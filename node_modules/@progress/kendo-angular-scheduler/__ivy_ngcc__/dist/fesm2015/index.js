/**-----------------------------------------------------------------------------------------
* Copyright © 2020 Progress Software Corporation. All rights reserved.
* Licensed under commercial license. See LICENSE.md in the project root for more information
*-------------------------------------------------------------------------------------------*/
import { Directive, TemplateRef, Optional, Injectable, EventEmitter, NgZone, Input, Renderer2, ElementRef, ChangeDetectorRef, Inject, isDevMode, Component, HostBinding, ChangeDetectionStrategy, ViewEncapsulation, Output, ContentChild, ContentChildren, ViewChild, ViewContainerRef, forwardRef, NgModule, LOCALE_ID, Pipe, ViewChildren, HostListener } from '@angular/core';
import { LocalizationService, L10N_PREFIX, MessageService, RTL, ComponentMessages } from '@progress/kendo-angular-l10n';
import { hasObservers, isDocumentAvailable, isChanged, anyChanged, ResizeSensorComponent, EventsModule, guid, Keys, ResizeSensorModule } from '@progress/kendo-angular-common';
import { getDate, Day, ZonedDate, isEqualDate, toLocalDate, MS_PER_DAY, addDays, firstDayOfMonth, addMonths, firstDayInWeek, timezoneNames } from '@progress/kendo-date-math';
import { PreventableEvent, CalendarModule, DateInputsModule } from '@progress/kendo-angular-dateinputs';
import { Subject, BehaviorSubject, fromEvent, Subscription, combineLatest, merge } from 'rxjs';
import { buffer, filter, map, auditTime, debounceTime, take, switchMap, tap } from 'rxjs/operators';
import { FormControl, FormGroup, NG_VALUE_ACCESSOR, ReactiveFormsModule } from '@angular/forms';
import { DialogCloseResult, DialogService, DialogModule } from '@progress/kendo-angular-dialog';
import { IntlService, formatDate, IntlModule, CldrIntlService, parseDate } from '@progress/kendo-angular-intl';
import { CommonModule } from '@angular/common';
import { parseRule, expand, serializeRule } from '@progress/kendo-recurrence';
import { PopupService, PopupModule } from '@progress/kendo-angular-popup';
import { orderBy, groupBy } from '@progress/kendo-data-query';
import Draggable from '@telerik/kendo-draggable';
import { DropDownsModule } from '@progress/kendo-angular-dropdowns';
import { Button, ButtonsModule } from '@progress/kendo-angular-buttons';
import { NumericTextBoxModule, TextBoxModule } from '@progress/kendo-angular-inputs';
import { drawDOM, exportPDF } from '@progress/kendo-drawing';
import { saveAs } from '@progress/kendo-file-saver';

/**
 * Arguments for the `dateChange` event.
 */
import * as ɵngcc0 from '@angular/core';
import * as ɵngcc1 from '@progress/kendo-angular-dialog';
import * as ɵngcc2 from '@progress/kendo-angular-l10n';
import * as ɵngcc3 from '@progress/kendo-angular-intl';
import * as ɵngcc4 from '@angular/common';
import * as ɵngcc5 from '@progress/kendo-angular-common';
import * as ɵngcc6 from '@progress/kendo-angular-popup';
import * as ɵngcc7 from '@progress/kendo-angular-dateinputs';
import * as ɵngcc8 from '@progress/kendo-angular-dropdowns';
import * as ɵngcc9 from '@angular/forms';
import * as ɵngcc10 from '@progress/kendo-angular-buttons';
import * as ɵngcc11 from '@progress/kendo-angular-inputs';

const _c0 = ["kendoSchedulerLoading", ""];
const _c1 = ["confirmationDialogContainer"];
var I18N_2;
if (typeof ngI18nClosureMode !== "undefined" && ngI18nClosureMode) {
    /**
     * @desc The All events text displayed in the timeline views when there is no vertical grouping.
     * @meaning kendo.scheduler.allEvents
     */ 
    const MSG_EXTERNAL_8408622862957502888$$DIST_FESM2015_INDEX_JS_3 = goog.getMsg("All events");
    I18N_2 = MSG_EXTERNAL_8408622862957502888$$DIST_FESM2015_INDEX_JS_3;
}
else {
    I18N_2 = $localize `:kendo.scheduler.allEvents|The All events text displayed in the timeline views when there is no vertical grouping.␟45d19d9b3ef76d141ff0e2d0fc223f0fa947bb55␟8408622862957502888:All events`;
}
var I18N_4;
if (typeof ngI18nClosureMode !== "undefined" && ngI18nClosureMode) {
    /**
     * @desc The all day text displayed in the day and week views.
     * @meaning kendo.scheduler.allDay
     */ 
    const MSG_EXTERNAL_1312095086929656823$$DIST_FESM2015_INDEX_JS_5 = goog.getMsg("all day");
    I18N_4 = MSG_EXTERNAL_1312095086929656823$$DIST_FESM2015_INDEX_JS_5;
}
else {
    I18N_4 = $localize `:kendo.scheduler.allDay|The all day text displayed in the day and week views.␟e61f2c1a0414bc2137acd254acf1e80e12a3e7ff␟1312095086929656823:all day`;
}
var I18N_6;
if (typeof ngI18nClosureMode !== "undefined" && ngI18nClosureMode) {
    /**
     * @desc The date header text displayed in the agenda view.
     * @meaning kendo.scheduler.dateHeader
     */ 
    const MSG_EXTERNAL_6984691347020720127$$DIST_FESM2015_INDEX_JS_7 = goog.getMsg("Date");
    I18N_6 = MSG_EXTERNAL_6984691347020720127$$DIST_FESM2015_INDEX_JS_7;
}
else {
    I18N_6 = $localize `:kendo.scheduler.dateHeader|The date header text displayed in the agenda view.␟8d2df501dbf1d7110b31000c6e0bb5f2f7a73f25␟6984691347020720127:Date`;
}
var I18N_8;
if (typeof ngI18nClosureMode !== "undefined" && ngI18nClosureMode) {
    /**
     * @desc The time header text displayed in the agenda view.
     * @meaning kendo.scheduler.timeHeader
     */ 
    const MSG_EXTERNAL_8587582897660323296$$DIST_FESM2015_INDEX_JS_9 = goog.getMsg("Time");
    I18N_8 = MSG_EXTERNAL_8587582897660323296$$DIST_FESM2015_INDEX_JS_9;
}
else {
    I18N_8 = $localize `:kendo.scheduler.timeHeader|The time header text displayed in the agenda view.␟0b9f46b7397825c376c9bfdb240e6adc50595ac4␟8587582897660323296:Time`;
}
var I18N_10;
if (typeof ngI18nClosureMode !== "undefined" && ngI18nClosureMode) {
    /**
     * @desc The delete icon title.
     * @meaning kendo.scheduler.deleteTitle
     */ 
    const MSG_EXTERNAL_3978422734727725369$$DIST_FESM2015_INDEX_JS_11 = goog.getMsg("Delete");
    I18N_10 = MSG_EXTERNAL_3978422734727725369$$DIST_FESM2015_INDEX_JS_11;
}
else {
    I18N_10 = $localize `:kendo.scheduler.deleteTitle|The delete icon title.␟a458e323a0bd2340993beb65206a75e51d9a697f␟3978422734727725369:Delete`;
}
var I18N_12;
if (typeof ngI18nClosureMode !== "undefined" && ngI18nClosureMode) {
    /**
     * @desc The event header text displayed in the agenda view.
     * @meaning kendo.scheduler.eventHeader
     */ 
    const MSG_EXTERNAL_2796853291807558926$$DIST_FESM2015_INDEX_JS_13 = goog.getMsg("Event");
    I18N_12 = MSG_EXTERNAL_2796853291807558926$$DIST_FESM2015_INDEX_JS_13;
}
else {
    I18N_12 = $localize `:kendo.scheduler.eventHeader|The event header text displayed in the agenda view.␟8702ed2955b31f24baf4651a5867bff8a75126f2␟2796853291807558926:Event`;
}
var I18N_14;
if (typeof ngI18nClosureMode !== "undefined" && ngI18nClosureMode) {
    /**
     * @desc The title of the navigation next button.
     * @meaning kendo.scheduler.nextTitle
     */ 
    const MSG_EXTERNAL_5955416358076623168$$DIST_FESM2015_INDEX_JS_15 = goog.getMsg("Next");
    I18N_14 = MSG_EXTERNAL_5955416358076623168$$DIST_FESM2015_INDEX_JS_15;
}
else {
    I18N_14 = $localize `:kendo.scheduler.nextTitle|The title of the navigation next button.␟2ebb83a1a2f679e77d3b218501dad8bccdc0a58e␟5955416358076623168:Next`;
}
var I18N_16;
if (typeof ngI18nClosureMode !== "undefined" && ngI18nClosureMode) {
    /**
     * @desc The title of the navigation previous button.
     * @meaning kendo.scheduler.previousTitle
     */ 
    const MSG_EXTERNAL_8718593914002864927$$DIST_FESM2015_INDEX_JS_17 = goog.getMsg("Previous");
    I18N_16 = MSG_EXTERNAL_8718593914002864927$$DIST_FESM2015_INDEX_JS_17;
}
else {
    I18N_16 = $localize `:kendo.scheduler.previousTitle|The title of the navigation previous button.␟2ffa7eebcba58b882fc7e4f84bc42d52f6c387ad␟8718593914002864927:Previous`;
}
var I18N_18;
if (typeof ngI18nClosureMode !== "undefined" && ngI18nClosureMode) {
    /**
     * @desc The text of the show full day button displayed in the footer of the day, week and timeline views.
     * @meaning kendo.scheduler.showFullDay
     */ 
    const MSG_EXTERNAL_8822764848863163824$$DIST_FESM2015_INDEX_JS_19 = goog.getMsg("Show full day");
    I18N_18 = MSG_EXTERNAL_8822764848863163824$$DIST_FESM2015_INDEX_JS_19;
}
else {
    I18N_18 = $localize `:kendo.scheduler.showFullDay|The text of the show full day button displayed in the footer of the day, week and timeline views.␟3744a237fcc462c5a6e6d02cc34c685b4612672c␟8822764848863163824:Show full day`;
}
var I18N_20;
if (typeof ngI18nClosureMode !== "undefined" && ngI18nClosureMode) {
    /**
     * @desc The text of the show work day button displayed in the footer of the day, week and timeline views.
     * @meaning kendo.scheduler.showWorkDay
     */ 
    const MSG_EXTERNAL_3936978764162144919$$DIST_FESM2015_INDEX_JS_21 = goog.getMsg("Show business hours");
    I18N_20 = MSG_EXTERNAL_3936978764162144919$$DIST_FESM2015_INDEX_JS_21;
}
else {
    I18N_20 = $localize `:kendo.scheduler.showWorkDay|The text of the show work day button displayed in the footer of the day, week and timeline views.␟be7a47bb38902473d3c58ced7bd607ce10e9efc0␟3936978764162144919:Show business hours`;
}
var I18N_22;
if (typeof ngI18nClosureMode !== "undefined" && ngI18nClosureMode) {
    /**
     * @desc The today button text displayed in the navigation.
     * @meaning kendo.scheduler.today
     */ 
    const MSG_EXTERNAL_7902376714654319987$$DIST_FESM2015_INDEX_JS_23 = goog.getMsg("Today");
    I18N_22 = MSG_EXTERNAL_7902376714654319987$$DIST_FESM2015_INDEX_JS_23;
}
else {
    I18N_22 = $localize `:kendo.scheduler.today|The today button text displayed in the navigation.␟d82a4f28a9981df444a5dc3581002c21e9691d43␟7902376714654319987:Today`;
}
var I18N_24;
if (typeof ngI18nClosureMode !== "undefined" && ngI18nClosureMode) {
    /**
     * @desc The text of today's date in the header of the Calendar.
     * @meaning kendo.scheduler.calendarToday
     */ 
    const MSG_EXTERNAL_3220648218786128347$$DIST_FESM2015_INDEX_JS_25 = goog.getMsg("TODAY");
    I18N_24 = MSG_EXTERNAL_3220648218786128347$$DIST_FESM2015_INDEX_JS_25;
}
else {
    I18N_24 = $localize `:kendo.scheduler.calendarToday|The text of today's date in the header of the Calendar.␟d94740e45bae6fa585efd5f8d5162aac5729240a␟3220648218786128347:TODAY`;
}
var I18N_26;
if (typeof ngI18nClosureMode !== "undefined" && ngI18nClosureMode) {
    /**
     * @desc The day view title.
     * @meaning kendo.scheduler.dayViewTitle
     */ 
    const MSG_EXTERNAL_4013373256580533285$$DIST_FESM2015_INDEX_JS_27 = goog.getMsg("Day");
    I18N_26 = MSG_EXTERNAL_4013373256580533285$$DIST_FESM2015_INDEX_JS_27;
}
else {
    I18N_26 = $localize `:kendo.scheduler.dayViewTitle|The day view title.␟95294711f9c0d5dc43a3801e1fb33ff009cd2f9f␟4013373256580533285:Day`;
}
var I18N_28;
if (typeof ngI18nClosureMode !== "undefined" && ngI18nClosureMode) {
    /**
     * @desc The multi day view title.
     * @meaning kendo.scheduler.multiDayViewTitle
     */ 
    const MSG_EXTERNAL_4942025028043440996$$DIST_FESM2015_INDEX_JS_29 = goog.getMsg("Multi-Day");
    I18N_28 = MSG_EXTERNAL_4942025028043440996$$DIST_FESM2015_INDEX_JS_29;
}
else {
    I18N_28 = $localize `:kendo.scheduler.multiDayViewTitle|The multi day view title.␟9454696588264b0a4dc173ae30287b5daf5a005f␟4942025028043440996:Multi-Day`;
}
var I18N_30;
if (typeof ngI18nClosureMode !== "undefined" && ngI18nClosureMode) {
    /**
     * @desc The week view title.
     * @meaning kendo.scheduler.weekViewTitle
     */ 
    const MSG_EXTERNAL_4740641677277537900$$DIST_FESM2015_INDEX_JS_31 = goog.getMsg("Week");
    I18N_30 = MSG_EXTERNAL_4740641677277537900$$DIST_FESM2015_INDEX_JS_31;
}
else {
    I18N_30 = $localize `:kendo.scheduler.weekViewTitle|The week view title.␟278707809b2044247aea90cd6fa16f5e36360bff␟4740641677277537900:Week`;
}
var I18N_32;
if (typeof ngI18nClosureMode !== "undefined" && ngI18nClosureMode) {
    /**
     * @desc The work week view title.
     * @meaning kendo.scheduler.workWeekViewTitle
     */ 
    const MSG_EXTERNAL_5945679415328129389$$DIST_FESM2015_INDEX_JS_33 = goog.getMsg("Work Week");
    I18N_32 = MSG_EXTERNAL_5945679415328129389$$DIST_FESM2015_INDEX_JS_33;
}
else {
    I18N_32 = $localize `:kendo.scheduler.workWeekViewTitle|The work week view title.␟4e676d2adc2867a6f9f0268d944fa9b243a0342c␟5945679415328129389:Work Week`;
}
var I18N_34;
if (typeof ngI18nClosureMode !== "undefined" && ngI18nClosureMode) {
    /**
     * @desc The month view title.
     * @meaning kendo.scheduler.monthViewTitle
     */ 
    const MSG_EXTERNAL_1742125707942154077$$DIST_FESM2015_INDEX_JS_35 = goog.getMsg("Month");
    I18N_34 = MSG_EXTERNAL_1742125707942154077$$DIST_FESM2015_INDEX_JS_35;
}
else {
    I18N_34 = $localize `:kendo.scheduler.monthViewTitle|The month view title.␟ef42d2bdf6b5e730464f7c5bba7f9f691af487f7␟1742125707942154077:Month`;
}
var I18N_36;
if (typeof ngI18nClosureMode !== "undefined" && ngI18nClosureMode) {
    /**
     * @desc The timeline view title.
     * @meaning kendo.scheduler.timelineViewTitle
     */ 
    const MSG_EXTERNAL_8217382496677055298$$DIST_FESM2015_INDEX_JS_37 = goog.getMsg("Timeline");
    I18N_36 = MSG_EXTERNAL_8217382496677055298$$DIST_FESM2015_INDEX_JS_37;
}
else {
    I18N_36 = $localize `:kendo.scheduler.timelineViewTitle|The timeline view title.␟c3b0e12d3dffb7e0e4ad26366076b3a4145d1ccd␟8217382496677055298:Timeline`;
}
var I18N_38;
if (typeof ngI18nClosureMode !== "undefined" && ngI18nClosureMode) {
    /**
     * @desc The timeline week view title.
     * @meaning kendo.scheduler.timelineWeekViewTitle
     */ 
    const MSG_EXTERNAL_3115529717588498176$$DIST_FESM2015_INDEX_JS_39 = goog.getMsg("Timeline Week");
    I18N_38 = MSG_EXTERNAL_3115529717588498176$$DIST_FESM2015_INDEX_JS_39;
}
else {
    I18N_38 = $localize `:kendo.scheduler.timelineWeekViewTitle|The timeline week view title.␟6364c05e2771666adb47b133f925a89f2cbc7694␟3115529717588498176:Timeline Week`;
}
var I18N_40;
if (typeof ngI18nClosureMode !== "undefined" && ngI18nClosureMode) {
    /**
     * @desc The timeline month view title.
     * @meaning kendo.scheduler.timelineMonthViewTitle
     */ 
    const MSG_EXTERNAL_5220476278066772606$$DIST_FESM2015_INDEX_JS_41 = goog.getMsg("Timeline Month");
    I18N_40 = MSG_EXTERNAL_5220476278066772606$$DIST_FESM2015_INDEX_JS_41;
}
else {
    I18N_40 = $localize `:kendo.scheduler.timelineMonthViewTitle|The timeline month view title.␟c9caadeeb4298daf969b6849d82906526b17287d␟5220476278066772606:Timeline Month`;
}
var I18N_42;
if (typeof ngI18nClosureMode !== "undefined" && ngI18nClosureMode) {
    /**
     * @desc The agenda view title.
     * @meaning kendo.scheduler.agendaViewTitle
     */ 
    const MSG_EXTERNAL_3706328927689979096$$DIST_FESM2015_INDEX_JS_43 = goog.getMsg("Agenda");
    I18N_42 = MSG_EXTERNAL_3706328927689979096$$DIST_FESM2015_INDEX_JS_43;
}
else {
    I18N_42 = $localize `:kendo.scheduler.agendaViewTitle|The agenda view title.␟d8496db2e58fbcb49d4a962f466c7181136a394b␟3706328927689979096:Agenda`;
}
var I18N_44;
if (typeof ngI18nClosureMode !== "undefined" && ngI18nClosureMode) {
    /**
     * @desc The text similar to 'Cancel' displayed in scheduler.
     * @meaning kendo.scheduler.cancel
     */ 
    const MSG_EXTERNAL_3362605619020331305$$DIST_FESM2015_INDEX_JS_45 = goog.getMsg("Cancel");
    I18N_44 = MSG_EXTERNAL_3362605619020331305$$DIST_FESM2015_INDEX_JS_45;
}
else {
    I18N_44 = $localize `:kendo.scheduler.cancel|The text similar to 'Cancel' displayed in scheduler.␟f0c4e5b754f09725afce28e7d7068f35b858136c␟3362605619020331305:Cancel`;
}
var I18N_46;
if (typeof ngI18nClosureMode !== "undefined" && ngI18nClosureMode) {
    /**
     * @desc The text similar to 'Save' displayed in scheduler.
     * @meaning kendo.scheduler.save
     */ 
    const MSG_EXTERNAL_1135434150799803990$$DIST_FESM2015_INDEX_JS_47 = goog.getMsg("Save");
    I18N_46 = MSG_EXTERNAL_1135434150799803990$$DIST_FESM2015_INDEX_JS_47;
}
else {
    I18N_46 = $localize `:kendo.scheduler.save|The text similar to 'Save' displayed in scheduler.␟50889e2af44e6f957e14fa7a9ea8bf9149dfaafe␟1135434150799803990:Save`;
}
var I18N_48;
if (typeof ngI18nClosureMode !== "undefined" && ngI18nClosureMode) {
    /**
     * @desc The text similar to 'Title' displayed in the scheduler event editor.
     * @meaning kendo.scheduler.editorEventTitle
     */ 
    const MSG_EXTERNAL_4679570191412964384$$DIST_FESM2015_INDEX_JS_49 = goog.getMsg("Title");
    I18N_48 = MSG_EXTERNAL_4679570191412964384$$DIST_FESM2015_INDEX_JS_49;
}
else {
    I18N_48 = $localize `:kendo.scheduler.editorEventTitle|The text similar to 'Title' displayed in the scheduler event editor.␟f4b0165716706e0fd483febcc2557c573aad03b3␟4679570191412964384:Title`;
}
var I18N_50;
if (typeof ngI18nClosureMode !== "undefined" && ngI18nClosureMode) {
    /**
     * @desc The text similar to 'Start' displayed in the scheduler event editor.
     * @meaning kendo.scheduler.editorEventStart
     */ 
    const MSG_EXTERNAL_8950463545934402114$$DIST_FESM2015_INDEX_JS_51 = goog.getMsg("Start");
    I18N_50 = MSG_EXTERNAL_8950463545934402114$$DIST_FESM2015_INDEX_JS_51;
}
else {
    I18N_50 = $localize `:kendo.scheduler.editorEventStart|The text similar to 'Start' displayed in the scheduler event editor.␟a6d283a567098bd66cbf4a591cd372319b602968␟8950463545934402114:Start`;
}
var I18N_52;
if (typeof ngI18nClosureMode !== "undefined" && ngI18nClosureMode) {
    /**
     * @desc The text similar to 'Start Time Zone' displayed in the scheduler event editor.
     * @meaning kendo.scheduler.editorEventStartTimeZone
     */ 
    const MSG_EXTERNAL_3790399863174995244$$DIST_FESM2015_INDEX_JS_53 = goog.getMsg("Start Time Zone");
    I18N_52 = MSG_EXTERNAL_3790399863174995244$$DIST_FESM2015_INDEX_JS_53;
}
else {
    I18N_52 = $localize `:kendo.scheduler.editorEventStartTimeZone|The text similar to 'Start Time Zone' displayed in the scheduler event editor.␟fde16c966e6978a27a392ffaa336e18ccbd98e20␟3790399863174995244:Start Time Zone`;
}
var I18N_54;
if (typeof ngI18nClosureMode !== "undefined" && ngI18nClosureMode) {
    /**
     * @desc The text similar to 'End' displayed in the scheduler event editor.
     * @meaning kendo.scheduler.editorEventEnd
     */ 
    const MSG_EXTERNAL_4517224154488404602$$DIST_FESM2015_INDEX_JS_55 = goog.getMsg("End");
    I18N_54 = MSG_EXTERNAL_4517224154488404602$$DIST_FESM2015_INDEX_JS_55;
}
else {
    I18N_54 = $localize `:kendo.scheduler.editorEventEnd|The text similar to 'End' displayed in the scheduler event editor.␟45d1ffb3aa3b268723f86a3d8f58e15be78023b7␟4517224154488404602:End`;
}
var I18N_56;
if (typeof ngI18nClosureMode !== "undefined" && ngI18nClosureMode) {
    /**
     * @desc The text similar to 'End Time Zone' displayed in the scheduler event editor.
     * @meaning kendo.scheduler.editorEventEndTimeZone
     */ 
    const MSG_EXTERNAL_7038735539999845663$$DIST_FESM2015_INDEX_JS_57 = goog.getMsg("End Time Zone");
    I18N_56 = MSG_EXTERNAL_7038735539999845663$$DIST_FESM2015_INDEX_JS_57;
}
else {
    I18N_56 = $localize `:kendo.scheduler.editorEventEndTimeZone|The text similar to 'End Time Zone' displayed in the scheduler event editor.␟cd7d8ac89f8b8dd6117e53832c0cf11e72cfb652␟7038735539999845663:End Time Zone`;
}
var I18N_58;
if (typeof ngI18nClosureMode !== "undefined" && ngI18nClosureMode) {
    /**
     * @desc The text similar to 'All Day event' displayed in the scheduler event editor.
     * @meaning kendo.scheduler.editorEventAllDay
     */ 
    const MSG_EXTERNAL_7143574931251605534$$DIST_FESM2015_INDEX_JS_59 = goog.getMsg("All Day Event");
    I18N_58 = MSG_EXTERNAL_7143574931251605534$$DIST_FESM2015_INDEX_JS_59;
}
else {
    I18N_58 = $localize `:kendo.scheduler.editorEventAllDay|The text similar to 'All Day event' displayed in the scheduler event editor.␟501d4926870f59c6e28dc979f29c90d3353e6dd5␟7143574931251605534:All Day Event`;
}
var I18N_60;
if (typeof ngI18nClosureMode !== "undefined" && ngI18nClosureMode) {
    /**
     * @desc The text similar to 'Description' displayed in the scheduler event editor.
     * @meaning kendo.scheduler.editorEventDescription
     */ 
    const MSG_EXTERNAL_2326906337842303047$$DIST_FESM2015_INDEX_JS_61 = goog.getMsg("Description");
    I18N_60 = MSG_EXTERNAL_2326906337842303047$$DIST_FESM2015_INDEX_JS_61;
}
else {
    I18N_60 = $localize `:kendo.scheduler.editorEventDescription|The text similar to 'Description' displayed in the scheduler event editor.␟a6fe39f81a8dab506648aee70e5271c8e4b7459d␟2326906337842303047:Description`;
}
var I18N_62;
if (typeof ngI18nClosureMode !== "undefined" && ngI18nClosureMode) {
    /**
     * @desc The text similar to 'Use separate Start and End Time Zones' displayed in the scheduler event editor.
     * @meaning kendo.scheduler.editorEventSeparateTimeZones
     */ 
    const MSG_EXTERNAL_2965234059535254725$$DIST_FESM2015_INDEX_JS_63 = goog.getMsg("End in different Time Zone");
    I18N_62 = MSG_EXTERNAL_2965234059535254725$$DIST_FESM2015_INDEX_JS_63;
}
else {
    I18N_62 = $localize `:kendo.scheduler.editorEventSeparateTimeZones|The text similar to 'Use separate Start and End Time Zones' displayed in the scheduler event editor.␟09968e651cd9c911504e9b0637988edf5cab6f1c␟2965234059535254725:End in different Time Zone`;
}
var I18N_64;
if (typeof ngI18nClosureMode !== "undefined" && ngI18nClosureMode) {
    /**
     * @desc The text similar to 'Time Zone' displayed in the scheduler event editor.
     * @meaning kendo.scheduler.editorEventTimeZone
     */ 
    const MSG_EXTERNAL_2236213542221741073$$DIST_FESM2015_INDEX_JS_65 = goog.getMsg("Specify Time Zone");
    I18N_64 = MSG_EXTERNAL_2236213542221741073$$DIST_FESM2015_INDEX_JS_65;
}
else {
    I18N_64 = $localize `:kendo.scheduler.editorEventTimeZone|The text similar to 'Time Zone' displayed in the scheduler event editor.␟bf8df58c304deb2a94f51f48679085969a89b0e5␟2236213542221741073:Specify Time Zone`;
}
var I18N_66;
if (typeof ngI18nClosureMode !== "undefined" && ngI18nClosureMode) {
    /**
     * @desc The text similar to 'Event' displayed as title of the scheduler event editor.
     * @meaning kendo.scheduler.editorTitle
     */ 
    const MSG_EXTERNAL_6087685798709247238$$DIST_FESM2015_INDEX_JS_67 = goog.getMsg("Event");
    I18N_66 = MSG_EXTERNAL_6087685798709247238$$DIST_FESM2015_INDEX_JS_67;
}
else {
    I18N_66 = $localize `:kendo.scheduler.editorTitle|The text similar to 'Event' displayed as title of the scheduler event editor.␟9f7df90df3ce014c3f31fd58c295079df2018366␟6087685798709247238:Event`;
}
var I18N_68;
if (typeof ngI18nClosureMode !== "undefined" && ngI18nClosureMode) {
    /**
     * @desc The text similar to 'Repeat' displayed in the scheduler recurrence editor.
     * @meaning kendo.scheduler.recurrenceEditorRepeat
     */ 
    const MSG_EXTERNAL_2771130446018606333$$DIST_FESM2015_INDEX_JS_69 = goog.getMsg("Repeat");
    I18N_68 = MSG_EXTERNAL_2771130446018606333$$DIST_FESM2015_INDEX_JS_69;
}
else {
    I18N_68 = $localize `:kendo.scheduler.recurrenceEditorRepeat|The text similar to 'Repeat' displayed in the scheduler recurrence editor.␟e424d1bb72fabf05780214e8adac996805f172ac␟2771130446018606333:Repeat`;
}
var I18N_70;
if (typeof ngI18nClosureMode !== "undefined" && ngI18nClosureMode) {
    /**
     * @desc The text similar to 'day(s)' displayed in the scheduler recurrence editor.
     * @meaning kendo.scheduler.recurrenceEditorDailyInterval
     */ 
    const MSG_EXTERNAL_7156265113240976747$$DIST_FESM2015_INDEX_JS_71 = goog.getMsg("day(s)");
    I18N_70 = MSG_EXTERNAL_7156265113240976747$$DIST_FESM2015_INDEX_JS_71;
}
else {
    I18N_70 = $localize `:kendo.scheduler.recurrenceEditorDailyInterval|The text similar to 'day(s)' displayed in the scheduler recurrence editor.␟d902290d2ee048dd4c04015388b1419bd7319297␟7156265113240976747:day(s)`;
}
var I18N_72;
if (typeof ngI18nClosureMode !== "undefined" && ngI18nClosureMode) {
    /**
     * @desc The text similar to 'Repeat every' displayed in the scheduler recurrence editor.
     * @meaning kendo.scheduler.recurrenceEditorDailyRepeatEvery
     */ 
    const MSG_EXTERNAL_4754044655309841246$$DIST_FESM2015_INDEX_JS_73 = goog.getMsg("Repeat every");
    I18N_72 = MSG_EXTERNAL_4754044655309841246$$DIST_FESM2015_INDEX_JS_73;
}
else {
    I18N_72 = $localize `:kendo.scheduler.recurrenceEditorDailyRepeatEvery|The text similar to 'Repeat every' displayed in the scheduler recurrence editor.␟178b1746e470c53796d23ca6679b5dbeb541f354␟4754044655309841246:Repeat every`;
}
var I18N_74;
if (typeof ngI18nClosureMode !== "undefined" && ngI18nClosureMode) {
    /**
     * @desc The text similar to 'week(s)' displayed in the scheduler recurrence editor.
     * @meaning kendo.scheduler.recurrenceEditorWeeklyInterval
     */ 
    const MSG_EXTERNAL_6964433212570735746$$DIST_FESM2015_INDEX_JS_75 = goog.getMsg("week(s)");
    I18N_74 = MSG_EXTERNAL_6964433212570735746$$DIST_FESM2015_INDEX_JS_75;
}
else {
    I18N_74 = $localize `:kendo.scheduler.recurrenceEditorWeeklyInterval|The text similar to 'week(s)' displayed in the scheduler recurrence editor.␟6c7d5458c9e73ed2ba5db7d27f90c54b22e65bb8␟6964433212570735746:week(s)`;
}
var I18N_76;
if (typeof ngI18nClosureMode !== "undefined" && ngI18nClosureMode) {
    /**
     * @desc The text similar to 'Repeat every' displayed in the scheduler recurrence editor.
     * @meaning kendo.scheduler.recurrenceEditorWeeklyRepeatEvery
     */ 
    const MSG_EXTERNAL_3817801398781476456$$DIST_FESM2015_INDEX_JS_77 = goog.getMsg("Repeat every");
    I18N_76 = MSG_EXTERNAL_3817801398781476456$$DIST_FESM2015_INDEX_JS_77;
}
else {
    I18N_76 = $localize `:kendo.scheduler.recurrenceEditorWeeklyRepeatEvery|The text similar to 'Repeat every' displayed in the scheduler recurrence editor.␟6c9ac15982b8767f300f958a584dd61e2badc218␟3817801398781476456:Repeat every`;
}
var I18N_78;
if (typeof ngI18nClosureMode !== "undefined" && ngI18nClosureMode) {
    /**
     * @desc The text similar to 'Repeat on' displayed in the scheduler recurrence editor.
     * @meaning kendo.scheduler.recurrenceEditorWeeklyRepeatOn
     */ 
    const MSG_EXTERNAL_6453859475568542185$$DIST_FESM2015_INDEX_JS_79 = goog.getMsg("Repeat on");
    I18N_78 = MSG_EXTERNAL_6453859475568542185$$DIST_FESM2015_INDEX_JS_79;
}
else {
    I18N_78 = $localize `:kendo.scheduler.recurrenceEditorWeeklyRepeatOn|The text similar to 'Repeat on' displayed in the scheduler recurrence editor.␟7d47cd2c34022c3d730fe5535fe6d5772e259100␟6453859475568542185:Repeat on`;
}
var I18N_80;
if (typeof ngI18nClosureMode !== "undefined" && ngI18nClosureMode) {
    /**
     * @desc The text similar to 'Day' displayed in the scheduler recurrence editor.
     * @meaning kendo.scheduler.recurrenceEditorMonthlyDay
     */ 
    const MSG_EXTERNAL_5599748045690190536$$DIST_FESM2015_INDEX_JS_81 = goog.getMsg("Day");
    I18N_80 = MSG_EXTERNAL_5599748045690190536$$DIST_FESM2015_INDEX_JS_81;
}
else {
    I18N_80 = $localize `:kendo.scheduler.recurrenceEditorMonthlyDay|The text similar to 'Day' displayed in the scheduler recurrence editor.␟e9c50e6d1046b52f72b5b57def511d2639f41c49␟5599748045690190536:Day`;
}
var I18N_82;
if (typeof ngI18nClosureMode !== "undefined" && ngI18nClosureMode) {
    /**
     * @desc The text similar to 'month(s)' displayed in the scheduler recurrence editor.
     * @meaning kendo.scheduler.recurrenceEditorMonthlyInterval
     */ 
    const MSG_EXTERNAL_3575417344638854070$$DIST_FESM2015_INDEX_JS_83 = goog.getMsg("month(s)");
    I18N_82 = MSG_EXTERNAL_3575417344638854070$$DIST_FESM2015_INDEX_JS_83;
}
else {
    I18N_82 = $localize `:kendo.scheduler.recurrenceEditorMonthlyInterval|The text similar to 'month(s)' displayed in the scheduler recurrence editor.␟4e8829d18918c60a930c9bc1222a385da0328824␟3575417344638854070:month(s)`;
}
var I18N_84;
if (typeof ngI18nClosureMode !== "undefined" && ngI18nClosureMode) {
    /**
     * @desc The text similar to 'Repeat every' displayed in the scheduler recurrence editor.
     * @meaning kendo.scheduler.recurrenceEditorMonthlyRepeatEvery
     */ 
    const MSG_EXTERNAL_7719819752023049444$$DIST_FESM2015_INDEX_JS_85 = goog.getMsg("Repeat every");
    I18N_84 = MSG_EXTERNAL_7719819752023049444$$DIST_FESM2015_INDEX_JS_85;
}
else {
    I18N_84 = $localize `:kendo.scheduler.recurrenceEditorMonthlyRepeatEvery|The text similar to 'Repeat every' displayed in the scheduler recurrence editor.␟a4d8135703345b071c369b698c4cccd04d88e9e4␟7719819752023049444:Repeat every`;
}
var I18N_86;
if (typeof ngI18nClosureMode !== "undefined" && ngI18nClosureMode) {
    /**
     * @desc The text similar to 'Repeat on' displayed in the scheduler recurrence editor.
     * @meaning kendo.scheduler.recurrenceEditorMonthlyRepeatOn
     */ 
    const MSG_EXTERNAL_2096766037382368468$$DIST_FESM2015_INDEX_JS_87 = goog.getMsg("Repeat on");
    I18N_86 = MSG_EXTERNAL_2096766037382368468$$DIST_FESM2015_INDEX_JS_87;
}
else {
    I18N_86 = $localize `:kendo.scheduler.recurrenceEditorMonthlyRepeatOn|The text similar to 'Repeat on' displayed in the scheduler recurrence editor.␟a5edb3aa4326d98a824044cd1e7097296a164bd1␟2096766037382368468:Repeat on`;
}
var I18N_88;
if (typeof ngI18nClosureMode !== "undefined" && ngI18nClosureMode) {
    /**
     * @desc The text similar to 'of' displayed in the scheduler recurrence editor.
     * @meaning kendo.scheduler.recurrenceEditorYearlyOf
     */ 
    const MSG_EXTERNAL_6672695259943113660$$DIST_FESM2015_INDEX_JS_89 = goog.getMsg("of");
    I18N_88 = MSG_EXTERNAL_6672695259943113660$$DIST_FESM2015_INDEX_JS_89;
}
else {
    I18N_88 = $localize `:kendo.scheduler.recurrenceEditorYearlyOf|The text similar to 'of' displayed in the scheduler recurrence editor.␟13a98c0f4d00f0231244181f3b11680e041d004b␟6672695259943113660:of`;
}
var I18N_90;
if (typeof ngI18nClosureMode !== "undefined" && ngI18nClosureMode) {
    /**
     * @desc The text similar to 'Repeat every' displayed in the scheduler recurrence editor.
     * @meaning kendo.scheduler.recurrenceEditorYearlyRepeatEvery
     */ 
    const MSG_EXTERNAL_8141119167461241688$$DIST_FESM2015_INDEX_JS_91 = goog.getMsg("Repeat every");
    I18N_90 = MSG_EXTERNAL_8141119167461241688$$DIST_FESM2015_INDEX_JS_91;
}
else {
    I18N_90 = $localize `:kendo.scheduler.recurrenceEditorYearlyRepeatEvery|The text similar to 'Repeat every' displayed in the scheduler recurrence editor.␟b50a62cd37f139cccf32a0337f64759df6c2d26e␟8141119167461241688:Repeat every`;
}
var I18N_92;
if (typeof ngI18nClosureMode !== "undefined" && ngI18nClosureMode) {
    /**
     * @desc The text similar to 'Repeat on' displayed in the scheduler recurrence editor.
     * @meaning kendo.scheduler.recurrenceEditorYearlyRepeatOn
     */ 
    const MSG_EXTERNAL_2145735653820863227$$DIST_FESM2015_INDEX_JS_93 = goog.getMsg("Repeat on");
    I18N_92 = MSG_EXTERNAL_2145735653820863227$$DIST_FESM2015_INDEX_JS_93;
}
else {
    I18N_92 = $localize `:kendo.scheduler.recurrenceEditorYearlyRepeatOn|The text similar to 'Repeat on' displayed in the scheduler recurrence editor.␟06852b1d73720228cae4f93944cacbd4e5f8350c␟2145735653820863227:Repeat on`;
}
var I18N_94;
if (typeof ngI18nClosureMode !== "undefined" && ngI18nClosureMode) {
    /**
     * @desc The text similar to 'year(s)' displayed in the scheduler recurrence editor.
     * @meaning kendo.scheduler.recurrenceEditorYearlyInterval
     */ 
    const MSG_EXTERNAL_1652202196533936726$$DIST_FESM2015_INDEX_JS_95 = goog.getMsg("year(s)");
    I18N_94 = MSG_EXTERNAL_1652202196533936726$$DIST_FESM2015_INDEX_JS_95;
}
else {
    I18N_94 = $localize `:kendo.scheduler.recurrenceEditorYearlyInterval|The text similar to 'year(s)' displayed in the scheduler recurrence editor.␟3aa2820cc946cd5d3c3b6aab3373eaa6b9c404fb␟1652202196533936726:year(s)`;
}
var I18N_96;
if (typeof ngI18nClosureMode !== "undefined" && ngI18nClosureMode) {
    /**
     * @desc The text similar to 'Daily' displayed in the scheduler recurrence editor.
     * @meaning kendo.scheduler.recurrenceEditorFrequenciesDaily
     */ 
    const MSG_EXTERNAL_5023213595781266531$$DIST_FESM2015_INDEX_JS_97 = goog.getMsg("Daily");
    I18N_96 = MSG_EXTERNAL_5023213595781266531$$DIST_FESM2015_INDEX_JS_97;
}
else {
    I18N_96 = $localize `:kendo.scheduler.recurrenceEditorFrequenciesDaily|The text similar to 'Daily' displayed in the scheduler recurrence editor.␟bbaafa8ff78cf75fdbd992be947fe00f997f6e64␟5023213595781266531:Daily`;
}
var I18N_98;
if (typeof ngI18nClosureMode !== "undefined" && ngI18nClosureMode) {
    /**
     * @desc The text similar to 'Monthly' displayed in the scheduler recurrence editor.
     * @meaning kendo.scheduler.recurrenceEditorFrequenciesMonthly
     */ 
    const MSG_EXTERNAL_3884314422864893067$$DIST_FESM2015_INDEX_JS_99 = goog.getMsg("Monthly");
    I18N_98 = MSG_EXTERNAL_3884314422864893067$$DIST_FESM2015_INDEX_JS_99;
}
else {
    I18N_98 = $localize `:kendo.scheduler.recurrenceEditorFrequenciesMonthly|The text similar to 'Monthly' displayed in the scheduler recurrence editor.␟65d8df3c16d1d27fae45bf68b17a4608ee6a6a29␟3884314422864893067:Monthly`;
}
var I18N_100;
if (typeof ngI18nClosureMode !== "undefined" && ngI18nClosureMode) {
    /**
     * @desc The text similar to 'Never' displayed in the scheduler recurrence editor.
     * @meaning kendo.scheduler.recurrenceEditorFrequenciesNever
     */ 
    const MSG_EXTERNAL_7758510782582934936$$DIST_FESM2015_INDEX_JS_101 = goog.getMsg("Never");
    I18N_100 = MSG_EXTERNAL_7758510782582934936$$DIST_FESM2015_INDEX_JS_101;
}
else {
    I18N_100 = $localize `:kendo.scheduler.recurrenceEditorFrequenciesNever|The text similar to 'Never' displayed in the scheduler recurrence editor.␟16da1a785f3ff5dc02af3822c8e3ede77fac8643␟7758510782582934936:Never`;
}
var I18N_102;
if (typeof ngI18nClosureMode !== "undefined" && ngI18nClosureMode) {
    /**
     * @desc The text similar to 'Weekly' displayed in the scheduler recurrence editor.
     * @meaning kendo.scheduler.recurrenceEditorFrequenciesWeekly
     */ 
    const MSG_EXTERNAL_3105770084102237891$$DIST_FESM2015_INDEX_JS_103 = goog.getMsg("Weekly");
    I18N_102 = MSG_EXTERNAL_3105770084102237891$$DIST_FESM2015_INDEX_JS_103;
}
else {
    I18N_102 = $localize `:kendo.scheduler.recurrenceEditorFrequenciesWeekly|The text similar to 'Weekly' displayed in the scheduler recurrence editor.␟208423d471dc351046a5f44215e683d2fc3d0045␟3105770084102237891:Weekly`;
}
var I18N_104;
if (typeof ngI18nClosureMode !== "undefined" && ngI18nClosureMode) {
    /**
     * @desc The text similar to 'Yearly' displayed in the scheduler recurrence editor.
     * @meaning kendo.scheduler.recurrenceEditorFrequenciesYearly
     */ 
    const MSG_EXTERNAL_3776729014363660971$$DIST_FESM2015_INDEX_JS_105 = goog.getMsg("Yearly");
    I18N_104 = MSG_EXTERNAL_3776729014363660971$$DIST_FESM2015_INDEX_JS_105;
}
else {
    I18N_104 = $localize `:kendo.scheduler.recurrenceEditorFrequenciesYearly|The text similar to 'Yearly' displayed in the scheduler recurrence editor.␟05941c17c2a1103f0609e74a154a908d8055dbae␟3776729014363660971:Yearly`;
}
var I18N_106;
if (typeof ngI18nClosureMode !== "undefined" && ngI18nClosureMode) {
    /**
     * @desc The text similar to 'First' displayed in the scheduler recurrence editor.
     * @meaning kendo.scheduler.recurrenceEditorOffsetPositionsFirst
     */ 
    const MSG_EXTERNAL_5597626547885665582$$DIST_FESM2015_INDEX_JS_107 = goog.getMsg("First");
    I18N_106 = MSG_EXTERNAL_5597626547885665582$$DIST_FESM2015_INDEX_JS_107;
}
else {
    I18N_106 = $localize `:kendo.scheduler.recurrenceEditorOffsetPositionsFirst|The text similar to 'First' displayed in the scheduler recurrence editor.␟edbc4f6e22e62b48a01a064e11d0d16b34a0200c␟5597626547885665582:First`;
}
var I18N_108;
if (typeof ngI18nClosureMode !== "undefined" && ngI18nClosureMode) {
    /**
     * @desc The text similar to 'Second' displayed in the scheduler recurrence editor.
     * @meaning kendo.scheduler.recurrenceEditorOffsetPositionsSecond
     */ 
    const MSG_EXTERNAL_6416510614694965999$$DIST_FESM2015_INDEX_JS_109 = goog.getMsg("Second");
    I18N_108 = MSG_EXTERNAL_6416510614694965999$$DIST_FESM2015_INDEX_JS_109;
}
else {
    I18N_108 = $localize `:kendo.scheduler.recurrenceEditorOffsetPositionsSecond|The text similar to 'Second' displayed in the scheduler recurrence editor.␟5bc0dbc945d780455bc967dc3690456cbb5cc908␟6416510614694965999:Second`;
}
var I18N_110;
if (typeof ngI18nClosureMode !== "undefined" && ngI18nClosureMode) {
    /**
     * @desc The text similar to 'Third' displayed in the scheduler recurrence editor.
     * @meaning kendo.scheduler.recurrenceEditorOffsetPositionsThird
     */ 
    const MSG_EXTERNAL_5473687794099280167$$DIST_FESM2015_INDEX_JS_111 = goog.getMsg("Third");
    I18N_110 = MSG_EXTERNAL_5473687794099280167$$DIST_FESM2015_INDEX_JS_111;
}
else {
    I18N_110 = $localize `:kendo.scheduler.recurrenceEditorOffsetPositionsThird|The text similar to 'Third' displayed in the scheduler recurrence editor.␟7db9a1dcc928a557ecdf987e9a513d999308e458␟5473687794099280167:Third`;
}
var I18N_112;
if (typeof ngI18nClosureMode !== "undefined" && ngI18nClosureMode) {
    /**
     * @desc The text similar to 'Fourth' displayed in the scheduler recurrence editor.
     * @meaning kendo.scheduler.recurrenceEditorOffsetPositionsFourth
     */ 
    const MSG_EXTERNAL_3450058621151317524$$DIST_FESM2015_INDEX_JS_113 = goog.getMsg("Fourth");
    I18N_112 = MSG_EXTERNAL_3450058621151317524$$DIST_FESM2015_INDEX_JS_113;
}
else {
    I18N_112 = $localize `:kendo.scheduler.recurrenceEditorOffsetPositionsFourth|The text similar to 'Fourth' displayed in the scheduler recurrence editor.␟5eab7aca02ce9226be42b48bf20d9dfa7b0866d8␟3450058621151317524:Fourth`;
}
var I18N_114;
if (typeof ngI18nClosureMode !== "undefined" && ngI18nClosureMode) {
    /**
     * @desc The text similar to 'Last' displayed in the scheduler recurrence editor.
     * @meaning kendo.scheduler.recurrenceEditorOffsetPositionsLast
     */ 
    const MSG_EXTERNAL_6038647414973413875$$DIST_FESM2015_INDEX_JS_115 = goog.getMsg("Last");
    I18N_114 = MSG_EXTERNAL_6038647414973413875$$DIST_FESM2015_INDEX_JS_115;
}
else {
    I18N_114 = $localize `:kendo.scheduler.recurrenceEditorOffsetPositionsLast|The text similar to 'Last' displayed in the scheduler recurrence editor.␟a2c19b0030dc10e94ad96261dd96f34e0b39fd00␟6038647414973413875:Last`;
}
var I18N_116;
if (typeof ngI18nClosureMode !== "undefined" && ngI18nClosureMode) {
    /**
     * @desc The text similar to 'Day' displayed in the repeat by section of the monthly recurrence pattern.
     * @meaning kendo.scheduler.recurrenceEditorWeekdaysDay
     */ 
    const MSG_EXTERNAL_7655296102419034905$$DIST_FESM2015_INDEX_JS_117 = goog.getMsg("Day");
    I18N_116 = MSG_EXTERNAL_7655296102419034905$$DIST_FESM2015_INDEX_JS_117;
}
else {
    I18N_116 = $localize `:kendo.scheduler.recurrenceEditorWeekdaysDay|The text similar to 'Day' displayed in the repeat by section of the monthly recurrence pattern.␟34c1dbeea117aa993dcbd25fed7eab0618d9c078␟7655296102419034905:Day`;
}
var I18N_118;
if (typeof ngI18nClosureMode !== "undefined" && ngI18nClosureMode) {
    /**
     * @desc The text similar to 'Weekday' displayed in the repeat by section of the monthly recurrence pattern.
     * @meaning kendo.scheduler.recurrenceEditorWeekdaysWeekday
     */ 
    const MSG_EXTERNAL_4094983069547710260$$DIST_FESM2015_INDEX_JS_119 = goog.getMsg("Weekday");
    I18N_118 = MSG_EXTERNAL_4094983069547710260$$DIST_FESM2015_INDEX_JS_119;
}
else {
    I18N_118 = $localize `:kendo.scheduler.recurrenceEditorWeekdaysWeekday|The text similar to 'Weekday' displayed in the repeat by section of the monthly recurrence pattern.␟6c1ce6b9c46f38effb21b847e8facdff0b664fd3␟4094983069547710260:Weekday`;
}
var I18N_120;
if (typeof ngI18nClosureMode !== "undefined" && ngI18nClosureMode) {
    /**
     * @desc The text similar to 'Weekend Day' displayed in the repeat by section of the monthly recurrence pattern.
     * @meaning kendo.scheduler.recurrenceEditorWeekdaysWeekendday
     */ 
    const MSG_EXTERNAL_7054014236026062694$$DIST_FESM2015_INDEX_JS_121 = goog.getMsg("Weekend Day");
    I18N_120 = MSG_EXTERNAL_7054014236026062694$$DIST_FESM2015_INDEX_JS_121;
}
else {
    I18N_120 = $localize `:kendo.scheduler.recurrenceEditorWeekdaysWeekendday|The text similar to 'Weekend Day' displayed in the repeat by section of the monthly recurrence pattern.␟e77ed57c2a07d35094d021dce41e6917fd7922c9␟7054014236026062694:Weekend Day`;
}
var I18N_122;
if (typeof ngI18nClosureMode !== "undefined" && ngI18nClosureMode) {
    /**
     * @desc The text similar to 'After' displayed in the scheduler recurrence editor.
     * @meaning kendo.scheduler.recurrenceEditorEndAfter
     */ 
    const MSG_EXTERNAL_2097703021296390048$$DIST_FESM2015_INDEX_JS_123 = goog.getMsg("After");
    I18N_122 = MSG_EXTERNAL_2097703021296390048$$DIST_FESM2015_INDEX_JS_123;
}
else {
    I18N_122 = $localize `:kendo.scheduler.recurrenceEditorEndAfter|The text similar to 'After' displayed in the scheduler recurrence editor.␟827f090f4bcd1f8e6a845000a7498027b5a85cfc␟2097703021296390048:After`;
}
var I18N_124;
if (typeof ngI18nClosureMode !== "undefined" && ngI18nClosureMode) {
    /**
     * @desc The text similar to 'occurrence(s)' displayed in the scheduler recurrence editor.
     * @meaning kendo.scheduler.recurrenceEditorEndOccurrence
     */ 
    const MSG_EXTERNAL_1451056976548055926$$DIST_FESM2015_INDEX_JS_125 = goog.getMsg("occurrence(s)");
    I18N_124 = MSG_EXTERNAL_1451056976548055926$$DIST_FESM2015_INDEX_JS_125;
}
else {
    I18N_124 = $localize `:kendo.scheduler.recurrenceEditorEndOccurrence|The text similar to 'occurrence(s)' displayed in the scheduler recurrence editor.␟620365df1f319c842f25ca8cbd27c338063eefe7␟1451056976548055926:occurrence(s)`;
}
var I18N_126;
if (typeof ngI18nClosureMode !== "undefined" && ngI18nClosureMode) {
    /**
     * @desc The text similar to 'End' displayed in the scheduler recurrence editor.
     * @meaning kendo.scheduler.recurrenceEditorEndLabel
     */ 
    const MSG_EXTERNAL_5231487492500110340$$DIST_FESM2015_INDEX_JS_127 = goog.getMsg("End");
    I18N_126 = MSG_EXTERNAL_5231487492500110340$$DIST_FESM2015_INDEX_JS_127;
}
else {
    I18N_126 = $localize `:kendo.scheduler.recurrenceEditorEndLabel|The text similar to 'End' displayed in the scheduler recurrence editor.␟335767a9cc38a3e50fe8af40810efec20f9eab20␟5231487492500110340:End`;
}
var I18N_128;
if (typeof ngI18nClosureMode !== "undefined" && ngI18nClosureMode) {
    /**
     * @desc The text similar to 'Never' displayed in the scheduler recurrence editor.
     * @meaning kendo.scheduler.recurrenceEditorEndNever
     */ 
    const MSG_EXTERNAL_5437573022604353578$$DIST_FESM2015_INDEX_JS_129 = goog.getMsg("Never");
    I18N_128 = MSG_EXTERNAL_5437573022604353578$$DIST_FESM2015_INDEX_JS_129;
}
else {
    I18N_128 = $localize `:kendo.scheduler.recurrenceEditorEndNever|The text similar to 'Never' displayed in the scheduler recurrence editor.␟997d0ed8354147e84ea1175fad9ba2a9efc80caa␟5437573022604353578:Never`;
}
var I18N_130;
if (typeof ngI18nClosureMode !== "undefined" && ngI18nClosureMode) {
    /**
     * @desc The text similar to 'On' displayed in the scheduler recurrence editor.
     * @meaning kendo.scheduler.recurrenceEditorEndOn
     */ 
    const MSG_EXTERNAL_3682093993696692809$$DIST_FESM2015_INDEX_JS_131 = goog.getMsg("On");
    I18N_130 = MSG_EXTERNAL_3682093993696692809$$DIST_FESM2015_INDEX_JS_131;
}
else {
    I18N_130 = $localize `:kendo.scheduler.recurrenceEditorEndOn|The text similar to 'On' displayed in the scheduler recurrence editor.␟ef00f9208fcc3149d1fa32a9eda8afb5f37e3e02␟3682093993696692809:On`;
}
var I18N_132;
if (typeof ngI18nClosureMode !== "undefined" && ngI18nClosureMode) {
    /**
     * @desc The text of the 'Delete' button displayed in the scheduler remove confirmation dialog.
     * @meaning kendo.scheduler.destroy
     */ 
    const MSG_EXTERNAL_7253460703217602757$$DIST_FESM2015_INDEX_JS_133 = goog.getMsg("Delete");
    I18N_132 = MSG_EXTERNAL_7253460703217602757$$DIST_FESM2015_INDEX_JS_133;
}
else {
    I18N_132 = $localize `:kendo.scheduler.destroy|The text of the 'Delete' button displayed in the scheduler remove confirmation dialog.␟875ea861307672d789084939f4d51956587885f6␟7253460703217602757:Delete`;
}
var I18N_134;
if (typeof ngI18nClosureMode !== "undefined" && ngI18nClosureMode) {
    /**
     * @desc The text similar to 'Are you sure you want to delete this event?' displayed in scheduler remove confirmation dialog.
     * @meaning kendo.scheduler.deleteConfirmation
     */ 
    const MSG_EXTERNAL_5917959048626452273$$DIST_FESM2015_INDEX_JS_135 = goog.getMsg("Are you sure you want to delete this event?");
    I18N_134 = MSG_EXTERNAL_5917959048626452273$$DIST_FESM2015_INDEX_JS_135;
}
else {
    I18N_134 = $localize `:kendo.scheduler.deleteConfirmation|The text similar to 'Are you sure you want to delete this event?' displayed in scheduler remove confirmation dialog.␟20accdc4b9ee24a5d1c94221d05fa0cb71ee9b6b␟5917959048626452273:Are you sure you want to delete this event?`;
}
var I18N_136;
if (typeof ngI18nClosureMode !== "undefined" && ngI18nClosureMode) {
    /**
     * @desc The text similar to 'Do you want to edit only this event occurrence or the whole series?' displayed in the scheduler recurring confirmation dialog.
     * @meaning kendo.scheduler.editRecurringConfirmation
     */ 
    const MSG_EXTERNAL_1834554343916221051$$DIST_FESM2015_INDEX_JS_137 = goog.getMsg("Do you want to edit only this event occurrence or the whole series?");
    I18N_136 = MSG_EXTERNAL_1834554343916221051$$DIST_FESM2015_INDEX_JS_137;
}
else {
    I18N_136 = $localize `:kendo.scheduler.editRecurringConfirmation|The text similar to 'Do you want to edit only this event occurrence or the whole series?' displayed in the scheduler recurring confirmation dialog.␟e807f1ee07fc419c8a36e7ede511ac92c1142185␟1834554343916221051:Do you want to edit only this event occurrence or the whole series?`;
}
var I18N_138;
if (typeof ngI18nClosureMode !== "undefined" && ngI18nClosureMode) {
    /**
     * @desc The text of the 'Edit current occurrence' button displayed in the scheduler recurring confirmation dialog.
     * @meaning kendo.scheduler.editOccurrence
     */ 
    const MSG_EXTERNAL_8272351580358548563$$DIST_FESM2015_INDEX_JS_139 = goog.getMsg("Edit current occurrence");
    I18N_138 = MSG_EXTERNAL_8272351580358548563$$DIST_FESM2015_INDEX_JS_139;
}
else {
    I18N_138 = $localize `:kendo.scheduler.editOccurrence|The text of the 'Edit current occurrence' button displayed in the scheduler recurring confirmation dialog.␟ecc5321d8daa1a219287ce11b152f2f0122967b5␟8272351580358548563:Edit current occurrence`;
}
var I18N_140;
if (typeof ngI18nClosureMode !== "undefined" && ngI18nClosureMode) {
    /**
     * @desc The text of the 'Edit the series' button displayed in the scheduler recurring confirmation dialog.
     * @meaning kendo.scheduler.editSeries
     */ 
    const MSG_EXTERNAL_125777708095000773$$DIST_FESM2015_INDEX_JS_141 = goog.getMsg("Edit the series");
    I18N_140 = MSG_EXTERNAL_125777708095000773$$DIST_FESM2015_INDEX_JS_141;
}
else {
    I18N_140 = $localize `:kendo.scheduler.editSeries|The text of the 'Edit the series' button displayed in the scheduler recurring confirmation dialog.␟c5e428fad50c320e1cfbbd2ef597dcde755671b3␟125777708095000773:Edit the series`;
}
var I18N_142;
if (typeof ngI18nClosureMode !== "undefined" && ngI18nClosureMode) {
    /**
     * @desc The text similar to 'Do you want to delete only this event occurrence or the whole series?' displayed in the scheduler recurring confirmation dialog.
     * @meaning kendo.scheduler.deleteRecurringConfirmation
     */ 
    const MSG_EXTERNAL_3713756894071974624$$DIST_FESM2015_INDEX_JS_143 = goog.getMsg("Do you want to delete only this event occurrence or the whole series?");
    I18N_142 = MSG_EXTERNAL_3713756894071974624$$DIST_FESM2015_INDEX_JS_143;
}
else {
    I18N_142 = $localize `:kendo.scheduler.deleteRecurringConfirmation|The text similar to 'Do you want to delete only this event occurrence or the whole series?' displayed in the scheduler recurring confirmation dialog.␟5dcd0042184961bf24c6f7d0f7a2dcd21e146a00␟3713756894071974624:Do you want to delete only this event occurrence or the whole series?`;
}
var I18N_144;
if (typeof ngI18nClosureMode !== "undefined" && ngI18nClosureMode) {
    /**
     * @desc The text of the 'Delete current occurrence' button displayed in the scheduler recurring confirmation dialog.
     * @meaning kendo.scheduler.deleteOccurrence
     */ 
    const MSG_EXTERNAL_1748288149909224362$$DIST_FESM2015_INDEX_JS_145 = goog.getMsg("Delete current occurrence");
    I18N_144 = MSG_EXTERNAL_1748288149909224362$$DIST_FESM2015_INDEX_JS_145;
}
else {
    I18N_144 = $localize `:kendo.scheduler.deleteOccurrence|The text of the 'Delete current occurrence' button displayed in the scheduler recurring confirmation dialog.␟be085922c17b8f26ed6076c377a4b27e822b9b90␟1748288149909224362:Delete current occurrence`;
}
var I18N_146;
if (typeof ngI18nClosureMode !== "undefined" && ngI18nClosureMode) {
    /**
     * @desc The text similar of the 'Delete the series' button displayed in the scheduler recurring confirmation dialog.
     * @meaning kendo.scheduler.deleteSeries
     */ 
    const MSG_EXTERNAL_3833220248658630693$$DIST_FESM2015_INDEX_JS_147 = goog.getMsg("Delete the series");
    I18N_146 = MSG_EXTERNAL_3833220248658630693$$DIST_FESM2015_INDEX_JS_147;
}
else {
    I18N_146 = $localize `:kendo.scheduler.deleteSeries|The text similar of the 'Delete the series' button displayed in the scheduler recurring confirmation dialog.␟c586d733f2b6c2e6453eb56edc90305a33a082c2␟3833220248658630693:Delete the series`;
}
var I18N_148;
if (typeof ngI18nClosureMode !== "undefined" && ngI18nClosureMode) {
    /**
     * @desc The title of the remove confirmation dialog, similar to 'Delete Event'.
     * @meaning kendo.scheduler.deleteDialogTitle
     */ 
    const MSG_EXTERNAL_1567169606122407258$$DIST_FESM2015_INDEX_JS_149 = goog.getMsg("Delete Event");
    I18N_148 = MSG_EXTERNAL_1567169606122407258$$DIST_FESM2015_INDEX_JS_149;
}
else {
    I18N_148 = $localize `:kendo.scheduler.deleteDialogTitle|The title of the remove confirmation dialog, similar to 'Delete Event'.␟2884f479dc7ed9a2f6d7a0e1f31ac3cf36c8e5bd␟1567169606122407258:Delete Event`;
}
var I18N_150;
if (typeof ngI18nClosureMode !== "undefined" && ngI18nClosureMode) {
    /**
     * @desc The title of the recurring remove confirmation dialog, similar to 'Delete Recurring Item'
     * @meaning kendo.scheduler.deleteRecurringDialogTitle
     */ 
    const MSG_EXTERNAL_3767124003690482688$$DIST_FESM2015_INDEX_JS_151 = goog.getMsg("Delete Recurring Item");
    I18N_150 = MSG_EXTERNAL_3767124003690482688$$DIST_FESM2015_INDEX_JS_151;
}
else {
    I18N_150 = $localize `:kendo.scheduler.deleteRecurringDialogTitle|The title of the recurring remove confirmation dialog, similar to 'Delete Recurring Item'␟f1f8d324f5872adf6e5f000972aa484de5db5857␟3767124003690482688:Delete Recurring Item`;
}
var I18N_152;
if (typeof ngI18nClosureMode !== "undefined" && ngI18nClosureMode) {
    /**
     * @desc The title of the recurring edit confirmation dialog, similar to 'Edit Recurring Item'
     * @meaning kendo.scheduler.editRecurringDialogTitle
     */ 
    const MSG_EXTERNAL_6062715259991815291$$DIST_FESM2015_INDEX_JS_153 = goog.getMsg("Edit Recurring Item");
    I18N_152 = MSG_EXTERNAL_6062715259991815291$$DIST_FESM2015_INDEX_JS_153;
}
else {
    I18N_152 = $localize `:kendo.scheduler.editRecurringDialogTitle|The title of the recurring edit confirmation dialog, similar to 'Edit Recurring Item'␟72c6e48e403f55b0b42190d96dc013e2a359a92d␟6062715259991815291:Edit Recurring Item`;
}
const _c154 = ["allEvents", I18N_2, "allDay", I18N_4, "dateHeader", I18N_6, "timeHeader", I18N_8, "deleteTitle", I18N_10, "eventHeader", I18N_12, "nextTitle", I18N_14, "previousTitle", I18N_16, "showFullDay", I18N_18, "showWorkDay", I18N_20, "today", I18N_22, "calendarToday", I18N_24, "dayViewTitle", I18N_26, "multiDayViewTitle", I18N_28, "weekViewTitle", I18N_30, "workWeekViewTitle", I18N_32, "monthViewTitle", I18N_34, "timelineViewTitle", I18N_36, "timelineWeekViewTitle", I18N_38, "timelineMonthViewTitle", I18N_40, "agendaViewTitle", I18N_42, "cancel", I18N_44, "save", I18N_46, "editorEventTitle", I18N_48, "editorEventStart", I18N_50, "editorEventStartTimeZone", I18N_52, "editorEventEnd", I18N_54, "editorEventEndTimeZone", I18N_56, "editorEventAllDay", I18N_58, "editorEventDescription", I18N_60, "editorEventSeparateTimeZones", I18N_62, "editorEventTimeZone", I18N_64, "editorTitle", I18N_66, "recurrenceEditorRepeat", I18N_68, "recurrenceEditorDailyInterval", I18N_70, "recurrenceEditorDailyRepeatEvery", I18N_72, "recurrenceEditorWeeklyInterval", I18N_74, "recurrenceEditorWeeklyRepeatEvery", I18N_76, "recurrenceEditorWeeklyRepeatOn", I18N_78, "recurrenceEditorMonthlyDay", I18N_80, "recurrenceEditorMonthlyInterval", I18N_82, "recurrenceEditorMonthlyRepeatEvery", I18N_84, "recurrenceEditorMonthlyRepeatOn", I18N_86, "recurrenceEditorYearlyOf", I18N_88, "recurrenceEditorYearlyRepeatEvery", I18N_90, "recurrenceEditorYearlyRepeatOn", I18N_92, "recurrenceEditorYearlyInterval", I18N_94, "recurrenceEditorFrequenciesDaily", I18N_96, "recurrenceEditorFrequenciesMonthly", I18N_98, "recurrenceEditorFrequenciesNever", I18N_100, "recurrenceEditorFrequenciesWeekly", I18N_102, "recurrenceEditorFrequenciesYearly", I18N_104, "recurrenceEditorOffsetPositionsFirst", I18N_106, "recurrenceEditorOffsetPositionsSecond", I18N_108, "recurrenceEditorOffsetPositionsThird", I18N_110, "recurrenceEditorOffsetPositionsFourth", I18N_112, "recurrenceEditorOffsetPositionsLast", I18N_114, "recurrenceEditorWeekdaysDay", I18N_116, "recurrenceEditorWeekdaysWeekday", I18N_118, "recurrenceEditorWeekdaysWeekendday", I18N_120, "recurrenceEditorEndAfter", I18N_122, "recurrenceEditorEndOccurrence", I18N_124, "recurrenceEditorEndLabel", I18N_126, "recurrenceEditorEndNever", I18N_128, "recurrenceEditorEndOn", I18N_130, "destroy", I18N_132, "deleteConfirmation", I18N_134, "editRecurringConfirmation", I18N_136, "editOccurrence", I18N_138, "editSeries", I18N_140, "deleteRecurringConfirmation", I18N_142, "deleteOccurrence", I18N_144, "deleteSeries", I18N_146, "deleteDialogTitle", I18N_148, "deleteRecurringDialogTitle", I18N_150, "editRecurringDialogTitle", I18N_152];
function SchedulerComponent_ng_container_3_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementContainer(0);
} }
const _c155 = ["calendar"];
const _c156 = ["kendoSchedulerToolbarNavigation", ""];
function ToolbarNavigationComponent_ng_template_19_Template(rf, ctx) { if (rf & 1) {
    const _r5 = ɵngcc0.ɵɵgetCurrentView();
    ɵngcc0.ɵɵelementStart(0, "kendo-calendar", 12, 13);
    ɵngcc0.ɵɵlistener("blur", function ToolbarNavigationComponent_ng_template_19_Template_kendo_calendar_blur_0_listener() { ɵngcc0.ɵɵrestoreView(_r5); const ctx_r4 = ɵngcc0.ɵɵnextContext(); return ctx_r4.onBlur(); })("valueChange", function ToolbarNavigationComponent_ng_template_19_Template_kendo_calendar_valueChange_0_listener($event) { ɵngcc0.ɵɵrestoreView(_r5); const ctx_r6 = ɵngcc0.ɵɵnextContext(); return ctx_r6.selectDate($event); });
    ɵngcc0.ɵɵpipe(2, "async");
    ɵngcc0.ɵɵelement(3, "kendo-calendar-messages", 14);
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    const ctx_r2 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵproperty("value", ɵngcc0.ɵɵpipeBind1(2, 4, ctx_r2.ctx.selectedDate))("min", ctx_r2.min)("max", ctx_r2.max);
    ɵngcc0.ɵɵadvance(3);
    ɵngcc0.ɵɵproperty("today", ctx_r2.calendarTodayText);
} }
function ToolbarComponent_0_ng_template_0_Template(rf, ctx) { }
function ToolbarComponent_0_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵtemplate(0, ToolbarComponent_0_ng_template_0_Template, 0, 0, "ng-template", 2);
} if (rf & 2) {
    const ctx_r0 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵproperty("ngTemplateOutlet", ctx_r0.template.templateRef)("ngTemplateOutletContext", ctx_r0.templateContext);
} }
function ToolbarComponent_ng_template_1_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelement(0, "ul", 3);
    ɵngcc0.ɵɵelement(1, "ul", 4);
} if (rf & 2) {
    const ctx_r2 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵproperty("min", ctx_r2.min)("max", ctx_r2.max);
} }
const _c157 = ["kendoSchedulerToolbarViewSelector", ""];
const _c158 = function (a0) { return { click: a0 }; };
function ToolbarViewSelectorComponent_li_0_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementStart(0, "li", 2);
    ɵngcc0.ɵɵelementStart(1, "span", 3);
    ɵngcc0.ɵɵtext(2);
    ɵngcc0.ɵɵelementEnd();
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    const ctx_r0 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("kendoEventsOutsideAngular", ɵngcc0.ɵɵpureFunction1(3, _c158, ctx_r0.onCurrentViewClick))("scope", ctx_r0);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵtextInterpolate1(" ", ctx_r0.ctx.selectedView == null ? null : ctx_r0.ctx.selectedView.title, " ");
} }
const _c159 = function (a0) { return { display: a0 }; };
function ToolbarViewSelectorComponent_li_1_Template(rf, ctx) { if (rf & 1) {
    const _r4 = ɵngcc0.ɵɵgetCurrentView();
    ɵngcc0.ɵɵelementStart(0, "li", 4);
    ɵngcc0.ɵɵelementStart(1, "span", 5);
    ɵngcc0.ɵɵlistener("click", function ToolbarViewSelectorComponent_li_1_Template_span_click_1_listener() { ɵngcc0.ɵɵrestoreView(_r4); const view_r2 = ctx.$implicit; const ctx_r3 = ɵngcc0.ɵɵnextContext(); return ctx_r3.onClick(view_r2); });
    ɵngcc0.ɵɵtext(2);
    ɵngcc0.ɵɵelementEnd();
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    const view_r2 = ctx.$implicit;
    const ctx_r1 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵclassProp("k-state-selected", ctx_r1.isSelected(view_r2));
    ɵngcc0.ɵɵproperty("ngStyle", ɵngcc0.ɵɵpureFunction1(4, _c159, ctx_r1.itemDisplay));
    ɵngcc0.ɵɵadvance(2);
    ɵngcc0.ɵɵtextInterpolate1(" ", view_r2.title, " ");
} }
const _c160 = ["content"];
function AgendaViewComponent_ng_template_0_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelement(0, "agenda-view-internal", 1);
} if (rf & 2) {
    const ctx_r1 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵproperty("numberOfDays", ctx_r1.numberOfDays)("eventTemplate", ctx_r1.eventTemplate == null ? null : ctx_r1.eventTemplate.templateRef)("slotClass", ctx_r1.viewSlotClass)("eventClass", ctx_r1.viewEventClass)("eventStyles", ctx_r1.viewEventStyles)("agendaTimeTemplate", ctx_r1.agendaTimeTemplate == null ? null : ctx_r1.agendaTimeTemplate.templateRef)("agendaDateTemplate", ctx_r1.agendaDateTemplate == null ? null : ctx_r1.agendaDateTemplate.templateRef)("selectedDateFormat", ctx_r1.selectedDateFormat)("selectedShortDateFormat", ctx_r1.selectedShortDateFormat);
} }
const _c161 = ["kendoSchedulerAgendaHeaderItem", ""];
function AgendaHeaderItemComponent_ng_container_0_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementContainerStart(0);
    ɵngcc0.ɵɵelementStart(1, "strong", 2);
    ɵngcc0.ɵɵtext(2);
    ɵngcc0.ɵɵpipe(3, "kendoDate");
    ɵngcc0.ɵɵelementEnd();
    ɵngcc0.ɵɵelementStart(4, "em", 3);
    ɵngcc0.ɵɵtext(5);
    ɵngcc0.ɵɵpipe(6, "kendoDate");
    ɵngcc0.ɵɵelementEnd();
    ɵngcc0.ɵɵelementStart(7, "span", 4);
    ɵngcc0.ɵɵtext(8);
    ɵngcc0.ɵɵpipe(9, "kendoDate");
    ɵngcc0.ɵɵelementEnd();
    ɵngcc0.ɵɵelementContainerEnd();
} if (rf & 2) {
    const ctx_r0 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵadvance(2);
    ɵngcc0.ɵɵtextInterpolate(ɵngcc0.ɵɵpipeBind2(3, 3, ctx_r0.itemDate, "dd"));
    ɵngcc0.ɵɵadvance(3);
    ɵngcc0.ɵɵtextInterpolate(ɵngcc0.ɵɵpipeBind2(6, 6, ctx_r0.itemDate, "EEEE"));
    ɵngcc0.ɵɵadvance(3);
    ɵngcc0.ɵɵtextInterpolate(ɵngcc0.ɵɵpipeBind2(9, 9, ctx_r0.itemDate, "y"));
} }
const _c162 = function (a0) { return { date: a0 }; };
function AgendaHeaderItemComponent_ng_container_1_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementContainer(0, 5);
} if (rf & 2) {
    const ctx_r1 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵproperty("ngTemplateOutlet", ctx_r1.agendaDateTemplate)("ngTemplateOutletContext", ɵngcc0.ɵɵpureFunction1(2, _c162, ctx_r1.itemDate));
} }
const _c163 = ["kendoSchedulerAgendaHeader", ""];
function AgendaHeaderComponent_th_4_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelement(0, "th", 5);
} }
const _c164 = ["kendoSchedulerAgendaTaskItem", ""];
function AgendaTaskItemComponent_span_1_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelement(0, "span", 7);
} if (rf & 2) {
    const ctx_r0 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵstyleProp("background-color", ctx_r0.eventColor);
} }
function AgendaTaskItemComponent_span_2_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelement(0, "span", 8);
} }
function AgendaTaskItemComponent_span_3_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelement(0, "span", 9);
} }
function AgendaTaskItemComponent_ng_container_4_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementContainerStart(0);
    ɵngcc0.ɵɵtext(1);
    ɵngcc0.ɵɵelementContainerEnd();
} if (rf & 2) {
    const ctx_r3 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵtextInterpolate1(" ", ctx_r3.item == null ? null : ctx_r3.item.title, " ");
} }
const _c165 = function (a0, a1, a2) { return { $implicit: a0, event: a1, resources: a2 }; };
function AgendaTaskItemComponent_ng_container_5_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementContainer(0, 10);
} if (rf & 2) {
    const ctx_r4 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵproperty("ngTemplateOutlet", ctx_r4.eventTemplate)("ngTemplateOutletContext", ɵngcc0.ɵɵpureFunction3(2, _c165, ctx_r4.item.event, ctx_r4.item.event, ctx_r4.item.resources));
} }
function AgendaTaskItemComponent_span_6_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementStart(0, "span", 11);
    ɵngcc0.ɵɵelement(1, "span", 12);
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    const ctx_r5 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵattribute("title", ctx_r5.deleteMessage);
} }
const _c166 = ["kendoSchedulerAgendaList", ""];
function AgendaListComponent_ng_container_2_tr_1_ng_container_1_td_1_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementStart(0, "td", 9);
    ɵngcc0.ɵɵtext(1);
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    const ctx_r14 = ɵngcc0.ɵɵnextContext();
    const resourceIndex_r11 = ctx_r14.index;
    const resource_r10 = ctx_r14.$implicit;
    const group_r1 = ɵngcc0.ɵɵnextContext(2).$implicit;
    ɵngcc0.ɵɵattribute("rowspan", group_r1.spans[resourceIndex_r11]);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵtextInterpolate1(" ", resource_r10, " ");
} }
function AgendaListComponent_ng_container_2_tr_1_ng_container_1_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementContainerStart(0);
    ɵngcc0.ɵɵtemplate(1, AgendaListComponent_ng_container_2_tr_1_ng_container_1_td_1_Template, 2, 2, "td", 8);
    ɵngcc0.ɵɵelementContainerEnd();
} if (rf & 2) {
    const resourceIndex_r11 = ctx.index;
    const index_r5 = ɵngcc0.ɵɵnextContext().index;
    const group_r1 = ɵngcc0.ɵɵnextContext().$implicit;
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngIf", group_r1.spans[resourceIndex_r11] && index_r5 === 0);
} }
function AgendaListComponent_ng_container_2_tr_1_td_2_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelement(0, "td", 10);
} if (rf & 2) {
    const item_r4 = ɵngcc0.ɵɵnextContext().$implicit;
    const ctx_r7 = ɵngcc0.ɵɵnextContext(2);
    ɵngcc0.ɵɵproperty("kendoSchedulerAgendaHeaderItem", item_r4)("agendaDateTemplate", ctx_r7.agendaDateTemplate);
} }
function AgendaListComponent_ng_container_2_tr_1_div_4_span_1_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelement(0, "span", 13);
} }
function AgendaListComponent_ng_container_2_tr_1_div_4_span_3_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelement(0, "span", 14);
} }
function AgendaListComponent_ng_container_2_tr_1_div_4_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementStart(0, "div");
    ɵngcc0.ɵɵtemplate(1, AgendaListComponent_ng_container_2_tr_1_div_4_span_1_Template, 1, 0, "span", 11);
    ɵngcc0.ɵɵtext(2);
    ɵngcc0.ɵɵtemplate(3, AgendaListComponent_ng_container_2_tr_1_div_4_span_3_Template, 1, 0, "span", 12);
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    const item_r4 = ɵngcc0.ɵɵnextContext().$implicit;
    const ctx_r8 = ɵngcc0.ɵɵnextContext(2);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngIf", ctx_r8.extractDataItem(item_r4).tail);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵtextInterpolate1(" ", ctx_r8.formatTime(ctx_r8.extractDataItem(item_r4)), " ");
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngIf", ctx_r8.extractDataItem(item_r4).head);
} }
function AgendaListComponent_ng_container_2_tr_1_ng_container_5_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementContainer(0, 15);
} if (rf & 2) {
    const item_r4 = ɵngcc0.ɵɵnextContext().$implicit;
    const ctx_r9 = ɵngcc0.ɵɵnextContext(2);
    ɵngcc0.ɵɵproperty("ngTemplateOutlet", ctx_r9.agendaTimeTemplate)("ngTemplateOutletContext", ctx_r9.extractDataItem(item_r4));
} }
function AgendaListComponent_ng_container_2_tr_1_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementStart(0, "tr");
    ɵngcc0.ɵɵtemplate(1, AgendaListComponent_ng_container_2_tr_1_ng_container_1_Template, 2, 1, "ng-container", 1);
    ɵngcc0.ɵɵtemplate(2, AgendaListComponent_ng_container_2_tr_1_td_2_Template, 1, 2, "td", 3);
    ɵngcc0.ɵɵelementStart(3, "td", 4);
    ɵngcc0.ɵɵtemplate(4, AgendaListComponent_ng_container_2_tr_1_div_4_Template, 4, 3, "div", 5);
    ɵngcc0.ɵɵtemplate(5, AgendaListComponent_ng_container_2_tr_1_ng_container_5_Template, 1, 2, "ng-container", 6);
    ɵngcc0.ɵɵelementEnd();
    ɵngcc0.ɵɵelement(6, "td", 7);
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    const item_r4 = ctx.$implicit;
    const index_r5 = ctx.index;
    const ctx_r22 = ɵngcc0.ɵɵnextContext();
    const group_r1 = ctx_r22.$implicit;
    const groupIndex_r2 = ctx_r22.index;
    const ctx_r3 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngForOf", group_r1.resources);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngIf", item_r4.type === "group");
    ɵngcc0.ɵɵadvance(2);
    ɵngcc0.ɵɵproperty("ngIf", !ctx_r3.agendaTimeTemplate);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngIf", ctx_r3.agendaTimeTemplate);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngClass", ctx_r3.cellClasses(item_r4))("ngStyle", ctx_r3.getEventStyles(item_r4))("kendoSchedulerFocusIndex", groupIndex_r2)("kendoSchedulerAgendaTaskItem", ctx_r3.extractDataItem(item_r4))("editable", ctx_r3.editable)("eventTemplate", ctx_r3.eventTemplate);
    ɵngcc0.ɵɵattribute("data-group-index", groupIndex_r2)("data-task-index", index_r5);
} }
function AgendaListComponent_ng_container_2_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementContainerStart(0);
    ɵngcc0.ɵɵtemplate(1, AgendaListComponent_ng_container_2_tr_1_Template, 7, 12, "tr", 2);
    ɵngcc0.ɵɵelementContainerEnd();
} if (rf & 2) {
    const group_r1 = ctx.$implicit;
    const ctx_r0 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngForOf", group_r1.tasks)("ngForTrackBy", ctx_r0.trackByFn);
} }
const _c167 = ["headerWrap"];
const _c168 = ["monthViewItem", ""];
function MonthViewItemComponent_span_1_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelement(0, "span", 8);
} }
function MonthViewItemComponent_span_2_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelement(0, "span", 9);
} }
function MonthViewItemComponent_span_3_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelement(0, "span", 10);
} }
function MonthViewItemComponent_ng_container_4_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementContainer(0, 11);
} if (rf & 2) {
    const ctx_r3 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵproperty("ngTemplateOutlet", ctx_r3.eventTemplate)("ngTemplateOutletContext", ɵngcc0.ɵɵpureFunction3(2, _c165, ctx_r3.item.event, ctx_r3.item.event, ctx_r3.resources));
} }
function MonthViewItemComponent_div_5_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementStart(0, "div");
    ɵngcc0.ɵɵelementStart(1, "div", 12);
    ɵngcc0.ɵɵtext(2);
    ɵngcc0.ɵɵelementEnd();
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    const ctx_r4 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵattribute("title", ctx_r4.eventTitle);
    ɵngcc0.ɵɵadvance(2);
    ɵngcc0.ɵɵtextInterpolate(ctx_r4.item.event.title);
} }
function MonthViewItemComponent_span_7_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementStart(0, "span", 13);
    ɵngcc0.ɵɵelement(1, "span", 14);
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    const ctx_r5 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵattribute("title", ctx_r5.deleteMessage);
} }
function MonthViewItemComponent_span_8_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelement(0, "span", 15);
} }
function MonthViewItemComponent_ng_container_9_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementContainerStart(0);
    ɵngcc0.ɵɵelement(1, "span", 16);
    ɵngcc0.ɵɵelement(2, "span", 17);
    ɵngcc0.ɵɵelementContainerEnd();
} }
function MonthViewComponent_ng_template_0_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelement(0, "month-view", 1);
} if (rf & 2) {
    const ctx_r1 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵproperty("eventHeight", ctx_r1.viewEventHeight)("\u0435ventTemplate", ctx_r1.eventTemplate == null ? null : ctx_r1.eventTemplate.templateRef)("slotClass", ctx_r1.viewSlotClass)("eventClass", ctx_r1.viewEventClass)("eventStyles", ctx_r1.viewEventStyles)("groupHeaderTemplate", ctx_r1.groupHeaderTemplate == null ? null : ctx_r1.groupHeaderTemplate.templateRef)("monthDaySlotTemplate", ctx_r1.monthDaySlotTemplate == null ? null : ctx_r1.monthDaySlotTemplate.templateRef)("selectedDateFormat", ctx_r1.selectedDateFormat)("selectedShortDateFormat", ctx_r1.selectedShortDateFormat);
} }
const _c169 = ["header"];
const _c170 = ["contentTable"];
const _c171 = ["times"];
const _c172 = ["timesHeader"];
const _c173 = ["timesTable"];
const _c174 = ["hintContainer"];
function MonthViewRendererComponent_div_2_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementStart(0, "div", 15, 16);
    ɵngcc0.ɵɵelementStart(2, "table", 7);
    ɵngcc0.ɵɵelementStart(3, "tr");
    ɵngcc0.ɵɵelement(4, "th");
    ɵngcc0.ɵɵelementEnd();
    ɵngcc0.ɵɵelementEnd();
    ɵngcc0.ɵɵelementEnd();
} }
function MonthViewRendererComponent_tr_8_th_1_ng_container_1_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementContainerStart(0);
    ɵngcc0.ɵɵtext(1);
    ɵngcc0.ɵɵelementContainerEnd();
} if (rf & 2) {
    const item_r16 = ɵngcc0.ɵɵnextContext().$implicit;
    const resource_r13 = ɵngcc0.ɵɵnextContext().$implicit;
    const ctx_r17 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵtextInterpolate(ctx_r17.getField(item_r16, resource_r13.textField));
} }
const _c175 = function (a0) { return { resource: a0 }; };
function MonthViewRendererComponent_tr_8_th_1_ng_container_2_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementContainer(0, 21);
} if (rf & 2) {
    const item_r16 = ɵngcc0.ɵɵnextContext().$implicit;
    const ctx_r18 = ɵngcc0.ɵɵnextContext(2);
    ɵngcc0.ɵɵproperty("ngTemplateOutlet", ctx_r18.groupHeaderTemplateRef)("ngTemplateOutletContext", ɵngcc0.ɵɵpureFunction1(2, _c175, item_r16));
} }
function MonthViewRendererComponent_tr_8_th_1_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementStart(0, "th", 18);
    ɵngcc0.ɵɵtemplate(1, MonthViewRendererComponent_tr_8_th_1_ng_container_1_Template, 2, 1, "ng-container", 19);
    ɵngcc0.ɵɵtemplate(2, MonthViewRendererComponent_tr_8_th_1_ng_container_2_Template, 1, 4, "ng-container", 20);
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    const resourceIndex_r14 = ɵngcc0.ɵɵnextContext().index;
    const ctx_r15 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵattribute("colspan", ctx_r15.horizontalColspan(resourceIndex_r14));
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngIf", !ctx_r15.groupHeaderTemplateRef);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngIf", ctx_r15.groupHeaderTemplateRef);
} }
function MonthViewRendererComponent_tr_8_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementStart(0, "tr");
    ɵngcc0.ɵɵtemplate(1, MonthViewRendererComponent_tr_8_th_1_Template, 3, 3, "th", 17);
    ɵngcc0.ɵɵpipe(2, "resourceIterator");
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    const resourceIndex_r14 = ctx.index;
    const ctx_r3 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngForOf", ɵngcc0.ɵɵpipeBind2(2, 2, ctx_r3.horizontalResources, resourceIndex_r14))("ngForTrackBy", ctx_r3.itemIndex);
} }
function MonthViewRendererComponent_ng_container_10_th_1_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementStart(0, "th");
    ɵngcc0.ɵɵtext(1);
    ɵngcc0.ɵɵpipe(2, "kendoDate");
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    const day_r25 = ctx.$implicit;
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵtextInterpolate1(" ", ɵngcc0.ɵɵpipeBind2(2, 1, day_r25, "EEEE"), " ");
} }
function MonthViewRendererComponent_ng_container_10_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementContainerStart(0);
    ɵngcc0.ɵɵtemplate(1, MonthViewRendererComponent_ng_container_10_th_1_Template, 3, 4, "th", 8);
    ɵngcc0.ɵɵelementContainerEnd();
} if (rf & 2) {
    const ctx_r4 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngForOf", ctx_r4.weeks[0])("ngForTrackBy", ctx_r4.itemIndex);
} }
function MonthViewRendererComponent_div_13_ng_container_4_ng_container_2_th_1_ng_container_1_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementContainerStart(0);
    ɵngcc0.ɵɵtext(1);
    ɵngcc0.ɵɵelementContainerEnd();
} if (rf & 2) {
    const ctx_r39 = ɵngcc0.ɵɵnextContext(2);
    const resourceIndex_r34 = ctx_r39.index;
    const resource_r33 = ctx_r39.$implicit;
    const leafIndex_r30 = ɵngcc0.ɵɵnextContext().index;
    const ctx_r36 = ɵngcc0.ɵɵnextContext(2);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵtextInterpolate(ctx_r36.getField(ctx_r36.verticalItem(leafIndex_r30, resourceIndex_r34), resource_r33.textField));
} }
function MonthViewRendererComponent_div_13_ng_container_4_ng_container_2_th_1_ng_container_2_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementContainer(0, 21);
} if (rf & 2) {
    const resourceIndex_r34 = ɵngcc0.ɵɵnextContext(2).index;
    const leafIndex_r30 = ɵngcc0.ɵɵnextContext().index;
    const ctx_r37 = ɵngcc0.ɵɵnextContext(2);
    ɵngcc0.ɵɵproperty("ngTemplateOutlet", ctx_r37.groupHeaderTemplateRef)("ngTemplateOutletContext", ɵngcc0.ɵɵpureFunction1(2, _c175, ctx_r37.verticalItem(leafIndex_r30, resourceIndex_r34)));
} }
const _c176 = function (a0) { return { "k-last-resource": a0 }; };
function MonthViewRendererComponent_div_13_ng_container_4_ng_container_2_th_1_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementStart(0, "th", 27);
    ɵngcc0.ɵɵtemplate(1, MonthViewRendererComponent_div_13_ng_container_4_ng_container_2_th_1_ng_container_1_Template, 2, 1, "ng-container", 19);
    ɵngcc0.ɵɵtemplate(2, MonthViewRendererComponent_div_13_ng_container_4_ng_container_2_th_1_ng_container_2_Template, 1, 4, "ng-container", 20);
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    const resourceIndex_r34 = ɵngcc0.ɵɵnextContext().index;
    const ctx_r35 = ɵngcc0.ɵɵnextContext(3);
    ɵngcc0.ɵɵproperty("ngClass", ɵngcc0.ɵɵpureFunction1(4, _c176, resourceIndex_r34 === ctx_r35.verticalResources.length - 1));
    ɵngcc0.ɵɵattribute("rowspan", ctx_r35.verticalRowspan(resourceIndex_r34));
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngIf", !ctx_r35.groupHeaderTemplateRef);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngIf", ctx_r35.groupHeaderTemplateRef);
} }
function MonthViewRendererComponent_div_13_ng_container_4_ng_container_2_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementContainerStart(0);
    ɵngcc0.ɵɵtemplate(1, MonthViewRendererComponent_div_13_ng_container_4_ng_container_2_th_1_Template, 3, 6, "th", 26);
    ɵngcc0.ɵɵelementContainerEnd();
} if (rf & 2) {
    const resourceIndex_r34 = ctx.index;
    const leafIndex_r30 = ɵngcc0.ɵɵnextContext().index;
    const ctx_r31 = ɵngcc0.ɵɵnextContext(2);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngIf", ctx_r31.verticalItem(leafIndex_r30, resourceIndex_r34));
} }
function MonthViewRendererComponent_div_13_ng_container_4_tr_4_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementStart(0, "tr");
    ɵngcc0.ɵɵelement(1, "th", 25);
    ɵngcc0.ɵɵelementEnd();
} }
function MonthViewRendererComponent_div_13_ng_container_4_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementContainerStart(0);
    ɵngcc0.ɵɵelementStart(1, "tr");
    ɵngcc0.ɵɵtemplate(2, MonthViewRendererComponent_div_13_ng_container_4_ng_container_2_Template, 2, 1, "ng-container", 8);
    ɵngcc0.ɵɵelement(3, "th", 25);
    ɵngcc0.ɵɵelementEnd();
    ɵngcc0.ɵɵtemplate(4, MonthViewRendererComponent_div_13_ng_container_4_tr_4_Template, 2, 0, "tr", 8);
    ɵngcc0.ɵɵpipe(5, "repeat");
    ɵngcc0.ɵɵelementContainerEnd();
} if (rf & 2) {
    const ctx_r28 = ɵngcc0.ɵɵnextContext(2);
    ɵngcc0.ɵɵadvance(2);
    ɵngcc0.ɵɵproperty("ngForOf", ctx_r28.verticalResources)("ngForTrackBy", ctx_r28.itemIndex);
    ɵngcc0.ɵɵadvance(2);
    ɵngcc0.ɵɵproperty("ngForOf", ɵngcc0.ɵɵpipeBind1(5, 4, 5))("ngForTrackBy", ctx_r28.itemIndex);
} }
function MonthViewRendererComponent_div_13_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementStart(0, "div", 22, 23);
    ɵngcc0.ɵɵelementStart(2, "table", 7, 24);
    ɵngcc0.ɵɵtemplate(4, MonthViewRendererComponent_div_13_ng_container_4_Template, 6, 6, "ng-container", 8);
    ɵngcc0.ɵɵpipe(5, "resourceIterator");
    ɵngcc0.ɵɵelementEnd();
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    const ctx_r5 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵadvance(4);
    ɵngcc0.ɵɵproperty("ngForOf", ɵngcc0.ɵɵpipeBind1(5, 2, ctx_r5.verticalResources))("ngForTrackBy", ctx_r5.itemIndex);
} }
function MonthViewRendererComponent_ng_container_18_tr_1_ng_container_1_td_1_span_1_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementStart(0, "span", 31);
    ɵngcc0.ɵɵtext(1);
    ɵngcc0.ɵɵpipe(2, "kendoDate");
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    const day_r54 = ɵngcc0.ɵɵnextContext().$implicit;
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵtextInterpolate(ɵngcc0.ɵɵpipeBind2(2, 1, day_r54, "dd"));
} }
const _c177 = function (a0, a1) { return { date: a0, resources: a1 }; };
function MonthViewRendererComponent_ng_container_18_tr_1_ng_container_1_td_1_ng_container_2_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementContainer(0, 21);
} if (rf & 2) {
    const day_r54 = ɵngcc0.ɵɵnextContext().$implicit;
    const horizontalIndex_r52 = ɵngcc0.ɵɵnextContext().index;
    const verticalIndex_r46 = ɵngcc0.ɵɵnextContext(2).index;
    const ctx_r57 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵproperty("ngTemplateOutlet", ctx_r57.monthDaySlotTemplateRef)("ngTemplateOutletContext", ɵngcc0.ɵɵpureFunction2(2, _c177, day_r54, ctx_r57.resourcesByIndex(ctx_r57.verticalResources.length ? verticalIndex_r46 : horizontalIndex_r52)));
} }
const _c178 = function (a0, a1, a2) { return { resourceIndex: a0, rangeIndex: a1, index: a2 }; };
function MonthViewRendererComponent_ng_container_18_tr_1_ng_container_1_td_1_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementStart(0, "td", 29);
    ɵngcc0.ɵɵtemplate(1, MonthViewRendererComponent_ng_container_18_tr_1_ng_container_1_td_1_span_1_Template, 3, 4, "span", 30);
    ɵngcc0.ɵɵtemplate(2, MonthViewRendererComponent_ng_container_18_tr_1_ng_container_1_td_1_ng_container_2_Template, 1, 5, "ng-container", 20);
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    const day_r54 = ctx.$implicit;
    const index_r55 = ctx.index;
    const horizontalIndex_r52 = ɵngcc0.ɵɵnextContext().index;
    const rangeIndex_r49 = ɵngcc0.ɵɵnextContext().index;
    const verticalIndex_r46 = ɵngcc0.ɵɵnextContext().index;
    const ctx_r53 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵproperty("ngClass", ctx_r53.daySlotClass(day_r54, ctx_r53.verticalResources.length ? verticalIndex_r46 : horizontalIndex_r52))("start", day_r54)("id", ɵngcc0.ɵɵpureFunction3(5, _c178, ctx_r53.verticalResources.length ? verticalIndex_r46 : horizontalIndex_r52, rangeIndex_r49, index_r55));
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngIf", !ctx_r53.monthDaySlotTemplateRef);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngIf", ctx_r53.monthDaySlotTemplateRef);
} }
function MonthViewRendererComponent_ng_container_18_tr_1_ng_container_1_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementContainerStart(0);
    ɵngcc0.ɵɵtemplate(1, MonthViewRendererComponent_ng_container_18_tr_1_ng_container_1_td_1_Template, 3, 9, "td", 28);
    ɵngcc0.ɵɵelementContainerEnd();
} if (rf & 2) {
    const week_r48 = ɵngcc0.ɵɵnextContext().$implicit;
    const ctx_r50 = ɵngcc0.ɵɵnextContext(2);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngForOf", week_r48)("ngForTrackBy", ctx_r50.itemIndex);
} }
function MonthViewRendererComponent_ng_container_18_tr_1_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementStart(0, "tr");
    ɵngcc0.ɵɵtemplate(1, MonthViewRendererComponent_ng_container_18_tr_1_ng_container_1_Template, 2, 2, "ng-container", 8);
    ɵngcc0.ɵɵpipe(2, "resourceIterator");
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    const ctx_r47 = ɵngcc0.ɵɵnextContext(2);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngForOf", ɵngcc0.ɵɵpipeBind1(2, 2, ctx_r47.horizontalResources))("ngForTrackBy", ctx_r47.itemIndex);
} }
function MonthViewRendererComponent_ng_container_18_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementContainerStart(0);
    ɵngcc0.ɵɵtemplate(1, MonthViewRendererComponent_ng_container_18_tr_1_Template, 3, 4, "tr", 8);
    ɵngcc0.ɵɵelementContainerEnd();
} if (rf & 2) {
    const ctx_r8 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngForOf", ctx_r8.weeks)("ngForTrackBy", ctx_r8.itemIndex);
} }
function MonthViewRendererComponent_ng_container_20_div_1_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelement(0, "div", 33);
} if (rf & 2) {
    const itemResource_r68 = ctx.$implicit;
    const item_r66 = ɵngcc0.ɵɵnextContext().$implicit;
    const ctx_r67 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵproperty("ngClass", ctx_r67.getEventClasses(item_r66, itemResource_r68.resources))("ngStyle", ctx_r67.getEventStyles(item_r66, itemResource_r68))("kendoSchedulerFocusIndex", itemResource_r68.leafIdx)("editable", ctx_r67.editable)("item", item_r66)("index", item_r66.index)("rangeIndex", item_r66.rangeIndex)("eventTemplate", ctx_r67.eventTemplateRef)("resources", itemResource_r68.resources)("resourceIndex", itemResource_r68.leafIdx);
} }
function MonthViewRendererComponent_ng_container_20_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementContainerStart(0);
    ɵngcc0.ɵɵtemplate(1, MonthViewRendererComponent_ng_container_20_div_1_Template, 1, 10, "div", 32);
    ɵngcc0.ɵɵelementContainerEnd();
} if (rf & 2) {
    const item_r66 = ctx.$implicit;
    const ctx_r9 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngForOf", item_r66.resources)("ngForTrackBy", ctx_r9.itemIndex);
} }
function MonthViewRendererComponent_ng_template_24_div_0_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelement(0, "div", 36);
} if (rf & 2) {
    const hint_r72 = ctx.$implicit;
    const ctx_r70 = ɵngcc0.ɵɵnextContext(2);
    ɵngcc0.ɵɵproperty("ngStyle", hint_r72.style)("ngClass", hint_r72.class)("dragHint", true)("eventTemplate", ctx_r70.eventTemplateRef)("item", hint_r72.item)("resources", hint_r72.resources);
} }
function MonthViewRendererComponent_ng_template_24_div_1_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelement(0, "div", 37);
} if (rf & 2) {
    const hint_r73 = ctx.$implicit;
    const ctx_r71 = ɵngcc0.ɵɵnextContext(2);
    ɵngcc0.ɵɵproperty("hint", hint_r73)("ngClass", hint_r73.class)("format", ctx_r71.resizeHintFormat);
} }
function MonthViewRendererComponent_ng_template_24_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵtemplate(0, MonthViewRendererComponent_ng_template_24_div_0_Template, 1, 6, "div", 34);
    ɵngcc0.ɵɵtemplate(1, MonthViewRendererComponent_ng_template_24_div_1_Template, 1, 3, "div", 35);
} if (rf & 2) {
    const ctx_r11 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵproperty("ngForOf", ctx_r11.dragHints)("ngForTrackBy", ctx_r11.itemIndex);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngForOf", ctx_r11.resizeHints)("ngForTrackBy", ctx_r11.itemIndex);
} }
const _c179 = ["viewFooter", ""];
function ViewFooterComponent_li_1_Template(rf, ctx) { if (rf & 1) {
    const _r3 = ɵngcc0.ɵɵgetCurrentView();
    ɵngcc0.ɵɵelementStart(0, "li", 2);
    ɵngcc0.ɵɵlistener("click", function ViewFooterComponent_li_1_Template_li_click_0_listener($event) { ɵngcc0.ɵɵrestoreView(_r3); const item_r1 = ctx.$implicit; const ctx_r2 = ɵngcc0.ɵɵnextContext(); return ctx_r2.onItemClick($event, item_r1); });
    ɵngcc0.ɵɵelementStart(1, "a", 3);
    ɵngcc0.ɵɵelement(2, "span", 4);
    ɵngcc0.ɵɵtext(3);
    ɵngcc0.ɵɵelementEnd();
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    const item_r1 = ctx.$implicit;
    ɵngcc0.ɵɵproperty("ngClass", item_r1.cssClass);
    ɵngcc0.ɵɵadvance(2);
    ɵngcc0.ɵɵproperty("ngClass", item_r1.iconClass);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵtextInterpolate1(" ", item_r1.text, " ");
} }
const _c180 = ["kendoResizeHint", ""];
function ResizeHintComponent_div_2_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementStart(0, "div", 4);
    ɵngcc0.ɵɵtext(1);
    ɵngcc0.ɵɵpipe(2, "kendoDate");
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    const ctx_r0 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵtextInterpolate(ɵngcc0.ɵɵpipeBind2(2, 1, ctx_r0.start, ctx_r0.format));
} }
function ResizeHintComponent_div_3_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementStart(0, "div", 5);
    ɵngcc0.ɵɵtext(1);
    ɵngcc0.ɵɵpipe(2, "kendoDate");
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    const ctx_r1 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵtextInterpolate(ɵngcc0.ɵɵpipeBind2(2, 1, ctx_r1.end, ctx_r1.format));
} }
function DayViewComponent_ng_template_0_Template(rf, ctx) { if (rf & 1) {
    const _r3 = ɵngcc0.ɵɵgetCurrentView();
    ɵngcc0.ɵɵelement(0, "multi-day-view", 1);
    ɵngcc0.ɵɵelementStart(1, "div", 2);
    ɵngcc0.ɵɵlistener("itemClick", function DayViewComponent_ng_template_0_Template_div_itemClick_1_listener() { ɵngcc0.ɵɵrestoreView(_r3); const ctx_r2 = ɵngcc0.ɵɵnextContext(); return ctx_r2.showWorkHours = !ctx_r2.shouldShowWorkHours; });
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    const ctx_r1 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵproperty("name", ctx_r1.name)("eventHeight", ctx_r1.viewEventHeight)("currentTimeMarker", ctx_r1.viewCurrentTimeMarker)("showWorkHours", ctx_r1.shouldShowWorkHours)("scrollTime", ctx_r1.viewScrollTime)("startTime", ctx_r1.viewStartTime)("endTime", ctx_r1.viewEndTime)("workDayStart", ctx_r1.viewWorkDayStart)("workDayEnd", ctx_r1.viewWorkDayEnd)("workWeekStart", ctx_r1.viewWorkWeekStart)("workWeekEnd", ctx_r1.viewWorkWeekEnd)("slotDuration", ctx_r1.viewSlotDuration)("slotDivisions", ctx_r1.viewSlotDivisions)("slotFill", ctx_r1.viewSlotFill)("slotClass", ctx_r1.viewSlotClass)("eventClass", ctx_r1.viewEventClass)("eventStyles", ctx_r1.viewEventStyles)("allDaySlotTemplate", ctx_r1.allDaySlotTemplate == null ? null : ctx_r1.allDaySlotTemplate.templateRef)("allDayEventTemplate", ctx_r1.allDayEventTemplate == null ? null : ctx_r1.allDayEventTemplate.templateRef)("\u0435ventTemplate", ctx_r1.eventTemplate == null ? null : ctx_r1.eventTemplate.templateRef)("groupHeaderTemplate", ctx_r1.groupHeaderTemplate == null ? null : ctx_r1.groupHeaderTemplate.templateRef)("timeSlotTemplate", ctx_r1.timeSlotTemplate == null ? null : ctx_r1.timeSlotTemplate.templateRef)("minorTimeHeaderTemplate", ctx_r1.minorTimeHeaderTemplate == null ? null : ctx_r1.minorTimeHeaderTemplate.templateRef)("majorTimeHeaderTemplate", ctx_r1.majorTimeHeaderTemplate == null ? null : ctx_r1.majorTimeHeaderTemplate.templateRef)("dateHeaderTemplate", ctx_r1.dateHeaderTemplate == null ? null : ctx_r1.dateHeaderTemplate.templateRef)("selectedDateFormat", ctx_r1.selectedDateFormat)("selectedShortDateFormat", ctx_r1.selectedShortDateFormat);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("showWorkHours", ctx_r1.shouldShowWorkHours);
} }
function MultiDayViewComponent_ng_template_0_Template(rf, ctx) { if (rf & 1) {
    const _r3 = ɵngcc0.ɵɵgetCurrentView();
    ɵngcc0.ɵɵelement(0, "multi-day-view", 1);
    ɵngcc0.ɵɵelementStart(1, "div", 2);
    ɵngcc0.ɵɵlistener("itemClick", function MultiDayViewComponent_ng_template_0_Template_div_itemClick_1_listener() { ɵngcc0.ɵɵrestoreView(_r3); const ctx_r2 = ɵngcc0.ɵɵnextContext(); return ctx_r2.showWorkHours = !ctx_r2.shouldShowWorkHours; });
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    const ctx_r1 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵproperty("name", ctx_r1.name)("numberOfDays", ctx_r1.numberOfDays)("eventHeight", ctx_r1.viewEventHeight)("currentTimeMarker", ctx_r1.viewCurrentTimeMarker)("showWorkHours", ctx_r1.shouldShowWorkHours)("scrollTime", ctx_r1.viewScrollTime)("startTime", ctx_r1.viewStartTime)("endTime", ctx_r1.viewEndTime)("workDayStart", ctx_r1.viewWorkDayStart)("workDayEnd", ctx_r1.viewWorkDayEnd)("workWeekStart", ctx_r1.viewWorkWeekStart)("workWeekEnd", ctx_r1.viewWorkWeekEnd)("slotDuration", ctx_r1.viewSlotDuration)("slotDivisions", ctx_r1.viewSlotDivisions)("slotFill", ctx_r1.viewSlotFill)("slotClass", ctx_r1.viewSlotClass)("eventClass", ctx_r1.viewEventClass)("eventStyles", ctx_r1.viewEventStyles)("allDaySlotTemplate", ctx_r1.allDaySlotTemplate == null ? null : ctx_r1.allDaySlotTemplate.templateRef)("allDayEventTemplate", ctx_r1.allDayEventTemplate == null ? null : ctx_r1.allDayEventTemplate.templateRef)("\u0435ventTemplate", ctx_r1.eventTemplate == null ? null : ctx_r1.eventTemplate.templateRef)("groupHeaderTemplate", ctx_r1.groupHeaderTemplate == null ? null : ctx_r1.groupHeaderTemplate.templateRef)("timeSlotTemplate", ctx_r1.timeSlotTemplate == null ? null : ctx_r1.timeSlotTemplate.templateRef)("minorTimeHeaderTemplate", ctx_r1.minorTimeHeaderTemplate == null ? null : ctx_r1.minorTimeHeaderTemplate.templateRef)("majorTimeHeaderTemplate", ctx_r1.majorTimeHeaderTemplate == null ? null : ctx_r1.majorTimeHeaderTemplate.templateRef)("dateHeaderTemplate", ctx_r1.dateHeaderTemplate == null ? null : ctx_r1.dateHeaderTemplate.templateRef)("selectedDateFormat", ctx_r1.selectedDateFormat)("selectedShortDateFormat", ctx_r1.selectedShortDateFormat);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("showWorkHours", ctx_r1.shouldShowWorkHours);
} }
function WeekViewComponent_ng_template_0_Template(rf, ctx) { if (rf & 1) {
    const _r3 = ɵngcc0.ɵɵgetCurrentView();
    ɵngcc0.ɵɵelement(0, "multi-day-view", 1);
    ɵngcc0.ɵɵelementStart(1, "div", 2);
    ɵngcc0.ɵɵlistener("itemClick", function WeekViewComponent_ng_template_0_Template_div_itemClick_1_listener() { ɵngcc0.ɵɵrestoreView(_r3); const ctx_r2 = ɵngcc0.ɵɵnextContext(); return ctx_r2.showWorkHours = !ctx_r2.shouldShowWorkHours; });
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    const ctx_r1 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵproperty("name", ctx_r1.name)("numberOfDays", 7)("getStartDate", ctx_r1.getStartDate)("eventHeight", ctx_r1.viewEventHeight)("currentTimeMarker", ctx_r1.viewCurrentTimeMarker)("showWorkHours", ctx_r1.shouldShowWorkHours)("scrollTime", ctx_r1.viewScrollTime)("startTime", ctx_r1.viewStartTime)("endTime", ctx_r1.viewEndTime)("workDayStart", ctx_r1.viewWorkDayStart)("workDayEnd", ctx_r1.viewWorkDayEnd)("workWeekStart", ctx_r1.viewWorkWeekStart)("workWeekEnd", ctx_r1.viewWorkWeekEnd)("slotDuration", ctx_r1.viewSlotDuration)("slotDivisions", ctx_r1.viewSlotDivisions)("slotFill", ctx_r1.viewSlotFill)("slotClass", ctx_r1.viewSlotClass)("eventClass", ctx_r1.viewEventClass)("eventStyles", ctx_r1.viewEventStyles)("allDaySlotTemplate", ctx_r1.allDaySlotTemplate == null ? null : ctx_r1.allDaySlotTemplate.templateRef)("allDayEventTemplate", ctx_r1.allDayEventTemplate == null ? null : ctx_r1.allDayEventTemplate.templateRef)("\u0435ventTemplate", ctx_r1.eventTemplate == null ? null : ctx_r1.eventTemplate.templateRef)("groupHeaderTemplate", ctx_r1.groupHeaderTemplate == null ? null : ctx_r1.groupHeaderTemplate.templateRef)("timeSlotTemplate", ctx_r1.timeSlotTemplate == null ? null : ctx_r1.timeSlotTemplate.templateRef)("minorTimeHeaderTemplate", ctx_r1.minorTimeHeaderTemplate == null ? null : ctx_r1.minorTimeHeaderTemplate.templateRef)("majorTimeHeaderTemplate", ctx_r1.majorTimeHeaderTemplate == null ? null : ctx_r1.majorTimeHeaderTemplate.templateRef)("dateHeaderTemplate", ctx_r1.dateHeaderTemplate == null ? null : ctx_r1.dateHeaderTemplate.templateRef)("selectedDateFormat", ctx_r1.selectedDateFormat)("selectedShortDateFormat", ctx_r1.selectedShortDateFormat);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("showWorkHours", ctx_r1.shouldShowWorkHours);
} }
function WorkWeekViewComponent_ng_template_0_Template(rf, ctx) { if (rf & 1) {
    const _r3 = ɵngcc0.ɵɵgetCurrentView();
    ɵngcc0.ɵɵelement(0, "multi-day-view", 1);
    ɵngcc0.ɵɵelementStart(1, "div", 2);
    ɵngcc0.ɵɵlistener("itemClick", function WorkWeekViewComponent_ng_template_0_Template_div_itemClick_1_listener() { ɵngcc0.ɵɵrestoreView(_r3); const ctx_r2 = ɵngcc0.ɵɵnextContext(); return ctx_r2.showWorkHours = !ctx_r2.shouldShowWorkHours; });
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    const ctx_r1 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵproperty("name", ctx_r1.name)("numberOfDays", ctx_r1.numberOfDays)("getStartDate", ctx_r1.getStartDate)("getNextDate", ctx_r1.getNextDate)("eventHeight", ctx_r1.viewEventHeight)("currentTimeMarker", ctx_r1.viewCurrentTimeMarker)("showWorkHours", ctx_r1.shouldShowWorkHours)("scrollTime", ctx_r1.viewScrollTime)("startTime", ctx_r1.viewStartTime)("endTime", ctx_r1.viewEndTime)("workDayStart", ctx_r1.viewWorkDayStart)("workDayEnd", ctx_r1.viewWorkDayEnd)("workWeekStart", ctx_r1.viewWorkWeekStart)("workWeekEnd", ctx_r1.viewWorkWeekEnd)("slotDuration", ctx_r1.viewSlotDuration)("slotDivisions", ctx_r1.viewSlotDivisions)("slotFill", ctx_r1.viewSlotFill)("slotClass", ctx_r1.viewSlotClass)("eventClass", ctx_r1.viewEventClass)("eventStyles", ctx_r1.viewEventStyles)("allDaySlotTemplate", ctx_r1.allDaySlotTemplate == null ? null : ctx_r1.allDaySlotTemplate.templateRef)("allDayEventTemplate", ctx_r1.allDayEventTemplate == null ? null : ctx_r1.allDayEventTemplate.templateRef)("\u0435ventTemplate", ctx_r1.eventTemplate == null ? null : ctx_r1.eventTemplate.templateRef)("groupHeaderTemplate", ctx_r1.groupHeaderTemplate == null ? null : ctx_r1.groupHeaderTemplate.templateRef)("timeSlotTemplate", ctx_r1.timeSlotTemplate == null ? null : ctx_r1.timeSlotTemplate.templateRef)("minorTimeHeaderTemplate", ctx_r1.minorTimeHeaderTemplate == null ? null : ctx_r1.minorTimeHeaderTemplate.templateRef)("majorTimeHeaderTemplate", ctx_r1.majorTimeHeaderTemplate == null ? null : ctx_r1.majorTimeHeaderTemplate.templateRef)("dateHeaderTemplate", ctx_r1.dateHeaderTemplate == null ? null : ctx_r1.dateHeaderTemplate.templateRef)("selectedDateFormat", ctx_r1.selectedDateFormat)("selectedShortDateFormat", ctx_r1.selectedShortDateFormat);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("showWorkHours", ctx_r1.shouldShowWorkHours);
} }
const _c181 = ["currentTimeMarker"];
const _c182 = ["currentTimeArrow"];
const _c183 = ["headerHintContainer"];
const _c184 = ["allDayCell"];
function MultiDayViewRendererComponent_tr_5_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementStart(0, "tr");
    ɵngcc0.ɵɵelement(1, "th");
    ɵngcc0.ɵɵelementEnd();
} }
function MultiDayViewRendererComponent_tr_9_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementStart(0, "tr");
    ɵngcc0.ɵɵelementStart(1, "th", 19, 20);
    ɵngcc0.ɵɵtext(3);
    ɵngcc0.ɵɵelementEnd();
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    const ctx_r2 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵadvance(3);
    ɵngcc0.ɵɵtextInterpolate(ctx_r2.allDayMessage);
} }
function MultiDayViewRendererComponent_tr_15_th_1_ng_container_1_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementContainerStart(0);
    ɵngcc0.ɵɵtext(1);
    ɵngcc0.ɵɵelementContainerEnd();
} if (rf & 2) {
    const item_r25 = ɵngcc0.ɵɵnextContext().$implicit;
    const resource_r22 = ɵngcc0.ɵɵnextContext().$implicit;
    const ctx_r26 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵtextInterpolate(ctx_r26.getField(item_r25, resource_r22.textField));
} }
function MultiDayViewRendererComponent_tr_15_th_1_ng_container_2_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementContainer(0, 24);
} if (rf & 2) {
    const item_r25 = ɵngcc0.ɵɵnextContext().$implicit;
    const ctx_r27 = ɵngcc0.ɵɵnextContext(2);
    ɵngcc0.ɵɵproperty("ngTemplateOutlet", ctx_r27.groupHeaderTemplateRef)("ngTemplateOutletContext", ɵngcc0.ɵɵpureFunction1(2, _c175, item_r25));
} }
function MultiDayViewRendererComponent_tr_15_th_1_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementStart(0, "th", 22);
    ɵngcc0.ɵɵtemplate(1, MultiDayViewRendererComponent_tr_15_th_1_ng_container_1_Template, 2, 1, "ng-container", 6);
    ɵngcc0.ɵɵtemplate(2, MultiDayViewRendererComponent_tr_15_th_1_ng_container_2_Template, 1, 4, "ng-container", 23);
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    const resourceIndex_r23 = ɵngcc0.ɵɵnextContext().index;
    const ctx_r24 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵattribute("colspan", ctx_r24.horizontalColspan(resourceIndex_r23));
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngIf", !ctx_r24.groupHeaderTemplateRef);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngIf", ctx_r24.groupHeaderTemplateRef);
} }
function MultiDayViewRendererComponent_tr_15_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementStart(0, "tr");
    ɵngcc0.ɵɵtemplate(1, MultiDayViewRendererComponent_tr_15_th_1_Template, 3, 3, "th", 21);
    ɵngcc0.ɵɵpipe(2, "resourceIterator");
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    const resourceIndex_r23 = ctx.index;
    const ctx_r5 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngForOf", ɵngcc0.ɵɵpipeBind2(2, 2, ctx_r5.horizontalResources, resourceIndex_r23))("ngForTrackBy", ctx_r5.itemIndex);
} }
function MultiDayViewRendererComponent_ng_container_17_th_1_span_1_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementStart(0, "span", 26);
    ɵngcc0.ɵɵtext(1);
    ɵngcc0.ɵɵpipe(2, "kendoDate");
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    const ctx_r38 = ɵngcc0.ɵɵnextContext();
    const index_r35 = ctx_r38.index;
    const slot_r34 = ctx_r38.$implicit;
    const ctx_r36 = ɵngcc0.ɵɵnextContext(2);
    ɵngcc0.ɵɵattribute("data-dayslot-index", index_r35);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵtextInterpolate(ɵngcc0.ɵɵpipeBind2(2, 2, slot_r34.start, ctx_r36.dateFormat));
} }
function MultiDayViewRendererComponent_ng_container_17_th_1_ng_container_2_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementContainer(0, 24);
} if (rf & 2) {
    const slot_r34 = ɵngcc0.ɵɵnextContext().$implicit;
    const ctx_r37 = ɵngcc0.ɵɵnextContext(2);
    ɵngcc0.ɵɵproperty("ngTemplateOutlet", ctx_r37.dateHeaderTemplateRef)("ngTemplateOutletContext", ɵngcc0.ɵɵpureFunction1(2, _c162, slot_r34.start));
} }
function MultiDayViewRendererComponent_ng_container_17_th_1_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementStart(0, "th");
    ɵngcc0.ɵɵtemplate(1, MultiDayViewRendererComponent_ng_container_17_th_1_span_1_Template, 3, 5, "span", 25);
    ɵngcc0.ɵɵtemplate(2, MultiDayViewRendererComponent_ng_container_17_th_1_ng_container_2_Template, 1, 4, "ng-container", 23);
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    const ctx_r33 = ɵngcc0.ɵɵnextContext(2);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngIf", !ctx_r33.dateHeaderTemplateRef);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngIf", ctx_r33.dateHeaderTemplateRef);
} }
function MultiDayViewRendererComponent_ng_container_17_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementContainerStart(0);
    ɵngcc0.ɵɵtemplate(1, MultiDayViewRendererComponent_ng_container_17_th_1_Template, 3, 2, "th", 5);
    ɵngcc0.ɵɵelementContainerEnd();
} if (rf & 2) {
    const ctx_r6 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngForOf", ctx_r6.daySlots)("ngForTrackBy", ctx_r6.itemIndex);
} }
function MultiDayViewRendererComponent_div_19_ng_container_3_td_1_ng_container_1_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementContainer(0, 24);
} if (rf & 2) {
    const slot_r47 = ɵngcc0.ɵɵnextContext().$implicit;
    const resourceIndex_r45 = ɵngcc0.ɵɵnextContext().index;
    const ctx_r49 = ɵngcc0.ɵɵnextContext(2);
    ɵngcc0.ɵɵproperty("ngTemplateOutlet", ctx_r49.allDaySlotTemplateRef)("ngTemplateOutletContext", ɵngcc0.ɵɵpureFunction2(2, _c177, slot_r47.start, ctx_r49.resourcesByIndex(resourceIndex_r45)));
} }
const _c185 = function (a0, a2) { return { resourceIndex: a0, rangeIndex: 0, index: a2 }; };
function MultiDayViewRendererComponent_div_19_ng_container_3_td_1_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementStart(0, "td", 31);
    ɵngcc0.ɵɵtemplate(1, MultiDayViewRendererComponent_div_19_ng_container_3_td_1_ng_container_1_Template, 1, 5, "ng-container", 23);
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    const slot_r47 = ctx.$implicit;
    const index_r48 = ctx.index;
    const resourceIndex_r45 = ɵngcc0.ɵɵnextContext().index;
    const ctx_r46 = ɵngcc0.ɵɵnextContext(2);
    ɵngcc0.ɵɵproperty("start", slot_r47.start)("end", slot_r47.end)("id", ɵngcc0.ɵɵpureFunction2(5, _c185, resourceIndex_r45, index_r48))("ngClass", ctx_r46.allDaySlotClass(slot_r47, resourceIndex_r45));
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngIf", ctx_r46.allDaySlotTemplateRef);
} }
function MultiDayViewRendererComponent_div_19_ng_container_3_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementContainerStart(0);
    ɵngcc0.ɵɵtemplate(1, MultiDayViewRendererComponent_div_19_ng_container_3_td_1_Template, 2, 8, "td", 30);
    ɵngcc0.ɵɵelementContainerEnd();
} if (rf & 2) {
    const ctx_r40 = ɵngcc0.ɵɵnextContext(2);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngForOf", ctx_r40.daySlots)("ngForTrackBy", ctx_r40.itemIndex);
} }
function MultiDayViewRendererComponent_div_19_ng_container_5_div_1_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelement(0, "div", 33);
} if (rf & 2) {
    const itemResource_r55 = ctx.$implicit;
    const item_r53 = ɵngcc0.ɵɵnextContext().$implicit;
    const ctx_r54 = ɵngcc0.ɵɵnextContext(2);
    ɵngcc0.ɵɵproperty("ngClass", ctx_r54.getEventClasses(item_r53, itemResource_r55.resources, true))("ngStyle", ctx_r54.getEventStyles(item_r53, itemResource_r55, true))("kendoSchedulerFocusIndex", itemResource_r55.leafIdx)("isAllDay", true)("editable", ctx_r54.editable)("eventTemplate", ctx_r54.allDayEventTemplateRef)("item", item_r53)("index", item_r53.index)("rangeIndex", item_r53.rangeIndex)("resources", itemResource_r55.resources)("resourceIndex", itemResource_r55.leafIdx);
} }
function MultiDayViewRendererComponent_div_19_ng_container_5_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementContainerStart(0);
    ɵngcc0.ɵɵtemplate(1, MultiDayViewRendererComponent_div_19_ng_container_5_div_1_Template, 1, 11, "div", 32);
    ɵngcc0.ɵɵelementContainerEnd();
} if (rf & 2) {
    const item_r53 = ctx.$implicit;
    const ctx_r41 = ɵngcc0.ɵɵnextContext(2);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngForOf", item_r53.resources)("ngForTrackBy", ctx_r41.itemIndex);
} }
function MultiDayViewRendererComponent_div_19_ng_template_9_div_0_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelement(0, "div", 36);
} if (rf & 2) {
    const ctx_r57 = ɵngcc0.ɵɵnextContext(3);
    ɵngcc0.ɵɵproperty("isAllDay", true)("ngStyle", ctx_r57.dragHints[0].style)("ngClass", ctx_r57.dragHints[0].class)("dragHint", true)("eventTemplate", ctx_r57.eventTemplateRef)("item", ctx_r57.dragHints[0].item)("resources", ctx_r57.dragHints[0].resources);
} }
function MultiDayViewRendererComponent_div_19_ng_template_9_div_1_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelement(0, "div", 37);
} if (rf & 2) {
    const ctx_r58 = ɵngcc0.ɵɵnextContext(3);
    ɵngcc0.ɵɵproperty("hint", ctx_r58.resizeHints[0])("ngClass", ctx_r58.resizeHints[0].class)("format", ctx_r58.allDayResizeHintFormat);
} }
function MultiDayViewRendererComponent_div_19_ng_template_9_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵtemplate(0, MultiDayViewRendererComponent_div_19_ng_template_9_div_0_Template, 1, 7, "div", 34);
    ɵngcc0.ɵɵtemplate(1, MultiDayViewRendererComponent_div_19_ng_template_9_div_1_Template, 1, 3, "div", 35);
} if (rf & 2) {
    const ctx_r43 = ɵngcc0.ɵɵnextContext(2);
    ɵngcc0.ɵɵproperty("ngIf", ctx_r43.dragHints.length && ctx_r43.allDayDragHint);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngIf", ctx_r43.resizeHints.length && ctx_r43.allDayResizeHint);
} }
function MultiDayViewRendererComponent_div_19_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementStart(0, "div", 27);
    ɵngcc0.ɵɵelementStart(1, "table", 28);
    ɵngcc0.ɵɵelementStart(2, "tr");
    ɵngcc0.ɵɵtemplate(3, MultiDayViewRendererComponent_div_19_ng_container_3_Template, 2, 2, "ng-container", 5);
    ɵngcc0.ɵɵpipe(4, "resourceIterator");
    ɵngcc0.ɵɵelementEnd();
    ɵngcc0.ɵɵelementEnd();
    ɵngcc0.ɵɵtemplate(5, MultiDayViewRendererComponent_div_19_ng_container_5_Template, 2, 2, "ng-container", 5);
    ɵngcc0.ɵɵpipe(6, "async");
    ɵngcc0.ɵɵelementStart(7, "kendo-hint-container", null, 29);
    ɵngcc0.ɵɵtemplate(9, MultiDayViewRendererComponent_div_19_ng_template_9_Template, 2, 2, "ng-template");
    ɵngcc0.ɵɵelementEnd();
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    const ctx_r7 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵadvance(3);
    ɵngcc0.ɵɵproperty("ngForOf", ɵngcc0.ɵɵpipeBind1(4, 4, ctx_r7.horizontalResources))("ngForTrackBy", ctx_r7.itemIndex);
    ɵngcc0.ɵɵadvance(2);
    ɵngcc0.ɵɵproperty("ngForOf", ɵngcc0.ɵɵpipeBind1(6, 6, ctx_r7.allDayItems))("ngForTrackBy", ctx_r7.itemIndex);
} }
function MultiDayViewRendererComponent_ng_container_23_div_1_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelement(0, "div", 39, 40);
} }
function MultiDayViewRendererComponent_ng_container_23_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementContainerStart(0);
    ɵngcc0.ɵɵtemplate(1, MultiDayViewRendererComponent_ng_container_23_div_1_Template, 2, 0, "div", 38);
    ɵngcc0.ɵɵpipe(2, "resourceIterator");
    ɵngcc0.ɵɵelementContainerEnd();
} if (rf & 2) {
    const ctx_r9 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngForOf", ɵngcc0.ɵɵpipeBind1(2, 2, ctx_r9.verticalResources))("ngForTrackBy", ctx_r9.itemIndex);
} }
function MultiDayViewRendererComponent_ng_container_26_tr_1_ng_container_1_th_1_ng_container_1_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementContainerStart(0);
    ɵngcc0.ɵɵtext(1);
    ɵngcc0.ɵɵelementContainerEnd();
} if (rf & 2) {
    const ctx_r74 = ɵngcc0.ɵɵnextContext(2);
    const resourceIndex_r69 = ctx_r74.index;
    const resource_r68 = ctx_r74.$implicit;
    const leafIndex_r63 = ɵngcc0.ɵɵnextContext(2).index;
    const ctx_r71 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵtextInterpolate(ctx_r71.getField(ctx_r71.verticalItem(leafIndex_r63, resourceIndex_r69), resource_r68.textField));
} }
function MultiDayViewRendererComponent_ng_container_26_tr_1_ng_container_1_th_1_ng_container_2_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementContainer(0, 24);
} if (rf & 2) {
    const resourceIndex_r69 = ɵngcc0.ɵɵnextContext(2).index;
    const leafIndex_r63 = ɵngcc0.ɵɵnextContext(2).index;
    const ctx_r72 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵproperty("ngTemplateOutlet", ctx_r72.groupHeaderTemplateRef)("ngTemplateOutletContext", ɵngcc0.ɵɵpureFunction1(2, _c175, ctx_r72.verticalItem(leafIndex_r63, resourceIndex_r69)));
} }
function MultiDayViewRendererComponent_ng_container_26_tr_1_ng_container_1_th_1_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementStart(0, "th", 22);
    ɵngcc0.ɵɵtemplate(1, MultiDayViewRendererComponent_ng_container_26_tr_1_ng_container_1_th_1_ng_container_1_Template, 2, 1, "ng-container", 6);
    ɵngcc0.ɵɵtemplate(2, MultiDayViewRendererComponent_ng_container_26_tr_1_ng_container_1_th_1_ng_container_2_Template, 1, 4, "ng-container", 23);
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    const resourceIndex_r69 = ɵngcc0.ɵɵnextContext().index;
    const ctx_r70 = ɵngcc0.ɵɵnextContext(3);
    ɵngcc0.ɵɵattribute("rowspan", ctx_r70.verticalRowspan(resourceIndex_r69));
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngIf", !ctx_r70.groupHeaderTemplateRef);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngIf", ctx_r70.groupHeaderTemplateRef);
} }
function MultiDayViewRendererComponent_ng_container_26_tr_1_ng_container_1_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementContainerStart(0);
    ɵngcc0.ɵɵtemplate(1, MultiDayViewRendererComponent_ng_container_26_tr_1_ng_container_1_th_1_Template, 3, 3, "th", 41);
    ɵngcc0.ɵɵelementContainerEnd();
} if (rf & 2) {
    const resourceIndex_r69 = ctx.index;
    const leafIndex_r63 = ɵngcc0.ɵɵnextContext(2).index;
    const ctx_r66 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngIf", ctx_r66.verticalItem(leafIndex_r63, resourceIndex_r69));
} }
function MultiDayViewRendererComponent_ng_container_26_tr_1_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementStart(0, "tr");
    ɵngcc0.ɵɵtemplate(1, MultiDayViewRendererComponent_ng_container_26_tr_1_ng_container_1_Template, 2, 1, "ng-container", 5);
    ɵngcc0.ɵɵelementStart(2, "th", 19, 20);
    ɵngcc0.ɵɵtext(4);
    ɵngcc0.ɵɵelementEnd();
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    const ctx_r64 = ɵngcc0.ɵɵnextContext(2);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngForOf", ctx_r64.verticalResources)("ngForTrackBy", ctx_r64.itemIndex);
    ɵngcc0.ɵɵadvance(3);
    ɵngcc0.ɵɵtextInterpolate(ctx_r64.allDayMessage);
} }
function MultiDayViewRendererComponent_ng_container_26_tr_2_th_1_ng_container_1_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementContainerStart(0);
    ɵngcc0.ɵɵtext(1);
    ɵngcc0.ɵɵpipe(2, "kendoDate");
    ɵngcc0.ɵɵelementContainerEnd();
} if (rf & 2) {
    const slot_r79 = ɵngcc0.ɵɵnextContext(2).$implicit;
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵtextInterpolate(ɵngcc0.ɵɵpipeBind2(2, 1, slot_r79.start, "t"));
} }
function MultiDayViewRendererComponent_ng_container_26_tr_2_th_1_ng_container_2_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementContainer(0, 24);
} if (rf & 2) {
    const slot_r79 = ɵngcc0.ɵɵnextContext(2).$implicit;
    const ctx_r84 = ɵngcc0.ɵɵnextContext(2);
    ɵngcc0.ɵɵproperty("ngTemplateOutlet", ctx_r84.majorTimeHeaderTemplateRef)("ngTemplateOutletContext", ɵngcc0.ɵɵpureFunction1(2, _c162, slot_r79.start));
} }
const _c186 = function (a0) { return { "k-slot-cell": a0 }; };
function MultiDayViewRendererComponent_ng_container_26_tr_2_th_1_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementStart(0, "th", 43);
    ɵngcc0.ɵɵtemplate(1, MultiDayViewRendererComponent_ng_container_26_tr_2_th_1_ng_container_1_Template, 3, 4, "ng-container", 6);
    ɵngcc0.ɵɵtemplate(2, MultiDayViewRendererComponent_ng_container_26_tr_2_th_1_ng_container_2_Template, 1, 4, "ng-container", 23);
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    const ctx_r81 = ɵngcc0.ɵɵnextContext(3);
    ɵngcc0.ɵɵproperty("ngClass", ɵngcc0.ɵɵpureFunction1(3, _c186, ctx_r81.slotDivisions === 1));
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngIf", !ctx_r81.majorTimeHeaderTemplateRef);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngIf", ctx_r81.majorTimeHeaderTemplateRef);
} }
function MultiDayViewRendererComponent_ng_container_26_tr_2_th_2_ng_container_1_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementContainer(0, 24);
} if (rf & 2) {
    const slot_r79 = ɵngcc0.ɵɵnextContext(2).$implicit;
    const ctx_r87 = ɵngcc0.ɵɵnextContext(2);
    ɵngcc0.ɵɵproperty("ngTemplateOutlet", ctx_r87.minorTimeHeaderTemplateRef)("ngTemplateOutletContext", ɵngcc0.ɵɵpureFunction1(2, _c162, slot_r79.start));
} }
function MultiDayViewRendererComponent_ng_container_26_tr_2_th_2_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementStart(0, "th", 43);
    ɵngcc0.ɵɵtemplate(1, MultiDayViewRendererComponent_ng_container_26_tr_2_th_2_ng_container_1_Template, 1, 4, "ng-container", 23);
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    const timeSlotIndex_r80 = ɵngcc0.ɵɵnextContext().index;
    const ctx_r82 = ɵngcc0.ɵɵnextContext(2);
    ɵngcc0.ɵɵproperty("ngClass", ɵngcc0.ɵɵpureFunction1(2, _c186, timeSlotIndex_r80 % ctx_r82.slotDivisions === ctx_r82.slotDivisions - 1));
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngIf", ctx_r82.minorTimeHeaderTemplateRef);
} }
function MultiDayViewRendererComponent_ng_container_26_tr_2_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementStart(0, "tr");
    ɵngcc0.ɵɵtemplate(1, MultiDayViewRendererComponent_ng_container_26_tr_2_th_1_Template, 3, 5, "th", 42);
    ɵngcc0.ɵɵtemplate(2, MultiDayViewRendererComponent_ng_container_26_tr_2_th_2_Template, 2, 4, "th", 42);
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    const slot_r79 = ctx.$implicit;
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngIf", slot_r79.isMajor);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngIf", !slot_r79.isMajor);
} }
function MultiDayViewRendererComponent_ng_container_26_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementContainerStart(0);
    ɵngcc0.ɵɵtemplate(1, MultiDayViewRendererComponent_ng_container_26_tr_1_Template, 5, 3, "tr", 6);
    ɵngcc0.ɵɵtemplate(2, MultiDayViewRendererComponent_ng_container_26_tr_2_Template, 3, 2, "tr", 5);
    ɵngcc0.ɵɵelementContainerEnd();
} if (rf & 2) {
    const ctx_r11 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngIf", ctx_r11.verticalResources.length);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngForOf", ctx_r11.timeSlots)("ngForTrackBy", ctx_r11.itemIndex);
} }
function MultiDayViewRendererComponent_ng_container_30_div_1_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelement(0, "div", 45, 46);
} }
function MultiDayViewRendererComponent_ng_container_30_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementContainerStart(0);
    ɵngcc0.ɵɵtemplate(1, MultiDayViewRendererComponent_ng_container_30_div_1_Template, 2, 0, "div", 44);
    ɵngcc0.ɵɵpipe(2, "resourceIterator");
    ɵngcc0.ɵɵelementContainerEnd();
} if (rf & 2) {
    const ctx_r13 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngForOf", ɵngcc0.ɵɵpipeBind1(2, 2, ctx_r13.verticalResources))("ngForTrackBy", ctx_r13.itemIndex);
} }
function MultiDayViewRendererComponent_ng_container_33_tr_1_td_1_ng_container_1_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementContainer(0, 24);
} if (rf & 2) {
    const slot_r98 = ɵngcc0.ɵɵnextContext().$implicit;
    const verticalIndex_r94 = ɵngcc0.ɵɵnextContext(2).index;
    const ctx_r100 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵproperty("ngTemplateOutlet", ctx_r100.allDaySlotTemplateRef)("ngTemplateOutletContext", ɵngcc0.ɵɵpureFunction2(2, _c177, slot_r98.start, ctx_r100.resourcesByIndex(verticalIndex_r94)));
} }
function MultiDayViewRendererComponent_ng_container_33_tr_1_td_1_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementStart(0, "td", 51);
    ɵngcc0.ɵɵtemplate(1, MultiDayViewRendererComponent_ng_container_33_tr_1_td_1_ng_container_1_Template, 1, 5, "ng-container", 23);
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    const slot_r98 = ctx.$implicit;
    const index_r99 = ctx.index;
    const verticalIndex_r94 = ɵngcc0.ɵɵnextContext(2).index;
    const ctx_r97 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵproperty("start", slot_r98.start)("end", slot_r98.end)("id", ɵngcc0.ɵɵpureFunction2(4, _c185, verticalIndex_r94, index_r99));
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngIf", ctx_r97.allDaySlotTemplateRef);
} }
function MultiDayViewRendererComponent_ng_container_33_tr_1_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementStart(0, "tr", 49);
    ɵngcc0.ɵɵtemplate(1, MultiDayViewRendererComponent_ng_container_33_tr_1_td_1_Template, 2, 7, "td", 50);
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    const ctx_r95 = ɵngcc0.ɵɵnextContext(2);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngForOf", ctx_r95.daySlots)("ngForTrackBy", ctx_r95.itemIndex);
} }
function MultiDayViewRendererComponent_ng_container_33_tr_2_ng_container_1_td_1_ng_container_2_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementContainer(0, 24);
} if (rf & 2) {
    ɵngcc0.ɵɵnextContext();
    const _r112 = ɵngcc0.ɵɵreference(1);
    const ctx_r113 = ɵngcc0.ɵɵnextContext(4);
    ɵngcc0.ɵɵproperty("ngTemplateOutlet", ctx_r113.timeSlotTemplateRef)("ngTemplateOutletContext", ɵngcc0.ɵɵpureFunction2(2, _c177, _r112.startLocalTime, ctx_r113.resourcesByIndex(_r112.id.resourceIndex)));
} }
function MultiDayViewRendererComponent_ng_container_33_tr_2_ng_container_1_td_1_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementStart(0, "td", 53, 54);
    ɵngcc0.ɵɵtemplate(2, MultiDayViewRendererComponent_ng_container_33_tr_2_ng_container_1_td_1_ng_container_2_Template, 1, 5, "ng-container", 23);
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    const daySlot_r110 = ctx.$implicit;
    const rangeIndex_r111 = ctx.index;
    const horizontalIndex_r108 = ɵngcc0.ɵɵnextContext().index;
    const ctx_r114 = ɵngcc0.ɵɵnextContext();
    const slot_r104 = ctx_r114.$implicit;
    const index_r105 = ctx_r114.index;
    const verticalIndex_r94 = ɵngcc0.ɵɵnextContext().index;
    const ctx_r109 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵclassProp("k-nonwork-hour", slot_r104.isWorkHour);
    ɵngcc0.ɵɵproperty("ngClass", ctx_r109.timeSlotClass(slot_r104, daySlot_r110.start, ctx_r109.verticalResources.length ? verticalIndex_r94 : horizontalIndex_r108))("date", daySlot_r110.start)("invariantStart", slot_r104.start)("invariantEnd", slot_r104.end)("workDayStart", ctx_r109.workDayStartTime)("workDayEnd", ctx_r109.workDayEndTime)("workWeekStart", ctx_r109.workWeekStart)("workWeekEnd", ctx_r109.workWeekEnd)("id", ɵngcc0.ɵɵpureFunction3(12, _c178, ctx_r109.verticalResources.length ? verticalIndex_r94 : horizontalIndex_r108, rangeIndex_r111, index_r105));
    ɵngcc0.ɵɵadvance(2);
    ɵngcc0.ɵɵproperty("ngIf", ctx_r109.timeSlotTemplateRef);
} }
function MultiDayViewRendererComponent_ng_container_33_tr_2_ng_container_1_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementContainerStart(0);
    ɵngcc0.ɵɵtemplate(1, MultiDayViewRendererComponent_ng_container_33_tr_2_ng_container_1_td_1_Template, 3, 16, "td", 52);
    ɵngcc0.ɵɵelementContainerEnd();
} if (rf & 2) {
    const ctx_r106 = ɵngcc0.ɵɵnextContext(3);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngForOf", ctx_r106.daySlots)("ngForTrackBy", ctx_r106.itemIndex);
} }
function MultiDayViewRendererComponent_ng_container_33_tr_2_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementStart(0, "tr");
    ɵngcc0.ɵɵtemplate(1, MultiDayViewRendererComponent_ng_container_33_tr_2_ng_container_1_Template, 2, 2, "ng-container", 5);
    ɵngcc0.ɵɵpipe(2, "resourceIterator");
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    const slot_r104 = ctx.$implicit;
    const ctx_r96 = ɵngcc0.ɵɵnextContext(2);
    ɵngcc0.ɵɵclassProp("k-middle-row", slot_r104.isMajor);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngForOf", ɵngcc0.ɵɵpipeBind1(2, 4, ctx_r96.horizontalResources))("ngForTrackBy", ctx_r96.itemIndex);
} }
function MultiDayViewRendererComponent_ng_container_33_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementContainerStart(0);
    ɵngcc0.ɵɵtemplate(1, MultiDayViewRendererComponent_ng_container_33_tr_1_Template, 2, 2, "tr", 47);
    ɵngcc0.ɵɵtemplate(2, MultiDayViewRendererComponent_ng_container_33_tr_2_Template, 3, 6, "tr", 48);
    ɵngcc0.ɵɵelementContainerEnd();
} if (rf & 2) {
    const ctx_r15 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngIf", ctx_r15.verticalResources.length);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngForOf", ctx_r15.timeSlots)("ngForTrackBy", ctx_r15.itemIndex);
} }
function MultiDayViewRendererComponent_ng_container_35_div_1_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelement(0, "div", 56);
} if (rf & 2) {
    const itemResource_r119 = ctx.$implicit;
    const item_r117 = ɵngcc0.ɵɵnextContext().$implicit;
    const ctx_r118 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵproperty("ngClass", ctx_r118.getEventClasses(item_r117, itemResource_r119.resources))("ngStyle", ctx_r118.getEventStyles(item_r117, itemResource_r119))("kendoSchedulerFocusIndex", itemResource_r119.leafIdx)("editable", ctx_r118.editable)("vertical", true)("eventTemplate", ctx_r118.eventTemplateRef)("item", item_r117)("index", item_r117.index)("rangeIndex", item_r117.rangeIndex)("resources", itemResource_r119.resources)("resourceIndex", itemResource_r119.leafIdx);
} }
function MultiDayViewRendererComponent_ng_container_35_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementContainerStart(0);
    ɵngcc0.ɵɵtemplate(1, MultiDayViewRendererComponent_ng_container_35_div_1_Template, 1, 11, "div", 55);
    ɵngcc0.ɵɵelementContainerEnd();
} if (rf & 2) {
    const item_r117 = ctx.$implicit;
    const ctx_r16 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngForOf", item_r117.resources)("ngForTrackBy", ctx_r16.itemIndex);
} }
function MultiDayViewRendererComponent_ng_container_37_ng_container_1_div_1_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelement(0, "div", 33);
} if (rf & 2) {
    const itemResource_r124 = ctx.$implicit;
    const item_r122 = ɵngcc0.ɵɵnextContext().$implicit;
    const ctx_r123 = ɵngcc0.ɵɵnextContext(2);
    ɵngcc0.ɵɵproperty("ngClass", ctx_r123.getEventClasses(item_r122, itemResource_r124.resources, true))("ngStyle", ctx_r123.getEventStyles(item_r122, itemResource_r124, true))("kendoSchedulerFocusIndex", itemResource_r124.leafIdx)("isAllDay", true)("editable", ctx_r123.editable)("eventTemplate", ctx_r123.allDayEventTemplateRef)("item", item_r122)("index", item_r122.index)("rangeIndex", item_r122.rangeIndex)("resources", itemResource_r124.resources)("resourceIndex", itemResource_r124.leafIdx);
} }
function MultiDayViewRendererComponent_ng_container_37_ng_container_1_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementContainerStart(0);
    ɵngcc0.ɵɵtemplate(1, MultiDayViewRendererComponent_ng_container_37_ng_container_1_div_1_Template, 1, 11, "div", 32);
    ɵngcc0.ɵɵelementContainerEnd();
} if (rf & 2) {
    const item_r122 = ctx.$implicit;
    const ctx_r121 = ɵngcc0.ɵɵnextContext(2);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngForOf", item_r122.resources)("ngForTrackBy", ctx_r121.itemIndex);
} }
function MultiDayViewRendererComponent_ng_container_37_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementContainerStart(0);
    ɵngcc0.ɵɵtemplate(1, MultiDayViewRendererComponent_ng_container_37_ng_container_1_Template, 2, 2, "ng-container", 5);
    ɵngcc0.ɵɵpipe(2, "async");
    ɵngcc0.ɵɵelementContainerEnd();
} if (rf & 2) {
    const ctx_r17 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngForOf", ɵngcc0.ɵɵpipeBind1(2, 2, ctx_r17.allDayItems))("ngForTrackBy", ctx_r17.itemIndex);
} }
function MultiDayViewRendererComponent_ng_template_40_div_0_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelement(0, "div", 58);
} if (rf & 2) {
    const ctx_r126 = ɵngcc0.ɵɵnextContext(2);
    ɵngcc0.ɵɵproperty("isAllDay", ctx_r126.allDayDragHint)("ngStyle", ctx_r126.dragHints[0].style)("ngClass", ctx_r126.dragHints[0].class)("dragHint", true)("eventTemplate", ctx_r126.eventTemplateRef)("resources", ctx_r126.dragHints[0].resources)("item", ctx_r126.dragHints[0].item);
} }
function MultiDayViewRendererComponent_ng_template_40_ng_container_1_div_1_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelement(0, "div", 37);
} if (rf & 2) {
    const hint_r129 = ctx.$implicit;
    const ctx_r128 = ɵngcc0.ɵɵnextContext(3);
    ɵngcc0.ɵɵproperty("hint", hint_r129)("ngClass", hint_r129.class)("format", ctx_r128.allDayResizeHint ? ctx_r128.allDayResizeHintFormat : ctx_r128.resizeHintFormat);
} }
function MultiDayViewRendererComponent_ng_template_40_ng_container_1_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementContainerStart(0);
    ɵngcc0.ɵɵtemplate(1, MultiDayViewRendererComponent_ng_template_40_ng_container_1_div_1_Template, 1, 3, "div", 59);
    ɵngcc0.ɵɵelementContainerEnd();
} if (rf & 2) {
    const ctx_r127 = ɵngcc0.ɵɵnextContext(2);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngForOf", ctx_r127.resizeHints)("ngForTrackBy", ctx_r127.itemIndex);
} }
function MultiDayViewRendererComponent_ng_template_40_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵtemplate(0, MultiDayViewRendererComponent_ng_template_40_div_0_Template, 1, 7, "div", 57);
    ɵngcc0.ɵɵtemplate(1, MultiDayViewRendererComponent_ng_template_40_ng_container_1_Template, 2, 2, "ng-container", 6);
} if (rf & 2) {
    const ctx_r19 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵproperty("ngIf", ctx_r19.dragHints.length && (!ctx_r19.allDayDragHint || ctx_r19.verticalResources.length));
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngIf", ctx_r19.resizeHints.length && (!ctx_r19.allDayResizeHint || ctx_r19.verticalResources.length));
} }
const _c187 = ["dayTimeViewItem", ""];
function DayTimeViewItemComponent_span_1_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelement(0, "span", 10);
} }
function DayTimeViewItemComponent_span_2_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelement(0, "span", 11);
} }
function DayTimeViewItemComponent_span_3_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelement(0, "span", 12);
} }
function DayTimeViewItemComponent_ng_container_4_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementContainer(0, 13);
} if (rf & 2) {
    const ctx_r3 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵproperty("ngTemplateOutlet", ctx_r3.eventTemplate)("ngTemplateOutletContext", ɵngcc0.ɵɵpureFunction3(2, _c165, ctx_r3.item.event, ctx_r3.item.event, ctx_r3.resources));
} }
function DayTimeViewItemComponent_div_5_div_1_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementStart(0, "div", 16);
    ɵngcc0.ɵɵtext(1);
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    const ctx_r11 = ɵngcc0.ɵɵnextContext(2);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵtextInterpolate(ctx_r11.eventTime);
} }
function DayTimeViewItemComponent_div_5_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementStart(0, "div");
    ɵngcc0.ɵɵtemplate(1, DayTimeViewItemComponent_div_5_div_1_Template, 2, 1, "div", 14);
    ɵngcc0.ɵɵelementStart(2, "div", 15);
    ɵngcc0.ɵɵtext(3);
    ɵngcc0.ɵɵelementEnd();
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    const ctx_r4 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵattribute("title", ctx_r4.eventTitle);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngIf", !ctx_r4.isAllDay);
    ɵngcc0.ɵɵadvance(2);
    ɵngcc0.ɵɵtextInterpolate(ctx_r4.item.event.title);
} }
function DayTimeViewItemComponent_span_7_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementStart(0, "span", 17);
    ɵngcc0.ɵɵelement(1, "span", 18);
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    const ctx_r5 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵattribute("title", ctx_r5.deleteMessage);
} }
function DayTimeViewItemComponent_span_8_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelement(0, "span", 19);
} }
function DayTimeViewItemComponent_span_9_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementStart(0, "span", 20);
    ɵngcc0.ɵɵelement(1, "span", 21);
    ɵngcc0.ɵɵelementEnd();
} }
function DayTimeViewItemComponent_span_10_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementStart(0, "span", 22);
    ɵngcc0.ɵɵelement(1, "span", 23);
    ɵngcc0.ɵɵelementEnd();
} }
function DayTimeViewItemComponent_ng_container_11_span_1_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelement(0, "span", 26);
} }
function DayTimeViewItemComponent_ng_container_11_span_2_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelement(0, "span", 27);
} }
function DayTimeViewItemComponent_ng_container_11_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementContainerStart(0);
    ɵngcc0.ɵɵtemplate(1, DayTimeViewItemComponent_ng_container_11_span_1_Template, 1, 0, "span", 24);
    ɵngcc0.ɵɵtemplate(2, DayTimeViewItemComponent_ng_container_11_span_2_Template, 1, 0, "span", 25);
    ɵngcc0.ɵɵelementContainerEnd();
} if (rf & 2) {
    const ctx_r9 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngIf", !ctx_r9.item.tail);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngIf", !ctx_r9.item.head);
} }
function DayTimeViewItemComponent_ng_container_12_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementContainerStart(0);
    ɵngcc0.ɵɵelement(1, "span", 28);
    ɵngcc0.ɵɵelement(2, "span", 29);
    ɵngcc0.ɵɵelementContainerEnd();
} }
const _c188 = ["verticalResourceRows"];
function TimelineMultiDayViewComponent_tr_9_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementStart(0, "tr");
    ɵngcc0.ɵɵelement(1, "th");
    ɵngcc0.ɵɵelementEnd();
} }
function TimelineMultiDayViewComponent_ng_container_14_div_1_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelement(0, "div", 21, 22);
} }
function TimelineMultiDayViewComponent_ng_container_14_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementContainerStart(0);
    ɵngcc0.ɵɵtemplate(1, TimelineMultiDayViewComponent_ng_container_14_div_1_Template, 2, 0, "div", 20);
    ɵngcc0.ɵɵpipe(2, "resourceIterator");
    ɵngcc0.ɵɵelementContainerEnd();
} if (rf & 2) {
    const ctx_r4 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngForOf", ɵngcc0.ɵɵpipeBind1(2, 2, ctx_r4.horizontalResources))("ngForTrackBy", ctx_r4.itemIndex);
} }
const _c189 = function (a0) { return { "width.px": a0 }; };
function TimelineMultiDayViewComponent_col_17_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelement(0, "col", 23);
} if (rf & 2) {
    const ctx_r5 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵproperty("ngStyle", ɵngcc0.ɵɵpureFunction1(1, _c189, ctx_r5.columnWidth));
} }
function TimelineMultiDayViewComponent_tr_19_th_1_ng_container_1_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementContainerStart(0);
    ɵngcc0.ɵɵtext(1);
    ɵngcc0.ɵɵelementContainerEnd();
} if (rf & 2) {
    const item_r29 = ɵngcc0.ɵɵnextContext().$implicit;
    const resource_r26 = ɵngcc0.ɵɵnextContext().$implicit;
    const ctx_r30 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵtextInterpolate(ctx_r30.getField(item_r29, resource_r26.textField));
} }
function TimelineMultiDayViewComponent_tr_19_th_1_ng_container_2_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementContainer(0, 26);
} if (rf & 2) {
    const item_r29 = ɵngcc0.ɵɵnextContext().$implicit;
    const ctx_r31 = ɵngcc0.ɵɵnextContext(2);
    ɵngcc0.ɵɵproperty("ngTemplateOutlet", ctx_r31.groupHeaderTemplateRef)("ngTemplateOutletContext", ɵngcc0.ɵɵpureFunction1(2, _c175, item_r29));
} }
function TimelineMultiDayViewComponent_tr_19_th_1_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementStart(0, "th", 5);
    ɵngcc0.ɵɵtemplate(1, TimelineMultiDayViewComponent_tr_19_th_1_ng_container_1_Template, 2, 1, "ng-container", 11);
    ɵngcc0.ɵɵtemplate(2, TimelineMultiDayViewComponent_tr_19_th_1_ng_container_2_Template, 1, 4, "ng-container", 25);
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    const resourceIndex_r27 = ɵngcc0.ɵɵnextContext().index;
    const ctx_r28 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵattribute("colspan", ctx_r28.horizontalColspan(resourceIndex_r27));
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngIf", !ctx_r28.groupHeaderTemplateRef);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngIf", ctx_r28.groupHeaderTemplateRef);
} }
function TimelineMultiDayViewComponent_tr_19_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementStart(0, "tr");
    ɵngcc0.ɵɵtemplate(1, TimelineMultiDayViewComponent_tr_19_th_1_Template, 3, 3, "th", 24);
    ɵngcc0.ɵɵpipe(2, "resourceIterator");
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    const resourceIndex_r27 = ctx.index;
    const ctx_r6 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngForOf", ɵngcc0.ɵɵpipeBind2(2, 2, ctx_r6.horizontalResources, resourceIndex_r27))("ngForTrackBy", ctx_r6.itemIndex);
} }
const _c190 = function (a0) { return { "k-nav-day": a0 }; };
function TimelineMultiDayViewComponent_ng_container_21_ng_container_1_span_2_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementStart(0, "span", 28);
    ɵngcc0.ɵɵtext(1);
    ɵngcc0.ɵɵpipe(2, "kendoDate");
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    const ctx_r42 = ɵngcc0.ɵɵnextContext();
    const index_r39 = ctx_r42.index;
    const daySlot_r38 = ctx_r42.$implicit;
    const ctx_r40 = ɵngcc0.ɵɵnextContext(2);
    ɵngcc0.ɵɵproperty("ngClass", ɵngcc0.ɵɵpureFunction1(6, _c190, ctx_r40.numberOfDays > 1));
    ɵngcc0.ɵɵattribute("data-dayslot-index", index_r39);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵtextInterpolate(ɵngcc0.ɵɵpipeBind2(2, 3, daySlot_r38.start, "m"));
} }
function TimelineMultiDayViewComponent_ng_container_21_ng_container_1_ng_container_3_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementContainer(0, 26);
} if (rf & 2) {
    const daySlot_r38 = ɵngcc0.ɵɵnextContext().$implicit;
    const ctx_r41 = ɵngcc0.ɵɵnextContext(2);
    ɵngcc0.ɵɵproperty("ngTemplateOutlet", ctx_r41.dateHeaderTemplateRef)("ngTemplateOutletContext", ɵngcc0.ɵɵpureFunction1(2, _c162, daySlot_r38.start));
} }
function TimelineMultiDayViewComponent_ng_container_21_ng_container_1_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementContainerStart(0);
    ɵngcc0.ɵɵelementStart(1, "th", 5);
    ɵngcc0.ɵɵtemplate(2, TimelineMultiDayViewComponent_ng_container_21_ng_container_1_span_2_Template, 3, 8, "span", 27);
    ɵngcc0.ɵɵtemplate(3, TimelineMultiDayViewComponent_ng_container_21_ng_container_1_ng_container_3_Template, 1, 4, "ng-container", 25);
    ɵngcc0.ɵɵelementEnd();
    ɵngcc0.ɵɵelementContainerEnd();
} if (rf & 2) {
    const ctx_r37 = ɵngcc0.ɵɵnextContext(2);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵattribute("colspan", ctx_r37.timeSlots.length);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngIf", !ctx_r37.dateHeaderTemplateRef);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngIf", ctx_r37.dateHeaderTemplateRef);
} }
function TimelineMultiDayViewComponent_ng_container_21_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementContainerStart(0);
    ɵngcc0.ɵɵtemplate(1, TimelineMultiDayViewComponent_ng_container_21_ng_container_1_Template, 4, 3, "ng-container", 6);
    ɵngcc0.ɵɵelementContainerEnd();
} if (rf & 2) {
    const ctx_r7 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngForOf", ctx_r7.daySlots)("ngForTrackBy", ctx_r7.itemIndex);
} }
function TimelineMultiDayViewComponent_ng_container_24_ng_container_1_ng_container_1_th_1_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementStart(0, "th");
    ɵngcc0.ɵɵtext(1);
    ɵngcc0.ɵɵpipe(2, "kendoDate");
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    const ctx_r53 = ɵngcc0.ɵɵnextContext();
    const index_r51 = ctx_r53.index;
    const timeSlot_r50 = ctx_r53.$implicit;
    const ctx_r52 = ɵngcc0.ɵɵnextContext(3);
    ɵngcc0.ɵɵattribute("colspan", ctx_r52.timeColspan(index_r51));
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵtextInterpolate(ɵngcc0.ɵɵpipeBind2(2, 2, timeSlot_r50.start, "t"));
} }
function TimelineMultiDayViewComponent_ng_container_24_ng_container_1_ng_container_1_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementContainerStart(0);
    ɵngcc0.ɵɵtemplate(1, TimelineMultiDayViewComponent_ng_container_24_ng_container_1_ng_container_1_th_1_Template, 3, 5, "th", 11);
    ɵngcc0.ɵɵelementContainerEnd();
} if (rf & 2) {
    const timeSlot_r50 = ctx.$implicit;
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngIf", timeSlot_r50.isMajor);
} }
function TimelineMultiDayViewComponent_ng_container_24_ng_container_1_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementContainerStart(0);
    ɵngcc0.ɵɵtemplate(1, TimelineMultiDayViewComponent_ng_container_24_ng_container_1_ng_container_1_Template, 2, 1, "ng-container", 6);
    ɵngcc0.ɵɵelementContainerEnd();
} if (rf & 2) {
    const ctx_r46 = ɵngcc0.ɵɵnextContext(2);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngForOf", ctx_r46.timeSlots)("ngForTrackBy", ctx_r46.itemIndex);
} }
function TimelineMultiDayViewComponent_ng_container_24_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementContainerStart(0);
    ɵngcc0.ɵɵtemplate(1, TimelineMultiDayViewComponent_ng_container_24_ng_container_1_Template, 2, 2, "ng-container", 6);
    ɵngcc0.ɵɵelementContainerEnd();
} if (rf & 2) {
    const ctx_r8 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngForOf", ctx_r8.daySlots)("ngForTrackBy", ctx_r8.itemIndex);
} }
function TimelineMultiDayViewComponent_tr_31_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementStart(0, "tr");
    ɵngcc0.ɵɵelementStart(1, "th", 29, 30);
    ɵngcc0.ɵɵtext(3);
    ɵngcc0.ɵɵelementEnd();
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    const ctx_r11 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵadvance(3);
    ɵngcc0.ɵɵtextInterpolate1(" ", ctx_r11.allEventsMessage, " ");
} }
function TimelineMultiDayViewComponent_ng_container_32_ng_container_1_ng_container_3_th_1_ng_container_2_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementContainerStart(0);
    ɵngcc0.ɵɵtext(1);
    ɵngcc0.ɵɵelementContainerEnd();
} if (rf & 2) {
    const ctx_r66 = ɵngcc0.ɵɵnextContext(2);
    const resourceIndex_r61 = ctx_r66.index;
    const resource_r60 = ctx_r66.$implicit;
    const leafIndex_r57 = ɵngcc0.ɵɵnextContext().index;
    const ctx_r63 = ɵngcc0.ɵɵnextContext(2);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵtextInterpolate(ctx_r63.getField(ctx_r63.verticalItem(leafIndex_r57, resourceIndex_r61), resource_r60.textField));
} }
function TimelineMultiDayViewComponent_ng_container_32_ng_container_1_ng_container_3_th_1_ng_container_3_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementContainer(0, 26);
} if (rf & 2) {
    const resourceIndex_r61 = ɵngcc0.ɵɵnextContext(2).index;
    const leafIndex_r57 = ɵngcc0.ɵɵnextContext().index;
    const ctx_r64 = ɵngcc0.ɵɵnextContext(2);
    ɵngcc0.ɵɵproperty("ngTemplateOutlet", ctx_r64.groupHeaderTemplateRef)("ngTemplateOutletContext", ɵngcc0.ɵɵpureFunction1(2, _c175, ctx_r64.verticalItem(leafIndex_r57, resourceIndex_r61)));
} }
function TimelineMultiDayViewComponent_ng_container_32_ng_container_1_ng_container_3_th_1_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementStart(0, "th", 5);
    ɵngcc0.ɵɵelementStart(1, "div");
    ɵngcc0.ɵɵtemplate(2, TimelineMultiDayViewComponent_ng_container_32_ng_container_1_ng_container_3_th_1_ng_container_2_Template, 2, 1, "ng-container", 11);
    ɵngcc0.ɵɵtemplate(3, TimelineMultiDayViewComponent_ng_container_32_ng_container_1_ng_container_3_th_1_ng_container_3_Template, 1, 4, "ng-container", 25);
    ɵngcc0.ɵɵelementEnd();
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    const resourceIndex_r61 = ɵngcc0.ɵɵnextContext().index;
    const ctx_r62 = ɵngcc0.ɵɵnextContext(3);
    ɵngcc0.ɵɵattribute("rowspan", ctx_r62.verticalRowspan(resourceIndex_r61));
    ɵngcc0.ɵɵadvance(2);
    ɵngcc0.ɵɵproperty("ngIf", !ctx_r62.groupHeaderTemplateRef);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngIf", ctx_r62.groupHeaderTemplateRef);
} }
function TimelineMultiDayViewComponent_ng_container_32_ng_container_1_ng_container_3_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementContainerStart(0);
    ɵngcc0.ɵɵtemplate(1, TimelineMultiDayViewComponent_ng_container_32_ng_container_1_ng_container_3_th_1_Template, 4, 3, "th", 32);
    ɵngcc0.ɵɵelementContainerEnd();
} if (rf & 2) {
    const resourceIndex_r61 = ctx.index;
    const leafIndex_r57 = ɵngcc0.ɵɵnextContext().index;
    const ctx_r59 = ɵngcc0.ɵɵnextContext(2);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngIf", ctx_r59.verticalItem(leafIndex_r57, resourceIndex_r61));
} }
function TimelineMultiDayViewComponent_ng_container_32_ng_container_1_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementContainerStart(0);
    ɵngcc0.ɵɵelementStart(1, "tr", null, 31);
    ɵngcc0.ɵɵtemplate(3, TimelineMultiDayViewComponent_ng_container_32_ng_container_1_ng_container_3_Template, 2, 1, "ng-container", 6);
    ɵngcc0.ɵɵelementEnd();
    ɵngcc0.ɵɵelementContainerEnd();
} if (rf & 2) {
    const ctx_r55 = ɵngcc0.ɵɵnextContext(2);
    ɵngcc0.ɵɵadvance(3);
    ɵngcc0.ɵɵproperty("ngForOf", ctx_r55.verticalResources)("ngForTrackBy", ctx_r55.itemIndex);
} }
function TimelineMultiDayViewComponent_ng_container_32_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementContainerStart(0);
    ɵngcc0.ɵɵtemplate(1, TimelineMultiDayViewComponent_ng_container_32_ng_container_1_Template, 4, 2, "ng-container", 6);
    ɵngcc0.ɵɵpipe(2, "resourceIterator");
    ɵngcc0.ɵɵelementContainerEnd();
} if (rf & 2) {
    const ctx_r12 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngForOf", ɵngcc0.ɵɵpipeBind1(2, 2, ctx_r12.verticalResources))("ngForTrackBy", ctx_r12.itemIndex);
} }
function TimelineMultiDayViewComponent_ng_container_35_div_1_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelement(0, "div", 34, 35);
} }
function TimelineMultiDayViewComponent_ng_container_35_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementContainerStart(0);
    ɵngcc0.ɵɵtemplate(1, TimelineMultiDayViewComponent_ng_container_35_div_1_Template, 2, 0, "div", 33);
    ɵngcc0.ɵɵpipe(2, "resourceIterator");
    ɵngcc0.ɵɵelementContainerEnd();
} if (rf & 2) {
    const ctx_r14 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngForOf", ɵngcc0.ɵɵpipeBind1(2, 2, ctx_r14.horizontalResources))("ngForTrackBy", ctx_r14.itemIndex);
} }
function TimelineMultiDayViewComponent_col_39_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelement(0, "col", 23);
} if (rf & 2) {
    const ctx_r16 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵproperty("ngStyle", ɵngcc0.ɵɵpureFunction1(1, _c189, ctx_r16.columnWidth));
} }
function TimelineMultiDayViewComponent_tr_41_ng_container_1_ng_container_1_td_1_ng_container_2_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementContainer(0, 26);
} if (rf & 2) {
    ɵngcc0.ɵɵnextContext();
    const _r86 = ɵngcc0.ɵɵreference(1);
    const ctx_r87 = ɵngcc0.ɵɵnextContext(4);
    ɵngcc0.ɵɵproperty("ngTemplateOutlet", ctx_r87.timeSlotTemplateRef)("ngTemplateOutletContext", ɵngcc0.ɵɵpureFunction2(2, _c177, _r86.start, ctx_r87.resourcesByIndex(_r86.id.resourceIndex)));
} }
function TimelineMultiDayViewComponent_tr_41_ng_container_1_ng_container_1_td_1_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementStart(0, "td", 37, 38);
    ɵngcc0.ɵɵtemplate(2, TimelineMultiDayViewComponent_tr_41_ng_container_1_ng_container_1_td_1_ng_container_2_Template, 1, 5, "ng-container", 25);
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    const slot_r84 = ctx.$implicit;
    const index_r85 = ctx.index;
    const ctx_r88 = ɵngcc0.ɵɵnextContext();
    const daySlot_r81 = ctx_r88.$implicit;
    const rangeIndex_r82 = ctx_r88.index;
    const horizontalIndex_r79 = ɵngcc0.ɵɵnextContext().index;
    const verticalIndex_r76 = ɵngcc0.ɵɵnextContext().index;
    const ctx_r83 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵproperty("ngClass", ctx_r83.timeSlotClass(slot_r84, daySlot_r81.start, ctx_r83.verticalResources.length ? verticalIndex_r76 : horizontalIndex_r79))("date", daySlot_r81.start)("invariantStart", slot_r84.start)("invariantEnd", slot_r84.end)("workDayStart", ctx_r83.workDayStartTime)("workDayEnd", ctx_r83.workDayEndTime)("workWeekStart", ctx_r83.workWeekStart)("workWeekEnd", ctx_r83.workWeekEnd)("id", ɵngcc0.ɵɵpureFunction3(10, _c178, ctx_r83.verticalResources.length ? verticalIndex_r76 : horizontalIndex_r79, rangeIndex_r82, index_r85));
    ɵngcc0.ɵɵadvance(2);
    ɵngcc0.ɵɵproperty("ngIf", ctx_r83.timeSlotTemplateRef);
} }
function TimelineMultiDayViewComponent_tr_41_ng_container_1_ng_container_1_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementContainerStart(0);
    ɵngcc0.ɵɵtemplate(1, TimelineMultiDayViewComponent_tr_41_ng_container_1_ng_container_1_td_1_Template, 3, 14, "td", 36);
    ɵngcc0.ɵɵelementContainerEnd();
} if (rf & 2) {
    const ctx_r80 = ɵngcc0.ɵɵnextContext(3);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngForOf", ctx_r80.timeSlots)("ngForTrackBy", ctx_r80.itemIndex);
} }
function TimelineMultiDayViewComponent_tr_41_ng_container_1_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementContainerStart(0);
    ɵngcc0.ɵɵtemplate(1, TimelineMultiDayViewComponent_tr_41_ng_container_1_ng_container_1_Template, 2, 2, "ng-container", 6);
    ɵngcc0.ɵɵelementContainerEnd();
} if (rf & 2) {
    const ctx_r77 = ɵngcc0.ɵɵnextContext(2);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngForOf", ctx_r77.daySlots)("ngForTrackBy", ctx_r77.itemIndex);
} }
function TimelineMultiDayViewComponent_tr_41_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementStart(0, "tr");
    ɵngcc0.ɵɵtemplate(1, TimelineMultiDayViewComponent_tr_41_ng_container_1_Template, 2, 2, "ng-container", 6);
    ɵngcc0.ɵɵpipe(2, "resourceIterator");
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    const ctx_r17 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngForOf", ɵngcc0.ɵɵpipeBind1(2, 2, ctx_r17.horizontalResources))("ngForTrackBy", ctx_r17.itemIndex);
} }
function TimelineMultiDayViewComponent_ng_container_43_div_1_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelement(0, "div", 40);
} if (rf & 2) {
    const itemResource_r93 = ctx.$implicit;
    const item_r91 = ɵngcc0.ɵɵnextContext().$implicit;
    const ctx_r92 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵproperty("ngClass", ctx_r92.getEventClasses(item_r91, itemResource_r93.resources))("ngStyle", ctx_r92.getEventStyles(item_r91, itemResource_r93))("kendoSchedulerFocusIndex", itemResource_r93.leafIdx)("editable", ctx_r92.editable)("item", item_r91)("index", item_r91.index)("rangeIndex", item_r91.rangeIndex)("eventTemplate", ctx_r92.eventTemplateRef)("resources", itemResource_r93.resources)("resourceIndex", itemResource_r93.leafIdx);
} }
function TimelineMultiDayViewComponent_ng_container_43_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementContainerStart(0);
    ɵngcc0.ɵɵtemplate(1, TimelineMultiDayViewComponent_ng_container_43_div_1_Template, 1, 10, "div", 39);
    ɵngcc0.ɵɵelementContainerEnd();
} if (rf & 2) {
    const item_r91 = ctx.$implicit;
    const ctx_r18 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngForOf", item_r91.resources)("ngForTrackBy", ctx_r18.itemIndex);
} }
function TimelineMultiDayViewComponent_ng_template_47_div_0_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelement(0, "div", 43);
} if (rf & 2) {
    const hint_r97 = ctx.$implicit;
    const ctx_r95 = ɵngcc0.ɵɵnextContext(2);
    ɵngcc0.ɵɵproperty("ngStyle", hint_r97.style)("ngClass", hint_r97.class)("dragHint", true)("eventTemplate", ctx_r95.eventTemplateRef)("item", hint_r97.item)("resources", hint_r97.resources);
} }
function TimelineMultiDayViewComponent_ng_template_47_div_1_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelement(0, "div", 44);
} if (rf & 2) {
    const ctx_r96 = ɵngcc0.ɵɵnextContext(2);
    ɵngcc0.ɵɵproperty("hint", ctx_r96.resizeHints[0])("ngClass", ctx_r96.resizeHints[0].class)("format", ctx_r96.resizeHintFormat);
} }
function TimelineMultiDayViewComponent_ng_template_47_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵtemplate(0, TimelineMultiDayViewComponent_ng_template_47_div_0_Template, 1, 6, "div", 41);
    ɵngcc0.ɵɵtemplate(1, TimelineMultiDayViewComponent_ng_template_47_div_1_Template, 1, 3, "div", 42);
} if (rf & 2) {
    const ctx_r20 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵproperty("ngForOf", ctx_r20.dragHints)("ngForTrackBy", ctx_r20.itemIndex);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngIf", ctx_r20.resizeHints && ctx_r20.resizeHints.length);
} }
function TimelineViewComponent_ng_template_0_Template(rf, ctx) { if (rf & 1) {
    const _r3 = ɵngcc0.ɵɵgetCurrentView();
    ɵngcc0.ɵɵelement(0, "timeline-multi-day-view", 1);
    ɵngcc0.ɵɵelementStart(1, "div", 2);
    ɵngcc0.ɵɵlistener("itemClick", function TimelineViewComponent_ng_template_0_Template_div_itemClick_1_listener() { ɵngcc0.ɵɵrestoreView(_r3); const ctx_r2 = ɵngcc0.ɵɵnextContext(); return ctx_r2.showWorkHours = !ctx_r2.shouldShowWorkHours; });
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    const ctx_r1 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵproperty("name", ctx_r1.name)("eventHeight", ctx_r1.viewEventHeight)("columnWidth", ctx_r1.viewColumnWidth)("currentTimeMarker", ctx_r1.viewCurrentTimeMarker)("showWorkHours", ctx_r1.shouldShowWorkHours)("scrollTime", ctx_r1.viewScrollTime)("startTime", ctx_r1.viewStartTime)("endTime", ctx_r1.viewEndTime)("workDayStart", ctx_r1.viewWorkDayStart)("workDayEnd", ctx_r1.viewWorkDayEnd)("workWeekStart", ctx_r1.viewWorkWeekStart)("workWeekEnd", ctx_r1.viewWorkWeekEnd)("slotDuration", ctx_r1.viewSlotDuration)("slotDivisions", ctx_r1.viewSlotDivisions)("slotClass", ctx_r1.viewSlotClass)("eventClass", ctx_r1.viewEventClass)("eventStyles", ctx_r1.viewEventStyles)("\u0435ventTemplate", ctx_r1.eventTemplate == null ? null : ctx_r1.eventTemplate.templateRef)("groupHeaderTemplate", ctx_r1.groupHeaderTemplate == null ? null : ctx_r1.groupHeaderTemplate.templateRef)("timeSlotTemplate", ctx_r1.timeSlotTemplate == null ? null : ctx_r1.timeSlotTemplate.templateRef)("dateHeaderTemplate", ctx_r1.dateHeaderTemplate == null ? null : ctx_r1.dateHeaderTemplate.templateRef)("selectedDateFormat", ctx_r1.selectedDateFormat)("selectedShortDateFormat", ctx_r1.selectedShortDateFormat);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("showWorkHours", ctx_r1.shouldShowWorkHours);
} }
function TimelineWeekViewComponent_ng_template_0_Template(rf, ctx) { if (rf & 1) {
    const _r3 = ɵngcc0.ɵɵgetCurrentView();
    ɵngcc0.ɵɵelement(0, "timeline-multi-day-view", 1);
    ɵngcc0.ɵɵelementStart(1, "div", 2);
    ɵngcc0.ɵɵlistener("itemClick", function TimelineWeekViewComponent_ng_template_0_Template_div_itemClick_1_listener() { ɵngcc0.ɵɵrestoreView(_r3); const ctx_r2 = ɵngcc0.ɵɵnextContext(); return ctx_r2.showWorkHours = !ctx_r2.shouldShowWorkHours; });
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    const ctx_r1 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵproperty("name", ctx_r1.name)("numberOfDays", 7)("getStartDate", ctx_r1.getStartDate)("eventHeight", ctx_r1.viewEventHeight)("columnWidth", ctx_r1.viewColumnWidth)("currentTimeMarker", ctx_r1.viewCurrentTimeMarker)("showWorkHours", ctx_r1.shouldShowWorkHours)("scrollTime", ctx_r1.viewScrollTime)("startTime", ctx_r1.viewStartTime)("endTime", ctx_r1.viewEndTime)("workDayStart", ctx_r1.viewWorkDayStart)("workDayEnd", ctx_r1.viewWorkDayEnd)("workWeekStart", ctx_r1.viewWorkWeekStart)("workWeekEnd", ctx_r1.viewWorkWeekEnd)("slotDuration", ctx_r1.viewSlotDuration)("slotDivisions", ctx_r1.viewSlotDivisions)("slotClass", ctx_r1.viewSlotClass)("eventClass", ctx_r1.viewEventClass)("eventStyles", ctx_r1.viewEventStyles)("\u0435ventTemplate", ctx_r1.eventTemplate == null ? null : ctx_r1.eventTemplate.templateRef)("groupHeaderTemplate", ctx_r1.groupHeaderTemplate == null ? null : ctx_r1.groupHeaderTemplate.templateRef)("timeSlotTemplate", ctx_r1.timeSlotTemplate == null ? null : ctx_r1.timeSlotTemplate.templateRef)("dateHeaderTemplate", ctx_r1.dateHeaderTemplate == null ? null : ctx_r1.dateHeaderTemplate.templateRef)("selectedDateFormat", ctx_r1.selectedDateFormat)("selectedShortDateFormat", ctx_r1.selectedShortDateFormat);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("showWorkHours", ctx_r1.shouldShowWorkHours);
} }
function TimelineMonthViewComponent_ng_template_0_Template(rf, ctx) { if (rf & 1) {
    const _r3 = ɵngcc0.ɵɵgetCurrentView();
    ɵngcc0.ɵɵelement(0, "timeline-multi-day-view", 1);
    ɵngcc0.ɵɵelementStart(1, "div", 2);
    ɵngcc0.ɵɵlistener("itemClick", function TimelineMonthViewComponent_ng_template_0_Template_div_itemClick_1_listener() { ɵngcc0.ɵɵrestoreView(_r3); const ctx_r2 = ɵngcc0.ɵɵnextContext(); return ctx_r2.showWorkHours = !ctx_r2.shouldShowWorkHours; });
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    const ctx_r1 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵproperty("name", ctx_r1.name)("getNextDate", ctx_r1.getNextDate)("getStartDate", ctx_r1.getStartDate)("getEndDate", ctx_r1.getEndDate)("eventHeight", ctx_r1.viewEventHeight)("columnWidth", ctx_r1.viewColumnWidth)("currentTimeMarker", ctx_r1.viewCurrentTimeMarker)("showWorkHours", ctx_r1.shouldShowWorkHours)("scrollTime", ctx_r1.viewScrollTime)("startTime", ctx_r1.viewStartTime)("endTime", ctx_r1.viewEndTime)("workDayStart", ctx_r1.viewWorkDayStart)("workDayEnd", ctx_r1.viewWorkDayEnd)("workWeekStart", ctx_r1.viewWorkWeekStart)("workWeekEnd", ctx_r1.viewWorkWeekEnd)("slotDuration", ctx_r1.viewSlotDuration)("slotDivisions", ctx_r1.viewSlotDivisions)("slotClass", ctx_r1.viewSlotClass)("eventClass", ctx_r1.viewEventClass)("eventStyles", ctx_r1.viewEventStyles)("\u0435ventTemplate", ctx_r1.eventTemplate == null ? null : ctx_r1.eventTemplate.templateRef)("groupHeaderTemplate", ctx_r1.groupHeaderTemplate == null ? null : ctx_r1.groupHeaderTemplate.templateRef)("timeSlotTemplate", ctx_r1.timeSlotTemplate == null ? null : ctx_r1.timeSlotTemplate.templateRef)("dateHeaderTemplate", ctx_r1.dateHeaderTemplate == null ? null : ctx_r1.dateHeaderTemplate.templateRef)("selectedDateFormat", ctx_r1.selectedDateFormat)("selectedShortDateFormat", ctx_r1.selectedShortDateFormat);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("showWorkHours", ctx_r1.shouldShowWorkHours);
} }
const _c191 = ["resourceMultiSelect"];
function MultipleResourceEditorComponent_ng_template_2_span_0_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelement(0, "span", 5);
} if (rf & 2) {
    const dataItem_r3 = ɵngcc0.ɵɵnextContext().$implicit;
    const ctx_r4 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵproperty("ngStyle", ctx_r4.getResourceStyle(dataItem_r3));
} }
function MultipleResourceEditorComponent_ng_template_2_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵtemplate(0, MultipleResourceEditorComponent_ng_template_2_span_0_Template, 1, 1, "span", 4);
    ɵngcc0.ɵɵtext(1);
} if (rf & 2) {
    const dataItem_r3 = ctx.$implicit;
    const ctx_r1 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵproperty("ngIf", ctx_r1.resource.colorField);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵtextInterpolate1(" ", ctx_r1.getField(dataItem_r3, ctx_r1.resource.textField), " ");
} }
function MultipleResourceEditorComponent_ng_template_3_span_0_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelement(0, "span", 5);
} if (rf & 2) {
    const dataItem_r6 = ɵngcc0.ɵɵnextContext().$implicit;
    const ctx_r7 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵproperty("ngStyle", ctx_r7.getTagStyle(dataItem_r6));
} }
function MultipleResourceEditorComponent_ng_template_3_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵtemplate(0, MultipleResourceEditorComponent_ng_template_3_span_0_Template, 1, 1, "span", 4);
    ɵngcc0.ɵɵtext(1);
} if (rf & 2) {
    const dataItem_r6 = ctx.$implicit;
    const ctx_r2 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵproperty("ngIf", ctx_r2.resource.colorField);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵtextInterpolate1(" ", ctx_r2.getField(dataItem_r6, ctx_r2.resource.textField), " ");
} }
const _c192 = ["resourceDropDown"];
function SingleResourceEditorComponent_ng_template_2_span_0_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelement(0, "span", 4);
} if (rf & 2) {
    const dataItem_r2 = ɵngcc0.ɵɵnextContext().$implicit;
    const ctx_r3 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵproperty("ngStyle", ctx_r3.getResourceStyle(dataItem_r2));
} }
function SingleResourceEditorComponent_ng_template_2_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵtemplate(0, SingleResourceEditorComponent_ng_template_2_span_0_Template, 1, 1, "span", 3);
    ɵngcc0.ɵɵtext(1);
} if (rf & 2) {
    const dataItem_r2 = ctx.$implicit;
    const ctx_r1 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵproperty("ngIf", ctx_r1.resource.colorField);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵtextInterpolate1(" ", ctx_r1.getField(dataItem_r2, ctx_r1.resource.textField), " ");
} }
function EditDialogComponent_kendo_dialog_0_ng_container_1_ng_container_16_Template(rf, ctx) { if (rf & 1) {
    const _r15 = ɵngcc0.ɵɵgetCurrentView();
    ɵngcc0.ɵɵelementContainerStart(0);
    ɵngcc0.ɵɵelementStart(1, "div", 8);
    ɵngcc0.ɵɵelementStart(2, "label", 13);
    ɵngcc0.ɵɵlistener("click", function EditDialogComponent_kendo_dialog_0_ng_container_1_ng_container_16_Template_label_click_2_listener() { ɵngcc0.ɵɵrestoreView(_r15); const _r13 = ɵngcc0.ɵɵreference(6); return _r13.focus(); });
    ɵngcc0.ɵɵtext(3);
    ɵngcc0.ɵɵelementEnd();
    ɵngcc0.ɵɵelementEnd();
    ɵngcc0.ɵɵelementStart(4, "div", 10);
    ɵngcc0.ɵɵelement(5, "kendo-timezone-editor", 19, 20);
    ɵngcc0.ɵɵelementEnd();
    ɵngcc0.ɵɵelementContainerEnd();
} if (rf & 2) {
    const ctx_r5 = ɵngcc0.ɵɵnextContext(3);
    ɵngcc0.ɵɵadvance(3);
    ɵngcc0.ɵɵtextInterpolate(ctx_r5.textFor("editorEventStartTimeZone"));
    ɵngcc0.ɵɵadvance(2);
    ɵngcc0.ɵɵproperty("formControl", ctx_r5.formGroup.get(ctx_r5.fields.startTimezone));
} }
function EditDialogComponent_kendo_dialog_0_ng_container_1_ng_container_23_Template(rf, ctx) { if (rf & 1) {
    const _r18 = ɵngcc0.ɵɵgetCurrentView();
    ɵngcc0.ɵɵelementContainerStart(0);
    ɵngcc0.ɵɵelementStart(1, "div", 8);
    ɵngcc0.ɵɵelementStart(2, "label", 13);
    ɵngcc0.ɵɵlistener("click", function EditDialogComponent_kendo_dialog_0_ng_container_1_ng_container_23_Template_label_click_2_listener() { ɵngcc0.ɵɵrestoreView(_r18); const _r16 = ɵngcc0.ɵɵreference(6); return _r16.focus(); });
    ɵngcc0.ɵɵtext(3);
    ɵngcc0.ɵɵelementEnd();
    ɵngcc0.ɵɵelementEnd();
    ɵngcc0.ɵɵelementStart(4, "div", 10);
    ɵngcc0.ɵɵelement(5, "kendo-timezone-editor", 19, 21);
    ɵngcc0.ɵɵelementEnd();
    ɵngcc0.ɵɵelementContainerEnd();
} if (rf & 2) {
    const ctx_r7 = ɵngcc0.ɵɵnextContext(3);
    ɵngcc0.ɵɵadvance(3);
    ɵngcc0.ɵɵtextInterpolate(ctx_r7.textFor("editorEventEndTimeZone"));
    ɵngcc0.ɵɵadvance(2);
    ɵngcc0.ɵɵproperty("formControl", ctx_r7.formGroup.get(ctx_r7.fields.endTimezone));
} }
function EditDialogComponent_kendo_dialog_0_ng_container_1_div_24_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementStart(0, "div", 10);
    ɵngcc0.ɵɵelement(1, "input", 22);
    ɵngcc0.ɵɵelementStart(2, "label", 23);
    ɵngcc0.ɵɵtext(3);
    ɵngcc0.ɵɵelementEnd();
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    const ctx_r8 = ɵngcc0.ɵɵnextContext(3);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("formControl", ctx_r8.formGroup.get(ctx_r8.fields.isAllDay));
    ɵngcc0.ɵɵadvance(2);
    ɵngcc0.ɵɵtextInterpolate(ctx_r8.textFor("editorEventAllDay"));
} }
function EditDialogComponent_kendo_dialog_0_ng_container_1_div_25_ng_container_4_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementContainerStart(0);
    ɵngcc0.ɵɵelement(1, "input", 26);
    ɵngcc0.ɵɵelementStart(2, "label", 27);
    ɵngcc0.ɵɵtext(3);
    ɵngcc0.ɵɵelementEnd();
    ɵngcc0.ɵɵelementContainerEnd();
} if (rf & 2) {
    const ctx_r19 = ɵngcc0.ɵɵnextContext(4);
    ɵngcc0.ɵɵadvance(3);
    ɵngcc0.ɵɵtextInterpolate(ctx_r19.textFor("editorEventSeparateTimeZones"));
} }
function EditDialogComponent_kendo_dialog_0_ng_container_1_div_25_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementStart(0, "div", 10);
    ɵngcc0.ɵɵelement(1, "input", 24);
    ɵngcc0.ɵɵelementStart(2, "label", 25);
    ɵngcc0.ɵɵtext(3);
    ɵngcc0.ɵɵelementEnd();
    ɵngcc0.ɵɵtemplate(4, EditDialogComponent_kendo_dialog_0_ng_container_1_div_25_ng_container_4_Template, 4, 1, "ng-container", 2);
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    const ctx_r9 = ɵngcc0.ɵɵnextContext(3);
    ɵngcc0.ɵɵadvance(3);
    ɵngcc0.ɵɵtextInterpolate(ctx_r9.textFor("editorEventTimeZone"));
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngIf", ctx_r9.isStartTimeZoneVisible && ctx_r9.hasEndTimeZone);
} }
function EditDialogComponent_kendo_dialog_0_ng_container_1_ng_container_26_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementContainerStart(0);
    ɵngcc0.ɵɵelement(1, "kendo-recurrence-editor", 28);
    ɵngcc0.ɵɵelementContainerEnd();
} if (rf & 2) {
    const ctx_r10 = ɵngcc0.ɵɵnextContext(3);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("formControl", ctx_r10.formGroup.get(ctx_r10.fields.recurrenceRule))("start", ctx_r10.recurrenceStart)("timezone", ctx_r10.eventTimezone);
} }
function EditDialogComponent_kendo_dialog_0_ng_container_1_ng_container_27_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementContainerStart(0);
    ɵngcc0.ɵɵelementStart(1, "div", 8);
    ɵngcc0.ɵɵelementStart(2, "label", 29);
    ɵngcc0.ɵɵtext(3);
    ɵngcc0.ɵɵelementEnd();
    ɵngcc0.ɵɵelementEnd();
    ɵngcc0.ɵɵelementStart(4, "div", 10);
    ɵngcc0.ɵɵelement(5, "textarea", 30);
    ɵngcc0.ɵɵelementEnd();
    ɵngcc0.ɵɵelementContainerEnd();
} if (rf & 2) {
    const ctx_r11 = ɵngcc0.ɵɵnextContext(3);
    ɵngcc0.ɵɵadvance(3);
    ɵngcc0.ɵɵtextInterpolate(ctx_r11.textFor("editorEventDescription"));
    ɵngcc0.ɵɵadvance(2);
    ɵngcc0.ɵɵproperty("formControl", ctx_r11.formGroup.get(ctx_r11.fields.description));
} }
function EditDialogComponent_kendo_dialog_0_ng_container_1_ng_container_28_ng_container_1_kendo_multiple_resource_editor_5_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelement(0, "kendo-multiple-resource-editor", 32);
} if (rf & 2) {
    const resource_r20 = ɵngcc0.ɵɵnextContext(2).$implicit;
    const ctx_r22 = ɵngcc0.ɵɵnextContext(3);
    ɵngcc0.ɵɵproperty("formControl", ctx_r22.formGroup.get(resource_r20.field))("resource", resource_r20);
} }
function EditDialogComponent_kendo_dialog_0_ng_container_1_ng_container_28_ng_container_1_kendo_single_resource_editor_6_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelement(0, "kendo-single-resource-editor", 32);
} if (rf & 2) {
    const resource_r20 = ɵngcc0.ɵɵnextContext(2).$implicit;
    const ctx_r23 = ɵngcc0.ɵɵnextContext(3);
    ɵngcc0.ɵɵproperty("formControl", ctx_r23.formGroup.get(resource_r20.field))("resource", resource_r20);
} }
function EditDialogComponent_kendo_dialog_0_ng_container_1_ng_container_28_ng_container_1_Template(rf, ctx) { if (rf & 1) {
    const _r28 = ɵngcc0.ɵɵgetCurrentView();
    ɵngcc0.ɵɵelementContainerStart(0);
    ɵngcc0.ɵɵelementStart(1, "div", 8);
    ɵngcc0.ɵɵelementStart(2, "label", 13);
    ɵngcc0.ɵɵlistener("click", function EditDialogComponent_kendo_dialog_0_ng_container_1_ng_container_28_ng_container_1_Template_label_click_2_listener() { ɵngcc0.ɵɵrestoreView(_r28); const resource_r20 = ɵngcc0.ɵɵnextContext().$implicit; const ctx_r26 = ɵngcc0.ɵɵnextContext(3); return ctx_r26.onResourceClick(resource_r20); });
    ɵngcc0.ɵɵtext(3);
    ɵngcc0.ɵɵelementEnd();
    ɵngcc0.ɵɵelementEnd();
    ɵngcc0.ɵɵelementStart(4, "div", 10);
    ɵngcc0.ɵɵtemplate(5, EditDialogComponent_kendo_dialog_0_ng_container_1_ng_container_28_ng_container_1_kendo_multiple_resource_editor_5_Template, 1, 2, "kendo-multiple-resource-editor", 31);
    ɵngcc0.ɵɵtemplate(6, EditDialogComponent_kendo_dialog_0_ng_container_1_ng_container_28_ng_container_1_kendo_single_resource_editor_6_Template, 1, 2, "kendo-single-resource-editor", 31);
    ɵngcc0.ɵɵelementEnd();
    ɵngcc0.ɵɵelementContainerEnd();
} if (rf & 2) {
    const resource_r20 = ɵngcc0.ɵɵnextContext().$implicit;
    ɵngcc0.ɵɵadvance(3);
    ɵngcc0.ɵɵtextInterpolate1(" ", resource_r20.name ? resource_r20.name : resource_r20.field, " ");
    ɵngcc0.ɵɵadvance(2);
    ɵngcc0.ɵɵproperty("ngIf", resource_r20.multiple);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngIf", !resource_r20.multiple);
} }
function EditDialogComponent_kendo_dialog_0_ng_container_1_ng_container_28_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementContainerStart(0);
    ɵngcc0.ɵɵtemplate(1, EditDialogComponent_kendo_dialog_0_ng_container_1_ng_container_28_ng_container_1_Template, 7, 3, "ng-container", 2);
    ɵngcc0.ɵɵelementContainerEnd();
} if (rf & 2) {
    const resource_r20 = ctx.$implicit;
    const ctx_r12 = ɵngcc0.ɵɵnextContext(3);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngIf", ctx_r12.getFormValue(resource_r20.field));
} }
function EditDialogComponent_kendo_dialog_0_ng_container_1_Template(rf, ctx) { if (rf & 1) {
    const _r31 = ɵngcc0.ɵɵgetCurrentView();
    ɵngcc0.ɵɵelementContainerStart(0);
    ɵngcc0.ɵɵelementStart(1, "div", 5);
    ɵngcc0.ɵɵelementStart(2, "div", 6);
    ɵngcc0.ɵɵelementStart(3, "form", 7);
    ɵngcc0.ɵɵelementStart(4, "div", 8);
    ɵngcc0.ɵɵelementStart(5, "label", 9);
    ɵngcc0.ɵɵtext(6);
    ɵngcc0.ɵɵelementEnd();
    ɵngcc0.ɵɵelementEnd();
    ɵngcc0.ɵɵelementStart(7, "div", 10);
    ɵngcc0.ɵɵelement(8, "input", 11, 12);
    ɵngcc0.ɵɵelementEnd();
    ɵngcc0.ɵɵelementStart(10, "div", 8);
    ɵngcc0.ɵɵelementStart(11, "label", 13);
    ɵngcc0.ɵɵlistener("click", function EditDialogComponent_kendo_dialog_0_ng_container_1_Template_label_click_11_listener() { ɵngcc0.ɵɵrestoreView(_r31); const _r4 = ɵngcc0.ɵɵreference(15); return _r4.focus(); });
    ɵngcc0.ɵɵtext(12);
    ɵngcc0.ɵɵelementEnd();
    ɵngcc0.ɵɵelementEnd();
    ɵngcc0.ɵɵelementStart(13, "div", 10);
    ɵngcc0.ɵɵelement(14, "kendo-scheduler-datetime-picker", 14, 15);
    ɵngcc0.ɵɵelementEnd();
    ɵngcc0.ɵɵtemplate(16, EditDialogComponent_kendo_dialog_0_ng_container_1_ng_container_16_Template, 7, 2, "ng-container", 2);
    ɵngcc0.ɵɵelementStart(17, "div", 8);
    ɵngcc0.ɵɵelementStart(18, "label", 13);
    ɵngcc0.ɵɵlistener("click", function EditDialogComponent_kendo_dialog_0_ng_container_1_Template_label_click_18_listener() { ɵngcc0.ɵɵrestoreView(_r31); const _r6 = ɵngcc0.ɵɵreference(22); return _r6.focus(); });
    ɵngcc0.ɵɵtext(19);
    ɵngcc0.ɵɵelementEnd();
    ɵngcc0.ɵɵelementEnd();
    ɵngcc0.ɵɵelementStart(20, "div", 10);
    ɵngcc0.ɵɵelement(21, "kendo-scheduler-datetime-picker", 14, 16);
    ɵngcc0.ɵɵelementEnd();
    ɵngcc0.ɵɵtemplate(23, EditDialogComponent_kendo_dialog_0_ng_container_1_ng_container_23_Template, 7, 2, "ng-container", 2);
    ɵngcc0.ɵɵtemplate(24, EditDialogComponent_kendo_dialog_0_ng_container_1_div_24_Template, 4, 2, "div", 17);
    ɵngcc0.ɵɵtemplate(25, EditDialogComponent_kendo_dialog_0_ng_container_1_div_25_Template, 5, 2, "div", 17);
    ɵngcc0.ɵɵtemplate(26, EditDialogComponent_kendo_dialog_0_ng_container_1_ng_container_26_Template, 2, 3, "ng-container", 2);
    ɵngcc0.ɵɵtemplate(27, EditDialogComponent_kendo_dialog_0_ng_container_1_ng_container_27_Template, 6, 2, "ng-container", 2);
    ɵngcc0.ɵɵtemplate(28, EditDialogComponent_kendo_dialog_0_ng_container_1_ng_container_28_Template, 2, 1, "ng-container", 18);
    ɵngcc0.ɵɵelementEnd();
    ɵngcc0.ɵɵelementEnd();
    ɵngcc0.ɵɵelementEnd();
    ɵngcc0.ɵɵelementContainerEnd();
} if (rf & 2) {
    const ctx_r1 = ɵngcc0.ɵɵnextContext(2);
    var tmp_5_0 = null;
    const currVal_5 = (tmp_5_0 = ctx_r1.getFormValue(ctx_r1.fields.isAllDay)) == null ? null : tmp_5_0.value;
    var tmp_9_0 = null;
    const currVal_9 = (tmp_9_0 = ctx_r1.getFormValue(ctx_r1.fields.isAllDay)) == null ? null : tmp_9_0.value;
    ɵngcc0.ɵɵadvance(3);
    ɵngcc0.ɵɵproperty("formGroup", ctx_r1.formGroup);
    ɵngcc0.ɵɵadvance(3);
    ɵngcc0.ɵɵtextInterpolate(ctx_r1.textFor("editorEventTitle"));
    ɵngcc0.ɵɵadvance(2);
    ɵngcc0.ɵɵproperty("formControl", ctx_r1.formGroup.get(ctx_r1.fields.title));
    ɵngcc0.ɵɵadvance(4);
    ɵngcc0.ɵɵtextInterpolate(ctx_r1.textFor("editorEventStart"));
    ɵngcc0.ɵɵadvance(2);
    ɵngcc0.ɵɵproperty("formControl", ctx_r1.formGroup.get(ctx_r1.fields.start))("isAllDay", currVal_5);
    ɵngcc0.ɵɵadvance(2);
    ɵngcc0.ɵɵproperty("ngIf", ctx_r1.isStartTimeZoneVisible);
    ɵngcc0.ɵɵadvance(3);
    ɵngcc0.ɵɵtextInterpolate(ctx_r1.textFor("editorEventEnd"));
    ɵngcc0.ɵɵadvance(2);
    ɵngcc0.ɵɵproperty("formControl", ctx_r1.formGroup.get(ctx_r1.fields.end))("isAllDay", currVal_9);
    ɵngcc0.ɵɵadvance(2);
    ɵngcc0.ɵɵproperty("ngIf", ctx_r1.isEndTimeZoneVisible);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngIf", ctx_r1.hasAllDay);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngIf", ctx_r1.hasStartTimeZone);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngIf", ctx_r1.isEditingSeries);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngIf", ctx_r1.getFormValue(ctx_r1.fields.description));
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngForOf", ctx_r1.resources);
} }
const _c193 = function (a0, a1, a2, a3, a4) { return { $implicit: a0, formGroup: a1, dataItem: a2, editMode: a3, isNew: a4 }; };
function EditDialogComponent_kendo_dialog_0_ng_container_2_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementContainerStart(0);
    ɵngcc0.ɵɵelementStart(1, "form", 7);
    ɵngcc0.ɵɵelementContainer(2, 33);
    ɵngcc0.ɵɵelementEnd();
    ɵngcc0.ɵɵelementContainerEnd();
} if (rf & 2) {
    const ctx_r2 = ɵngcc0.ɵɵnextContext(2);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("formGroup", ctx_r2.formGroup);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngTemplateOutlet", ctx_r2.editTemplate.templateRef)("ngTemplateOutletContext", ɵngcc0.ɵɵpureFunction5(3, _c193, ctx_r2.formGroup, ctx_r2.formGroup, ctx_r2.editedEvent, ctx_r2.editMode, ctx_r2.isNew));
} }
function EditDialogComponent_kendo_dialog_0_Template(rf, ctx) { if (rf & 1) {
    const _r34 = ɵngcc0.ɵɵgetCurrentView();
    ɵngcc0.ɵɵelementStart(0, "kendo-dialog", 1);
    ɵngcc0.ɵɵlistener("close", function EditDialogComponent_kendo_dialog_0_Template_kendo_dialog_close_0_listener() { ɵngcc0.ɵɵrestoreView(_r34); const ctx_r33 = ɵngcc0.ɵɵnextContext(); return ctx_r33.onClose(); });
    ɵngcc0.ɵɵtemplate(1, EditDialogComponent_kendo_dialog_0_ng_container_1_Template, 29, 16, "ng-container", 2);
    ɵngcc0.ɵɵtemplate(2, EditDialogComponent_kendo_dialog_0_ng_container_2_Template, 3, 9, "ng-container", 2);
    ɵngcc0.ɵɵelementStart(3, "kendo-dialog-actions");
    ɵngcc0.ɵɵelementStart(4, "button", 3);
    ɵngcc0.ɵɵlistener("click", function EditDialogComponent_kendo_dialog_0_Template_button_click_4_listener($event) { ɵngcc0.ɵɵrestoreView(_r34); const ctx_r35 = ɵngcc0.ɵɵnextContext(); return ctx_r35.onCancel($event); });
    ɵngcc0.ɵɵtext(5);
    ɵngcc0.ɵɵelementEnd();
    ɵngcc0.ɵɵelementStart(6, "button", 4);
    ɵngcc0.ɵɵlistener("click", function EditDialogComponent_kendo_dialog_0_Template_button_click_6_listener($event) { ɵngcc0.ɵɵrestoreView(_r34); const ctx_r36 = ɵngcc0.ɵɵnextContext(); return ctx_r36.onSave($event); });
    ɵngcc0.ɵɵtext(7);
    ɵngcc0.ɵɵelementEnd();
    ɵngcc0.ɵɵelementEnd();
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    const ctx_r0 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵpropertyInterpolate("title", ctx_r0.textFor("editorTitle"));
    ɵngcc0.ɵɵproperty("minWidth", 700)("autoFocusedElement", ctx_r0.autoFocusedElement);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngIf", !ctx_r0.editTemplate);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngIf", ctx_r0.editTemplate);
    ɵngcc0.ɵɵadvance(3);
    ɵngcc0.ɵɵtextInterpolate(ctx_r0.textFor("cancel"));
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("disabled", !ctx_r0.formGroup.valid);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵtextInterpolate(ctx_r0.textFor("save"));
} }
const _c194 = ["datepicker"];
function SchedulerDateTimePickerComponent_kendo_timepicker_2_Template(rf, ctx) { if (rf & 1) {
    const _r3 = ɵngcc0.ɵɵgetCurrentView();
    ɵngcc0.ɵɵelementStart(0, "kendo-timepicker", 0);
    ɵngcc0.ɵɵlistener("valueChange", function SchedulerDateTimePickerComponent_kendo_timepicker_2_Template_kendo_timepicker_valueChange_0_listener($event) { ɵngcc0.ɵɵrestoreView(_r3); const ctx_r2 = ɵngcc0.ɵɵnextContext(); return ctx_r2.date = $event; })("valueChange", function SchedulerDateTimePickerComponent_kendo_timepicker_2_Template_kendo_timepicker_valueChange_0_listener($event) { ɵngcc0.ɵɵrestoreView(_r3); const ctx_r4 = ɵngcc0.ɵɵnextContext(); return ctx_r4.onValueChange($event); });
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    const ctx_r1 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵproperty("value", ctx_r1.date);
} }
var I18N_195;
if (typeof ngI18nClosureMode !== "undefined" && ngI18nClosureMode) {
    /**
     * @desc The text similar to 'Repeat' displayed in the recurrence editor.
     * @meaning kendo.recurrenceeditor.repeat
     */ 
    const MSG_EXTERNAL_8788943645292671161$$DIST_FESM2015_INDEX_JS_196 = goog.getMsg("Repeat");
    I18N_195 = MSG_EXTERNAL_8788943645292671161$$DIST_FESM2015_INDEX_JS_196;
}
else {
    I18N_195 = $localize `:kendo.recurrenceeditor.repeat|The text similar to 'Repeat' displayed in the recurrence editor.␟0bddaa66242efa61597c2f4ea98fa691334f7fba␟8788943645292671161:Repeat`;
}
var I18N_197;
if (typeof ngI18nClosureMode !== "undefined" && ngI18nClosureMode) {
    /**
     * @desc The text similar to 'day(s)' displayed in the recurrence editor.
     * @meaning kendo.recurrenceeditor.dailyInterval
     */ 
    const MSG_EXTERNAL_1576286772964686531$$DIST_FESM2015_INDEX_JS_198 = goog.getMsg("day(s)");
    I18N_197 = MSG_EXTERNAL_1576286772964686531$$DIST_FESM2015_INDEX_JS_198;
}
else {
    I18N_197 = $localize `:kendo.recurrenceeditor.dailyInterval|The text similar to 'day(s)' displayed in the recurrence editor.␟c18849e2cc957d8bbf3733a1f4f01fec4297e5a1␟1576286772964686531:day(s)`;
}
var I18N_199;
if (typeof ngI18nClosureMode !== "undefined" && ngI18nClosureMode) {
    /**
     * @desc The text similar to 'Repeat every' displayed in the recurrence editor.
     * @meaning kendo.recurrenceeditor.dailyRepeatEvery
     */ 
    const MSG_EXTERNAL_2375882472818653457$$DIST_FESM2015_INDEX_JS_200 = goog.getMsg("Repeat every");
    I18N_199 = MSG_EXTERNAL_2375882472818653457$$DIST_FESM2015_INDEX_JS_200;
}
else {
    I18N_199 = $localize `:kendo.recurrenceeditor.dailyRepeatEvery|The text similar to 'Repeat every' displayed in the recurrence editor.␟cbf6305b6f982851bbdda0effa9e867ff03cc1bf␟2375882472818653457:Repeat every`;
}
var I18N_201;
if (typeof ngI18nClosureMode !== "undefined" && ngI18nClosureMode) {
    /**
     * @desc The text similar to 'week(s)' displayed in the recurrence editor.
     * @meaning kendo.recurrenceeditor.weeklyInterval
     */ 
    const MSG_EXTERNAL_7243646588531721642$$DIST_FESM2015_INDEX_JS_202 = goog.getMsg("week(s)");
    I18N_201 = MSG_EXTERNAL_7243646588531721642$$DIST_FESM2015_INDEX_JS_202;
}
else {
    I18N_201 = $localize `:kendo.recurrenceeditor.weeklyInterval|The text similar to 'week(s)' displayed in the recurrence editor.␟b3ff8ea01cbbce5dc48f1a03009554bdd8359e1a␟7243646588531721642:week(s)`;
}
var I18N_203;
if (typeof ngI18nClosureMode !== "undefined" && ngI18nClosureMode) {
    /**
     * @desc The text similar to 'Repeat every' displayed in the recurrence editor.
     * @meaning kendo.recurrenceeditor.weeklyRepeatEvery
     */ 
    const MSG_EXTERNAL_4914310067503948792$$DIST_FESM2015_INDEX_JS_204 = goog.getMsg("Repeat every");
    I18N_203 = MSG_EXTERNAL_4914310067503948792$$DIST_FESM2015_INDEX_JS_204;
}
else {
    I18N_203 = $localize `:kendo.recurrenceeditor.weeklyRepeatEvery|The text similar to 'Repeat every' displayed in the recurrence editor.␟1d44b28d927b787264bfd885753bd6ad00caed66␟4914310067503948792:Repeat every`;
}
var I18N_205;
if (typeof ngI18nClosureMode !== "undefined" && ngI18nClosureMode) {
    /**
     * @desc The text similar to 'Repeat on' displayed in the recurrence editor.
     * @meaning kendo.recurrenceeditor.weeklyRepeatOn
     */ 
    const MSG_EXTERNAL_4147240639502605432$$DIST_FESM2015_INDEX_JS_206 = goog.getMsg("Repeat on");
    I18N_205 = MSG_EXTERNAL_4147240639502605432$$DIST_FESM2015_INDEX_JS_206;
}
else {
    I18N_205 = $localize `:kendo.recurrenceeditor.weeklyRepeatOn|The text similar to 'Repeat on' displayed in the recurrence editor.␟3f4e866782d53b9ff28ce8b97c44db237849b9e5␟4147240639502605432:Repeat on`;
}
var I18N_207;
if (typeof ngI18nClosureMode !== "undefined" && ngI18nClosureMode) {
    /**
     * @desc The text similar to 'Day' displayed in the recurrence editor.
     * @meaning kendo.recurrenceeditor.monthlyDay
     */ 
    const MSG_EXTERNAL_7227479698248140015$$DIST_FESM2015_INDEX_JS_208 = goog.getMsg("Day");
    I18N_207 = MSG_EXTERNAL_7227479698248140015$$DIST_FESM2015_INDEX_JS_208;
}
else {
    I18N_207 = $localize `:kendo.recurrenceeditor.monthlyDay|The text similar to 'Day' displayed in the recurrence editor.␟9b85d49beeaad4557a98421bad0f102dfe19ba70␟7227479698248140015:Day`;
}
var I18N_209;
if (typeof ngI18nClosureMode !== "undefined" && ngI18nClosureMode) {
    /**
     * @desc The text similar to 'month(s)' displayed in the recurrence editor.
     * @meaning kendo.recurrenceeditor.monthlyInterval
     */ 
    const MSG_EXTERNAL_4064971617373785103$$DIST_FESM2015_INDEX_JS_210 = goog.getMsg("month(s)");
    I18N_209 = MSG_EXTERNAL_4064971617373785103$$DIST_FESM2015_INDEX_JS_210;
}
else {
    I18N_209 = $localize `:kendo.recurrenceeditor.monthlyInterval|The text similar to 'month(s)' displayed in the recurrence editor.␟1eac62ae640aaf56db966bac5d9defe3a5076465␟4064971617373785103:month(s)`;
}
var I18N_211;
if (typeof ngI18nClosureMode !== "undefined" && ngI18nClosureMode) {
    /**
     * @desc The text similar to 'Repeat every' displayed in the recurrence editor.
     * @meaning kendo.recurrenceeditor.monthlyRepeatEvery
     */ 
    const MSG_EXTERNAL_8052133877234013470$$DIST_FESM2015_INDEX_JS_212 = goog.getMsg("Repeat every");
    I18N_211 = MSG_EXTERNAL_8052133877234013470$$DIST_FESM2015_INDEX_JS_212;
}
else {
    I18N_211 = $localize `:kendo.recurrenceeditor.monthlyRepeatEvery|The text similar to 'Repeat every' displayed in the recurrence editor.␟2c39073af72965a0f514731ca875d5a446ffe917␟8052133877234013470:Repeat every`;
}
var I18N_213;
if (typeof ngI18nClosureMode !== "undefined" && ngI18nClosureMode) {
    /**
     * @desc The text similar to 'Repeat on' displayed in the recurrence editor.
     * @meaning kendo.recurrenceeditor.monthlyRepeatOn
     */ 
    const MSG_EXTERNAL_5679551064569721903$$DIST_FESM2015_INDEX_JS_214 = goog.getMsg("Repeat on");
    I18N_213 = MSG_EXTERNAL_5679551064569721903$$DIST_FESM2015_INDEX_JS_214;
}
else {
    I18N_213 = $localize `:kendo.recurrenceeditor.monthlyRepeatOn|The text similar to 'Repeat on' displayed in the recurrence editor.␟5757939708602b87c6542208bb85e4c3dc1adca2␟5679551064569721903:Repeat on`;
}
var I18N_215;
if (typeof ngI18nClosureMode !== "undefined" && ngI18nClosureMode) {
    /**
     * @desc The text similar to 'of' displayed in the recurrence editor.
     * @meaning kendo.recurrenceeditor.yearlyOf
     */ 
    const MSG_EXTERNAL_4042178120150268671$$DIST_FESM2015_INDEX_JS_216 = goog.getMsg("of");
    I18N_215 = MSG_EXTERNAL_4042178120150268671$$DIST_FESM2015_INDEX_JS_216;
}
else {
    I18N_215 = $localize `:kendo.recurrenceeditor.yearlyOf|The text similar to 'of' displayed in the recurrence editor.␟ba75a08b97b5b627aa68f65fdf9c98b21929cb3c␟4042178120150268671:of`;
}
var I18N_217;
if (typeof ngI18nClosureMode !== "undefined" && ngI18nClosureMode) {
    /**
     * @desc The text similar to 'Repeat every' displayed in the recurrence editor.
     * @meaning kendo.recurrenceeditor.yearlyRepeatEvery
     */ 
    const MSG_EXTERNAL_40013948560808339$$DIST_FESM2015_INDEX_JS_218 = goog.getMsg("Repeat every");
    I18N_217 = MSG_EXTERNAL_40013948560808339$$DIST_FESM2015_INDEX_JS_218;
}
else {
    I18N_217 = $localize `:kendo.recurrenceeditor.yearlyRepeatEvery|The text similar to 'Repeat every' displayed in the recurrence editor.␟7638896f73774502fe218d831c6e4707592e234f␟40013948560808339:Repeat every`;
}
var I18N_219;
if (typeof ngI18nClosureMode !== "undefined" && ngI18nClosureMode) {
    /**
     * @desc The text similar to 'Repeat on' displayed in the recurrence editor.
     * @meaning kendo.recurrenceeditor.yearlyRepeatOn
     */ 
    const MSG_EXTERNAL_8341877415603464181$$DIST_FESM2015_INDEX_JS_220 = goog.getMsg("Repeat on");
    I18N_219 = MSG_EXTERNAL_8341877415603464181$$DIST_FESM2015_INDEX_JS_220;
}
else {
    I18N_219 = $localize `:kendo.recurrenceeditor.yearlyRepeatOn|The text similar to 'Repeat on' displayed in the recurrence editor.␟36609e797ac0037a4cb28e5edd5cf62b34df21e7␟8341877415603464181:Repeat on`;
}
var I18N_221;
if (typeof ngI18nClosureMode !== "undefined" && ngI18nClosureMode) {
    /**
     * @desc The text similar to 'year(s)' displayed in the recurrence editor.
     * @meaning kendo.recurrenceeditor.yearlyInterval
     */ 
    const MSG_EXTERNAL_2807249993287587395$$DIST_FESM2015_INDEX_JS_222 = goog.getMsg("year(s)");
    I18N_221 = MSG_EXTERNAL_2807249993287587395$$DIST_FESM2015_INDEX_JS_222;
}
else {
    I18N_221 = $localize `:kendo.recurrenceeditor.yearlyInterval|The text similar to 'year(s)' displayed in the recurrence editor.␟f004fd135763238a1a36974157f3c81769b6dee5␟2807249993287587395:year(s)`;
}
var I18N_223;
if (typeof ngI18nClosureMode !== "undefined" && ngI18nClosureMode) {
    /**
     * @desc The text similar to 'Daily' displayed in the recurrence editor.
     * @meaning kendo.recurrenceeditor.frequenciesDaily
     */ 
    const MSG_EXTERNAL_3411828321534606106$$DIST_FESM2015_INDEX_JS_224 = goog.getMsg("Daily");
    I18N_223 = MSG_EXTERNAL_3411828321534606106$$DIST_FESM2015_INDEX_JS_224;
}
else {
    I18N_223 = $localize `:kendo.recurrenceeditor.frequenciesDaily|The text similar to 'Daily' displayed in the recurrence editor.␟ef1ce06afabfee613af8f110c4ab674f5fa92b57␟3411828321534606106:Daily`;
}
var I18N_225;
if (typeof ngI18nClosureMode !== "undefined" && ngI18nClosureMode) {
    /**
     * @desc The text similar to 'Monthly' displayed in the recurrence editor.
     * @meaning kendo.recurrenceeditor.frequenciesMonthly
     */ 
    const MSG_EXTERNAL_1888636560142623619$$DIST_FESM2015_INDEX_JS_226 = goog.getMsg("Monthly");
    I18N_225 = MSG_EXTERNAL_1888636560142623619$$DIST_FESM2015_INDEX_JS_226;
}
else {
    I18N_225 = $localize `:kendo.recurrenceeditor.frequenciesMonthly|The text similar to 'Monthly' displayed in the recurrence editor.␟ba4e5b19269d9b3c39474d65f05a2cfc4b15a0a7␟1888636560142623619:Monthly`;
}
var I18N_227;
if (typeof ngI18nClosureMode !== "undefined" && ngI18nClosureMode) {
    /**
     * @desc The text similar to 'Never' displayed in the recurrence editor.
     * @meaning kendo.recurrenceeditor.frequenciesNever
     */ 
    const MSG_EXTERNAL_3868019025342455426$$DIST_FESM2015_INDEX_JS_228 = goog.getMsg("Never");
    I18N_227 = MSG_EXTERNAL_3868019025342455426$$DIST_FESM2015_INDEX_JS_228;
}
else {
    I18N_227 = $localize `:kendo.recurrenceeditor.frequenciesNever|The text similar to 'Never' displayed in the recurrence editor.␟723a98aacd5cc73a6423fca02ea2b173b0e2ef85␟3868019025342455426:Never`;
}
var I18N_229;
if (typeof ngI18nClosureMode !== "undefined" && ngI18nClosureMode) {
    /**
     * @desc The text similar to 'Weekly' displayed in the recurrence editor.
     * @meaning kendo.recurrenceeditor.frequenciesWeekly
     */ 
    const MSG_EXTERNAL_7751757060995164198$$DIST_FESM2015_INDEX_JS_230 = goog.getMsg("Weekly");
    I18N_229 = MSG_EXTERNAL_7751757060995164198$$DIST_FESM2015_INDEX_JS_230;
}
else {
    I18N_229 = $localize `:kendo.recurrenceeditor.frequenciesWeekly|The text similar to 'Weekly' displayed in the recurrence editor.␟69cc53104d25196d6431f2e6d37fa3ca438e8822␟7751757060995164198:Weekly`;
}
var I18N_231;
if (typeof ngI18nClosureMode !== "undefined" && ngI18nClosureMode) {
    /**
     * @desc The text similar to 'Yearly' displayed in the recurrence editor.
     * @meaning kendo.recurrenceeditor.frequenciesYearly
     */ 
    const MSG_EXTERNAL_5461952213371726138$$DIST_FESM2015_INDEX_JS_232 = goog.getMsg("Yearly");
    I18N_231 = MSG_EXTERNAL_5461952213371726138$$DIST_FESM2015_INDEX_JS_232;
}
else {
    I18N_231 = $localize `:kendo.recurrenceeditor.frequenciesYearly|The text similar to 'Yearly' displayed in the recurrence editor.␟9de8b986ab1e23269af6abed9fb18e03c0d916a0␟5461952213371726138:Yearly`;
}
var I18N_233;
if (typeof ngI18nClosureMode !== "undefined" && ngI18nClosureMode) {
    /**
     * @desc The text similar to 'Second' displayed in the recurrence editor.
     * @meaning kendo.recurrenceeditor.offsetPositionsSecond
     */ 
    const MSG_EXTERNAL_3509219036806379154$$DIST_FESM2015_INDEX_JS_234 = goog.getMsg("Second");
    I18N_233 = MSG_EXTERNAL_3509219036806379154$$DIST_FESM2015_INDEX_JS_234;
}
else {
    I18N_233 = $localize `:kendo.recurrenceeditor.offsetPositionsSecond|The text similar to 'Second' displayed in the recurrence editor.␟f9f9f8f6aa1a8463e81f7f201f464f484843a02a␟3509219036806379154:Second`;
}
var I18N_235;
if (typeof ngI18nClosureMode !== "undefined" && ngI18nClosureMode) {
    /**
     * @desc The text similar to 'Third' displayed in the recurrence editor.
     * @meaning kendo.recurrenceeditor.offsetPositionsThird
     */ 
    const MSG_EXTERNAL_3360007263021545136$$DIST_FESM2015_INDEX_JS_236 = goog.getMsg("Third");
    I18N_235 = MSG_EXTERNAL_3360007263021545136$$DIST_FESM2015_INDEX_JS_236;
}
else {
    I18N_235 = $localize `:kendo.recurrenceeditor.offsetPositionsThird|The text similar to 'Third' displayed in the recurrence editor.␟e76984e59c331ac74006431f71ccc7950675d9cf␟3360007263021545136:Third`;
}
var I18N_237;
if (typeof ngI18nClosureMode !== "undefined" && ngI18nClosureMode) {
    /**
     * @desc The text similar to 'Fourth' displayed in the recurrence editor.
     * @meaning kendo.recurrenceeditor.offsetPositionsFourth
     */ 
    const MSG_EXTERNAL_1973074769088335432$$DIST_FESM2015_INDEX_JS_238 = goog.getMsg("Fourth");
    I18N_237 = MSG_EXTERNAL_1973074769088335432$$DIST_FESM2015_INDEX_JS_238;
}
else {
    I18N_237 = $localize `:kendo.recurrenceeditor.offsetPositionsFourth|The text similar to 'Fourth' displayed in the recurrence editor.␟c503cb891337b37a76a61a258032a2ddc1ec5869␟1973074769088335432:Fourth`;
}
var I18N_239;
if (typeof ngI18nClosureMode !== "undefined" && ngI18nClosureMode) {
    /**
     * @desc The text similar to 'Last' displayed in the recurrence editor.
     * @meaning kendo.recurrenceeditor.offsetPositionsLast
     */ 
    const MSG_EXTERNAL_921310214903186573$$DIST_FESM2015_INDEX_JS_240 = goog.getMsg("Last");
    I18N_239 = MSG_EXTERNAL_921310214903186573$$DIST_FESM2015_INDEX_JS_240;
}
else {
    I18N_239 = $localize `:kendo.recurrenceeditor.offsetPositionsLast|The text similar to 'Last' displayed in the recurrence editor.␟a62b5bb6052a923af022ed8c0b1d587b660d958b␟921310214903186573:Last`;
}
var I18N_241;
if (typeof ngI18nClosureMode !== "undefined" && ngI18nClosureMode) {
    /**
     * @desc The text similar to 'Day' displayed in the repeat by section of the monthly recurrence pattern.
     * @meaning kendo.recurrenceeditor.weekdaysDay
     */ 
    const MSG_EXTERNAL_327147532266939448$$DIST_FESM2015_INDEX_JS_242 = goog.getMsg("Day");
    I18N_241 = MSG_EXTERNAL_327147532266939448$$DIST_FESM2015_INDEX_JS_242;
}
else {
    I18N_241 = $localize `:kendo.recurrenceeditor.weekdaysDay|The text similar to 'Day' displayed in the repeat by section of the monthly recurrence pattern.␟f731992eeb337a99d57983e713c332ee6ea03e70␟327147532266939448:Day`;
}
var I18N_243;
if (typeof ngI18nClosureMode !== "undefined" && ngI18nClosureMode) {
    /**
     * @desc The text similar to 'Weekday' displayed in the repeat by section of the monthly recurrence pattern.
     * @meaning kendo.recurrenceeditor.weekdaysWeekday
     */ 
    const MSG_EXTERNAL_3509665360149175299$$DIST_FESM2015_INDEX_JS_244 = goog.getMsg("Weekday");
    I18N_243 = MSG_EXTERNAL_3509665360149175299$$DIST_FESM2015_INDEX_JS_244;
}
else {
    I18N_243 = $localize `:kendo.recurrenceeditor.weekdaysWeekday|The text similar to 'Weekday' displayed in the repeat by section of the monthly recurrence pattern.␟eb0ba470e5b8f94939407df263ef047e10c8266f␟3509665360149175299:Weekday`;
}
var I18N_245;
if (typeof ngI18nClosureMode !== "undefined" && ngI18nClosureMode) {
    /**
     * @desc The text similar to 'Weekend Day' displayed in the repeat by section of the monthly recurrence pattern.
     * @meaning kendo.recurrenceeditor.weekdaysWeekendday
     */ 
    const MSG_EXTERNAL_5795746900681495493$$DIST_FESM2015_INDEX_JS_246 = goog.getMsg("Weekend Day");
    I18N_245 = MSG_EXTERNAL_5795746900681495493$$DIST_FESM2015_INDEX_JS_246;
}
else {
    I18N_245 = $localize `:kendo.recurrenceeditor.weekdaysWeekendday|The text similar to 'Weekend Day' displayed in the repeat by section of the monthly recurrence pattern.␟34227d6c9ee22456265afb53fa38f94c6e4b7b72␟5795746900681495493:Weekend Day`;
}
var I18N_247;
if (typeof ngI18nClosureMode !== "undefined" && ngI18nClosureMode) {
    /**
     * @desc The text similar to 'After' displayed in the recurrence editor.
     * @meaning kendo.recurrenceeditor.endAfter
     */ 
    const MSG_EXTERNAL_8163894072062565978$$DIST_FESM2015_INDEX_JS_248 = goog.getMsg("After");
    I18N_247 = MSG_EXTERNAL_8163894072062565978$$DIST_FESM2015_INDEX_JS_248;
}
else {
    I18N_247 = $localize `:kendo.recurrenceeditor.endAfter|The text similar to 'After' displayed in the recurrence editor.␟b56082650444a62a435cfedc82813d37cb767403␟8163894072062565978:After`;
}
var I18N_249;
if (typeof ngI18nClosureMode !== "undefined" && ngI18nClosureMode) {
    /**
     * @desc The text similar to 'occurrence(s)' displayed in the recurrence editor.
     * @meaning kendo.recurrenceeditor.endOccurrence
     */ 
    const MSG_EXTERNAL_7520391809247875756$$DIST_FESM2015_INDEX_JS_250 = goog.getMsg("occurrence(s)");
    I18N_249 = MSG_EXTERNAL_7520391809247875756$$DIST_FESM2015_INDEX_JS_250;
}
else {
    I18N_249 = $localize `:kendo.recurrenceeditor.endOccurrence|The text similar to 'occurrence(s)' displayed in the recurrence editor.␟413b2e9c172d3c7a567ff2e28e1e480f1e38ae72␟7520391809247875756:occurrence(s)`;
}
var I18N_251;
if (typeof ngI18nClosureMode !== "undefined" && ngI18nClosureMode) {
    /**
     * @desc The text similar to 'End' displayed in the recurrence editor.
     * @meaning kendo.recurrenceeditor.endLabel
     */ 
    const MSG_EXTERNAL_356781468184706156$$DIST_FESM2015_INDEX_JS_252 = goog.getMsg("End");
    I18N_251 = MSG_EXTERNAL_356781468184706156$$DIST_FESM2015_INDEX_JS_252;
}
else {
    I18N_251 = $localize `:kendo.recurrenceeditor.endLabel|The text similar to 'End' displayed in the recurrence editor.␟2a25becb4cc1950a471438748363853c73a22bcf␟356781468184706156:End`;
}
var I18N_253;
if (typeof ngI18nClosureMode !== "undefined" && ngI18nClosureMode) {
    /**
     * @desc The text similar to 'Never' displayed in the recurrence editor.
     * @meaning kendo.recurrenceeditor.endNever
     */ 
    const MSG_EXTERNAL_8881058177741426019$$DIST_FESM2015_INDEX_JS_254 = goog.getMsg("Never");
    I18N_253 = MSG_EXTERNAL_8881058177741426019$$DIST_FESM2015_INDEX_JS_254;
}
else {
    I18N_253 = $localize `:kendo.recurrenceeditor.endNever|The text similar to 'Never' displayed in the recurrence editor.␟3ce2bd2fcf23742bbc5f194d167743842ee061a2␟8881058177741426019:Never`;
}
var I18N_255;
if (typeof ngI18nClosureMode !== "undefined" && ngI18nClosureMode) {
    /**
     * @desc The text similar to 'On' displayed in the recurrence editor.
     * @meaning kendo.recurrenceeditor.endOn
     */ 
    const MSG_EXTERNAL_5812894481751230966$$DIST_FESM2015_INDEX_JS_256 = goog.getMsg("On");
    I18N_255 = MSG_EXTERNAL_5812894481751230966$$DIST_FESM2015_INDEX_JS_256;
}
else {
    I18N_255 = $localize `:kendo.recurrenceeditor.endOn|The text similar to 'On' displayed in the recurrence editor.␟d938bdb9e6b20644db88cd8c0d9d236ae64cd1cf␟5812894481751230966:On`;
}
const _c257 = ["repeat", I18N_195, "dailyInterval", I18N_197, "dailyRepeatEvery", I18N_199, "weeklyInterval", I18N_201, "weeklyRepeatEvery", I18N_203, "weeklyRepeatOn", I18N_205, "monthlyDay", I18N_207, "monthlyInterval", I18N_209, "monthlyRepeatEvery", I18N_211, "monthlyRepeatOn", I18N_213, "yearlyOf", I18N_215, "yearlyRepeatEvery", I18N_217, "yearlyRepeatOn", I18N_219, "yearlyInterval", I18N_221, "frequenciesDaily", I18N_223, "frequenciesMonthly", I18N_225, "frequenciesNever", I18N_227, "frequenciesWeekly", I18N_229, "frequenciesYearly", I18N_231, "offsetPositionsSecond", I18N_233, "offsetPositionsThird", I18N_235, "offsetPositionsFourth", I18N_237, "offsetPositionsLast", I18N_239, "weekdaysDay", I18N_241, "weekdaysWeekday", I18N_243, "weekdaysWeekendday", I18N_245, "endAfter", I18N_247, "endOccurrence", I18N_249, "endLabel", I18N_251, "endNever", I18N_253, "endOn", I18N_255];
function RecurrenceEditorComponent_kendo_recurrence_interval_editor_4_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelement(0, "kendo-recurrence-interval-editor", 5);
} if (rf & 2) {
    const ctx_r0 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵproperty("userNumericOptions", ctx_r0.repeatEveryOptions);
} }
function RecurrenceEditorComponent_kendo_recurrence_weekday_rule_editor_5_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelement(0, "kendo-recurrence-weekday-rule-editor");
} }
function RecurrenceEditorComponent_kendo_recurrence_monthly_yearly_editor_6_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelement(0, "kendo-recurrence-monthly-yearly-editor", 5);
} if (rf & 2) {
    const ctx_r2 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵproperty("userNumericOptions", ctx_r2.repeatOnOptions);
} }
function RecurrenceEditorComponent_kendo_recurrence_end_rule_editor_7_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelement(0, "kendo-recurrence-end-rule-editor", 6);
} if (rf & 2) {
    const ctx_r3 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵproperty("userNumericOptions", ctx_r3.endAfterOptions)("userDatePickerOptions", ctx_r3.endOnOptions);
} }
function RecurrenceFrequencyEditorComponent_button_5_Template(rf, ctx) { if (rf & 1) {
    const _r3 = ɵngcc0.ɵɵgetCurrentView();
    ɵngcc0.ɵɵelementStart(0, "button", 5);
    ɵngcc0.ɵɵlistener("click", function RecurrenceFrequencyEditorComponent_button_5_Template_button_click_0_listener() { ɵngcc0.ɵɵrestoreView(_r3); const freq_r1 = ctx.$implicit; const ctx_r2 = ɵngcc0.ɵɵnextContext(); return ctx_r2.onClick(freq_r1); });
    ɵngcc0.ɵɵtext(1);
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    const freq_r1 = ctx.$implicit;
    const ctx_r0 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵstyleProp("width", 100, "px");
    ɵngcc0.ɵɵproperty("togglable", true)("selected", freq_r1.value === ctx_r0.selected);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵtextInterpolate(freq_r1.text);
} }
function RecurrenceMonthlyYearlyEditorComponent_ng_template_8_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵtext(0);
} if (rf & 2) {
    const ctx_r0 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵtextInterpolate1(" ", ctx_r0.textFor("monthlyDay"), " ");
} }
function RecurrenceMonthlyYearlyEditorComponent_ng_template_9_Template(rf, ctx) { if (rf & 1) {
    const _r4 = ɵngcc0.ɵɵgetCurrentView();
    ɵngcc0.ɵɵelementStart(0, "kendo-dropdownlist", 8);
    ɵngcc0.ɵɵlistener("valueChange", function RecurrenceMonthlyYearlyEditorComponent_ng_template_9_Template_kendo_dropdownlist_valueChange_0_listener($event) { ɵngcc0.ɵɵrestoreView(_r4); const ctx_r3 = ɵngcc0.ɵɵnextContext(); return ctx_r3.onMonthChange($event, "monthday"); });
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    const ctx_r1 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵproperty("data", ctx_r1.months)("value", ctx_r1.currentMonthMonthDay)("valuePrimitive", true)("disabled", ctx_r1.isDisabled("monthday"));
} }
function RecurrenceMonthlyYearlyEditorComponent_ng_template_16_Template(rf, ctx) { if (rf & 1) {
    const _r6 = ɵngcc0.ɵɵgetCurrentView();
    ɵngcc0.ɵɵelementStart(0, "span");
    ɵngcc0.ɵɵtext(1);
    ɵngcc0.ɵɵelementEnd();
    ɵngcc0.ɵɵelementStart(2, "kendo-dropdownlist", 8);
    ɵngcc0.ɵɵlistener("valueChange", function RecurrenceMonthlyYearlyEditorComponent_ng_template_16_Template_kendo_dropdownlist_valueChange_2_listener($event) { ɵngcc0.ɵɵrestoreView(_r6); const ctx_r5 = ɵngcc0.ɵɵnextContext(); return ctx_r5.onMonthChange($event, "weekday"); });
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    const ctx_r2 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵtextInterpolate(ctx_r2.textFor("yearlyOf"));
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("data", ctx_r2.months)("value", ctx_r2.currentMonthWeekDay)("valuePrimitive", true)("disabled", ctx_r2.isDisabled("weekday"));
} }
function RecurrenceWeekdayRuleEditorComponent_button_5_Template(rf, ctx) { if (rf & 1) {
    const _r3 = ɵngcc0.ɵɵgetCurrentView();
    ɵngcc0.ɵɵelementStart(0, "button", 5);
    ɵngcc0.ɵɵlistener("selectedChange", function RecurrenceWeekdayRuleEditorComponent_button_5_Template_button_selectedChange_0_listener($event) { ɵngcc0.ɵɵrestoreView(_r3); const day_r1 = ctx.$implicit; const ctx_r2 = ɵngcc0.ɵɵnextContext(); return ctx_r2.onSelectedChange($event, day_r1.value); });
    ɵngcc0.ɵɵtext(1);
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    const day_r1 = ctx.$implicit;
    const ctx_r0 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵstyleProp("width", 75, "px");
    ɵngcc0.ɵɵproperty("toggleable", true)("selected", ctx_r0.isSelected(day_r1));
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵtextInterpolate(ctx_r0.capitalize(day_r1.text));
} }
const _c258 = ["tzcombobox"];
class DateChangeEvent {
    /**
     * @hidden
     */
    constructor(sender, selectedDate, dateRange) {
        this.sender = sender;
        this.selectedDate = selectedDate;
        this.dateRange = dateRange;
    }
}

/**
 * Arguments for the `navigate` event.
 */
class NavigateEvent extends PreventableEvent {
    /**
     * @hidden
     */
    constructor(sender, action) {
        super();
        this.sender = sender;
        this.action = action;
    }
}

/**
 * Arguments for `slotClick` and `slotDblClick` events.
 */
class SlotClickEvent {
    /**
     * @hidden
     */
    constructor(sender, args) {
        this.sender = sender;
        Object.assign(this, args);
    }
}

/**
 * Arguments for the `eventClick` and `eventDblClick` events.
 */
class EventClickEvent {
    /**
     * @hidden
     */
    constructor(sender, args) {
        this.sender = sender;
        Object.assign(this, args);
    }
}

/**
 * Arguments for the `eventKeydown` event.
 */
class EventKeydownEvent {
    /**
     * @hidden
     */
    constructor(sender, args) {
        this.sender = sender;
        Object.assign(this, args);
    }
}

/**
 * Arguments for the `create` event.
 */
class CreateEvent {
    /**
     * @hidden
     */
    constructor(sender, args) {
        this.sender = sender;
        Object.assign(this, args);
    }
}

/**
 * @hidden
 */
class PreventableEvent$1 {
    constructor() {
        this.prevented = false;
    }
    /**
     * Prevents the default action for a specified event.
     * In this way, the source component suppresses
     * the built-in behavior that follows the event.
     */
    preventDefault() {
        this.prevented = true;
    }
    /**
     * Returns `true` if the event was prevented
     * by any of its subscribers.
     *
     * @returns `true` if the default action was prevented.
     * Otherwise, returns `false`.
     */
    isDefaultPrevented() {
        return this.prevented;
    }
}

/**
 * Arguments for the `dragEnd` event.
 */
class DragEndEvent extends PreventableEvent$1 {
    /**
     * @hidden
     */
    constructor(sender, args) {
        super();
        this.sender = sender;
        Object.assign(this, args);
    }
}

/**
 * Arguments for the `drag` event.
 */
class DragEvent extends PreventableEvent$1 {
    /**
     * @hidden
     */
    constructor(sender, args) {
        super();
        this.sender = sender;
        Object.assign(this, args);
    }
}

/**
 * Arguments for the `dragStart` event.
 */
class DragStartEvent extends PreventableEvent$1 {
    /**
     * @hidden
     */
    constructor(sender, args) {
        super();
        this.sender = sender;
        Object.assign(this, args);
    }
}

/**
 * Arguments for the `remove` event.
 */
class RemoveEvent extends PreventableEvent$1 {
    /**
     * @hidden
     */
    constructor(sender, args) {
        super();
        this.sender = sender;
        Object.assign(this, args);
    }
}

/**
 * Arguments for the `resizeEnd` event.
 */
class ResizeEndEvent extends PreventableEvent$1 {
    /**
     * @hidden
     */
    constructor(sender, args) {
        super();
        this.sender = sender;
        Object.assign(this, args);
    }
}

/**
 * Arguments for the `resize` event.
 */
class ResizeEvent extends PreventableEvent$1 {
    /**
     * @hidden
     */
    constructor(sender, args) {
        super();
        this.sender = sender;
        Object.assign(this, args);
    }
}

/**
 * Arguments for the `resizeStart` event.
 */
class ResizeStartEvent extends PreventableEvent$1 {
    /**
     * @hidden
     */
    constructor(sender, args) {
        super();
        this.sender = sender;
        Object.assign(this, args);
    }
}

/**
 * @hidden
 *
 * Maps the name of the event to the argument type of the event.
 */
const VIEW_EVENT_MAP = {
    slotClick: SlotClickEvent,
    slotDblClick: SlotClickEvent,
    eventClick: EventClickEvent,
    eventDblClick: EventClickEvent,
    eventKeydown: EventKeydownEvent,
    create: CreateEvent,
    remove: RemoveEvent,
    resizeStart: ResizeStartEvent,
    resize: ResizeEvent,
    resizeEnd: ResizeEndEvent,
    dragStart: DragStartEvent,
    drag: DragEvent,
    dragEnd: DragEndEvent
};

/**
 * @hidden
 */
class EditEventBase {
    /**
     * @hidden
     */
    constructor(sender, args) {
        this.sender = sender;
        Object.assign(this, args);
    }
}

/**
 * Arguments for the `cancel` event.
 */
class CancelEvent extends EditEventBase {
}

/**
 * Arguments for the `save` event.
 */
class SaveEvent extends EditEventBase {
}

/**
 * Arguments for the `edit` event of the editing directives.
 */
class EditEvent extends PreventableEvent$1 {
    /**
     * @hidden
     */
    constructor(sender, args) {
        super();
        this.sender = sender;
        Object.assign(this, args);
    }
}

/**
 * Arguments for the `add` event of the editing directives.
 */
class AddEvent extends PreventableEvent$1 {
    /**
     * @hidden
     */
    constructor(sender, args) {
        super();
        this.sender = sender;
        Object.assign(this, args);
    }
}

/**
 * Represents the toolbar template of the Scheduler. To define a toolbar
 * template, nest an `<ng-template kendoSchedulerToolbarTemplate>` tag
 * inside `<kendo-scheduler>`. For more information and examples, refer to the article on
 * [customizing the toolbar]({% slug toolbar_scheduler %}) of the Scheduler.
 *
 * The template context receives the following template variables:
 * * `selectedDate`&mdash;The currently selected date.
 * * `dateRange`&mdash;The currently selected [`DateRange`]({% slug api_scheduler_daterange %}).
 * * `views`&mdash;A [`SchedulerView`]({% slug api_scheduler_schedulerview %}) array with the available views.
 * * `selectedView`&mdash;The currently selected [`SchedulerView`]({% slug api_scheduler_schedulerview %}).
 *
 * You can declare either of the following built-in navigation components in the toolbar template:
 * * `kendoSchedulerToolbarNavigation`&mdash;Renders navigation buttons, a calendar, and a date-range label.
 * * `kendoSchedulerToolbarViewSelector`&mdash;Renders the buttons for selecting the view.
 *
 * To emit navigation events, the components inside the toolbar can inject
 * the [`ToolbarService`]({% slug api_scheduler_toolbarservice %}).
 *
 * {% meta height:700 %}
 * {% embed_file toolbar/template/app.component.ts preview %}
 * {% embed_file toolbar/template/my-navigation.component.ts %}
 * {% embed_file toolbar/template/app.module.ts %}
 * {% embed_file shared/events-utc.ts %}
 * {% embed_file shared/main.ts %}
 * {% endmeta %}
 */
class ToolbarTemplateDirective {
    constructor(templateRef) {
        this.templateRef = templateRef;
    }
}
ToolbarTemplateDirective.ɵfac = function ToolbarTemplateDirective_Factory(t) { return new (t || ToolbarTemplateDirective)(ɵngcc0.ɵɵdirectiveInject(ɵngcc0.TemplateRef, 8)); };
ToolbarTemplateDirective.ɵdir = ɵngcc0.ɵɵdefineDirective({ type: ToolbarTemplateDirective, selectors: [["", "kendoSchedulerToolbarTemplate", ""]] });
/** @nocollapse */
ToolbarTemplateDirective.ctorParameters = () => [
    { type: TemplateRef, decorators: [{ type: Optional }] }
];
/*@__PURE__*/ (function () { ɵngcc0.ɵsetClassMetadata(ToolbarTemplateDirective, [{
        type: Directive,
        args: [{
                selector: '[kendoSchedulerToolbarTemplate]'
            }]
    }], function () { return [{ type: ɵngcc0.TemplateRef, decorators: [{
                type: Optional
            }] }]; }, null); })();

/**
 * A service for communication with the toolbar controls
 * which is used by the toolbar components for publishing navigation actions
 * ([see example]({% slug toolbar_scheduler %}#toc-using-the-toolbar-service)).
 */
class ToolbarService {
    /** @hidden */
    constructor() {
        this.actionSource = new Subject();
        this.action = this.actionSource.asObservable();
    }
    /**
     * Emits the specified navigation action.
     *
     * @param action - The navigation action that will be executed.
     */
    navigate(action) {
        this.actionSource.next(action);
    }
}
ToolbarService.ɵfac = function ToolbarService_Factory(t) { return new (t || ToolbarService)(); };
ToolbarService.ɵprov = ɵngcc0.ɵɵdefineInjectable({ token: ToolbarService, factory: ToolbarService.ɵfac });
/** @nocollapse */
ToolbarService.ctorParameters = () => [];
/*@__PURE__*/ (function () { ɵngcc0.ɵsetClassMetadata(ToolbarService, [{
        type: Injectable
    }], function () { return []; }, null); })();

/**
 * An abstract class which contains meta information about a Scheduler view.
 */
class SchedulerView {
}

/**
 * Represents the template which renders the date header in the **Agenda** view.
 * To define the date template, nest an `<ng-template>` tag with the `kendoSchedulerAgendaDateTemplate`
 * directive inside the `<kendo-scheduler-agenda-view>` or `<kendo-scheduler>` components.
 *
 * The available fields in the template context are:
 * - `date`&mdash;The header date.
 *
 * {% meta height:500 %}
 * {% embed_file templates/agenda-date-header/app.component.ts preview %}
 * {% embed_file templates/agenda-date-header/app.module.ts %}
 * {% embed_file shared/main.ts %}
 * {% embed_file shared/events-utc.ts %}
 * {% endmeta %}
 */
class AgendaDateTemplateDirective {
    constructor(templateRef) {
        this.templateRef = templateRef;
    }
}
AgendaDateTemplateDirective.ɵfac = function AgendaDateTemplateDirective_Factory(t) { return new (t || AgendaDateTemplateDirective)(ɵngcc0.ɵɵdirectiveInject(ɵngcc0.TemplateRef, 8)); };
AgendaDateTemplateDirective.ɵdir = ɵngcc0.ɵɵdefineDirective({ type: AgendaDateTemplateDirective, selectors: [["", "kendoSchedulerAgendaDateTemplate", ""]] });
/** @nocollapse */
AgendaDateTemplateDirective.ctorParameters = () => [
    { type: TemplateRef, decorators: [{ type: Optional }] }
];
/*@__PURE__*/ (function () { ɵngcc0.ɵsetClassMetadata(AgendaDateTemplateDirective, [{
        type: Directive,
        args: [{
                selector: '[kendoSchedulerAgendaDateTemplate]'
            }]
    }], function () { return [{ type: ɵngcc0.TemplateRef, decorators: [{
                type: Optional
            }] }]; }, null); })();

/**
 * Represents the template which renders the time header in the **Agenda** view.
 * To define the time template, nest an `<ng-template>` tag with the `kendoSchedulerAgendaTimeTemplate`
 * directive inside the `<kendo-scheduler>` or in the `<kendo-scheduler-agenda-view>` component.
 *
 * The available fields in the template context are:
 * - `start`&mdash;The start date of the event.
 * - `end`&mdash;The end date of the event.
 * - `title`&mdash;The title of the event.
 * - `description`&mdash;The description of the event.
 * - `isAllDay`&mdash;A Boolean value which indicates if the event is all-day.
 * - `resources`&mdash;The resources of the event.
 *
 * {% meta height:500 %}
 * {% embed_file templates/agenda-time-header/app.component.ts preview %}
 * {% embed_file templates/agenda-time-header/app.module.ts %}
 * {% embed_file shared/main.ts %}
 * {% embed_file shared/events-utc.ts %}
 * {% endmeta %}
 */
class AgendaTimeTemplateDirective {
    constructor(templateRef) {
        this.templateRef = templateRef;
    }
}
AgendaTimeTemplateDirective.ɵfac = function AgendaTimeTemplateDirective_Factory(t) { return new (t || AgendaTimeTemplateDirective)(ɵngcc0.ɵɵdirectiveInject(ɵngcc0.TemplateRef, 8)); };
AgendaTimeTemplateDirective.ɵdir = ɵngcc0.ɵɵdefineDirective({ type: AgendaTimeTemplateDirective, selectors: [["", "kendoSchedulerAgendaTimeTemplate", ""]] });
/** @nocollapse */
AgendaTimeTemplateDirective.ctorParameters = () => [
    { type: TemplateRef, decorators: [{ type: Optional }] }
];
/*@__PURE__*/ (function () { ɵngcc0.ɵsetClassMetadata(AgendaTimeTemplateDirective, [{
        type: Directive,
        args: [{
                selector: '[kendoSchedulerAgendaTimeTemplate]'
            }]
    }], function () { return [{ type: ɵngcc0.TemplateRef, decorators: [{
                type: Optional
            }] }]; }, null); })();

/**
 * Represents the template for and assists the content customization of all-day events.
 * To define the all-day event template, nest an `<ng-template>` tag with the `kendoSchedulerAllDayEventTemplate`
 * directive inside the `<kendo-scheduler>`, `<kendo-scheduler-day-view>`, or `kendo-scheduler-week-view` component.
 *
 * The available fields in the template context are:
 * - `event`&mdash;The event that is associated with the item.
 * - `resources`&mdash;The resources of the event.
 *
 * {% meta height:500 %}
 * {% embed_file templates/all-day-event/app.component.ts preview %}
 * {% embed_file templates/all-day-event/app.module.ts %}
 * {% embed_file shared/main.ts %}
 * {% embed_file shared/events-utc.ts %}
 * {% endmeta %}
 */
class AllDayEventTemplateDirective {
    constructor(templateRef) {
        this.templateRef = templateRef;
    }
}
AllDayEventTemplateDirective.ɵfac = function AllDayEventTemplateDirective_Factory(t) { return new (t || AllDayEventTemplateDirective)(ɵngcc0.ɵɵdirectiveInject(ɵngcc0.TemplateRef, 8)); };
AllDayEventTemplateDirective.ɵdir = ɵngcc0.ɵɵdefineDirective({ type: AllDayEventTemplateDirective, selectors: [["", "kendoSchedulerAllDayEventTemplate", ""]] });
/** @nocollapse */
AllDayEventTemplateDirective.ctorParameters = () => [
    { type: TemplateRef, decorators: [{ type: Optional }] }
];
/*@__PURE__*/ (function () { ɵngcc0.ɵsetClassMetadata(AllDayEventTemplateDirective, [{
        type: Directive,
        args: [{
                selector: '[kendoSchedulerAllDayEventTemplate]'
            }]
    }], function () { return [{ type: ɵngcc0.TemplateRef, decorators: [{
                type: Optional
            }] }]; }, null); })();

/**
 * Represents the template for and assists the content customization of all-day slots.
 * To define the all-day slot template, nest an `<ng-template>` tag with the `kendoSchedulerAllDaySlotTemplate`
 * directive inside the `<kendo-scheduler>`, `<kendo-scheduler-day-view>`, or `kendo-scheduler-week-view` component.
 *
 * The available fields in the template context are:
 * - `date`&mdash;The date of the slot.
 * - `resources`&mdash;The resources of the slot.
 *
 * {% meta height:500 %}
 * {% embed_file templates/all-day-slot/app.component.ts preview %}
 * {% embed_file templates/all-day-slot/app.module.ts %}
 * {% embed_file shared/main.ts %}
 * {% embed_file shared/events-utc.ts %}
 * {% endmeta %}
 */
class AllDaySlotTemplateDirective {
    constructor(templateRef) {
        this.templateRef = templateRef;
    }
}
AllDaySlotTemplateDirective.ɵfac = function AllDaySlotTemplateDirective_Factory(t) { return new (t || AllDaySlotTemplateDirective)(ɵngcc0.ɵɵdirectiveInject(ɵngcc0.TemplateRef, 8)); };
AllDaySlotTemplateDirective.ɵdir = ɵngcc0.ɵɵdefineDirective({ type: AllDaySlotTemplateDirective, selectors: [["", "kendoSchedulerAllDaySlotTemplate", ""]] });
/** @nocollapse */
AllDaySlotTemplateDirective.ctorParameters = () => [
    { type: TemplateRef, decorators: [{ type: Optional }] }
];
/*@__PURE__*/ (function () { ɵngcc0.ɵsetClassMetadata(AllDaySlotTemplateDirective, [{
        type: Directive,
        args: [{
                selector: '[kendoSchedulerAllDaySlotTemplate]'
            }]
    }], function () { return [{ type: ɵngcc0.TemplateRef, decorators: [{
                type: Optional
            }] }]; }, null); })();

/**
 * Represents the template which renders the date header in the **Day**, **Week**, and **Timeline** views.
 * To define the day template, nest an `<ng-template>` tag with the `kendoSchedulerDateHeaderTemplate`
 * directive inside the `<kendo-scheduler>`, or in the `<kendo-scheduler-day-view>`, `<kendo-scheduler-week-view>`,
 * `<kendo-scheduler-timeline-view>`, `<kendo-scheduler-timeline-week-view>`, and `<kendo-scheduler-timeline-month-view>` components.
 *
 * The available fields in the template context are:
 * - `date`&mdash;The header date.
 *
 * {% meta height:500 %}
 * {% embed_file templates/date-header/app.component.ts preview %}
 * {% embed_file templates/date-header/app.module.ts %}
 * {% embed_file shared/main.ts %}
 * {% embed_file shared/events-utc.ts %}
 * {% endmeta %}
 */
class DateHeaderTemplateDirective {
    constructor(templateRef) {
        this.templateRef = templateRef;
    }
}
DateHeaderTemplateDirective.ɵfac = function DateHeaderTemplateDirective_Factory(t) { return new (t || DateHeaderTemplateDirective)(ɵngcc0.ɵɵdirectiveInject(ɵngcc0.TemplateRef, 8)); };
DateHeaderTemplateDirective.ɵdir = ɵngcc0.ɵɵdefineDirective({ type: DateHeaderTemplateDirective, selectors: [["", "kendoSchedulerDateHeaderTemplate", ""]] });
/** @nocollapse */
DateHeaderTemplateDirective.ctorParameters = () => [
    { type: TemplateRef, decorators: [{ type: Optional }] }
];
/*@__PURE__*/ (function () { ɵngcc0.ɵsetClassMetadata(DateHeaderTemplateDirective, [{
        type: Directive,
        args: [{
                selector: '[kendoSchedulerDateHeaderTemplate]'
            }]
    }], function () { return [{ type: ɵngcc0.TemplateRef, decorators: [{
                type: Optional
            }] }]; }, null); })();

/**
 * Represents the template for and assists the content customization of the Scheduler events.
 * To define the event template, nest an `<ng-template>` tag with the `kendoSchedulerEventTemplate`
 * directive inside the `<kendo-scheduler>`, or in the view components.
 *
 * The available fields in the template context are:
 * - `event`&mdash;The event that is associated with the item.
 * - `resources`&mdash;The resources of the event.
 *
 * {% meta height:500 %}
 * {% embed_file templates/event/app.component.ts preview %}
 * {% embed_file templates/event/app.module.ts %}
 * {% embed_file shared/main.ts %}
 * {% embed_file shared/events-utc.ts %}
 * {% endmeta %}
 */
class EventTemplateDirective {
    constructor(templateRef) {
        this.templateRef = templateRef;
    }
}
EventTemplateDirective.ɵfac = function EventTemplateDirective_Factory(t) { return new (t || EventTemplateDirective)(ɵngcc0.ɵɵdirectiveInject(ɵngcc0.TemplateRef, 8)); };
EventTemplateDirective.ɵdir = ɵngcc0.ɵɵdefineDirective({ type: EventTemplateDirective, selectors: [["", "kendoSchedulerEventTemplate", ""]] });
/** @nocollapse */
EventTemplateDirective.ctorParameters = () => [
    { type: TemplateRef, decorators: [{ type: Optional }] }
];
/*@__PURE__*/ (function () { ɵngcc0.ɵsetClassMetadata(EventTemplateDirective, [{
        type: Directive,
        args: [{
                selector: '[kendoSchedulerEventTemplate]'
            }]
    }], function () { return [{ type: ɵngcc0.TemplateRef, decorators: [{
                type: Optional
            }] }]; }, null); })();

/**
 * Represents the template which renders the resource group header in the **Day**, **Week**, and **Timeline** views.
 * To define the template, nest an `<ng-template>` tag with the `kendoSchedulerGroupHeaderTemplate`
 * directive inside the `<kendo-scheduler>`, or in the `<kendo-scheduler-day-view>`, `<kendo-scheduler-week-view>`,
 * `<kendo-scheduler-timeline-view>`, `<kendo-scheduler-timeline-week-view>`, and `<kendo-scheduler-timeline-month-view>` components.
 *
 * The available fields in the template context are:
 * - `resource`&mdash;The resource item.
 *
 * {% meta height:500 %}
 * {% embed_file templates/group-header/app.component.ts preview %}
 * {% embed_file templates/group-header/app.module.ts %}
 * {% embed_file shared/main.ts %}
 * {% embed_file shared/events-utc.ts %}
 * {% endmeta %}
 */
class GroupHeaderTemplateDirective {
    constructor(templateRef) {
        this.templateRef = templateRef;
    }
}
GroupHeaderTemplateDirective.ɵfac = function GroupHeaderTemplateDirective_Factory(t) { return new (t || GroupHeaderTemplateDirective)(ɵngcc0.ɵɵdirectiveInject(ɵngcc0.TemplateRef, 8)); };
GroupHeaderTemplateDirective.ɵdir = ɵngcc0.ɵɵdefineDirective({ type: GroupHeaderTemplateDirective, selectors: [["", "kendoSchedulerGroupHeaderTemplate", ""]] });
/** @nocollapse */
GroupHeaderTemplateDirective.ctorParameters = () => [
    { type: TemplateRef, decorators: [{ type: Optional }] }
];
/*@__PURE__*/ (function () { ɵngcc0.ɵsetClassMetadata(GroupHeaderTemplateDirective, [{
        type: Directive,
        args: [{
                selector: '[kendoSchedulerGroupHeaderTemplate]'
            }]
    }], function () { return [{ type: ɵngcc0.TemplateRef, decorators: [{
                type: Optional
            }] }]; }, null); })();

/**
 * Represents the template for the major-time headers in the **Day** and **Week** views.
 * To define the major-time header template, nest an `<ng-template>` tag with the `kendoSchedulerMajorTimeHeaderTemplate`
 * directive inside the `<kendo-scheduler>`, or in the `<kendo-scheduler-day-view>` and `<kendo-scheduler-week-view>` components.
 *
 * The available fields in the template context are:
 * - `date`&mdash;The date of the header.
 *
 * {% meta height:500 %}
 * {% embed_file templates/major-header/app.component.ts preview %}
 * {% embed_file templates/major-header/app.module.ts %}
 * {% embed_file shared/main.ts %}
 * {% embed_file shared/events-utc.ts %}
 * {% endmeta %}
 */
class MajorTimeHeaderTemplateDirective {
    constructor(templateRef) {
        this.templateRef = templateRef;
    }
}
MajorTimeHeaderTemplateDirective.ɵfac = function MajorTimeHeaderTemplateDirective_Factory(t) { return new (t || MajorTimeHeaderTemplateDirective)(ɵngcc0.ɵɵdirectiveInject(ɵngcc0.TemplateRef, 8)); };
MajorTimeHeaderTemplateDirective.ɵdir = ɵngcc0.ɵɵdefineDirective({ type: MajorTimeHeaderTemplateDirective, selectors: [["", "kendoSchedulerMajorTimeHeaderTemplate", ""]] });
/** @nocollapse */
MajorTimeHeaderTemplateDirective.ctorParameters = () => [
    { type: TemplateRef, decorators: [{ type: Optional }] }
];
/*@__PURE__*/ (function () { ɵngcc0.ɵsetClassMetadata(MajorTimeHeaderTemplateDirective, [{
        type: Directive,
        args: [{
                selector: '[kendoSchedulerMajorTimeHeaderTemplate]'
            }]
    }], function () { return [{ type: ɵngcc0.TemplateRef, decorators: [{
                type: Optional
            }] }]; }, null); })();

/**
 * Represents the template for the minor-time headers in the **Day** and **Week** views.
 * To define the minor-time header template, nest an `<ng-template>` tag with the `kendoSchedulerMinorTimeHeaderTemplate`
 * directive inside the `<kendo-scheduler>`, or in the `<kendo-scheduler-day-view>` and `<kendo-scheduler-week-view>` components.
 *
 * The available fields in the template context are:
 * - `date`&mdash;The date of the header.
 *
 * {% meta height:500 %}
 * {% embed_file templates/minor-header/app.component.ts preview %}
 * {% embed_file templates/minor-header/app.module.ts %}
 * {% embed_file shared/main.ts %}
 * {% embed_file shared/events-utc.ts %}
 * {% endmeta %}
 */
class MinorTimeHeaderTemplateDirective {
    constructor(templateRef) {
        this.templateRef = templateRef;
    }
}
MinorTimeHeaderTemplateDirective.ɵfac = function MinorTimeHeaderTemplateDirective_Factory(t) { return new (t || MinorTimeHeaderTemplateDirective)(ɵngcc0.ɵɵdirectiveInject(ɵngcc0.TemplateRef, 8)); };
MinorTimeHeaderTemplateDirective.ɵdir = ɵngcc0.ɵɵdefineDirective({ type: MinorTimeHeaderTemplateDirective, selectors: [["", "kendoSchedulerMinorTimeHeaderTemplate", ""]] });
/** @nocollapse */
MinorTimeHeaderTemplateDirective.ctorParameters = () => [
    { type: TemplateRef, decorators: [{ type: Optional }] }
];
/*@__PURE__*/ (function () { ɵngcc0.ɵsetClassMetadata(MinorTimeHeaderTemplateDirective, [{
        type: Directive,
        args: [{
                selector: '[kendoSchedulerMinorTimeHeaderTemplate]'
            }]
    }], function () { return [{ type: ɵngcc0.TemplateRef, decorators: [{
                type: Optional
            }] }]; }, null); })();

/**
 * Represents the template for rendering the day slots in the **Month** view.
 * To define the day template, nest an `<ng-template>` tag with the `kendoSchedulerMonthDaySlotTemplate`
 * directive inside the `<kendo-scheduler>`, or in the `<kendo-scheduler-month-view>` component.
 *
 * The available fields in the template context are:
 * - `date`&mdash;The date of the slot.
 * - `resources`&mdash;The resources of the slot.
 *
 * {% meta height:500 %}
 * {% embed_file templates/month-slot/app.component.ts preview %}
 * {% embed_file templates/month-slot/app.module.ts %}
 * {% embed_file shared/main.ts %}
 * {% embed_file shared/events-utc.ts %}
 * {% endmeta %}
 */
class MonthDaySlotTemplateDirective {
    constructor(templateRef) {
        this.templateRef = templateRef;
    }
}
MonthDaySlotTemplateDirective.ɵfac = function MonthDaySlotTemplateDirective_Factory(t) { return new (t || MonthDaySlotTemplateDirective)(ɵngcc0.ɵɵdirectiveInject(ɵngcc0.TemplateRef, 8)); };
MonthDaySlotTemplateDirective.ɵdir = ɵngcc0.ɵɵdefineDirective({ type: MonthDaySlotTemplateDirective, selectors: [["", "kendoSchedulerMonthDaySlotTemplate", ""]] });
/** @nocollapse */
MonthDaySlotTemplateDirective.ctorParameters = () => [
    { type: TemplateRef, decorators: [{ type: Optional }] }
];
/*@__PURE__*/ (function () { ɵngcc0.ɵsetClassMetadata(MonthDaySlotTemplateDirective, [{
        type: Directive,
        args: [{
                selector: '[kendoSchedulerMonthDaySlotTemplate]'
            }]
    }], function () { return [{ type: ɵngcc0.TemplateRef, decorators: [{
                type: Optional
            }] }]; }, null); })();
// Rename to indicate that it is only for the month view.

/**
 * Represents the template for the time-slot renderer in the **Day**, **Week**, and **Timeline** views.
 * To define the time-slot template, nest an `<ng-template>` tag with the `kendoSchedulerTimeSlotTemplate`
 * directive inside the `<kendo-scheduler>`, or in the `<kendo-scheduler-day-view>`, `<kendo-scheduler-week-view>`,
 * `<kendo-scheduler-timeline-view>`, `<kendo-scheduler-timeline-week-view>`, and `<kendo-scheduler-timeline-month-view>` components.
 *
 * The available fields in the template context are:
 * - `date`&mdash;The date of the slot.
 * - `resources`&mdash;The resources of the slot.
 *
 * {% meta height:500 %}
 * {% embed_file templates/time-slot/app.component.ts preview %}
 * {% embed_file templates/time-slot/app.module.ts %}
 * {% embed_file shared/main.ts %}
 * {% embed_file shared/events-utc.ts %}
 * {% endmeta %}
 */
class TimeSlotTemplateDirective {
    constructor(templateRef) {
        this.templateRef = templateRef;
    }
}
TimeSlotTemplateDirective.ɵfac = function TimeSlotTemplateDirective_Factory(t) { return new (t || TimeSlotTemplateDirective)(ɵngcc0.ɵɵdirectiveInject(ɵngcc0.TemplateRef, 8)); };
TimeSlotTemplateDirective.ɵdir = ɵngcc0.ɵɵdefineDirective({ type: TimeSlotTemplateDirective, selectors: [["", "kendoSchedulerTimeSlotTemplate", ""]] });
/** @nocollapse */
TimeSlotTemplateDirective.ctorParameters = () => [
    { type: TemplateRef, decorators: [{ type: Optional }] }
];
/*@__PURE__*/ (function () { ɵngcc0.ɵsetClassMetadata(TimeSlotTemplateDirective, [{
        type: Directive,
        args: [{
                selector: '[kendoSchedulerTimeSlotTemplate]'
            }]
    }], function () { return [{ type: ɵngcc0.TemplateRef, decorators: [{
                type: Optional
            }] }]; }, null); })();

/**
 * A service which publishes information from the Scheduler to the views.
 * Views subscribe to changes in the context (selected date, event, and resource data) through this service.
 */
class ViewContextService {
    constructor() {
        this.actionSource = new Subject();
        this.itemsSource = new BehaviorSubject([]);
        this.selectedDateSource = new BehaviorSubject(null);
        this.resizeSource = new Subject();
        this.optionsChangeSource = new BehaviorSubject({});
        this.executeSource = new Subject();
        this.action = this.actionSource.asObservable();
        this.items = this.itemsSource.asObservable();
        this.selectedDate = this.selectedDateSource.asObservable();
        this.resize = this.resizeSource.asObservable();
        this.optionsChange = this.optionsChangeSource.asObservable();
        this.execute = this.executeSource.asObservable();
    }
    /**
     * An internal method which is used by the Scheduler to publish unhandled navigation actions.
     *
     * @hidden
     */
    notifyAction(action) {
        this.actionSource.next(action);
    }
    /**
     * An internal method which is used by the Scheduler to publish the current set of items.
     *
     * @hidden
     */
    notifyItems(items) {
        this.itemsSource.next(items);
    }
    /**
     * An internal method which is used by the Scheduler to publish the currently selected date.
     *
     * @hidden
     */
    notifySelectedDate(date) {
        this.selectedDateSource.next(date);
    }
    /**
     * An internal method which is used by the Scheduler to notify that the size changed.
     *
     * @hidden
     */
    notifyResize() {
        this.resizeSource.next();
    }
    /**
     * An internal method which is used by the Scheduler to notify that the options changed.
     *
     * @hidden
     */
    notifyOptionsChange(changes) {
        this.optionsChangeSource.next(changes);
    }
    /**
     * An internal method which is used by the Scheduler to execute a view method.
     *
     * @hidden
     */
    executeMethod(name, args) {
        let result;
        this.executeSource.next({ name, args, result: (r) => {
                result = r;
            } });
        return result;
    }
}
ViewContextService.ɵfac = function ViewContextService_Factory(t) { return new (t || ViewContextService)(); };
ViewContextService.ɵprov = ɵngcc0.ɵɵdefineInjectable({ token: ViewContextService, factory: ViewContextService.ɵfac });
/** @nocollapse */
ViewContextService.ctorParameters = () => [];
/*@__PURE__*/ (function () { ɵngcc0.ɵsetClassMetadata(ViewContextService, [{
        type: Injectable
    }], function () { return []; }, null); })();

const emptyDateRange = () => ({
    start: new Date(0),
    end: new Date(0),
    text: '',
    shortText: ''
});
/**
 * A service for publishing the view state and actions to the Scheduler.
 */
class ViewStateService {
    constructor() {
        this.dateRangeSource = new BehaviorSubject(emptyDateRange());
        this.nextDateSource = new Subject();
        this.navigateSource = new Subject();
        this.viewEventSource = new Subject();
        this.layoutEndSource = new Subject();
        this.optionsChangeSource = new Subject();
        this.dateRange = this.dateRangeSource.asObservable();
        this.nextDate = this.nextDateSource.asObservable();
        this.navigate = this.navigateSource.asObservable();
        this.viewEvent = this.viewEventSource.asObservable();
        this.layoutEnd = this.layoutEndSource.asObservable();
        this.optionsChange = this.optionsChangeSource.asObservable();
    }
    /**
     * Publishes the date that will be displayed by the Scheduler
     * typically as a result from processing a navigation action.
     */
    notifyNextDate(date) {
        this.nextDateSource.next(date);
    }
    /**
     * Publishes the visible date range of the view.
     * The view will calculate and set the new data range when
     * the selected date changes.
     */
    notifyDateRange(range) {
        this.dateRangeSource.next(range);
    }
    /**
     * Notifies the Scheduler that the view has completed its layout.
     */
    notifyLayoutEnd() {
        this.layoutEndSource.next();
    }
    /**
     * Navigates to another view.
     */
    navigateTo(args) {
        this.navigateSource.next(args);
    }
    /**
     * Notifies the Scheduler that the view options have been changed.
     */
    notifyOptionsChange() {
        this.optionsChangeSource.next(null);
    }
    /**
     * Emits a DOM event to the Scheduler.
     */
    emitEvent(name, args) {
        this.viewEventSource.next({
            name: name,
            args: args
        });
    }
}
ViewStateService.ɵfac = function ViewStateService_Factory(t) { return new (t || ViewStateService)(); };
ViewStateService.ɵprov = ɵngcc0.ɵɵdefineInjectable({ token: ViewStateService, factory: ViewStateService.ɵfac });
/** @nocollapse */
ViewStateService.ctorParameters = () => [];
/*@__PURE__*/ (function () { ɵngcc0.ɵsetClassMetadata(ViewStateService, [{
        type: Injectable
    }], function () { return []; }, null); })();

const FIELD_REGEX = /\[(?:(\d+)|['"](.*?)['"])\]|((?:(?!\[.*?\]|\.).)+)/g;
const getterCache = {};
getterCache['undefined'] = () => undefined;
/**
 * @hidden
 *
 * TODO: Move to @progress/kendo-common
 */
function getter(field) {
    if (getterCache[field]) {
        return getterCache[field];
    }
    const fields = [];
    field.replace(FIELD_REGEX, function (_match, index, indexAccessor, fieldName) {
        fields.push(index !== undefined ? index : (indexAccessor || fieldName));
    });
    getterCache[field] = function (obj) {
        let result = obj;
        for (let idx = 0; idx < fields.length && result; idx++) {
            result = result[fields[idx]];
        }
        return result;
    };
    return getterCache[field];
}

const FIELD_REGEX$1 = /\[(?:(\d+)|['"](.*?)['"])\]|((?:(?!\[.*?\]|\.).)+)/g;
const setterCache = {};
setterCache['undefined'] = obj => obj;
/**
 * @hidden
 *
 * TODO: Move to @progress/kendo-common
 */
function setter(field) {
    if (setterCache[field]) {
        return setterCache[field];
    }
    const fields = [];
    field.replace(FIELD_REGEX$1, function (_match, index, indexAccessor, fieldName) {
        fields.push(index !== undefined ? index : (indexAccessor || fieldName));
    });
    setterCache[field] = function (obj, value) {
        let root = obj;
        const depth = fields.length - 1;
        for (let idx = 0; idx < depth && root; idx++) {
            root = root[fields[idx]] = root[fields[idx]] || {};
        }
        root[fields[depth]] = value;
    };
    return setterCache[field];
}

/**
 * @hidden
 */
const OCCURRENCE_ID = 0;

/**
 * @hidden
 *
 * TODO: Move to @progress/kendo-common
 */
const capitalize = (value) => value.charAt(0).toUpperCase() + value.slice(1);
/**
 * @hidden
 *
 * TODO: Move to @progress/kendo-common
 */
const isPresent = (value) => value !== null && value !== undefined;
/**
 * @hidden
 *
 * TODO: Move to @progress/kendo-common
 */
const isBlank = (value) => value === null || value === undefined;
/**
 * @hidden
 *
 * TODO: Move to @progress/kendo-common
 */
const isArray = (value) => Array.isArray(value);
/**
 * @hidden
 *
 * TODO: Move to @progress/kendo-common
 */
const isNullOrEmptyString = (value) => isBlank(value) || (value.trim && value.trim().length === 0);
/**
 * @hidden
 *
 * TODO: Move to @progress/kendo-common
 */
const isNumber = (value) => typeof value === "number" && !isNaN(value);
/**
 * @hidden
 *
 * TODO: Move to @progress/kendo-common
 */
const isString = (value) => typeof value === 'string';
/**
 * @hidden
 *
 * TODO: Move to @progress/kendo-common
 */
const isObject = (value) => typeof value === 'object';
/**
 * @hidden
 */
const isRecurring = (event, fields) => {
    const recurrenceId = getter(fields.recurrenceId)(event);
    const recurrenceRule = getter(fields.recurrenceRule)(event);
    return !!(recurrenceRule || recurrenceId);
};
/**
 * @hidden
 */
const isException = (event, fields) => {
    const id = getter(fields.id)(event);
    const recurrenceId = getter(fields.recurrenceId)(event);
    return isPresent(id) && id !== OCCURRENCE_ID && isPresent(recurrenceId);
};
/**
 * @hidden
 */
const copyResources = (event, resources) => {
    if (resources) {
        for (let idx = 0; idx < resources.length; idx++) {
            assignField(event, event.dataItem, resources[idx].field);
        }
    }
};
/**
 * @hidden
 */
const readEvent = (dataItem, fields, resources) => {
    const result = {
        id: getter(fields.id)(dataItem),
        start: getter(fields.start)(dataItem),
        startTimezone: getter(fields.startTimezone)(dataItem),
        end: getter(fields.end)(dataItem),
        endTimezone: getter(fields.endTimezone)(dataItem),
        isAllDay: getter(fields.isAllDay)(dataItem),
        title: getter(fields.title)(dataItem),
        description: getter(fields.description)(dataItem),
        recurrenceRule: getter(fields.recurrenceRule)(dataItem),
        recurrenceExceptions: getter(fields.recurrenceExceptions)(dataItem),
        recurrenceId: getter(fields.recurrenceId)(dataItem),
        dataItem
    };
    copyResources(result, resources);
    return result;
};
/**
 * @hidden
 */
const isRecurrenceMaster = (event) => event.recurrenceRule && !isPresent(event.recurrenceId);
/**
 * @hidden
 */
function groupResources(group, resources) {
    const result = [];
    if (group && group.resources && group.resources.length) {
        const groups = group.resources;
        for (let idx = 0; idx < groups.length; idx++) {
            const resource = resources.find(r => r.name === groups[idx]);
            result.push(resource);
        }
    }
    return result;
}
/**
 * @hidden
 */
const getField = (obj, field) => getter(field)(obj);
/**
 * @hidden
 */
const setField = (obj, field, value) => setter(field)(obj, value);
/**
 * @hidden
 */
function assignField(target, source, field) {
    setField(target, field, getField(source, field));
}
/**
 * @hidden
 */
function assignValues(target, source) {
    cloneTo(source, target);
    return target;
}
/**
 * @hidden
 */
function cloneTo(obj, result) {
    for (let field in obj) {
        if (obj.hasOwnProperty(field)) {
            const value = obj[field];
            if (Array.isArray(value)) {
                result[field] = value.slice(0);
            }
            else if (value && typeof value === 'object' && !(value instanceof Date)) {
                result[field] = result[field] || {};
                cloneTo(value, result[field]);
            }
            else {
                result[field] = value;
            }
        }
    }
}
/**
 * @hidden
 */
function clone(obj) {
    const result = {};
    cloneTo(obj, result);
    return result;
}
/** @hidden */
const iterator = getIterator();
// TODO: Move to kendo-common
function getIterator() {
    if (typeof Symbol === 'function' && Symbol.iterator) {
        return Symbol.iterator;
    }
    const keys = Object.getOwnPropertyNames(Map.prototype);
    const proto = Map.prototype;
    for (let i = 0; i < keys.length; ++i) {
        const key = keys[i];
        if (key !== 'entries' && key !== 'size' && proto[key] === proto.entries) {
            return key;
        }
    }
}
/**
 * @hidden
 */
function fromClick(element) {
    return fromEvent(element, 'click');
}
/**
 * @hidden
 */
function fromDoubleClick(element) {
    const DBLCLICK_DELAY = 250;
    const clicks = fromClick(element);
    const endSequence = clicks.pipe(auditTime(DBLCLICK_DELAY));
    return clicks.pipe(buffer(endSequence), filter(sequence => sequence.length === 2), filter((sequence) => sequence[1].target === sequence[0].target), map(sequence => sequence[1]));
}
/**
 * @hidden
 */
function sortTasksByTime(tasks) {
    tasks.sort((a, b) => (a.startTime - b.startTime) || (b.endTime - a.endTime));
    return tasks;
}

// const toSimilarDate = (date: ZonedDate): Date => new Date(
//     date.getFullYear(), date.getMonth(), date.getDay(),
//     date.getHours(), date.getMinutes(), date.getSeconds(),
//     date.getMilliseconds()
//   );
// const toUTCDateTime = (localDate: Date): Date => new Date(Date.UTC(
//       localDate.getFullYear(),
//       localDate.getMonth(),
//       localDate.getDate(),
//       localDate.getHours(),
//       localDate.getMinutes(),
//       localDate.getSeconds(),
//       localDate.getMilliseconds()
//     ));
/**
 * @hidden
 */
class EditService {
    constructor(ngZone) {
        this.ngZone = ngZone;
        this.changes = new EventEmitter();
        this.changedSource = new Subject();
        this.changed = this.changedSource.asObservable().pipe(debounceTime(0));
    }
    endEdit() {
        const formGroup = this.hasNewEvent ? this.newEventGroup.group : this.editedEvent.formGroup;
        this.changes.emit({ action: 'cancel', formGroup });
    }
    removeEvent(dataItem) {
        this.changes.emit({ action: 'remove', dataItem });
    }
    addEvent(formGroup) {
        this.newEventGroup = { formGroup };
        this.onChanged();
    }
    editEvent(dataItem, formGroup = undefined, mode) {
        this.editedEvent = { dataItem, formGroup, mode };
        this.onChanged();
    }
    close() {
        this.newEventGroup = this.editedEvent = null;
        this.onChanged();
    }
    save() {
        const { dataItem, formGroup } = this.context;
        this.changes.emit({
            action: 'save',
            dataItem,
            formGroup,
            isNew: this.hasNewEvent,
            mode: this.occurrenceEditMode
        });
    }
    isEditing() {
        return isPresent(this.context);
    }
    get occurrenceEditMode() {
        if (this.hasNewEvent) {
            return 2 /* Series */;
        }
        else {
            return this.editedEvent.mode || 0 /* Event */;
        }
    }
    get hasNewEvent() {
        return isPresent(this.newEventGroup);
    }
    get newEvent() {
        if (this.hasNewEvent) {
            return this.newEventGroup.group.value;
        }
        return {};
    }
    get context() {
        if (this.hasNewEvent) {
            return this.newEventGroup;
        }
        return this.editedEvent;
    }
    onChanged() {
        this.ngZone.runOutsideAngular(() => {
            this.changedSource.next();
        });
    }
}
EditService.ɵfac = function EditService_Factory(t) { return new (t || EditService)(ɵngcc0.ɵɵinject(ɵngcc0.NgZone)); };
EditService.ɵprov = ɵngcc0.ɵɵdefineInjectable({ token: EditService, factory: EditService.ɵfac });
/** @nocollapse */
EditService.ctorParameters = () => [
    { type: NgZone }
];
/*@__PURE__*/ (function () { ɵngcc0.ɵsetClassMetadata(EditService, [{
        type: Injectable
    }], function () { return [{ type: ɵngcc0.NgZone }]; }, null); })();

/**
 * Represents the template for the edit dialog of the Scheduler.
 * To define the template, nest an `<ng-template>` tag
 * with the `kendoSchedulerEditDialogTemplate` directive inside the `<kendo-scheduler>` tag.
 *
 * The template context is set to the current event and then the following additional fields are passed:
 * - `event`&mdash;The currently edited event. Represents the default context that will be assigned to any template variable which utilizes the `let-x` syntax&mdash;for example, `let-event`.
 * - `formGroup`&mdash;The current [`FormGroup`](https://angular.io/docs/ts/latest/api/forms/index/FormGroup-class.html).
 * - `editMode`&mdash;The current edit mode.
 * - `isNew`&mdash;The state of the current event.
 */
class EditDialogTemplateDirective {
    constructor(templateRef) {
        this.templateRef = templateRef;
    }
}
EditDialogTemplateDirective.ɵfac = function EditDialogTemplateDirective_Factory(t) { return new (t || EditDialogTemplateDirective)(ɵngcc0.ɵɵdirectiveInject(ɵngcc0.TemplateRef, 8)); };
EditDialogTemplateDirective.ɵdir = ɵngcc0.ɵɵdefineDirective({ type: EditDialogTemplateDirective, selectors: [["", "kendoSchedulerEditDialogTemplate", ""]], inputs: { autoFocusedElement: "autoFocusedElement" } });
/** @nocollapse */
EditDialogTemplateDirective.ctorParameters = () => [
    { type: TemplateRef, decorators: [{ type: Optional }] }
];
EditDialogTemplateDirective.propDecorators = {
    autoFocusedElement: [{ type: Input }]
};
/*@__PURE__*/ (function () { ɵngcc0.ɵsetClassMetadata(EditDialogTemplateDirective, [{
        type: Directive,
        args: [{
                selector: '[kendoSchedulerEditDialogTemplate]'
            }]
    }], function () { return [{ type: ɵngcc0.TemplateRef, decorators: [{
                type: Optional
            }] }]; }, { autoFocusedElement: [{
            type: Input
        }] }); })();

/**
 * @hidden
 */
class LocalDataChangesService {
    constructor() {
        this.changes = new EventEmitter();
    }
}
LocalDataChangesService.ɵfac = function LocalDataChangesService_Factory(t) { return new (t || LocalDataChangesService)(); };
LocalDataChangesService.ɵprov = ɵngcc0.ɵɵdefineInjectable({ token: LocalDataChangesService, factory: LocalDataChangesService.ɵfac });
/*@__PURE__*/ (function () { ɵngcc0.ɵsetClassMetadata(LocalDataChangesService, [{
        type: Injectable
    }], function () { return []; }, null); })();

/**
 * @hidden
 */
class DomEventsService {
    constructor() {
        this.focus = new EventEmitter();
        this.focusIn = new EventEmitter();
        this.focusOut = new EventEmitter();
        this.click = new EventEmitter();
        this.keydown = new EventEmitter();
        this.windowBlur = new EventEmitter();
    }
}
DomEventsService.ɵfac = function DomEventsService_Factory(t) { return new (t || DomEventsService)(); };
DomEventsService.ɵprov = ɵngcc0.ɵɵdefineInjectable({ token: DomEventsService, factory: DomEventsService.ɵfac });
/*@__PURE__*/ (function () { ɵngcc0.ɵsetClassMetadata(DomEventsService, [{
        type: Injectable
    }], function () { return []; }, null); })();

/**
 * @hidden
 */
class FocusService {
    constructor(renderer, wrapper, domEvents) {
        this.renderer = renderer;
        this.wrapper = wrapper;
        this.domEvents = domEvents;
        this.items = new Set();
        this.elementMap = new WeakMap();
        this.subs = new Subscription();
        this.subs.add(this.domEvents.focus.subscribe(e => this.onFocusIn(e)));
        this.subs.add(this.domEvents.focusOut.subscribe(() => this.onFocusOut()));
    }
    get activeElement() {
        if (this.activeItem) {
            return this.activeItem.element;
        }
    }
    ngOnDestroy() {
        this.subs.unsubscribe();
    }
    register(item) {
        if (!this.activeItem) {
            this.activeItem = item;
            item.toggle(true);
        }
        this.items.add(item);
        this.elementMap.set(item.element.nativeElement, item);
        this.toggleWrapper();
    }
    unregister(item) {
        this.items.delete(item);
        this.elementMap.delete(item.element.nativeElement);
        if (item === this.activeItem) {
            this.activateNext();
        }
        this.toggleWrapper();
    }
    focus() {
        if (this.activeItem) {
            this.activeItem.focus();
        }
        else {
            this.wrapper.nativeElement.focus();
        }
    }
    focusNext(options) {
        const currentItem = this.activeItem;
        this.activateNext(options);
        if (this.activeItem) {
            this.activeItem.focus();
        }
        return this.activeItem !== currentItem;
    }
    activate(next) {
        this.items.forEach(item => item.toggle(item === next));
        this.activeItem = next;
    }
    activateNext(position) {
        this.activeItem = this.findNext(position);
    }
    findNext(position) {
        const { offset, nowrap } = Object.assign({ nowrap: false, offset: 1 }, position);
        const items = Array.from(this.items.values())
            .filter(item => item.canFocus())
            .sort((a, b) => a.focusIndex - b.focusIndex);
        if (items.length === 0) {
            return null;
        }
        if (!this.activeItem) {
            return nowrap ? null : items[0];
        }
        const index = items.indexOf(this.activeItem);
        let nextIndex = index + offset;
        if (nowrap) {
            nextIndex = Math.max(0, Math.min(items.length - 1, nextIndex));
        }
        else {
            nextIndex = nextIndex % items.length;
            if (nextIndex < 0) {
                nextIndex = items.length - 1;
            }
        }
        return items[nextIndex];
    }
    toggleWrapper() {
        if (this.wrapper) {
            this.renderer.setAttribute(this.wrapper.nativeElement, 'tabindex', this.activeItem ? '-1' : '0');
        }
    }
    onFocusIn(e) {
        const item = this.elementMap.get(e.target);
        if (!item || item === this.focusedItem) {
            return;
        }
        if (this.focusedItem) {
            this.focusedItem.toggleFocus(false);
        }
        this.activate(item);
        item.toggleFocus(true);
        this.focusedItem = item;
    }
    onFocusOut() {
        if (!this.focusedItem) {
            return;
        }
        this.focusedItem.toggleFocus(false);
        this.focusedItem = null;
    }
}
FocusService.ɵfac = function FocusService_Factory(t) { return new (t || FocusService)(ɵngcc0.ɵɵinject(ɵngcc0.Renderer2, 8), ɵngcc0.ɵɵinject(ɵngcc0.ElementRef, 8), ɵngcc0.ɵɵinject(DomEventsService)); };
FocusService.ɵprov = ɵngcc0.ɵɵdefineInjectable({ token: FocusService, factory: FocusService.ɵfac });
/** @nocollapse */
FocusService.ctorParameters = () => [
    { type: Renderer2, decorators: [{ type: Optional }] },
    { type: ElementRef, decorators: [{ type: Optional }] },
    { type: DomEventsService }
];
/*@__PURE__*/ (function () { ɵngcc0.ɵsetClassMetadata(FocusService, [{
        type: Injectable
    }], function () { return [{ type: ɵngcc0.Renderer2, decorators: [{
                type: Optional
            }] }, { type: ɵngcc0.ElementRef, decorators: [{
                type: Optional
            }] }, { type: DomEventsService }]; }, null); })();

/**
 * @hidden
 */
class DialogsService {
    constructor(dialogService, localization, changeDetector, focusService, viewState) {
        this.dialogService = dialogService;
        this.localization = localization;
        this.changeDetector = changeDetector;
        this.focusService = focusService;
        this.viewState = viewState;
        this.isOpen = false;
    }
    openRemoveConfirmationDialog() {
        const dialog = this.dialogService.open({
            title: this.textFor('deleteDialogTitle'),
            content: this.textFor('deleteConfirmation'),
            actions: [
                { text: this.textFor('cancel'), value: false },
                { text: this.textFor('destroy'), value: true }
            ],
            appendTo: this.container,
            autoFocusedElement: 'button:nth-child(2)'
        });
        this.isOpen = true;
        this.changeDetector.markForCheck();
        return dialog.result.pipe(map((result) => {
            this.isOpen = false;
            if (result instanceof DialogCloseResult) {
                this.focusService.focus();
                return false;
            }
            this.viewState.layoutEnd.pipe(take(1)).subscribe(() => this.focusService.focus());
            const res = result;
            return res.value;
        }));
    }
    openRecurringConfirmationDialog(operation) {
        const dialog = this.dialogService.open({
            actions: [
                {
                    text: operation === 0 /* Edit */ ? this.textFor('editOccurrence') : this.textFor('deleteOccurrence'),
                    value: 1 /* Occurrence */
                },
                {
                    text: operation === 0 /* Edit */ ? this.textFor('editSeries') : this.textFor('deleteSeries'),
                    value: 2 /* Series */
                }
            ],
            appendTo: this.container,
            autoFocusedElement: 'button:nth-child(1)',
            content: operation === 0 /* Edit */ ? this.textFor('editRecurringConfirmation') : this.textFor('deleteRecurringConfirmation'),
            title: operation === 0 /* Edit */ ? this.textFor('editRecurringDialogTitle') : this.textFor('deleteRecurringDialogTitle')
        });
        this.isOpen = true;
        this.changeDetector.markForCheck();
        return dialog.result.pipe(map((result) => {
            this.isOpen = false;
            this.focusService.focus();
            if (result instanceof DialogCloseResult) {
                return undefined;
            }
            const res = result;
            return res.value;
        }));
    }
    textFor(key) {
        return this.localization.get(key);
    }
}
DialogsService.ɵfac = function DialogsService_Factory(t) { return new (t || DialogsService)(ɵngcc0.ɵɵinject(ɵngcc1.DialogService), ɵngcc0.ɵɵinject(ɵngcc2.LocalizationService), ɵngcc0.ɵɵinject(ɵngcc0.ChangeDetectorRef), ɵngcc0.ɵɵinject(FocusService), ɵngcc0.ɵɵinject(ViewStateService)); };
DialogsService.ɵprov = ɵngcc0.ɵɵdefineInjectable({ token: DialogsService, factory: DialogsService.ɵfac });
/** @nocollapse */
DialogsService.ctorParameters = () => [
    { type: DialogService },
    { type: LocalizationService },
    { type: ChangeDetectorRef },
    { type: FocusService },
    { type: ViewStateService }
];
/*@__PURE__*/ (function () { ɵngcc0.ɵsetClassMetadata(DialogsService, [{
        type: Injectable
    }], function () { return [{ type: ɵngcc1.DialogService }, { type: ɵngcc2.LocalizationService }, { type: ɵngcc0.ChangeDetectorRef }, { type: FocusService }, { type: ViewStateService }]; }, null); })();

/**
 * @hidden
 */
class SchedulerLocalizationService extends LocalizationService {
    constructor(prefix, messageService, _rtl) {
        super(prefix, messageService, _rtl);
    }
}
SchedulerLocalizationService.ɵfac = function SchedulerLocalizationService_Factory(t) { return new (t || SchedulerLocalizationService)(ɵngcc0.ɵɵinject(L10N_PREFIX), ɵngcc0.ɵɵinject(ɵngcc2.MessageService, 8), ɵngcc0.ɵɵinject(RTL, 8)); };
SchedulerLocalizationService.ɵprov = ɵngcc0.ɵɵdefineInjectable({ token: SchedulerLocalizationService, factory: SchedulerLocalizationService.ɵfac });
/** @nocollapse */
SchedulerLocalizationService.ctorParameters = () => [
    { type: String, decorators: [{ type: Inject, args: [L10N_PREFIX,] }] },
    { type: MessageService, decorators: [{ type: Optional }] },
    { type: Boolean, decorators: [{ type: Optional }, { type: Inject, args: [RTL,] }] }
];


/**
 * @hidden
 */
const defaultModelFields = {
    id: 'id',
    start: 'start',
    startTimezone: 'startTimezone',
    end: 'end',
    endTimezone: 'endTimezone',
    isAllDay: 'isAllDay',
    title: 'title',
    description: 'description',
    recurrenceRule: 'recurrenceRule',
    recurrenceId: 'recurrenceId',
    recurrenceExceptions: 'recurrenceExceptions'
};

/**
 * @hidden
 */
class PDFService {
    constructor() {
        this.createElement = new EventEmitter();
        this.exportClick = new EventEmitter();
        this.done = new EventEmitter();
        this.elementReady = new EventEmitter();
    }
    save() {
        if (!hasObservers(this.elementReady)) {
            if (isDevMode()) {
                throw new Error('Creating PDF requires including the PDFModule and adding the <kendo-scheduler-pdf> component.');
            }
            return;
        }
        if (!hasObservers(this.createElement)) {
            if (isDevMode()) {
                throw new Error('No active Scheduler view to export.');
            }
            return;
        }
        this.createElement.emit();
    }
}
PDFService.ɵfac = function PDFService_Factory(t) { return new (t || PDFService)(); };
PDFService.ɵprov = ɵngcc0.ɵɵdefineInjectable({ token: PDFService, factory: PDFService.ɵfac });
/*@__PURE__*/ (function () { ɵngcc0.ɵsetClassMetadata(PDFService, [{
        type: Injectable
    }], function () { return []; }, null); })();

/**
 * The arguments for the `pdfExport` event.
 */
class PDFExportEvent extends PreventableEvent$1 {
}

/**
 * @hidden
 */
class LoadingComponent {
    constructor(element, renderer) {
        this.element = element;
        this.renderer = renderer;
        this.hostClasses = true;
    }
    get display() {
        return this.loading || this.force ? 'block' : 'none';
    }
    toggle(value) {
        this.force = value;
        this.renderer.setStyle(this.element.nativeElement, 'display', this.display);
    }
}
LoadingComponent.ɵfac = function LoadingComponent_Factory(t) { return new (t || LoadingComponent)(ɵngcc0.ɵɵdirectiveInject(ɵngcc0.ElementRef), ɵngcc0.ɵɵdirectiveInject(ɵngcc0.Renderer2)); };
LoadingComponent.ɵcmp = ɵngcc0.ɵɵdefineComponent({ type: LoadingComponent, selectors: [["", "kendoSchedulerLoading", ""]], hostVars: 4, hostBindings: function LoadingComponent_HostBindings(rf, ctx) { if (rf & 2) {
        ɵngcc0.ɵɵstyleProp("display", ctx.display);
        ɵngcc0.ɵɵclassProp("k-loading-mask", ctx.hostClasses);
    } }, inputs: { loading: "loading" }, attrs: _c0, decls: 2, vars: 0, consts: [[1, "k-loading-image"], [1, "k-loading-color"]], template: function LoadingComponent_Template(rf, ctx) { if (rf & 1) {
        ɵngcc0.ɵɵelement(0, "div", 0);
        ɵngcc0.ɵɵelement(1, "div", 1);
    } }, encapsulation: 2 });
/** @nocollapse */
LoadingComponent.ctorParameters = () => [
    { type: ElementRef },
    { type: Renderer2 }
];
LoadingComponent.propDecorators = {
    hostClasses: [{ type: HostBinding, args: ['class.k-loading-mask',] }],
    loading: [{ type: Input }],
    display: [{ type: HostBinding, args: ['style.display',] }]
};
/*@__PURE__*/ (function () { ɵngcc0.ɵsetClassMetadata(LoadingComponent, [{
        type: Component,
        args: [{
                // tslint:disable-next-line:component-selector
                selector: '[kendoSchedulerLoading]',
                template: `
        <div class="k-loading-image"></div>
        <div class="k-loading-color"></div>
    `
            }]
    }], function () { return [{ type: ɵngcc0.ElementRef }, { type: ɵngcc0.Renderer2 }]; }, { hostClasses: [{
            type: HostBinding,
            args: ['class.k-loading-mask']
        }], display: [{
            type: HostBinding,
            args: ['style.display']
        }], loading: [{
            type: Input
        }] }); })();

/**
 * @hidden
 */
class FocusableDirective {
    constructor(element, renderer, focusService) {
        this.element = element;
        this.renderer = renderer;
        this.focusService = focusService;
        /**
         * The order of the element with respect to the other focusable elements.
         * If multiple elements share the same value, their relative to each other order follows their position in the component tree.
         */
        this.focusIndex = 0;
        this.toggle(false);
        this.focusService.register(this);
    }
    get visible() {
        return this.element.nativeElement.style.display !== 'none';
    }
    get enabled() {
        return !this.element.nativeElement.disabled;
    }
    ngOnDestroy() {
        this.focusService.unregister(this);
    }
    toggle(active) {
        if (active !== this.active) {
            const index = active ? '0' : '-1';
            this.renderer.setAttribute(this.element.nativeElement, 'tabIndex', index);
            this.active = active;
        }
    }
    canFocus() {
        return this.visible && this.enabled;
    }
    focus() {
        this.element.nativeElement.focus();
    }
    toggleFocus(value) {
        const focusedClass = 'k-state-selected';
        const element = this.element.nativeElement;
        if (value) {
            this.renderer.addClass(element, focusedClass);
        }
        else {
            this.renderer.removeClass(element, focusedClass);
        }
        this.renderer.setAttribute(element, 'aria-selected', value.toString());
    }
}
FocusableDirective.ɵfac = function FocusableDirective_Factory(t) { return new (t || FocusableDirective)(ɵngcc0.ɵɵdirectiveInject(ɵngcc0.ElementRef), ɵngcc0.ɵɵdirectiveInject(ɵngcc0.Renderer2), ɵngcc0.ɵɵdirectiveInject(FocusService)); };
FocusableDirective.ɵdir = ɵngcc0.ɵɵdefineDirective({ type: FocusableDirective, selectors: [["", "kendoSchedulerFocusIndex", ""]], inputs: { focusIndex: ["kendoSchedulerFocusIndex", "focusIndex"] } });
/** @nocollapse */
FocusableDirective.ctorParameters = () => [
    { type: ElementRef },
    { type: Renderer2 },
    { type: FocusService }
];
FocusableDirective.propDecorators = {
    focusIndex: [{ type: Input, args: ['kendoSchedulerFocusIndex',] }]
};
/*@__PURE__*/ (function () { ɵngcc0.ɵsetClassMetadata(FocusableDirective, [{
        type: Directive,
        args: [{
                selector: '[kendoSchedulerFocusIndex]'
            }]
    }], function () { return [{ type: ɵngcc0.ElementRef }, { type: ɵngcc0.Renderer2 }, { type: FocusService }]; }, { focusIndex: [{
            type: Input,
            args: ['kendoSchedulerFocusIndex']
        }] }); })();

// TODO: Move to @progress/kendo-common
const toClassList = (classNames) => String(classNames).trim().split(' ');
/**
 * @hidden
 */
const hasClasses = (element, classNames) => {
    const namesList = toClassList(classNames);
    return Boolean(toClassList(element.className).find((className) => namesList.indexOf(className) >= 0));
};
/**
 * @hidden
 */
const closest = (node, predicate) => {
    while (node && !predicate(node)) {
        node = node.parentNode;
    }
    return node;
};
/**
 * @hidden
 */
const firstElementChild = (node) => {
    const children = node.children;
    const length = children.length;
    for (let idx = 0; idx < length; idx++) {
        if (children[idx].nodeType === 1) {
            return children[idx];
        }
    }
};
/**
 * @hidden
 */
const closestInScope = (node, predicate, scope) => {
    while (node && node !== scope && !predicate(node)) {
        node = node.parentNode;
    }
    if (node !== scope) {
        return node;
    }
};
/**
 * @hidden
 */
const wheelDeltaY = (e) => {
    const deltaY = e.wheelDeltaY;
    if (e.wheelDelta && (deltaY === undefined || deltaY)) {
        return e.wheelDelta;
    }
    else if (e.detail && e.axis === e.VERTICAL_AXIS) {
        return (-e.detail) * 10;
    }
    return 0;
};
/**
 * @hidden
 */
const preventLockedScroll = el => event => {
    const delta = wheelDeltaY(event);
    const scrollTop = el.scrollTop;
    const allowScroll = (scrollTop === 0 && 0 < delta) || (el.scrollHeight <= el.offsetHeight + scrollTop && delta < 0);
    if (!allowScroll) {
        event.preventDefault();
    }
};
let cachedScrollbarWidth = 0;
/**
 * @hidden
 */
function scrollbarWidth() {
    if (!cachedScrollbarWidth && isDocumentAvailable()) {
        const div = document.createElement("div");
        div.style.cssText = "overflow:scroll;overflow-x:hidden;zoom:1;clear:both;display:block";
        div.innerHTML = "&nbsp;";
        document.body.appendChild(div);
        cachedScrollbarWidth = div.offsetWidth - div.scrollWidth;
        document.body.removeChild(div);
    }
    return cachedScrollbarWidth;
}
/**
 * @hidden
 */
function hasScrollbar(element, type) {
    const sizeField = type === 'vertical' ? 'Height' : 'Width';
    return element[`scroll${sizeField}`] > element[`client${sizeField}`];
}
/**
 * @hidden
 */
function rtlScrollPosition(element, position) {
    const initial = element.scrollLeft;
    let result = position;
    element.scrollLeft = -1;
    if (element.scrollLeft < 0) {
        result = -position;
    }
    else if (initial > 0) {
        result = element.scrollWidth - element.offsetWidth - position;
    }
    return result;
}

const todayDate = () => getDate(new Date());
const DAYS_IN_WEEK = 7;
/**
 * Represents the [Kendo UI Scheduler component for Angular]({% slug overview_scheduler %}).
 *
 * @example
 * ```ts-preview
 * _@Component({
 *    selector: 'my-app',
 *    template: `
 *        <kendo-scheduler style="height: 600px">
 *            <kendo-scheduler-day-view>
 *            </kendo-scheduler-day-view>
 *            <kendo-scheduler-week-view>
 *            </kendo-scheduler-week-view>
 *        </kendo-scheduler>
 *    `
 * })
 * class AppComponent {}
 * ```
 */
class SchedulerComponent {
    constructor(wrapper, viewContext, viewState, editService, dialogsService, intlService, changeDetector, zone, pdfService, localization, domEvents, renderer, focusService) {
        this.wrapper = wrapper;
        this.viewContext = viewContext;
        this.viewState = viewState;
        this.editService = editService;
        this.dialogsService = dialogsService;
        this.intlService = intlService;
        this.changeDetector = changeDetector;
        this.zone = zone;
        this.pdfService = pdfService;
        this.localization = localization;
        this.domEvents = domEvents;
        this.renderer = renderer;
        this.focusService = focusService;
        this.hostClasses = true;
        this.rtl = false;
        /**
         * Specifies if the Scheduler is editable.
         */
        this.editable = false;
        /**
         * The height of the events in the **Month** and **Timeline** views, and the height of the **All day** events in the **Day** and **Week** views.
         */
        this.eventHeight = 25;
        /**
         * Specifies the columns width. Applicable for the **Timeline** views.
         */
        this.columnWidth = 100;
        /**
         * The start time of the view. The Scheduler displays events which start after the start time.
         * Accepts string values in the `HH:mm` format. Applicable for the **Day**, **Week**, and **Timeline** views.
         */
        this.startTime = '00:00';
        /**
         * The end time of the view. The Scheduler displays events which end before the end time.
         * Accepts string values in the `HH:mm` format. Applicable for the **Day**, **Week**, and **Timeline** views.
         */
        this.endTime = '00:00';
        /**
         * The start time of the view when `showWorkHours` is set to `true`.
         * Accepts string values in the `HH:mm` format. Applicable for the **Day**, **Week**, and **Timeline** views.
         */
        this.workDayStart = '08:00';
        /**
         * The end time of the view when `showWorkHours` is set to `true`.
         * Accepts string values in the `HH:mm` format. Applicable for the **Day**, **Week**, and **Timeline** views.
         */
        this.workDayEnd = '17:00';
        /**
         * The duration (in minutes) of the time slots. Applicable for the day, week and timeline views.
         */
        this.slotDuration = 60;
        /**
         * The number of divisions of the time slots. Applicable for the **Day**, **Week**, and **Timeline** views.
         */
        this.slotDivisions = 2;
        /**
         * A numeric value between 0 and 1 that specifies what percentage of the slot will be filled by the events.
         * Applicable for the **Day** and **Week** views.
         * Defaults to `0.9` (90% fill).
         */
        this.slotFill = 0.9;
        /**
         * The time to which the view will initially be scrolled.
         * Accepts string values in the `HH:mm` format or a JavaScript `Date`. Applicable for the **Day**, **Week**, and **Timeline** views.
         */
        this.scrollTime = this.workDayStart;
        /**
         * Specifies the Scheduler current time marker settings.
         */
        this.currentTimeMarker = true;
        /**
         * @hidden
         */
        this.selectedViewIndexChange = new EventEmitter();
        /**
         * Fires when the Scheduler is about to execute a navigation action
         * (a view, date, or focus change).
         */
        this.navigate = new EventEmitter();
        /**
         * Fires when the date range that is displayed in the Scheduler changes.
         */
        this.dateChange = new EventEmitter();
        /**
         * Fires when a Scheduler view slot is clicked.
         */
        this.slotClick = new EventEmitter();
        /**
         * Fires when a Scheduler view slot is double-clicked.
         */
        this.slotDblClick = new EventEmitter();
        /**
         * Fires when the user creates a new event using the `'c'` key.
         * ([see example]({% slug keyboard_navigation_scheduler %})).
         */
        this.create = new EventEmitter();
        /**
         * Fires when a Scheduler event is clicked.
         */
        this.eventClick = new EventEmitter();
        /**
         * Fires when a Scheduler event is double-clicked.
         */
        this.eventDblClick = new EventEmitter();
        /**
         * Fires when a key is pressed on a focused Scheduler event.
         */
        this.eventKeydown = new EventEmitter();
        /**
         * Fires when the user cancels the editing by clicking the **Cancel** command button.
         */
        this.cancel = new EventEmitter();
        /**
         * Fires when the user clicks the **Save** command button to save the changes of the edited event.
         */
        this.save = new EventEmitter();
        /**
         * Fires when the user clicks the **Remove** icon of a Scheduler event.
         */
        this.remove = new EventEmitter();
        /**
         * Fires when the user starts resizing a Scheduler event.
         */
        this.resizeStart = new EventEmitter();
        /**
         * Fires when the user is resizing a Scheduler event.
         */
        this.resize = new EventEmitter();
        /**
         * Fires when the user stops resizing a Scheduler event.
         */
        this.resizeEnd = new EventEmitter();
        /**
         * Fires when the user starts dragging a Scheduler event.
         */
        this.dragStart = new EventEmitter();
        /**
         * Fires when the user is dragging a Scheduler event.
         */
        this.drag = new EventEmitter();
        /**
         * Fires when the user stops dragging a Scheduler event.
         */
        this.dragEnd = new EventEmitter();
        /**
         * Fires when the user clicks the **PDF export** command button.
         */
        this.pdfExport = new EventEmitter();
        /**
         * @hidden
         */
        this.dragEndConfirmed = new EventEmitter();
        /**
         * @hidden
         */
        this.resizeEndConfirmed = new EventEmitter();
        /**
         * @hidden
         */
        this.removeConfirmed = new EventEmitter();
        this.viewIndex = 0;
        this._timezone = '';
        this._modelFields = defaultModelFields;
        this.dateRangeStream = viewState.dateRange;
        this.selectedDateStream = viewContext.selectedDate;
    }
    get dir() {
        return this.direction;
    }
    /**
     * The index of the currently selected view.
     *
     * By default, the selected view index is `0` and
     * indicates that the first declared view is visible.
     */
    set selectedViewIndex(index) {
        this.viewIndex = index;
        this.onViewIndexChange();
    }
    get selectedViewIndex() {
        return this.viewIndex;
    }
    /**
     * Specifies the id of the timezone that will be displayed in the Scheduler.
     * For example, `Europe/Sofia`.
     * Defaults to `Etc/UTC`.
     */
    set timezone(value) {
        this._timezone = value;
        this.events = this.events || [];
    }
    get timezone() {
        return this._timezone;
    }
    /**
     * An array of event instances which will be shown by the Scheduler.
     */
    set events(value) {
        this._events = value;
        this.processEvents(value);
    }
    get events() {
        return this._events;
    }
    /**
     * The currently selected date of the Scheduler.
     * Determines the period which is displayed.
     */
    set selectedDate(value) {
        if (!value) {
            return;
        }
        this._selectedDate = value;
        this.viewContext.notifySelectedDate(value);
    }
    get selectedDate() {
        return this._selectedDate;
    }
    /**
     * The names of the model fields from which the Scheduler will read its data
     * ([see example]({% slug databinding_scheduler %}#toc-binding-to-models)).
     */
    set modelFields(value) {
        this._modelFields = Object.assign({}, defaultModelFields, value);
    }
    get modelFields() {
        return this._modelFields;
    }
    ngOnInit() {
        if (!this.selectedDate) {
            this.selectedDate = todayDate();
        }
    }
    ngAfterContentInit() {
        if (isDevMode() && this.views.length === 0) {
            throw new Error('No views declared for <kendo-scheduler>. Please, declare at least one view.');
        }
        this.subs = this.views.changes.subscribe(() => this.resetViewIndex());
        this.subs.add(this.intlService.changes.subscribe(this.intlChange.bind(this)));
        this.subs.add(this.viewState.nextDate.subscribe(nextDate => {
            this.selectedDate = nextDate;
        }));
        this.subs.add(this.viewState.dateRange.subscribe(dateRange => {
            const isEmpty = dateRange.start.getTime() === 0;
            if (!isEmpty) {
                const args = new DateChangeEvent(this, this.selectedDate, dateRange);
                this.dateChange.emit(args);
            }
        }));
        this.subs.add(this.viewState.navigate.subscribe(({ viewName, date }) => {
            const views = this.views.toArray();
            const view = views.find(v => v.name === viewName);
            const args = new NavigateEvent(this, {
                type: 'show-date',
                view: view || {
                    name: viewName,
                    title: viewName
                },
                date: date
            });
            this.navigate.next(args);
            if (view && !args.isDefaultPrevented()) {
                const index = views.indexOf(view);
                this.selectedView = view;
                this.setViewIndex(index);
                this.selectedDate = date;
            }
        }));
        this.subs.add(this.viewState.viewEvent.subscribe(({ name, args }) => {
            const emitter = this[name];
            const confirmedEmitter = this[`${name}Confirmed`];
            if (hasObservers(emitter) || (confirmedEmitter && hasObservers(confirmedEmitter))) {
                this.zone.run(() => {
                    const eventInstance = new VIEW_EVENT_MAP[name](this, args);
                    emitter.emit(eventInstance);
                    args.prevented = eventInstance.prevented;
                    if (confirmedEmitter && !args.prevented) {
                        confirmedEmitter.emit(eventInstance);
                    }
                });
            }
        }));
        this.subs.add(this.viewState.layoutEnd.subscribe(() => {
            if (this.resizeSensor) {
                this.resizeSensor.acceptSize();
            }
        }));
        this.onViewIndexChange();
        this.notifyOptionsChange = this.notifyOptionsChange.bind(this);
        this.subs.add(this.allDayEventTemplate.changes.subscribe(this.notifyOptionsChange));
        this.subs.add(this.eventTemplate.changes.subscribe(this.notifyOptionsChange));
        this.subs.add(this.timeSlotTemplate.changes.subscribe(this.notifyOptionsChange));
        this.subs.add(this.timeSlotTemplate.changes.subscribe(this.notifyOptionsChange));
        this.subs.add(this.minorTimeHeaderTemplate.changes.subscribe(this.notifyOptionsChange));
        this.subs.add(this.majorTimeHeaderTemplate.changes.subscribe(this.notifyOptionsChange));
        this.subs.add(this.monthDaySlotTemplate.changes.subscribe(this.notifyOptionsChange));
        this.subs.add(this.dateHeaderTemplate.changes.subscribe(this.notifyOptionsChange));
        this.subs.add(this.allDaySlotTemplate.changes.subscribe(this.notifyOptionsChange));
        this.subs.add(this.groupHeaderTemplate.changes.subscribe(this.notifyOptionsChange));
        this.subs.add(this.agendaDateTemplate.changes.subscribe(this.notifyOptionsChange));
        this.subs.add(this.agendaTimeTemplate.changes.subscribe(this.notifyOptionsChange));
        this.subs.add(this.views.changes.subscribe(() => {
            this.changeDetector.markForCheck();
        }));
        //this.editService.timezone = this.timezone;
        this.attachEditHandlers();
        this.dialogsService.container = this.confirmationDialogContainerRef;
        this.notifyOptionsChange();
        this.subs.add(this.pdfService.exportClick.subscribe(() => {
            const args = new PDFExportEvent();
            this.pdfExport.emit(args);
            if (!args.isDefaultPrevented()) {
                this.saveAsPDF();
            }
        }));
        this.subs.add(this.pdfService.done.subscribe(() => {
            this.loadingComponent.toggle(false);
        }));
        this.subs.add(this.localization.changes.subscribe(({ rtl }) => {
            this.rtl = rtl;
            this.direction = this.rtl ? 'rtl' : 'ltr';
        }));
        this.subs.add(this.viewState.optionsChange.subscribe(() => {
            this.changeDetector.markForCheck();
        }));
        this.attachElementEventHandlers();
    }
    ngOnChanges(changes) {
        if (isChanged('resources', changes) && !isChanged('events', changes) && this.viewItems) {
            this.viewItems.forEach(item => {
                copyResources(item.event, this.resources);
            });
        }
        if (anyChanged(['group', 'resources', 'min', 'max', 'showWorkHours', 'startTime', 'scrollTime', 'endTime', 'eventHeight',
            'workDayStart', 'workDayEnd', 'workWeekStart', 'workWeekEnd', 'slotDuration', 'slotDivisions',
            'editable', 'timezone', 'slotClass', 'slotFill', 'columnWidth', 'eventClass', 'eventStyles'], changes)) {
            this.notifyOptionsChange(changes);
        }
    }
    ngOnDestroy() {
        if (this.subs) {
            this.subs.unsubscribe();
        }
        if (this.detachElementEventHandlers) {
            this.detachElementEventHandlers();
        }
    }
    /**
     * @hidden
     */
    onResize(_event) {
        this.viewContext.notifyResize();
    }
    /**
     * @hidden
     */
    onNavigationAction(action) {
        const args = new NavigateEvent(this, action);
        this.navigate.next(args);
        if (args.isDefaultPrevented()) {
            return true;
        }
        if (action.type === 'view-change') {
            const views = this.views.toArray();
            const index = views.indexOf(action.view);
            this.selectedView = action.view;
            this.setViewIndex(index);
        }
        else if (action.type === 'select-date') {
            if (this.isInRange(action.date)) {
                this.selectedDate = action.date;
            }
        }
        else if (action.type === 'today') {
            const date = new Date();
            if (this.isInRange(date)) {
                this.selectedDate = date;
            }
        }
        else {
            this.viewContext.notifyAction(action);
        }
    }
    /**
     * Creates a popup editor for the new event.
     *
     * @param group - The [`FormGroup`](https://angular.io/docs/ts/latest/api/forms/index/FormGroup-class.html) that describes
     * the edit form. If called with a data item, the parameter will build the `FormGroup` from the data item fields.
     */
    addEvent(group) {
        const isFormGroup = group instanceof FormGroup;
        if (!isFormGroup) {
            const createControl = (source) => (acc, key) => {
                acc[key] = new FormControl(source[key]);
                return acc;
            };
            const fields = Object.keys(group).reduce(createControl(group), {});
            group = new FormGroup(fields);
        }
        this.editService.addEvent(group);
    }
    /**
     * Switches the specified event in edit mode.
     *
     * @param dataItem - The event that will be switched to edit mode.
     * @param options - An object which contains the form `group` that will be bound in the edit dialog and the current edit `mode`.
     *
     */
    editEvent(dataItem, options = {}) {
        const { group, mode } = options;
        this.editService.editEvent(dataItem, group, mode);
    }
    /**
     * Closes the event editor, if open.
     */
    closeEvent() {
        this.editService.close();
    }
    /**
     * Returns a flag which indicates if an event is currently edited.
     *
     * @return {boolean} - A flag which indicates if an event is currently edited.
     */
    isEditing() {
        return this.editService.isEditing();
    }
    /**
     * Opens the built-in confirmation dialog for defining the edit mode
     * that will be used when the user edits or removes a recurring event.
     *
     * @param operation - The type of operation that will be confirmed. Has to be either **Edit** or **Remove**.
     *
     * @return {Observable<EditMode>}
     */
    openRecurringConfirmationDialog(operation) {
        return this.dialogsService.openRecurringConfirmationDialog(operation);
    }
    /**
     * Opens the built-in removal confirmation dialog.
     *
     * @return {Observable<boolean>}
     */
    openRemoveConfirmationDialog() {
        return this.dialogsService.openRemoveConfirmationDialog();
    }
    /**
     * Saves the current view as PDF.
     */
    saveAsPDF() {
        this.loadingComponent.toggle(true);
        this.zone.runOutsideAngular(() => {
            // wait a tick in order for the loading element style to be updated by the browser.
            // if the export is synchronous, the browser will not update the element before the export is finished.
            setTimeout(() => {
                this.pdfService.save();
            }, 0);
        });
    }
    /**
     * Scrolls the view to the specified time.
     */
    scrollToTime(time) {
        this.viewContext.notifyAction({
            type: 'scroll-time',
            time: time
        });
    }
    /**
     * Returns the current view slot that matches the passed document position.
     *
     * @param x - The x document position.
     * @param y - The y document position.
     *
     * @return {SchedulerSlot} - The slot.
     *
     * {% embed_file drag-and-drop/app.component.ts %}
     * {% embed_file drag-and-drop/draggable.directive.ts %}
     * {% embed_file drag-and-drop/app.module.ts %}
     * {% embed_file shared/main.ts %}
     */
    slotByPosition(x, y) {
        return this.viewContext.executeMethod('slotByPosition', { x, y });
    }
    /**
     * Returns the event associated with the specified DOM element, if any.
     *
     * @param element - The DOM element document position.
     * @return the event instance, if found.
     */
    eventFromElement(element) {
        return this.viewContext.executeMethod('eventFromElement', { element });
    }
    /**
     * Gets the currently active event, if any.
     * The active event is the event that can currently receive focus.
     */
    get activeEvent() {
        const activeElement = this.focusService.activeElement;
        if (activeElement) {
            return this.eventFromElement(activeElement.nativeElement);
        }
    }
    /**
     * Focuses the next event or an event at a specified relative position.
     * The `options` parameter can be used to set a positive or negative offset
     * that is relative to the currently focused event.
     * A `nowrap` flag toggles the wrapping to the first or to the last item.
     *
     * @example
     * ```ts-no-run
     * scheduler.focusNext(); // Focuses the next event.
     * scheduler.focusNext({ offset: 1 }); // Focuses the next event.
     * scheduler.focusNext({ offset: -1 }); // Focuses the previous event.
     * scheduler.focusNext({ nowrap: true }); // If the focus is on the last event, does not move the focus to the first event.
     * ```
     *
     * @param position The relative position of the event to focus.
     * @returns `true` if the focused event changed. Otherwise, returns `false`.
     */
    focusNext(position) {
        return this.focusService.focusNext(position);
    }
    /**
     * Focuses the previous event or an event at a specified relative position.
     * The `options` parameter can be used to set a positive or negative offset
     * that is relative to the currently focused event.
     * A `nowrap` flag toggles the wrapping to the first or to the last item.
     *
     * @example
     * ```ts-no-run
     * scheduler.focusPrev(); // Focuses the previous event
     * scheduler.focusPrev({ nowrap: true }); // Does not move the focus to the last event, if focus is on the first one.
     * ```
     *
     * @param position The relative position of the event to focus.
     * @returns `true` if the focused event changed. Otherwise, returns `false`.
     */
    focusPrev(position) {
        const prevPosition = Object.assign({ offset: -1 }, position);
        return this.focusService.focusNext(prevPosition);
    }
    /**
     * Focuses the last focused event or the Scheduler element, if no events are available.
     */
    focus() {
        return this.focusService.focus();
    }
    isInRange(date) {
        return (!this.min || this.min <= date) && (!this.max || date <= this.max);
    }
    notifyOptionsChange(changes) {
        const workweek = this.workWeek;
        this.viewContext.notifyOptionsChange({
            group: this.group,
            resources: this.resources,
            allDayEventTemplate: this.allDayEventTemplate ? this.allDayEventTemplate.first : null,
            eventTemplate: this.eventTemplate ? this.eventTemplate.first : null,
            timeSlotTemplate: this.timeSlotTemplate ? this.timeSlotTemplate.first : null,
            minorTimeHeaderTemplate: this.minorTimeHeaderTemplate ? this.minorTimeHeaderTemplate.first : null,
            majorTimeHeaderTemplate: this.majorTimeHeaderTemplate ? this.majorTimeHeaderTemplate.first : null,
            monthDaySlotTemplate: this.monthDaySlotTemplate ? this.monthDaySlotTemplate.first : null,
            dateHeaderTemplate: this.dateHeaderTemplate ? this.dateHeaderTemplate.first : null,
            allDaySlotTemplate: this.allDaySlotTemplate ? this.allDaySlotTemplate.first : null,
            groupHeaderTemplate: this.groupHeaderTemplate ? this.groupHeaderTemplate.first : null,
            agendaDateTemplate: this.agendaDateTemplate ? this.agendaDateTemplate.first : null,
            agendaTimeTemplate: this.agendaTimeTemplate ? this.agendaTimeTemplate.first : null,
            min: this.min,
            max: this.max,
            showWorkHours: this.showWorkHours,
            startTime: this.startTime,
            scrollTime: this.scrollTime,
            endTime: this.endTime,
            workDayStart: this.workDayStart,
            workDayEnd: this.workDayEnd,
            workWeekStart: workweek.start,
            workWeekEnd: workweek.end,
            slotDuration: this.slotDuration,
            slotDivisions: this.slotDivisions,
            eventHeight: this.eventHeight,
            editable: this.editable,
            timezone: this.timezone,
            currentTimeMarker: this.currentTimeMarker,
            slotClass: this.slotClass,
            slotFill: this.slotFill,
            columnWidth: this.columnWidth,
            eventClass: this.eventClass,
            eventStyles: this.eventStyles,
            changes: changes
        });
    }
    get workWeek() {
        let { start, end } = this.intlService.weekendRange();
        const workWeekStart = isPresent(this.workWeekStart) ? this.workWeekStart : (end + 1) % DAYS_IN_WEEK;
        const weekEnd = start > 0 ? start - 1 : Day.Saturday;
        const workWeekEnd = isPresent(this.workWeekEnd) ? this.workWeekEnd : weekEnd;
        return { start: workWeekStart, end: workWeekEnd };
    }
    resetViewIndex() {
        const index = this.selectedViewIndex;
        const newIndex = Math.max(0, Math.min(index, this.views.length - 1));
        this.setViewIndex(newIndex);
        this.onViewIndexChange();
    }
    onViewIndexChange() {
        if (!this.views) {
            return;
        }
        const views = this.views.toArray();
        const selectedView = views[this.viewIndex];
        if (selectedView) {
            this.selectedView = selectedView;
        }
    }
    setViewIndex(newIndex) {
        const changed = this.selectedViewIndex !== newIndex;
        if (changed) {
            this.selectedViewIndex = newIndex;
            this.selectedViewIndexChange.emit(newIndex);
        }
        return changed;
    }
    processEvents(dataItems) {
        const timezone = this.timezone;
        const fields = this.modelFields;
        const items = dataItems
            .map(dataItem => readEvent(dataItem, fields, this.resources))
            .filter(event => !isRecurrenceMaster(event))
            .map(event => {
            const start = ZonedDate.fromLocalDate(event.start, timezone);
            const end = ZonedDate.fromLocalDate(event.end, timezone);
            return { start, end, event };
        });
        this.viewItems = items;
        this.viewContext.notifyItems(items);
    }
    attachEditHandlers() {
        if (!this.editService) {
            return;
        }
        this.subs.add(this.editService.changes.subscribe(this.emitCRUDEvent.bind(this)));
    }
    emitCRUDEvent(args) {
        Object.assign(args, { sender: this });
        switch (args.action) {
            case 'cancel':
                this.cancel.emit(args);
                break;
            case 'save':
                this.save.emit(args);
                break;
            default: break;
        }
    }
    intlChange() {
        const currentView = this.selectedView;
        this.selectedView = null;
        if (!isPresent(this.workWeekStart) || !isPresent(this.workWeekEnd)) {
            this.notifyOptionsChange();
        }
        this.changeDetector.detectChanges();
        this.selectedView = currentView;
        if (NgZone.isInAngularZone()) {
            this.changeDetector.markForCheck();
        }
        else {
            this.changeDetector.detectChanges();
        }
    }
    attachElementEventHandlers() {
        if (!isDocumentAvailable()) {
            return;
        }
        const wrapper = this.wrapper.nativeElement;
        this.zone.runOutsideAngular(() => {
            const windowBlurSubscription = this.renderer.listen('window', 'blur', (args) => {
                this.domEvents.windowBlur.emit(args);
            });
            const clickSubscription = this.renderer.listen(wrapper, 'click', (args) => {
                this.domEvents.click.emit(args);
            });
            const keydownSubscription = this.renderer.listen(wrapper, 'keydown', args => {
                this.domEvents.keydown.emit(args);
            });
            let focused = false;
            const focusInSubscription = this.renderer.listen(wrapper, 'focusin', (args) => {
                this.domEvents.focus.emit(args);
                if (!focused) {
                    this.domEvents.focusIn.emit(args);
                    this.renderer.addClass(this.wrapper.nativeElement, 'k-state-focused');
                    focused = true;
                }
            });
            const focusOutSubscription = this.renderer.listen(wrapper, 'focusout', (args) => {
                const next = args.relatedTarget || document.activeElement;
                const outside = !closest(next, (node) => node === wrapper);
                if (outside) {
                    this.domEvents.focusOut.emit(args);
                    this.renderer.removeClass(this.wrapper.nativeElement, 'k-state-focused');
                    focused = false;
                }
            });
            this.detachElementEventHandlers = () => {
                windowBlurSubscription();
                clickSubscription();
                keydownSubscription();
                focusInSubscription();
                focusOutSubscription();
            };
        });
    }
}
SchedulerComponent.ɵfac = function SchedulerComponent_Factory(t) { return new (t || SchedulerComponent)(ɵngcc0.ɵɵdirectiveInject(ɵngcc0.ElementRef), ɵngcc0.ɵɵdirectiveInject(ViewContextService), ɵngcc0.ɵɵdirectiveInject(ViewStateService), ɵngcc0.ɵɵdirectiveInject(EditService), ɵngcc0.ɵɵdirectiveInject(DialogsService), ɵngcc0.ɵɵdirectiveInject(ɵngcc3.IntlService), ɵngcc0.ɵɵdirectiveInject(ɵngcc0.ChangeDetectorRef), ɵngcc0.ɵɵdirectiveInject(ɵngcc0.NgZone), ɵngcc0.ɵɵdirectiveInject(PDFService), ɵngcc0.ɵɵdirectiveInject(ɵngcc2.LocalizationService), ɵngcc0.ɵɵdirectiveInject(DomEventsService), ɵngcc0.ɵɵdirectiveInject(ɵngcc0.Renderer2), ɵngcc0.ɵɵdirectiveInject(FocusService)); };
SchedulerComponent.ɵcmp = ɵngcc0.ɵɵdefineComponent({ type: SchedulerComponent, selectors: [["kendo-scheduler"]], contentQueries: function SchedulerComponent_ContentQueries(rf, ctx, dirIndex) { if (rf & 1) {
        ɵngcc0.ɵɵcontentQuery(dirIndex, EditDialogTemplateDirective, true);
        ɵngcc0.ɵɵcontentQuery(dirIndex, ToolbarTemplateDirective, true);
        ɵngcc0.ɵɵcontentQuery(dirIndex, SchedulerView, false);
        ɵngcc0.ɵɵcontentQuery(dirIndex, AllDayEventTemplateDirective, false);
        ɵngcc0.ɵɵcontentQuery(dirIndex, EventTemplateDirective, false);
        ɵngcc0.ɵɵcontentQuery(dirIndex, TimeSlotTemplateDirective, false);
        ɵngcc0.ɵɵcontentQuery(dirIndex, MinorTimeHeaderTemplateDirective, false);
        ɵngcc0.ɵɵcontentQuery(dirIndex, MajorTimeHeaderTemplateDirective, false);
        ɵngcc0.ɵɵcontentQuery(dirIndex, MonthDaySlotTemplateDirective, false);
        ɵngcc0.ɵɵcontentQuery(dirIndex, DateHeaderTemplateDirective, false);
        ɵngcc0.ɵɵcontentQuery(dirIndex, AllDaySlotTemplateDirective, false);
        ɵngcc0.ɵɵcontentQuery(dirIndex, GroupHeaderTemplateDirective, false);
        ɵngcc0.ɵɵcontentQuery(dirIndex, AgendaDateTemplateDirective, false);
        ɵngcc0.ɵɵcontentQuery(dirIndex, AgendaTimeTemplateDirective, false);
    } if (rf & 2) {
        var _t;
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.editDialogTemplate = _t.first);
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.toolbarTemplate = _t.first);
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.views = _t);
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.allDayEventTemplate = _t);
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.eventTemplate = _t);
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.timeSlotTemplate = _t);
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.minorTimeHeaderTemplate = _t);
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.majorTimeHeaderTemplate = _t);
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.monthDaySlotTemplate = _t);
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.dateHeaderTemplate = _t);
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.allDaySlotTemplate = _t);
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.groupHeaderTemplate = _t);
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.agendaDateTemplate = _t);
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.agendaTimeTemplate = _t);
    } }, viewQuery: function SchedulerComponent_Query(rf, ctx) { if (rf & 1) {
        ɵngcc0.ɵɵviewQuery(ResizeSensorComponent, true);
        ɵngcc0.ɵɵstaticViewQuery(_c1, true, ViewContainerRef);
        ɵngcc0.ɵɵviewQuery(LoadingComponent, true);
    } if (rf & 2) {
        var _t;
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.resizeSensor = _t.first);
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.confirmationDialogContainerRef = _t.first);
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.loadingComponent = _t.first);
    } }, hostVars: 9, hostBindings: function SchedulerComponent_HostBindings(rf, ctx) { if (rf & 2) {
        ɵngcc0.ɵɵattribute("dir", ctx.dir);
        ɵngcc0.ɵɵclassProp("k-widget", ctx.hostClasses)("k-scheduler", ctx.hostClasses)("k-floatwrap", ctx.hostClasses)("k-rtl", ctx.rtl);
    } }, inputs: { editable: "editable", eventHeight: "eventHeight", columnWidth: "columnWidth", startTime: "startTime", endTime: "endTime", workDayStart: "workDayStart", workDayEnd: "workDayEnd", slotDuration: "slotDuration", slotDivisions: "slotDivisions", slotFill: "slotFill", scrollTime: "scrollTime", currentTimeMarker: "currentTimeMarker", selectedViewIndex: "selectedViewIndex", timezone: "timezone", events: "events", selectedDate: "selectedDate", modelFields: "modelFields", min: "min", max: "max", showWorkHours: "showWorkHours", workWeekStart: "workWeekStart", workWeekEnd: "workWeekEnd", group: "group", resources: "resources", loading: "loading", slotClass: "slotClass", eventClass: "eventClass", eventStyles: "eventStyles" }, outputs: { selectedViewIndexChange: "selectedViewIndexChange", navigate: "navigate", dateChange: "dateChange", slotClick: "slotClick", slotDblClick: "slotDblClick", create: "create", eventClick: "eventClick", eventDblClick: "eventDblClick", eventKeydown: "eventKeydown", cancel: "cancel", save: "save", remove: "remove", resizeStart: "resizeStart", resize: "resize", resizeEnd: "resizeEnd", dragStart: "dragStart", drag: "drag", dragEnd: "dragEnd", pdfExport: "pdfExport" }, features: [ɵngcc0.ɵɵProvidersFeature([
            EditService,
            DialogsService,
            DomEventsService,
            LocalDataChangesService,
            FocusService,
            SchedulerLocalizationService,
            {
                provide: LocalizationService,
                useExisting: SchedulerLocalizationService
            },
            {
                provide: L10N_PREFIX,
                useValue: 'kendo.scheduler'
            },
            ToolbarService,
            ViewContextService,
            ViewStateService,
            PDFService
        ]), ɵngcc0.ɵɵNgOnChangesFeature], decls: 9, vars: 13, consts: [["kendoSchedulerLocalizedMessages", "", 6, "allEvents", "allDay", "dateHeader", "timeHeader", "deleteTitle", "eventHeader", "nextTitle", "previousTitle", "showFullDay", "showWorkDay", "today", "calendarToday", "dayViewTitle", "multiDayViewTitle", "weekViewTitle", "workWeekViewTitle", "monthViewTitle", "timelineViewTitle", "timelineWeekViewTitle", "timelineMonthViewTitle", "agendaViewTitle", "cancel", "save", "editorEventTitle", "editorEventStart", "editorEventStartTimeZone", "editorEventEnd", "editorEventEndTimeZone", "editorEventAllDay", "editorEventDescription", "editorEventSeparateTimeZones", "editorEventTimeZone", "editorTitle", "recurrenceEditorRepeat", "recurrenceEditorDailyInterval", "recurrenceEditorDailyRepeatEvery", "recurrenceEditorWeeklyInterval", "recurrenceEditorWeeklyRepeatEvery", "recurrenceEditorWeeklyRepeatOn", "recurrenceEditorMonthlyDay", "recurrenceEditorMonthlyInterval", "recurrenceEditorMonthlyRepeatEvery", "recurrenceEditorMonthlyRepeatOn", "recurrenceEditorYearlyOf", "recurrenceEditorYearlyRepeatEvery", "recurrenceEditorYearlyRepeatOn", "recurrenceEditorYearlyInterval", "recurrenceEditorFrequenciesDaily", "recurrenceEditorFrequenciesMonthly", "recurrenceEditorFrequenciesNever", "recurrenceEditorFrequenciesWeekly", "recurrenceEditorFrequenciesYearly", "recurrenceEditorOffsetPositionsFirst", "recurrenceEditorOffsetPositionsSecond", "recurrenceEditorOffsetPositionsThird", "recurrenceEditorOffsetPositionsFourth", "recurrenceEditorOffsetPositionsLast", "recurrenceEditorWeekdaysDay", "recurrenceEditorWeekdaysWeekday", "recurrenceEditorWeekdaysWeekendday", "recurrenceEditorEndAfter", "recurrenceEditorEndOccurrence", "recurrenceEditorEndLabel", "recurrenceEditorEndNever", "recurrenceEditorEndOn", "destroy", "deleteConfirmation", "editRecurringConfirmation", "editOccurrence", "editSeries", "deleteRecurringConfirmation", "deleteOccurrence", "deleteSeries", "deleteDialogTitle", "deleteRecurringDialogTitle", "editRecurringDialogTitle"], [3, "dateRange", "selectedDate", "views", "selectedView", "template", "min", "max", "navigate"], [4, "ngTemplateOutlet"], ["confirmationDialogContainer", ""], [3, "resources", "editTemplate", "timezone", "fields"], [3, "resize"], ["kendoSchedulerLoading", "", 3, "loading"]], template: function SchedulerComponent_Template(rf, ctx) { if (rf & 1) {
        ɵngcc0.ɵɵelementContainerStart(0, 0);
        ɵngcc0.ɵɵi18nAttributes(1, _c154);
        ɵngcc0.ɵɵelementContainerEnd();
        ɵngcc0.ɵɵelementStart(2, "kendo-scheduler-toolbar", 1);
        ɵngcc0.ɵɵlistener("navigate", function SchedulerComponent_Template_kendo_scheduler_toolbar_navigate_2_listener($event) { return ctx.onNavigationAction($event); });
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵtemplate(3, SchedulerComponent_ng_container_3_Template, 1, 0, "ng-container", 2);
        ɵngcc0.ɵɵelementContainer(4, null, 3);
        ɵngcc0.ɵɵelement(6, "kendo-scheduler-edit-dialog", 4);
        ɵngcc0.ɵɵelementStart(7, "kendo-resize-sensor", 5);
        ɵngcc0.ɵɵlistener("resize", function SchedulerComponent_Template_kendo_resize_sensor_resize_7_listener() { return ctx.onResize(); });
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵelement(8, "div", 6);
    } if (rf & 2) {
        ɵngcc0.ɵɵadvance(2);
        ɵngcc0.ɵɵproperty("dateRange", ctx.dateRangeStream)("selectedDate", ctx.selectedDateStream)("views", ctx.views)("selectedView", ctx.selectedView)("template", ctx.toolbarTemplate)("min", ctx.min)("max", ctx.max);
        ɵngcc0.ɵɵadvance(1);
        ɵngcc0.ɵɵproperty("ngTemplateOutlet", ctx.selectedView == null ? null : ctx.selectedView.template);
        ɵngcc0.ɵɵadvance(3);
        ɵngcc0.ɵɵproperty("resources", ctx.resources)("editTemplate", ctx.editDialogTemplate)("timezone", ctx.timezone)("fields", ctx.modelFields);
        ɵngcc0.ɵɵadvance(2);
        ɵngcc0.ɵɵproperty("loading", ctx.loading);
    } }, directives: function () { return [LocalizedMessagesDirective,
        ToolbarComponent, ɵngcc4.NgTemplateOutlet, EditDialogComponent, ɵngcc5.ResizeSensorComponent, LoadingComponent]; }, styles: [".k-scheduler.k-state-focused { box-shadow: 0 0.5px 0.5px 0.5px rgba(0, 0, 0, .12); }"], encapsulation: 2, changeDetection: 0 });
/** @nocollapse */
SchedulerComponent.ctorParameters = () => [
    { type: ElementRef },
    { type: ViewContextService },
    { type: ViewStateService },
    { type: EditService },
    { type: DialogsService },
    { type: IntlService },
    { type: ChangeDetectorRef },
    { type: NgZone },
    { type: PDFService },
    { type: LocalizationService },
    { type: DomEventsService },
    { type: Renderer2 },
    { type: FocusService }
];
SchedulerComponent.propDecorators = {
    hostClasses: [{ type: HostBinding, args: ['class.k-widget',] }, { type: HostBinding, args: ['class.k-scheduler',] }, { type: HostBinding, args: ['class.k-floatwrap',] }],
    rtl: [{ type: HostBinding, args: ['class.k-rtl',] }],
    dir: [{ type: HostBinding, args: ['attr.dir',] }],
    selectedViewIndex: [{ type: Input }],
    editable: [{ type: Input }],
    min: [{ type: Input }],
    max: [{ type: Input }],
    eventHeight: [{ type: Input }],
    columnWidth: [{ type: Input }],
    showWorkHours: [{ type: Input }],
    startTime: [{ type: Input }],
    endTime: [{ type: Input }],
    workDayStart: [{ type: Input }],
    workDayEnd: [{ type: Input }],
    workWeekStart: [{ type: Input }],
    workWeekEnd: [{ type: Input }],
    slotDuration: [{ type: Input }],
    slotDivisions: [{ type: Input }],
    slotFill: [{ type: Input }],
    scrollTime: [{ type: Input }],
    group: [{ type: Input }],
    resources: [{ type: Input }],
    loading: [{ type: Input }],
    timezone: [{ type: Input }],
    events: [{ type: Input }],
    selectedDate: [{ type: Input }],
    modelFields: [{ type: Input }],
    currentTimeMarker: [{ type: Input }],
    slotClass: [{ type: Input }],
    eventClass: [{ type: Input }],
    eventStyles: [{ type: Input }],
    selectedViewIndexChange: [{ type: Output }],
    navigate: [{ type: Output }],
    dateChange: [{ type: Output }],
    slotClick: [{ type: Output }],
    slotDblClick: [{ type: Output }],
    create: [{ type: Output }],
    eventClick: [{ type: Output }],
    eventDblClick: [{ type: Output }],
    eventKeydown: [{ type: Output }],
    cancel: [{ type: Output }],
    save: [{ type: Output }],
    remove: [{ type: Output }],
    resizeStart: [{ type: Output }],
    resize: [{ type: Output }],
    resizeEnd: [{ type: Output }],
    dragStart: [{ type: Output }],
    drag: [{ type: Output }],
    dragEnd: [{ type: Output }],
    pdfExport: [{ type: Output }],
    editDialogTemplate: [{ type: ContentChild, args: [EditDialogTemplateDirective,] }],
    toolbarTemplate: [{ type: ContentChild, args: [ToolbarTemplateDirective,] }],
    views: [{ type: ContentChildren, args: [SchedulerView,] }],
    resizeSensor: [{ type: ViewChild, args: [ResizeSensorComponent,] }],
    confirmationDialogContainerRef: [{ type: ViewChild, args: ["confirmationDialogContainer", { read: ViewContainerRef, static: true },] }],
    loadingComponent: [{ type: ViewChild, args: [LoadingComponent,] }],
    allDayEventTemplate: [{ type: ContentChildren, args: [AllDayEventTemplateDirective,] }],
    eventTemplate: [{ type: ContentChildren, args: [EventTemplateDirective,] }],
    timeSlotTemplate: [{ type: ContentChildren, args: [TimeSlotTemplateDirective,] }],
    minorTimeHeaderTemplate: [{ type: ContentChildren, args: [MinorTimeHeaderTemplateDirective,] }],
    majorTimeHeaderTemplate: [{ type: ContentChildren, args: [MajorTimeHeaderTemplateDirective,] }],
    monthDaySlotTemplate: [{ type: ContentChildren, args: [MonthDaySlotTemplateDirective,] }],
    dateHeaderTemplate: [{ type: ContentChildren, args: [DateHeaderTemplateDirective,] }],
    allDaySlotTemplate: [{ type: ContentChildren, args: [AllDaySlotTemplateDirective,] }],
    groupHeaderTemplate: [{ type: ContentChildren, args: [GroupHeaderTemplateDirective,] }],
    agendaDateTemplate: [{ type: ContentChildren, args: [AgendaDateTemplateDirective,] }],
    agendaTimeTemplate: [{ type: ContentChildren, args: [AgendaTimeTemplateDirective,] }]
};
/*@__PURE__*/ (function () { ɵngcc0.ɵsetClassMetadata(SchedulerComponent, [{
        type: Component,
        args: [{
                changeDetection: ChangeDetectionStrategy.OnPush,
                selector: 'kendo-scheduler',
                providers: [
                    EditService,
                    DialogsService,
                    DomEventsService,
                    LocalDataChangesService,
                    FocusService,
                    SchedulerLocalizationService,
                    {
                        provide: LocalizationService,
                        useExisting: SchedulerLocalizationService
                    },
                    {
                        provide: L10N_PREFIX,
                        useValue: 'kendo.scheduler'
                    },
                    ToolbarService,
                    ViewContextService,
                    ViewStateService,
                    PDFService
                ],
                // TODO: Move to themes
                styles: ['.k-scheduler.k-state-focused { box-shadow: 0 0.5px 0.5px 0.5px rgba(0, 0, 0, .12); }'],
                encapsulation: ViewEncapsulation.None,
                template: `
        <ng-container kendoSchedulerLocalizedMessages
            i18n-allEvents="kendo.scheduler.allEvents|The All events text displayed in the timeline views when there is no vertical grouping."
            allEvents="All events"

            i18n-allDay="kendo.scheduler.allDay|The all day text displayed in the day and week views."
            allDay="all day"

            i18n-dateHeader="kendo.scheduler.dateHeader|The date header text displayed in the agenda view."
            dateHeader="Date"

            i18n-timeHeader="kendo.scheduler.timeHeader|The time header text displayed in the agenda view."
            timeHeader="Time"

            i18n-deleteTitle="kendo.scheduler.deleteTitle|The delete icon title."
            deleteTitle="Delete"

            i18n-eventHeader="kendo.scheduler.eventHeader|The event header text displayed in the agenda view."
            eventHeader="Event"

            i18n-nextTitle="kendo.scheduler.nextTitle|The title of the navigation next button."
            nextTitle="Next"

            i18n-previousTitle="kendo.scheduler.previousTitle|The title of the navigation previous button."
            previousTitle="Previous"

            i18n-showFullDay="kendo.scheduler.showFullDay|The text of the show full day button displayed in the footer of the day, week and timeline views."
            showFullDay="Show full day"

            i18n-showWorkDay="kendo.scheduler.showWorkDay|The text of the show work day button displayed in the footer of the day, week and timeline views."
            showWorkDay="Show business hours"

            i18n-today="kendo.scheduler.today|The today button text displayed in the navigation."
            today="Today"

            i18n-calendarToday="kendo.scheduler.calendarToday|The text of today's date in the header of the Calendar."
            calendarToday="TODAY"

            i18n-dayViewTitle="kendo.scheduler.dayViewTitle|The day view title."
            dayViewTitle="Day"

            i18n-multiDayViewTitle="kendo.scheduler.multiDayViewTitle|The multi day view title."
            multiDayViewTitle="Multi-Day"

            i18n-weekViewTitle="kendo.scheduler.weekViewTitle|The week view title."
            weekViewTitle="Week"

            i18n-workWeekViewTitle="kendo.scheduler.workWeekViewTitle|The work week view title."
            workWeekViewTitle="Work Week"

            i18n-monthViewTitle="kendo.scheduler.monthViewTitle|The month view title."
            monthViewTitle="Month"

            i18n-timelineViewTitle="kendo.scheduler.timelineViewTitle|The timeline view title."
            timelineViewTitle="Timeline"

            i18n-timelineWeekViewTitle="kendo.scheduler.timelineWeekViewTitle|The timeline week view title."
            timelineWeekViewTitle="Timeline Week"

            i18n-timelineMonthViewTitle="kendo.scheduler.timelineMonthViewTitle|The timeline month view title."
            timelineMonthViewTitle="Timeline Month"

            i18n-agendaViewTitle="kendo.scheduler.agendaViewTitle|The agenda view title."
            agendaViewTitle="Agenda"

            i18n-cancel="kendo.scheduler.cancel|The text similar to 'Cancel' displayed in scheduler."
            cancel="Cancel"

            i18n-save="kendo.scheduler.save|The text similar to 'Save' displayed in scheduler."
            save="Save"

            i18n-editorEventTitle="kendo.scheduler.editorEventTitle|The text similar to 'Title' displayed in the scheduler event editor."
            editorEventTitle='Title'

            i18n-editorEventStart="kendo.scheduler.editorEventStart|The text similar to 'Start' displayed in the scheduler event editor."
            editorEventStart="Start"

            i18n-editorEventStartTimeZone="kendo.scheduler.editorEventStartTimeZone|The text similar to 'Start Time Zone' displayed in the scheduler event editor."
            editorEventStartTimeZone="Start Time Zone"

            i18n-editorEventEnd="kendo.scheduler.editorEventEnd|The text similar to 'End' displayed in the scheduler event editor."
            editorEventEnd="End"

            i18n-editorEventEndTimeZone="kendo.scheduler.editorEventEndTimeZone|The text similar to 'End Time Zone' displayed in the scheduler event editor."
            editorEventEndTimeZone="End Time Zone"

            i18n-editorEventAllDay="kendo.scheduler.editorEventAllDay|The text similar to 'All Day event' displayed in the scheduler event editor."
            editorEventAllDay="All Day Event"

            i18n-editorEventDescription="kendo.scheduler.editorEventDescription|The text similar to 'Description' displayed in the scheduler event editor."
            editorEventDescription="Description"

            i18n-editorEventSeparateTimeZones="kendo.scheduler.editorEventSeparateTimeZones|The text similar to 'Use separate Start and End Time Zones' displayed in the scheduler event editor."
            editorEventSeparateTimeZones="End in different Time Zone"

            i18n-editorEventTimeZone="kendo.scheduler.editorEventTimeZone|The text similar to 'Time Zone' displayed in the scheduler event editor."
            editorEventTimeZone='Specify Time Zone'

            i18n-editorTitle="kendo.scheduler.editorTitle|The text similar to 'Event' displayed as title of the scheduler event editor."
            editorTitle='Event'

            i18n-recurrenceEditorRepeat="kendo.scheduler.recurrenceEditorRepeat|The text similar to 'Repeat' displayed in the scheduler recurrence editor."
            recurrenceEditorRepeat='Repeat'

            i18n-recurrenceEditorDailyInterval="kendo.scheduler.recurrenceEditorDailyInterval|The text similar to 'day(s)' displayed in the scheduler recurrence editor."
            recurrenceEditorDailyInterval='day(s)'

            i18n-recurrenceEditorDailyRepeatEvery="kendo.scheduler.recurrenceEditorDailyRepeatEvery|The text similar to 'Repeat every' displayed in the scheduler recurrence editor."
            recurrenceEditorDailyRepeatEvery='Repeat every'

            i18n-recurrenceEditorWeeklyInterval="kendo.scheduler.recurrenceEditorWeeklyInterval|The text similar to 'week(s)' displayed in the scheduler recurrence editor."
            recurrenceEditorWeeklyInterval='week(s)'

            i18n-recurrenceEditorWeeklyRepeatEvery="kendo.scheduler.recurrenceEditorWeeklyRepeatEvery|The text similar to 'Repeat every' displayed in the scheduler recurrence editor."
            recurrenceEditorWeeklyRepeatEvery='Repeat every'

            i18n-recurrenceEditorWeeklyRepeatOn="kendo.scheduler.recurrenceEditorWeeklyRepeatOn|The text similar to 'Repeat on' displayed in the scheduler recurrence editor."
            recurrenceEditorWeeklyRepeatOn='Repeat on'

            i18n-recurrenceEditorMonthlyDay="kendo.scheduler.recurrenceEditorMonthlyDay|The text similar to 'Day' displayed in the scheduler recurrence editor."
            recurrenceEditorMonthlyDay='Day'

            i18n-recurrenceEditorMonthlyInterval="kendo.scheduler.recurrenceEditorMonthlyInterval|The text similar to 'month(s)' displayed in the scheduler recurrence editor."
            recurrenceEditorMonthlyInterval='month(s)'

            i18n-recurrenceEditorMonthlyRepeatEvery="kendo.scheduler.recurrenceEditorMonthlyRepeatEvery|The text similar to 'Repeat every' displayed in the scheduler recurrence editor."
            recurrenceEditorMonthlyRepeatEvery='Repeat every'

            i18n-recurrenceEditorMonthlyRepeatOn="kendo.scheduler.recurrenceEditorMonthlyRepeatOn|The text similar to 'Repeat on' displayed in the scheduler recurrence editor."
            recurrenceEditorMonthlyRepeatOn='Repeat on'

            i18n-recurrenceEditorYearlyOf="kendo.scheduler.recurrenceEditorYearlyOf|The text similar to 'of' displayed in the scheduler recurrence editor."
            recurrenceEditorYearlyOf='of'

            i18n-recurrenceEditorYearlyRepeatEvery="kendo.scheduler.recurrenceEditorYearlyRepeatEvery|The text similar to 'Repeat every' displayed in the scheduler recurrence editor."
            recurrenceEditorYearlyRepeatEvery='Repeat every'

            i18n-recurrenceEditorYearlyRepeatOn="kendo.scheduler.recurrenceEditorYearlyRepeatOn|The text similar to 'Repeat on' displayed in the scheduler recurrence editor."
            recurrenceEditorYearlyRepeatOn='Repeat on'

            i18n-recurrenceEditorYearlyInterval="kendo.scheduler.recurrenceEditorYearlyInterval|The text similar to 'year(s)' displayed in the scheduler recurrence editor."
            recurrenceEditorYearlyInterval='year(s)'

            i18n-recurrenceEditorFrequenciesDaily="kendo.scheduler.recurrenceEditorFrequenciesDaily|The text similar to 'Daily' displayed in the scheduler recurrence editor."
            recurrenceEditorFrequenciesDaily='Daily'

            i18n-recurrenceEditorFrequenciesMonthly="kendo.scheduler.recurrenceEditorFrequenciesMonthly|The text similar to 'Monthly' displayed in the scheduler recurrence editor."
            recurrenceEditorFrequenciesMonthly='Monthly'

            i18n-recurrenceEditorFrequenciesNever="kendo.scheduler.recurrenceEditorFrequenciesNever|The text similar to 'Never' displayed in the scheduler recurrence editor."
            recurrenceEditorFrequenciesNever='Never'

            i18n-recurrenceEditorFrequenciesWeekly="kendo.scheduler.recurrenceEditorFrequenciesWeekly|The text similar to 'Weekly' displayed in the scheduler recurrence editor."
            recurrenceEditorFrequenciesWeekly='Weekly'

            i18n-recurrenceEditorFrequenciesYearly="kendo.scheduler.recurrenceEditorFrequenciesYearly|The text similar to 'Yearly' displayed in the scheduler recurrence editor."
            recurrenceEditorFrequenciesYearly='Yearly'

            i18n-recurrenceEditorOffsetPositionsFirst="kendo.scheduler.recurrenceEditorOffsetPositionsFirst|The text similar to 'First' displayed in the scheduler recurrence editor."
            recurrenceEditorOffsetPositionsFirst='First'

            i18n-recurrenceEditorOffsetPositionsSecond="kendo.scheduler.recurrenceEditorOffsetPositionsSecond|The text similar to 'Second' displayed in the scheduler recurrence editor."
            recurrenceEditorOffsetPositionsSecond='Second'

            i18n-recurrenceEditorOffsetPositionsThird="kendo.scheduler.recurrenceEditorOffsetPositionsThird|The text similar to 'Third' displayed in the scheduler recurrence editor."
            recurrenceEditorOffsetPositionsThird='Third'

            i18n-recurrenceEditorOffsetPositionsFourth="kendo.scheduler.recurrenceEditorOffsetPositionsFourth|The text similar to 'Fourth' displayed in the scheduler recurrence editor."
            recurrenceEditorOffsetPositionsFourth='Fourth'

            i18n-recurrenceEditorOffsetPositionsLast="kendo.scheduler.recurrenceEditorOffsetPositionsLast|The text similar to 'Last' displayed in the scheduler recurrence editor."
            recurrenceEditorOffsetPositionsLast='Last'

            i18n-recurrenceEditorWeekdaysDay="kendo.scheduler.recurrenceEditorWeekdaysDay|The text similar to 'Day' displayed in the repeat by section of the monthly recurrence pattern."
            recurrenceEditorWeekdaysDay='Day'

            i18n-recurrenceEditorWeekdaysWeekday="kendo.scheduler.recurrenceEditorWeekdaysWeekday|The text similar to 'Weekday' displayed in the repeat by section of the monthly recurrence pattern."
            recurrenceEditorWeekdaysWeekday='Weekday'

            i18n-recurrenceEditorWeekdaysWeekendday="kendo.scheduler.recurrenceEditorWeekdaysWeekendday|The text similar to 'Weekend Day' displayed in the repeat by section of the monthly recurrence pattern."
            recurrenceEditorWeekdaysWeekendday='Weekend Day'

            i18n-recurrenceEditorEndAfter="kendo.scheduler.recurrenceEditorEndAfter|The text similar to 'After' displayed in the scheduler recurrence editor."
            recurrenceEditorEndAfter='After'

            i18n-recurrenceEditorEndOccurrence="kendo.scheduler.recurrenceEditorEndOccurrence|The text similar to 'occurrence(s)' displayed in the scheduler recurrence editor."
            recurrenceEditorEndOccurrence='occurrence(s)'

            i18n-recurrenceEditorEndLabel="kendo.scheduler.recurrenceEditorEndLabel|The text similar to 'End' displayed in the scheduler recurrence editor."
            recurrenceEditorEndLabel='End'

            i18n-recurrenceEditorEndNever="kendo.scheduler.recurrenceEditorEndNever|The text similar to 'Never' displayed in the scheduler recurrence editor."
            recurrenceEditorEndNever='Never'

            i18n-recurrenceEditorEndOn="kendo.scheduler.recurrenceEditorEndOn|The text similar to 'On' displayed in the scheduler recurrence editor."
            recurrenceEditorEndOn='On'

            i18n-destroy="kendo.scheduler.destroy|The text of the 'Delete' button displayed in the scheduler remove confirmation dialog."
            destroy='Delete'

            i18n-deleteConfirmation="kendo.scheduler.deleteConfirmation|The text similar to 'Are you sure you want to delete this event?' displayed in scheduler remove confirmation dialog."
            deleteConfirmation='Are you sure you want to delete this event?'

            i18n-editRecurringConfirmation="kendo.scheduler.editRecurringConfirmation|The text similar to 'Do you want to edit only this event occurrence or the whole series?' displayed in the scheduler recurring confirmation dialog."
            editRecurringConfirmation='Do you want to edit only this event occurrence or the whole series?'

            i18n-editOccurrence="kendo.scheduler.editOccurrence|The text of the 'Edit current occurrence' button displayed in the scheduler recurring confirmation dialog."
            editOccurrence='Edit current occurrence'

            i18n-editSeries="kendo.scheduler.editSeries|The text of the 'Edit the series' button displayed in the scheduler recurring confirmation dialog."
            editSeries='Edit the series'

            i18n-deleteRecurringConfirmation="kendo.scheduler.deleteRecurringConfirmation|The text similar to 'Do you want to delete only this event occurrence or the whole series?' displayed in the scheduler recurring confirmation dialog."
            deleteRecurringConfirmation='Do you want to delete only this event occurrence or the whole series?'

            i18n-deleteOccurrence="kendo.scheduler.deleteOccurrence|The text of the 'Delete current occurrence' button displayed in the scheduler recurring confirmation dialog."
            deleteOccurrence='Delete current occurrence'

            i18n-deleteSeries="kendo.scheduler.deleteSeries|The text similar of the 'Delete the series' button displayed in the scheduler recurring confirmation dialog."
            deleteSeries='Delete the series'

            i18n-deleteDialogTitle="kendo.scheduler.deleteDialogTitle|The title of the remove confirmation dialog, similar to 'Delete Event'."
            deleteDialogTitle='Delete Event'

            i18n-deleteRecurringDialogTitle="kendo.scheduler.deleteRecurringDialogTitle|The title of the recurring remove confirmation dialog, similar to 'Delete Recurring Item'"
            deleteRecurringDialogTitle='Delete Recurring Item'

            i18n-editRecurringDialogTitle="kendo.scheduler.editRecurringDialogTitle|The title of the recurring edit confirmation dialog, similar to 'Edit Recurring Item'"
            editRecurringDialogTitle='Edit Recurring Item'
        >
        </ng-container>

        <kendo-scheduler-toolbar
            [dateRange]="dateRangeStream"
            [selectedDate]="selectedDateStream"
            [views]="views"
            [selectedView]="selectedView"
            [template]="toolbarTemplate"
            (navigate)="onNavigationAction($event)"
            [min]="min"
            [max]="max"
        ></kendo-scheduler-toolbar>

        <ng-container *ngTemplateOutlet="selectedView?.template">
        </ng-container>

        <ng-container #confirmationDialogContainer>
        </ng-container>

        <kendo-scheduler-edit-dialog
            [resources]="resources"
            [editTemplate]="editDialogTemplate"
            [timezone]="timezone"
            [fields]="modelFields"
        ></kendo-scheduler-edit-dialog>

        <kendo-resize-sensor (resize)="onResize()"></kendo-resize-sensor>

        <div [loading]="loading" kendoSchedulerLoading>
        </div>
    `
            }]
    }], function () { return [{ type: ɵngcc0.ElementRef }, { type: ViewContextService }, { type: ViewStateService }, { type: EditService }, { type: DialogsService }, { type: ɵngcc3.IntlService }, { type: ɵngcc0.ChangeDetectorRef }, { type: ɵngcc0.NgZone }, { type: PDFService }, { type: ɵngcc2.LocalizationService }, { type: DomEventsService }, { type: ɵngcc0.Renderer2 }, { type: FocusService }]; }, { hostClasses: [{
            type: HostBinding,
            args: ['class.k-widget']
        }, {
            type: HostBinding,
            args: ['class.k-scheduler']
        }, {
            type: HostBinding,
            args: ['class.k-floatwrap']
        }], rtl: [{
            type: HostBinding,
            args: ['class.k-rtl']
        }], editable: [{
            type: Input
        }], eventHeight: [{
            type: Input
        }], columnWidth: [{
            type: Input
        }], startTime: [{
            type: Input
        }], endTime: [{
            type: Input
        }], workDayStart: [{
            type: Input
        }], workDayEnd: [{
            type: Input
        }], slotDuration: [{
            type: Input
        }], slotDivisions: [{
            type: Input
        }], slotFill: [{
            type: Input
        }], scrollTime: [{
            type: Input
        }], currentTimeMarker: [{
            type: Input
        }], selectedViewIndexChange: [{
            type: Output
        }], navigate: [{
            type: Output
        }], dateChange: [{
            type: Output
        }], slotClick: [{
            type: Output
        }], slotDblClick: [{
            type: Output
        }], create: [{
            type: Output
        }], eventClick: [{
            type: Output
        }], eventDblClick: [{
            type: Output
        }], eventKeydown: [{
            type: Output
        }], cancel: [{
            type: Output
        }], save: [{
            type: Output
        }], remove: [{
            type: Output
        }], resizeStart: [{
            type: Output
        }], resize: [{
            type: Output
        }], resizeEnd: [{
            type: Output
        }], dragStart: [{
            type: Output
        }], drag: [{
            type: Output
        }], dragEnd: [{
            type: Output
        }], pdfExport: [{
            type: Output
        }], dir: [{
            type: HostBinding,
            args: ['attr.dir']
        }], selectedViewIndex: [{
            type: Input
        }], timezone: [{
            type: Input
        }], events: [{
            type: Input
        }], selectedDate: [{
            type: Input
        }], modelFields: [{
            type: Input
        }], min: [{
            type: Input
        }], max: [{
            type: Input
        }], showWorkHours: [{
            type: Input
        }], workWeekStart: [{
            type: Input
        }], workWeekEnd: [{
            type: Input
        }], group: [{
            type: Input
        }], resources: [{
            type: Input
        }], loading: [{
            type: Input
        }], slotClass: [{
            type: Input
        }], eventClass: [{
            type: Input
        }], eventStyles: [{
            type: Input
        }], editDialogTemplate: [{
            type: ContentChild,
            args: [EditDialogTemplateDirective]
        }], toolbarTemplate: [{
            type: ContentChild,
            args: [ToolbarTemplateDirective]
        }], views: [{
            type: ContentChildren,
            args: [SchedulerView]
        }], resizeSensor: [{
            type: ViewChild,
            args: [ResizeSensorComponent]
        }], confirmationDialogContainerRef: [{
            type: ViewChild,
            args: ["confirmationDialogContainer", { read: ViewContainerRef, static: true }]
        }], loadingComponent: [{
            type: ViewChild,
            args: [LoadingComponent]
        }], allDayEventTemplate: [{
            type: ContentChildren,
            args: [AllDayEventTemplateDirective]
        }], eventTemplate: [{
            type: ContentChildren,
            args: [EventTemplateDirective]
        }], timeSlotTemplate: [{
            type: ContentChildren,
            args: [TimeSlotTemplateDirective]
        }], minorTimeHeaderTemplate: [{
            type: ContentChildren,
            args: [MinorTimeHeaderTemplateDirective]
        }], majorTimeHeaderTemplate: [{
            type: ContentChildren,
            args: [MajorTimeHeaderTemplateDirective]
        }], monthDaySlotTemplate: [{
            type: ContentChildren,
            args: [MonthDaySlotTemplateDirective]
        }], dateHeaderTemplate: [{
            type: ContentChildren,
            args: [DateHeaderTemplateDirective]
        }], allDaySlotTemplate: [{
            type: ContentChildren,
            args: [AllDaySlotTemplateDirective]
        }], groupHeaderTemplate: [{
            type: ContentChildren,
            args: [GroupHeaderTemplateDirective]
        }], agendaDateTemplate: [{
            type: ContentChildren,
            args: [AgendaDateTemplateDirective]
        }], agendaTimeTemplate: [{
            type: ContentChildren,
            args: [AgendaTimeTemplateDirective]
        }] }); })();

/** @hidden */
const intersects = (startTime, endTime, periodStart, periodEnd) => (startTime < periodStart && endTime > periodEnd) ||
    (periodStart <= startTime && startTime < periodEnd) ||
    (periodStart < endTime && endTime <= periodEnd && startTime < endTime);
/** @hidden */
const dateInRange = (date, start, end) => start.getTime() <= date.getTime() && date.getTime() <= end.getTime();
/** @hidden */
const roundAllDayEnd = ({ start, end }) => {
    const startDate = start.stripTime();
    const endDate = end.stripTime();
    return endDate.getTime() !== end.getTime() || startDate.getTime() === endDate.getTime() ? endDate.addDays(1) : endDate;
};
/** @hidden */
function toInvariantTime(date) {
    var staticDate = new Date(1980, 0, 1, 0, 0, 0);
    if (date) {
        staticDate.setHours(date.getHours(), date.getMinutes(), date.getSeconds(), date.getMilliseconds());
    }
    return staticDate;
}
/**
 * @hidden
 * TODO Move to date-math
 */
const addUTCDays = (date, offset) => {
    const newDate = new Date(date.getTime());
    newDate.setUTCDate(newDate.getUTCDate() + offset);
    return newDate;
};
// TODO: name? move to date-math
/** @hidden */
function toUTCTime(localDate, localTime) {
    return new Date(Date.UTC(localDate.getFullYear(), localDate.getMonth(), localDate.getDate(), localTime.getHours(), localTime.getMinutes(), localTime.getSeconds(), localTime.getMilliseconds()));
}
//  TODO: move to date-math
/** @hidden */
function toUTCDate(localDate) {
    return new Date(Date.UTC(localDate.getFullYear(), localDate.getMonth(), localDate.getDate()));
}
// TODO: move to date-math
/** @hidden */
function getUTCDate(utcDate) {
    return new Date(Date.UTC(utcDate.getUTCFullYear(), utcDate.getUTCMonth(), utcDate.getUTCDate()));
}
// TODO: move to date-math
/** @hidden */
function toUTCDateTime(localDate) {
    return new Date(Date.UTC(localDate.getFullYear(), localDate.getMonth(), localDate.getDate(), localDate.getHours(), localDate.getMinutes(), localDate.getSeconds(), localDate.getMilliseconds()));
}
/** @hidden */
function dateWithTime(target, time) {
    return new Date(target.getFullYear(), target.getMonth(), target.getDate(), time.getHours(), time.getMinutes());
}
function getDataIdx(value, resource) {
    const data = resource.data;
    for (let dataIdx = 0; dataIdx < data.length; dataIdx++) {
        if (getField(data[dataIdx], resource.valueField) === value) {
            return dataIdx;
        }
    }
    return -1;
}
function resourceItem(value, resource) {
    const index = getDataIdx(value, resource);
    return index >= 0 ? resource.data[index] : {};
}
function resourceItems(values, resource) {
    return values.map(value => resourceItem(value, resource));
}
function cloneResources(arr) {
    const result = [];
    for (let idx = 0; idx < arr.length; idx++) {
        const clone$$1 = Object.assign({}, arr[idx]);
        clone$$1.resources = clone$$1.resources.slice(0);
        result.push(clone$$1);
    }
    return result;
}
/** @hidden */
function resourceItemByValue(event, resource) {
    const value = getField(event, resource.field);
    if (Array.isArray(value)) {
        return resourceItems(value, resource);
    }
    return resourceItem(value, resource);
}
function addNotGroupedResources(event, resources, allResources) {
    for (let resourceIdx = 0; resourceIdx < resources.length; resourceIdx++) {
        const current = resources[resourceIdx];
        for (let idx = 0; idx < allResources.length; idx++) {
            const item = allResources[idx];
            if (!current.resources[idx] && item.data) {
                current.resources[idx] = resourceItemByValue(event, item);
            }
        }
    }
}
/** @hidden */
function eventResources(event, { taskResources, hasGroups, spans, allResources = [] }) {
    let resources = [];
    for (let resourceIdx = 0; resourceIdx < taskResources.length; resourceIdx++) {
        const resource = taskResources[resourceIdx];
        if (!resource.data) {
            resources = [{ leafIdx: 0, resources: [] }];
            continue;
        }
        const resourceIndex = allResources.indexOf(resource);
        let values = getField(event, resource.field);
        if (!Array.isArray(values)) {
            values = [values];
        }
        const expandedResources = [];
        for (let valueIdx = 0; valueIdx < values.length; valueIdx++) {
            const dataIdx = getDataIdx(values[valueIdx], resource);
            if (dataIdx < 0) {
                return [{ leafIdx: hasGroups ? -1 : 0, resources: [] }];
            }
            const item = resource.data[dataIdx];
            // has groups - need all copies of the multiple resource
            // no groups - just the first
            if (resourceIdx === 0 && (hasGroups || valueIdx === 0)) {
                const resourceItems = [];
                resourceItems[resourceIndex] = resource.multiple && !hasGroups ? [item] : item;
                resources.push({
                    leafIdx: hasGroups ? dataIdx * spans[resourceIdx] : 0,
                    color: getField(item, resource.colorField),
                    resources: resourceItems
                });
            }
            else if (hasGroups) { // don't create multiple resource groups if no groups for multiple resources
                let currentResources = resources;
                if (values.length > 1) {
                    currentResources = cloneResources(resources);
                    expandedResources.push.apply(expandedResources, currentResources);
                }
                for (let currentIdx = 0; currentIdx < currentResources.length; currentIdx++) {
                    currentResources[currentIdx].leafIdx += dataIdx * spans[resourceIdx];
                    currentResources[currentIdx].resources[resourceIndex] = item;
                }
            }
            else if (valueIdx > 0) {
                for (let idx = 0; idx < resources.length; idx++) {
                    resources[idx].resources[resourceIndex].push(item);
                }
            }
        }
        if (expandedResources.length) {
            resources = expandedResources;
        }
    }
    addNotGroupedResources(event, resources, allResources);
    return resources;
}
/** @hidden */
function assignTasksResources(tasks, options) {
    for (let idx = 0; idx < tasks.length; idx++) {
        const task = tasks[idx];
        task.resources = eventResources(task.event, options);
    }
}
/** @hidden */
function findRowIndex(events, data) {
    if (data.rowIndex !== undefined) {
        return data.rowIndex;
    }
    for (let idx = 0; idx < events.length; idx++) {
        if (!events[idx]) {
            return idx;
        }
    }
    return events.length;
}
/** @hidden */
function isRecurrence(task) {
    return Boolean(task.event && task.event.recurrenceRule);
}
/** @hidden */
function isRecurrenceException(task) {
    return task.event && isPresent(task.event.recurrenceId) && !task.event.recurrenceRule;
}
/** @hidden */
const rectContains = (rect, left, top) => rect.left <= left && left <= rect.left + rect.width && rect.top <= top && top <= rect.top + rect.height;
/** @hidden */
const rectContainsX = (rect, left) => rect.left <= left && left <= rect.left + rect.width;
/** @hidden */
const toPx = value => `${value}px`;
/** @hidden */
const elementOffset = (element) => {
    if (!element) {
        return null;
    }
    const box = element.getBoundingClientRect();
    const documentElement = document.documentElement;
    return {
        top: box.top + (window.pageYOffset || documentElement.scrollTop) - (documentElement.clientTop || 0),
        left: box.left + (window.pageXOffset || documentElement.scrollLeft) - (documentElement.clientLeft || 0),
        width: box.width,
        height: box.height
    };
};
/** @hidden */
const pointDistance = (x1, y1, x2, y2) => Math.sqrt(Math.pow(x1 - x2, 2) + Math.pow(y1 - y2, 2));
/** @hidden */
const ignoreContentChild = child => child.nodeName === 'KENDO-RESIZE-SENSOR' || hasClasses(child, 'k-loading-mask');
/** @hidden */
const setCoordinates = (element, coordinates) => {
    for (let field in coordinates) {
        if (coordinates.hasOwnProperty(field)) {
            element.style[field] = toPx(coordinates[field]);
        }
    }
};
/** @hidden */
const convertNgClassBindings = (bindingValues) => {
    const result = [];
    if (isString(bindingValues)) {
        result.push(bindingValues);
    }
    else if (isArray(bindingValues)) {
        result.push.apply(result, bindingValues);
    }
    else if (isObject(bindingValues)) {
        for (let field in bindingValues) {
            if (bindingValues.hasOwnProperty(field) && bindingValues[field]) {
                result.push(field);
            }
        }
    }
    return result;
};
/**
 * @hidden
 */
function formatEventTime(start, end, isAllDay, localeId) {
    const startTimeFormat = { skeleton: 'yMMMMEEEEdhm' };
    const startDateFormat = { skeleton: 'yMMMMEEEEd' };
    const endFormat = isEqualDate(start, end) ? 't' : startTimeFormat;
    return isAllDay ?
        `${formatDate(start, startDateFormat, localeId)}` :
        `${formatDate(start, startTimeFormat, localeId)}–${formatDate(end, endFormat, localeId)}`;
}
/**
 * @hidden
 */
function formValueOrDefault(group, field, defaultValue) {
    const control = group.get(field);
    if (!control) {
        return defaultValue;
    }
    return control.value || defaultValue;
}
/**
 * @hidden
 */
const isWorkWeekDay = (day, start, end) => {
    if (end < start) {
        return day <= end || start <= day;
    }
    return start <= day && day <= end;
};

// TODO
// Extract as public method
const occurrences = (item, fields, range, timezone, weekStart) => {
    const rrule = parseRule({
        recurrenceRule: getField(item, fields.recurrenceRule),
        weekStart: weekStart
    });
    if (!rrule.start) {
        const start = getField(item, fields.start);
        rrule.start = ZonedDate.fromLocalDate(start, timezone);
    }
    if (!rrule.end) {
        const end = getField(item, fields.end);
        rrule.end = ZonedDate.fromLocalDate(end, timezone);
    }
    const exceptions = getField(item, fields.recurrenceExceptions);
    if (exceptions) {
        rrule.exceptionDates = exceptions
            .map(exDate => ZonedDate.fromLocalDate(exDate, timezone));
        // TODO: Merge exceptions from recurrence rule with event.recurrenceException
    }
    const utcRangeStart = toUTCDateTime(range.start);
    const utcRangeEnd = toUTCDateTime(range.end);
    const series = expand(rrule, {
        rangeStart: ZonedDate.fromUTCDate(utcRangeStart, timezone),
        rangeEnd: ZonedDate.fromUTCDate(utcRangeEnd, timezone)
    });
    if (!series.events.length) {
        return [];
    }
    const expanded = series.events.map(occ => {
        const event = clone(item);
        setField(event, fields.id, OCCURRENCE_ID);
        setField(event, fields.recurrenceId, getField(item, fields.id));
        setField(event, fields.start, occ.start.toLocalDate());
        setField(event, fields.end, occ.end.toLocalDate());
        return event;
    });
    return [item, ...expanded];
};
/**
 * A directive that processes Scheduler events in-memory.
 *
 * Processing includes the expanding of recurring events and the filtering of data for
 * the currently active period.
 *
 * {% meta height:650 %}
 * {% embed_file basic-usage/app.component.ts preview %}
 * {% embed_file shared/app.module.ts %}
 * {% embed_file shared/main.ts %}
 * {% embed_file shared/events-utc.ts %}
 * {% endmeta %}
 */
class DataBindingDirective {
    constructor(scheduler, changeDetector, intl, localDataChangesService) {
        this.scheduler = scheduler;
        this.changeDetector = changeDetector;
        this.intl = intl;
        this.localDataChangesService = localDataChangesService;
        this.originalData = [];
        if (localDataChangesService) {
            this.dataChangedSubscription = this.localDataChangesService.changes.subscribe(this.rebind.bind(this));
        }
    }
    /**
     * The array of data which will populate the Scheduler.
     */
    set data(value) {
        this.originalData = value || [];
        if (this.localDataChangesService) {
            this.localDataChangesService.data = value;
        }
        this.scheduler.events = this.process();
    }
    /**
     * @hidden
     */
    ngOnInit() {
        this.subscription = this.scheduler
            .dateChange
            .subscribe(e => this.onDateChange(e));
    }
    /**
     * @hidden
     */
    ngOnDestroy() {
        if (this.subscription) {
            this.subscription.unsubscribe();
        }
        if (this.dataChangedSubscription) {
            this.dataChangedSubscription.unsubscribe();
        }
    }
    /**
     * @hidden
     */
    rebind() {
        this.data = this.originalData;
        this.changeDetector.markForCheck();
    }
    process() {
        if (!this.dateRange) {
            // No processing until a date range is set
            return [];
        }
        const data = [];
        const fields = this.scheduler.modelFields;
        this.originalData
            .forEach(item => {
            if (getField(item, fields.recurrenceRule)) {
                const series = occurrences(item, fields, this.dateRange, this.scheduler.timezone, this.intl.firstDay());
                data.push(...series);
            }
            else {
                data.push(item);
            }
        });
        return data;
    }
    onDateChange(e) {
        this.dateRange = e.dateRange;
        this.rebind();
    }
}
DataBindingDirective.ɵfac = function DataBindingDirective_Factory(t) { return new (t || DataBindingDirective)(ɵngcc0.ɵɵdirectiveInject(SchedulerComponent), ɵngcc0.ɵɵdirectiveInject(ɵngcc0.ChangeDetectorRef), ɵngcc0.ɵɵdirectiveInject(ɵngcc3.IntlService), ɵngcc0.ɵɵdirectiveInject(LocalDataChangesService)); };
DataBindingDirective.ɵdir = ɵngcc0.ɵɵdefineDirective({ type: DataBindingDirective, selectors: [["", "kendoSchedulerBinding", ""]], inputs: { data: ["kendoSchedulerBinding", "data"] } });
/** @nocollapse */
DataBindingDirective.ctorParameters = () => [
    { type: SchedulerComponent },
    { type: ChangeDetectorRef },
    { type: IntlService },
    { type: LocalDataChangesService }
];
DataBindingDirective.propDecorators = {
    data: [{ type: Input, args: ['kendoSchedulerBinding',] }]
};
/*@__PURE__*/ (function () { ɵngcc0.ɵsetClassMetadata(DataBindingDirective, [{
        type: Directive,
        args: [{
                selector: '[kendoSchedulerBinding]'
            }]
    }], function () { return [{ type: SchedulerComponent }, { type: ɵngcc0.ChangeDetectorRef }, { type: ɵngcc3.IntlService }, { type: LocalDataChangesService }]; }, { data: [{
            type: Input,
            args: ['kendoSchedulerBinding']
        }] }); })();

/**
 * @hidden
 */
class Messages extends ComponentMessages {
}
Messages.ɵfac = function Messages_Factory(t) { return ɵMessages_BaseFactory(t || Messages); };
Messages.ɵdir = ɵngcc0.ɵɵdefineDirective({ type: Messages, inputs: { allEvents: "allEvents", allDay: "allDay", dateHeader: "dateHeader", timeHeader: "timeHeader", eventHeader: "eventHeader", deleteTitle: "deleteTitle", nextTitle: "nextTitle", previousTitle: "previousTitle", today: "today", calendarToday: "calendarToday", showFullDay: "showFullDay", showWorkDay: "showWorkDay", dayViewTitle: "dayViewTitle", multiDayViewTitle: "multiDayViewTitle", weekViewTitle: "weekViewTitle", workWeekViewTitle: "workWeekViewTitle", monthViewTitle: "monthViewTitle", timelineViewTitle: "timelineViewTitle", timelineWeekViewTitle: "timelineWeekViewTitle", timelineMonthViewTitle: "timelineMonthViewTitle", agendaViewTitle: "agendaViewTitle", cancel: "cancel", save: "save", editorEventTitle: "editorEventTitle", editorEventStart: "editorEventStart", editorEventStartTimeZone: "editorEventStartTimeZone", editorEventEnd: "editorEventEnd", editorEventEndTimeZone: "editorEventEndTimeZone", editorEventAllDay: "editorEventAllDay", editorEventDescription: "editorEventDescription", editorEventSeparateTimeZones: "editorEventSeparateTimeZones", editorEventTimeZone: "editorEventTimeZone", recurrenceEditorRepeat: "recurrenceEditorRepeat", recurrenceEditorDailyInterval: "recurrenceEditorDailyInterval", recurrenceEditorDailyRepeatEvery: "recurrenceEditorDailyRepeatEvery", recurrenceEditorWeeklyInterval: "recurrenceEditorWeeklyInterval", recurrenceEditorWeeklyRepeatEvery: "recurrenceEditorWeeklyRepeatEvery", recurrenceEditorWeeklyRepeatOn: "recurrenceEditorWeeklyRepeatOn", recurrenceEditorMonthlyDay: "recurrenceEditorMonthlyDay", recurrenceEditorMonthlyInterval: "recurrenceEditorMonthlyInterval", recurrenceEditorMonthlyRepeatEvery: "recurrenceEditorMonthlyRepeatEvery", recurrenceEditorMonthlyRepeatOn: "recurrenceEditorMonthlyRepeatOn", recurrenceEditorYearlyOf: "recurrenceEditorYearlyOf", recurrenceEditorYearlyRepeatEvery: "recurrenceEditorYearlyRepeatEvery", recurrenceEditorYearlyRepeatOn: "recurrenceEditorYearlyRepeatOn", recurrenceEditorYearlyInterval: "recurrenceEditorYearlyInterval", recurrenceEditorFrequenciesDaily: "recurrenceEditorFrequenciesDaily", recurrenceEditorFrequenciesMonthly: "recurrenceEditorFrequenciesMonthly", recurrenceEditorFrequenciesNever: "recurrenceEditorFrequenciesNever", recurrenceEditorFrequenciesWeekly: "recurrenceEditorFrequenciesWeekly", recurrenceEditorFrequenciesYearly: "recurrenceEditorFrequenciesYearly", recurrenceEditorOffsetPositionsFirst: "recurrenceEditorOffsetPositionsFirst", recurrenceEditorOffsetPositionsSecond: "recurrenceEditorOffsetPositionsSecond", recurrenceEditorOffsetPositionsThird: "recurrenceEditorOffsetPositionsThird", recurrenceEditorOffsetPositionsFourth: "recurrenceEditorOffsetPositionsFourth", recurrenceEditorOffsetPositionsLast: "recurrenceEditorOffsetPositionsLast", recurrenceEditorWeekdaysDay: "recurrenceEditorWeekdaysDay", recurrenceEditorWeekdaysWeekday: "recurrenceEditorWeekdaysWeekday", recurrenceEditorWeekdaysWeekendday: "recurrenceEditorWeekdaysWeekendday", recurrenceEditorEndAfter: "recurrenceEditorEndAfter", recurrenceEditorEndOccurrence: "recurrenceEditorEndOccurrence", recurrenceEditorEndLabel: "recurrenceEditorEndLabel", recurrenceEditorEndNever: "recurrenceEditorEndNever", recurrenceEditorEndOn: "recurrenceEditorEndOn", editorTitle: "editorTitle", destroy: "destroy", deleteConfirmation: "deleteConfirmation", editRecurringConfirmation: "editRecurringConfirmation", editOccurrence: "editOccurrence", editSeries: "editSeries", deleteRecurringConfirmation: "deleteRecurringConfirmation", deleteOccurrence: "deleteOccurrence", deleteSeries: "deleteSeries", deleteDialogTitle: "deleteDialogTitle", deleteRecurringDialogTitle: "deleteRecurringDialogTitle", editRecurringDialogTitle: "editRecurringDialogTitle" }, features: [ɵngcc0.ɵɵInheritDefinitionFeature] });
Messages.propDecorators = {
    allEvents: [{ type: Input }],
    allDay: [{ type: Input }],
    dateHeader: [{ type: Input }],
    timeHeader: [{ type: Input }],
    eventHeader: [{ type: Input }],
    deleteTitle: [{ type: Input }],
    nextTitle: [{ type: Input }],
    previousTitle: [{ type: Input }],
    today: [{ type: Input }],
    calendarToday: [{ type: Input }],
    showFullDay: [{ type: Input }],
    showWorkDay: [{ type: Input }],
    dayViewTitle: [{ type: Input }],
    multiDayViewTitle: [{ type: Input }],
    weekViewTitle: [{ type: Input }],
    workWeekViewTitle: [{ type: Input }],
    monthViewTitle: [{ type: Input }],
    timelineViewTitle: [{ type: Input }],
    timelineWeekViewTitle: [{ type: Input }],
    timelineMonthViewTitle: [{ type: Input }],
    agendaViewTitle: [{ type: Input }],
    cancel: [{ type: Input }],
    save: [{ type: Input }],
    editorEventTitle: [{ type: Input }],
    editorEventStart: [{ type: Input }],
    editorEventStartTimeZone: [{ type: Input }],
    editorEventEnd: [{ type: Input }],
    editorEventEndTimeZone: [{ type: Input }],
    editorEventAllDay: [{ type: Input }],
    editorEventDescription: [{ type: Input }],
    editorEventSeparateTimeZones: [{ type: Input }],
    editorEventTimeZone: [{ type: Input }],
    recurrenceEditorRepeat: [{ type: Input }],
    recurrenceEditorDailyInterval: [{ type: Input }],
    recurrenceEditorDailyRepeatEvery: [{ type: Input }],
    recurrenceEditorWeeklyInterval: [{ type: Input }],
    recurrenceEditorWeeklyRepeatEvery: [{ type: Input }],
    recurrenceEditorWeeklyRepeatOn: [{ type: Input }],
    recurrenceEditorMonthlyDay: [{ type: Input }],
    recurrenceEditorMonthlyInterval: [{ type: Input }],
    recurrenceEditorMonthlyRepeatEvery: [{ type: Input }],
    recurrenceEditorMonthlyRepeatOn: [{ type: Input }],
    recurrenceEditorYearlyOf: [{ type: Input }],
    recurrenceEditorYearlyRepeatEvery: [{ type: Input }],
    recurrenceEditorYearlyRepeatOn: [{ type: Input }],
    recurrenceEditorYearlyInterval: [{ type: Input }],
    recurrenceEditorFrequenciesDaily: [{ type: Input }],
    recurrenceEditorFrequenciesMonthly: [{ type: Input }],
    recurrenceEditorFrequenciesNever: [{ type: Input }],
    recurrenceEditorFrequenciesWeekly: [{ type: Input }],
    recurrenceEditorFrequenciesYearly: [{ type: Input }],
    recurrenceEditorOffsetPositionsFirst: [{ type: Input }],
    recurrenceEditorOffsetPositionsSecond: [{ type: Input }],
    recurrenceEditorOffsetPositionsThird: [{ type: Input }],
    recurrenceEditorOffsetPositionsFourth: [{ type: Input }],
    recurrenceEditorOffsetPositionsLast: [{ type: Input }],
    recurrenceEditorWeekdaysDay: [{ type: Input }],
    recurrenceEditorWeekdaysWeekday: [{ type: Input }],
    recurrenceEditorWeekdaysWeekendday: [{ type: Input }],
    recurrenceEditorEndAfter: [{ type: Input }],
    recurrenceEditorEndOccurrence: [{ type: Input }],
    recurrenceEditorEndLabel: [{ type: Input }],
    recurrenceEditorEndNever: [{ type: Input }],
    recurrenceEditorEndOn: [{ type: Input }],
    editorTitle: [{ type: Input }],
    destroy: [{ type: Input }],
    deleteConfirmation: [{ type: Input }],
    editRecurringConfirmation: [{ type: Input }],
    editOccurrence: [{ type: Input }],
    editSeries: [{ type: Input }],
    deleteRecurringConfirmation: [{ type: Input }],
    deleteOccurrence: [{ type: Input }],
    deleteSeries: [{ type: Input }],
    deleteDialogTitle: [{ type: Input }],
    deleteRecurringDialogTitle: [{ type: Input }],
    editRecurringDialogTitle: [{ type: Input }]
};
const ɵMessages_BaseFactory = ɵngcc0.ɵɵgetInheritedFactory(Messages);

/**
 * Custom component messages override default component messages.
 */
class SchedulerCustomMessagesComponent extends Messages {
    constructor(service) {
        super();
        this.service = service;
    }
    get override() {
        return true;
    }
}
SchedulerCustomMessagesComponent.ɵfac = function SchedulerCustomMessagesComponent_Factory(t) { return new (t || SchedulerCustomMessagesComponent)(ɵngcc0.ɵɵdirectiveInject(ɵngcc2.LocalizationService)); };
SchedulerCustomMessagesComponent.ɵcmp = ɵngcc0.ɵɵdefineComponent({ type: SchedulerCustomMessagesComponent, selectors: [["kendo-scheduler-messages"]], features: [ɵngcc0.ɵɵProvidersFeature([
            {
                provide: Messages,
                useExisting: forwardRef(() => SchedulerCustomMessagesComponent) // tslint:disable-line:no-forward-ref
            }
        ]), ɵngcc0.ɵɵInheritDefinitionFeature], decls: 0, vars: 0, template: function SchedulerCustomMessagesComponent_Template(rf, ctx) { }, encapsulation: 2 });
/** @nocollapse */
SchedulerCustomMessagesComponent.ctorParameters = () => [
    { type: LocalizationService }
];
/*@__PURE__*/ (function () { ɵngcc0.ɵsetClassMetadata(SchedulerCustomMessagesComponent, [{
        type: Component,
        args: [{
                providers: [
                    {
                        provide: Messages,
                        useExisting: forwardRef(() => SchedulerCustomMessagesComponent) // tslint:disable-line:no-forward-ref
                    }
                ],
                selector: 'kendo-scheduler-messages',
                template: ``
            }]
    }], function () { return [{ type: ɵngcc2.LocalizationService }]; }, null); })();

/**
 * @hidden
 */
class LocalizedMessagesDirective extends Messages {
    constructor(service) {
        super();
        this.service = service;
    }
}
LocalizedMessagesDirective.ɵfac = function LocalizedMessagesDirective_Factory(t) { return new (t || LocalizedMessagesDirective)(ɵngcc0.ɵɵdirectiveInject(ɵngcc2.LocalizationService)); };
LocalizedMessagesDirective.ɵdir = ɵngcc0.ɵɵdefineDirective({ type: LocalizedMessagesDirective, selectors: [["", "kendoSchedulerLocalizedMessages", ""]], features: [ɵngcc0.ɵɵProvidersFeature([
            {
                provide: Messages,
                useExisting: forwardRef(() => LocalizedMessagesDirective) // tslint:disable-line:no-forward-ref
            }
        ]), ɵngcc0.ɵɵInheritDefinitionFeature] });
/** @nocollapse */
LocalizedMessagesDirective.ctorParameters = () => [
    { type: LocalizationService }
];
/*@__PURE__*/ (function () { ɵngcc0.ɵsetClassMetadata(LocalizedMessagesDirective, [{
        type: Directive,
        args: [{
                providers: [
                    {
                        provide: Messages,
                        useExisting: forwardRef(() => LocalizedMessagesDirective) // tslint:disable-line:no-forward-ref
                    }
                ],
                selector: '[kendoSchedulerLocalizedMessages]'
            }]
    }], function () { return [{ type: ɵngcc2.LocalizationService }]; }, null); })();

/**
 * A toolbar component which contains the controls for date navigation
 * ([see example]({% slug toolbar_scheduler %}#toc-including-the-built-in-components)).
 *
 * To render the **Previous**, **Today**, **Next**, and **Date picker**
 * buttons, include the component in the
 * [toolbar template]({% slug api_scheduler_toolbartemplatedirective %}).
 *
 * {% meta height:700 %}
 * {% embed_file toolbar/template/app.component.ts preview %}
 * {% embed_file toolbar/template/my-navigation.component.ts %}
 * {% embed_file toolbar/template/app.module.ts %}
 * {% embed_file shared/events-utc.ts %}
 * {% embed_file shared/main.ts %}
 * {% endmeta %}
 */
class ToolbarNavigationComponent {
    constructor(popupService, toolbarService, localization, cd) {
        this.popupService = popupService;
        this.toolbarService = toolbarService;
        this.localization = localization;
        /**
         * @hidden
         */
        this.hostClasses = true;
        this.subs = this.localization.changes.subscribe(({ rtl }) => {
            cd.markForCheck();
        });
    }
    set calendar(calendar) {
        if (calendar) {
            calendar.focus();
        }
    }
    /**
     * @hidden
     */
    get todayText() {
        return this.localization.get('today');
    }
    /**
     * @hidden
     */
    get calendarTodayText() {
        return this.localization.get('calendarToday');
    }
    /**
     * @hidden
     */
    get nextText() {
        return this.localization.get('nextTitle');
    }
    /**
     * @hidden
     */
    get previousText() {
        return this.localization.get('previousTitle');
    }
    /**
     * @hidden
     */
    get ctx() {
        return this.toolbarService.context;
    }
    /**
     * @hidden
     */
    onBlur() {
        this.closePopup();
    }
    ngOnDestroy() {
        this.subs.unsubscribe();
        this.closePopup();
    }
    /**
     * @hidden
     */
    toggleSelectedDate(anchor, template) {
        if (this.popupRef) {
            this.closePopup();
        }
        else {
            const popupSettings = {
                anchor: anchor,
                content: template
            };
            if (this.localization.rtl) {
                popupSettings.popupClass = 'k-rtl';
            }
            this.popupRef = this.popupService.open(popupSettings);
        }
        return false;
    }
    /**
     * @hidden
     */
    selectDate(value) {
        this.closePopup();
        this.toolbarService.navigate({
            type: 'select-date',
            date: value
        });
    }
    /**
     * @hidden
     */
    prevClick() {
        this.toolbarService.navigate({
            type: 'prev'
        });
        return false;
    }
    /**
     * @hidden
     */
    nextClick() {
        this.toolbarService.navigate({
            type: 'next'
        });
        return false;
    }
    /**
     * @hidden
     */
    todayClick() {
        this.toolbarService.navigate({
            type: 'today'
        });
        return false;
    }
    closePopup() {
        if (this.popupRef) {
            this.popupRef.close();
            this.popupRef = null;
        }
    }
}
ToolbarNavigationComponent.ɵfac = function ToolbarNavigationComponent_Factory(t) { return new (t || ToolbarNavigationComponent)(ɵngcc0.ɵɵdirectiveInject(ɵngcc6.PopupService), ɵngcc0.ɵɵdirectiveInject(ToolbarService), ɵngcc0.ɵɵdirectiveInject(ɵngcc2.LocalizationService), ɵngcc0.ɵɵdirectiveInject(ɵngcc0.ChangeDetectorRef)); };
ToolbarNavigationComponent.ɵcmp = ɵngcc0.ɵɵdefineComponent({ type: ToolbarNavigationComponent, selectors: [["", "kendoSchedulerToolbarNavigation", ""]], viewQuery: function ToolbarNavigationComponent_Query(rf, ctx) { if (rf & 1) {
        ɵngcc0.ɵɵviewQuery(_c155, true);
    } if (rf & 2) {
        var _t;
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.calendar = _t.first);
    } }, hostVars: 4, hostBindings: function ToolbarNavigationComponent_HostBindings(rf, ctx) { if (rf & 2) {
        ɵngcc0.ɵɵclassProp("k-scheduler-navigation", ctx.hostClasses)("k-reset", ctx.hostClasses);
    } }, inputs: { min: "min", max: "max" }, features: [ɵngcc0.ɵɵProvidersFeature([
            PopupService
        ])], attrs: _c156, decls: 21, vars: 12, consts: [[1, "k-state-default", "k-header", "k-nav-today"], ["role", "button", "href", "#", "tabindex", "-1", 1, "k-link", 3, "click"], [1, "k-state-default", "k-header", "k-nav-prev"], [1, "k-icon", "k-i-arrow-60-left", 2, "pointer-events", "none"], [1, "k-state-default", "k-header", "k-nav-next"], [1, "k-icon", "k-i-arrow-60-right", 2, "pointer-events", "none"], [1, "k-state-default", "k-nav-current"], ["anchor", ""], [1, "k-icon", "k-i-calendar"], [1, "k-sm-date-format"], [1, "k-lg-date-format"], ["template", ""], [3, "value", "min", "max", "blur", "valueChange"], ["calendar", ""], [3, "today"]], template: function ToolbarNavigationComponent_Template(rf, ctx) { if (rf & 1) {
        const _r7 = ɵngcc0.ɵɵgetCurrentView();
        ɵngcc0.ɵɵelementStart(0, "li", 0);
        ɵngcc0.ɵɵelementStart(1, "a", 1);
        ɵngcc0.ɵɵlistener("click", function ToolbarNavigationComponent_Template_a_click_1_listener() { return ctx.todayClick(); });
        ɵngcc0.ɵɵtext(2);
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵelementStart(3, "li", 2);
        ɵngcc0.ɵɵelementStart(4, "a", 1);
        ɵngcc0.ɵɵlistener("click", function ToolbarNavigationComponent_Template_a_click_4_listener() { return ctx.prevClick(); });
        ɵngcc0.ɵɵelement(5, "span", 3);
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵelementStart(6, "li", 4);
        ɵngcc0.ɵɵelementStart(7, "a", 1);
        ɵngcc0.ɵɵlistener("click", function ToolbarNavigationComponent_Template_a_click_7_listener() { return ctx.nextClick(); });
        ɵngcc0.ɵɵelement(8, "span", 5);
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵelementStart(9, "li", 6);
        ɵngcc0.ɵɵelementStart(10, "a", 1, 7);
        ɵngcc0.ɵɵlistener("click", function ToolbarNavigationComponent_Template_a_click_10_listener() { ɵngcc0.ɵɵrestoreView(_r7); const _r0 = ɵngcc0.ɵɵreference(11); const _r1 = ɵngcc0.ɵɵreference(20); return ctx.toggleSelectedDate(_r0, _r1); });
        ɵngcc0.ɵɵelement(12, "span", 8);
        ɵngcc0.ɵɵelementStart(13, "span", 9);
        ɵngcc0.ɵɵtext(14);
        ɵngcc0.ɵɵpipe(15, "async");
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵelementStart(16, "span", 10);
        ɵngcc0.ɵɵtext(17);
        ɵngcc0.ɵɵpipe(18, "async");
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵtemplate(19, ToolbarNavigationComponent_ng_template_19_Template, 4, 6, "ng-template", null, 11, ɵngcc0.ɵɵtemplateRefExtractor);
    } if (rf & 2) {
        var tmp_6_0 = null;
        var tmp_7_0 = null;
        ɵngcc0.ɵɵadvance(1);
        ɵngcc0.ɵɵattribute("title", ctx.todayText);
        ɵngcc0.ɵɵadvance(1);
        ɵngcc0.ɵɵtextInterpolate(ctx.todayText);
        ɵngcc0.ɵɵadvance(2);
        ɵngcc0.ɵɵattribute("title", ctx.previousText)("aria-label", ctx.previousText);
        ɵngcc0.ɵɵadvance(3);
        ɵngcc0.ɵɵattribute("title", ctx.nextText)("aria-label", ctx.nextText);
        ɵngcc0.ɵɵadvance(7);
        ɵngcc0.ɵɵtextInterpolate((tmp_6_0 = ɵngcc0.ɵɵpipeBind1(15, 8, ctx.ctx.dateRange)) == null ? null : tmp_6_0.shortText);
        ɵngcc0.ɵɵadvance(3);
        ɵngcc0.ɵɵtextInterpolate((tmp_7_0 = ɵngcc0.ɵɵpipeBind1(18, 10, ctx.ctx.dateRange)) == null ? null : tmp_7_0.text);
    } }, directives: [ɵngcc7.CalendarComponent, ɵngcc7.CalendarCustomMessagesComponent], pipes: [ɵngcc4.AsyncPipe], encapsulation: 2, changeDetection: 0 });
/** @nocollapse */
ToolbarNavigationComponent.ctorParameters = () => [
    { type: PopupService },
    { type: ToolbarService },
    { type: LocalizationService },
    { type: ChangeDetectorRef }
];
ToolbarNavigationComponent.propDecorators = {
    calendar: [{ type: ViewChild, args: ['calendar',] }],
    hostClasses: [{ type: HostBinding, args: ['class.k-scheduler-navigation',] }, { type: HostBinding, args: ['class.k-reset',] }],
    min: [{ type: Input }],
    max: [{ type: Input }]
};
/*@__PURE__*/ (function () { ɵngcc0.ɵsetClassMetadata(ToolbarNavigationComponent, [{
        type: Component,
        args: [{
                // tslint:disable-next-line:component-selector
                selector: '[kendoSchedulerToolbarNavigation]',
                changeDetection: ChangeDetectionStrategy.OnPush,
                providers: [
                    PopupService
                ],
                template: `
        <li class="k-state-default k-header k-nav-today">
            <a role="button"
                (click)="todayClick()"
                href="#"
                class="k-link"
                tabindex="-1"
                [attr.title]="todayText">{{todayText}}</a>
        </li>
        <li class="k-state-default k-header k-nav-prev">
            <a role="button"
                (click)="prevClick()"
                href="#"
                class="k-link"
                tabindex="-1"
                [attr.title]="previousText"
                [attr.aria-label]="previousText">
                <span class="k-icon k-i-arrow-60-left" style="pointer-events: none"></span>
            </a>
        </li>
        <li class="k-state-default k-header k-nav-next">
            <a role="button"
                (click)="nextClick()"
                href="#"
                class="k-link"
                tabindex="-1"
                [attr.title]="nextText"
                [attr.aria-label]="nextText">
                <span class="k-icon k-i-arrow-60-right" style="pointer-events: none"></span>
            </a>
        </li>
        <li class="k-state-default k-nav-current">
            <a role="button" #anchor href="#" class="k-link" tabindex="-1" (click)="toggleSelectedDate(anchor, template)">
                <span class="k-icon k-i-calendar"></span>
                <span class="k-sm-date-format">{{ (ctx.dateRange | async)?.shortText }}</span>
                <span class="k-lg-date-format">{{ (ctx.dateRange | async)?.text }}</span>
            </a>
        </li>

        <ng-template #template>
            <kendo-calendar #calendar (blur)="onBlur()" (valueChange)="selectDate($event)" [value]="ctx.selectedDate | async" [min]="min" [max]="max">
                <kendo-calendar-messages [today]="calendarTodayText">
                </kendo-calendar-messages>
            </kendo-calendar>
        </ng-template>
    `
            }]
    }], function () { return [{ type: ɵngcc6.PopupService }, { type: ToolbarService }, { type: ɵngcc2.LocalizationService }, { type: ɵngcc0.ChangeDetectorRef }]; }, { hostClasses: [{
            type: HostBinding,
            args: ['class.k-scheduler-navigation']
        }, {
            type: HostBinding,
            args: ['class.k-reset']
        }], calendar: [{
            type: ViewChild,
            args: ['calendar']
        }], min: [{
            type: Input
        }], max: [{
            type: Input
        }] }); })();

/**
 * @hidden
 */
class ToolbarComponent {
    constructor(service) {
        this.service = service;
        this.hostClasses = true;
        this.navigate = new EventEmitter();
        // The template context is the same as the service context,
        // but with resolved values instead of observables.
        this.templateContext = {};
        this.subs = new Subscription();
        this.subs.add(service.action.subscribe(action => this.navigate.next(action)));
    }
    ngOnInit() {
        this.subs.add(this.selectedDate.subscribe(date => this.templateContext.selectedDate = date));
        this.subs.add(this.dateRange.subscribe(dateRange => this.templateContext.dateRange = dateRange));
    }
    ngOnChanges() {
        this.service.context = {
            dateRange: this.dateRange,
            selectedDate: this.selectedDate,
            views: this.views,
            selectedView: this.selectedView
        };
        Object.assign(this.templateContext, {
            views: this.views,
            selectedView: this.selectedView
            // The dateRange and selectedDate context fields
            // are updated through the subscriptions added in ngOnInit.
        });
    }
    ngOnDestroy() {
        this.subs.unsubscribe();
    }
}
ToolbarComponent.ɵfac = function ToolbarComponent_Factory(t) { return new (t || ToolbarComponent)(ɵngcc0.ɵɵdirectiveInject(ToolbarService)); };
ToolbarComponent.ɵcmp = ɵngcc0.ɵɵdefineComponent({ type: ToolbarComponent, selectors: [["kendo-scheduler-toolbar"]], hostVars: 6, hostBindings: function ToolbarComponent_HostBindings(rf, ctx) { if (rf & 2) {
        ɵngcc0.ɵɵclassProp("k-scheduler-toolbar", ctx.hostClasses)("k-header", ctx.hostClasses)("k-floatwrap", ctx.hostClasses);
    } }, inputs: { selectedView: "selectedView", views: "views", dateRange: "dateRange", selectedDate: "selectedDate", template: "template", min: "min", max: "max" }, outputs: { navigate: "navigate" }, features: [ɵngcc0.ɵɵNgOnChangesFeature], decls: 3, vars: 2, consts: [[4, "ngIf", "ngIfElse"], ["defaultTemplate", ""], [3, "ngTemplateOutlet", "ngTemplateOutletContext"], ["kendoSchedulerToolbarNavigation", "", 3, "min", "max"], ["kendoSchedulerToolbarViewSelector", ""]], template: function ToolbarComponent_Template(rf, ctx) { if (rf & 1) {
        ɵngcc0.ɵɵtemplate(0, ToolbarComponent_0_Template, 1, 2, undefined, 0);
        ɵngcc0.ɵɵtemplate(1, ToolbarComponent_ng_template_1_Template, 2, 2, "ng-template", null, 1, ɵngcc0.ɵɵtemplateRefExtractor);
    } if (rf & 2) {
        const _r1 = ɵngcc0.ɵɵreference(2);
        ɵngcc0.ɵɵproperty("ngIf", ctx.template)("ngIfElse", _r1);
    } }, directives: function () { return [ɵngcc4.NgIf, ɵngcc4.NgTemplateOutlet, ToolbarNavigationComponent,
        ToolbarViewSelectorComponent]; }, encapsulation: 2 });
/** @nocollapse */
ToolbarComponent.ctorParameters = () => [
    { type: ToolbarService }
];
ToolbarComponent.propDecorators = {
    hostClasses: [{ type: HostBinding, args: ['class.k-scheduler-toolbar',] }, { type: HostBinding, args: ['class.k-header',] }, { type: HostBinding, args: ['class.k-floatwrap',] }],
    selectedView: [{ type: Input }],
    views: [{ type: Input }],
    dateRange: [{ type: Input }],
    selectedDate: [{ type: Input }],
    template: [{ type: Input }],
    navigate: [{ type: Output }],
    min: [{ type: Input }],
    max: [{ type: Input }]
};
/*@__PURE__*/ (function () { ɵngcc0.ɵsetClassMetadata(ToolbarComponent, [{
        type: Component,
        args: [{
                selector: 'kendo-scheduler-toolbar',
                template: `
        <ng-template
            *ngIf="template; else defaultTemplate"
            [ngTemplateOutlet]="template.templateRef"
            [ngTemplateOutletContext]="templateContext"
        >
        </ng-template>

        <ng-template #defaultTemplate>
            <ul kendoSchedulerToolbarNavigation [min]="min" [max]="max"></ul>
            <ul kendoSchedulerToolbarViewSelector></ul>
        </ng-template>
    `
            }]
    }], function () { return [{ type: ToolbarService }]; }, { hostClasses: [{
            type: HostBinding,
            args: ['class.k-scheduler-toolbar']
        }, {
            type: HostBinding,
            args: ['class.k-header']
        }, {
            type: HostBinding,
            args: ['class.k-floatwrap']
        }], navigate: [{
            type: Output
        }], selectedView: [{
            type: Input
        }], views: [{
            type: Input
        }], dateRange: [{
            type: Input
        }], selectedDate: [{
            type: Input
        }], template: [{
            type: Input
        }], min: [{
            type: Input
        }], max: [{
            type: Input
        }] }); })();

/**
 * A toolbar component which contains the controls for switching the views
 * ([see example]({% slug toolbar_scheduler %}#toc-including-the-built-in-components)).
 *
 * To render the view-selection buttons, include the component in the
 * [toolbar template]({% slug api_scheduler_toolbartemplatedirective %}).
 *
 * {% meta height:700 %}
 * {% embed_file toolbar/template/app.component.ts preview %}
 * {% embed_file toolbar/template/my-navigation.component.ts %}
 * {% embed_file toolbar/template/app.module.ts %}
 * {% embed_file shared/events-utc.ts %}
 * {% embed_file shared/main.ts %}
 * {% endmeta %}
 */
class ToolbarViewSelectorComponent {
    constructor(service, element, renderer, domEvents, ngZone) {
        this.service = service;
        this.element = element;
        this.renderer = renderer;
        this.domEvents = domEvents;
        this.ngZone = ngZone;
        /**
         * @hidden
         */
        this.hostClasses = true;
    }
    /**
     * @hidden
     */
    get expanded() {
        return this._expanded;
    }
    set expanded(value) {
        this._expanded = value;
        const expandedClass = 'k-state-expanded';
        const element = this.element.nativeElement;
        if (value) {
            this.renderer.addClass(element, expandedClass);
        }
        else {
            this.renderer.removeClass(element, expandedClass);
        }
    }
    /**
     * @hidden
     */
    get ctx() {
        return this.service.context;
    }
    /**
     * @hidden
     */
    get itemDisplay() {
        if (this.ctx.views && this.ctx.views.length === 1) {
            return 'list-item';
        }
    }
    ngAfterViewInit() {
        this.attachElementEventHandlers();
    }
    ngOnDestroy() {
        if (this.detachDomEvents) {
            this.detachDomEvents();
        }
    }
    /**
     * @hidden
     */
    onClick(view) {
        if (this.ctx.selectedView !== view) {
            this.service.navigate({
                type: 'view-change',
                view: view
            });
        }
        this.expanded = false;
    }
    /**
     * @hidden
     */
    onCurrentViewClick() {
        this.expanded = !this.expanded;
    }
    /**
     * @hidden
     */
    isSelected(view) {
        return this.ctx.selectedView === view;
    }
    attachElementEventHandlers() {
        const element = this.element.nativeElement;
        this.ngZone.runOutsideAngular(() => {
            const focusOutListener = this.renderer.listen(element, 'focusout', (args) => {
                const next = args.relatedTarget || document.activeElement;
                const outside = !closest(next, (node) => node === element);
                if (outside) {
                    this.expanded = false;
                }
            });
            const windowBlurSubscription = this.domEvents.windowBlur.subscribe(() => this.expanded = false);
            this.detachDomEvents = () => {
                focusOutListener();
                windowBlurSubscription.unsubscribe();
            };
        });
    }
}
ToolbarViewSelectorComponent.ɵfac = function ToolbarViewSelectorComponent_Factory(t) { return new (t || ToolbarViewSelectorComponent)(ɵngcc0.ɵɵdirectiveInject(ToolbarService), ɵngcc0.ɵɵdirectiveInject(ɵngcc0.ElementRef), ɵngcc0.ɵɵdirectiveInject(ɵngcc0.Renderer2), ɵngcc0.ɵɵdirectiveInject(DomEventsService), ɵngcc0.ɵɵdirectiveInject(ɵngcc0.NgZone)); };
ToolbarViewSelectorComponent.ɵcmp = ɵngcc0.ɵɵdefineComponent({ type: ToolbarViewSelectorComponent, selectors: [["", "kendoSchedulerToolbarViewSelector", ""]], hostVars: 4, hostBindings: function ToolbarViewSelectorComponent_HostBindings(rf, ctx) { if (rf & 2) {
        ɵngcc0.ɵɵclassProp("k-scheduler-views", ctx.hostClasses)("k-reset", ctx.hostClasses);
    } }, attrs: _c157, decls: 2, vars: 2, consts: [["class", "k-current-view", 4, "ngIf"], [3, "k-state-selected", "ngStyle", 4, "ngFor", "ngForOf"], [1, "k-current-view"], ["role", "button", "tabindex", "-1", 1, "k-link", 3, "kendoEventsOutsideAngular", "scope"], [3, "ngStyle"], ["role", "button", "tabindex", "-1", 1, "k-link", 3, "click"]], template: function ToolbarViewSelectorComponent_Template(rf, ctx) { if (rf & 1) {
        ɵngcc0.ɵɵtemplate(0, ToolbarViewSelectorComponent_li_0_Template, 3, 5, "li", 0);
        ɵngcc0.ɵɵtemplate(1, ToolbarViewSelectorComponent_li_1_Template, 3, 6, "li", 1);
    } if (rf & 2) {
        ɵngcc0.ɵɵproperty("ngIf", (ctx.ctx.views == null ? null : ctx.ctx.views.length) > 1);
        ɵngcc0.ɵɵadvance(1);
        ɵngcc0.ɵɵproperty("ngForOf", ctx.ctx.views);
    } }, directives: [ɵngcc4.NgIf, ɵngcc4.NgForOf, ɵngcc5.EventsOutsideAngularDirective, ɵngcc4.NgStyle], encapsulation: 2 });
/** @nocollapse */
ToolbarViewSelectorComponent.ctorParameters = () => [
    { type: ToolbarService },
    { type: ElementRef },
    { type: Renderer2 },
    { type: DomEventsService },
    { type: NgZone }
];
ToolbarViewSelectorComponent.propDecorators = {
    hostClasses: [{ type: HostBinding, args: ['class.k-scheduler-views',] }, { type: HostBinding, args: ['class.k-reset',] }]
};
/*@__PURE__*/ (function () { ɵngcc0.ɵsetClassMetadata(ToolbarViewSelectorComponent, [{
        type: Component,
        args: [{
                // tslint:disable-next-line:component-selector
                selector: '[kendoSchedulerToolbarViewSelector]',
                template: `
        <li class="k-current-view" *ngIf="ctx.views?.length > 1">
            <span role="button" class="k-link" tabindex="-1" [kendoEventsOutsideAngular]="{ click: onCurrentViewClick }" [scope]="this">
                {{ ctx.selectedView?.title }}
            </span>
        </li>
        <li *ngFor="let view of ctx.views"
            [class.k-state-selected]="isSelected(view)" [ngStyle]="{ display: itemDisplay }"
         >
            <span role="button" class="k-link" tabindex="-1" (click)="onClick(view)">
                {{ view.title }}
            </span>
        </li>
    `
            }]
    }], function () { return [{ type: ToolbarService }, { type: ɵngcc0.ElementRef }, { type: ɵngcc0.Renderer2 }, { type: DomEventsService }, { type: ɵngcc0.NgZone }]; }, { hostClasses: [{
            type: HostBinding,
            args: ['class.k-scheduler-views']
        }, {
            type: HostBinding,
            args: ['class.k-reset']
        }] }); })();

/**
 * @hidden
 */
const publicDirectives = [
    ToolbarNavigationComponent,
    ToolbarTemplateDirective,
    ToolbarViewSelectorComponent
];
/**
 * @hidden
 */
class ToolbarModule {
}
ToolbarModule.ɵmod = ɵngcc0.ɵɵdefineNgModule({ type: ToolbarModule });
ToolbarModule.ɵinj = ɵngcc0.ɵɵdefineInjector({ factory: function ToolbarModule_Factory(t) { return new (t || ToolbarModule)(); }, imports: [[
            CommonModule,
            CalendarModule,
            PopupModule,
            EventsModule
        ]] });
(function () { (typeof ngJitMode === "undefined" || ngJitMode) && ɵngcc0.ɵɵsetNgModuleScope(ToolbarModule, { declarations: function () { return [ToolbarComponent,
        ToolbarNavigationComponent,
        ToolbarTemplateDirective,
        ToolbarViewSelectorComponent]; }, imports: function () { return [CommonModule,
        CalendarModule,
        PopupModule,
        EventsModule]; }, exports: function () { return [ToolbarComponent,
        ToolbarNavigationComponent,
        ToolbarTemplateDirective,
        ToolbarViewSelectorComponent]; } }); })();
/*@__PURE__*/ (function () { ɵngcc0.ɵsetClassMetadata(ToolbarModule, [{
        type: NgModule,
        args: [{
                imports: [
                    CommonModule,
                    CalendarModule,
                    PopupModule,
                    EventsModule
                ],
                exports: [
                    ToolbarComponent,
                    ...publicDirectives
                ],
                declarations: [
                    ToolbarComponent,
                    ...publicDirectives
                ]
            }]
    }], null, null); })();

const defaultSlotClass = (_args) => null;
/**
 * @hidden
 */
class ConfigurationViewBase extends SchedulerView {
    constructor(localization, changeDetector, viewContext, viewState) {
        super();
        this.localization = localization;
        this.changeDetector = changeDetector;
        this.viewContext = viewContext;
        this.viewState = viewState;
        this.schedulerOptions = {};
        this.subs = this.localization.changes.subscribe(({ rtl }) => {
            changeDetector.markForCheck();
        });
        this.subs.add(this.viewContext.optionsChange.subscribe(this.optionsChange.bind(this)));
    }
    /**
     * @hidden
     */
    get viewSlotClass() {
        return isPresent(this.slotClass) ? this.slotClass : (this.schedulerOptions.slotClass || defaultSlotClass);
    }
    /**
     * @hidden
     */
    get viewEventClass() {
        return isPresent(this.eventClass) ? this.eventClass : this.schedulerOptions.eventClass;
    }
    /**
     * @hidden
     */
    get viewEventStyles() {
        return isPresent(this.eventStyles) ? this.eventStyles : this.schedulerOptions.eventStyles;
    }
    ngOnChanges(_changes) {
        this.viewState.notifyOptionsChange();
    }
    ngOnDestroy() {
        this.subs.unsubscribe();
    }
    optionsChange(options) {
        this.schedulerOptions = options;
    }
}
ConfigurationViewBase.ɵfac = function ConfigurationViewBase_Factory(t) { ɵngcc0.ɵɵinvalidFactory(); };
ConfigurationViewBase.ɵdir = ɵngcc0.ɵɵdefineDirective({ type: ConfigurationViewBase, contentQueries: function ConfigurationViewBase_ContentQueries(rf, ctx, dirIndex) { if (rf & 1) {
        ɵngcc0.ɵɵcontentQuery(dirIndex, EventTemplateDirective, true);
        ɵngcc0.ɵɵcontentQuery(dirIndex, GroupHeaderTemplateDirective, true);
    } if (rf & 2) {
        var _t;
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.eventTemplate = _t.first);
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.groupHeaderTemplate = _t.first);
    } }, viewQuery: function ConfigurationViewBase_Query(rf, ctx) { if (rf & 1) {
        ɵngcc0.ɵɵstaticViewQuery(_c160, true);
    } if (rf & 2) {
        var _t;
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.template = _t.first);
    } }, inputs: { slotClass: "slotClass", eventClass: "eventClass", eventStyles: "eventStyles" }, features: [ɵngcc0.ɵɵInheritDefinitionFeature, ɵngcc0.ɵɵNgOnChangesFeature] });
ConfigurationViewBase.propDecorators = {
    slotClass: [{ type: Input }],
    eventClass: [{ type: Input }],
    eventStyles: [{ type: Input }],
    template: [{ type: ViewChild, args: ['content', { static: true },] }],
    eventTemplate: [{ type: ContentChild, args: [EventTemplateDirective,] }],
    groupHeaderTemplate: [{ type: ContentChild, args: [GroupHeaderTemplateDirective,] }]
};


/**
 * The component for rendering the **Agenda** view.
 */
class AgendaViewComponent extends ConfigurationViewBase {
    constructor(localization, changeDetector, viewContext, viewState) {
        super(localization, changeDetector, viewContext, viewState);
        /**
         * The long-date format for displaying the
         * selected date in the Scheduler toolbar.
         * Defaults to `{0:D} - {1:D}`,
         * where `0` is the start and `1` is the end date
         * ([more information]({% slug parsingandformatting_intl %}#toc-date-formatting)).
         */
        this.selectedDateFormat = '{0:D} - {1:D}';
        /**
         * The short-date format for displaying the
         * selected date in the Scheduler toolbar.
         * Defaults to `{0:d} - {1:d}`,
         * where `0` is the start and `1` is the end date
         * ([more information]({% slug parsingandformatting_intl %}#toc-date-formatting)).
         */
        this.selectedShortDateFormat = '{0:d} - {1:d}';
        /**
         * Specifies the number of days that the view will render.
         * Defaults to `7`.
         */
        this.numberOfDays = 7;
        /**
         * The invariant name for this view (`agenda`).
         */
        this.name = 'agenda';
    }
    /**
     * @hidden
     */
    get title() {
        return this.localization.get('agendaViewTitle');
    }
}
AgendaViewComponent.ɵfac = function AgendaViewComponent_Factory(t) { return new (t || AgendaViewComponent)(ɵngcc0.ɵɵdirectiveInject(ɵngcc2.LocalizationService), ɵngcc0.ɵɵdirectiveInject(ɵngcc0.ChangeDetectorRef), ɵngcc0.ɵɵdirectiveInject(ViewContextService), ɵngcc0.ɵɵdirectiveInject(ViewStateService)); };
AgendaViewComponent.ɵcmp = ɵngcc0.ɵɵdefineComponent({ type: AgendaViewComponent, selectors: [["kendo-scheduler-agenda-view"]], contentQueries: function AgendaViewComponent_ContentQueries(rf, ctx, dirIndex) { if (rf & 1) {
        ɵngcc0.ɵɵcontentQuery(dirIndex, EventTemplateDirective, true);
        ɵngcc0.ɵɵcontentQuery(dirIndex, AgendaTimeTemplateDirective, true);
        ɵngcc0.ɵɵcontentQuery(dirIndex, AgendaDateTemplateDirective, true);
    } if (rf & 2) {
        var _t;
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.eventTemplate = _t.first);
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.agendaTimeTemplate = _t.first);
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.agendaDateTemplate = _t.first);
    } }, inputs: { selectedDateFormat: "selectedDateFormat", selectedShortDateFormat: "selectedShortDateFormat", numberOfDays: "numberOfDays" }, features: [ɵngcc0.ɵɵProvidersFeature([{
                provide: SchedulerView,
                // tslint:disable-next-line:no-forward-ref
                useExisting: forwardRef(() => AgendaViewComponent)
            }]), ɵngcc0.ɵɵInheritDefinitionFeature], decls: 2, vars: 0, consts: [["content", ""], [3, "numberOfDays", "eventTemplate", "slotClass", "eventClass", "eventStyles", "agendaTimeTemplate", "agendaDateTemplate", "selectedDateFormat", "selectedShortDateFormat"]], template: function AgendaViewComponent_Template(rf, ctx) { if (rf & 1) {
        ɵngcc0.ɵɵtemplate(0, AgendaViewComponent_ng_template_0_Template, 1, 9, "ng-template", null, 0, ɵngcc0.ɵɵtemplateRefExtractor);
    } }, directives: function () { return [AgendaViewInternalComponent]; }, encapsulation: 2, changeDetection: 0 });
/** @nocollapse */
AgendaViewComponent.ctorParameters = () => [
    { type: LocalizationService },
    { type: ChangeDetectorRef },
    { type: ViewContextService },
    { type: ViewStateService }
];
AgendaViewComponent.propDecorators = {
    selectedDateFormat: [{ type: Input }],
    selectedShortDateFormat: [{ type: Input }],
    numberOfDays: [{ type: Input }],
    eventTemplate: [{ type: ContentChild, args: [EventTemplateDirective,] }],
    agendaTimeTemplate: [{ type: ContentChild, args: [AgendaTimeTemplateDirective,] }],
    agendaDateTemplate: [{ type: ContentChild, args: [AgendaDateTemplateDirective,] }]
};
/*@__PURE__*/ (function () { ɵngcc0.ɵsetClassMetadata(AgendaViewComponent, [{
        type: Component,
        args: [{
                changeDetection: ChangeDetectionStrategy.OnPush,
                selector: 'kendo-scheduler-agenda-view',
                providers: [{
                        provide: SchedulerView,
                        // tslint:disable-next-line:no-forward-ref
                        useExisting: forwardRef(() => AgendaViewComponent)
                    }],
                template: `
        <ng-template #content>
            <agenda-view-internal
                [numberOfDays]="numberOfDays"
                [eventTemplate]="eventTemplate?.templateRef"
                [slotClass]="viewSlotClass"
                [eventClass]="viewEventClass"
                [eventStyles]="viewEventStyles"
                [agendaTimeTemplate]="agendaTimeTemplate?.templateRef"
                [agendaDateTemplate]="agendaDateTemplate?.templateRef"
                [selectedDateFormat]="selectedDateFormat"
                [selectedShortDateFormat]="selectedShortDateFormat">
            </agenda-view-internal>
        </ng-template>
    `
            }]
    }], function () { return [{ type: ɵngcc2.LocalizationService }, { type: ɵngcc0.ChangeDetectorRef }, { type: ViewContextService }, { type: ViewStateService }]; }, { selectedDateFormat: [{
            type: Input
        }], selectedShortDateFormat: [{
            type: Input
        }], numberOfDays: [{
            type: Input
        }], eventTemplate: [{
            type: ContentChild,
            args: [EventTemplateDirective]
        }], agendaTimeTemplate: [{
            type: ContentChild,
            args: [AgendaTimeTemplateDirective]
        }], agendaDateTemplate: [{
            type: ContentChild,
            args: [AgendaDateTemplateDirective]
        }] }); })();

/**
 * @hidden
 */
class AgendaHeaderItemComponent {
    constructor() {
        this.classes = true;
    }
    get rowSpan() {
        return this.item.rowSpan;
    }
    get itemDate() {
        return toLocalDate(this.item.dataItem.value);
    }
}
AgendaHeaderItemComponent.ɵfac = function AgendaHeaderItemComponent_Factory(t) { return new (t || AgendaHeaderItemComponent)(); };
AgendaHeaderItemComponent.ɵcmp = ɵngcc0.ɵɵdefineComponent({ type: AgendaHeaderItemComponent, selectors: [["", "kendoSchedulerAgendaHeaderItem", ""]], hostVars: 3, hostBindings: function AgendaHeaderItemComponent_HostBindings(rf, ctx) { if (rf & 2) {
        ɵngcc0.ɵɵattribute("rowspan", ctx.rowSpan);
        ɵngcc0.ɵɵclassProp("k-scheduler-datecolumn", ctx.classes);
    } }, inputs: { item: ["kendoSchedulerAgendaHeaderItem", "item"], agendaDateTemplate: "agendaDateTemplate" }, attrs: _c161, decls: 2, vars: 2, consts: [[4, "ngIf"], [3, "ngTemplateOutlet", "ngTemplateOutletContext", 4, "ngIf"], [1, "k-scheduler-agendaday"], [1, "k-scheduler-agendaweek"], [1, "k-scheduler-agendadate"], [3, "ngTemplateOutlet", "ngTemplateOutletContext"]], template: function AgendaHeaderItemComponent_Template(rf, ctx) { if (rf & 1) {
        ɵngcc0.ɵɵtemplate(0, AgendaHeaderItemComponent_ng_container_0_Template, 10, 12, "ng-container", 0);
        ɵngcc0.ɵɵtemplate(1, AgendaHeaderItemComponent_ng_container_1_Template, 1, 4, "ng-container", 1);
    } if (rf & 2) {
        ɵngcc0.ɵɵproperty("ngIf", !ctx.agendaDateTemplate);
        ɵngcc0.ɵɵadvance(1);
        ɵngcc0.ɵɵproperty("ngIf", ctx.agendaDateTemplate);
    } }, directives: [ɵngcc4.NgIf, ɵngcc4.NgTemplateOutlet], pipes: [ɵngcc3.DatePipe], encapsulation: 2, changeDetection: 0 });
AgendaHeaderItemComponent.propDecorators = {
    classes: [{ type: HostBinding, args: ["class.k-scheduler-datecolumn",] }],
    rowSpan: [{ type: HostBinding, args: ["attr.rowspan",] }],
    item: [{ type: Input, args: ["kendoSchedulerAgendaHeaderItem",] }],
    agendaDateTemplate: [{ type: Input }]
};
/*@__PURE__*/ (function () { ɵngcc0.ɵsetClassMetadata(AgendaHeaderItemComponent, [{
        type: Component,
        args: [{
                changeDetection: ChangeDetectionStrategy.OnPush,
                // tslint:disable-next-line:component-selector
                selector: '[kendoSchedulerAgendaHeaderItem]',
                template: `
        <ng-container *ngIf="!agendaDateTemplate">
            <strong class="k-scheduler-agendaday">{{itemDate | kendoDate: 'dd'}}</strong>
            <em class="k-scheduler-agendaweek">{{itemDate | kendoDate: 'EEEE'}}</em>
            <span class="k-scheduler-agendadate">{{itemDate | kendoDate: 'y'}}</span>
        </ng-container>
        <ng-container *ngIf="agendaDateTemplate" [ngTemplateOutlet]="agendaDateTemplate"
            [ngTemplateOutletContext]="{ date: itemDate }">
        </ng-container>
    `
            }]
    }], function () { return []; }, { classes: [{
            type: HostBinding,
            args: ["class.k-scheduler-datecolumn"]
        }], rowSpan: [{
            type: HostBinding,
            args: ["attr.rowspan"]
        }], item: [{
            type: Input,
            args: ["kendoSchedulerAgendaHeaderItem"]
        }], agendaDateTemplate: [{
            type: Input
        }] }); })();

/**
 * @hidden
 */
class AgendaHeaderComponent {
    constructor(localization) {
        this.localization = localization;
        this.classes = true;
    }
    get dateMessage() {
        return this.localization.get('dateHeader');
    }
    get timeMessage() {
        return this.localization.get('timeHeader');
    }
    get eventMessage() {
        return this.localization.get('eventHeader');
    }
}
AgendaHeaderComponent.ɵfac = function AgendaHeaderComponent_Factory(t) { return new (t || AgendaHeaderComponent)(ɵngcc0.ɵɵdirectiveInject(ɵngcc2.LocalizationService)); };
AgendaHeaderComponent.ɵcmp = ɵngcc0.ɵɵdefineComponent({ type: AgendaHeaderComponent, selectors: [["", "kendoSchedulerAgendaHeader", ""]], hostVars: 4, hostBindings: function AgendaHeaderComponent_HostBindings(rf, ctx) { if (rf & 2) {
        ɵngcc0.ɵɵclassProp("k-scheduler-header", ctx.classes)("k-state-default", ctx.classes);
    } }, inputs: { resources: "resources" }, attrs: _c163, decls: 11, vars: 4, consts: [[1, "k-scheduler-header-wrap"], ["role", "presentation", 1, "k-scheduler-table"], ["class", "k-scheduler-groupcolumn", 4, "ngFor", "ngForOf"], [1, "k-scheduler-datecolumn"], [1, "k-scheduler-timecolumn"], [1, "k-scheduler-groupcolumn"]], template: function AgendaHeaderComponent_Template(rf, ctx) { if (rf & 1) {
        ɵngcc0.ɵɵelementStart(0, "div", 0);
        ɵngcc0.ɵɵelementStart(1, "table", 1);
        ɵngcc0.ɵɵelementStart(2, "tbody");
        ɵngcc0.ɵɵelementStart(3, "tr");
        ɵngcc0.ɵɵtemplate(4, AgendaHeaderComponent_th_4_Template, 1, 0, "th", 2);
        ɵngcc0.ɵɵelementStart(5, "th", 3);
        ɵngcc0.ɵɵtext(6);
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵelementStart(7, "th", 4);
        ɵngcc0.ɵɵtext(8);
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵelementStart(9, "th");
        ɵngcc0.ɵɵtext(10);
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵelementEnd();
    } if (rf & 2) {
        ɵngcc0.ɵɵadvance(4);
        ɵngcc0.ɵɵproperty("ngForOf", ctx.resources);
        ɵngcc0.ɵɵadvance(2);
        ɵngcc0.ɵɵtextInterpolate(ctx.dateMessage);
        ɵngcc0.ɵɵadvance(2);
        ɵngcc0.ɵɵtextInterpolate(ctx.timeMessage);
        ɵngcc0.ɵɵadvance(2);
        ɵngcc0.ɵɵtextInterpolate(ctx.eventMessage);
    } }, directives: [ɵngcc4.NgForOf], encapsulation: 2, changeDetection: 0 });
/** @nocollapse */
AgendaHeaderComponent.ctorParameters = () => [
    { type: LocalizationService }
];
AgendaHeaderComponent.propDecorators = {
    classes: [{ type: HostBinding, args: ["class.k-scheduler-header",] }, { type: HostBinding, args: ["class.k-state-default",] }],
    resources: [{ type: Input }]
};
/*@__PURE__*/ (function () { ɵngcc0.ɵsetClassMetadata(AgendaHeaderComponent, [{
        type: Component,
        args: [{
                changeDetection: ChangeDetectionStrategy.OnPush,
                // tslint:disable-next-line:component-selector
                selector: '[kendoSchedulerAgendaHeader]',
                template: `
        <div class="k-scheduler-header-wrap">
            <table class="k-scheduler-table" role="presentation">
                <tbody>
                    <tr>
                        <th *ngFor="let resource of resources" class="k-scheduler-groupcolumn"></th>
                        <th class="k-scheduler-datecolumn">{{ dateMessage }}</th>
                        <th class="k-scheduler-timecolumn">{{ timeMessage }}</th>
                        <th>{{ eventMessage }}</th>
                    </tr>
                </tbody>
            </table>
        </div>
    `
            }]
    }], function () { return [{ type: ɵngcc2.LocalizationService }]; }, { classes: [{
            type: HostBinding,
            args: ["class.k-scheduler-header"]
        }, {
            type: HostBinding,
            args: ["class.k-state-default"]
        }], resources: [{
            type: Input
        }] }); })();

/**
 * @hidden
 */
class AgendaTaskItemComponent {
    constructor(localization, localeId) {
        this.localization = localization;
        this.localeId = localeId;
    }
    get eventTitle() {
        const start = toLocalDate(this.item.start);
        const end = toLocalDate(this.item.end);
        const time = formatEventTime(start, end, this.item.isAllDay, this.localeId);
        return `${time}, ${this.item.event.title}`;
    }
    get eventColor() {
        return this.item.color;
    }
    get deleteMessage() {
        return this.localization.get('deleteTitle');
    }
    get isRecurrence() {
        return isRecurrence(this.item);
    }
    get isRecurrenceException() {
        return isRecurrenceException(this.item);
    }
    get removable() {
        return this.editable && this.editable.remove !== false;
    }
}
AgendaTaskItemComponent.ɵfac = function AgendaTaskItemComponent_Factory(t) { return new (t || AgendaTaskItemComponent)(ɵngcc0.ɵɵdirectiveInject(ɵngcc2.LocalizationService), ɵngcc0.ɵɵdirectiveInject(LOCALE_ID)); };
AgendaTaskItemComponent.ɵcmp = ɵngcc0.ɵɵdefineComponent({ type: AgendaTaskItemComponent, selectors: [["", "kendoSchedulerAgendaTaskItem", ""]], hostVars: 1, hostBindings: function AgendaTaskItemComponent_HostBindings(rf, ctx) { if (rf & 2) {
        ɵngcc0.ɵɵattribute("aria-label", ctx.eventTitle);
    } }, inputs: { item: ["kendoSchedulerAgendaTaskItem", "item"], color: "color", eventTemplate: "eventTemplate", editable: "editable" }, attrs: _c164, decls: 7, vars: 7, consts: [[1, "k-task", 3, "title"], ["class", "k-scheduler-mark", 3, "background-color", 4, "ngIf"], ["class", "k-icon k-i-reload", 4, "ngIf"], ["class", "k-icon k-i-non-recurrence", 4, "ngIf"], [4, "ngIf"], [3, "ngTemplateOutlet", "ngTemplateOutletContext", 4, "ngIf"], ["class", "k-link k-event-delete", "aria-hidden", "true", 4, "ngIf"], [1, "k-scheduler-mark"], [1, "k-icon", "k-i-reload"], [1, "k-icon", "k-i-non-recurrence"], [3, "ngTemplateOutlet", "ngTemplateOutletContext"], ["aria-hidden", "true", 1, "k-link", "k-event-delete"], [1, "k-icon", "k-i-close"]], template: function AgendaTaskItemComponent_Template(rf, ctx) { if (rf & 1) {
        ɵngcc0.ɵɵelementStart(0, "div", 0);
        ɵngcc0.ɵɵtemplate(1, AgendaTaskItemComponent_span_1_Template, 1, 2, "span", 1);
        ɵngcc0.ɵɵtemplate(2, AgendaTaskItemComponent_span_2_Template, 1, 0, "span", 2);
        ɵngcc0.ɵɵtemplate(3, AgendaTaskItemComponent_span_3_Template, 1, 0, "span", 3);
        ɵngcc0.ɵɵtemplate(4, AgendaTaskItemComponent_ng_container_4_Template, 2, 1, "ng-container", 4);
        ɵngcc0.ɵɵtemplate(5, AgendaTaskItemComponent_ng_container_5_Template, 1, 6, "ng-container", 5);
        ɵngcc0.ɵɵtemplate(6, AgendaTaskItemComponent_span_6_Template, 2, 1, "span", 6);
        ɵngcc0.ɵɵelementEnd();
    } if (rf & 2) {
        ɵngcc0.ɵɵproperty("title", ctx.item.title);
        ɵngcc0.ɵɵadvance(1);
        ɵngcc0.ɵɵproperty("ngIf", ctx.eventColor);
        ɵngcc0.ɵɵadvance(1);
        ɵngcc0.ɵɵproperty("ngIf", ctx.isRecurrence);
        ɵngcc0.ɵɵadvance(1);
        ɵngcc0.ɵɵproperty("ngIf", ctx.isRecurrenceException);
        ɵngcc0.ɵɵadvance(1);
        ɵngcc0.ɵɵproperty("ngIf", !ctx.eventTemplate);
        ɵngcc0.ɵɵadvance(1);
        ɵngcc0.ɵɵproperty("ngIf", ctx.eventTemplate);
        ɵngcc0.ɵɵadvance(1);
        ɵngcc0.ɵɵproperty("ngIf", ctx.removable);
    } }, directives: [ɵngcc4.NgIf, ɵngcc4.NgTemplateOutlet], encapsulation: 2, changeDetection: 0 });
/** @nocollapse */
AgendaTaskItemComponent.ctorParameters = () => [
    { type: LocalizationService },
    { type: String, decorators: [{ type: Inject, args: [LOCALE_ID,] }] }
];
AgendaTaskItemComponent.propDecorators = {
    item: [{ type: Input, args: ["kendoSchedulerAgendaTaskItem",] }],
    color: [{ type: Input }],
    eventTemplate: [{ type: Input }],
    editable: [{ type: Input }],
    eventTitle: [{ type: HostBinding, args: ['attr.aria-label',] }]
};
/*@__PURE__*/ (function () { ɵngcc0.ɵsetClassMetadata(AgendaTaskItemComponent, [{
        type: Component,
        args: [{
                changeDetection: ChangeDetectionStrategy.OnPush,
                // tslint:disable-next-line:component-selector
                selector: '[kendoSchedulerAgendaTaskItem]',
                template: `
        <div class="k-task" [title]="item.title">
            <span class="k-scheduler-mark" *ngIf="eventColor" [style.background-color]="eventColor"></span>
            <span class="k-icon k-i-reload" *ngIf="isRecurrence"></span>
            <span class="k-icon k-i-non-recurrence" *ngIf="isRecurrenceException"></span>
            <ng-container *ngIf="!eventTemplate">
                {{item?.title }}
            </ng-container>
            <ng-container *ngIf="eventTemplate" [ngTemplateOutlet]="eventTemplate"
                [ngTemplateOutletContext]="{ $implicit: item.event, event: item.event, resources: item.resources }">
            </ng-container>

            <span *ngIf="removable" class="k-link k-event-delete" aria-hidden="true" [attr.title]="deleteMessage">
                <span class="k-icon k-i-close"></span>
            </span>
        </div>
    `
            }]
    }], function () { return [{ type: ɵngcc2.LocalizationService }, { type: String, decorators: [{
                type: Inject,
                args: [LOCALE_ID]
            }] }]; }, { eventTitle: [{
            type: HostBinding,
            args: ['attr.aria-label']
        }], item: [{
            type: Input,
            args: ["kendoSchedulerAgendaTaskItem"]
        }], color: [{
            type: Input
        }], eventTemplate: [{
            type: Input
        }], editable: [{
            type: Input
        }] }); })();

/**
 * @hidden
 */
class AgendaListComponent {
    constructor(intlService, localization) {
        this.intlService = intlService;
        this.localization = localization;
        this.classes = true;
    }
    extractDataItem(item) {
        return item.type === "group" ? item.dataItem.items[0] : item.dataItem;
    }
    formatTime(dataItem) {
        if (dataItem.isAllDay) {
            return this.localization.get('allDay');
        }
        let format = "{0:t}-{1:t}";
        if (dataItem.head) {
            format = "{0:t}";
        }
        else if (dataItem.tail) {
            format = "{1:t}";
        }
        return this.intlService.format(format, toLocalDate(dataItem.start), toLocalDate(dataItem.end));
    }
    trackByFn(index, _item) {
        return index;
    }
    cellClasses(item) {
        const task = this.extractDataItem(item);
        let result = [];
        if (this.slotClass) {
            result = result.concat(convertNgClassBindings(this.slotClass({
                start: task.start,
                end: task.end,
                resources: task.resources,
                event: task.event
            })));
        }
        if (this.eventClass) {
            result = result.concat(convertNgClassBindings(this.eventClass({
                event: task.event,
                resources: task.resources
            })));
        }
        return result;
    }
    getEventStyles(item) {
        if (this.eventStyles) {
            const task = this.extractDataItem(item);
            return this.eventStyles({
                event: task.event,
                resources: task.resources
            });
        }
    }
}
AgendaListComponent.ɵfac = function AgendaListComponent_Factory(t) { return new (t || AgendaListComponent)(ɵngcc0.ɵɵdirectiveInject(ɵngcc3.IntlService), ɵngcc0.ɵɵdirectiveInject(ɵngcc2.LocalizationService)); };
AgendaListComponent.ɵcmp = ɵngcc0.ɵɵdefineComponent({ type: AgendaListComponent, selectors: [["", "kendoSchedulerAgendaList", ""]], hostVars: 2, hostBindings: function AgendaListComponent_HostBindings(rf, ctx) { if (rf & 2) {
        ɵngcc0.ɵɵclassProp("k-scheduler-content", ctx.classes);
    } }, inputs: { tasks: "tasks", eventTemplate: "eventTemplate", slotClass: "slotClass", eventClass: "eventClass", eventStyles: "eventStyles", agendaTimeTemplate: "agendaTimeTemplate", agendaDateTemplate: "agendaDateTemplate", editable: "editable" }, attrs: _c166, decls: 3, vars: 1, consts: [["role", "presentation", 1, "k-scheduler-table"], [4, "ngFor", "ngForOf"], [4, "ngFor", "ngForOf", "ngForTrackBy"], [3, "kendoSchedulerAgendaHeaderItem", "agendaDateTemplate", 4, "ngIf"], [1, "k-scheduler-timecolumn"], [4, "ngIf"], [3, "ngTemplateOutlet", "ngTemplateOutletContext", 4, "ngIf"], [3, "ngClass", "ngStyle", "kendoSchedulerFocusIndex", "kendoSchedulerAgendaTaskItem", "editable", "eventTemplate"], ["class", "k-scheduler-groupcolumn", 4, "ngIf"], [1, "k-scheduler-groupcolumn"], [3, "kendoSchedulerAgendaHeaderItem", "agendaDateTemplate"], ["class", "k-icon k-i-arrow-60-left", 4, "ngIf"], ["class", "k-icon k-i-arrow-60-right", 4, "ngIf"], [1, "k-icon", "k-i-arrow-60-left"], [1, "k-icon", "k-i-arrow-60-right"], [3, "ngTemplateOutlet", "ngTemplateOutletContext"]], template: function AgendaListComponent_Template(rf, ctx) { if (rf & 1) {
        ɵngcc0.ɵɵelementStart(0, "table", 0);
        ɵngcc0.ɵɵelementStart(1, "tbody");
        ɵngcc0.ɵɵtemplate(2, AgendaListComponent_ng_container_2_Template, 2, 2, "ng-container", 1);
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵelementEnd();
    } if (rf & 2) {
        ɵngcc0.ɵɵadvance(2);
        ɵngcc0.ɵɵproperty("ngForOf", ctx.tasks);
    } }, directives: [ɵngcc4.NgForOf, ɵngcc4.NgIf, ɵngcc4.NgClass, ɵngcc4.NgStyle, FocusableDirective,
        AgendaTaskItemComponent,
        AgendaHeaderItemComponent, ɵngcc4.NgTemplateOutlet], encapsulation: 2 });
/** @nocollapse */
AgendaListComponent.ctorParameters = () => [
    { type: IntlService },
    { type: LocalizationService }
];
AgendaListComponent.propDecorators = {
    classes: [{ type: HostBinding, args: ['class.k-scheduler-content',] }],
    tasks: [{ type: Input }],
    eventTemplate: [{ type: Input }],
    slotClass: [{ type: Input }],
    eventClass: [{ type: Input }],
    eventStyles: [{ type: Input }],
    agendaTimeTemplate: [{ type: Input }],
    agendaDateTemplate: [{ type: Input }],
    editable: [{ type: Input }]
};
/*@__PURE__*/ (function () { ɵngcc0.ɵsetClassMetadata(AgendaListComponent, [{
        type: Component,
        args: [{
                // tslint:disable-next-line:component-selector
                selector: '[kendoSchedulerAgendaList]',
                template: `
        <table class="k-scheduler-table" role="presentation">
            <tbody>
                <ng-container *ngFor="let group of tasks; let groupIndex = index;">
                    <tr *ngFor="let item of group.tasks;let index = index; trackBy: trackByFn">
                        <ng-container *ngFor="let resource of group.resources;let resourceIndex = index">
                            <td *ngIf="group.spans[resourceIndex] && index === 0" class="k-scheduler-groupcolumn" [attr.rowspan]="group.spans[resourceIndex]">
                                {{ resource }}
                            </td>
                        </ng-container>
                        <td *ngIf="item.type === 'group'"
                            [kendoSchedulerAgendaHeaderItem]="item"
                            [agendaDateTemplate]="agendaDateTemplate">
                        </td>
                        <td class="k-scheduler-timecolumn">
                            <div *ngIf="!agendaTimeTemplate">
                                <span class="k-icon k-i-arrow-60-left" *ngIf="extractDataItem(item).tail"></span>
                                {{formatTime(extractDataItem(item)) }}
                                <span class="k-icon k-i-arrow-60-right" *ngIf="extractDataItem(item).head"></span>
                            </div>
                            <ng-container *ngIf="agendaTimeTemplate" [ngTemplateOutlet]="agendaTimeTemplate"
                                [ngTemplateOutletContext]="extractDataItem(item)">
                            </ng-container>
                        </td>
                        <td [attr.data-group-index]="groupIndex" [attr.data-task-index]="index"
                            [ngClass]="cellClasses(item)" [ngStyle]="getEventStyles(item)"
                            [kendoSchedulerFocusIndex]="groupIndex"
                            [kendoSchedulerAgendaTaskItem]="extractDataItem(item)"
                                [editable]="editable"
                                [eventTemplate]="eventTemplate"
                        ></td>
                    </tr>
                </ng-container>
            </tbody>
        </table>
    `
            }]
    }], function () { return [{ type: ɵngcc3.IntlService }, { type: ɵngcc2.LocalizationService }]; }, { classes: [{
            type: HostBinding,
            args: ['class.k-scheduler-content']
        }], tasks: [{
            type: Input
        }], eventTemplate: [{
            type: Input
        }], slotClass: [{
            type: Input
        }], eventClass: [{
            type: Input
        }], eventStyles: [{
            type: Input
        }], agendaTimeTemplate: [{
            type: Input
        }], agendaDateTemplate: [{
            type: Input
        }], editable: [{
            type: Input
        }] }); })();

const flip = fn => a => b => fn(b, a);
const sort = flip(orderBy);
const group = flip(groupBy);
/**
 * @hidden
 */
const compose = (...args) => (data) => args.reduceRight((acc, curr) => curr(acc), data);
/**
 * @hidden
 */
const processEvents = (start, end) => compose(group([{ field: "startDate" }]), sort([{ field: "start", dir: "asc" }, { field: "end", dir: "asc" }]));
function* flattenGroups(groups) {
    for (let index = 0; index < groups.length; index++) {
        const groupItem = groups[index];
        yield {
            type: "group",
            dataItem: groupItem,
            rowSpan: groupItem.items.length
        };
        for (let itemIndex = 1; itemIndex < groupItem.items.length; itemIndex++) {
            const item = groupItem.items[itemIndex];
            yield {
                type: "event",
                dataItem: item
            };
        }
    }
}
/** @hidden */
class EmptyIterator {
    [iterator]() {
        return {
            next: () => ({ done: true, value: null })
        };
    }
    toString() {
        return "Empty Iterator";
    }
}
/**
 * @hidden
 */
class TaskCollection {
    constructor(start, end, events) {
        this.start = start;
        this.end = end;
        this.events = events;
        this.createIterator = compose(flattenGroups, processEvents(this.start, this.end));
    }
    static empty() {
        return (new EmptyIterator());
    }
    [iterator]() {
        return this.createIterator(this.events);
    }
    itemAt(index) {
        const taskIterator = this.createIterator(this.events);
        let idx = 0;
        let item;
        do {
            item = taskIterator.next();
            if (item && idx === index) {
                const value = item.value;
                return value.type === 'group' ? value.dataItem.items[0] : value.dataItem;
            }
            idx++;
        } while (item);
    }
    toString() {
        return this.events.toString();
    }
}

/**
 * @hidden
 */
function createResourceGroups(groupedResources) {
    let result = [];
    const firstResource = groupedResources[0];
    const firstResourceData = firstResource.data;
    for (let dataIdx = 0; dataIdx < firstResourceData.length; dataIdx++) {
        const item = firstResourceData[dataIdx];
        result.push({ resources: [getField(item, firstResource.textField)] });
    }
    for (let idx = 1; idx < groupedResources.length; idx++) {
        const resource = groupedResources[idx];
        const data = resource.data;
        const current = [];
        for (let resourceIdx = 0; resourceIdx < result.length; resourceIdx++) {
            const resourceItem = result[resourceIdx];
            for (let dataIdx = 0; dataIdx < data.length; dataIdx++) {
                const item = data[dataIdx];
                current.push({ resources: resourceItem.resources.concat(getField(item, resource.textField)) });
            }
        }
        result = current;
    }
    return result;
}
function createTask(item, resourceIdx, resources, color) {
    const event = item.event;
    return {
        event,
        start: item.start.toUTCDate(),
        end: item.end.toUTCDate(),
        title: event.title,
        isAllDay: event.isAllDay,
        color,
        resourceIdx,
        resources
    };
}
const durationInDays = ({ start, end, isAllDay = false }) => {
    const eventEnd = isAllDay ? getUTCDate(end) : end;
    const duration = Math.ceil((eventEnd - +getUTCDate(start)) / MS_PER_DAY);
    if (isAllDay) {
        return duration + 1;
    }
    return duration;
};
const curry = fn => {
    const len = fn.length;
    return (...args) => len === args.length
        ? fn.apply(null, args)
        : curry(fn.bind(null, ...args));
};
const range = num => Array.from(new Array(num).keys());
const cloneTask = (eventStart, eventEnd) => task => (Object.assign({}, task, { start: getUTCDate(eventStart), end: task.tail && !task.isAllDay ? eventEnd : addUTCDays(eventStart, 1), startDate: getUTCDate(eventStart) }));
const previousEventEnd = (start, events) => events.length
    ? events[events.length - 1].end
    : start;
const markAsTail = isLast => task => {
    if (isLast) {
        task.tail = true;
    }
    return task;
};
const markAsMid = task => {
    if (!task.tail) {
        task.mid = true;
    }
    return task;
};
const addTaskPart = (task, start) => (tasks, _, day, days) => tasks.concat(compose(markAsMid, cloneTask(previousEventEnd(start, tasks), task.end), markAsTail(day === days.length - 1))(task));
const splitMultiDayTask = (task, start) => range(durationInDays(task) - 1)
    .reduce(addTaskPart(task, start), []);
/**
 * @hidden
 */
const splitTasks = curry((periodStart, periodEnd, tasks) => {
    const result = [];
    for (let index = 0; index < tasks.length; index++) {
        let task = Object.assign({}, tasks[index]);
        task.startDate = getUTCDate(task.start);
        if (task.start >= periodStart && task.start <= periodEnd) {
            result.push(task);
        }
        if (durationInDays(task) > 1) {
            task.end = addUTCDays(task.startDate, 1);
            task.head = true;
            result.push(...splitMultiDayTask(Object.assign({}, tasks[index]), task.end)
                .filter(tsk => getUTCDate(tsk.end) <= periodEnd && tsk.start >= periodStart));
        }
    }
    return result;
});
function groupByResource(groupedResources, resourceGroups, dateRange) {
    const groups = resourceGroups.filter(group => group.tasks && group.tasks.length);
    if (!groups.length) {
        return [];
    }
    const values = groups[0].resources.map(resource => ({ value: resource, span: 0, groupIdx: 0 }));
    const periodStart = toUTCDate(dateRange.start);
    const periodEnd = toUTCDate(dateRange.end);
    for (let groupIdx = 0; groupIdx < groups.length; groupIdx++) {
        const group = groups[groupIdx];
        group.tasks = splitTasks(periodStart, periodEnd, group.tasks);
        const count = group.tasks.length;
        group.tasks = new TaskCollection(periodStart, periodEnd, group.tasks);
        let invalidate = false;
        for (let resourceIdx = 0; resourceIdx < groupedResources.length; resourceIdx++) {
            const resourceValue = values[resourceIdx];
            if (resourceValue.value !== group.resources[resourceIdx] || invalidate) {
                resourceValue.value = group.resources[resourceIdx];
                const spanGroup = groups[resourceValue.groupIdx];
                spanGroup.spans = spanGroup.spans || [];
                spanGroup.spans[resourceIdx] = resourceValue.span;
                resourceValue.span = count;
                resourceValue.groupIdx = groupIdx;
                invalidate = true;
            }
            else {
                resourceValue.span += count;
            }
        }
    }
    values.forEach((value, index) => {
        const group = groups[value.groupIdx];
        group.spans = group.spans || [];
        group.spans[index] = value.span;
    });
    return groups;
}
/**
 * @hidden
 */
function groupEvents(items, { taskResources, resourceGroups, spans, allResources, dateRange }) {
    const groups = resourceGroups || [{}];
    const periodStart = toUTCDate(dateRange.start);
    const periodEnd = toUTCDate(dateRange.end);
    for (let idx = 0; idx < items.length; idx++) {
        const item = items[idx];
        const event = item.event;
        if (!intersects(item.start.toUTCDate(), item.end.toUTCDate(), periodStart, periodEnd)) {
            continue;
        }
        const resources = eventResources(event, { taskResources, hasGroups: resourceGroups && resourceGroups.length > 0, spans, allResources });
        if (resources.length && resources[0].leafIdx >= 0) {
            for (let resourceIdx = 0; resourceIdx < resources.length; resourceIdx++) {
                const current = resources[resourceIdx];
                const task = createTask(item, current.leafIdx, current.resources, current.color);
                const tasks = groups[current.leafIdx].tasks = groups[current.leafIdx].tasks || [];
                tasks.push(task);
            }
        }
    }
    if (resourceGroups) {
        return groupByResource(taskResources, groups, dateRange);
    }
    groups[0].tasks = new TaskCollection(periodStart, periodEnd, splitTasks(periodStart, periodEnd, groups[0].tasks || []));
    return groups;
}

/**
 * @hidden
 */
class AgendaViewInternalComponent {
    constructor(viewContext, viewState, intl, renderer, element, zone, pdfService, localization) {
        this.viewContext = viewContext;
        this.viewState = viewState;
        this.intl = intl;
        this.renderer = renderer;
        this.element = element;
        this.zone = zone;
        this.pdfService = pdfService;
        this.localization = localization;
        this.tasks = new BehaviorSubject(null);
        this.groupedResources = [];
        this.spans = [];
        this.subs = new Subscription();
    }
    get eventTemplateRef() {
        return this.eventTemplate || (this.schedulerEventTemplate || {}).templateRef;
    }
    get agendaTimeTemplateRef() {
        return this.agendaTimeTemplate || (this.schedulerAgendaTimeTemplate || {}).templateRef;
    }
    get agendaDateTemplateRef() {
        return this.agendaDateTemplate || (this.schedulerAgendaDateTemplate || {}).templateRef;
    }
    ngOnInit() {
        this.updateContentHeight = this.updateContentHeight.bind(this);
        this.subs.add(this.viewContext.selectedDate.subscribe(this.onSelectDate.bind(this)));
        this.subs.add(this.viewContext.action.subscribe(this.onAction.bind(this)));
        this.subs.add(this.viewContext.execute.subscribe(this.execute.bind(this)));
        this.subs.add(this.viewContext.resize.subscribe(this.updateContentHeight));
        this.subs.add(combineLatest(this.viewContext.items, this.viewState.dateRange).pipe(map(([items, dateRange]) => {
            this.items = items;
            this.range = dateRange;
            return this.createEventGroups();
        }))
            .subscribe((tasks) => {
            this.tasks.next(tasks);
        }));
        this.subs.add(this.viewContext.optionsChange.subscribe(this.optionsChange.bind(this)));
        const onStable = () => this.zone.onStable.pipe(take(1));
        this.subs.add(combineLatest(this.tasks, this.localization.changes).pipe(switchMap(onStable))
            .subscribe(this.updateContentHeight));
        this.subs.add(this.pdfService.createElement.subscribe(this.createPDFElement.bind(this)));
    }
    ngOnChanges(changes) {
        if (anyChanged(['selectedDateFormat', 'selectedShortDateFormat', 'numberOfDays'], changes)) {
            this.viewState.notifyDateRange(this.dateRange(this.selectedDate));
        }
    }
    ngAfterViewInit() {
        if (!this.element) {
            return;
        }
        const contentElement = this.content.nativeElement;
        this.zone.runOutsideAngular(() => {
            this.subs.add(merge(fromEvent(contentElement, 'click'), fromEvent(contentElement, 'contextmenu'), fromEvent(contentElement, 'dblclick'))
                .subscribe(e => this.onClick(e)));
            this.subs.add(fromEvent(contentElement, 'keydown')
                .subscribe(e => this.onKeydown(e)));
        });
    }
    onClick(e) {
        const targetTask = this.targetTask(e.target);
        if (targetTask) {
            const { task, eventTarget } = targetTask;
            const eventType = e.type;
            const isSingle = eventType === 'click';
            const isDouble = eventType === 'dblclick';
            if (isSingle && closestInScope(e.target, node => hasClasses(node, 'k-event-delete'), eventTarget)) {
                this.viewState.emitEvent('remove', { event: task.event, dataItem: task.event.dataItem });
            }
            else {
                const name = isDouble ? 'eventDblClick' : 'eventClick';
                this.viewState.emitEvent(name, { type: eventType, event: task.event, originalEvent: e });
            }
        }
    }
    onKeydown(e) {
        const targetTask = this.targetTask(e.target);
        if (targetTask) {
            const task = targetTask.task;
            this.viewState.emitEvent('eventKeydown', { event: task.event, dataItem: task.event.dataItem, originalEvent: e });
        }
    }
    targetTask(target) {
        const eventTarget = closestInScope(target, node => node.hasAttribute('data-task-index'), this.element.nativeElement);
        if (eventTarget) {
            return {
                eventTarget,
                task: this.elementTask(eventTarget)
            };
        }
    }
    updateContentHeight() {
        const element = this.element.nativeElement;
        const parent = element.parentNode;
        const content = this.content.nativeElement;
        this.renderer.setStyle(content, 'height', '');
        let height = parent.clientHeight;
        for (let idx = 0; idx < parent.children.length; idx++) {
            const child = parent.children[idx];
            if (child !== element && !ignoreContentChild(child)) {
                height -= child.offsetHeight;
            }
        }
        const headerElement = this.headerWrap.nativeElement;
        height -= this.headerWrap ? headerElement.offsetHeight : 0;
        this.renderer.setStyle(content, 'height', `${height}px`);
        const rtl = this.localization.rtl;
        const padding = hasScrollbar(content, 'vertical') ? scrollbarWidth() : 0;
        this.renderer.setStyle(headerElement, !rtl ? 'padding-right' : 'padding-left', `${padding}px`);
        this.renderer.setStyle(headerElement, rtl ? 'padding-right' : 'padding-left', '0px');
        this.viewState.notifyLayoutEnd();
    }
    ngOnDestroy() {
        this.subs.unsubscribe();
    }
    optionsChange(changes) {
        this.group = changes.group;
        this.resources = changes.resources;
        this.groupResources();
        this.min = changes.min;
        this.max = changes.max;
        this.editable = changes.editable;
        if (this.items && this.items.length) {
            this.tasks.next(this.createEventGroups());
        }
        this.schedulerEventTemplate = changes.eventTemplate;
        this.schedulerAgendaTimeTemplate = changes.agendaTimeTemplate;
        this.schedulerAgendaDateTemplate = changes.agendaDateTemplate;
    }
    onSelectDate(date) {
        this.selectedDate = date;
        this.viewState.notifyDateRange(this.dateRange());
    }
    onAction(e) {
        const now = getDate(this.selectedDate);
        if (e.type === 'next') {
            const next = getDate(addDays(now, this.numberOfDays));
            if (this.isInRange(next)) {
                this.viewState.notifyNextDate(next);
            }
        }
        if (e.type === 'prev') {
            const next = getDate(addDays(now, -this.numberOfDays));
            if (this.isInRange(next)) {
                this.viewState.notifyNextDate(next);
            }
        }
    }
    createEventGroups() {
        const resourceGroups = this.groupedResources.length ? createResourceGroups(this.groupedResources) : null;
        const eventGroups = this.groups = groupEvents(this.items, {
            taskResources: this.taskResources,
            resourceGroups,
            allResources: this.resources,
            spans: this.spans,
            dateRange: this.range
        });
        return eventGroups;
    }
    dateRange(date = this.selectedDate) {
        const start = getDate(date);
        const end = getDate(addDays(start, this.numberOfDays));
        const rangeEnd = getDate(addDays(start, this.numberOfDays - 1));
        const text = this.intl.format(this.selectedDateFormat, start, rangeEnd);
        const shortText = this.intl.format(this.selectedShortDateFormat, start, rangeEnd);
        return { start, end, text, shortText };
    }
    groupResources() {
        const resources = this.resources || [];
        const group = this.group || {};
        const grouped = group.resources;
        const groupedResources = this.groupedResources = [];
        if (grouped && grouped.length) {
            for (let groupIdx = 0; groupIdx < grouped.length; groupIdx++) {
                const name = grouped[groupIdx];
                const resource = resources.find(item => item.name === name);
                if (resource) {
                    groupedResources.push(resource);
                }
            }
        }
        this.spans = this.resourceSpans();
    }
    resourceSpans() {
        const spans = [1];
        const resources = this.groupedResources;
        let span = 1;
        for (let idx = resources.length - 1; idx > 0; idx--) {
            span *= ((resources[idx].data || []).length || 1);
            spans.unshift(span);
        }
        return spans;
    }
    get taskResources() {
        if (this.groupedResources.length) {
            return this.groupedResources;
        }
        else if (this.resources && this.resources.length) {
            return [this.resources[0]];
        }
        else {
            return [{}];
        }
    }
    isInRange(date) {
        const dateRange = this.dateRange(date);
        return (!this.min || this.min < dateRange.end) && (!this.max || dateRange.start <= this.max);
    }
    createPDFElement() {
        const element = this.element.nativeElement.cloneNode(true);
        element.style.width = `${this.element.nativeElement.offsetWidth}px`;
        element.querySelector('.k-scheduler-content').style.height = 'auto';
        const header = element.querySelector('.k-scheduler-header');
        header.style.paddingRight = 0;
        header.style.paddingLeft = 0;
        this.pdfService.elementReady.emit({
            element: element
        });
    }
    elementTask(element) {
        const index = parseInt(element.getAttribute('data-task-index'), 10);
        const groupIndex = parseInt(element.getAttribute('data-group-index'), 10);
        const group = this.groups[groupIndex];
        const task = group.tasks.itemAt(index);
        return task;
    }
    execute(e) {
        if (e.name === 'slotByPosition') {
            const slot = this.slotByPosition(e.args);
            e.result(slot);
        }
        else if (e.name === 'eventFromElement') {
            const task = this.elementTask(e.args.element);
            if (task) {
                e.result(task.event);
            }
        }
    }
    slotByPosition({ x, y }) {
        const contentTable = this.content.nativeElement.querySelector('table');
        const offset = elementOffset(contentTable);
        if (offset.top <= y && y <= offset.top + offset.height) {
            const contentRows = contentTable.rows;
            if (!contentRows.length) {
                return;
            }
            const taskOffset = elementOffset(contentRows[0].cells[contentRows[0].cells.length - 1]);
            if (taskOffset.left <= x && x <= taskOffset.left + taskOffset.width) {
                for (let idx = 0; idx < contentRows.length; idx++) {
                    const row = contentRows[idx];
                    const rowOffset = elementOffset(row);
                    if (rowOffset.top <= y && y <= rowOffset.top + rowOffset.height) {
                        const element = row.querySelector('[data-task-index]');
                        const task = this.elementTask(element);
                        const event = task.event;
                        return {
                            element: new ElementRef(element),
                            start: event.start,
                            end: event.end,
                            event: event,
                            resources: task.resources,
                            isAllDay: task.isAllDay
                        };
                    }
                }
            }
        }
    }
}
AgendaViewInternalComponent.ɵfac = function AgendaViewInternalComponent_Factory(t) { return new (t || AgendaViewInternalComponent)(ɵngcc0.ɵɵdirectiveInject(ViewContextService), ɵngcc0.ɵɵdirectiveInject(ViewStateService), ɵngcc0.ɵɵdirectiveInject(ɵngcc3.IntlService), ɵngcc0.ɵɵdirectiveInject(ɵngcc0.Renderer2), ɵngcc0.ɵɵdirectiveInject(ɵngcc0.ElementRef), ɵngcc0.ɵɵdirectiveInject(ɵngcc0.NgZone), ɵngcc0.ɵɵdirectiveInject(PDFService), ɵngcc0.ɵɵdirectiveInject(ɵngcc2.LocalizationService)); };
AgendaViewInternalComponent.ɵcmp = ɵngcc0.ɵɵdefineComponent({ type: AgendaViewInternalComponent, selectors: [["agenda-view-internal"]], viewQuery: function AgendaViewInternalComponent_Query(rf, ctx) { if (rf & 1) {
        ɵngcc0.ɵɵviewQuery(_c167, true, ElementRef);
        ɵngcc0.ɵɵviewQuery(_c160, true, ElementRef);
    } if (rf & 2) {
        var _t;
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.headerWrap = _t.first);
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.content = _t.first);
    } }, inputs: { eventTemplate: "eventTemplate", slotClass: "slotClass", eventClass: "eventClass", eventStyles: "eventStyles", agendaTimeTemplate: "agendaTimeTemplate", agendaDateTemplate: "agendaDateTemplate", selectedDateFormat: "selectedDateFormat", selectedShortDateFormat: "selectedShortDateFormat", numberOfDays: "numberOfDays" }, features: [ɵngcc0.ɵɵNgOnChangesFeature], decls: 11, vars: 11, consts: [[1, "k-scheduler-layout", "k-scheduler-agendaview", "k-scheduler-agenda"], ["kendoSchedulerAgendaHeader", "", 3, "resources"], ["headerWrap", ""], ["kendoSchedulerAgendaList", "", 3, "editable", "eventTemplate", "slotClass", "eventClass", "eventStyles", "agendaTimeTemplate", "agendaDateTemplate", "tasks"], ["content", ""]], template: function AgendaViewInternalComponent_Template(rf, ctx) { if (rf & 1) {
        ɵngcc0.ɵɵelementStart(0, "table", 0);
        ɵngcc0.ɵɵelementStart(1, "tbody");
        ɵngcc0.ɵɵelementStart(2, "tr");
        ɵngcc0.ɵɵelementStart(3, "td");
        ɵngcc0.ɵɵelement(4, "div", 1, 2);
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵelementStart(6, "tr");
        ɵngcc0.ɵɵelementStart(7, "td");
        ɵngcc0.ɵɵelement(8, "div", 3, 4);
        ɵngcc0.ɵɵpipe(10, "async");
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵelementEnd();
    } if (rf & 2) {
        ɵngcc0.ɵɵadvance(4);
        ɵngcc0.ɵɵproperty("resources", ctx.groupedResources);
        ɵngcc0.ɵɵadvance(4);
        ɵngcc0.ɵɵproperty("editable", ctx.editable)("eventTemplate", ctx.eventTemplateRef)("slotClass", ctx.slotClass)("eventClass", ctx.eventClass)("eventStyles", ctx.eventStyles)("agendaTimeTemplate", ctx.agendaTimeTemplateRef)("agendaDateTemplate", ctx.agendaDateTemplateRef)("tasks", ɵngcc0.ɵɵpipeBind1(10, 9, ctx.tasks));
    } }, directives: [AgendaHeaderComponent,
        AgendaListComponent], pipes: [ɵngcc4.AsyncPipe], encapsulation: 2 });
/** @nocollapse */
AgendaViewInternalComponent.ctorParameters = () => [
    { type: ViewContextService },
    { type: ViewStateService },
    { type: IntlService },
    { type: Renderer2 },
    { type: ElementRef },
    { type: NgZone },
    { type: PDFService },
    { type: LocalizationService }
];
AgendaViewInternalComponent.propDecorators = {
    eventTemplate: [{ type: Input }],
    slotClass: [{ type: Input }],
    eventClass: [{ type: Input }],
    eventStyles: [{ type: Input }],
    agendaTimeTemplate: [{ type: Input }],
    agendaDateTemplate: [{ type: Input }],
    selectedDateFormat: [{ type: Input }],
    selectedShortDateFormat: [{ type: Input }],
    numberOfDays: [{ type: Input }],
    headerWrap: [{ type: ViewChild, args: ['headerWrap', { read: ElementRef },] }],
    content: [{ type: ViewChild, args: ['content', { read: ElementRef },] }]
};
/*@__PURE__*/ (function () { ɵngcc0.ɵsetClassMetadata(AgendaViewInternalComponent, [{
        type: Component,
        args: [{
                // tslint:disable-next-line:component-selector
                selector: 'agenda-view-internal',
                template: `
        <table class="k-scheduler-layout k-scheduler-agendaview k-scheduler-agenda">
            <tbody>
                <tr>
                    <td>
                        <div kendoSchedulerAgendaHeader [resources]="groupedResources" #headerWrap></div>
                    </td>
                </tr>
                <tr>
                    <td>
                        <div kendoSchedulerAgendaList #content
                            [editable]="editable"
                            [eventTemplate]="eventTemplateRef"
                            [slotClass]="slotClass"
                            [eventClass]="eventClass"
                            [eventStyles]="eventStyles"
                            [agendaTimeTemplate]="agendaTimeTemplateRef"
                            [agendaDateTemplate]="agendaDateTemplateRef"
                            [tasks]="tasks | async">
                        </div>
                    </td>
                </tr>
            </tbody>
        </table>
    `
            }]
    }], function () { return [{ type: ViewContextService }, { type: ViewStateService }, { type: ɵngcc3.IntlService }, { type: ɵngcc0.Renderer2 }, { type: ɵngcc0.ElementRef }, { type: ɵngcc0.NgZone }, { type: PDFService }, { type: ɵngcc2.LocalizationService }]; }, { eventTemplate: [{
            type: Input
        }], slotClass: [{
            type: Input
        }], eventClass: [{
            type: Input
        }], eventStyles: [{
            type: Input
        }], agendaTimeTemplate: [{
            type: Input
        }], agendaDateTemplate: [{
            type: Input
        }], selectedDateFormat: [{
            type: Input
        }], selectedShortDateFormat: [{
            type: Input
        }], numberOfDays: [{
            type: Input
        }], headerWrap: [{
            type: ViewChild,
            args: ['headerWrap', { read: ElementRef }]
        }], content: [{
            type: ViewChild,
            args: ['content', { read: ElementRef }]
        }] }); })();

/**
 * @hidden
 */
class SharedModule {
    static exports() {
        return [
            FocusableDirective
        ];
    }
}
SharedModule.ɵmod = ɵngcc0.ɵɵdefineNgModule({ type: SharedModule });
SharedModule.ɵinj = ɵngcc0.ɵɵdefineInjector({ factory: function SharedModule_Factory(t) { return new (t || SharedModule)(); } });
(function () { (typeof ngJitMode === "undefined" || ngJitMode) && ɵngcc0.ɵɵsetNgModuleScope(SharedModule, { declarations: [FocusableDirective], exports: [FocusableDirective] }); })();
/*@__PURE__*/ (function () { ɵngcc0.ɵsetClassMetadata(SharedModule, [{
        type: NgModule,
        args: [{
                declarations: [
                    FocusableDirective
                ],
                exports: [
                    FocusableDirective
                ]
            }]
    }], null, null); })();

const COMPONENTS = [
    AgendaHeaderComponent,
    AgendaHeaderItemComponent,
    AgendaListComponent,
    AgendaTaskItemComponent,
    AgendaViewComponent,
    AgendaViewInternalComponent
];
/**
 * @hidden
 */
class AgendaViewModule {
}
AgendaViewModule.ɵmod = ɵngcc0.ɵɵdefineNgModule({ type: AgendaViewModule });
AgendaViewModule.ɵinj = ɵngcc0.ɵɵdefineInjector({ factory: function AgendaViewModule_Factory(t) { return new (t || AgendaViewModule)(); }, imports: [[CommonModule, IntlModule, SharedModule]] });
(function () { (typeof ngJitMode === "undefined" || ngJitMode) && ɵngcc0.ɵɵsetNgModuleScope(AgendaViewModule, { declarations: function () { return [AgendaHeaderComponent,
        AgendaHeaderItemComponent,
        AgendaListComponent,
        AgendaTaskItemComponent,
        AgendaViewComponent,
        AgendaViewInternalComponent]; }, imports: function () { return [CommonModule, IntlModule,
        SharedModule]; }, exports: function () { return [AgendaViewComponent]; } }); })();
/*@__PURE__*/ (function () { ɵngcc0.ɵsetClassMetadata(AgendaViewModule, [{
        type: NgModule,
        args: [{
                imports: [CommonModule, IntlModule, SharedModule],
                exports: [AgendaViewComponent],
                declarations: [COMPONENTS]
            }]
    }], null, null); })();

/**
 * @hidden
 */
class ItemMap {
    constructor() {
        this.count = 0;
        this.items = {};
    }
    get first() {
        if (this.count > 0) {
            return this.items[Object.keys(this.items)[0]];
        }
    }
    get last() {
        if (this.count > 0) {
            const keys = Object.keys(this.items);
            return this.items[keys[keys.length - 1]];
        }
    }
    addItem(index, item) {
        if (!this.items[index]) {
            this.count++;
        }
        this.items[index] = item;
    }
    removeItem(index, item) {
        const current = this.items[index];
        if (current === item) {
            delete this.items[index];
            this.count--;
        }
    }
    toArray() {
        return Object.keys(this.items).map(index => this.items[index]);
    }
}

/**
 * @hidden
 */
class BaseSlotService {
    constructor() {
        this.containerSize = 0;
        this.slotsChange = new EventEmitter();
        this.groups = [];
    }
    registerItem(component) {
        const group = this.itemGroup(component);
        group.registerItem(component);
    }
    unregisterItem(component, id) {
        id = id || {
            index: component.index,
            resourceIndex: component.resourceIndex,
            rangeIndex: component.rangeIndex
        };
        const group = this.groups[id.resourceIndex];
        if (group) {
            group.unregisterItem(component, id);
        }
    }
    registerSlot(slot) {
        const group = this.slotGroup(slot);
        group.registerSlot(slot);
    }
    unregisterSlot(slot) {
        const group = this.groups[slot.id.resourceIndex];
        if (group) {
            group.unregisterSlot(slot);
        }
    }
    invalidate() {
        this.clearEmptyGroups();
        this.cleanRanges();
        this.slotsChange.emit();
        this.forEachSlot(slot => {
            slot.invalidate();
        });
    }
    cleanRanges() {
        this.groups.forEach(group => {
            group.cleanRanges();
        });
    }
    clearEmptyGroups() {
        const groups = this.groups;
        let index = this.groups.length - 1;
        while (index > 0 && !groups[index].hasSlots) {
            groups.splice(index, 1);
            index--;
        }
    }
    itemGroup(item) {
        const index = item.resourceIndex;
        if (!this.groups[index]) {
            this.groups[index] = this.createGroup(index);
        }
        return this.groups[index];
    }
    slotGroup(slot) {
        const index = slot.id.resourceIndex;
        if (!this.groups[index]) {
            this.groups[index] = this.createGroup(index);
        }
        return this.groups[index];
    }
}

/** @hidden */
const MIDNIGHT_INVARIANT = new Date(1980, 0, 1);
/** @hidden */
const INVARIANT_END = new Date(1980, 0, 2);
/** @hidden */
const MS_PER_SECOND = 1000;
/** @hidden */
const MS_PER_MINUTE = 60 * MS_PER_SECOND;
//probably should calculate this
/** @hidden */
const BORDER_WIDTH = 1;
/** @hidden */
const DEFAULT_EVENT_HEIGHT = 25;

//better try to measure this one
const MORE_BUTTON_HEIGHT = 13;
const EVENT_OFFSET = 2;
/**
 * @hidden
 */
class SlotRange {
    constructor(index) {
        this.index = index;
        this.slotMap = new ItemMap();
        this.itemMap = new ItemMap();
    }
    get slots() {
        return this.slotMap.toArray();
    }
    get items() {
        return this.itemMap.toArray();
    }
    get start() {
        const first = this.slotMap.first;
        if (!first) {
            return null;
        }
        return first.start;
    }
    get end() {
        const last = this.slotMap.last;
        if (!last) {
            return null;
        }
        return addUTCDays(last.end, 1);
    }
    get hasSlots() {
        return this.slotMap.count > 0;
    }
    get hasItems() {
        return this.itemMap.count > 0;
    }
    get firstSlot() {
        return this.slotMap.first;
    }
    get lastSlot() {
        return this.slotMap.last;
    }
    get rect() {
        const first = this.firstSlot.rect;
        const last = this.lastSlot.rect;
        return {
            left: first.left,
            top: first.top,
            width: last.left - first.left + last.width,
            height: last.top - first.top + last.height
        };
    }
    registerItem(component) {
        this.itemMap.addItem(component.item.index, component);
    }
    unregisterItem(component, index) {
        this.itemMap.removeItem(index, component);
    }
    registerSlot(slot) {
        this.slotMap.addItem(slot.id.index, slot);
    }
    unregisterSlot(slot) {
        this.slotMap.removeItem(slot.id.index, slot);
    }
    layout(eventHeight) {
        if (!this.hasItems) {
            return;
        }
        const items = this.items;
        const sorted = orderBy(items, [{ field: "item.startTime", dir: "asc" }, { field: "item.endTime", dir: "desc" }]);
        const slotItems = {};
        const slots = this.slots;
        sorted.forEach(event => slots
            .filter(slot => intersects(event.item.startTime, event.item.endTime, slot.start, slot.end))
            .forEach(slot => {
            const value = slotItems[slot.key] = slotItems[slot.key] || { events: [], height: slot.linkHeight };
            value.slot = slot;
            const rect = slot.rect;
            const data = event.item.data[event.resourceIndex];
            data.rowIndex = findRowIndex(value.events, data);
            if (value.height + eventHeight + EVENT_OFFSET + MORE_BUTTON_HEIGHT > rect.height || data.hidden) {
                data.hidden = true;
                slot.showMore({ width: rect.width, left: rect.left, top: rect.top + slot.linkHeight + ((data.rowIndex) * (eventHeight + EVENT_OFFSET)) });
            }
            else {
                value.events[data.rowIndex] = event;
                if (!event.rect) {
                    event.rect = {
                        top: rect.top + slot.linkHeight + (data.rowIndex * (eventHeight + EVENT_OFFSET)),
                        left: rect.left,
                        height: eventHeight,
                        width: 0
                    };
                }
                event.rect.width += rect.width + BORDER_WIDTH;
                value.height += eventHeight + EVENT_OFFSET;
            }
        }));
        sorted.forEach(event => {
            if (event.rect) {
                event.rect.width -= BORDER_WIDTH;
            }
            event.reflow();
        });
    }
}
/**
 * @hidden
 */
class MonthResourceGroup {
    constructor(index) {
        this.index = index;
        this.dayRanges = [];
    }
    get hasSlots() {
        return Boolean(this.dayRanges.find(range => range && range.hasSlots));
    }
    registerSlot(slot) {
        const range = this.slotRange(slot);
        range.registerSlot(slot);
    }
    unregisterSlot(slot) {
        const range = this.dayRanges[slot.id.rangeIndex];
        range.unregisterSlot(slot);
        if (!range.hasSlots) {
            delete this.dayRanges[slot.id.rangeIndex];
        }
    }
    registerItem(component) {
        const range = this.dayRanges[component.rangeIndex];
        range.registerItem(component);
    }
    unregisterItem(component, id) {
        const range = this.dayRanges[id.rangeIndex];
        if (range) {
            range.unregisterItem(component, id.index);
        }
    }
    slotRange(slot) {
        const ranges = this.dayRanges;
        const rangeIndex = slot.id.rangeIndex;
        if (!ranges[rangeIndex]) {
            ranges[rangeIndex] = new SlotRange(rangeIndex);
        }
        return ranges[rangeIndex];
    }
    forEachRange(callback) {
        for (let i = 0; i < this.dayRanges.length; i++) {
            callback(this.dayRanges[i]);
        }
    }
    cleanRanges() {
        this.dayRanges = this.dayRanges.filter(r => Boolean(r));
    }
}
/**
 * @hidden
 */
class MonthSlotService extends BaseSlotService {
    layout(eventHeight) {
        this.groups.forEach((group) => group.forEachRange(range => range.layout(eventHeight)));
    }
    slotByIndex(slotIndex) {
        const [resourceIndex, rangeIndex, index] = slotIndex.split(':').map(part => parseInt(part, 10));
        return this.groups[resourceIndex].dayRanges[rangeIndex].slots[index];
    }
    forEachSlot(callback) {
        this.groups.forEach((group) => {
            group.dayRanges.forEach(range => {
                range.slots.forEach(slot => callback(slot));
            });
        });
    }
    forEachItem(callback) {
        this.groups.forEach((group) => {
            group.dayRanges.forEach(range => {
                range.items.forEach(viewItem => callback(viewItem));
            });
        });
    }
    createGroup(index) {
        return new MonthResourceGroup(index);
    }
    invalidate() {
        super.invalidate();
        this.forEachItem((viewItem) => {
            const data = viewItem.item.data;
            Object.keys(data).forEach(resourceIndex => {
                data[resourceIndex].hidden = false;
            });
        });
    }
    slotByPosition(x, y) {
        let range;
        this.groups.find((group) => {
            range = group.dayRanges.find(r => rectContains(r.rect, x, y));
            return range;
        });
        if (range) {
            return range.slots.find(slot => rectContains(slot.rect, x, y));
        }
    }
    dragRanges(currentSlot, offset) {
        const start = new Date(currentSlot.start.getTime() - offset.start);
        const end = new Date(currentSlot.start.getTime() + offset.end);
        const group = this.groups[currentSlot.id.resourceIndex];
        const ranges = [];
        group.dayRanges.forEach(range => {
            const slots = range.slots.filter(s => intersects(start, end, s.start, s.end));
            if (slots.length) {
                ranges.push(slots);
            }
        });
        return {
            start,
            end,
            ranges
        };
    }
    groupSlotByPosition(currentSlot, x, y) {
        const range = this.groups[currentSlot.id.resourceIndex].dayRanges.find(r => rectContains(r.rect, x, y));
        if (range) {
            return range.slots.find(slot => rectContains(slot.rect, x, y));
        }
    }
    resizeRanges(currentSlot, task, resizeStart, offset) {
        const group = this.groups[task.resources[0].leafIdx];
        const ranges = [];
        const startDate = task.start.toUTCDate();
        const endDate = task.end.toUTCDate();
        let start, end;
        if (resizeStart) {
            start = currentSlot.start.getTime() + offset.start;
            if (start > endDate.getTime()) {
                start = new Date(Math.min(dateWithTime(endDate, startDate).getTime(), endDate.getTime()));
            }
            end = endDate;
        }
        else {
            start = startDate;
            end = currentSlot.start.getTime() + offset.end;
            if (end < start.getTime()) {
                end = new Date(Math.max(dateWithTime(startDate, endDate).getTime(), start.getTime()));
            }
        }
        group.dayRanges.forEach(range => {
            const slots = range.slots.filter(s => intersects(start, end, s.start, s.end));
            if (slots.length) {
                ranges.push(slots);
            }
        });
        return {
            start: new Date(start),
            end: new Date(end),
            ranges: ranges
        };
    }
}
MonthSlotService.ɵfac = function MonthSlotService_Factory(t) { return ɵMonthSlotService_BaseFactory(t || MonthSlotService); };
MonthSlotService.ɵprov = ɵngcc0.ɵɵdefineInjectable({ token: MonthSlotService, factory: MonthSlotService.ɵfac });
const ɵMonthSlotService_BaseFactory = ɵngcc0.ɵɵgetInheritedFactory(MonthSlotService);

/**
 * @hidden
 */
class BaseViewItem {
    constructor(slotService, localization, focusService, element, renderer, localeId) {
        this.slotService = slotService;
        this.localization = localization;
        this.focusService = focusService;
        this.element = element;
        this.renderer = renderer;
        this.localeId = localeId;
        this.className = true;
        this.subs = new Subscription();
    }
    get taskIndex() {
        return this.item.index;
    }
    get touchAction() {
        return this.editable && this.editable.drag !== false ? 'none' : null;
    }
    get eventTitle() {
        const startTime = toLocalDate(this.item.startTime);
        const endTime = toLocalDate(this.item.endTime);
        const time = formatEventTime(startTime, endTime, this.item.isAllDay, this.localeId);
        return `${time}, ${this.item.event.title}`;
    }
    get deleteMessage() {
        return this.localization.get('deleteTitle');
    }
    get resizable() {
        return this.editable && this.editable.resize !== false;
    }
    get removable() {
        return this.editable && this.editable.remove !== false;
    }
    get isRecurrence() {
        return isRecurrence(this.item);
    }
    get isRecurrenceException() {
        return isRecurrenceException(this.item);
    }
    get nativeElement() {
        if (this.element) {
            return this.element.nativeElement;
        }
    }
    setStyles(styles) {
        const element = this.nativeElement;
        if (element) {
            for (let name in styles) {
                if (styles.hasOwnProperty(name)) {
                    this.renderer.setStyle(element, name, styles[name]);
                }
            }
        }
    }
    toggle(visible) {
        this.setStyles({ display: visible ? 'block' : 'none' });
    }
    reflow() {
        const rect = this.rect;
        if (rect) {
            this.setStyles({
                left: !this.localization.rtl ? `${rect.left}px` : '',
                right: this.localization.rtl ? `${rect.left}px` : '',
                top: `${rect.top}px`,
                width: `${rect.width}px`,
                height: `${rect.height}px`,
                display: 'block'
            });
        }
    }
    ngOnInit() {
        if (this.dragHint) {
            return;
        }
        this.subs.add(this.slotService.slotsChange.subscribe(() => {
            this.rect = null;
            this.setStyles({
                display: 'none',
                width: 0,
                left: 0
            });
            const slotId = { index: this.index, resourceIndex: this.resourceIndex, rangeIndex: this.rangeIndex };
            this.slotService.unregisterItem(this, slotId);
            if (this.resourceIndex >= 0) {
                this.slotService.registerItem(this);
            }
        }));
    }
    ngOnChanges(changes) {
        if (this.dragHint) {
            return;
        }
        if (anyChanged(['index', 'resourceIndex', 'rangeIndex'], changes)) {
            const { resourceIndex, index, rangeIndex } = changes;
            const previousResourceIndex = resourceIndex ? resourceIndex.previousValue : this.resourceIndex;
            const previousIndex = index ? index.previousValue : this.index;
            const previousRangeIndex = rangeIndex ? rangeIndex.previousValue : this.rangeIndex;
            const slotId = {
                index: previousIndex,
                resourceIndex: previousResourceIndex,
                rangeIndex: previousRangeIndex
            };
            this.slotService.unregisterItem(this, slotId);
            if (this.resourceIndex >= 0) {
                this.slotService.registerItem(this);
                this.toggle(true);
            }
            else {
                this.toggle(false);
            }
        }
    }
    ngOnDestroy() {
        if (this.dragHint) {
            return;
        }
        this.slotService.unregisterItem(this);
        this.subs.unsubscribe();
    }
}
BaseViewItem.ɵfac = function BaseViewItem_Factory(t) { ɵngcc0.ɵɵinvalidFactory(); };
BaseViewItem.ɵdir = ɵngcc0.ɵɵdefineDirective({ type: BaseViewItem, hostVars: 6, hostBindings: function BaseViewItem_HostBindings(rf, ctx) { if (rf & 2) {
        ɵngcc0.ɵɵattribute("data-task-index", ctx.taskIndex)("aria-label", ctx.eventTitle);
        ɵngcc0.ɵɵstyleProp("touch-action", ctx.touchAction);
        ɵngcc0.ɵɵclassProp("k-event", ctx.className);
    } }, inputs: { item: "item", resourceIndex: "resourceIndex", rangeIndex: "rangeIndex", index: "index", eventTemplate: "eventTemplate", editable: "editable", dragHint: "dragHint", resources: "resources" }, features: [ɵngcc0.ɵɵNgOnChangesFeature] });
BaseViewItem.propDecorators = {
    item: [{ type: Input }],
    resourceIndex: [{ type: Input }],
    rangeIndex: [{ type: Input }],
    index: [{ type: Input }],
    eventTemplate: [{ type: Input }],
    editable: [{ type: Input }],
    dragHint: [{ type: Input }],
    resources: [{ type: Input }],
    className: [{ type: HostBinding, args: ['class.k-event',] }],
    taskIndex: [{ type: HostBinding, args: ['attr.data-task-index',] }],
    touchAction: [{ type: HostBinding, args: ['style.touch-action',] }],
    eventTitle: [{ type: HostBinding, args: ['attr.aria-label',] }]
};


/**
 * @hidden
 */
class MonthViewItemComponent extends BaseViewItem {
    constructor(slotService, localization, focusService, element, renderer, localeId) {
        super(slotService, localization, focusService, element, renderer, localeId);
        this.localeId = localeId;
    }
    reflow() {
        if (this.item.data[this.resourceIndex].hidden) {
            this.toggle(false);
            return;
        }
        super.reflow();
    }
}
MonthViewItemComponent.ɵfac = function MonthViewItemComponent_Factory(t) { return new (t || MonthViewItemComponent)(ɵngcc0.ɵɵdirectiveInject(MonthSlotService), ɵngcc0.ɵɵdirectiveInject(ɵngcc2.LocalizationService), ɵngcc0.ɵɵdirectiveInject(FocusService), ɵngcc0.ɵɵdirectiveInject(ɵngcc0.ElementRef), ɵngcc0.ɵɵdirectiveInject(ɵngcc0.Renderer2), ɵngcc0.ɵɵdirectiveInject(LOCALE_ID)); };
MonthViewItemComponent.ɵcmp = ɵngcc0.ɵɵdefineComponent({ type: MonthViewItemComponent, selectors: [["", "monthViewItem", ""]], features: [ɵngcc0.ɵɵInheritDefinitionFeature], attrs: _c168, decls: 10, vars: 8, consts: [[1, "k-event-actions"], ["class", "k-icon k-i-arrow-60-left", 4, "ngIf"], ["class", "k-icon k-i-reload", 4, "ngIf"], ["class", "k-icon k-i-non-recurrence", 4, "ngIf"], [3, "ngTemplateOutlet", "ngTemplateOutletContext", 4, "ngIf"], [4, "ngIf"], ["class", "k-link k-event-delete", "aria-hidden", "true", 4, "ngIf"], ["class", "k-icon k-i-arrow-60-right", 4, "ngIf"], [1, "k-icon", "k-i-arrow-60-left"], [1, "k-icon", "k-i-reload"], [1, "k-icon", "k-i-non-recurrence"], [3, "ngTemplateOutlet", "ngTemplateOutletContext"], [1, "k-event-template"], ["aria-hidden", "true", 1, "k-link", "k-event-delete"], [1, "k-icon", "k-i-close"], [1, "k-icon", "k-i-arrow-60-right"], [1, "k-resize-handle", "k-resize-w"], [1, "k-resize-handle", "k-resize-e"]], template: function MonthViewItemComponent_Template(rf, ctx) { if (rf & 1) {
        ɵngcc0.ɵɵelementStart(0, "span", 0);
        ɵngcc0.ɵɵtemplate(1, MonthViewItemComponent_span_1_Template, 1, 0, "span", 1);
        ɵngcc0.ɵɵtemplate(2, MonthViewItemComponent_span_2_Template, 1, 0, "span", 2);
        ɵngcc0.ɵɵtemplate(3, MonthViewItemComponent_span_3_Template, 1, 0, "span", 3);
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵtemplate(4, MonthViewItemComponent_ng_container_4_Template, 1, 6, "ng-container", 4);
        ɵngcc0.ɵɵtemplate(5, MonthViewItemComponent_div_5_Template, 3, 2, "div", 5);
        ɵngcc0.ɵɵelementStart(6, "span", 0);
        ɵngcc0.ɵɵtemplate(7, MonthViewItemComponent_span_7_Template, 2, 1, "span", 6);
        ɵngcc0.ɵɵtemplate(8, MonthViewItemComponent_span_8_Template, 1, 0, "span", 7);
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵtemplate(9, MonthViewItemComponent_ng_container_9_Template, 3, 0, "ng-container", 5);
    } if (rf & 2) {
        ɵngcc0.ɵɵadvance(1);
        ɵngcc0.ɵɵproperty("ngIf", ctx.item.tail);
        ɵngcc0.ɵɵadvance(1);
        ɵngcc0.ɵɵproperty("ngIf", ctx.isRecurrence);
        ɵngcc0.ɵɵadvance(1);
        ɵngcc0.ɵɵproperty("ngIf", ctx.isRecurrenceException);
        ɵngcc0.ɵɵadvance(1);
        ɵngcc0.ɵɵproperty("ngIf", ctx.eventTemplate);
        ɵngcc0.ɵɵadvance(1);
        ɵngcc0.ɵɵproperty("ngIf", !ctx.eventTemplate);
        ɵngcc0.ɵɵadvance(2);
        ɵngcc0.ɵɵproperty("ngIf", ctx.removable);
        ɵngcc0.ɵɵadvance(1);
        ɵngcc0.ɵɵproperty("ngIf", ctx.item.head);
        ɵngcc0.ɵɵadvance(1);
        ɵngcc0.ɵɵproperty("ngIf", ctx.resizable);
    } }, directives: [ɵngcc4.NgIf, ɵngcc4.NgTemplateOutlet], encapsulation: 2 });
/** @nocollapse */
MonthViewItemComponent.ctorParameters = () => [
    { type: MonthSlotService },
    { type: LocalizationService },
    { type: FocusService },
    { type: ElementRef },
    { type: Renderer2 },
    { type: String, decorators: [{ type: Inject, args: [LOCALE_ID,] }] }
];
/*@__PURE__*/ (function () { ɵngcc0.ɵsetClassMetadata(MonthViewItemComponent, [{
        type: Component,
        args: [{
                // tslint:disable-next-line:component-selector
                selector: '[monthViewItem]',
                template: `
        <span class="k-event-actions">
            <span class="k-icon k-i-arrow-60-left" *ngIf="item.tail"></span>
            <span class="k-icon k-i-reload" *ngIf="isRecurrence"></span>
            <span class="k-icon k-i-non-recurrence" *ngIf="isRecurrenceException"></span>
        </span>
        <ng-container *ngIf="eventTemplate" [ngTemplateOutlet]="eventTemplate"
            [ngTemplateOutletContext]="{ $implicit: item.event, event: item.event, resources: resources }">
        </ng-container>
        <div *ngIf="!eventTemplate" [attr.title]="eventTitle">
            <div class="k-event-template">{{ item.event.title }}</div>
        </div>

        <span class="k-event-actions">
            <span *ngIf="removable" class="k-link k-event-delete" aria-hidden="true" [attr.title]="deleteMessage">
                <span class="k-icon k-i-close"></span>
            </span>
            <span class="k-icon k-i-arrow-60-right" *ngIf="item.head"></span>
        </span>

        <ng-container *ngIf="resizable">
            <span class="k-resize-handle k-resize-w"></span>
            <span class="k-resize-handle k-resize-e"></span>
        </ng-container>
    `
            }]
    }], function () { return [{ type: MonthSlotService }, { type: ɵngcc2.LocalizationService }, { type: FocusService }, { type: ɵngcc0.ElementRef }, { type: ɵngcc0.Renderer2 }, { type: String, decorators: [{
                type: Inject,
                args: [LOCALE_ID]
            }] }]; }, null); })();

/**
 * The component for rendering the **Month** view.
 */
class MonthViewComponent extends ConfigurationViewBase {
    constructor(localization, changeDetector, viewContext, viewState) {
        super(localization, changeDetector, viewContext, viewState);
        /**
         * The long-date format for displaying the
         * selected date in the Scheduler toolbar.
         * Defaults to `{0:Y}`
         * ([more information]({% slug parsingandformatting_intl %}#toc-date-formatting)).
         */
        this.selectedDateFormat = '{0:Y}';
        /**
         * The short-date format for displaying the
         * selected date in the Scheduler toolbar.
         * Defaults to `{0:y}`
         * ([more information]({% slug parsingandformatting_intl %}#toc-date-formatting.
         */
        this.selectedShortDateFormat = '{0:y}';
        /**
         * The invariant name for this view (`month`).
         */
        this.name = 'month';
    }
    /**
     * @hidden
     */
    get title() {
        return this.localization.get('monthViewTitle');
    }
    get viewEventHeight() {
        return isPresent(this.eventHeight) ? this.eventHeight : (this.schedulerOptions.eventHeight || DEFAULT_EVENT_HEIGHT);
    }
}
MonthViewComponent.ɵfac = function MonthViewComponent_Factory(t) { return new (t || MonthViewComponent)(ɵngcc0.ɵɵdirectiveInject(ɵngcc2.LocalizationService), ɵngcc0.ɵɵdirectiveInject(ɵngcc0.ChangeDetectorRef), ɵngcc0.ɵɵdirectiveInject(ViewContextService), ɵngcc0.ɵɵdirectiveInject(ViewStateService)); };
MonthViewComponent.ɵcmp = ɵngcc0.ɵɵdefineComponent({ type: MonthViewComponent, selectors: [["kendo-scheduler-month-view"]], contentQueries: function MonthViewComponent_ContentQueries(rf, ctx, dirIndex) { if (rf & 1) {
        ɵngcc0.ɵɵcontentQuery(dirIndex, MonthDaySlotTemplateDirective, true);
    } if (rf & 2) {
        var _t;
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.monthDaySlotTemplate = _t.first);
    } }, inputs: { selectedDateFormat: "selectedDateFormat", selectedShortDateFormat: "selectedShortDateFormat", eventHeight: "eventHeight" }, features: [ɵngcc0.ɵɵProvidersFeature([{
                provide: SchedulerView,
                // tslint:disable-next-line:no-forward-ref
                useExisting: forwardRef(() => MonthViewComponent)
            }]), ɵngcc0.ɵɵInheritDefinitionFeature], decls: 2, vars: 0, consts: [["content", ""], [3, "eventHeight", "\u0435ventTemplate", "slotClass", "eventClass", "eventStyles", "groupHeaderTemplate", "monthDaySlotTemplate", "selectedDateFormat", "selectedShortDateFormat"]], template: function MonthViewComponent_Template(rf, ctx) { if (rf & 1) {
        ɵngcc0.ɵɵtemplate(0, MonthViewComponent_ng_template_0_Template, 1, 9, "ng-template", null, 0, ɵngcc0.ɵɵtemplateRefExtractor);
    } }, directives: function () { return [MonthViewRendererComponent]; }, encapsulation: 2, changeDetection: 0 });
/** @nocollapse */
MonthViewComponent.ctorParameters = () => [
    { type: LocalizationService },
    { type: ChangeDetectorRef },
    { type: ViewContextService },
    { type: ViewStateService }
];
MonthViewComponent.propDecorators = {
    eventHeight: [{ type: Input }],
    selectedDateFormat: [{ type: Input }],
    selectedShortDateFormat: [{ type: Input }],
    monthDaySlotTemplate: [{ type: ContentChild, args: [MonthDaySlotTemplateDirective,] }]
};
/*@__PURE__*/ (function () { ɵngcc0.ɵsetClassMetadata(MonthViewComponent, [{
        type: Component,
        args: [{
                changeDetection: ChangeDetectionStrategy.OnPush,
                selector: 'kendo-scheduler-month-view',
                providers: [{
                        provide: SchedulerView,
                        // tslint:disable-next-line:no-forward-ref
                        useExisting: forwardRef(() => MonthViewComponent)
                    }],
                template: `
        <ng-template #content>
            <month-view
                [eventHeight]="viewEventHeight"
                [еventTemplate]="eventTemplate?.templateRef"
                [slotClass]="viewSlotClass"
                [eventClass]="viewEventClass"
                [eventStyles]="viewEventStyles"
                [groupHeaderTemplate]="groupHeaderTemplate?.templateRef"
                [monthDaySlotTemplate]="monthDaySlotTemplate?.templateRef"
                [selectedDateFormat]="selectedDateFormat"
                [selectedShortDateFormat]="selectedShortDateFormat">
            </month-view>
        </ng-template>
    `
            }]
    }], function () { return [{ type: ɵngcc2.LocalizationService }, { type: ɵngcc0.ChangeDetectorRef }, { type: ViewContextService }, { type: ViewStateService }]; }, { selectedDateFormat: [{
            type: Input
        }], selectedShortDateFormat: [{
            type: Input
        }], eventHeight: [{
            type: Input
        }], monthDaySlotTemplate: [{
            type: ContentChild,
            args: [MonthDaySlotTemplateDirective]
        }] }); })();

const last = (arr) => arr[arr.length - 1];
/**
 * @hidden
 */
const createTasks = (periodStart, periodEnd, items, ranges) => {
    const tasks = [];
    const utcStart = toUTCDate(periodStart);
    const utcEnd = toUTCDate(periodEnd);
    for (let index = 0; index < items.length; index++) {
        const item = items[index];
        const data = {};
        const startTime = item.start.toUTCDate();
        const end = item.end;
        const endTime = (item.end.getTime() !== end.getTime() ? end.addDays(1) : end).toUTCDate();
        if (intersects(startTime, endTime, utcStart, utcEnd)) {
            for (let rangeIdx = 0; rangeIdx < ranges.length; rangeIdx++) {
                const range = ranges[rangeIdx];
                const rangeStart = toUTCDate(range[0]);
                const rangeEnd = addUTCDays(toUTCDate(last(range)), 1);
                if (intersects(startTime, endTime, rangeStart, rangeEnd)) {
                    const task = {
                        index,
                        startTime,
                        endTime,
                        start: item.start,
                        end: item.end,
                        event: item.event,
                        isAllDay: item.event.isAllDay,
                        rangeIndex: rangeIdx,
                        data: data
                    };
                    tasks.push(task);
                    task.head = task.endTime > rangeEnd;
                    task.tail = task.startTime < rangeStart;
                }
            }
        }
    }
    return sortTasksByTime(tasks);
};
function clearTaskData(task) {
    const data = task.data;
    for (let key in data) {
        if (data.hasOwnProperty(key)) {
            delete data[key];
        }
    }
}
/**
 * @hidden
 */
function updateTaskData(tasks) {
    for (let idx = 0; idx < tasks.length; idx++) {
        const task = tasks[idx];
        const resources = task.resources;
        clearTaskData(task);
        for (let resourceIdx = 0; resourceIdx < resources.length; resourceIdx++) {
            task.data[resources[resourceIdx].leafIdx] = {};
        }
    }
}

/**
 * @hidden
 */
class HintContainerComponent {
    constructor(changeDetector) {
        this.changeDetector = changeDetector;
        this.changeDetector.detach();
    }
    detectChanges() {
        this.changeDetector.detectChanges();
    }
}
HintContainerComponent.ɵfac = function HintContainerComponent_Factory(t) { return new (t || HintContainerComponent)(ɵngcc0.ɵɵdirectiveInject(ɵngcc0.ChangeDetectorRef)); };
HintContainerComponent.ɵcmp = ɵngcc0.ɵɵdefineComponent({ type: HintContainerComponent, selectors: [["kendo-hint-container"]], contentQueries: function HintContainerComponent_ContentQueries(rf, ctx, dirIndex) { if (rf & 1) {
        ɵngcc0.ɵɵcontentQuery(dirIndex, TemplateRef, true);
    } if (rf & 2) {
        var _t;
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.hintTemplate = _t.first);
    } }, decls: 1, vars: 1, consts: [[3, "ngTemplateOutlet"]], template: function HintContainerComponent_Template(rf, ctx) { if (rf & 1) {
        ɵngcc0.ɵɵelementContainer(0, 0);
    } if (rf & 2) {
        ɵngcc0.ɵɵproperty("ngTemplateOutlet", ctx.hintTemplate);
    } }, directives: [ɵngcc4.NgTemplateOutlet], encapsulation: 2 });
/** @nocollapse */
HintContainerComponent.ctorParameters = () => [
    { type: ChangeDetectorRef }
];
HintContainerComponent.propDecorators = {
    hintTemplate: [{ type: ContentChild, args: [TemplateRef,] }]
};
/*@__PURE__*/ (function () { ɵngcc0.ɵsetClassMetadata(HintContainerComponent, [{
        type: Component,
        args: [{
                selector: 'kendo-hint-container',
                template: `
        <ng-container [ngTemplateOutlet]="hintTemplate">
        </ng-container>
    `
            }]
    }], function () { return [{ type: ɵngcc0.ChangeDetectorRef }]; }, { hintTemplate: [{
            type: ContentChild,
            args: [TemplateRef]
        }] }); })();

const SCROLL_CHANGE = 15;
const MIN_DISTANCE = 60;
const SCROLL_INTERVAL = 50;
const MIN_MOVE_DISTANCE = 10;
/** @hidden */
class BaseView {
    constructor(viewContext, viewState, intl, slotService, zone, renderer, element, pdfService, localization) {
        this.viewContext = viewContext;
        this.viewState = viewState;
        this.intl = intl;
        this.slotService = slotService;
        this.zone = zone;
        this.renderer = renderer;
        this.element = element;
        this.pdfService = pdfService;
        this.localization = localization;
        this.items = new BehaviorSubject(null);
        this.horizontalResources = [];
        this.verticalResources = [];
        this.dragHints = [];
        this.resizeHints = [];
        this.getField = getField;
        this.changes = new BehaviorSubject(null);
        this.viewRangeChange = new BehaviorSubject(null);
        this.subs = new Subscription();
        this.groupedResources = [];
        this.spans = [];
        this.domEvents = [];
        this.resourcesCache = {};
        this.autoHeight = false;
        this.rtl = false;
        this.setSlotClass = this.setSlotClass.bind(this);
        this.setHintClass = this.setHintClass.bind(this);
    }
    get eventTemplateRef() {
        return this.еventTemplate || (this.schedulerEventTemplate || {}).templateRef;
    }
    get groupHeaderTemplateRef() {
        return this.groupHeaderTemplate || (this.schedulerGroupHeaderTemplate || {}).templateRef;
    }
    ngOnInit() {
        const updateView = this.updateView.bind(this);
        this.resourcesByIndex = this.resourcesByIndex.bind(this);
        this.subs.add(this.viewContext.selectedDate.subscribe(this.onSelectDate.bind(this)));
        this.subs.add(this.viewContext.action.subscribe(this.onAction.bind(this)));
        this.subs.add(this.viewContext.execute.subscribe(this.execute.bind(this)));
        this.subs.add(this.viewContext.resize.subscribe(() => {
            this.toggleElement(false);
            this.updateView();
        }));
        this.subs.add(this.viewContext.optionsChange.subscribe(this.optionsChange.bind(this)));
        this.subs.add(this.changes.subscribe(() => {
            this.toggleElement(false);
        }));
        this.subs.add(combineLatest(this.viewContext.items, this.viewState.dateRange, this.viewRangeChange)
            .pipe(map(([items, dateRange]) => this.createTasks(items, dateRange)))
            .subscribe((tasks) => {
            this.tasks = tasks;
            this.assignResources();
            this.onTasksChange();
        }));
        this.subs.add(combineLatest(this.items, this.changes, this.localization.changes).pipe(switchMap(() => this.onStable()))
            .subscribe(updateView));
        this.subs.add(this.pdfService.createElement.subscribe(this.createPDFElement.bind(this)));
    }
    ngOnChanges(changes) {
        if (anyChanged(['selectedDateFormat', 'selectedShortDateFormat'], changes)) {
            this.viewState.notifyDateRange(this.dateRange(this.selectedDate));
        }
        if (changes.eventHeight) {
            this.changes.next(null);
        }
    }
    ngAfterViewInit() {
        this.bindEvents();
        this.subs.add(this.localization.changes.subscribe(({ rtl }) => {
            this.rtl = rtl;
        }));
    }
    ngOnDestroy() {
        this.subs.unsubscribe();
        this.domEvents.forEach(unbindHandler => unbindHandler());
        this.domEvents = [];
        if (this.draggable) {
            this.draggable.destroy();
            this.draggable = null;
        }
    }
    itemIndex(index, _) {
        return index;
    }
    resourcesByIndex(index) {
        if (!this.resourcesCache[index]) {
            const resources = this.taskResources;
            const result = [];
            let currentIndex = index;
            for (let idx = 0; idx < resources.length; idx++) {
                const data = resources[idx].data || [];
                const dataIdx = Math.floor(currentIndex / this.spans[idx]);
                result.push(data[dataIdx]);
                currentIndex -= dataIdx * this.spans[idx];
            }
            this.resourcesCache[index] = result;
        }
        return this.resourcesCache[index];
    }
    dragResourcesByIndex(index) {
        const allResources = this.resources || [];
        const result = [];
        if (this.groupedResources.length) {
            const resources = this.resourcesByIndex(index).slice(0);
            const taskResources = this.taskResources;
            for (let idx = 0; idx < taskResources.length; idx++) {
                const index = this.resources.indexOf(taskResources[idx]);
                if (index >= 0) {
                    result[index] = resources[idx];
                }
            }
        }
        for (let idx = 0; idx < allResources.length; idx++) {
            if (!result[idx]) {
                result[idx] = resourceItemByValue(this.dragging.task.event, allResources[idx]);
            }
        }
        return result;
    }
    getEventClasses(item, resources, isAllDay) {
        if (this.eventClass) {
            return this.eventClass({
                event: item.event,
                resources,
                isAllDay
            });
        }
    }
    getEventStyles(item, itemResource, isAllDay) {
        const result = { backgroundColor: itemResource.color, borderColor: itemResource.color };
        if (this.eventStyles) {
            Object.assign(result, this.eventStyles({
                event: item.event,
                resources: itemResource.resources,
                isAllDay
            }));
        }
        return result;
    }
    optionsChange(options) {
        this.schedulerEventTemplate = options.eventTemplate;
        this.schedulerGroupHeaderTemplate = options.groupHeaderTemplate;
        this.min = options.min;
        this.max = options.max;
        this.editable = options.editable;
        this.timezone = options.timezone;
        if (!options.changes || anyChanged(['group', 'resources'], options.changes, false) ||
            options.group !== this.group || options.resources !== this.resources) {
            this.group = options.group;
            this.resources = options.resources;
            this.groupResources();
            this.resourcesCache = {};
            if (this.tasks && this.tasks.length) {
                this.assignResources();
                this.onTasksChange();
            }
            this.changes.next(null);
        }
    }
    toggleElement(visible) {
        if (this.element) {
            this.renderer.setStyle(this.element.nativeElement, 'display', visible ? 'block' : 'none');
        }
    }
    onStable() {
        return this.zone.onStable.asObservable().pipe(take(1));
    }
    updateView() {
        this.slotService.invalidate();
        this.toggleElement(true);
        this.reflow();
        this.viewState.notifyLayoutEnd();
    }
    assignResources() {
        assignTasksResources(this.tasks, {
            taskResources: this.taskResources,
            hasGroups: this.groupedResources.length > 0,
            allResources: this.resources,
            spans: this.spans
        });
    }
    bindEvents() {
        const contentElement = this.content.nativeElement;
        const element = this.element.nativeElement;
        this.zone.runOutsideAngular(() => {
            if (this.times) {
                this.subs.add(merge(fromEvent(this.times.nativeElement, 'mousewheel'), fromEvent(this.times.nativeElement, 'DOMMouseScroll')).pipe(filter((event) => !event.ctrlKey), tap(preventLockedScroll(contentElement)), map(wheelDeltaY))
                    .subscribe(x => contentElement.scrollTop -= x));
            }
            this.subs.add(merge(fromClick(contentElement), fromEvent(contentElement, 'contextmenu'))
                .subscribe(e => this.onClick(e)));
            this.subs.add(fromDoubleClick(contentElement)
                .subscribe(e => this.onClick(e, 'dblclick')));
            this.subs.add(fromEvent(element, 'keydown')
                .subscribe(e => this.onKeydown(e)));
            this.domEvents.push(this.renderer.listen(contentElement, 'scroll', () => {
                if (this.headerWrap) {
                    this.headerWrap.nativeElement.scrollLeft = contentElement.scrollLeft;
                }
                if (this.times) {
                    this.times.nativeElement.scrollTop = contentElement.scrollTop;
                }
            }));
            this.draggable = new Draggable({
                press: this.onPress.bind(this),
                drag: this.onDrag.bind(this),
                release: this.onRelease.bind(this)
            });
            this.draggable.bindTo(element);
        });
    }
    onPress(args) {
        const resizable = this.editable && this.editable.resize !== false;
        const draggable = this.editable && this.editable.drag !== false;
        const target = args.originalEvent.target;
        if (hasClasses(target, 'k-resize-handle')) {
            if (!resizable) {
                return;
            }
            this.initResize(args);
        }
        else if (draggable) {
            const task = this.targetTask(target);
            if (task) {
                if (!args.isTouch) {
                    args.originalEvent.preventDefault();
                }
                this.pressLocation = { x: args.pageX, y: args.pageY };
                this.pressTarget = task;
            }
        }
        this.dragArgs = args;
    }
    onDrag(args) {
        if (this.resizing) {
            this.resize(args);
            this.scrollContainer(this.resize, args);
        }
        else {
            this.initDrag(args);
            if (this.dragging) {
                this.drag(args);
                args.originalEvent.preventDefault();
                this.scrollContainer(this.drag, args);
            }
        }
        this.dragArgs = args;
    }
    onRelease() {
        clearInterval(this.scrollInterval);
        const { resizing, dragging } = this;
        if (resizing) {
            this.emitEvent('resizeEnd', {
                event: resizing.task.event,
                dataItem: resizing.task.event.dataItem,
                start: this.convertDate(resizing.start),
                end: this.convertDate(resizing.end)
            });
            this.resizeHints = [];
        }
        if (dragging) {
            this.emitEvent('dragEnd', {
                event: dragging.task.event,
                dataItem: dragging.task.event.dataItem,
                start: dragging.start ? this.convertDate(dragging.start) : dragging.task.start.toLocalDate(),
                end: dragging.end ? this.convertDate(dragging.end) : dragging.task.end.toLocalDate(),
                resources: dragging.resources,
                isAllDay: this.draggedIsAllDay(dragging.task, dragging.slot)
            });
            this.dragHints = [];
        }
        if (resizing || dragging) {
            this.removeSlotClass();
            this.updateHintContainer();
            this.resizing = null;
            this.dragging = null;
        }
        this.container = null;
        this.dragArgs = null;
        this.pressLocation = null;
        this.pressTarget = null;
    }
    setHintClass(className) {
        (this.dragging || this.resizing).hintClass = className;
    }
    updateHintClass() {
        const current = this.dragging || this.resizing;
        let update = false;
        this.hints.forEach(hint => {
            if (hint.class !== current.hintClass) {
                hint.class = current.hintClass;
                update = true;
            }
        });
        if (update) {
            this.updateHintContainer();
        }
    }
    removeHintClass() {
        (this.dragging || this.resizing).hintClass = null;
    }
    setSlotClass(className) {
        const current = this.dragging || this.resizing;
        current.slotClass = className;
        this.renderer.addClass(current.slot.nativeElement, current.slotClass);
    }
    removeSlotClass() {
        const current = this.dragging || this.resizing;
        if (current.slotClass) {
            this.renderer.removeClass(current.slot.nativeElement, current.slotClass);
            current.slotClass = null;
        }
    }
    get hints() {
        return this.dragging ? this.dragHints : this.resizeHints;
    }
    initDrag(args) {
        if (!this.dragging && this.pressLocation && pointDistance(this.pressLocation.x, this.pressLocation.y, args.pageX, args.pageY) >= MIN_MOVE_DISTANCE) {
            const dragging = this.pressTarget;
            const task = dragging.task;
            if (this.emitEvent('dragStart', { event: task.event, dataItem: task.event.dataItem })) {
                this.pressLocation = null;
                this.pressTarget = null;
                return;
            }
            this.dragging = dragging;
            this.updateDragContainer(args);
            const { x, y } = this.coordinatesOffset(this.pressLocation.x, this.pressLocation.y);
            const slot = this.slotByPosition(x, y, this.container);
            this.dragging.offset = {
                start: slot.start.getTime() - task.start.toUTCDate().getTime(),
                end: task.end.toUTCDate().getTime() - slot.start.getTime()
            };
            this.dragging.slot = slot;
            this.dragging.startResources = this.dragging.resourceItems = this.dragResourcesByIndex(slot.id.resourceIndex);
            this.dragging.resources = this.resourceValues(task, this.dragging.startResources);
        }
    }
    updateDragContainer(args) {
        if (!this.container) {
            this.container = this.content.nativeElement;
            this.containerOffset = elementOffset(this.container);
        }
    }
    drag(args) {
        this.updateDragContainer(args);
        if (!this.container) {
            return;
        }
        const { x, y } = this.coordinatesOffset(args.pageX, args.pageY);
        const slot = this.slotByPosition(x, y, this.container);
        if (slot && (slot !== this.dragging.slot || !this.dragHints.length)) {
            const dragging = this.dragging;
            const { slot: currentSlot, task } = dragging;
            const { ranges, start, end, isAllDay } = this.dragRanges(slot);
            let resourceItems, resourceValues;
            if (currentSlot.id.resourceIndex !== slot.id.resourceIndex) {
                resourceItems = this.dragResourcesByIndex(slot.id.resourceIndex);
                resourceValues = this.resourceValues(task, resourceItems);
            }
            else {
                resourceItems = dragging.resourceItems;
                resourceValues = dragging.resources;
            }
            this.removeSlotClass();
            dragging.start = start;
            dragging.end = end;
            dragging.slot = slot;
            dragging.resources = resourceValues;
            dragging.resourceItems = resourceItems;
            dragging.hintClass = null;
            if (this.emitEvent('drag', {
                event: task.event,
                dataItem: task.event.dataItem,
                start: this.convertDate(start),
                end: this.convertDate(end),
                resources: resourceValues,
                isAllDay,
                setHintClass: this.setHintClass,
                setSlotClass: this.setSlotClass
            })) {
                this.updateHintClass();
                return;
            }
            const color = this.dragResourceColor(task, resourceItems);
            const hintClasses = this.dragHintClasses();
            this.dragHints = [];
            for (let idx = 0; idx < ranges.length; idx++) {
                const slots = ranges[idx];
                const first = slots[0];
                const last = slots[slots.length - 1];
                const size = this.dragHintSize(first, last);
                let origin = first.rect.left;
                const styles = {
                    top: toPx(first.rect.top),
                    left: this.localization.rtl ? '' : toPx(origin),
                    right: !this.localization.rtl ? '' : toPx(origin),
                    width: size.width,
                    height: size.height,
                    backgroundColor: color,
                    borderColor: color
                };
                if (this.eventStyles) {
                    Object.assign(styles, this.eventStyles(this.dragHintEventStyleArgs()));
                }
                this.dragHints.push({
                    item: Object.assign({}, this.dragging.task, {
                        startTime: start,
                        endTime: end
                    }),
                    resources: resourceItems,
                    class: hintClasses,
                    style: styles
                });
            }
            this.updateHintContainer();
        }
    }
    dragHintClasses() {
        const hintClass = this.dragging.hintClass;
        let result = [];
        if (hintClass) {
            result.push(hintClass);
        }
        if (this.eventClass) {
            const eventClass = this.eventClass(this.dragHintEventStyleArgs());
            result = result.concat(convertNgClassBindings(eventClass));
        }
        return result;
    }
    dragHintEventStyleArgs() {
        return {
            event: this.dragging.task.event,
            resources: this.dragging.resourceItems
        };
    }
    draggedIsAllDay(task, _slot) {
        return Boolean(task.event.isAllDay);
    }
    dragResourceColor(task, slotResources) {
        if (this.groupedResources.length) {
            const index = this.resources.indexOf(this.groupedResources[0]);
            return getField(slotResources[index], this.groupedResources[0].colorField);
        }
        else if (this.resources && this.resources.length) {
            return task.resources[0].color;
        }
        return '';
    }
    resourceValues(task, currentResources) {
        const result = {};
        for (let idx = 0; idx < currentResources.length; idx++) {
            const resource = this.resources[idx];
            const resourceItem = currentResources[idx];
            let value;
            if (Array.isArray(resourceItem)) { // not grouped multiple resource
                value = getField(task.event, resource.field);
            }
            else {
                value = getField(currentResources[idx], resource.valueField);
                if (resource.multiple) {
                    const startValue = getField(this.dragging.startResources[idx], resource.valueField);
                    if (startValue !== value) {
                        value = [value];
                    }
                    else {
                        value = getField(task.event.dataItem, resource.field);
                    }
                }
            }
            setField(result, resource.field, value);
        }
        return result;
    }
    initResize(args) {
        args.originalEvent.preventDefault();
        const target = args.originalEvent.target;
        const resizing = this.targetTask(target);
        if (this.emitEvent('resizeStart', { event: resizing.task.event, dataItem: resizing.task.event.dataItem })) {
            return;
        }
        this.resizing = resizing;
        resizing.start = resizing.task.start.toUTCDate();
        resizing.end = resizing.task.end.toUTCDate();
        if (hasClasses(target, 'k-resize-n')) {
            resizing.direction = 'n';
        }
        else if (hasClasses(target, 'k-resize-s')) {
            resizing.direction = 's';
        }
        else if (hasClasses(target, 'k-resize-w')) {
            resizing.direction = 'w';
        }
        else {
            resizing.direction = 'e';
        }
        this.updateDragContainer(args);
        const { x, y } = this.coordinatesOffset(args.pageX, args.pageY);
        resizing.slot = this.slotByPosition(x, y, this.container);
        resizing.offset = {
            start: resizing.task.start.toUTCDate().getTime() - resizing.slot.start.getTime(),
            end: resizing.task.end.toUTCDate().getTime() - resizing.slot.start.getTime()
        };
    }
    resize(args) {
        const { x, y } = this.coordinatesOffset(args.pageX, args.pageY);
        const resizing = this.resizing;
        const { direction, task, offset } = resizing;
        const slot = this.slotService.groupSlotByPosition(resizing.slot, x, y);
        if (!slot || slot === resizing.slot) {
            return;
        }
        this.removeSlotClass();
        const { start, end, ranges } = this.slotService.resizeRanges(slot, task, direction === 'w' || direction === 'n', offset);
        resizing.hintClass = null;
        resizing.start = start;
        resizing.end = end;
        resizing.slot = slot;
        if (this.emitEvent('resize', {
            event: task.event,
            dataItem: task.event.dataItem,
            start: this.convertDate(start),
            end: this.convertDate(end),
            setHintClass: this.setHintClass,
            setSlotClass: this.setSlotClass
        })) {
            this.updateHintClass();
            return;
        }
        this.updateResizeHints(ranges, start, end);
        this.updateHintContainer();
    }
    updateResizeHints(ranges, start, end) {
        const resizing = this.resizing;
        const direction = resizing.direction;
        const horizontal = direction === 'w' || direction === 'e';
        const resizeStart = direction === 'w' || direction === 'n';
        this.resizeHints = [];
        for (let idx = 0; idx < ranges.length; idx++) {
            const range = ranges[idx];
            const firstSlot = range[0];
            const lastSlot = range[range.length - 1];
            const first = idx === 0;
            const last = idx === ranges.length - 1;
            this.resizeHints.push({
                first: first,
                last: last,
                rect: {
                    left: firstSlot.rect.left,
                    top: firstSlot.top,
                    height: horizontal ? firstSlot.height : Math.abs(lastSlot.rect.top - firstSlot.rect.top) + lastSlot.rect.height,
                    width: horizontal ? Math.abs(lastSlot.rect.left - firstSlot.rect.left) + lastSlot.rect.width : firstSlot.width
                },
                start: first && !resizeStart ? resizing.start : firstSlot.start,
                end: last && resizeStart ? resizing.end : lastSlot.end,
                class: resizing.hintClass
            });
        }
    }
    coordinatesOffset(x, y, container = this.container, offset = this.containerOffset) {
        const position = x - offset.left + container.scrollLeft;
        return {
            x: !this.localization.rtl ? position : this.slotService.containerSize - position,
            y: y - offset.top + container.scrollTop
        };
    }
    scrollContainer(callback, args) {
        clearInterval(this.scrollInterval);
        const container = this.container;
        if (!container) {
            return;
        }
        const viewPortY = args.pageY - this.containerOffset.top;
        const pointerYDistance = Math.abs(container.offsetHeight - viewPortY);
        const deltaY = args.pageY - this.dragArgs.pageY;
        const viewPortX = args.pageX - this.containerOffset.left;
        const pointerXDistance = Math.abs(container.offsetWidth - viewPortX);
        const deltaX = args.pageX - this.dragArgs.pageX;
        let scroll = false;
        let leftChange = 0;
        let topChange = 0;
        if (pointerYDistance < MIN_DISTANCE && container.scrollTop + container.offsetHeight < container.scrollHeight && deltaY > 0) {
            scroll = true;
            topChange = SCROLL_CHANGE;
            this.container.scrollTop += MIN_DISTANCE - pointerYDistance;
        }
        else if (viewPortY < MIN_DISTANCE && container.scrollTop > 0 && deltaY < 0) {
            scroll = true;
            topChange = -SCROLL_CHANGE;
            this.container.scrollTop -= MIN_DISTANCE - viewPortY;
        }
        if (pointerXDistance < MIN_DISTANCE && container.scrollLeft + container.offsetWidth < container.scrollWidth && deltaX > 0) {
            scroll = true;
            leftChange = SCROLL_CHANGE;
            this.container.scrollLeft += MIN_DISTANCE - pointerXDistance;
        }
        else if (viewPortX < MIN_DISTANCE && container.scrollLeft > 0 && deltaY < 0) {
            scroll = true;
            leftChange = -SCROLL_CHANGE;
            this.container.scrollLeft -= MIN_DISTANCE - viewPortX;
        }
        if (scroll) {
            this.scrollInterval = setInterval(() => {
                if (this.container) {
                    this.container.scrollLeft += leftChange;
                    this.container.scrollTop += topChange;
                    callback.call(this, args);
                }
                else {
                    clearInterval(this.scrollInterval);
                }
            }, SCROLL_INTERVAL);
        }
    }
    emitEvent(name, args) {
        this.viewState.emitEvent(name, args);
        return args.prevented;
    }
    targetTask(target) {
        const eventTarget = closestInScope(target, node => node.hasAttribute('data-task-index'), this.element.nativeElement);
        if (eventTarget) {
            const index = parseInt(eventTarget.getAttribute('data-task-index'), 10);
            return {
                target: eventTarget,
                task: this.tasks.find(t => t.index === index)
            };
        }
    }
    updateHintContainer() {
        if (this.hintContainer) {
            this.hintContainer.detectChanges();
        }
    }
    /**
     * Converts a "view date" (date stored in the UTC parts of a Date object) to a local date.
     */
    convertDate(date) {
        return ZonedDate.fromUTCDate(date, this.timezone).toLocalDate();
    }
    onClick(e, eventType = e.type) {
        this.emitSlotEvent(e, eventType);
        this.emitTaskEvent(e, eventType);
    }
    emitSlotEvent(e, eventType) {
        const targetSlot = closestInScope(e.target, node => node.hasAttribute('data-slot-index'), this.element.nativeElement);
        if (targetSlot) {
            const slotIndex = targetSlot.getAttribute('data-slot-index');
            const name = eventType === 'dblclick' ? 'slotDblClick' : 'slotClick';
            const slot = this.slotByIndex(slotIndex, e);
            this.viewState.emitEvent(name, {
                type: eventType,
                slot: slot,
                start: this.convertDate(slot.start),
                end: this.convertDate(slot.end),
                isAllDay: slot.isDaySlot,
                originalEvent: e,
                resources: this.resources && this.resources.length ?
                    this.resourcesByIndex(slot.id.resourceIndex) : []
            });
        }
    }
    emitTaskEvent(e, eventType) {
        const targetTask = this.targetTask(e.target);
        if (targetTask) {
            const task = targetTask.task;
            const isSingle = eventType === 'click';
            const isDouble = eventType === 'dblclick';
            if (isSingle && closestInScope(e.target, node => hasClasses(node, 'k-event-delete'), targetTask.target)) {
                this.viewState.emitEvent('remove', { event: task.event, dataItem: task.event.dataItem });
            }
            else {
                const name = isDouble ? 'eventDblClick' : 'eventClick';
                this.viewState.emitEvent(name, { type: eventType, event: task.event, originalEvent: e });
                targetTask.target.focus();
            }
        }
    }
    onKeydown(e) {
        const targetTask = this.targetTask(e.target);
        if (targetTask) {
            const task = targetTask.task;
            this.viewState.emitEvent('eventKeydown', { event: task.event, dataItem: task.event.dataItem, originalEvent: e });
        }
    }
    syncTables() {
        if (this.timesTable) {
            this.renderer.setStyle(this.timesTable.nativeElement, 'height', `${this.contentTable.nativeElement.offsetHeight}px`);
        }
        if (this.header) {
            this.renderer.setStyle(this.header.nativeElement, !this.localization.rtl ? 'padding-right' : 'padding-left', `${hasScrollbar(this.content.nativeElement, 'vertical') ? scrollbarWidth() - BORDER_WIDTH : 0}px`);
            this.renderer.setStyle(this.header.nativeElement, this.localization.rtl ? 'padding-right' : 'padding-left', '0px');
        }
        if (this.times) {
            const times = this.times.nativeElement;
            this.timesHeader.nativeElement.style.width = `${times.offsetWidth}px`;
            const contentHeight = this.contentHeight === 'auto' ? this.content.nativeElement.offsetHeight : this.contentHeight;
            this.renderer.setStyle(times, 'height', `${contentHeight - (hasScrollbar(this.content.nativeElement, 'horizontal') ? scrollbarWidth() : 0)}px`);
            times.scrollTop = this.content.nativeElement.scrollTop;
        }
    }
    updateContentHeight() {
        const element = this.element.nativeElement;
        const parent = element.parentNode;
        const content = this.content.nativeElement;
        const autoHeight = this.autoHeight || !parent.style.height;
        const scrollLeft = content.scrollLeft;
        const scrollTop = content.scrollTop;
        this.renderer.setStyle(content, 'height', '');
        if (this.times) {
            this.renderer.setStyle(this.times.nativeElement, 'height', '');
        }
        if (autoHeight) {
            this.contentHeight = 'auto';
            return;
        }
        let height = parent.clientHeight;
        for (let idx = 0; idx < parent.children.length; idx++) {
            const child = parent.children[idx];
            if (child !== element && !ignoreContentChild(child)) {
                height -= child.offsetHeight;
            }
        }
        height -= this.headerWrap ? this.headerWrap.nativeElement.offsetHeight : 0;
        this.renderer.setStyle(content, 'height', `${height}px`);
        this.contentHeight = height;
        content.scrollLeft = scrollLeft;
        content.scrollTop = scrollTop;
    }
    groupResources() {
        const resources = this.resources || [];
        const group = this.group || {};
        this.groupedResources = groupResources(group, resources);
        if (group.orientation !== 'vertical') {
            this.horizontalResources = this.groupedResources;
            this.verticalResources = [];
        }
        else {
            this.verticalResources = this.groupedResources;
            this.horizontalResources = [];
        }
        this.spans = this.resourceSpans();
    }
    get taskResources() {
        if (this.groupedResources.length) {
            return this.groupedResources;
        }
        else if (this.resources && this.resources.length) {
            return [this.resources[0]];
        }
        else {
            return [{}];
        }
    }
    resourceSpans() {
        const spans = [1];
        const resources = this.groupedResources;
        let span = 1;
        for (let idx = resources.length - 1; idx > 0; idx--) {
            span *= ((resources[idx].data || []).length || 1);
            spans.unshift(span);
        }
        return spans;
    }
    isInRange(date) {
        const dateRange = this.dateRange(date);
        return (!this.min || this.min < dateRange.end) && (!this.max || dateRange.start <= this.max);
    }
    createPDFElement() {
        const contentHeight = this.contentHeight;
        const scrollTop = this.content.nativeElement.scrollTop;
        if (contentHeight !== 'auto') {
            this.autoHeight = true;
            this.updateView();
        }
        const element = this.element.nativeElement.cloneNode(true);
        element.style.width = `${this.pdfWidth()}px`;
        if (contentHeight !== 'auto') {
            this.autoHeight = false;
            this.updateView();
        }
        this.pdfService.elementReady.emit({
            element: element
        });
        this.content.nativeElement.scrollTop = scrollTop;
    }
    pdfWidth() {
        return this.element.nativeElement.offsetWidth;
    }
    containerByPosition({ x, y }) {
        const content = this.content.nativeElement;
        const offset = elementOffset(content);
        if (offset.top <= y && y <= offset.top + offset.height && offset.left <= x && x <= offset.left + offset.width) {
            return {
                element: content,
                offset: offset
            };
        }
    }
    execute(e) {
        if (e.name === 'slotByPosition') {
            const container = this.containerByPosition(e.args);
            if (container) {
                const offset = this.coordinatesOffset(e.args.x, e.args.y, container.element, container.offset);
                const slot = this.slotByPosition(offset.x, offset.y, container.element);
                e.result(this.slotFields(slot));
            }
        }
        else if (e.name === 'eventFromElement') {
            const target = this.targetTask(e.args.element);
            if (target) {
                e.result(target.task.event);
            }
        }
    }
    slotFields(slot) {
        return {
            element: slot.element,
            resources: this.groupedResources.length ? this.resourcesByIndex(slot.id.resourceIndex) : [],
            start: this.convertDate(slot.start),
            end: this.convertDate(slot.end)
        };
    }
}
BaseView.ɵfac = function BaseView_Factory(t) { ɵngcc0.ɵɵinvalidFactory(); };
BaseView.ɵdir = ɵngcc0.ɵɵdefineDirective({ type: BaseView, viewQuery: function BaseView_Query(rf, ctx) { if (rf & 1) {
        ɵngcc0.ɵɵviewQuery(_c160, true);
        ɵngcc0.ɵɵviewQuery(_c169, true);
        ɵngcc0.ɵɵviewQuery(_c170, true);
        ɵngcc0.ɵɵviewQuery(_c171, true);
        ɵngcc0.ɵɵviewQuery(_c172, true);
        ɵngcc0.ɵɵviewQuery(_c173, true);
        ɵngcc0.ɵɵviewQuery(_c167, true);
        ɵngcc0.ɵɵviewQuery(_c174, true);
    } if (rf & 2) {
        var _t;
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.content = _t.first);
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.header = _t.first);
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.contentTable = _t.first);
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.times = _t.first);
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.timesHeader = _t.first);
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.timesTable = _t.first);
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.headerWrap = _t.first);
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.hintContainer = _t.first);
    } }, inputs: { еventTemplate: "\u0435ventTemplate", groupHeaderTemplate: "groupHeaderTemplate", selectedDateFormat: "selectedDateFormat", selectedShortDateFormat: "selectedShortDateFormat", eventHeight: "eventHeight", slotClass: "slotClass", eventClass: "eventClass", eventStyles: "eventStyles" }, features: [ɵngcc0.ɵɵNgOnChangesFeature] });
BaseView.propDecorators = {
    еventTemplate: [{ type: Input }],
    groupHeaderTemplate: [{ type: Input }],
    selectedDateFormat: [{ type: Input }],
    selectedShortDateFormat: [{ type: Input }],
    eventHeight: [{ type: Input }],
    slotClass: [{ type: Input }],
    eventClass: [{ type: Input }],
    eventStyles: [{ type: Input }],
    content: [{ type: ViewChild, args: ['content',] }],
    header: [{ type: ViewChild, args: ['header',] }],
    contentTable: [{ type: ViewChild, args: ['contentTable',] }],
    times: [{ type: ViewChild, args: ['times',] }],
    timesHeader: [{ type: ViewChild, args: ['timesHeader',] }],
    timesTable: [{ type: ViewChild, args: ['timesTable',] }],
    headerWrap: [{ type: ViewChild, args: ['headerWrap',] }],
    hintContainer: [{ type: ViewChild, args: ['hintContainer',] }]
};


const DAYS_IN_WEEK_COUNT = 7;
const WEEKS_COUNT = 6;
/**
 * @hidden
 */
class MonthViewRendererComponent extends BaseView {
    constructor(viewContext, viewState, intl, slotService, zone, element, renderer, pdfService, localization) {
        super(viewContext, viewState, intl, slotService, zone, renderer, element, pdfService, localization);
        this.resizeHintFormat = { skeleton: 'Md' };
        this.weeks = [];
    }
    get monthDaySlotTemplateRef() {
        return this.monthDaySlotTemplate || (this.schedulerMonthDaySlotTemplate || {}).templateRef;
    }
    horizontalColspan(resourceIndex) {
        const resources = this.horizontalResources;
        let result = DAYS_IN_WEEK_COUNT;
        for (let idx = resourceIndex + 1; idx < resources.length; idx++) {
            result *= (resources[idx].data || []).length || 1;
        }
        return result;
    }
    verticalRowspan(resourceIndex) {
        const resources = this.verticalResources;
        let result = WEEKS_COUNT;
        for (let idx = resourceIndex + 1; idx < resources.length; idx++) {
            result *= (resources[idx].data || []).length || 1;
        }
        return result;
    }
    verticalItem(leafIndex, resourceIndex) {
        const data = this.verticalResources[resourceIndex].data || [];
        const resources = this.verticalResources;
        let result = 1;
        for (let idx = resourceIndex + 1; idx < resources.length; idx++) {
            result *= ((resources[idx].data || []).length || 1);
        }
        return data[(leafIndex / result) % data.length];
    }
    daySlotClass(day, resourceIndex) {
        if (this.slotClass) {
            return this.slotClass({
                start: day,
                end: addDays(day, 1),
                resources: this.resourcesByIndex(resourceIndex),
                isAllDay: false
            });
        }
    }
    optionsChange(changes) {
        this.schedulerMonthDaySlotTemplate = changes.monthDaySlotTemplate;
        super.optionsChange(changes);
    }
    createTasks(items, dateRange) {
        this.weeks = this.createDaySlots(dateRange);
        return createTasks(dateRange.start, dateRange.end, items, this.weeks);
    }
    onTasksChange() {
        updateTaskData(this.tasks);
        this.items.next(this.tasks);
    }
    reflow() {
        this.updateContentHeight();
        const content = this.content.nativeElement;
        this.slotService.containerSize = content.scrollWidth;
        if (this.contentHeight === 'auto') {
            // bigger size changes cause the table to overflow the container and in horizontal scrollbars
            // this changes the table and slots size during rendering before the browser re-adjusts the 100% table width
            content.style.overflow = 'visible';
        }
        this.slotService.layout(this.eventHeight);
        if (this.contentHeight === 'auto') {
            content.style.overflow = '';
        }
        this.syncTables();
    }
    onClick(e, eventType = e.type) {
        if (eventType === 'click') {
            const eventSlot = closestInScope(e.target, node => node.hasAttribute('data-slot-index'), this.element.nativeElement);
            const navigateToDay = closestInScope(e.target, node => hasClasses(node, 'k-more-events k-nav-day'), eventSlot);
            if (eventSlot && navigateToDay) {
                const index = eventSlot.getAttribute('data-slot-index');
                const slot = this.slotService.slotByIndex(index);
                this.zone.run(() => {
                    this.viewState.navigateTo({ viewName: 'day', date: toLocalDate(slot.start) });
                });
                return;
            }
        }
        super.onClick(e, eventType);
    }
    slotByIndex(index, _args) {
        return this.slotService.slotByIndex(index);
    }
    onSelectDate(date) {
        const dateRange = this.dateRange(date);
        this.selectedDate = date;
        this.viewState.notifyDateRange(dateRange);
        this.weeks = this.createDaySlots(dateRange);
    }
    onAction(e) {
        const now = getDate(this.selectedDate);
        if (e.type === 'next') {
            const next = firstDayOfMonth(addMonths(now, 1));
            if (this.isInRange(next)) {
                this.viewState.notifyNextDate(next);
            }
        }
        if (e.type === 'prev') {
            const next = firstDayOfMonth(addMonths(now, -1));
            if (this.isInRange(next)) {
                this.viewState.notifyNextDate(next);
            }
        }
    }
    dateRange(date = this.selectedDate) {
        const monthStart = firstDayOfMonth(getDate(date));
        const start = firstDayInWeek(monthStart, this.intl.firstDay());
        const end = addDays(start, DAYS_IN_WEEK_COUNT * WEEKS_COUNT);
        const text = this.intl.format(this.selectedDateFormat, monthStart);
        const shortText = this.intl.format(this.selectedShortDateFormat, monthStart);
        return { start, end, text, shortText };
    }
    dragRanges(slot) {
        return this.slotService.dragRanges(slot, this.dragging.offset);
    }
    dragHintSize(first, last) {
        return {
            width: toPx(last.rect.left - first.rect.left + last.rect.width),
            height: toPx(first.height)
        };
    }
    slotByPosition(x, y) {
        return this.slotService.slotByPosition(x, y);
    }
    createDaySlots({ start }) {
        const weeks = [];
        let date = start;
        for (let idx = 0; idx < WEEKS_COUNT; idx++) {
            const week = [];
            weeks.push(week);
            for (let dayIdx = 0; dayIdx < DAYS_IN_WEEK_COUNT; dayIdx++) {
                week.push(date);
                date = addDays(date, 1);
            }
        }
        return weeks;
    }
}
MonthViewRendererComponent.ɵfac = function MonthViewRendererComponent_Factory(t) { return new (t || MonthViewRendererComponent)(ɵngcc0.ɵɵdirectiveInject(ViewContextService), ɵngcc0.ɵɵdirectiveInject(ViewStateService), ɵngcc0.ɵɵdirectiveInject(ɵngcc3.IntlService), ɵngcc0.ɵɵdirectiveInject(MonthSlotService), ɵngcc0.ɵɵdirectiveInject(ɵngcc0.NgZone), ɵngcc0.ɵɵdirectiveInject(ɵngcc0.ElementRef), ɵngcc0.ɵɵdirectiveInject(ɵngcc0.Renderer2), ɵngcc0.ɵɵdirectiveInject(PDFService), ɵngcc0.ɵɵdirectiveInject(ɵngcc2.LocalizationService)); };
MonthViewRendererComponent.ɵcmp = ɵngcc0.ɵɵdefineComponent({ type: MonthViewRendererComponent, selectors: [["month-view"]], inputs: { monthDaySlotTemplate: "monthDaySlotTemplate" }, features: [ɵngcc0.ɵɵProvidersFeature([
            MonthSlotService
        ]), ɵngcc0.ɵɵInheritDefinitionFeature], decls: 25, vars: 16, consts: [[1, "k-scheduler-layout", "k-scheduler-monthview", "k-scheduler-flex-layout"], [1, "k-scheduler-pane"], ["class", "k-scheduler-times", 4, "ngIf"], [1, "k-scheduler-header", "k-state-default"], ["header", ""], [1, "k-scheduler-header-wrap"], ["headerWrap", ""], ["aria-hidden", "true", 1, "k-scheduler-table"], [4, "ngFor", "ngForOf", "ngForTrackBy"], ["class", "k-scheduler-times k-scheduler-resources", 4, "ngIf"], [1, "k-scheduler-content"], ["content", ""], ["role", "presentation", 1, "k-scheduler-table"], ["contentTable", ""], ["hintContainer", ""], [1, "k-scheduler-times"], ["timesHeader", ""], ["class", "k-slot-cell", 4, "ngFor", "ngForOf", "ngForTrackBy"], [1, "k-slot-cell"], [4, "ngIf"], [3, "ngTemplateOutlet", "ngTemplateOutletContext", 4, "ngIf"], [3, "ngTemplateOutlet", "ngTemplateOutletContext"], [1, "k-scheduler-times", "k-scheduler-resources"], ["times", ""], ["timesTable", ""], [1, "k-slot-cell", "k-empty-slot"], ["class", "k-slot-cell", 3, "ngClass", 4, "ngIf"], [1, "k-slot-cell", 3, "ngClass"], ["monthSlot", "", 3, "ngClass", "start", "id", 4, "ngFor", "ngForOf", "ngForTrackBy"], ["monthSlot", "", 3, "ngClass", "start", "id"], ["class", "k-link k-nav-day", 4, "ngIf"], [1, "k-link", "k-nav-day"], ["monthViewItem", "", 3, "ngClass", "ngStyle", "kendoSchedulerFocusIndex", "editable", "item", "index", "rangeIndex", "eventTemplate", "resources", "resourceIndex", 4, "ngFor", "ngForOf", "ngForTrackBy"], ["monthViewItem", "", 3, "ngClass", "ngStyle", "kendoSchedulerFocusIndex", "editable", "item", "index", "rangeIndex", "eventTemplate", "resources", "resourceIndex"], ["class", "k-event-drag-hint", "monthViewItem", "", 3, "ngStyle", "ngClass", "dragHint", "eventTemplate", "item", "resources", 4, "ngFor", "ngForOf", "ngForTrackBy"], ["kendoResizeHint", "", 3, "hint", "ngClass", "format", 4, "ngFor", "ngForOf", "ngForTrackBy"], ["monthViewItem", "", 1, "k-event-drag-hint", 3, "ngStyle", "ngClass", "dragHint", "eventTemplate", "item", "resources"], ["kendoResizeHint", "", 3, "hint", "ngClass", "format"]], template: function MonthViewRendererComponent_Template(rf, ctx) { if (rf & 1) {
        ɵngcc0.ɵɵelementStart(0, "div", 0);
        ɵngcc0.ɵɵelementStart(1, "div", 1);
        ɵngcc0.ɵɵtemplate(2, MonthViewRendererComponent_div_2_Template, 5, 0, "div", 2);
        ɵngcc0.ɵɵelementStart(3, "div", 3, 4);
        ɵngcc0.ɵɵelementStart(5, "div", 5, 6);
        ɵngcc0.ɵɵelementStart(7, "table", 7);
        ɵngcc0.ɵɵtemplate(8, MonthViewRendererComponent_tr_8_Template, 3, 5, "tr", 8);
        ɵngcc0.ɵɵelementStart(9, "tr");
        ɵngcc0.ɵɵtemplate(10, MonthViewRendererComponent_ng_container_10_Template, 2, 2, "ng-container", 8);
        ɵngcc0.ɵɵpipe(11, "resourceIterator");
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵelementStart(12, "div", 1);
        ɵngcc0.ɵɵtemplate(13, MonthViewRendererComponent_div_13_Template, 6, 4, "div", 9);
        ɵngcc0.ɵɵelementStart(14, "div", 10, 11);
        ɵngcc0.ɵɵelementStart(16, "table", 12, 13);
        ɵngcc0.ɵɵtemplate(18, MonthViewRendererComponent_ng_container_18_Template, 2, 2, "ng-container", 8);
        ɵngcc0.ɵɵpipe(19, "resourceIterator");
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵtemplate(20, MonthViewRendererComponent_ng_container_20_Template, 2, 2, "ng-container", 8);
        ɵngcc0.ɵɵpipe(21, "async");
        ɵngcc0.ɵɵelementStart(22, "kendo-hint-container", null, 14);
        ɵngcc0.ɵɵtemplate(24, MonthViewRendererComponent_ng_template_24_Template, 2, 4, "ng-template");
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵelementEnd();
    } if (rf & 2) {
        ɵngcc0.ɵɵadvance(2);
        ɵngcc0.ɵɵproperty("ngIf", ctx.verticalResources.length);
        ɵngcc0.ɵɵadvance(6);
        ɵngcc0.ɵɵproperty("ngForOf", ctx.horizontalResources)("ngForTrackBy", ctx.itemIndex);
        ɵngcc0.ɵɵadvance(2);
        ɵngcc0.ɵɵproperty("ngForOf", ɵngcc0.ɵɵpipeBind1(11, 10, ctx.horizontalResources))("ngForTrackBy", ctx.itemIndex);
        ɵngcc0.ɵɵadvance(3);
        ɵngcc0.ɵɵproperty("ngIf", ctx.verticalResources.length);
        ɵngcc0.ɵɵadvance(5);
        ɵngcc0.ɵɵproperty("ngForOf", ɵngcc0.ɵɵpipeBind1(19, 12, ctx.verticalResources))("ngForTrackBy", ctx.itemIndex);
        ɵngcc0.ɵɵadvance(2);
        ɵngcc0.ɵɵproperty("ngForOf", ɵngcc0.ɵɵpipeBind1(21, 14, ctx.items))("ngForTrackBy", ctx.itemIndex);
    } }, directives: function () { return [ɵngcc4.NgIf, ɵngcc4.NgForOf, HintContainerComponent, ɵngcc4.NgTemplateOutlet, ɵngcc4.NgClass, MonthSlotDirective,
        MonthViewItemComponent, ɵngcc4.NgStyle, FocusableDirective,
        ResizeHintComponent]; }, pipes: function () { return [ResourceIteratorPipe, ɵngcc4.AsyncPipe, ɵngcc3.DatePipe, RepeatPipe]; }, encapsulation: 2 });
/** @nocollapse */
MonthViewRendererComponent.ctorParameters = () => [
    { type: ViewContextService },
    { type: ViewStateService },
    { type: IntlService },
    { type: MonthSlotService },
    { type: NgZone },
    { type: ElementRef },
    { type: Renderer2 },
    { type: PDFService },
    { type: LocalizationService }
];
MonthViewRendererComponent.propDecorators = {
    monthDaySlotTemplate: [{ type: Input }]
};
/*@__PURE__*/ (function () { ɵngcc0.ɵsetClassMetadata(MonthViewRendererComponent, [{
        type: Component,
        args: [{
                // tslint:disable-next-line:component-selector
                selector: 'month-view',
                providers: [
                    MonthSlotService
                ],
                template: `
        <div class="k-scheduler-layout k-scheduler-monthview k-scheduler-flex-layout">
            <div class="k-scheduler-pane">
                <div class="k-scheduler-times" #timesHeader *ngIf="verticalResources.length">
                    <table class="k-scheduler-table" aria-hidden="true">
                        <tr>
                            <th></th>
                        </tr>
                    </table>
                </div>
                <div class="k-scheduler-header k-state-default" #header>
                    <div class="k-scheduler-header-wrap" #headerWrap>
                       <table class="k-scheduler-table" aria-hidden="true">
                         <tr *ngFor="let resource of horizontalResources; let resourceIndex = index; trackBy: itemIndex">
                             <th *ngFor="let item of horizontalResources | resourceIterator : resourceIndex; trackBy: itemIndex"
                                 class="k-slot-cell" [attr.colspan]="horizontalColspan(resourceIndex)">
                                <ng-container *ngIf="!groupHeaderTemplateRef">{{ getField(item, resource.textField) }}</ng-container>
                                <ng-container *ngIf="groupHeaderTemplateRef" [ngTemplateOutlet]="groupHeaderTemplateRef" [ngTemplateOutletContext]="{ resource: item }"></ng-container>
                             </th>
                         </tr>
                         <tr>
                             <ng-container *ngFor="let resource of horizontalResources | resourceIterator; trackBy: itemIndex">
                                 <th *ngFor="let day of weeks[0]; trackBy: itemIndex">
                                     {{ day | kendoDate: 'EEEE' }}
                                 </th>
                             </ng-container>
                         </tr>
                       </table>
                    </div>
                </div>
            </div>
            <div class="k-scheduler-pane">
                <div class="k-scheduler-times k-scheduler-resources" #times *ngIf="verticalResources.length">
                    <table class="k-scheduler-table" #timesTable aria-hidden="true">
                        <ng-container *ngFor="let resourceItem of verticalResources | resourceIterator; let leafIndex = index; trackBy: itemIndex">
                            <tr>
                                <ng-container *ngFor="let resource of verticalResources; let resourceIndex = index; trackBy: itemIndex">
                                    <th *ngIf="verticalItem(leafIndex, resourceIndex)" [attr.rowspan]="verticalRowspan(resourceIndex)" class="k-slot-cell" [ngClass]="{ 'k-last-resource': resourceIndex === verticalResources.length - 1 }">
                                        <ng-container *ngIf="!groupHeaderTemplateRef">{{ getField(verticalItem(leafIndex, resourceIndex), resource.textField) }}</ng-container>
                                        <ng-container *ngIf="groupHeaderTemplateRef" [ngTemplateOutlet]="groupHeaderTemplateRef"
                                            [ngTemplateOutletContext]="{ resource: verticalItem(leafIndex, resourceIndex) }"></ng-container>
                                    </th>
                                </ng-container>
                                <th class="k-slot-cell k-empty-slot">
                                </th>
                            </tr>
                            <tr *ngFor="let index of 5 | repeat; trackBy: itemIndex">
                                <th class="k-slot-cell k-empty-slot"></th>
                            </tr>
                        </ng-container>
                    </table>
                </div>
                <div class="k-scheduler-content" #content>
                     <table class="k-scheduler-table" #contentTable role="presentation">
                         <ng-container *ngFor="let resourceItem of verticalResources | resourceIterator; let verticalIndex = index; trackBy: itemIndex">
                             <tr *ngFor="let week of weeks;  let rangeIndex = index; trackBy: itemIndex">
                                <ng-container *ngFor="let resource of horizontalResources | resourceIterator; let horizontalIndex = index; trackBy: itemIndex">
                                     <td *ngFor="let day of week; let index = index; trackBy: itemIndex"
                                         monthSlot
                                         [ngClass]="daySlotClass(day, verticalResources.length ? verticalIndex : horizontalIndex)"
                                         [start]="day"
                                         [id]="{ resourceIndex: verticalResources.length ? verticalIndex : horizontalIndex, rangeIndex: rangeIndex, index: index }"
                                        >
                                        <span class="k-link k-nav-day" *ngIf="!monthDaySlotTemplateRef">{{ day | kendoDate: 'dd' }}</span>
                                        <ng-container *ngIf="monthDaySlotTemplateRef" [ngTemplateOutlet]="monthDaySlotTemplateRef"
                                            [ngTemplateOutletContext]="{ date: day, resources: resourcesByIndex(verticalResources.length ? verticalIndex : horizontalIndex) }"></ng-container>
                                     </td>
                                </ng-container>
                             </tr>
                         </ng-container>
                     </table>
                     <ng-container *ngFor="let item of items | async; trackBy: itemIndex">
                         <div *ngFor="let itemResource of item.resources; trackBy: itemIndex"
                            [ngClass]="getEventClasses(item, itemResource.resources)"
                            [ngStyle]="getEventStyles(item, itemResource)"
                            [kendoSchedulerFocusIndex]="itemResource.leafIdx"
                            monthViewItem
                                [editable]="editable"
                                [item]="item"
                                [index]="item.index"
                                [rangeIndex]="item.rangeIndex"
                                [eventTemplate]="eventTemplateRef"
                                [resources]="itemResource.resources"
                                [resourceIndex]="itemResource.leafIdx">
                         </div>
                     </ng-container>
                     <kendo-hint-container #hintContainer>
                        <ng-template>
                            <div *ngFor="let hint of dragHints; trackBy: itemIndex;"
                                class="k-event-drag-hint"
                                monthViewItem
                                    [ngStyle]="hint.style"
                                    [ngClass]="hint.class"
                                    [dragHint]="true"
                                    [eventTemplate]="eventTemplateRef"
                                    [item]="hint.item"
                                    [resources]="hint.resources">
                            </div>

                            <div *ngFor="let hint of resizeHints; trackBy: itemIndex;"
                                kendoResizeHint
                                    [hint]="hint"
                                    [ngClass]="hint.class"
                                    [format]="resizeHintFormat">
                            </div>
                        </ng-template>
                     </kendo-hint-container>
                </div>
            </div>
        </div>
    `
            }]
    }], function () { return [{ type: ViewContextService }, { type: ViewStateService }, { type: ɵngcc3.IntlService }, { type: MonthSlotService }, { type: ɵngcc0.NgZone }, { type: ɵngcc0.ElementRef }, { type: ɵngcc0.Renderer2 }, { type: PDFService }, { type: ɵngcc2.LocalizationService }]; }, { monthDaySlotTemplate: [{
            type: Input
        }] }); })();

/**
 * @hidden
 */
class BaseSlotDirective {
    constructor(element, slotService, localization) {
        this.element = element;
        this.slotService = slotService;
        this.localization = localization;
        this._rect = null;
    }
    get slotIndex() {
        return this.key;
    }
    get rect() {
        if (this._rect) {
            return this._rect;
        }
        const el = this.nativeElement;
        this._rect = {
            left: !this.localization.rtl ? el.offsetLeft : this.slotService.containerSize - (el.offsetLeft + el.clientWidth),
            top: el.offsetTop,
            width: el.clientWidth,
            height: el.clientHeight
        };
        return this._rect;
    }
    get top() {
        return this.element ? this.nativeElement.offsetTop : 0;
    }
    get padding() {
        if (!this.element || !isDocumentAvailable()) {
            return 0;
        }
        return parseInt(window.getComputedStyle(this.nativeElement).paddingTop, 10) * 2;
    }
    get height() {
        return this.element ? this.nativeElement.offsetHeight : 0;
    }
    set height(value) {
        if (this.element) {
            this.nativeElement.style.height = `${value}px`;
        }
        if (this._rect) {
            this._rect.height = value;
        }
    }
    get width() {
        return this.element ? this.nativeElement.offsetWidth : 0;
    }
    get key() {
        return `${this.id.resourceIndex}:${this.id.rangeIndex}:${this.id.index}`;
    }
    get nativeElement() {
        return this.element.nativeElement;
    }
    ngOnInit() {
        this.slotService.registerSlot(this);
    }
    ngOnDestroy() {
        this.slotService.unregisterSlot(this);
    }
    invalidate() {
        this._rect = null;
    }
}
BaseSlotDirective.ɵfac = function BaseSlotDirective_Factory(t) { ɵngcc0.ɵɵinvalidFactory(); };
BaseSlotDirective.ɵdir = ɵngcc0.ɵɵdefineDirective({ type: BaseSlotDirective, hostVars: 1, hostBindings: function BaseSlotDirective_HostBindings(rf, ctx) { if (rf & 2) {
        ɵngcc0.ɵɵattribute("data-slot-index", ctx.slotIndex);
    } }, inputs: { id: "id" } });
BaseSlotDirective.propDecorators = {
    id: [{ type: Input }],
    slotIndex: [{ type: HostBinding, args: ['attr.data-slot-index',] }]
};


/**
 * @hidden
 */
class MonthSlotDirective extends BaseSlotDirective {
    constructor(element, slotService, localization) {
        super(element, slotService, localization);
        this.isDaySlot = true;
        this._linkHeight = null;
    }
    set start(value) {
        this.startDate = toUTCDate(value);
    }
    get start() {
        return this.startDate;
    }
    get end() {
        return addUTCDays(this.start, 1);
    }
    get linkHeight() {
        if (this._linkHeight === null) {
            const element = firstElementChild(this.nativeElement);
            this._linkHeight = element ? element.offsetHeight + element.offsetTop : 0;
        }
        return this._linkHeight;
    }
    ngOnDestroy() {
        super.ngOnDestroy();
        this.removeShowMore();
    }
    showMore(rect) {
        if (!this.showMoreElement) {
            const element = this.showMoreElement = document.createElement('div');
            element.innerHTML = '<span class="k-icon k-i-more-horizontal"></span>';
            element.className = 'k-more-events k-button';
            element.style.width = `${rect.width}px`;
            element.style.left = `${rect.left}px`;
            element.style.top = `${rect.top}px`;
            this.nativeElement.appendChild(element);
        }
    }
    hideMore() {
        this.removeShowMore();
    }
    invalidate() {
        super.invalidate();
        this._linkHeight = null;
        this.removeShowMore();
    }
    removeShowMore() {
        if (this.showMoreElement) {
            this.showMoreElement.parentNode.removeChild(this.showMoreElement);
            this.showMoreElement = null;
        }
    }
}
MonthSlotDirective.ɵfac = function MonthSlotDirective_Factory(t) { return new (t || MonthSlotDirective)(ɵngcc0.ɵɵdirectiveInject(ɵngcc0.ElementRef), ɵngcc0.ɵɵdirectiveInject(MonthSlotService), ɵngcc0.ɵɵdirectiveInject(ɵngcc2.LocalizationService)); };
MonthSlotDirective.ɵdir = ɵngcc0.ɵɵdefineDirective({ type: MonthSlotDirective, selectors: [["", "monthSlot", ""]], inputs: { start: "start" }, features: [ɵngcc0.ɵɵInheritDefinitionFeature] });
/** @nocollapse */
MonthSlotDirective.ctorParameters = () => [
    { type: ElementRef },
    { type: MonthSlotService },
    { type: LocalizationService }
];
MonthSlotDirective.propDecorators = {
    start: [{ type: Input }]
};
/*@__PURE__*/ (function () { ɵngcc0.ɵsetClassMetadata(MonthSlotDirective, [{
        type: Directive,
        args: [{
                // tslint:disable-next-line:directive-selector
                selector: '[monthSlot]'
            }]
    }], function () { return [{ type: ɵngcc0.ElementRef }, { type: MonthSlotService }, { type: ɵngcc2.LocalizationService }]; }, { start: [{
            type: Input
        }] }); })();

/**
 * @hidden
 */
class ViewFooterComponent {
    constructor() {
        this.hostClasses = true;
        this.itemClick = new EventEmitter();
    }
    onItemClick(e, item) {
        e.preventDefault();
        this.itemClick.emit(item);
    }
}
ViewFooterComponent.ɵfac = function ViewFooterComponent_Factory(t) { return new (t || ViewFooterComponent)(); };
ViewFooterComponent.ɵcmp = ɵngcc0.ɵɵdefineComponent({ type: ViewFooterComponent, selectors: [["", "viewFooter", ""]], hostVars: 4, hostBindings: function ViewFooterComponent_HostBindings(rf, ctx) { if (rf & 2) {
        ɵngcc0.ɵɵclassProp("k-header", ctx.hostClasses)("k-scheduler-footer", ctx.hostClasses);
    } }, inputs: { items: "items" }, outputs: { itemClick: "itemClick" }, attrs: _c179, decls: 2, vars: 1, consts: [[1, "k-reset", "k-header"], ["class", "k-state-default", 3, "ngClass", "click", 4, "ngFor", "ngForOf"], [1, "k-state-default", 3, "ngClass", "click"], ["href", "#", "tabindex", "-1", 1, "k-link"], [1, "k-icon", 3, "ngClass"]], template: function ViewFooterComponent_Template(rf, ctx) { if (rf & 1) {
        ɵngcc0.ɵɵelementStart(0, "ul", 0);
        ɵngcc0.ɵɵtemplate(1, ViewFooterComponent_li_1_Template, 4, 3, "li", 1);
        ɵngcc0.ɵɵelementEnd();
    } if (rf & 2) {
        ɵngcc0.ɵɵadvance(1);
        ɵngcc0.ɵɵproperty("ngForOf", ctx.items);
    } }, directives: [ɵngcc4.NgForOf, ɵngcc4.NgClass], encapsulation: 2 });
ViewFooterComponent.propDecorators = {
    hostClasses: [{ type: HostBinding, args: ['class.k-header',] }, { type: HostBinding, args: ['class.k-scheduler-footer',] }],
    itemClick: [{ type: Output }],
    items: [{ type: Input }]
};
/*@__PURE__*/ (function () { ɵngcc0.ɵsetClassMetadata(ViewFooterComponent, [{
        type: Component,
        args: [{
                // tslint:disable-next-line:component-selector
                selector: '[viewFooter]',
                template: `
        <ul class="k-reset k-header">
            <li class="k-state-default" *ngFor="let item of items" [ngClass]="item.cssClass" (click)="onItemClick($event, item)">
                <a href="#" class="k-link" tabindex="-1">
                    <span class="k-icon" [ngClass]="item.iconClass"></span>
                    {{ item.text }}
                </a>
            </li>
        </ul>
    `
            }]
    }], function () { return []; }, { hostClasses: [{
            type: HostBinding,
            args: ['class.k-header']
        }, {
            type: HostBinding,
            args: ['class.k-scheduler-footer']
        }], itemClick: [{
            type: Output
        }], items: [{
            type: Input
        }] }); })();

/**
 * @hidden
 */
class WorkHoursFooterDirective {
    constructor(footer, localization) {
        this.footer = footer;
        this.localization = localization;
        this.showWorkHours = false;
        this.footerItems = [{ cssClass: 'k-scheduler-fullday', iconClass: 'k-i-clock', text: '' }];
    }
    ngOnInit() {
        this.toggleWorkHours();
        this.footer.items = this.footerItems;
    }
    ngOnChanges() {
        this.toggleWorkHours();
    }
    toggleWorkHours() {
        this.footerItems[0].text = this.showWorkHours ? this.localization.get('showFullDay') : this.localization.get('showWorkDay');
    }
}
WorkHoursFooterDirective.ɵfac = function WorkHoursFooterDirective_Factory(t) { return new (t || WorkHoursFooterDirective)(ɵngcc0.ɵɵdirectiveInject(ViewFooterComponent), ɵngcc0.ɵɵdirectiveInject(ɵngcc2.LocalizationService)); };
WorkHoursFooterDirective.ɵdir = ɵngcc0.ɵɵdefineDirective({ type: WorkHoursFooterDirective, selectors: [["", "kendoWorkHoursFooter", ""]], inputs: { showWorkHours: "showWorkHours" }, features: [ɵngcc0.ɵɵNgOnChangesFeature] });
/** @nocollapse */
WorkHoursFooterDirective.ctorParameters = () => [
    { type: ViewFooterComponent },
    { type: LocalizationService }
];
WorkHoursFooterDirective.propDecorators = {
    showWorkHours: [{ type: Input }]
};
/*@__PURE__*/ (function () { ɵngcc0.ɵsetClassMetadata(WorkHoursFooterDirective, [{
        type: Directive,
        args: [{
                selector: '[kendoWorkHoursFooter]'
            }]
    }], function () { return [{ type: ViewFooterComponent }, { type: ɵngcc2.LocalizationService }]; }, { showWorkHours: [{
            type: Input
        }] }); })();

class NumberIterator {
    constructor(count) {
        this.count = count;
    }
    *[iterator]() {
        for (let i = 0; i < this.count; i++) {
            yield i;
        }
    }
}
/**
 * @hidden
 */
class RepeatPipe {
    transform(value) {
        return new NumberIterator(value);
    }
}
RepeatPipe.ɵfac = function RepeatPipe_Factory(t) { return new (t || RepeatPipe)(); };
RepeatPipe.ɵpipe = ɵngcc0.ɵɵdefinePipe({ name: "repeat", type: RepeatPipe, pure: true });
/*@__PURE__*/ (function () { ɵngcc0.ɵsetClassMetadata(RepeatPipe, [{
        type: Pipe,
        args: [{
                // tslint:disable-next-line:pipe-naming
                name: 'repeat'
            }]
    }], null, null); })();

class ResourceIterator {
    constructor(resources, lastIndex = resources.length - 1) {
        this.resources = resources;
        this.lastIndex = lastIndex;
    }
    *[iterator]() {
        let resources = this.resources;
        const lastIndex = Math.max(0, this.lastIndex);
        if (!(resources && resources.length)) {
            resources = [{}];
        }
        const lastData = resources[lastIndex].data || [];
        const length = lastData.length;
        let count = 1;
        for (let idx = 0; idx <= lastIndex; idx++) {
            count *= (resources[idx].data || []).length || 1;
        }
        for (let idx = 0; idx < count; idx++) {
            yield lastData[idx % length];
        }
    }
}
/**
 * @hidden
 */
class ResourceIteratorPipe {
    transform(resources = [], lastIndex) {
        return new ResourceIterator(resources, lastIndex);
    }
}
ResourceIteratorPipe.ɵfac = function ResourceIteratorPipe_Factory(t) { return new (t || ResourceIteratorPipe)(); };
ResourceIteratorPipe.ɵpipe = ɵngcc0.ɵɵdefinePipe({ name: "resourceIterator", type: ResourceIteratorPipe, pure: true });
/*@__PURE__*/ (function () { ɵngcc0.ɵsetClassMetadata(ResourceIteratorPipe, [{
        type: Pipe,
        args: [{
                // tslint:disable-next-line:pipe-naming
                name: 'resourceIterator'
            }]
    }], null, null); })();

/**
 * @hidden
 */
class ResizeHintComponent {
    constructor() {
        this.marqueeClasses = true;
    }
    get left() {
        return this.hint.rect.left;
    }
    get top() {
        return this.hint.rect.top;
    }
    get width() {
        return this.hint.rect.width;
    }
    get height() {
        return this.hint.rect.height;
    }
    get start() {
        return toLocalDate(this.hint.start);
    }
    get end() {
        return toLocalDate(this.hint.end);
    }
}
ResizeHintComponent.ɵfac = function ResizeHintComponent_Factory(t) { return new (t || ResizeHintComponent)(); };
ResizeHintComponent.ɵcmp = ɵngcc0.ɵɵdefineComponent({ type: ResizeHintComponent, selectors: [["", "kendoResizeHint", ""]], hostVars: 18, hostBindings: function ResizeHintComponent_HostBindings(rf, ctx) { if (rf & 2) {
        ɵngcc0.ɵɵstyleProp("left", ctx.left, "px")("right", ctx.left, "px")("top", ctx.top, "px")("width", ctx.width, "px")("height", ctx.height, "px");
        ɵngcc0.ɵɵclassProp("k-marquee", ctx.marqueeClasses)("k-scheduler-marquee", ctx.marqueeClasses)("k-first", ctx.marqueeClasses)("k-last", ctx.marqueeClasses);
    } }, inputs: { hint: "hint", format: "format" }, attrs: _c180, decls: 4, vars: 2, consts: [[1, "k-marquee-color"], [1, "k-marquee-text"], ["class", "k-label-top", 4, "ngIf"], ["class", "k-label-bottom", 4, "ngIf"], [1, "k-label-top"], [1, "k-label-bottom"]], template: function ResizeHintComponent_Template(rf, ctx) { if (rf & 1) {
        ɵngcc0.ɵɵelement(0, "div", 0);
        ɵngcc0.ɵɵelementStart(1, "div", 1);
        ɵngcc0.ɵɵtemplate(2, ResizeHintComponent_div_2_Template, 3, 4, "div", 2);
        ɵngcc0.ɵɵtemplate(3, ResizeHintComponent_div_3_Template, 3, 4, "div", 3);
        ɵngcc0.ɵɵelementEnd();
    } if (rf & 2) {
        ɵngcc0.ɵɵadvance(2);
        ɵngcc0.ɵɵproperty("ngIf", ctx.hint.first);
        ɵngcc0.ɵɵadvance(1);
        ɵngcc0.ɵɵproperty("ngIf", ctx.hint.last);
    } }, directives: [ɵngcc4.NgIf], pipes: [ɵngcc3.DatePipe], encapsulation: 2 });
ResizeHintComponent.propDecorators = {
    hint: [{ type: Input }],
    format: [{ type: Input }],
    marqueeClasses: [{ type: HostBinding, args: ['class.k-marquee',] }, { type: HostBinding, args: ['class.k-scheduler-marquee',] }, { type: HostBinding, args: ['class.k-first',] }, { type: HostBinding, args: ['class.k-last',] }],
    left: [{ type: HostBinding, args: ['style.left.px',] }, { type: HostBinding, args: ['style.right.px',] }],
    top: [{ type: HostBinding, args: ['style.top.px',] }],
    width: [{ type: HostBinding, args: ['style.width.px',] }],
    height: [{ type: HostBinding, args: ['style.height.px',] }]
};
/*@__PURE__*/ (function () { ɵngcc0.ɵsetClassMetadata(ResizeHintComponent, [{
        type: Component,
        args: [{
                // tslint:disable-next-line:component-selector
                selector: '[kendoResizeHint]',
                template: `
        <div class="k-marquee-color"></div>
        <div class="k-marquee-text">
            <div class="k-label-top" *ngIf="hint.first">{{ start | kendoDate : format }}</div>
            <div class="k-label-bottom" *ngIf="hint.last">{{ end | kendoDate : format }}</div>
        </div>
    `
            }]
    }], function () { return []; }, { marqueeClasses: [{
            type: HostBinding,
            args: ['class.k-marquee']
        }, {
            type: HostBinding,
            args: ['class.k-scheduler-marquee']
        }, {
            type: HostBinding,
            args: ['class.k-first']
        }, {
            type: HostBinding,
            args: ['class.k-last']
        }], left: [{
            type: HostBinding,
            args: ['style.left.px']
        }, {
            type: HostBinding,
            args: ['style.right.px']
        }], top: [{
            type: HostBinding,
            args: ['style.top.px']
        }], width: [{
            type: HostBinding,
            args: ['style.width.px']
        }], height: [{
            type: HostBinding,
            args: ['style.height.px']
        }], hint: [{
            type: Input
        }], format: [{
            type: Input
        }] }); })();

const DECLARATIONS = [
    ViewFooterComponent,
    WorkHoursFooterDirective,
    RepeatPipe,
    ResourceIteratorPipe,
    HintContainerComponent,
    ResizeHintComponent
];
/**
 * @hidden
 */
class ViewsSharedModule {
}
ViewsSharedModule.ɵmod = ɵngcc0.ɵɵdefineNgModule({ type: ViewsSharedModule });
ViewsSharedModule.ɵinj = ɵngcc0.ɵɵdefineInjector({ factory: function ViewsSharedModule_Factory(t) { return new (t || ViewsSharedModule)(); }, imports: [[CommonModule, IntlModule, SharedModule],
        IntlModule,
        CommonModule,
        SharedModule] });
(function () { (typeof ngJitMode === "undefined" || ngJitMode) && ɵngcc0.ɵɵsetNgModuleScope(ViewsSharedModule, { declarations: function () { return [ViewFooterComponent,
        WorkHoursFooterDirective,
        RepeatPipe,
        ResourceIteratorPipe,
        HintContainerComponent,
        ResizeHintComponent]; }, imports: function () { return [CommonModule, IntlModule,
        SharedModule]; }, exports: function () { return [ViewFooterComponent,
        WorkHoursFooterDirective,
        RepeatPipe,
        ResourceIteratorPipe,
        HintContainerComponent,
        ResizeHintComponent,
        IntlModule,
        CommonModule,
        SharedModule]; } }); })();
/*@__PURE__*/ (function () { ɵngcc0.ɵsetClassMetadata(ViewsSharedModule, [{
        type: NgModule,
        args: [{
                imports: [CommonModule, IntlModule, SharedModule],
                exports: [
                    DECLARATIONS,
                    IntlModule,
                    CommonModule,
                    SharedModule
                ],
                declarations: [
                    DECLARATIONS
                ]
            }]
    }], null, null); })();

/**
 * @hidden
 */
class MonthViewModule {
}
MonthViewModule.ɵmod = ɵngcc0.ɵɵdefineNgModule({ type: MonthViewModule });
MonthViewModule.ɵinj = ɵngcc0.ɵɵdefineInjector({ factory: function MonthViewModule_Factory(t) { return new (t || MonthViewModule)(); }, imports: [[
            ViewsSharedModule
        ]] });
(function () { (typeof ngJitMode === "undefined" || ngJitMode) && ɵngcc0.ɵɵsetNgModuleScope(MonthViewModule, { declarations: [MonthViewComponent,
        MonthViewRendererComponent,
        MonthViewItemComponent,
        MonthSlotDirective], imports: [ViewsSharedModule], exports: [MonthViewComponent] }); })();
/*@__PURE__*/ (function () { ɵngcc0.ɵsetClassMetadata(MonthViewModule, [{
        type: NgModule,
        args: [{
                imports: [
                    ViewsSharedModule
                ],
                exports: [
                    MonthViewComponent
                ],
                declarations: [
                    MonthViewComponent,
                    MonthViewRendererComponent,
                    MonthViewItemComponent,
                    MonthSlotDirective
                ]
            }]
    }], null, null); })();

const EVENT_HEIGHT = 'eventHeight';
const SHOW_WORK_HOURS = 'showWorkHours';
const START_TIME = 'startTime';
const END_TIME = 'endTime';
const WORK_DAY_START = 'workDayStart';
const WORK_DAY_END = 'workDayEnd';
const WORK_WEEK_START = 'workWeekStart';
const WORK_WEEK_END = 'workWeekEnd';
const SLOT_DURATION = 'slotDuration';
const SLOT_DIVISIONS = 'slotDivisions';
const CURRENT_TIME_MARKER = 'currentTimeMarker';
/**
 * @hidden
 */
class DayTimeViewBase extends ConfigurationViewBase {
    constructor(localization, changeDetector, viewContext, viewState) {
        super(localization, changeDetector, viewContext, viewState);
    }
    /**
     * @hidden
     */
    get viewEventHeight() {
        return this.optionValue(EVENT_HEIGHT) || DEFAULT_EVENT_HEIGHT;
    }
    /**
     * @hidden
     */
    get shouldShowWorkHours() {
        return this.optionValue(SHOW_WORK_HOURS);
    }
    /**
     * @hidden
     */
    get viewStartTime() {
        return this.optionValue(START_TIME);
    }
    /**
     * @hidden
     */
    get viewEndTime() {
        return this.optionValue(END_TIME);
    }
    /**
     * @hidden
     */
    get viewWorkDayStart() {
        return this.optionValue(WORK_DAY_START);
    }
    /**
     * @hidden
     */
    get viewWorkDayEnd() {
        return this.optionValue(WORK_DAY_END);
    }
    /**
     * @hidden
     */
    get viewWorkWeekStart() {
        return this.optionValue(WORK_WEEK_START);
    }
    /**
     * @hidden
     */
    get viewWorkWeekEnd() {
        return this.optionValue(WORK_WEEK_END);
    }
    /**
     * @hidden
     */
    get viewSlotDuration() {
        return this.optionValue(SLOT_DURATION);
    }
    /**
     * @hidden
     */
    get viewSlotDivisions() {
        return this.optionValue(SLOT_DIVISIONS);
    }
    /**
     * @hidden
     */
    get viewCurrentTimeMarker() {
        return this.optionValue(CURRENT_TIME_MARKER);
    }
    /**
     * @hidden
     */
    get viewScrollTime() {
        return this.optionValue('scrollTime');
    }
    optionValue(name) {
        return isPresent(this[name]) ? this[name] : this.schedulerOptions[name];
    }
}
DayTimeViewBase.ɵfac = function DayTimeViewBase_Factory(t) { ɵngcc0.ɵɵinvalidFactory(); };
DayTimeViewBase.ɵdir = ɵngcc0.ɵɵdefineDirective({ type: DayTimeViewBase, contentQueries: function DayTimeViewBase_ContentQueries(rf, ctx, dirIndex) { if (rf & 1) {
        ɵngcc0.ɵɵcontentQuery(dirIndex, TimeSlotTemplateDirective, true);
        ɵngcc0.ɵɵcontentQuery(dirIndex, DateHeaderTemplateDirective, true);
    } if (rf & 2) {
        var _t;
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.timeSlotTemplate = _t.first);
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.dateHeaderTemplate = _t.first);
    } }, inputs: { showWorkHours: "showWorkHours", eventHeight: "eventHeight", startTime: "startTime", scrollTime: "scrollTime", endTime: "endTime", workDayStart: "workDayStart", workDayEnd: "workDayEnd", workWeekStart: "workWeekStart", workWeekEnd: "workWeekEnd", slotDuration: "slotDuration", slotDivisions: "slotDivisions", currentTimeMarker: "currentTimeMarker" }, features: [ɵngcc0.ɵɵInheritDefinitionFeature] });
DayTimeViewBase.propDecorators = {
    timeSlotTemplate: [{ type: ContentChild, args: [TimeSlotTemplateDirective,] }],
    dateHeaderTemplate: [{ type: ContentChild, args: [DateHeaderTemplateDirective,] }],
    showWorkHours: [{ type: Input }],
    eventHeight: [{ type: Input }],
    startTime: [{ type: Input }],
    scrollTime: [{ type: Input }],
    endTime: [{ type: Input }],
    workDayStart: [{ type: Input }],
    workDayEnd: [{ type: Input }],
    workWeekStart: [{ type: Input }],
    workWeekEnd: [{ type: Input }],
    slotDuration: [{ type: Input }],
    slotDivisions: [{ type: Input }],
    currentTimeMarker: [{ type: Input }]
};


const SLOT_FILL = 'slotFill';
/**
 * @hidden
 */
class MultiDayViewBase extends DayTimeViewBase {
    constructor(localization, changeDetector, viewContext, viewState) {
        super(localization, changeDetector, viewContext, viewState);
    }
    /**
     * @hidden
     */
    get viewSlotFill() {
        return this.optionValue(SLOT_FILL);
    }
}
MultiDayViewBase.ɵfac = function MultiDayViewBase_Factory(t) { ɵngcc0.ɵɵinvalidFactory(); };
MultiDayViewBase.ɵdir = ɵngcc0.ɵɵdefineDirective({ type: MultiDayViewBase, inputs: { slotFill: "slotFill" }, features: [ɵngcc0.ɵɵInheritDefinitionFeature] });
MultiDayViewBase.propDecorators = {
    slotFill: [{ type: Input }]
};


/**
 * The component for rendering the **Day** view.
 */
class DayViewComponent extends MultiDayViewBase {
    constructor(localization, changeDetector, viewContext, viewState) {
        super(localization, changeDetector, viewContext, viewState);
        /**
         * The long-date format for displaying the
         * selected date in the Scheduler toolbar.
         * Defaults to `{0:D}`
         * ([more information]({% slug parsingandformatting_intl %}#toc-date-formatting)).
         */
        this.selectedDateFormat = '{0:D}';
        /**
         * The short-date format for displaying the
         * selected date in the Scheduler toolbar.
         * Defaults to `{0:D}`
         * ([more information]({% slug parsingandformatting_intl %}#toc-date-formatting)).
         */
        this.selectedShortDateFormat = '{0:d}';
        /**
         * The invariant name for this view (`day`).
         */
        this.name = 'day';
    }
    /**
     * @hidden
     */
    get title() {
        return this.localization.get('dayViewTitle');
    }
}
DayViewComponent.ɵfac = function DayViewComponent_Factory(t) { return new (t || DayViewComponent)(ɵngcc0.ɵɵdirectiveInject(ɵngcc2.LocalizationService), ɵngcc0.ɵɵdirectiveInject(ɵngcc0.ChangeDetectorRef), ɵngcc0.ɵɵdirectiveInject(ViewContextService), ɵngcc0.ɵɵdirectiveInject(ViewStateService)); };
DayViewComponent.ɵcmp = ɵngcc0.ɵɵdefineComponent({ type: DayViewComponent, selectors: [["kendo-scheduler-day-view"]], contentQueries: function DayViewComponent_ContentQueries(rf, ctx, dirIndex) { if (rf & 1) {
        ɵngcc0.ɵɵcontentQuery(dirIndex, AllDaySlotTemplateDirective, true);
        ɵngcc0.ɵɵcontentQuery(dirIndex, AllDayEventTemplateDirective, true);
        ɵngcc0.ɵɵcontentQuery(dirIndex, MinorTimeHeaderTemplateDirective, true);
        ɵngcc0.ɵɵcontentQuery(dirIndex, MajorTimeHeaderTemplateDirective, true);
    } if (rf & 2) {
        var _t;
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.allDaySlotTemplate = _t.first);
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.allDayEventTemplate = _t.first);
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.minorTimeHeaderTemplate = _t.first);
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.majorTimeHeaderTemplate = _t.first);
    } }, inputs: { selectedDateFormat: "selectedDateFormat", selectedShortDateFormat: "selectedShortDateFormat" }, features: [ɵngcc0.ɵɵProvidersFeature([{
                provide: SchedulerView,
                // tslint:disable-next-line:no-forward-ref
                useExisting: forwardRef(() => DayViewComponent)
            }]), ɵngcc0.ɵɵInheritDefinitionFeature], decls: 2, vars: 0, consts: [["content", ""], [3, "name", "eventHeight", "currentTimeMarker", "showWorkHours", "scrollTime", "startTime", "endTime", "workDayStart", "workDayEnd", "workWeekStart", "workWeekEnd", "slotDuration", "slotDivisions", "slotFill", "slotClass", "eventClass", "eventStyles", "allDaySlotTemplate", "allDayEventTemplate", "\u0435ventTemplate", "groupHeaderTemplate", "timeSlotTemplate", "minorTimeHeaderTemplate", "majorTimeHeaderTemplate", "dateHeaderTemplate", "selectedDateFormat", "selectedShortDateFormat"], ["viewFooter", "", "kendoWorkHoursFooter", "", 3, "showWorkHours", "itemClick"]], template: function DayViewComponent_Template(rf, ctx) { if (rf & 1) {
        ɵngcc0.ɵɵtemplate(0, DayViewComponent_ng_template_0_Template, 2, 28, "ng-template", null, 0, ɵngcc0.ɵɵtemplateRefExtractor);
    } }, directives: function () { return [MultiDayViewRendererComponent,
        ViewFooterComponent,
        WorkHoursFooterDirective]; }, encapsulation: 2, changeDetection: 0 });
/** @nocollapse */
DayViewComponent.ctorParameters = () => [
    { type: LocalizationService },
    { type: ChangeDetectorRef },
    { type: ViewContextService },
    { type: ViewStateService }
];
DayViewComponent.propDecorators = {
    selectedDateFormat: [{ type: Input }],
    selectedShortDateFormat: [{ type: Input }],
    allDaySlotTemplate: [{ type: ContentChild, args: [AllDaySlotTemplateDirective,] }],
    allDayEventTemplate: [{ type: ContentChild, args: [AllDayEventTemplateDirective,] }],
    minorTimeHeaderTemplate: [{ type: ContentChild, args: [MinorTimeHeaderTemplateDirective,] }],
    majorTimeHeaderTemplate: [{ type: ContentChild, args: [MajorTimeHeaderTemplateDirective,] }]
};
/*@__PURE__*/ (function () { ɵngcc0.ɵsetClassMetadata(DayViewComponent, [{
        type: Component,
        args: [{
                changeDetection: ChangeDetectionStrategy.OnPush,
                selector: 'kendo-scheduler-day-view',
                providers: [{
                        provide: SchedulerView,
                        // tslint:disable-next-line:no-forward-ref
                        useExisting: forwardRef(() => DayViewComponent)
                    }],
                template: `
        <ng-template #content>
            <multi-day-view
                [name]="name"
                [eventHeight]="viewEventHeight"
                [currentTimeMarker]="viewCurrentTimeMarker"
                [showWorkHours]="shouldShowWorkHours"
                [scrollTime]="viewScrollTime"
                [startTime]="viewStartTime"
                [endTime]="viewEndTime"
                [workDayStart]="viewWorkDayStart"
                [workDayEnd]="viewWorkDayEnd"
                [workWeekStart]="viewWorkWeekStart"
                [workWeekEnd]="viewWorkWeekEnd"
                [slotDuration]="viewSlotDuration"
                [slotDivisions]="viewSlotDivisions"
                [slotFill]="viewSlotFill"
                [slotClass]="viewSlotClass"
                [eventClass]="viewEventClass"
                [eventStyles]="viewEventStyles"
                [allDaySlotTemplate]="allDaySlotTemplate?.templateRef"
                [allDayEventTemplate]="allDayEventTemplate?.templateRef"
                [еventTemplate]="eventTemplate?.templateRef"
                [groupHeaderTemplate]="groupHeaderTemplate?.templateRef"
                [timeSlotTemplate]="timeSlotTemplate?.templateRef"
                [minorTimeHeaderTemplate]="minorTimeHeaderTemplate?.templateRef"
                [majorTimeHeaderTemplate]="majorTimeHeaderTemplate?.templateRef"
                [dateHeaderTemplate]="dateHeaderTemplate?.templateRef"
                [selectedDateFormat]="selectedDateFormat"
                [selectedShortDateFormat]="selectedShortDateFormat">
            </multi-day-view>
            <div viewFooter kendoWorkHoursFooter [showWorkHours]="shouldShowWorkHours" (itemClick)="showWorkHours = !shouldShowWorkHours"></div>
        </ng-template>
    `
            }]
    }], function () { return [{ type: ɵngcc2.LocalizationService }, { type: ɵngcc0.ChangeDetectorRef }, { type: ViewContextService }, { type: ViewStateService }]; }, { selectedDateFormat: [{
            type: Input
        }], selectedShortDateFormat: [{
            type: Input
        }], allDaySlotTemplate: [{
            type: ContentChild,
            args: [AllDaySlotTemplateDirective]
        }], allDayEventTemplate: [{
            type: ContentChild,
            args: [AllDayEventTemplateDirective]
        }], minorTimeHeaderTemplate: [{
            type: ContentChild,
            args: [MinorTimeHeaderTemplateDirective]
        }], majorTimeHeaderTemplate: [{
            type: ContentChild,
            args: [MajorTimeHeaderTemplateDirective]
        }] }); })();

/**
 * The component for rendering the **Multi-Day** view.
 */
class MultiDayViewComponent extends DayViewComponent {
    constructor(localization, changeDetector, viewContext, viewState) {
        super(localization, changeDetector, viewContext, viewState);
        /**
         * Specifies the number of days that the view will render.
         * Defaults to `1`.
         */
        this.numberOfDays = 1;
        /**
         * The invariant name for this view (`multi-day`).
         */
        this.name = 'multiDay';
    }
    /**
     * The long-date format for displaying the
     * selected date in the Scheduler toolbar.
     * Defaults to `{0:D} - {1:D}` for multiple days and `{0:D}` for a single day
     * ([more information]({% slug parsingandformatting_intl %}#toc-date-formatting).
     */
    set selectedDateFormat(value) {
        this.dateFormat = value;
    }
    get selectedDateFormat() {
        return this.dateFormat || this.defaultDateFormat;
    }
    /**
     * The short date format for displaying the
     * selected date in the Scheduler toolbar.
     * Defaults to `{0:d} - {1:d}` for multiple days and `{0:d}` for a single day
     * ([more information]({% slug parsingandformatting_intl %}#toc-date-formatting).
     */
    set selectedShortDateFormat(value) {
        this.shortDateFormat = value;
    }
    get selectedShortDateFormat() {
        return this.shortDateFormat || this.defaultShortDateFormat;
    }
    /**
     * @hidden
     */
    get title() {
        return this.localization.get('multiDayViewTitle');
    }
    get defaultDateFormat() {
        return this.numberOfDays === 1 ? '{0:D}' : '{0:D} - {1:D}';
    }
    get defaultShortDateFormat() {
        return this.numberOfDays === 1 ? '{0:d}' : '{0:d} - {1:d}';
    }
}
MultiDayViewComponent.ɵfac = function MultiDayViewComponent_Factory(t) { return new (t || MultiDayViewComponent)(ɵngcc0.ɵɵdirectiveInject(ɵngcc2.LocalizationService), ɵngcc0.ɵɵdirectiveInject(ɵngcc0.ChangeDetectorRef), ɵngcc0.ɵɵdirectiveInject(ViewContextService), ɵngcc0.ɵɵdirectiveInject(ViewStateService)); };
MultiDayViewComponent.ɵcmp = ɵngcc0.ɵɵdefineComponent({ type: MultiDayViewComponent, selectors: [["kendo-scheduler-multi-day-view"]], inputs: { numberOfDays: "numberOfDays", selectedDateFormat: "selectedDateFormat", selectedShortDateFormat: "selectedShortDateFormat" }, features: [ɵngcc0.ɵɵProvidersFeature([{
                provide: SchedulerView,
                // tslint:disable-next-line:no-forward-ref
                useExisting: forwardRef(() => MultiDayViewComponent)
            }]), ɵngcc0.ɵɵInheritDefinitionFeature], decls: 2, vars: 0, consts: [["content", ""], ["viewName", "day", 3, "name", "numberOfDays", "eventHeight", "currentTimeMarker", "showWorkHours", "scrollTime", "startTime", "endTime", "workDayStart", "workDayEnd", "workWeekStart", "workWeekEnd", "slotDuration", "slotDivisions", "slotFill", "slotClass", "eventClass", "eventStyles", "allDaySlotTemplate", "allDayEventTemplate", "\u0435ventTemplate", "groupHeaderTemplate", "timeSlotTemplate", "minorTimeHeaderTemplate", "majorTimeHeaderTemplate", "dateHeaderTemplate", "selectedDateFormat", "selectedShortDateFormat"], ["viewFooter", "", "kendoWorkHoursFooter", "", 3, "showWorkHours", "itemClick"]], template: function MultiDayViewComponent_Template(rf, ctx) { if (rf & 1) {
        ɵngcc0.ɵɵtemplate(0, MultiDayViewComponent_ng_template_0_Template, 2, 29, "ng-template", null, 0, ɵngcc0.ɵɵtemplateRefExtractor);
    } }, directives: function () { return [MultiDayViewRendererComponent,
        ViewFooterComponent,
        WorkHoursFooterDirective]; }, encapsulation: 2, changeDetection: 0 });
/** @nocollapse */
MultiDayViewComponent.ctorParameters = () => [
    { type: LocalizationService },
    { type: ChangeDetectorRef },
    { type: ViewContextService },
    { type: ViewStateService }
];
MultiDayViewComponent.propDecorators = {
    selectedDateFormat: [{ type: Input }],
    selectedShortDateFormat: [{ type: Input }],
    numberOfDays: [{ type: Input }]
};
/*@__PURE__*/ (function () { ɵngcc0.ɵsetClassMetadata(MultiDayViewComponent, [{
        type: Component,
        args: [{
                changeDetection: ChangeDetectionStrategy.OnPush,
                selector: 'kendo-scheduler-multi-day-view',
                providers: [{
                        provide: SchedulerView,
                        // tslint:disable-next-line:no-forward-ref
                        useExisting: forwardRef(() => MultiDayViewComponent)
                    }],
                template: `
        <ng-template #content>
            <multi-day-view
                viewName="day"
                [name]="name"
                [numberOfDays]="numberOfDays"
                [eventHeight]="viewEventHeight"
                [currentTimeMarker]="viewCurrentTimeMarker"
                [showWorkHours]="shouldShowWorkHours"
                [scrollTime]="viewScrollTime"
                [startTime]="viewStartTime"
                [endTime]="viewEndTime"
                [workDayStart]="viewWorkDayStart"
                [workDayEnd]="viewWorkDayEnd"
                [workWeekStart]="viewWorkWeekStart"
                [workWeekEnd]="viewWorkWeekEnd"
                [slotDuration]="viewSlotDuration"
                [slotDivisions]="viewSlotDivisions"
                [slotFill]="viewSlotFill"
                [slotClass]="viewSlotClass"
                [eventClass]="viewEventClass"
                [eventStyles]="viewEventStyles"
                [allDaySlotTemplate]="allDaySlotTemplate?.templateRef"
                [allDayEventTemplate]="allDayEventTemplate?.templateRef"
                [еventTemplate]="eventTemplate?.templateRef"
                [groupHeaderTemplate]="groupHeaderTemplate?.templateRef"
                [timeSlotTemplate]="timeSlotTemplate?.templateRef"
                [minorTimeHeaderTemplate]="minorTimeHeaderTemplate?.templateRef"
                [majorTimeHeaderTemplate]="majorTimeHeaderTemplate?.templateRef"
                [dateHeaderTemplate]="dateHeaderTemplate?.templateRef"
                [selectedDateFormat]="selectedDateFormat"
                [selectedShortDateFormat]="selectedShortDateFormat">
            </multi-day-view>
            <div viewFooter kendoWorkHoursFooter [showWorkHours]="shouldShowWorkHours" (itemClick)="showWorkHours = !shouldShowWorkHours"></div>
        </ng-template>
    `
            }]
    }], function () { return [{ type: ɵngcc2.LocalizationService }, { type: ɵngcc0.ChangeDetectorRef }, { type: ViewContextService }, { type: ViewStateService }]; }, { numberOfDays: [{
            type: Input
        }], selectedDateFormat: [{
            type: Input
        }], selectedShortDateFormat: [{
            type: Input
        }] }); })();

/**
 * The component for rendering the **Week** view.
 */
class WeekViewComponent extends MultiDayViewBase {
    constructor(intl, localization, changeDetector, viewContext, viewState) {
        super(localization, changeDetector, viewContext, viewState);
        this.intl = intl;
        /**
         * The long-date format for displaying the
         * selected date in the Scheduler toolbar.
         * Defaults to `{0:D} - {1:D}`,
         * where `0` is the start and `1` is the end date
         * ([more information]({% slug parsingandformatting_intl %}#toc-date-formatting).
         */
        this.selectedDateFormat = '{0:D} - {1:D}';
        /**
         * The short date format for displaying the
         * selected date in the Scheduler toolbar.
         * Defaults to `{0:d} - {1:d}`,
         * where `0` is the start and `1` is the end date
         * ([more information]({% slug parsingandformatting_intl %}#toc-date-formatting).
         */
        this.selectedShortDateFormat = '{0:d} - {1:d}';
        /**
         * The invariant name for this view (`week`).
         */
        this.name = 'week';
        this.getStartDate = this.getStartDate.bind(this);
    }
    /**
     * @hidden
     */
    get title() {
        return this.localization.get('weekViewTitle');
    }
    /**
     * @hidden
     */
    getStartDate(selectedDate) {
        return firstDayInWeek(getDate(selectedDate), this.intl.firstDay());
    }
}
WeekViewComponent.ɵfac = function WeekViewComponent_Factory(t) { return new (t || WeekViewComponent)(ɵngcc0.ɵɵdirectiveInject(ɵngcc3.IntlService), ɵngcc0.ɵɵdirectiveInject(ɵngcc2.LocalizationService), ɵngcc0.ɵɵdirectiveInject(ɵngcc0.ChangeDetectorRef), ɵngcc0.ɵɵdirectiveInject(ViewContextService), ɵngcc0.ɵɵdirectiveInject(ViewStateService)); };
WeekViewComponent.ɵcmp = ɵngcc0.ɵɵdefineComponent({ type: WeekViewComponent, selectors: [["kendo-scheduler-week-view"]], contentQueries: function WeekViewComponent_ContentQueries(rf, ctx, dirIndex) { if (rf & 1) {
        ɵngcc0.ɵɵcontentQuery(dirIndex, AllDaySlotTemplateDirective, true);
        ɵngcc0.ɵɵcontentQuery(dirIndex, AllDayEventTemplateDirective, true);
        ɵngcc0.ɵɵcontentQuery(dirIndex, MinorTimeHeaderTemplateDirective, true);
        ɵngcc0.ɵɵcontentQuery(dirIndex, MajorTimeHeaderTemplateDirective, true);
    } if (rf & 2) {
        var _t;
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.allDaySlotTemplate = _t.first);
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.allDayEventTemplate = _t.first);
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.minorTimeHeaderTemplate = _t.first);
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.majorTimeHeaderTemplate = _t.first);
    } }, inputs: { selectedDateFormat: "selectedDateFormat", selectedShortDateFormat: "selectedShortDateFormat" }, features: [ɵngcc0.ɵɵProvidersFeature([{
                provide: SchedulerView,
                // tslint:disable-next-line:no-forward-ref
                useExisting: forwardRef(() => WeekViewComponent)
            }]), ɵngcc0.ɵɵInheritDefinitionFeature], decls: 2, vars: 0, consts: [["content", ""], [3, "name", "numberOfDays", "getStartDate", "eventHeight", "currentTimeMarker", "showWorkHours", "scrollTime", "startTime", "endTime", "workDayStart", "workDayEnd", "workWeekStart", "workWeekEnd", "slotDuration", "slotDivisions", "slotFill", "slotClass", "eventClass", "eventStyles", "allDaySlotTemplate", "allDayEventTemplate", "\u0435ventTemplate", "groupHeaderTemplate", "timeSlotTemplate", "minorTimeHeaderTemplate", "majorTimeHeaderTemplate", "dateHeaderTemplate", "selectedDateFormat", "selectedShortDateFormat"], ["viewFooter", "", "kendoWorkHoursFooter", "", 3, "showWorkHours", "itemClick"]], template: function WeekViewComponent_Template(rf, ctx) { if (rf & 1) {
        ɵngcc0.ɵɵtemplate(0, WeekViewComponent_ng_template_0_Template, 2, 30, "ng-template", null, 0, ɵngcc0.ɵɵtemplateRefExtractor);
    } }, directives: function () { return [MultiDayViewRendererComponent,
        ViewFooterComponent,
        WorkHoursFooterDirective]; }, encapsulation: 2, changeDetection: 0 });
/** @nocollapse */
WeekViewComponent.ctorParameters = () => [
    { type: IntlService },
    { type: LocalizationService },
    { type: ChangeDetectorRef },
    { type: ViewContextService },
    { type: ViewStateService }
];
WeekViewComponent.propDecorators = {
    selectedDateFormat: [{ type: Input }],
    selectedShortDateFormat: [{ type: Input }],
    allDaySlotTemplate: [{ type: ContentChild, args: [AllDaySlotTemplateDirective,] }],
    allDayEventTemplate: [{ type: ContentChild, args: [AllDayEventTemplateDirective,] }],
    minorTimeHeaderTemplate: [{ type: ContentChild, args: [MinorTimeHeaderTemplateDirective,] }],
    majorTimeHeaderTemplate: [{ type: ContentChild, args: [MajorTimeHeaderTemplateDirective,] }]
};
/*@__PURE__*/ (function () { ɵngcc0.ɵsetClassMetadata(WeekViewComponent, [{
        type: Component,
        args: [{
                changeDetection: ChangeDetectionStrategy.OnPush,
                selector: 'kendo-scheduler-week-view',
                providers: [{
                        provide: SchedulerView,
                        // tslint:disable-next-line:no-forward-ref
                        useExisting: forwardRef(() => WeekViewComponent)
                    }],
                template: `
        <ng-template #content>
            <multi-day-view
                [name]="name"
                [numberOfDays]="7"
                [getStartDate]="getStartDate"
                [eventHeight]="viewEventHeight"
                [currentTimeMarker]="viewCurrentTimeMarker"
                [showWorkHours]="shouldShowWorkHours"
                [scrollTime]="viewScrollTime"
                [startTime]="viewStartTime"
                [endTime]="viewEndTime"
                [workDayStart]="viewWorkDayStart"
                [workDayEnd]="viewWorkDayEnd"
                [workWeekStart]="viewWorkWeekStart"
                [workWeekEnd]="viewWorkWeekEnd"
                [slotDuration]="viewSlotDuration"
                [slotDivisions]="viewSlotDivisions"
                [slotFill]="viewSlotFill"
                [slotClass]="viewSlotClass"
                [eventClass]="viewEventClass"
                [eventStyles]="viewEventStyles"
                [allDaySlotTemplate]="allDaySlotTemplate?.templateRef"
                [allDayEventTemplate]="allDayEventTemplate?.templateRef"
                [еventTemplate]="eventTemplate?.templateRef"
                [groupHeaderTemplate]="groupHeaderTemplate?.templateRef"
                [timeSlotTemplate]="timeSlotTemplate?.templateRef"
                [minorTimeHeaderTemplate]="minorTimeHeaderTemplate?.templateRef"
                [majorTimeHeaderTemplate]="majorTimeHeaderTemplate?.templateRef"
                [dateHeaderTemplate]="dateHeaderTemplate?.templateRef"
                [selectedDateFormat]="selectedDateFormat"
                [selectedShortDateFormat]="selectedShortDateFormat">
            </multi-day-view>
            <div viewFooter kendoWorkHoursFooter [showWorkHours]="shouldShowWorkHours" (itemClick)="showWorkHours = !shouldShowWorkHours"></div>
        </ng-template>
    `
            }]
    }], function () { return [{ type: ɵngcc3.IntlService }, { type: ɵngcc2.LocalizationService }, { type: ɵngcc0.ChangeDetectorRef }, { type: ViewContextService }, { type: ViewStateService }]; }, { selectedDateFormat: [{
            type: Input
        }], selectedShortDateFormat: [{
            type: Input
        }], allDaySlotTemplate: [{
            type: ContentChild,
            args: [AllDaySlotTemplateDirective]
        }], allDayEventTemplate: [{
            type: ContentChild,
            args: [AllDayEventTemplateDirective]
        }], minorTimeHeaderTemplate: [{
            type: ContentChild,
            args: [MinorTimeHeaderTemplateDirective]
        }], majorTimeHeaderTemplate: [{
            type: ContentChild,
            args: [MajorTimeHeaderTemplateDirective]
        }] }); })();

const DAYS_IN_WEEK$1 = 7;
/**
 * The component for rendering the **Work Week** view.
 */
class WorkWeekViewComponent extends WeekViewComponent {
    constructor(intl, localization, changeDetector, viewContext, viewState) {
        super(intl, localization, changeDetector, viewContext, viewState);
        /**
         * The invariant name for this view (`week`).
         */
        this.name = 'workWeek';
        this.getNextDate = this.getNextDate.bind(this);
    }
    /**
     * @hidden
     */
    get title() {
        return this.localization.get('workWeekViewTitle');
    }
    /**
     * @hidden
     */
    get numberOfDays() {
        if (this.viewWorkWeekStart > this.viewWorkWeekEnd) {
            return (DAYS_IN_WEEK$1 - this.viewWorkWeekStart + this.viewWorkWeekEnd) + 1;
        }
        return (this.viewWorkWeekEnd - this.viewWorkWeekStart) + 1;
    }
    /**
     * @hidden
     */
    getStartDate(selectedDate) {
        return firstDayInWeek(getDate(selectedDate), this.viewWorkWeekStart);
    }
    /**
     * @hidden
     */
    getNextDate(date, count, _numberOfDays) {
        return getDate(addDays(date, DAYS_IN_WEEK$1 * count));
    }
}
WorkWeekViewComponent.ɵfac = function WorkWeekViewComponent_Factory(t) { return new (t || WorkWeekViewComponent)(ɵngcc0.ɵɵdirectiveInject(ɵngcc3.IntlService), ɵngcc0.ɵɵdirectiveInject(ɵngcc2.LocalizationService), ɵngcc0.ɵɵdirectiveInject(ɵngcc0.ChangeDetectorRef), ɵngcc0.ɵɵdirectiveInject(ViewContextService), ɵngcc0.ɵɵdirectiveInject(ViewStateService)); };
WorkWeekViewComponent.ɵcmp = ɵngcc0.ɵɵdefineComponent({ type: WorkWeekViewComponent, selectors: [["kendo-scheduler-work-week-view"]], features: [ɵngcc0.ɵɵProvidersFeature([{
                provide: SchedulerView,
                // tslint:disable-next-line:no-forward-ref
                useExisting: forwardRef(() => WorkWeekViewComponent)
            }]), ɵngcc0.ɵɵInheritDefinitionFeature], decls: 2, vars: 0, consts: [["content", ""], ["viewName", "workWeekview", 3, "name", "numberOfDays", "getStartDate", "getNextDate", "eventHeight", "currentTimeMarker", "showWorkHours", "scrollTime", "startTime", "endTime", "workDayStart", "workDayEnd", "workWeekStart", "workWeekEnd", "slotDuration", "slotDivisions", "slotFill", "slotClass", "eventClass", "eventStyles", "allDaySlotTemplate", "allDayEventTemplate", "\u0435ventTemplate", "groupHeaderTemplate", "timeSlotTemplate", "minorTimeHeaderTemplate", "majorTimeHeaderTemplate", "dateHeaderTemplate", "selectedDateFormat", "selectedShortDateFormat"], ["viewFooter", "", "kendoWorkHoursFooter", "", 3, "showWorkHours", "itemClick"]], template: function WorkWeekViewComponent_Template(rf, ctx) { if (rf & 1) {
        ɵngcc0.ɵɵtemplate(0, WorkWeekViewComponent_ng_template_0_Template, 2, 31, "ng-template", null, 0, ɵngcc0.ɵɵtemplateRefExtractor);
    } }, directives: function () { return [MultiDayViewRendererComponent,
        ViewFooterComponent,
        WorkHoursFooterDirective]; }, encapsulation: 2, changeDetection: 0 });
/** @nocollapse */
WorkWeekViewComponent.ctorParameters = () => [
    { type: IntlService },
    { type: LocalizationService },
    { type: ChangeDetectorRef },
    { type: ViewContextService },
    { type: ViewStateService }
];
/*@__PURE__*/ (function () { ɵngcc0.ɵsetClassMetadata(WorkWeekViewComponent, [{
        type: Component,
        args: [{
                changeDetection: ChangeDetectionStrategy.OnPush,
                selector: 'kendo-scheduler-work-week-view',
                providers: [{
                        provide: SchedulerView,
                        // tslint:disable-next-line:no-forward-ref
                        useExisting: forwardRef(() => WorkWeekViewComponent)
                    }],
                template: `
        <ng-template #content>
            <multi-day-view
                viewName="workWeekview"
                [name]="name"
                [numberOfDays]="numberOfDays"
                [getStartDate]="getStartDate"
                [getNextDate]="getNextDate"
                [eventHeight]="viewEventHeight"
                [currentTimeMarker]="viewCurrentTimeMarker"
                [showWorkHours]="shouldShowWorkHours"
                [scrollTime]="viewScrollTime"
                [startTime]="viewStartTime"
                [endTime]="viewEndTime"
                [workDayStart]="viewWorkDayStart"
                [workDayEnd]="viewWorkDayEnd"
                [workWeekStart]="viewWorkWeekStart"
                [workWeekEnd]="viewWorkWeekEnd"
                [slotDuration]="viewSlotDuration"
                [slotDivisions]="viewSlotDivisions"
                [slotFill]="viewSlotFill"
                [slotClass]="viewSlotClass"
                [eventClass]="viewEventClass"
                [eventStyles]="viewEventStyles"
                [allDaySlotTemplate]="allDaySlotTemplate?.templateRef"
                [allDayEventTemplate]="allDayEventTemplate?.templateRef"
                [еventTemplate]="eventTemplate?.templateRef"
                [groupHeaderTemplate]="groupHeaderTemplate?.templateRef"
                [timeSlotTemplate]="timeSlotTemplate?.templateRef"
                [minorTimeHeaderTemplate]="minorTimeHeaderTemplate?.templateRef"
                [majorTimeHeaderTemplate]="majorTimeHeaderTemplate?.templateRef"
                [dateHeaderTemplate]="dateHeaderTemplate?.templateRef"
                [selectedDateFormat]="selectedDateFormat"
                [selectedShortDateFormat]="selectedShortDateFormat">
            </multi-day-view>
            <div viewFooter kendoWorkHoursFooter [showWorkHours]="shouldShowWorkHours" (itemClick)="showWorkHours = !shouldShowWorkHours"></div>
        </ng-template>
    `
            }]
    }], function () { return [{ type: ɵngcc3.IntlService }, { type: ɵngcc2.LocalizationService }, { type: ɵngcc0.ChangeDetectorRef }, { type: ViewContextService }, { type: ViewStateService }]; }, null); })();

const EVENTS_OFFSET = 10;
const MIN_EVENT_HEIGHT = 25;
const minHeightOverlaps = (top1, top2) => top1 <= top2 && top2 <= top1 + MIN_EVENT_HEIGHT;
const timeOffset = (slot, date, vertical = true) => {
    if (slot.start.getTime() <= date.getTime()) {
        return (vertical ? slot.height : slot.width) * ((date.getTime() - slot.start.getTime()) / (slot.end.getTime() - slot.start.getTime()));
    }
    return 0;
};
const columnIndexComparer = (a, b) => {
    const indexA = isNumber(a.columnIndex) ? a.columnIndex : Number.MAX_VALUE;
    const indexB = isNumber(b.columnIndex) ? b.columnIndex : Number.MAX_VALUE;
    // a un b def = 0
    // b un a def = 0
    if (indexA === indexB) {
        return a.item.startTime.getTime() - b.item.startTime.getTime();
    }
    return indexA - indexB;
};
function initTimeColumns(slotKeys, slotItems) {
    // Break slots into groups with overlapping events.
    let columns = 0;
    let groupSlots = [];
    slotKeys.forEach(key => {
        const { slot, events } = slotItems[key];
        const count = events.length;
        let groupEnd = true;
        events.sort(columnIndexComparer);
        columns = Math.max(count, columns);
        groupSlots.push(slot);
        for (let eventIdx = 0; eventIdx < count; eventIdx++) {
            const event = events[eventIdx];
            groupEnd = groupEnd && event.item.endTime.getTime() <= slot.end.getTime();
            if (isNumber(event.columnIndex)) {
                continue;
            }
            event.rect = {
                top: slot.rect.top + timeOffset(slot, event.item.startTime)
            };
            event.columnIndex = eventIdx;
            event.lastColumn = true;
            for (let idx = 0, previousIdx = -1; idx < eventIdx; idx++) {
                const current = events[idx];
                if (current.columnIndex > previousIdx + 1) {
                    event.columnIndex = previousIdx + 1;
                    event.lastColumn = false;
                    events.splice(eventIdx, 1);
                    events.splice(event.columnIndex, 0, event);
                    break;
                }
                if (!intersects(event.item.startTime, event.item.endTime, current.item.startTime, current.item.endTime) &&
                    !minHeightOverlaps(current.rect.top, event.rect.top)) {
                    event.columnIndex = idx;
                    event.lastColumn = !events.some(e => e.columnIndex && idx < e.columnIndex &&
                        intersects(event.item.startTime, event.item.endTime, e.item.startTime, e.item.endTime));
                    events.splice(eventIdx, 1);
                    events.splice(idx, 0, event);
                    break;
                }
                previousIdx = current.columnIndex;
                current.lastColumn = false;
            }
        }
        if (groupEnd) {
            groupSlots.forEach(item => item.columns = columns);
            groupSlots = [];
            columns = 0;
        }
    });
    // The maximum number of overlapping events in the group is used to create the same number of columns.
    groupSlots.forEach(slot => slot.columns = columns);
}
function findTimeRowIndex(events, event) {
    if (event.rowIndex !== undefined) {
        return event.rowIndex;
    }
    for (let idx = 0; idx < events.length; idx++) {
        const current = events[idx];
        if (!current || !intersects(event.item.startTime, event.item.endTime, current.item.startTime, current.item.endTime)) {
            return idx;
        }
    }
    return events.length;
}
function initHorizontalSlots(slots, items, rowHeight, eventHeight, getRowIndex) {
    const padding = slots[0].padding;
    if (!items.length) {
        return {
            height: rowHeight - padding
        };
    }
    items.forEach(item => {
        item.rowIndex = undefined;
        item.rect = {
            height: eventHeight,
            width: 0
        };
    });
    const sorted = orderBy(items, [{ field: "item.startTime", dir: "asc" }, { field: "item.endTime", dir: "desc" }]);
    const slotItems = {};
    sorted.forEach(event => slots
        .filter(slot => intersects(event.item.startTime, event.item.endTime, slot.start, slot.end))
        .forEach(slot => {
        const value = slotItems[slot.key] = slotItems[slot.key] || { rows: [], slot: slot, events: [] };
        event.rowIndex = getRowIndex(value.rows, event);
        value.rows[event.rowIndex] = event;
        value.events.push(event);
    }));
    const top = slots[0].top;
    let maxOffset = 0;
    Object.keys(slotItems).forEach((key) => {
        const events = slotItems[key].events;
        let slotOffset = 0;
        for (let idx = 0; idx < events.length; idx++) {
            const event = events[idx];
            if (event) {
                event.rect.top = top + event.rowIndex * (EVENTS_OFFSET + event.rect.height);
                slotOffset = Math.max(slotOffset, (event.rect.top - top) + event.rect.height);
            }
        }
        maxOffset = Math.max(slotOffset, maxOffset);
    });
    maxOffset += rowHeight - padding;
    return {
        height: maxOffset,
        slotItems
    };
}
function setHorizontalOffsets(slotItems, items, measureTime) {
    Object.keys(slotItems).forEach((key) => {
        const { slot, events } = slotItems[key];
        const rect = slot.rect;
        for (let idx = 0; idx < events.length; idx++) {
            const event = events[idx];
            if (event) {
                if (!isNumber(event.rect.left)) {
                    event.rect.left = slot.rect.left +
                        (measureTime ? timeOffset(slot, event.item.startTime, false) : 0);
                }
                const slotOffset = measureTime && event.item.endTime.getTime() < slot.end.getTime() ?
                    timeOffset(slot, event.item.endTime, false) : rect.width;
                event.rect.width = slot.rect.left + slotOffset - event.rect.left;
            }
        }
    });
    items.forEach(item => {
        item.reflow();
    });
}
/** @hidden */
class SlotRange$1 {
    constructor(index) {
        this.index = index;
        this.slotMap = new ItemMap();
        this.itemMap = new ItemMap();
    }
    get slots() {
        return this.slotMap.toArray();
    }
    get firstSlot() {
        return this.slotMap.first;
    }
    get lastSlot() {
        return this.slotMap.last;
    }
    get items() {
        return this.itemMap.toArray();
    }
    get rect() {
        const first = this.firstSlot.rect;
        const last = this.lastSlot.rect;
        return {
            left: first.left,
            top: first.top,
            width: last.left - first.left + last.width,
            height: last.top - first.top + last.height
        };
    }
    get start() {
        const first = this.slotMap.first;
        if (!first) {
            return null;
        }
        return first.start;
    }
    get end() {
        const last = this.slotMap.last;
        if (!last) {
            return null;
        }
        return last.end;
    }
    get hasSlots() {
        return this.slotMap.count > 0;
    }
    get hasItems() {
        return this.itemMap.count > 0;
    }
    registerItem(component) {
        this.itemMap.addItem(component.item.index, component);
    }
    unregisterItem(component, id) {
        this.itemMap.removeItem(id.index, component);
    }
    registerSlot(slot) {
        this.slotMap.addItem(slot.id.index, slot);
    }
    unregisterSlot(slot) {
        this.slotMap.removeItem(slot.id.index, slot);
    }
    layout(options) {
        const items = this.items;
        if (!items.length) {
            return;
        }
        const fill = Math.max(Math.min(options.fill || 0.9, 1), 0.1);
        const sorted = orderBy(items, [{ field: "item.startTime", dir: "asc" }, { field: "item.endTime", dir: "desc" }]);
        items.forEach((item, index) => {
            item.rect = null;
            item.columnIndex = undefined;
        });
        const slotItems = {};
        const slots = this.slots;
        // Map each populated slot to the events in it
        sorted.forEach(event => slots
            .filter(slot => intersects(event.item.startTime, event.item.endTime, slot.start, slot.end))
            .forEach(slot => {
            const value = slotItems[slot.key] = slotItems[slot.key] || { events: [] };
            value.slot = slot;
            value.events.push(event);
        }));
        const slotKeys = Object.keys(slotItems);
        initTimeColumns(slotKeys, slotItems);
        slotKeys.forEach((key) => {
            const { slot, events } = slotItems[key];
            const count = events.length;
            const spacing = 2;
            const startOffset = 2;
            const slotRect = slot.rect;
            const slotLeft = slotRect.left;
            const columns = slot.columns;
            const slotWidth = slotRect.width * fill - (columns - 1) * spacing - startOffset;
            const origin = slotLeft + startOffset;
            const eventWidth = slotWidth / columns;
            const slotEnd = origin + slotWidth + (columns - 1) * spacing;
            events.forEach(event => {
                if (!isNumber(event.rect.left)) {
                    event.rect.left = origin + event.columnIndex * (eventWidth + spacing);
                    event.rect.width = event.lastColumn ? slotEnd - event.rect.left : eventWidth;
                    event.origin = {
                        left: slotLeft,
                        right: slotLeft + slotRect.width
                    };
                }
                // Expand the event to the last group slot
                const slotOffset = slot.end.getTime() <= event.item.endTime.getTime() ? slotRect.height : timeOffset(slot, event.item.endTime);
                event.rect.height = slotRect.top + slotOffset - event.rect.top;
            });
        });
        sorted.forEach(event => event.reflow());
    }
    initDaySlots(rowHeight, eventHeight) {
        const slots = this.slots;
        if (!slots.length) {
            return;
        }
        const { height, slotItems } = initHorizontalSlots(slots, this.items, rowHeight, eventHeight, findRowIndex);
        this.setSlotsHeight(height);
        this.slotItems = slotItems;
    }
    setDayOffsets() {
        if (!this.itemMap.count || !this.slotItems) {
            return;
        }
        setHorizontalOffsets(this.slotItems, this.items);
        this.slotItems = null;
    }
    setSlotsHeight(height) {
        this.firstSlot.height = height;
    }
}
/**
 * @hidden
 */
class DayTimeResourceGroup {
    constructor(index) {
        this.index = index;
        this.dayRanges = [];
        this.timeRanges = [];
    }
    registerSlot(slot) {
        const range = this.slotRange(slot);
        range.registerSlot(slot);
    }
    unregisterSlot(slot) {
        const range = this.slotRange(slot);
        range.unregisterSlot(slot);
        if (!range.hasSlots) {
            const ranges = this.slotRanges(slot);
            delete ranges[slot.id.rangeIndex];
        }
    }
    registerItem(component) {
        const range = this.itemRange(component);
        if (range) {
            range.registerItem(component);
            component.rangeIndex = range.index;
        }
        else {
            component.rangeIndex = undefined;
            component.toggle(false);
        }
    }
    unregisterItem(component, id) {
        if (component.rangeIndex !== undefined) {
            const ranges = component.item.isAllDay ? this.dayRanges : this.timeRanges;
            if (ranges[id.rangeIndex]) {
                ranges[id.rangeIndex].unregisterItem(component, id);
            }
            component.rangeIndex = undefined;
        }
    }
    forEachDateRange(callback) {
        for (let i = 0; i < this.dayRanges.length; i++) {
            callback(this.dayRanges[i]);
        }
    }
    forEachTimeRange(callback) {
        for (let i = 0; i < this.timeRanges.length; i++) {
            callback(this.timeRanges[i]);
        }
    }
    slotRange(slot) {
        const ranges = this.slotRanges(slot);
        const rangeIndex = slot.id.rangeIndex;
        if (!ranges[rangeIndex]) {
            ranges[rangeIndex] = new SlotRange$1(rangeIndex);
        }
        return ranges[rangeIndex];
    }
    slotRanges(slot) {
        return slot.isDaySlot ? this.dayRanges : this.timeRanges;
    }
    initTimeSlots(rowHeight, eventHeight, resourceRowHeight) {
        const slots = this.slots;
        if (!slots.length) {
            return;
        }
        const { height, slotItems } = initHorizontalSlots(slots, this.items, rowHeight, eventHeight, findTimeRowIndex);
        this.setSlotsHeight(Math.max(height, resourceRowHeight));
        this.slotItems = slotItems;
    }
    setTimelineOffsets() {
        const items = this.items;
        if (!this.slotItems || !items.length) {
            return;
        }
        setHorizontalOffsets(this.slotItems, items, true);
        this.slotItems = null;
    }
    setSlotsHeight(height) {
        //setting the first slot height should be sufficient
        this.timeRanges[0].setSlotsHeight(height);
    }
    get items() {
        return this.timeRanges.reduce((acc, range) => acc.concat(range.items), []);
    }
    get slots() {
        return this.timeRanges.reduce((acc, range) => acc.concat(range.slots), []);
    }
    get hasSlots() {
        return Boolean(this.dayRanges.find(range => range && range.hasSlots) || this.timeRanges.find(range => range && range.hasSlots));
    }
    cleanRanges() {
        this.dayRanges = this.dayRanges.filter(r => Boolean(r));
        this.timeRanges = this.timeRanges.filter(r => Boolean(r));
    }
    itemRange(component) {
        const task = component.item;
        const ranges = task.isAllDay ? this.dayRanges : this.timeRanges;
        if (isNumber(task.rangeIndex)) {
            return ranges[task.rangeIndex];
        }
        return ranges.find(r => intersects(task.startTime, task.endTime, r.start, r.end));
    }
}
/**
 * @hidden
 */
class DayTimeSlotService extends BaseSlotService {
    layoutDays(eventHeight = 25) {
        this.groups.forEach((group) => group.forEachDateRange(range => range.slots.forEach(slot => {
            slot.element.nativeElement.style.height = '';
        })));
        const rowHeight = this.groups[0].dayRanges[0].slots[0].height;
        this.groups.forEach((group) => {
            group.forEachDateRange(range => range.initDaySlots(rowHeight, eventHeight));
        });
        this.groups.forEach((group) => {
            group.forEachDateRange(range => range.setDayOffsets());
        });
    }
    layoutTimeline(eventHeight, resourceRows) {
        this.groups.forEach((group) => group.forEachTimeRange(range => range.slots.forEach(slot => {
            slot.element.nativeElement.style.height = '';
        })));
        const rowHeight = this.groups[0].timeRanges[0].slots[0].height;
        this.groups.forEach((group, index) => {
            group.initTimeSlots(rowHeight, eventHeight, resourceRows && resourceRows[index] ? resourceRows[index].nativeElement.children[0].children[0].offsetHeight : 0);
        });
        this.groups.forEach((group) => group.setTimelineOffsets());
    }
    layoutTimes(options) {
        this.groups.forEach((group) => group.forEachTimeRange(range => range.layout(options)));
    }
    forEachDateRange(callback) {
        this.groups.forEach((group, index) => {
            callback(group.dayRanges[0], index);
        });
    }
    syncDateRanges() {
        let maxHeight = 0;
        this.groups.forEach((group) => {
            const slot = group.dayRanges[0].firstSlot;
            if (slot) {
                maxHeight = Math.max(slot.rect.height - slot.padding, maxHeight);
            }
        });
        this.groups.forEach((group) => {
            group.dayRanges[0].setSlotsHeight(maxHeight);
        });
        return maxHeight;
    }
    forEachGroup(callback) {
        this.groups.forEach(callback);
    }
    forEachSlot(callback) {
        this.groups.forEach((group) => {
            group.dayRanges.forEach(range => {
                range.slots.forEach(slot => callback(slot));
            });
            group.timeRanges.forEach(range => {
                range.slots.forEach(slot => callback(slot));
            });
        });
    }
    createGroup(index) {
        return new DayTimeResourceGroup(index);
    }
    slotByIndex(slotIndex, allDay = false) {
        const [resourceIndex, rangeIndex, index] = slotIndex.split(':').map(part => parseInt(part, 10));
        return this.groups[resourceIndex][allDay ? 'dayRanges' : 'timeRanges'][rangeIndex].slots[index];
    }
    slotByPosition(x, y, isDaySlot, includeDayRanges) {
        let range;
        if (isDaySlot) {
            this.groups.find((group) => {
                range = group.dayRanges.find(r => rectContainsX(r.rect, x));
                return range;
            });
            if (range) {
                return range.slots.find(slot => rectContainsX(slot.rect, x));
            }
        }
        else {
            this.groups.find((group) => {
                if (includeDayRanges) {
                    range = group.dayRanges.find(r => rectContains(r.rect, x, y));
                }
                if (!range) {
                    range = group.timeRanges.find(r => rectContains(r.rect, x, y));
                }
                return range;
            });
            if (range) {
                return range.slots.find(slot => rectContains(slot.rect, x, y));
            }
        }
    }
    groupSlotByPosition(currentSlot, x, y) {
        const group = this.groups[currentSlot.id.resourceIndex];
        let range;
        if (currentSlot.isDaySlot) {
            range = group.dayRanges.find(r => rectContains(r.rect, x, y));
        }
        else {
            range = group.timeRanges.find(r => rectContains(r.rect, x, y));
        }
        if (range) {
            return range.slots.find(slot => rectContains(slot.rect, x, y));
        }
    }
    dragRanges(currentSlot, offset, timeRanges) {
        const start = new Date(currentSlot.start.getTime() - offset.start);
        const end = new Date(currentSlot.start.getTime() + offset.end);
        const group = this.groups[currentSlot.id.resourceIndex];
        let result;
        if (timeRanges) {
            const slotRanges = [];
            group.timeRanges.forEach(range => {
                const slots = range.slots.filter(s => intersects(start, end, s.start, s.end));
                if (slots.length) {
                    slotRanges.push(slots);
                }
            });
            const lastRange = slotRanges[slotRanges.length - 1];
            result = [slotRanges[0][0], lastRange[lastRange.length - 1]];
        }
        else {
            result = group.slotRange(currentSlot).slots.filter(s => intersects(start, end, s.start, s.end));
        }
        return {
            start,
            end,
            ranges: [result]
        };
    }
    resizeRanges(currentSlot, task, resizeStart, offset) {
        const group = this.groups[currentSlot.id.resourceIndex];
        const ranges = task.isAllDay ? group.dayRanges : group.timeRanges;
        const result = [];
        const startDate = task.start.toUTCDate();
        const endDate = task.end.toUTCDate();
        let start, end;
        if (resizeStart) {
            const startTime = currentSlot.start.getTime() + offset.start;
            end = startDate.getTime() === endDate.getTime() ? this.findDateSlot(endDate, ranges, true).end : endDate;
            if (startTime >= endDate.getTime()) {
                if (task.isAllDay) {
                    start = new Date(Math.min(dateWithTime(endDate, startDate).getTime(), endDate.getTime()));
                }
                else {
                    start = this.findDateSlot(end, ranges).start;
                }
            }
            else if (offset.start && task.isAllDay) {
                start = new Date(startTime);
            }
            else {
                start = new Date(currentSlot.start.getTime());
            }
        }
        else {
            start = startDate;
            if (currentSlot.start.getTime() <= start.getTime()) {
                if (task.isAllDay) {
                    end = new Date(Math.max(dateWithTime(startDate, endDate).getTime(), startDate.getTime()));
                }
                else {
                    end = this.findDateSlot(start, ranges, true).end;
                }
            }
            else if (offset.end && task.isAllDay) {
                end = new Date(currentSlot.start.getTime() + offset.end);
            }
            else {
                end = currentSlot.end;
            }
        }
        ranges.forEach(range => {
            const slots = range.slots.filter(s => intersects(start, end, s.start, s.end));
            if (slots.length) {
                result.push(slots);
            }
        });
        return {
            start,
            end,
            ranges: result
        };
    }
    timePosition(date, resourceIndex, vertical) {
        const group = this.groups[resourceIndex];
        const range = group.timeRanges.find(r => dateInRange(date, r.start, r.end));
        if (!range) {
            return;
        }
        const slot = range.slots.find(s => dateInRange(date, s.start, s.end));
        if (slot) {
            const position = (vertical ? slot.height : slot.width) *
                ((date.getTime() - slot.start.getTime()) / (slot.end.getTime() - slot.start.getTime()));
            return vertical ? slot.rect.top + position : slot.rect.left + position;
        }
    }
    findDateSlot(date, ranges, excludeEnd) {
        let result;
        ranges.forEach(range => {
            const slots = excludeEnd ? range.slots.filter(s => intersects(date, date, s.start, s.end)) :
                range.slots.filter(s => dateInRange(date, s.start, s.end));
            if (slots.length) {
                result = slots[0];
            }
        });
        return result;
    }
}
DayTimeSlotService.ɵfac = function DayTimeSlotService_Factory(t) { return ɵDayTimeSlotService_BaseFactory(t || DayTimeSlotService); };
DayTimeSlotService.ɵprov = ɵngcc0.ɵɵdefineInjectable({ token: DayTimeSlotService, factory: DayTimeSlotService.ɵfac });
const ɵDayTimeSlotService_BaseFactory = ɵngcc0.ɵɵgetInheritedFactory(DayTimeSlotService);

/** @hidden */
const isMultiDay = ({ start, end }) => {
    const startDate = start.stripTime();
    const endDate = end.stripTime();
    return startDate.getTime() !== endDate.getTime() &&
        (endDate.getTime() !== end.getTime() || startDate.addDays(1).getTime() !== endDate.getTime());
};
//check start and times or update day ranges to have them
/** @hidden */
const createTasks$1 = (periodStart, periodEnd, items, ranges) => {
    const tasks = [];
    const utcStart = toUTCDate(periodStart);
    const utcEnd = toUTCDate(periodEnd);
    for (let index = 0; index < items.length; index++) {
        const item = items[index];
        const multiDay = isMultiDay(item);
        const multipleRanges = multiDay && !item.event.isAllDay && (item.end.getTime() - item.start.getTime()) < MS_PER_DAY;
        const isAllDay = item.event.isAllDay || (multiDay && !multipleRanges);
        const endTime = (isAllDay ? roundAllDayEnd(item) : item.end).toUTCDate();
        const startTime = (isAllDay ? item.start.stripTime() : item.start).toUTCDate();
        for (let rangeIndex = 0; rangeIndex < ranges.length; rangeIndex++) {
            const rangeStart = ranges[rangeIndex].start;
            const rangeEnd = ranges[rangeIndex].end;
            if (intersects(startTime, endTime, rangeStart, rangeEnd)) {
                const task = {
                    index,
                    isAllDay,
                    startTime,
                    endTime,
                    rangeIndex: isAllDay ? 0 : rangeIndex,
                    start: item.start,
                    end: item.end,
                    event: item.event
                };
                tasks.push(task);
                if (!multipleRanges) {
                    task.head = utcEnd < endTime;
                    task.tail = startTime < utcStart;
                    break;
                }
                else {
                    const nextRange = ranges[rangeIndex + 1];
                    const previousRange = ranges[rangeIndex - 1];
                    task.head = (nextRange ? nextRange.start : utcEnd) < endTime;
                    task.tail = startTime < (previousRange ? previousRange.end : utcStart);
                }
            }
        }
    }
    return sortTasksByTime(tasks);
};

/**
 * @hidden
 */
function createTimeSlots(intlService, { showWorkHours, startTime, endTime, workDayStart, workDayEnd, slotDivisions, slotDuration }) {
    const startDate = intlService.parseDate(showWorkHours ? workDayStart : startTime);
    const start = toInvariantTime(startDate).getTime();
    const endDate = intlService.parseDate(showWorkHours ? workDayEnd : endTime);
    let end = toInvariantTime(endDate).getTime();
    if (end <= start) {
        end = toInvariantTime(MIDNIGHT_INVARIANT).getTime() + MS_PER_DAY;
    }
    const slots = [];
    const duration = Math.round((slotDuration / slotDivisions) * MS_PER_MINUTE);
    let slotTime = start;
    let index = 0;
    while (slotTime < end) {
        slots.push({
            start: new Date(slotTime),
            end: new Date(slotTime + duration),
            isMajor: index % slotDivisions === 0
        });
        index++;
        slotTime += duration;
    }
    return slots;
}

const getStartDate = date => getDate(date);
const getEndDate = (start, numberOfDays) => getDate(addDays(start, numberOfDays || 1));
const getNextDate = (date, count, numberOfDays) => getDate(addDays(date, numberOfDays * count));
/**
 * @hidden
 */
class DayTimeViewComponent extends BaseView {
    constructor(changeDetector, viewContext, viewState, intl, slotService, zone, renderer, element, pdfService, localization) {
        super(viewContext, viewState, intl, slotService, zone, renderer, element, pdfService, localization);
        this.changeDetector = changeDetector;
        this.numberOfDays = 1;
        this.startTime = '00:00';
        this.endTime = '00:00';
        this.workDayStart = '08:00';
        this.workDayEnd = '17:00';
        this.workWeekStart = 1;
        this.workWeekEnd = 5;
        this.slotDuration = 60;
        this.slotDivisions = 2;
        this.showWorkHours = false;
        this.getStartDate = getStartDate;
        this.getEndDate = getEndDate;
        this.getNextDate = getNextDate;
        this.daySlots = [];
        this.timeSlots = [];
        this.resizeHintFormat = 't';
        this.showCurrentTime = false;
        this.verticalTime = true;
        this.initialUpdate = true;
        this.updateCurrentTime = this.updateCurrentTime.bind(this);
    }
    get classNames() {
        return `k-scheduler-${this.name}view`;
    }
    get timeSlotTemplateRef() {
        return this.timeSlotTemplate || (this.schedulerTimeSlotTemplate || {}).templateRef;
    }
    get dateHeaderTemplateRef() {
        return this.dateHeaderTemplate || (this.schedulerDateHeaderTemplate || {}).templateRef;
    }
    ngOnChanges(changes) {
        if (changes.startTime || changes.endTime || changes.showWorkHours || changes.workDayStart || changes.workDayEnd ||
            changes.workWeekStart || changes.workWeekEnd || changes.slotDivisions || changes.slotDuration) {
            this.timeSlots = this.createTimeSlots();
            this.initWorkDay();
            this.changes.next(null);
        }
        if (isChanged('currentTimeMarker', changes)) {
            this.showCurrentTime = this.enableCurrentTime();
        }
        super.ngOnChanges(changes);
    }
    ngOnDestroy() {
        super.ngOnDestroy();
        clearTimeout(this.currentTimeTimeout);
    }
    verticalItem(leafIndex, resourceIndex) {
        const data = this.verticalResources[resourceIndex].data || [];
        const resources = this.verticalResources;
        let result = 1;
        for (let idx = resourceIndex + 1; idx < resources.length; idx++) {
            result *= ((resources[idx].data || []).length || 1);
        }
        return data[(leafIndex / result) % data.length];
    }
    timeSlotClass(slot, date, resourceIndex) {
        if (this.slotClass) {
            return this.slotClass({
                start: dateWithTime(date, slot.start),
                end: dateWithTime(date, slot.end),
                resources: this.resourcesByIndex(resourceIndex),
                isAllDay: false
            });
        }
    }
    scrollToTime(time = this.scrollTime) {
        let date;
        if (typeof time === 'string') {
            const scrollDate = this.intl.parseDate(time);
            if (!scrollDate) {
                return;
            }
            date = toUTCTime(this.daySlots[0].start, scrollDate);
        }
        else {
            date = toUTCDateTime(time);
        }
        const position = this.slotService.timePosition(date, 0, this.verticalTime);
        if (isNumber(position)) {
            const contentElement = this.content.nativeElement;
            contentElement[this.verticalTime ? 'scrollTop' : 'scrollLeft'] =
                (this.localization.rtl && !this.verticalTime) ? rtlScrollPosition(contentElement, position) : position;
        }
    }
    optionsChange(options) {
        this.schedulerTimeSlotTemplate = options.timeSlotTemplate;
        this.schedulerDateHeaderTemplate = options.dateHeaderTemplate;
        super.optionsChange(options);
    }
    updateView() {
        super.updateView();
        this.updateCurrentTime();
        if (this.initialUpdate) {
            this.scrollToTime();
            this.initialUpdate = false;
        }
    }
    enableCurrentTime() {
        if (!this.currentTimeMarker || this.currentTimeMarker.enabled === false || !this.selectedDate) {
            return false;
        }
        const dateRange = this.dateRange();
        this.currentDate = ZonedDate.fromLocalDate(this.currentTime(), this.currentTimeMarker.localTimezone !== false ? '' : this.timezone);
        const localTime = this.currentDate.toLocalDate();
        const invariantTime = toInvariantTime(localTime);
        const timeSlots = this.timeSlots;
        const inDateRange = dateInRange(localTime, dateRange.start, dateRange.end);
        const inTimeRange = timeSlots.length && dateInRange(invariantTime, timeSlots[0].start, timeSlots[timeSlots.length - 1].end);
        return inDateRange && inTimeRange;
    }
    currentTime() {
        return new Date();
    }
    updateCurrentTime() {
        if (!isDocumentAvailable()) {
            return;
        }
        const enable = this.enableCurrentTime();
        if (enable !== this.showCurrentTime) {
            this.showCurrentTime = enable;
            this.changeDetector.detectChanges();
        }
        clearTimeout(this.currentTimeTimeout);
        if (enable) {
            this.zone.runOutsideAngular(() => {
                this.currentTimeTimeout = setTimeout(this.updateCurrentTime, this.currentTimeMarker.updateInterval || MS_PER_MINUTE);
            });
            this.positionCurrentTime();
        }
    }
    positionCurrentTime() {
        if (this.currentTimeElements && this.currentTimeElements.length) {
            const date = this.currentDate.toUTCDate();
            const currentTimeArrows = this.currentTimeArrows ? this.currentTimeArrows.toArray() : [];
            const arrowOffset = currentTimeArrows.length ? this.currentTimeArrowOffset() : 0;
            const arrowMid = currentTimeArrows.length ? (currentTimeArrows[0].nativeElement.offsetHeight / 2) : 4;
            const tableWidth = this.contentTable.nativeElement.clientWidth;
            const tableHeight = this.contentTable.nativeElement.clientHeight;
            const vertical = this.verticalTime;
            this.currentTimeElements.forEach((element, index) => {
                const position = this.slotService.timePosition(date, index, vertical);
                if (position !== undefined) {
                    const line = element.nativeElement;
                    if (currentTimeArrows[index]) {
                        const arrow = currentTimeArrows[index].nativeElement;
                        const origin = vertical ? arrowOffset : position - arrowMid;
                        setCoordinates(arrow, {
                            top: vertical ? position - arrowMid : arrowOffset,
                            left: origin,
                            right: origin
                        });
                    }
                    const origin = vertical ? 0 : position;
                    setCoordinates(line, {
                        top: vertical ? position : 0,
                        left: origin,
                        right: origin,
                        width: vertical ? tableWidth : 1,
                        height: vertical ? 1 : tableHeight
                    });
                }
            });
        }
    }
    bindEvents() {
        super.bindEvents();
        this.zone.runOutsideAngular(() => {
            this.subs.add(fromClick(this.headerWrap.nativeElement)
                .subscribe(e => this.onHeaderClick(e)));
            this.subs.add(fromEvent(this.headerWrap.nativeElement, 'contextmenu')
                .subscribe(e => this.onClick(e)));
            this.subs.add(fromDoubleClick(this.headerWrap.nativeElement)
                .subscribe(e => this.onClick(e, 'dblclick')));
        });
    }
    onHeaderClick(e) {
        this.onClick(e);
        if (this.daySlots.length <= 1) {
            return;
        }
        const daySlotIndex = e.target.getAttribute('data-dayslot-index');
        if (daySlotIndex) {
            const slot = this.daySlots[parseInt(daySlotIndex, 10)];
            this.zone.run(() => {
                this.viewState.navigateTo({ viewName: 'day', date: slot.start });
            });
        }
    }
    slotByIndex(slotIndex, args) {
        return this.slotService.slotByIndex(slotIndex, args.target.hasAttribute('data-day-slot'));
    }
    onSelectDate(date) {
        this.selectedDate = date;
        this.daySlots = this.createDaySlots();
        this.showCurrentTime = this.enableCurrentTime();
        this.viewState.notifyDateRange(this.dateRange());
    }
    onAction(e) {
        const now = getDate(this.selectedDate);
        if (e.type === 'next') {
            const next = this.getNextDate(now, 1, this.numberOfDays);
            if (this.isInRange(next)) {
                this.viewState.notifyNextDate(next);
            }
        }
        if (e.type === 'prev') {
            const next = this.getNextDate(now, -1, this.numberOfDays);
            if (this.isInRange(next)) {
                this.viewState.notifyNextDate(next);
            }
        }
        if (e.type === 'scroll-time') {
            this.scrollToTime(e.time);
        }
    }
    dateRange(date = this.selectedDate) {
        const start = this.getStartDate(date);
        const end = this.getEndDate(start, this.numberOfDays);
        const rangeEnd = this.getEndDate(start, this.numberOfDays - 1);
        const text = this.intl.format(this.selectedDateFormat, start, rangeEnd);
        const shortText = this.intl.format(this.selectedShortDateFormat, start, rangeEnd);
        return { start, end, text, shortText };
    }
    createDaySlots() {
        let current = this.getStartDate(this.selectedDate);
        const end = this.getEndDate(current, this.numberOfDays);
        const dates = [];
        while (current < end) {
            const next = addDays(current, 1);
            dates.push({
                start: current,
                end: next
            });
            current = next;
        }
        return dates;
    }
    createTimeSlots() {
        return createTimeSlots(this.intl, {
            showWorkHours: this.showWorkHours,
            startTime: this.startTime,
            endTime: this.endTime,
            workDayStart: this.workDayStart,
            workDayEnd: this.workDayEnd,
            slotDivisions: this.slotDivisions,
            slotDuration: this.slotDuration
        });
    }
    initWorkDay() {
        const startDate = this.intl.parseDate(this.workDayStart);
        this.workDayStartTime = toInvariantTime(startDate);
        const endDate = this.intl.parseDate(this.workDayEnd);
        if (endDate <= startDate) {
            this.workDayEndTime = addDays(MIDNIGHT_INVARIANT, 1);
        }
        else {
            this.workDayEndTime = toInvariantTime(endDate);
        }
    }
    slotByPosition(x, y, container) {
        const isDaySlot = container ? hasClasses(container.parentNode, 'k-scheduler-header-wrap') : y < 0;
        return this.slotService.slotByPosition(x, y, isDaySlot, Boolean(this.verticalResources.length));
    }
    slotFields(slot) {
        const fields = super.slotFields(slot);
        if (slot.isDaySlot) {
            fields.isAllDay = true;
        }
        else {
            fields.start = this.convertDate(slot.start);
            fields.end = this.convertDate(slot.end);
        }
        return fields;
    }
}
DayTimeViewComponent.ɵfac = function DayTimeViewComponent_Factory(t) { ɵngcc0.ɵɵinvalidFactory(); };
DayTimeViewComponent.ɵdir = ɵngcc0.ɵɵdefineDirective({ type: DayTimeViewComponent, viewQuery: function DayTimeViewComponent_Query(rf, ctx) { if (rf & 1) {
        ɵngcc0.ɵɵviewQuery(_c181, true);
        ɵngcc0.ɵɵviewQuery(_c182, true);
    } if (rf & 2) {
        var _t;
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.currentTimeElements = _t);
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.currentTimeArrows = _t);
    } }, inputs: { numberOfDays: "numberOfDays", startTime: "startTime", endTime: "endTime", workDayStart: "workDayStart", workDayEnd: "workDayEnd", workWeekStart: "workWeekStart", workWeekEnd: "workWeekEnd", slotDuration: "slotDuration", slotDivisions: "slotDivisions", showWorkHours: "showWorkHours", getStartDate: "getStartDate", getEndDate: "getEndDate", getNextDate: "getNextDate", timeSlotTemplate: "timeSlotTemplate", dateHeaderTemplate: "dateHeaderTemplate", scrollTime: "scrollTime", currentTimeMarker: "currentTimeMarker" }, features: [ɵngcc0.ɵɵInheritDefinitionFeature, ɵngcc0.ɵɵNgOnChangesFeature] });
DayTimeViewComponent.propDecorators = {
    timeSlotTemplate: [{ type: Input }],
    dateHeaderTemplate: [{ type: Input }],
    numberOfDays: [{ type: Input }],
    scrollTime: [{ type: Input }],
    startTime: [{ type: Input }],
    endTime: [{ type: Input }],
    workDayStart: [{ type: Input }],
    workDayEnd: [{ type: Input }],
    workWeekStart: [{ type: Input }],
    workWeekEnd: [{ type: Input }],
    slotDuration: [{ type: Input }],
    slotDivisions: [{ type: Input }],
    showWorkHours: [{ type: Input }],
    getStartDate: [{ type: Input }],
    getEndDate: [{ type: Input }],
    getNextDate: [{ type: Input }],
    currentTimeMarker: [{ type: Input }],
    currentTimeElements: [{ type: ViewChildren, args: ['currentTimeMarker',] }],
    currentTimeArrows: [{ type: ViewChildren, args: ['currentTimeArrow',] }]
};


/**
 * @hidden
 */
class MultiDayViewRendererComponent extends DayTimeViewComponent {
    constructor(localization, viewContext, viewState, intl, slotService, zone, renderer, element, changeDetector, pdfService) {
        super(changeDetector, viewContext, viewState, intl, slotService, zone, renderer, element, pdfService, localization);
        this.name = 'day';
        this.dateFormat = { skeleton: 'MEd' };
        this.allDayResizeHintFormat = { skeleton: 'Md' };
        this.allDayItems = new BehaviorSubject(null);
    }
    get allDaySlotTemplateRef() {
        return this.allDaySlotTemplate || (this.schedulerAllDaySlotTemplate || {}).templateRef;
    }
    get allDayEventTemplateRef() {
        return this.allDayEventTemplate || (this.schedulerAllDayEventTemplate || {}).templateRef;
    }
    get minorTimeHeaderTemplateRef() {
        return this.minorTimeHeaderTemplate || (this.schedulerMinorTimeHeaderTemplate || {}).templateRef;
    }
    get majorTimeHeaderTemplateRef() {
        return this.majorTimeHeaderTemplate || (this.schedulerMajorTimeHeaderTemplate || {}).templateRef;
    }
    get allDayMessage() {
        return this.localization.get('allDay');
    }
    get allDayResizeHint() {
        return this.resizing && this.resizing.task.isAllDay;
    }
    get allDayDragHint() {
        return this.dragging && this.dragging.slot.isDaySlot;
    }
    optionsChange(changes) {
        this.schedulerAllDaySlotTemplate = changes.allDaySlotTemplate;
        this.schedulerAllDayEventTemplate = changes.allDayEventTemplate;
        this.schedulerMinorTimeHeaderTemplate = changes.minorTimeHeaderTemplate;
        this.schedulerMajorTimeHeaderTemplate = changes.majorTimeHeaderTemplate;
        super.optionsChange(changes);
    }
    ngOnChanges(changes) {
        super.ngOnChanges(changes);
        if (changes.slotFill) {
            this.changes.next(null);
        }
        if (changes.startTime || changes.endTime || changes.showWorkHours || changes.workDayStart || changes.workDayEnd ||
            changes.workWeekStart || changes.workWeekEnd) {
            this.viewRangeChange.next(null);
        }
        if (changes.numberOfDays && !changes.numberOfDays.firstChange) {
            this.daySlots = this.createDaySlots();
            this.viewState.notifyDateRange(this.dateRange());
        }
    }
    horizontalColspan(resourceIndex) {
        const resources = this.horizontalResources;
        let result = this.daySlots.length;
        for (let idx = resourceIndex + 1; idx < resources.length; idx++) {
            result *= (resources[idx].data || []).length || 1;
        }
        return result;
    }
    verticalRowspan(resourceIndex) {
        const resources = this.verticalResources;
        let result = this.timeSlots.length + 1;
        for (let idx = resourceIndex + 1; idx < resources.length; idx++) {
            result *= (resources[idx].data || []).length || 1;
        }
        return result;
    }
    allDaySlotClass(slot, resourceIndex) {
        if (this.slotClass) {
            return this.slotClass({
                start: slot.start,
                end: slot.end,
                resources: this.resourcesByIndex(resourceIndex),
                isAllDay: true
            });
        }
    }
    createTasks(items, dateRange) {
        const startTimeSlot = this.timeSlots[0];
        const endTimeSlot = this.timeSlots[this.timeSlots.length - 1].end;
        const nextDateEnd = !(endTimeSlot.getHours() || endTimeSlot.getMinutes());
        const ranges = this.daySlots.map(daySlot => ({
            start: toUTCTime(daySlot.start, startTimeSlot.start),
            end: nextDateEnd ? toUTCDate(daySlot.end) : toUTCTime(daySlot.start, endTimeSlot)
        }));
        return createTasks$1(dateRange.start, dateRange.end, items, ranges);
    }
    onTasksChange() {
        this.items.next(this.tasks.filter(task => !task.isAllDay));
        this.allDayItems.next(this.tasks.filter(task => task.isAllDay));
    }
    reflow() {
        const slotService = this.slotService;
        if (!this.verticalResources.length) {
            this.updateContentHeight();
            this.syncTables();
        }
        this.slotService.containerSize = this.content.nativeElement.clientWidth;
        slotService.layoutDays(this.eventHeight);
        this.updateContentHeight();
        this.syncTables();
        if (this.dayCells.length) {
            const cells = this.dayCells.toArray();
            if (this.verticalResources.length) {
                slotService.forEachDateRange((range, index) => {
                    const slot = range.firstSlot;
                    cells[index].nativeElement.style.height = `${slot.rect.height - slot.padding}px`;
                });
            }
            else {
                const size = slotService.syncDateRanges();
                cells[0].nativeElement.style.height = `${size}px`;
            }
        }
        slotService.layoutTimes({ fill: this.slotFill });
        this.syncTables();
    }
    dragHorizontal(slot) {
        return slot.isDaySlot;
    }
    updateHintContainer() {
        if (this.headerHintContainer) {
            this.headerHintContainer.detectChanges();
        }
        super.updateHintContainer();
    }
    onRelease() {
        super.onRelease();
        this.dragContainers = null;
    }
    updateDragContainer(args) {
        if (!this.dragContainers) {
            this.dragContainers = this.containers;
        }
        const container = this.dragContainers.find(c => {
            const offset = c.offset;
            return offset.top <= args.pageY && args.pageY <= offset.top + offset.height;
        }) || {};
        this.container = container.element;
        this.containerOffset = container.offset;
    }
    containerByPosition({ x, y }) {
        return this.containers.find(c => {
            const offset = c.offset;
            return offset.top <= y && y <= offset.top + offset.height && offset.left <= x && x <= offset.left + offset.width;
        });
    }
    get containers() {
        const header = this.headerWrap.nativeElement.children[1];
        const content = this.content.nativeElement;
        return [{
                element: content,
                offset: elementOffset(content)
            }, {
                element: header,
                offset: elementOffset(header)
            }];
    }
    scrollContainer(callback, args) {
        clearInterval(this.scrollInterval);
        if (this.container && this.container === this.content.nativeElement) {
            super.scrollContainer(callback, args);
        }
    }
    dragRanges(slot) {
        const task = this.dragging.task;
        if (slot.isDaySlot && !task.isAllDay) {
            return {
                ranges: [[slot]],
                start: dateWithTime(slot.start, task.start.toUTCDate()),
                end: dateWithTime(slot.start, task.end.toUTCDate()),
                isAllDay: true
            };
        }
        const allDayToTime = task.isAllDay && !slot.isDaySlot;
        const result = this.slotService.dragRanges(slot, allDayToTime ? { start: 0, end: 0 } : this.dragging.offset);
        if (allDayToTime) {
            result.end = slot.end;
        }
        result.isAllDay = this.draggedIsAllDay(task, slot);
        return result;
    }
    dragHintEventStyleArgs() {
        return {
            event: this.dragging.task.event,
            resources: this.dragging.resourceItems,
            isAllDay: Boolean(this.allDayDragHint)
        };
    }
    draggedIsAllDay(task, slot) {
        return Boolean(slot.isDaySlot && (task.event.isAllDay || !isMultiDay(task)));
    }
    dragHintSize(firstSlot, lastSlot) {
        let width, height;
        if (firstSlot.isDaySlot) {
            width = toPx(lastSlot.rect.left - firstSlot.rect.left + lastSlot.rect.width);
            height = toPx(firstSlot.height);
        }
        else {
            width = toPx(firstSlot.rect.width * 0.9);
            height = toPx(this.dragging.task.isAllDay ? firstSlot.rect.height : lastSlot.rect.top - firstSlot.rect.top + lastSlot.rect.height);
        }
        return { width, height };
    }
    currentTimeArrowOffset() {
        if (this.verticalResources.length) {
            const el = this.times.nativeElement.querySelector('.k-scheduler-times-all-day');
            const timesEl = this.times.nativeElement;
            return this.localization.rtl ? timesEl.offsetWidth - el.offsetWidth : el.offsetLeft;
        }
        return 0;
    }
}
MultiDayViewRendererComponent.ɵfac = function MultiDayViewRendererComponent_Factory(t) { return new (t || MultiDayViewRendererComponent)(ɵngcc0.ɵɵdirectiveInject(ɵngcc2.LocalizationService), ɵngcc0.ɵɵdirectiveInject(ViewContextService), ɵngcc0.ɵɵdirectiveInject(ViewStateService), ɵngcc0.ɵɵdirectiveInject(ɵngcc3.IntlService), ɵngcc0.ɵɵdirectiveInject(DayTimeSlotService), ɵngcc0.ɵɵdirectiveInject(ɵngcc0.NgZone), ɵngcc0.ɵɵdirectiveInject(ɵngcc0.Renderer2), ɵngcc0.ɵɵdirectiveInject(ɵngcc0.ElementRef), ɵngcc0.ɵɵdirectiveInject(ɵngcc0.ChangeDetectorRef), ɵngcc0.ɵɵdirectiveInject(PDFService)); };
MultiDayViewRendererComponent.ɵcmp = ɵngcc0.ɵɵdefineComponent({ type: MultiDayViewRendererComponent, selectors: [["multi-day-view"]], viewQuery: function MultiDayViewRendererComponent_Query(rf, ctx) { if (rf & 1) {
        ɵngcc0.ɵɵviewQuery(_c183, true);
        ɵngcc0.ɵɵviewQuery(_c184, true);
    } if (rf & 2) {
        var _t;
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.headerHintContainer = _t.first);
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.dayCells = _t);
    } }, inputs: { name: "name", slotFill: "slotFill", allDaySlotTemplate: "allDaySlotTemplate", allDayEventTemplate: "allDayEventTemplate", minorTimeHeaderTemplate: "minorTimeHeaderTemplate", majorTimeHeaderTemplate: "majorTimeHeaderTemplate" }, features: [ɵngcc0.ɵɵProvidersFeature([
            DayTimeSlotService
        ]), ɵngcc0.ɵɵInheritDefinitionFeature, ɵngcc0.ɵɵNgOnChangesFeature], decls: 41, vars: 26, consts: [[1, "k-scheduler-layout", "k-scheduler-flex-layout", 3, "ngClass"], [1, "k-scheduler-pane"], [1, "k-scheduler-times"], ["timesHeader", ""], ["aria-hidden", "true", 1, "k-scheduler-table"], [4, "ngFor", "ngForOf", "ngForTrackBy"], [4, "ngIf"], [1, "k-scheduler-header", "k-state-default"], ["header", ""], [1, "k-scheduler-header-wrap"], ["headerWrap", ""], ["style", "position: relative;", 4, "ngIf"], ["times", ""], ["timesTable", ""], [1, "k-scheduler-content"], ["content", ""], ["role", "presentation", 1, "k-scheduler-table"], ["contentTable", ""], ["hintContainer", ""], [1, "k-scheduler-times-all-day"], ["allDayCell", ""], ["class", "k-slot-cell", 4, "ngFor", "ngForOf", "ngForTrackBy"], [1, "k-slot-cell"], [3, "ngTemplateOutlet", "ngTemplateOutletContext", 4, "ngIf"], [3, "ngTemplateOutlet", "ngTemplateOutletContext"], ["class", "k-link k-nav-day", 4, "ngIf"], [1, "k-link", "k-nav-day"], [2, "position", "relative"], ["aria-hidden", "true", 1, "k-scheduler-table", "k-scheduler-header-all-day"], ["headerHintContainer", ""], ["daySlot", "", 3, "start", "end", "id", "ngClass", 4, "ngFor", "ngForOf", "ngForTrackBy"], ["daySlot", "", 3, "start", "end", "id", "ngClass"], ["dayTimeViewItem", "", 3, "ngClass", "ngStyle", "kendoSchedulerFocusIndex", "isAllDay", "editable", "eventTemplate", "item", "index", "rangeIndex", "resources", "resourceIndex", 4, "ngFor", "ngForOf", "ngForTrackBy"], ["dayTimeViewItem", "", 3, "ngClass", "ngStyle", "kendoSchedulerFocusIndex", "isAllDay", "editable", "eventTemplate", "item", "index", "rangeIndex", "resources", "resourceIndex"], ["class", "k-event-drag-hint", "dayTimeViewItem", "", 3, "isAllDay", "ngStyle", "ngClass", "dragHint", "eventTemplate", "item", "resources", 4, "ngIf"], ["kendoResizeHint", "", 3, "hint", "ngClass", "format", 4, "ngIf"], ["dayTimeViewItem", "", 1, "k-event-drag-hint", 3, "isAllDay", "ngStyle", "ngClass", "dragHint", "eventTemplate", "item", "resources"], ["kendoResizeHint", "", 3, "hint", "ngClass", "format"], ["class", "k-current-time k-current-time-arrow-right", 4, "ngFor", "ngForOf", "ngForTrackBy"], [1, "k-current-time", "k-current-time-arrow-right"], ["currentTimeArrow", ""], ["class", "k-slot-cell", 4, "ngIf"], [3, "ngClass", 4, "ngIf"], [3, "ngClass"], ["class", "k-current-time", 4, "ngFor", "ngForOf", "ngForTrackBy"], [1, "k-current-time"], ["currentTimeMarker", ""], ["class", "k-scheduler-header-all-day", 4, "ngIf"], [3, "k-middle-row", 4, "ngFor", "ngForOf", "ngForTrackBy"], [1, "k-scheduler-header-all-day"], ["daySlot", "", 3, "start", "end", "id", 4, "ngFor", "ngForOf", "ngForTrackBy"], ["daySlot", "", 3, "start", "end", "id"], ["timeSlot", "", 3, "k-nonwork-hour", "ngClass", "date", "invariantStart", "invariantEnd", "workDayStart", "workDayEnd", "workWeekStart", "workWeekEnd", "id", 4, "ngFor", "ngForOf", "ngForTrackBy"], ["timeSlot", "", 3, "ngClass", "date", "invariantStart", "invariantEnd", "workDayStart", "workDayEnd", "workWeekStart", "workWeekEnd", "id"], ["timeSlot", "timeSlot"], ["dayTimeViewItem", "", 3, "ngClass", "ngStyle", "kendoSchedulerFocusIndex", "editable", "vertical", "eventTemplate", "item", "index", "rangeIndex", "resources", "resourceIndex", 4, "ngFor", "ngForOf", "ngForTrackBy"], ["dayTimeViewItem", "", 3, "ngClass", "ngStyle", "kendoSchedulerFocusIndex", "editable", "vertical", "eventTemplate", "item", "index", "rangeIndex", "resources", "resourceIndex"], ["class", "k-event-drag-hint", "dayTimeViewItem", "", 3, "isAllDay", "ngStyle", "ngClass", "dragHint", "eventTemplate", "resources", "item", 4, "ngIf"], ["dayTimeViewItem", "", 1, "k-event-drag-hint", 3, "isAllDay", "ngStyle", "ngClass", "dragHint", "eventTemplate", "resources", "item"], ["kendoResizeHint", "", 3, "hint", "ngClass", "format", 4, "ngFor", "ngForOf", "ngForTrackBy"]], template: function MultiDayViewRendererComponent_Template(rf, ctx) { if (rf & 1) {
        ɵngcc0.ɵɵelementStart(0, "div", 0);
        ɵngcc0.ɵɵelementStart(1, "div", 1);
        ɵngcc0.ɵɵelementStart(2, "div", 2, 3);
        ɵngcc0.ɵɵelementStart(4, "table", 4);
        ɵngcc0.ɵɵtemplate(5, MultiDayViewRendererComponent_tr_5_Template, 2, 0, "tr", 5);
        ɵngcc0.ɵɵelementStart(6, "tr");
        ɵngcc0.ɵɵelementStart(7, "th");
        ɵngcc0.ɵɵtext(8, "\u200B");
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵtemplate(9, MultiDayViewRendererComponent_tr_9_Template, 4, 1, "tr", 6);
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵelementStart(10, "div", 7, 8);
        ɵngcc0.ɵɵelementStart(12, "div", 9, 10);
        ɵngcc0.ɵɵelementStart(14, "table", 4);
        ɵngcc0.ɵɵtemplate(15, MultiDayViewRendererComponent_tr_15_Template, 3, 5, "tr", 5);
        ɵngcc0.ɵɵelementStart(16, "tr");
        ɵngcc0.ɵɵtemplate(17, MultiDayViewRendererComponent_ng_container_17_Template, 2, 2, "ng-container", 5);
        ɵngcc0.ɵɵpipe(18, "resourceIterator");
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵtemplate(19, MultiDayViewRendererComponent_div_19_Template, 10, 8, "div", 11);
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵelementStart(20, "div", 1);
        ɵngcc0.ɵɵelementStart(21, "div", 2, 12);
        ɵngcc0.ɵɵtemplate(23, MultiDayViewRendererComponent_ng_container_23_Template, 3, 4, "ng-container", 6);
        ɵngcc0.ɵɵelementStart(24, "table", 4, 13);
        ɵngcc0.ɵɵtemplate(26, MultiDayViewRendererComponent_ng_container_26_Template, 3, 3, "ng-container", 5);
        ɵngcc0.ɵɵpipe(27, "resourceIterator");
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵelementStart(28, "div", 14, 15);
        ɵngcc0.ɵɵtemplate(30, MultiDayViewRendererComponent_ng_container_30_Template, 3, 4, "ng-container", 6);
        ɵngcc0.ɵɵelementStart(31, "table", 16, 17);
        ɵngcc0.ɵɵtemplate(33, MultiDayViewRendererComponent_ng_container_33_Template, 3, 3, "ng-container", 5);
        ɵngcc0.ɵɵpipe(34, "resourceIterator");
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵtemplate(35, MultiDayViewRendererComponent_ng_container_35_Template, 2, 2, "ng-container", 5);
        ɵngcc0.ɵɵpipe(36, "async");
        ɵngcc0.ɵɵtemplate(37, MultiDayViewRendererComponent_ng_container_37_Template, 3, 4, "ng-container", 6);
        ɵngcc0.ɵɵelementStart(38, "kendo-hint-container", null, 18);
        ɵngcc0.ɵɵtemplate(40, MultiDayViewRendererComponent_ng_template_40_Template, 2, 2, "ng-template");
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵelementEnd();
    } if (rf & 2) {
        ɵngcc0.ɵɵproperty("ngClass", ctx.classNames);
        ɵngcc0.ɵɵadvance(5);
        ɵngcc0.ɵɵproperty("ngForOf", ctx.horizontalResources)("ngForTrackBy", ctx.itemIndex);
        ɵngcc0.ɵɵadvance(4);
        ɵngcc0.ɵɵproperty("ngIf", !ctx.verticalResources.length);
        ɵngcc0.ɵɵadvance(6);
        ɵngcc0.ɵɵproperty("ngForOf", ctx.horizontalResources)("ngForTrackBy", ctx.itemIndex);
        ɵngcc0.ɵɵadvance(2);
        ɵngcc0.ɵɵproperty("ngForOf", ɵngcc0.ɵɵpipeBind1(18, 18, ctx.horizontalResources))("ngForTrackBy", ctx.itemIndex);
        ɵngcc0.ɵɵadvance(2);
        ɵngcc0.ɵɵproperty("ngIf", !ctx.verticalResources.length);
        ɵngcc0.ɵɵadvance(4);
        ɵngcc0.ɵɵproperty("ngIf", ctx.showCurrentTime);
        ɵngcc0.ɵɵadvance(3);
        ɵngcc0.ɵɵproperty("ngForOf", ɵngcc0.ɵɵpipeBind1(27, 20, ctx.verticalResources))("ngForTrackBy", ctx.itemIndex);
        ɵngcc0.ɵɵadvance(4);
        ɵngcc0.ɵɵproperty("ngIf", ctx.showCurrentTime);
        ɵngcc0.ɵɵadvance(3);
        ɵngcc0.ɵɵproperty("ngForOf", ɵngcc0.ɵɵpipeBind1(34, 22, ctx.verticalResources))("ngForTrackBy", ctx.itemIndex);
        ɵngcc0.ɵɵadvance(2);
        ɵngcc0.ɵɵproperty("ngForOf", ɵngcc0.ɵɵpipeBind1(36, 24, ctx.items))("ngForTrackBy", ctx.itemIndex);
        ɵngcc0.ɵɵadvance(2);
        ɵngcc0.ɵɵproperty("ngIf", ctx.verticalResources.length);
    } }, directives: function () { return [ɵngcc4.NgClass, ɵngcc4.NgForOf, ɵngcc4.NgIf, HintContainerComponent, ɵngcc4.NgTemplateOutlet, DaySlotDirective,
        DayTimeViewItemComponent, ɵngcc4.NgStyle, FocusableDirective,
        ResizeHintComponent,
        TimeSlotDirective]; }, pipes: function () { return [ResourceIteratorPipe, ɵngcc4.AsyncPipe, ɵngcc3.DatePipe]; }, encapsulation: 2 });
/** @nocollapse */
MultiDayViewRendererComponent.ctorParameters = () => [
    { type: LocalizationService },
    { type: ViewContextService },
    { type: ViewStateService },
    { type: IntlService },
    { type: DayTimeSlotService },
    { type: NgZone },
    { type: Renderer2 },
    { type: ElementRef },
    { type: ChangeDetectorRef },
    { type: PDFService }
];
MultiDayViewRendererComponent.propDecorators = {
    name: [{ type: Input }],
    slotFill: [{ type: Input }],
    allDaySlotTemplate: [{ type: Input }],
    allDayEventTemplate: [{ type: Input }],
    minorTimeHeaderTemplate: [{ type: Input }],
    majorTimeHeaderTemplate: [{ type: Input }],
    dayCells: [{ type: ViewChildren, args: ['allDayCell',] }],
    headerHintContainer: [{ type: ViewChild, args: ['headerHintContainer',] }]
};
/*@__PURE__*/ (function () { ɵngcc0.ɵsetClassMetadata(MultiDayViewRendererComponent, [{
        type: Component,
        args: [{
                // tslint:disable-next-line:component-selector
                selector: 'multi-day-view',
                providers: [
                    DayTimeSlotService
                ],
                template: `
        <div class="k-scheduler-layout k-scheduler-flex-layout" [ngClass]="classNames">
            <div class="k-scheduler-pane">
                <div class="k-scheduler-times" #timesHeader>
                    <table class="k-scheduler-table" aria-hidden="true">
                        <tr *ngFor="let resource of horizontalResources; trackBy: itemIndex;">
                            <th></th>
                        </tr>
                        <tr>
                            <th>​</th>
                        </tr>
                        <tr *ngIf="!verticalResources.length">
                            <th class="k-scheduler-times-all-day" #allDayCell>{{ allDayMessage }}</th>
                        </tr>
                    </table>
                </div>
                <div class="k-scheduler-header k-state-default" #header>
                    <div class="k-scheduler-header-wrap" #headerWrap>
                        <table class="k-scheduler-table" aria-hidden="true">
                            <tr *ngFor="let resource of horizontalResources; let resourceIndex = index; trackBy: itemIndex;">
                                <th *ngFor="let item of horizontalResources | resourceIterator : resourceIndex; trackBy: itemIndex;"
                                    class="k-slot-cell" [attr.colspan]="horizontalColspan(resourceIndex)">
                                    <ng-container *ngIf="!groupHeaderTemplateRef">{{ getField(item, resource.textField) }}</ng-container>
                                    <ng-container *ngIf="groupHeaderTemplateRef" [ngTemplateOutlet]="groupHeaderTemplateRef" [ngTemplateOutletContext]="{ resource: item }"></ng-container>
                                </th>
                            </tr>
                            <tr>
                                <ng-container *ngFor="let resource of horizontalResources | resourceIterator; trackBy: itemIndex;">
                                    <th *ngFor="let slot of daySlots; let index = index; trackBy: itemIndex">
                                        <span *ngIf="!dateHeaderTemplateRef" class="k-link k-nav-day" [attr.data-dayslot-index]="index">{{ slot.start | kendoDate: dateFormat }}</span>
                                        <ng-container *ngIf="dateHeaderTemplateRef" [ngTemplateOutlet]="dateHeaderTemplateRef" [ngTemplateOutletContext]="{ date: slot.start }"></ng-container>
                                    </th>
                                </ng-container>
                            </tr>
                        </table>
                        <div style="position: relative;" *ngIf="!verticalResources.length">
                            <table class="k-scheduler-table k-scheduler-header-all-day" aria-hidden="true">
                                <tr>
                                    <ng-container *ngFor="let resource of horizontalResources | resourceIterator; let resourceIndex = index; trackBy: itemIndex;">
                                        <td *ngFor="let slot of daySlots; let index = index; trackBy: itemIndex"
                                            daySlot
                                            [start]="slot.start"
                                            [end]="slot.end"
                                            [id]="{ resourceIndex: resourceIndex, rangeIndex: 0, index: index }"
                                            [ngClass]="allDaySlotClass(slot, resourceIndex)">
                                            <ng-container *ngIf="allDaySlotTemplateRef" [ngTemplateOutlet]="allDaySlotTemplateRef"
                                                [ngTemplateOutletContext]="{ date: slot.start, resources: resourcesByIndex(resourceIndex) }"></ng-container>
                                        </td>
                                    </ng-container>
                                </tr>
                            </table>
                            <ng-container *ngFor="let item of allDayItems | async; trackBy: itemIndex;">
                                <div *ngFor="let itemResource of item.resources; trackBy: itemIndex;"
                                    [ngClass]="getEventClasses(item, itemResource.resources, true)"
                                    [ngStyle]="getEventStyles(item, itemResource, true)"
                                    [kendoSchedulerFocusIndex]="itemResource.leafIdx"
                                     dayTimeViewItem
                                        [isAllDay]="true"
                                        [editable]="editable"
                                        [eventTemplate]="allDayEventTemplateRef"
                                        [item]="item"
                                        [index]="item.index"
                                        [rangeIndex]="item.rangeIndex"
                                        [resources]="itemResource.resources"
                                        [resourceIndex]="itemResource.leafIdx">
                                </div>
                            </ng-container>
                            <kendo-hint-container #headerHintContainer>
                                <ng-template>
                                    <div *ngIf="dragHints.length && allDayDragHint"
                                        class="k-event-drag-hint"
                                        dayTimeViewItem
                                            [isAllDay]="true"
                                            [ngStyle]="dragHints[0].style"
                                            [ngClass]="dragHints[0].class"
                                            [dragHint]="true"
                                            [eventTemplate]="eventTemplateRef"
                                            [item]="dragHints[0].item"
                                            [resources]="dragHints[0].resources">
                                    </div>

                                    <div *ngIf="resizeHints.length && allDayResizeHint"
                                        kendoResizeHint
                                            [hint]="resizeHints[0]"
                                            [ngClass]="resizeHints[0].class"
                                            [format]="allDayResizeHintFormat">
                                    </div>
                                </ng-template>
                            </kendo-hint-container>
                        </div>
                    </div>
                </div>
            </div>
            <div class="k-scheduler-pane">
                <div class="k-scheduler-times" #times>
                    <ng-container *ngIf="showCurrentTime">
                        <div *ngFor="let resource of verticalResources | resourceIterator; trackBy: itemIndex;"
                            #currentTimeArrow class="k-current-time k-current-time-arrow-right">
                        </div>
                    </ng-container>
                    <table class="k-scheduler-table" #timesTable aria-hidden="true">
                        <ng-container *ngFor="let resourceItem of verticalResources | resourceIterator; let leafIndex = index; trackBy: itemIndex;">
                            <tr *ngIf="verticalResources.length">
                                <ng-container *ngFor="let resource of verticalResources; let resourceIndex = index; trackBy: itemIndex;">
                                    <th *ngIf="verticalItem(leafIndex, resourceIndex)" [attr.rowspan]="verticalRowspan(resourceIndex)" class="k-slot-cell">
                                        <ng-container *ngIf="!groupHeaderTemplateRef">{{ getField(verticalItem(leafIndex, resourceIndex), resource.textField) }}</ng-container>
                                        <ng-container *ngIf="groupHeaderTemplateRef" [ngTemplateOutlet]="groupHeaderTemplateRef"
                                            [ngTemplateOutletContext]="{ resource: verticalItem(leafIndex, resourceIndex) }"></ng-container>
                                    </th>
                                </ng-container>
                                <th class="k-scheduler-times-all-day" #allDayCell>{{ allDayMessage }}</th>
                            </tr>
                            <tr *ngFor="let slot of timeSlots; let timeSlotIndex = index;trackBy: itemIndex">
                                <th *ngIf="slot.isMajor" [ngClass]="{ 'k-slot-cell': slotDivisions === 1 }">
                                    <ng-container *ngIf="!majorTimeHeaderTemplateRef">{{ slot.start | kendoDate: 't' }}</ng-container>
                                    <ng-container *ngIf="majorTimeHeaderTemplateRef" [ngTemplateOutlet]="majorTimeHeaderTemplateRef" [ngTemplateOutletContext]="{ date: slot.start }"></ng-container>
                                </th>
                                <th *ngIf="!slot.isMajor" [ngClass]="{ 'k-slot-cell': timeSlotIndex % slotDivisions === slotDivisions - 1 }">
                                    <ng-container *ngIf="minorTimeHeaderTemplateRef" [ngTemplateOutlet]="minorTimeHeaderTemplateRef" [ngTemplateOutletContext]="{ date: slot.start }">
                                    </ng-container>
                                </th>
                            </tr>
                        </ng-container>
                    </table>
                </div>
                <div class="k-scheduler-content" #content>
                    <ng-container *ngIf="showCurrentTime">
                        <div *ngFor="let resource of verticalResources | resourceIterator; trackBy: itemIndex;"
                            #currentTimeMarker class="k-current-time">
                        </div>
                    </ng-container>
                    <table class="k-scheduler-table" #contentTable role="presentation">
                        <ng-container *ngFor="let resourceItem of verticalResources | resourceIterator; let verticalIndex = index; trackBy: itemIndex;">
                            <tr class="k-scheduler-header-all-day" *ngIf="verticalResources.length">
                                <td *ngFor="let slot of daySlots; let index = index; trackBy: itemIndex"
                                    daySlot
                                    [start]="slot.start"
                                    [end]="slot.end"
                                    [id]="{ resourceIndex: verticalIndex, rangeIndex: 0, index: index }">
                                    <ng-container *ngIf="allDaySlotTemplateRef" [ngTemplateOutlet]="allDaySlotTemplateRef"
                                        [ngTemplateOutletContext]="{ date: slot.start, resources: resourcesByIndex(verticalIndex) }"></ng-container>
                                </td>
                            </tr>
                            <tr *ngFor="let slot of timeSlots; index as index; trackBy: itemIndex" [class.k-middle-row]="slot.isMajor">
                                <ng-container *ngFor="let resource of horizontalResources | resourceIterator; let horizontalIndex = index; trackBy: itemIndex;">
                                    <td *ngFor="let daySlot of daySlots; index as rangeIndex; trackBy: itemIndex"
                                        [class.k-nonwork-hour]="slot.isWorkHour"
                                        [ngClass]="timeSlotClass(slot, daySlot.start, verticalResources.length ? verticalIndex : horizontalIndex)"
                                        timeSlot #timeSlot="timeSlot"
                                            [date]="daySlot.start"
                                            [invariantStart]="slot.start"
                                            [invariantEnd]="slot.end"
                                            [workDayStart]="workDayStartTime"
                                            [workDayEnd]="workDayEndTime"
                                            [workWeekStart]="workWeekStart"
                                            [workWeekEnd]="workWeekEnd"
                                            [id]="{ resourceIndex: verticalResources.length ? verticalIndex : horizontalIndex, rangeIndex: rangeIndex, index: index }"
                                    >
                                        <ng-container *ngIf="timeSlotTemplateRef" [ngTemplateOutlet]="timeSlotTemplateRef"
                                            [ngTemplateOutletContext]="{ date: timeSlot.startLocalTime, resources: resourcesByIndex(timeSlot.id.resourceIndex) }">
                                        </ng-container>
                                    </td>
                                </ng-container>
                            </tr>
                        </ng-container>
                    </table>
                    <ng-container *ngFor="let item of items | async; trackBy: itemIndex;">
                        <div *ngFor="let itemResource of item.resources; trackBy: itemIndex;"
                            [ngClass]="getEventClasses(item, itemResource.resources)"
                            [ngStyle]="getEventStyles(item, itemResource)"
                            [kendoSchedulerFocusIndex]="itemResource.leafIdx"
                            dayTimeViewItem
                                [editable]="editable"
                                [vertical]="true"
                                [eventTemplate]="eventTemplateRef"
                                [item]="item"
                                [index]="item.index"
                                [rangeIndex]="item.rangeIndex"
                                [resources]="itemResource.resources"
                                [resourceIndex]="itemResource.leafIdx">
                        </div>
                    </ng-container>
                    <ng-container *ngIf="verticalResources.length">
                        <ng-container *ngFor="let item of allDayItems | async; trackBy: itemIndex;">
                            <div *ngFor="let itemResource of item.resources; trackBy: itemIndex;"
                                [ngClass]="getEventClasses(item, itemResource.resources, true)"
                                [ngStyle]="getEventStyles(item, itemResource, true)"
                                [kendoSchedulerFocusIndex]="itemResource.leafIdx"
                                dayTimeViewItem
                                    [isAllDay]="true"
                                    [editable]="editable"
                                    [eventTemplate]="allDayEventTemplateRef"
                                    [item]="item"
                                    [index]="item.index"
                                    [rangeIndex]="item.rangeIndex"
                                    [resources]="itemResource.resources"
                                    [resourceIndex]="itemResource.leafIdx">
                            </div>
                        </ng-container>
                    </ng-container>
                    <kendo-hint-container #hintContainer>
                        <ng-template>
                            <div *ngIf="dragHints.length && (!allDayDragHint || verticalResources.length)"
                                class="k-event-drag-hint"
                                dayTimeViewItem
                                    [isAllDay]="allDayDragHint"
                                    [ngStyle]="dragHints[0].style"
                                    [ngClass]="dragHints[0].class"
                                    [dragHint]="true"
                                    [eventTemplate]="eventTemplateRef"
                                    [resources]="dragHints[0].resources"
                                    [item]="dragHints[0].item">
                            </div>

                            <ng-container *ngIf="resizeHints.length && (!allDayResizeHint || verticalResources.length)">
                                <div *ngFor="let hint of resizeHints; trackBy: itemIndex;"
                                    kendoResizeHint
                                        [hint]="hint"
                                        [ngClass]="hint.class"
                                        [format]="allDayResizeHint ? allDayResizeHintFormat : resizeHintFormat">
                                </div>
                            </ng-container>
                        </ng-template>
                    </kendo-hint-container>
                </div>
            </div>
        </div>
    `
            }]
    }], function () { return [{ type: ɵngcc2.LocalizationService }, { type: ViewContextService }, { type: ViewStateService }, { type: ɵngcc3.IntlService }, { type: DayTimeSlotService }, { type: ɵngcc0.NgZone }, { type: ɵngcc0.Renderer2 }, { type: ɵngcc0.ElementRef }, { type: ɵngcc0.ChangeDetectorRef }, { type: PDFService }]; }, { name: [{
            type: Input
        }], slotFill: [{
            type: Input
        }], allDaySlotTemplate: [{
            type: Input
        }], allDayEventTemplate: [{
            type: Input
        }], minorTimeHeaderTemplate: [{
            type: Input
        }], majorTimeHeaderTemplate: [{
            type: Input
        }], dayCells: [{
            type: ViewChildren,
            args: ['allDayCell']
        }], headerHintContainer: [{
            type: ViewChild,
            args: ['headerHintContainer']
        }] }); })();

/**
 * @hidden
 */
class TimeSlotDirective extends BaseSlotDirective {
    constructor(element, slotService, localization) {
        super(element, slotService, localization);
        this.isDaySlot = false;
    }
    get nonWorkHour() {
        const date = this.date.getDay();
        return this.invariantStart < this.workDayStart || this.workDayEnd < this.invariantEnd || !isWorkWeekDay(date, this.workWeekStart, this.workWeekEnd);
    }
    get startLocalTime() {
        if (!this.date || !this.invariantStart) {
            return null;
        }
        return dateWithTime(this.date, this.invariantStart);
    }
    get endLocalTime() {
        if (!this.date || !this.invariantEnd) {
            return null;
        }
        return dateWithTime(this.date, this.invariantEnd);
    }
    get start() {
        if (!this.date || !this.invariantStart) {
            return null;
        }
        return toUTCTime(this.date, this.invariantStart);
    }
    get end() {
        if (!this.date || !this.invariantEnd) {
            return null;
        }
        const localEnd = toUTCTime(this.date, this.invariantEnd);
        if (INVARIANT_END.getTime() <= this.invariantEnd.getTime()) {
            return addUTCDays(localEnd, 1);
        }
        return localEnd;
    }
}
TimeSlotDirective.ɵfac = function TimeSlotDirective_Factory(t) { return new (t || TimeSlotDirective)(ɵngcc0.ɵɵdirectiveInject(ɵngcc0.ElementRef), ɵngcc0.ɵɵdirectiveInject(DayTimeSlotService), ɵngcc0.ɵɵdirectiveInject(ɵngcc2.LocalizationService)); };
TimeSlotDirective.ɵdir = ɵngcc0.ɵɵdefineDirective({ type: TimeSlotDirective, selectors: [["", "timeSlot", ""]], hostVars: 2, hostBindings: function TimeSlotDirective_HostBindings(rf, ctx) { if (rf & 2) {
        ɵngcc0.ɵɵclassProp("k-nonwork-hour", ctx.nonWorkHour);
    } }, inputs: { invariantStart: "invariantStart", invariantEnd: "invariantEnd", workDayStart: "workDayStart", workDayEnd: "workDayEnd", workWeekStart: "workWeekStart", workWeekEnd: "workWeekEnd", date: "date" }, exportAs: ["timeSlot"], features: [ɵngcc0.ɵɵInheritDefinitionFeature] });
/** @nocollapse */
TimeSlotDirective.ctorParameters = () => [
    { type: ElementRef },
    { type: DayTimeSlotService },
    { type: LocalizationService }
];
TimeSlotDirective.propDecorators = {
    invariantStart: [{ type: Input }],
    invariantEnd: [{ type: Input }],
    workDayStart: [{ type: Input }],
    workDayEnd: [{ type: Input }],
    workWeekStart: [{ type: Input }],
    workWeekEnd: [{ type: Input }],
    date: [{ type: Input }],
    nonWorkHour: [{ type: HostBinding, args: ['class.k-nonwork-hour',] }]
};
/*@__PURE__*/ (function () { ɵngcc0.ɵsetClassMetadata(TimeSlotDirective, [{
        type: Directive,
        args: [{
                // tslint:disable-next-line:directive-selector
                selector: '[timeSlot]',
                exportAs: 'timeSlot'
            }]
    }], function () { return [{ type: ɵngcc0.ElementRef }, { type: DayTimeSlotService }, { type: ɵngcc2.LocalizationService }]; }, { nonWorkHour: [{
            type: HostBinding,
            args: ['class.k-nonwork-hour']
        }], invariantStart: [{
            type: Input
        }], invariantEnd: [{
            type: Input
        }], workDayStart: [{
            type: Input
        }], workDayEnd: [{
            type: Input
        }], workWeekStart: [{
            type: Input
        }], workWeekEnd: [{
            type: Input
        }], date: [{
            type: Input
        }] }); })();
/**
 * @hidden
 */
class DaySlotDirective extends BaseSlotDirective {
    constructor(element, slotService, localization) {
        super(element, slotService, localization);
        this.isDaySlot = true;
    }
    set start(value) {
        this.startDate = value;
    }
    get start() {
        if (!this.startDate) {
            return null;
        }
        return toUTCDate(this.startDate);
    }
    set end(value) {
        this.endDate = value;
    }
    get end() {
        if (!this.endDate) {
            return null;
        }
        return toUTCDate(this.endDate);
    }
    get daySlot() {
        return true;
    }
}
DaySlotDirective.ɵfac = function DaySlotDirective_Factory(t) { return new (t || DaySlotDirective)(ɵngcc0.ɵɵdirectiveInject(ɵngcc0.ElementRef), ɵngcc0.ɵɵdirectiveInject(DayTimeSlotService), ɵngcc0.ɵɵdirectiveInject(ɵngcc2.LocalizationService)); };
DaySlotDirective.ɵdir = ɵngcc0.ɵɵdefineDirective({ type: DaySlotDirective, selectors: [["", "daySlot", ""]], hostVars: 1, hostBindings: function DaySlotDirective_HostBindings(rf, ctx) { if (rf & 2) {
        ɵngcc0.ɵɵattribute("data-day-slot", ctx.daySlot);
    } }, inputs: { start: "start", end: "end" }, features: [ɵngcc0.ɵɵInheritDefinitionFeature] });
/** @nocollapse */
DaySlotDirective.ctorParameters = () => [
    { type: ElementRef },
    { type: DayTimeSlotService },
    { type: LocalizationService }
];
DaySlotDirective.propDecorators = {
    start: [{ type: Input }],
    end: [{ type: Input }],
    daySlot: [{ type: HostBinding, args: ['attr.data-day-slot',] }]
};
/*@__PURE__*/ (function () { ɵngcc0.ɵsetClassMetadata(DaySlotDirective, [{
        type: Directive,
        args: [{
                // tslint:disable-next-line:directive-selector
                selector: '[daySlot]'
            }]
    }], function () { return [{ type: ɵngcc0.ElementRef }, { type: DayTimeSlotService }, { type: ɵngcc2.LocalizationService }]; }, { start: [{
            type: Input
        }], end: [{
            type: Input
        }], daySlot: [{
            type: HostBinding,
            args: ['attr.data-day-slot']
        }] }); })();

/**
 * @hidden
 */
class DayTimeViewItemComponent extends BaseViewItem {
    constructor(intlService, slotService, localization, focusService, element, renderer, localeId) {
        super(slotService, localization, focusService, element, renderer, localeId);
        this.intlService = intlService;
        this.localeId = localeId;
    }
    get eventTime() {
        return this.intlService.format('{0:t}–{1:t}', toLocalDate(this.item.startTime), toLocalDate(this.item.endTime));
    }
}
DayTimeViewItemComponent.ɵfac = function DayTimeViewItemComponent_Factory(t) { return new (t || DayTimeViewItemComponent)(ɵngcc0.ɵɵdirectiveInject(ɵngcc3.IntlService), ɵngcc0.ɵɵdirectiveInject(DayTimeSlotService), ɵngcc0.ɵɵdirectiveInject(ɵngcc2.LocalizationService), ɵngcc0.ɵɵdirectiveInject(FocusService), ɵngcc0.ɵɵdirectiveInject(ɵngcc0.ElementRef), ɵngcc0.ɵɵdirectiveInject(ɵngcc0.Renderer2), ɵngcc0.ɵɵdirectiveInject(LOCALE_ID)); };
DayTimeViewItemComponent.ɵcmp = ɵngcc0.ɵɵdefineComponent({ type: DayTimeViewItemComponent, selectors: [["", "dayTimeViewItem", ""]], inputs: { vertical: "vertical", isAllDay: "isAllDay" }, features: [ɵngcc0.ɵɵInheritDefinitionFeature], attrs: _c187, decls: 13, vars: 11, consts: [[1, "k-event-actions"], ["class", "k-icon k-i-arrow-60-left", 4, "ngIf"], ["class", "k-icon k-i-reload", 4, "ngIf"], ["class", "k-icon k-i-non-recurrence", 4, "ngIf"], [3, "ngTemplateOutlet", "ngTemplateOutletContext", 4, "ngIf"], [4, "ngIf"], ["class", "k-link k-event-delete", "aria-hidden", "true", 4, "ngIf"], ["class", "k-icon k-i-arrow-60-right", 4, "ngIf"], ["class", "k-event-top-actions", 4, "ngIf"], ["class", "k-event-bottom-actions", 4, "ngIf"], [1, "k-icon", "k-i-arrow-60-left"], [1, "k-icon", "k-i-reload"], [1, "k-icon", "k-i-non-recurrence"], [3, "ngTemplateOutlet", "ngTemplateOutletContext"], ["class", "k-event-template k-event-time", 4, "ngIf"], ["aria-hidden", "true", 1, "k-event-template"], [1, "k-event-template", "k-event-time"], ["aria-hidden", "true", 1, "k-link", "k-event-delete"], [1, "k-icon", "k-i-close"], [1, "k-icon", "k-i-arrow-60-right"], [1, "k-event-top-actions"], [1, "k-icon", "k-i-arrow-60-up"], [1, "k-event-bottom-actions"], [1, "k-icon", "k-i-arrow-60-down"], ["class", "k-resize-handle k-resize-n", 4, "ngIf"], ["class", "k-resize-handle k-resize-s", 4, "ngIf"], [1, "k-resize-handle", "k-resize-n"], [1, "k-resize-handle", "k-resize-s"], [1, "k-resize-handle", "k-resize-w"], [1, "k-resize-handle", "k-resize-e"]], template: function DayTimeViewItemComponent_Template(rf, ctx) { if (rf & 1) {
        ɵngcc0.ɵɵelementStart(0, "span", 0);
        ɵngcc0.ɵɵtemplate(1, DayTimeViewItemComponent_span_1_Template, 1, 0, "span", 1);
        ɵngcc0.ɵɵtemplate(2, DayTimeViewItemComponent_span_2_Template, 1, 0, "span", 2);
        ɵngcc0.ɵɵtemplate(3, DayTimeViewItemComponent_span_3_Template, 1, 0, "span", 3);
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵtemplate(4, DayTimeViewItemComponent_ng_container_4_Template, 1, 6, "ng-container", 4);
        ɵngcc0.ɵɵtemplate(5, DayTimeViewItemComponent_div_5_Template, 4, 3, "div", 5);
        ɵngcc0.ɵɵelementStart(6, "span", 0);
        ɵngcc0.ɵɵtemplate(7, DayTimeViewItemComponent_span_7_Template, 2, 1, "span", 6);
        ɵngcc0.ɵɵtemplate(8, DayTimeViewItemComponent_span_8_Template, 1, 0, "span", 7);
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵtemplate(9, DayTimeViewItemComponent_span_9_Template, 2, 0, "span", 8);
        ɵngcc0.ɵɵtemplate(10, DayTimeViewItemComponent_span_10_Template, 2, 0, "span", 9);
        ɵngcc0.ɵɵtemplate(11, DayTimeViewItemComponent_ng_container_11_Template, 3, 2, "ng-container", 5);
        ɵngcc0.ɵɵtemplate(12, DayTimeViewItemComponent_ng_container_12_Template, 3, 0, "ng-container", 5);
    } if (rf & 2) {
        ɵngcc0.ɵɵadvance(1);
        ɵngcc0.ɵɵproperty("ngIf", ctx.item.tail && !ctx.vertical);
        ɵngcc0.ɵɵadvance(1);
        ɵngcc0.ɵɵproperty("ngIf", ctx.isRecurrence);
        ɵngcc0.ɵɵadvance(1);
        ɵngcc0.ɵɵproperty("ngIf", ctx.isRecurrenceException);
        ɵngcc0.ɵɵadvance(1);
        ɵngcc0.ɵɵproperty("ngIf", ctx.eventTemplate);
        ɵngcc0.ɵɵadvance(1);
        ɵngcc0.ɵɵproperty("ngIf", !ctx.eventTemplate);
        ɵngcc0.ɵɵadvance(2);
        ɵngcc0.ɵɵproperty("ngIf", ctx.removable);
        ɵngcc0.ɵɵadvance(1);
        ɵngcc0.ɵɵproperty("ngIf", ctx.item.head && !ctx.vertical);
        ɵngcc0.ɵɵadvance(1);
        ɵngcc0.ɵɵproperty("ngIf", ctx.item.tail && ctx.vertical);
        ɵngcc0.ɵɵadvance(1);
        ɵngcc0.ɵɵproperty("ngIf", ctx.item.head && ctx.vertical);
        ɵngcc0.ɵɵadvance(1);
        ɵngcc0.ɵɵproperty("ngIf", ctx.resizable && ctx.vertical);
        ɵngcc0.ɵɵadvance(1);
        ɵngcc0.ɵɵproperty("ngIf", ctx.resizable && !ctx.vertical);
    } }, directives: [ɵngcc4.NgIf, ɵngcc4.NgTemplateOutlet], encapsulation: 2 });
/** @nocollapse */
DayTimeViewItemComponent.ctorParameters = () => [
    { type: IntlService },
    { type: DayTimeSlotService },
    { type: LocalizationService },
    { type: FocusService },
    { type: ElementRef },
    { type: Renderer2 },
    { type: String, decorators: [{ type: Inject, args: [LOCALE_ID,] }] }
];
DayTimeViewItemComponent.propDecorators = {
    vertical: [{ type: Input }],
    isAllDay: [{ type: Input }]
};
/*@__PURE__*/ (function () { ɵngcc0.ɵsetClassMetadata(DayTimeViewItemComponent, [{
        type: Component,
        args: [{
                // tslint:disable-next-line:component-selector
                selector: '[dayTimeViewItem]',
                template: `
        <span class="k-event-actions">
            <span class="k-icon k-i-arrow-60-left" *ngIf="item.tail && !vertical"></span>
            <span class="k-icon k-i-reload" *ngIf="isRecurrence"></span>
            <span class="k-icon k-i-non-recurrence" *ngIf="isRecurrenceException"></span>
        </span>
        <ng-container *ngIf="eventTemplate" [ngTemplateOutlet]="eventTemplate"
            [ngTemplateOutletContext]="{ $implicit: item.event, event: item.event, resources: resources }">
        </ng-container>
        <div *ngIf="!eventTemplate" [attr.title]="eventTitle">
            <div class="k-event-template k-event-time" *ngIf="!isAllDay">{{ eventTime }}</div>
            <div class="k-event-template" aria-hidden="true">{{ item.event.title }}</div>
        </div>

        <span class="k-event-actions">
            <span *ngIf="removable" class="k-link k-event-delete" aria-hidden="true" [attr.title]="deleteMessage">
                <span class="k-icon k-i-close"></span>
            </span>
            <span class="k-icon k-i-arrow-60-right" *ngIf="item.head && !vertical"></span>
        </span>

        <span class="k-event-top-actions" *ngIf="item.tail && vertical">
            <span class="k-icon k-i-arrow-60-up"></span>
        </span>

        <span class="k-event-bottom-actions" *ngIf="item.head && vertical">
            <span class="k-icon k-i-arrow-60-down"></span>
        </span>

        <ng-container *ngIf="resizable && vertical">
            <span class="k-resize-handle k-resize-n" *ngIf="!item.tail"></span>
            <span class="k-resize-handle k-resize-s" *ngIf="!item.head"></span>
        </ng-container>

        <ng-container *ngIf="resizable && !vertical">
            <span class="k-resize-handle k-resize-w"></span>
            <span class="k-resize-handle k-resize-e"></span>
        </ng-container>
    `
            }]
    }], function () { return [{ type: ɵngcc3.IntlService }, { type: DayTimeSlotService }, { type: ɵngcc2.LocalizationService }, { type: FocusService }, { type: ɵngcc0.ElementRef }, { type: ɵngcc0.Renderer2 }, { type: String, decorators: [{
                type: Inject,
                args: [LOCALE_ID]
            }] }]; }, { vertical: [{
            type: Input
        }], isAllDay: [{
            type: Input
        }] }); })();

const DIRECTIVES = [TimeSlotDirective, DaySlotDirective, DayTimeViewItemComponent];
/**
 * @hidden
 */
class DayTimeModule {
}
DayTimeModule.ɵmod = ɵngcc0.ɵɵdefineNgModule({ type: DayTimeModule });
DayTimeModule.ɵinj = ɵngcc0.ɵɵdefineInjector({ factory: function DayTimeModule_Factory(t) { return new (t || DayTimeModule)(); }, imports: [[CommonModule, SharedModule]] });
(function () { (typeof ngJitMode === "undefined" || ngJitMode) && ɵngcc0.ɵɵsetNgModuleScope(DayTimeModule, { declarations: function () { return [TimeSlotDirective,
        DaySlotDirective,
        DayTimeViewItemComponent]; }, imports: function () { return [CommonModule,
        SharedModule]; }, exports: function () { return [TimeSlotDirective,
        DaySlotDirective,
        DayTimeViewItemComponent]; } }); })();
/*@__PURE__*/ (function () { ɵngcc0.ɵsetClassMetadata(DayTimeModule, [{
        type: NgModule,
        args: [{
                imports: [CommonModule, SharedModule],
                exports: [
                    DIRECTIVES
                ],
                declarations: [
                    DIRECTIVES
                ]
            }]
    }], null, null); })();

const PUBLIC_DIRECTIVES = [
    DayViewComponent,
    MultiDayViewComponent,
    WeekViewComponent,
    WorkWeekViewComponent
];
/**
 * @hidden
 */
class MultiDayViewModule {
}
MultiDayViewModule.ɵmod = ɵngcc0.ɵɵdefineNgModule({ type: MultiDayViewModule });
MultiDayViewModule.ɵinj = ɵngcc0.ɵɵdefineInjector({ factory: function MultiDayViewModule_Factory(t) { return new (t || MultiDayViewModule)(); }, imports: [[
            ViewsSharedModule,
            DayTimeModule
        ]] });
(function () { (typeof ngJitMode === "undefined" || ngJitMode) && ɵngcc0.ɵɵsetNgModuleScope(MultiDayViewModule, { declarations: [DayViewComponent,
        MultiDayViewComponent,
        WeekViewComponent,
        WorkWeekViewComponent,
        MultiDayViewRendererComponent], imports: [ViewsSharedModule,
        DayTimeModule], exports: [DayViewComponent,
        MultiDayViewComponent,
        WeekViewComponent,
        WorkWeekViewComponent] }); })();
/*@__PURE__*/ (function () { ɵngcc0.ɵsetClassMetadata(MultiDayViewModule, [{
        type: NgModule,
        args: [{
                imports: [
                    ViewsSharedModule,
                    DayTimeModule
                ],
                exports: [
                    PUBLIC_DIRECTIVES
                ],
                declarations: [
                    ...PUBLIC_DIRECTIVES,
                    MultiDayViewRendererComponent
                ]
            }]
    }], null, null); })();

// tslint:disable:no-input-rename
/**
 * A directive selector for a custom Scheduler view
 */
class SchedulerViewDirective extends SchedulerView {
    constructor(template) {
        super();
        this.template = template;
    }
    /**
     * The invariant name for this view. For example, `day`.
     * If not set, the name will be the same as the title.
     */
    get name() {
        return this._name || this.title;
    }
    set name(value) {
        this._name = value;
    }
}
SchedulerViewDirective.ɵfac = function SchedulerViewDirective_Factory(t) { return new (t || SchedulerViewDirective)(ɵngcc0.ɵɵdirectiveInject(ɵngcc0.TemplateRef)); };
SchedulerViewDirective.ɵdir = ɵngcc0.ɵɵdefineDirective({ type: SchedulerViewDirective, selectors: [["", "kendoSchedulerView", ""]], inputs: { name: ["kendoSchedulerViewName", "name"], title: ["kendoSchedulerView", "title"] }, features: [ɵngcc0.ɵɵProvidersFeature([{
                provide: SchedulerView,
                // tslint:disable-next-line:no-forward-ref
                useExisting: forwardRef(() => SchedulerViewDirective)
            }]), ɵngcc0.ɵɵInheritDefinitionFeature] });
/** @nocollapse */
SchedulerViewDirective.ctorParameters = () => [
    { type: TemplateRef }
];
SchedulerViewDirective.propDecorators = {
    title: [{ type: Input, args: ['kendoSchedulerView',] }],
    name: [{ type: Input, args: ['kendoSchedulerViewName',] }]
};
/*@__PURE__*/ (function () { ɵngcc0.ɵsetClassMetadata(SchedulerViewDirective, [{
        type: Directive,
        args: [{
                providers: [{
                        provide: SchedulerView,
                        // tslint:disable-next-line:no-forward-ref
                        useExisting: forwardRef(() => SchedulerViewDirective)
                    }],
                selector: '[kendoSchedulerView]'
            }]
    }], function () { return [{ type: ɵngcc0.TemplateRef }]; }, { name: [{
            type: Input,
            args: ['kendoSchedulerViewName']
        }], title: [{
            type: Input,
            args: ['kendoSchedulerView']
        }] }); })();

/**
 * @hidden
 */
const createTasks$2 = (periodStart, periodEnd, items) => {
    const tasks = [];
    const utcStart = toUTCDate(periodStart);
    const utcEnd = toUTCDate(periodEnd);
    for (let index = 0; index < items.length; index++) {
        const item = items[index];
        const event = item.event;
        const task = {
            index,
            start: item.start,
            end: item.end,
            event: event,
            isAllDay: false
        };
        const endTime = event.isAllDay ? roundAllDayEnd(item) : task.end;
        const startTime = event.isAllDay ? task.start.stripTime() : task.start;
        task.startTime = startTime.toUTCDate();
        task.endTime = endTime.toUTCDate();
        if (intersects(task.startTime, task.endTime, utcStart, utcEnd)) {
            tasks.push(task);
            task.head = task.endTime > periodEnd;
            task.tail = task.startTime < periodStart;
        }
    }
    return tasks;
};

/**
 * @hidden
 */
class TimelineMultiDayViewComponent extends DayTimeViewComponent {
    constructor(localization, changeDetector, viewContext, viewState, intl, slotService, zone, renderer, element, pdfService) {
        super(changeDetector, viewContext, viewState, intl, slotService, zone, renderer, element, pdfService, localization);
        this.name = 'timeline';
        this.columnWidth = 100;
        this.viewName = 'timeline';
        this.verticalTime = false;
    }
    get classNames() {
        return `k-scheduler-${this.viewName}-view`;
    }
    ngOnChanges(changes) {
        if (changes.columnWidth) {
            this.changes.next(null);
        }
        super.ngOnChanges(changes);
    }
    reflow() {
        const slotService = this.slotService;
        this.updateContentHeight();
        slotService.containerSize = this.content.nativeElement.scrollWidth;
        const verticalResourceRows = this.verticalResources.length ? this.verticalResourceRows.toArray() : [];
        slotService.layoutTimeline(this.eventHeight, verticalResourceRows);
        if (verticalResourceRows.length) {
            slotService.forEachGroup((group, index) => {
                verticalResourceRows[index].nativeElement.style.height = `${group.timeRanges[0].slots[0].height}px`;
            });
        }
        this.syncTables();
    }
    get allEventsMessage() {
        return this.localization.get('allEvents');
    }
    get slotsCount() {
        const resources = this.horizontalResources;
        let result = this.daySlots.length * this.timeSlots.length;
        for (let idx = 0; idx < resources.length; idx++) {
            result *= (resources[idx].data || []).length || 1;
        }
        return result;
    }
    timeColspan(index) {
        const timeSlots = this.timeSlots.length;
        const remainder = timeSlots % this.slotDivisions;
        return remainder === 0 || (index < timeSlots - remainder) ? this.slotDivisions : 1;
    }
    horizontalColspan(resourceIndex) {
        const resources = this.horizontalResources;
        let result = this.daySlots.length * this.timeSlots.length;
        for (let idx = resourceIndex + 1; idx < resources.length; idx++) {
            result *= (resources[idx].data || []).length || 1;
        }
        return result;
    }
    verticalRowspan(resourceIndex) {
        const resources = this.verticalResources;
        let result = 1;
        for (let idx = resourceIndex + 1; idx < resources.length; idx++) {
            result *= (resources[idx].data || []).length || 1;
        }
        return result;
    }
    createTasks(items, dateRange) {
        return createTasks$2(dateRange.start, dateRange.end, items);
    }
    onTasksChange() {
        this.items.next(this.tasks);
    }
    dragRanges(slot) {
        return this.slotService.dragRanges(slot, this.dragging.offset, true);
    }
    dragHintSize(firstSlot, lastSlot) {
        return {
            width: toPx(lastSlot.rect.left - firstSlot.rect.left + lastSlot.rect.width),
            height: toPx(firstSlot.height)
        };
    }
    updateResizeHints(ranges, start, end) {
        const last = ranges[ranges.length - 1];
        super.updateResizeHints([[ranges[0][0], last[last.length - 1]]], start, end);
    }
    pdfWidth() {
        const contentWidth = this.content.nativeElement.scrollWidth;
        const timesWidth = this.times.nativeElement.offsetWidth;
        return contentWidth + timesWidth;
    }
    currentTimeArrowOffset() {
        return this.headerWrap.nativeElement.querySelector('tr:last-child').offsetTop;
    }
}
TimelineMultiDayViewComponent.ɵfac = function TimelineMultiDayViewComponent_Factory(t) { return new (t || TimelineMultiDayViewComponent)(ɵngcc0.ɵɵdirectiveInject(ɵngcc2.LocalizationService), ɵngcc0.ɵɵdirectiveInject(ɵngcc0.ChangeDetectorRef), ɵngcc0.ɵɵdirectiveInject(ViewContextService), ɵngcc0.ɵɵdirectiveInject(ViewStateService), ɵngcc0.ɵɵdirectiveInject(ɵngcc3.IntlService), ɵngcc0.ɵɵdirectiveInject(DayTimeSlotService), ɵngcc0.ɵɵdirectiveInject(ɵngcc0.NgZone), ɵngcc0.ɵɵdirectiveInject(ɵngcc0.Renderer2), ɵngcc0.ɵɵdirectiveInject(ɵngcc0.ElementRef), ɵngcc0.ɵɵdirectiveInject(PDFService)); };
TimelineMultiDayViewComponent.ɵcmp = ɵngcc0.ɵɵdefineComponent({ type: TimelineMultiDayViewComponent, selectors: [["timeline-multi-day-view"]], viewQuery: function TimelineMultiDayViewComponent_Query(rf, ctx) { if (rf & 1) {
        ɵngcc0.ɵɵviewQuery(_c188, true);
    } if (rf & 2) {
        var _t;
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.verticalResourceRows = _t);
    } }, inputs: { name: "name", columnWidth: "columnWidth", viewName: "viewName" }, features: [ɵngcc0.ɵɵProvidersFeature([
            DayTimeSlotService
        ]), ɵngcc0.ɵɵInheritDefinitionFeature, ɵngcc0.ɵɵNgOnChangesFeature], decls: 48, vars: 33, consts: [[1, "k-scheduler-layout", "k-scheduler-flex-layout", 3, "ngClass"], [1, "k-scheduler-pane"], [1, "k-scheduler-times"], ["timesHeader", ""], ["aria-hidden", "true", 1, "k-scheduler-table"], [1, "k-slot-cell"], [4, "ngFor", "ngForOf", "ngForTrackBy"], [1, "k-scheduler-header", "k-state-default"], ["header", ""], [1, "k-scheduler-header-wrap"], ["headerWrap", ""], [4, "ngIf"], [3, "ngStyle", 4, "ngFor", "ngForOf", "ngForTrackBy"], ["times", ""], ["timesTable", ""], [1, "k-scheduler-content"], ["content", ""], ["role", "presentation", 1, "k-scheduler-table"], ["contentTable", ""], ["hintContainer", ""], ["class", "k-current-time k-current-time-arrow-down", 4, "ngFor", "ngForOf", "ngForTrackBy"], [1, "k-current-time", "k-current-time-arrow-down"], ["currentTimeArrow", ""], [3, "ngStyle"], ["class", "k-slot-cell", 4, "ngFor", "ngForOf", "ngForTrackBy"], [3, "ngTemplateOutlet", "ngTemplateOutletContext", 4, "ngIf"], [3, "ngTemplateOutlet", "ngTemplateOutletContext"], ["class", "k-link", 3, "ngClass", 4, "ngIf"], [1, "k-link", 3, "ngClass"], ["rowspan", "1"], ["titleCell", ""], ["verticalResourceRows", ""], ["class", "k-slot-cell", 4, "ngIf"], ["class", "k-current-time", 4, "ngFor", "ngForOf", "ngForTrackBy"], [1, "k-current-time"], ["currentTimeMarker", ""], ["timeSlot", "", 3, "ngClass", "date", "invariantStart", "invariantEnd", "workDayStart", "workDayEnd", "workWeekStart", "workWeekEnd", "id", 4, "ngFor", "ngForOf", "ngForTrackBy"], ["timeSlot", "", 3, "ngClass", "date", "invariantStart", "invariantEnd", "workDayStart", "workDayEnd", "workWeekStart", "workWeekEnd", "id"], ["timeSlot", "timeSlot"], ["dayTimeViewItem", "", 3, "ngClass", "ngStyle", "kendoSchedulerFocusIndex", "editable", "item", "index", "rangeIndex", "eventTemplate", "resources", "resourceIndex", 4, "ngFor", "ngForOf", "ngForTrackBy"], ["dayTimeViewItem", "", 3, "ngClass", "ngStyle", "kendoSchedulerFocusIndex", "editable", "item", "index", "rangeIndex", "eventTemplate", "resources", "resourceIndex"], ["class", "k-event-drag-hint", "dayTimeViewItem", "", 3, "ngStyle", "ngClass", "dragHint", "eventTemplate", "item", "resources", 4, "ngFor", "ngForOf", "ngForTrackBy"], ["kendoResizeHint", "", 3, "hint", "ngClass", "format", 4, "ngIf"], ["dayTimeViewItem", "", 1, "k-event-drag-hint", 3, "ngStyle", "ngClass", "dragHint", "eventTemplate", "item", "resources"], ["kendoResizeHint", "", 3, "hint", "ngClass", "format"]], template: function TimelineMultiDayViewComponent_Template(rf, ctx) { if (rf & 1) {
        ɵngcc0.ɵɵelementStart(0, "div", 0);
        ɵngcc0.ɵɵelementStart(1, "div", 1);
        ɵngcc0.ɵɵelementStart(2, "div", 2, 3);
        ɵngcc0.ɵɵelementStart(4, "table", 4);
        ɵngcc0.ɵɵelementStart(5, "tr");
        ɵngcc0.ɵɵelement(6, "th");
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵelementStart(7, "tr");
        ɵngcc0.ɵɵelement(8, "th", 5);
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵtemplate(9, TimelineMultiDayViewComponent_tr_9_Template, 2, 0, "tr", 6);
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵelementStart(10, "div", 7, 8);
        ɵngcc0.ɵɵelementStart(12, "div", 9, 10);
        ɵngcc0.ɵɵtemplate(14, TimelineMultiDayViewComponent_ng_container_14_Template, 3, 4, "ng-container", 11);
        ɵngcc0.ɵɵelementStart(15, "table", 4);
        ɵngcc0.ɵɵelementStart(16, "colgroup");
        ɵngcc0.ɵɵtemplate(17, TimelineMultiDayViewComponent_col_17_Template, 1, 3, "col", 12);
        ɵngcc0.ɵɵpipe(18, "repeat");
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵtemplate(19, TimelineMultiDayViewComponent_tr_19_Template, 3, 5, "tr", 6);
        ɵngcc0.ɵɵelementStart(20, "tr");
        ɵngcc0.ɵɵtemplate(21, TimelineMultiDayViewComponent_ng_container_21_Template, 2, 2, "ng-container", 6);
        ɵngcc0.ɵɵpipe(22, "resourceIterator");
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵelementStart(23, "tr");
        ɵngcc0.ɵɵtemplate(24, TimelineMultiDayViewComponent_ng_container_24_Template, 2, 2, "ng-container", 6);
        ɵngcc0.ɵɵpipe(25, "resourceIterator");
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵelementStart(26, "div", 1);
        ɵngcc0.ɵɵelementStart(27, "div", 2, 13);
        ɵngcc0.ɵɵelementStart(29, "table", 4, 14);
        ɵngcc0.ɵɵtemplate(31, TimelineMultiDayViewComponent_tr_31_Template, 4, 1, "tr", 11);
        ɵngcc0.ɵɵtemplate(32, TimelineMultiDayViewComponent_ng_container_32_Template, 3, 4, "ng-container", 11);
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵelementStart(33, "div", 15, 16);
        ɵngcc0.ɵɵtemplate(35, TimelineMultiDayViewComponent_ng_container_35_Template, 3, 4, "ng-container", 11);
        ɵngcc0.ɵɵelementStart(36, "table", 17, 18);
        ɵngcc0.ɵɵelementStart(38, "colgroup");
        ɵngcc0.ɵɵtemplate(39, TimelineMultiDayViewComponent_col_39_Template, 1, 3, "col", 12);
        ɵngcc0.ɵɵpipe(40, "repeat");
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵtemplate(41, TimelineMultiDayViewComponent_tr_41_Template, 3, 4, "tr", 6);
        ɵngcc0.ɵɵpipe(42, "resourceIterator");
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵtemplate(43, TimelineMultiDayViewComponent_ng_container_43_Template, 2, 2, "ng-container", 6);
        ɵngcc0.ɵɵpipe(44, "async");
        ɵngcc0.ɵɵelementStart(45, "kendo-hint-container", null, 19);
        ɵngcc0.ɵɵtemplate(47, TimelineMultiDayViewComponent_ng_template_47_Template, 2, 3, "ng-template");
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵelementEnd();
    } if (rf & 2) {
        ɵngcc0.ɵɵproperty("ngClass", ctx.classNames);
        ɵngcc0.ɵɵadvance(9);
        ɵngcc0.ɵɵproperty("ngForOf", ctx.horizontalResources)("ngForTrackBy", ctx.itemIndex);
        ɵngcc0.ɵɵadvance(5);
        ɵngcc0.ɵɵproperty("ngIf", ctx.showCurrentTime);
        ɵngcc0.ɵɵadvance(3);
        ɵngcc0.ɵɵproperty("ngForOf", ɵngcc0.ɵɵpipeBind1(18, 21, ctx.slotsCount))("ngForTrackBy", ctx.itemIndex);
        ɵngcc0.ɵɵadvance(2);
        ɵngcc0.ɵɵproperty("ngForOf", ctx.horizontalResources)("ngForTrackBy", ctx.itemIndex);
        ɵngcc0.ɵɵadvance(2);
        ɵngcc0.ɵɵproperty("ngForOf", ɵngcc0.ɵɵpipeBind1(22, 23, ctx.horizontalResources))("ngForTrackBy", ctx.itemIndex);
        ɵngcc0.ɵɵadvance(3);
        ɵngcc0.ɵɵproperty("ngForOf", ɵngcc0.ɵɵpipeBind1(25, 25, ctx.horizontalResources))("ngForTrackBy", ctx.itemIndex);
        ɵngcc0.ɵɵadvance(7);
        ɵngcc0.ɵɵproperty("ngIf", !ctx.verticalResources.length);
        ɵngcc0.ɵɵadvance(1);
        ɵngcc0.ɵɵproperty("ngIf", ctx.verticalResources.length);
        ɵngcc0.ɵɵadvance(3);
        ɵngcc0.ɵɵproperty("ngIf", ctx.showCurrentTime);
        ɵngcc0.ɵɵadvance(4);
        ɵngcc0.ɵɵproperty("ngForOf", ɵngcc0.ɵɵpipeBind1(40, 27, ctx.slotsCount))("ngForTrackBy", ctx.itemIndex);
        ɵngcc0.ɵɵadvance(2);
        ɵngcc0.ɵɵproperty("ngForOf", ɵngcc0.ɵɵpipeBind1(42, 29, ctx.verticalResources))("ngForTrackBy", ctx.itemIndex);
        ɵngcc0.ɵɵadvance(2);
        ɵngcc0.ɵɵproperty("ngForOf", ɵngcc0.ɵɵpipeBind1(44, 31, ctx.items))("ngForTrackBy", ctx.itemIndex);
    } }, directives: [ɵngcc4.NgClass, ɵngcc4.NgForOf, ɵngcc4.NgIf, HintContainerComponent, ɵngcc4.NgStyle, ɵngcc4.NgTemplateOutlet, TimeSlotDirective,
        DayTimeViewItemComponent,
        FocusableDirective,
        ResizeHintComponent], pipes: [RepeatPipe,
        ResourceIteratorPipe, ɵngcc4.AsyncPipe, ɵngcc3.DatePipe], encapsulation: 2 });
/** @nocollapse */
TimelineMultiDayViewComponent.ctorParameters = () => [
    { type: LocalizationService },
    { type: ChangeDetectorRef },
    { type: ViewContextService },
    { type: ViewStateService },
    { type: IntlService },
    { type: DayTimeSlotService },
    { type: NgZone },
    { type: Renderer2 },
    { type: ElementRef },
    { type: PDFService }
];
TimelineMultiDayViewComponent.propDecorators = {
    name: [{ type: Input }],
    columnWidth: [{ type: Input }],
    viewName: [{ type: Input }],
    verticalResourceRows: [{ type: ViewChildren, args: ['verticalResourceRows',] }]
};
/*@__PURE__*/ (function () { ɵngcc0.ɵsetClassMetadata(TimelineMultiDayViewComponent, [{
        type: Component,
        args: [{
                // tslint:disable-next-line:component-selector
                selector: 'timeline-multi-day-view',
                providers: [
                    DayTimeSlotService
                ],
                template: `
        <div class="k-scheduler-layout k-scheduler-flex-layout" [ngClass]="classNames">
            <div class="k-scheduler-pane">
                <div class="k-scheduler-times" #timesHeader>
                    <table class="k-scheduler-table" aria-hidden="true">
                        <tr><th></th></tr>
                        <tr><th class="k-slot-cell"></th></tr>
                        <tr *ngFor="let resource of horizontalResources; trackBy: itemIndex;">
                            <th></th>
                        </tr>
                    </table>
                </div>
                <div class="k-scheduler-header k-state-default" #header >
                    <div class="k-scheduler-header-wrap" #headerWrap>
                        <ng-container *ngIf="showCurrentTime">
                            <div *ngFor="let resource of horizontalResources | resourceIterator; trackBy: itemIndex;"
                                #currentTimeArrow class="k-current-time k-current-time-arrow-down">
                            </div>
                        </ng-container>
                        <table class="k-scheduler-table" aria-hidden="true">
                            <colgroup>
                                <col *ngFor="let slotIndex of slotsCount | repeat; trackBy: itemIndex;" [ngStyle]="{ 'width.px': columnWidth }" />
                            </colgroup>
                            <tr *ngFor="let resource of horizontalResources; let resourceIndex = index; trackBy: itemIndex;">
                                <th *ngFor="let item of horizontalResources | resourceIterator : resourceIndex; trackBy: itemIndex;"
                                    class="k-slot-cell" [attr.colspan]="horizontalColspan(resourceIndex)">
                                    <ng-container *ngIf="!groupHeaderTemplateRef">{{ getField(item, resource.textField) }}</ng-container>
                                    <ng-container *ngIf="groupHeaderTemplateRef" [ngTemplateOutlet]="groupHeaderTemplateRef"
                                        [ngTemplateOutletContext]="{ resource: item }"></ng-container>
                                </th>
                            </tr>
                             <tr>
                                 <ng-container *ngFor="let resource of horizontalResources | resourceIterator; trackBy: itemIndex;">
                                     <ng-container *ngFor="let daySlot of daySlots; let index = index; trackBy: itemIndex;">
                                         <th [attr.colspan]="timeSlots.length" class="k-slot-cell">
                                             <span *ngIf="!dateHeaderTemplateRef" class="k-link" [ngClass]="{ 'k-nav-day': numberOfDays > 1 }" [attr.data-dayslot-index]="index">{{ daySlot.start | kendoDate: 'm'}}</span>
                                             <ng-container *ngIf="dateHeaderTemplateRef" [ngTemplateOutlet]="dateHeaderTemplateRef" [ngTemplateOutletContext]="{ date: daySlot.start }"></ng-container>
                                         </th>
                                     </ng-container>
                                 </ng-container>
                             </tr>
                             <tr>
                                 <ng-container *ngFor="let resource of horizontalResources | resourceIterator; let resourceIndex = index; trackBy: itemIndex;">
                                    <ng-container *ngFor="let daySlot of daySlots; let rangeIndex = index; trackBy: itemIndex;">
                                        <ng-container *ngFor="let timeSlot of timeSlots; let index = index; trackBy: itemIndex;">
                                            <th *ngIf="timeSlot.isMajor" [attr.colspan]="timeColspan(index)" >{{ timeSlot.start | kendoDate: 't' }}</th>
                                        </ng-container>
                                    </ng-container>
                                 </ng-container>
                             </tr>
                        </table>
                    </div>
                </div>
            </div>
            <div class="k-scheduler-pane">
                <div class="k-scheduler-times" #times>
                    <table class="k-scheduler-table" #timesTable aria-hidden="true">
                        <tr *ngIf="!verticalResources.length">
                            <th rowspan="1" #titleCell>
                                {{ allEventsMessage }}
                            </th>
                        </tr>
                        <ng-container *ngIf="verticalResources.length">
                            <ng-container *ngFor="let resourceItem of verticalResources | resourceIterator; let leafIndex = index; trackBy: itemIndex;">
                                <tr #verticalResourceRows>
                                    <ng-container *ngFor="let resource of verticalResources; let resourceIndex = index; trackBy: itemIndex;">
                                        <th *ngIf="verticalItem(leafIndex, resourceIndex)" [attr.rowspan]="verticalRowspan(resourceIndex)" class="k-slot-cell">
                                            <div>
                                                <ng-container *ngIf="!groupHeaderTemplateRef">{{ getField(verticalItem(leafIndex, resourceIndex), resource.textField) }}</ng-container>
                                                <ng-container *ngIf="groupHeaderTemplateRef" [ngTemplateOutlet]="groupHeaderTemplateRef"
                                                    [ngTemplateOutletContext]="{ resource: verticalItem(leafIndex, resourceIndex) }"></ng-container>
                                            </div>
                                        </th>
                                    </ng-container>
                                </tr>
                            </ng-container>
                        </ng-container>
                    </table>
                </div>
                <div class="k-scheduler-content" #content>
                    <ng-container *ngIf="showCurrentTime">
                        <div *ngFor="let resource of horizontalResources | resourceIterator; trackBy: itemIndex;"
                            class="k-current-time" #currentTimeMarker>
                        </div>
                    </ng-container>
                    <table class="k-scheduler-table" #contentTable role="presentation">
                        <colgroup>
                            <col *ngFor="let slotIndex of slotsCount | repeat; trackBy: itemIndex;" [ngStyle]="{ 'width.px': columnWidth }" />
                        </colgroup>
                        <tr *ngFor="let resourceItem of verticalResources | resourceIterator; let verticalIndex = index; trackBy: itemIndex;">
                            <ng-container *ngFor="let resource of horizontalResources | resourceIterator; let horizontalIndex = index; trackBy: itemIndex;">
                                <ng-container *ngFor="let daySlot of daySlots; let rangeIndex = index; trackBy: itemIndex;">
                                    <td *ngFor="let slot of timeSlots; let index = index; trackBy: itemIndex;"
                                            [ngClass]="timeSlotClass(slot, daySlot.start, verticalResources.length ? verticalIndex : horizontalIndex)"
                                            timeSlot #timeSlot="timeSlot"
                                            [date]="daySlot.start"
                                            [invariantStart]="slot.start"
                                            [invariantEnd]="slot.end"
                                            [workDayStart]="workDayStartTime"
                                            [workDayEnd]="workDayEndTime"
                                            [workWeekStart]="workWeekStart"
                                            [workWeekEnd]="workWeekEnd"
                                            [id]="{ resourceIndex: verticalResources.length ? verticalIndex : horizontalIndex, rangeIndex: rangeIndex, index: index }"
                                    >
                                        <ng-container *ngIf="timeSlotTemplateRef" [ngTemplateOutlet]="timeSlotTemplateRef"
                                            [ngTemplateOutletContext]="{ date: timeSlot.start, resources: resourcesByIndex(timeSlot.id.resourceIndex ) }">
                                        </ng-container>
                                    </td>
                                </ng-container>
                            </ng-container>
                        </tr>
                    </table>
                    <ng-container *ngFor="let item of items | async; trackBy: itemIndex;">
                        <div *ngFor="let itemResource of item.resources; trackBy: itemIndex;"
                            [ngClass]="getEventClasses(item, itemResource.resources)"
                            [ngStyle]="getEventStyles(item, itemResource)"
                            [kendoSchedulerFocusIndex]="itemResource.leafIdx"
                            dayTimeViewItem
                                [editable]="editable"
                                [item]="item"
                                [index]="item.index"
                                [rangeIndex]="item.rangeIndex"
                                [eventTemplate]="eventTemplateRef"
                                [resources]="itemResource.resources"
                                [resourceIndex]="itemResource.leafIdx">
                        </div>
                    </ng-container>
                    <kendo-hint-container #hintContainer>
                        <ng-template>
                            <div *ngFor="let hint of dragHints; trackBy: itemIndex;"
                                class="k-event-drag-hint"
                                dayTimeViewItem
                                    [ngStyle]="hint.style"
                                    [ngClass]="hint.class"
                                    [dragHint]="true"
                                    [eventTemplate]="eventTemplateRef"
                                    [item]="hint.item"
                                    [resources]="hint.resources">
                            </div>
                            <div *ngIf="resizeHints && resizeHints.length"
                                kendoResizeHint
                                [hint]="resizeHints[0]"
                                [ngClass]="resizeHints[0].class"
                                [format]="resizeHintFormat">
                            </div>
                        </ng-template>
                    </kendo-hint-container>
                </div>
            </div>
        </div>
    `
            }]
    }], function () { return [{ type: ɵngcc2.LocalizationService }, { type: ɵngcc0.ChangeDetectorRef }, { type: ViewContextService }, { type: ViewStateService }, { type: ɵngcc3.IntlService }, { type: DayTimeSlotService }, { type: ɵngcc0.NgZone }, { type: ɵngcc0.Renderer2 }, { type: ɵngcc0.ElementRef }, { type: PDFService }]; }, { name: [{
            type: Input
        }], columnWidth: [{
            type: Input
        }], viewName: [{
            type: Input
        }], verticalResourceRows: [{
            type: ViewChildren,
            args: ['verticalResourceRows']
        }] }); })();

const COLUMN_WIDTH = 'columnWidth';
/**
 * @hidden
 */
class TimelineBase extends DayTimeViewBase {
    constructor(localization, changeDetector, viewContext, viewState) {
        super(localization, changeDetector, viewContext, viewState);
    }
    /**
     * @hidden
     */
    get viewColumnWidth() {
        return this.optionValue(COLUMN_WIDTH);
    }
}
TimelineBase.ɵfac = function TimelineBase_Factory(t) { ɵngcc0.ɵɵinvalidFactory(); };
TimelineBase.ɵdir = ɵngcc0.ɵɵdefineDirective({ type: TimelineBase, inputs: { columnWidth: "columnWidth" }, features: [ɵngcc0.ɵɵInheritDefinitionFeature] });
TimelineBase.propDecorators = {
    columnWidth: [{ type: Input }]
};


/**
 * The component for rendering the **Timeline** view.
 */
class TimelineViewComponent extends TimelineBase {
    constructor(localization, changeDetector, viewContext, viewState) {
        super(localization, changeDetector, viewContext, viewState);
        /**
         * The long-date format for displaying the
         * selected date in the Scheduler toolbar.
         * Defaults to `{0:D}`
         * ([more information]({% slug parsingandformatting_intl %}#toc-date-formatting)).
         */
        this.selectedDateFormat = '{0:D}';
        /**
         * The short-date format for displaying the
         * selected date in the Scheduler toolbar.
         * Defaults to `{0:D}`
         * ([more information]({% slug parsingandformatting_intl %}#toc-date-formatting)).
         */
        this.selectedShortDateFormat = '{0:d}';
        /**
         * The invariant name for this view (`timeline`).
         */
        this.name = 'timeline';
    }
    /**
     * @hidden
     */
    get title() {
        return this.localization.get('timelineViewTitle');
    }
}
TimelineViewComponent.ɵfac = function TimelineViewComponent_Factory(t) { return new (t || TimelineViewComponent)(ɵngcc0.ɵɵdirectiveInject(ɵngcc2.LocalizationService), ɵngcc0.ɵɵdirectiveInject(ɵngcc0.ChangeDetectorRef), ɵngcc0.ɵɵdirectiveInject(ViewContextService), ɵngcc0.ɵɵdirectiveInject(ViewStateService)); };
TimelineViewComponent.ɵcmp = ɵngcc0.ɵɵdefineComponent({ type: TimelineViewComponent, selectors: [["kendo-scheduler-timeline-view"]], inputs: { selectedDateFormat: "selectedDateFormat", selectedShortDateFormat: "selectedShortDateFormat" }, features: [ɵngcc0.ɵɵProvidersFeature([{
                provide: SchedulerView,
                // tslint:disable-next-line:no-forward-ref
                useExisting: forwardRef(() => TimelineViewComponent)
            }]), ɵngcc0.ɵɵInheritDefinitionFeature], decls: 2, vars: 0, consts: [["content", ""], [3, "name", "eventHeight", "columnWidth", "currentTimeMarker", "showWorkHours", "scrollTime", "startTime", "endTime", "workDayStart", "workDayEnd", "workWeekStart", "workWeekEnd", "slotDuration", "slotDivisions", "slotClass", "eventClass", "eventStyles", "\u0435ventTemplate", "groupHeaderTemplate", "timeSlotTemplate", "dateHeaderTemplate", "selectedDateFormat", "selectedShortDateFormat"], ["viewFooter", "", "kendoWorkHoursFooter", "", 3, "showWorkHours", "itemClick"]], template: function TimelineViewComponent_Template(rf, ctx) { if (rf & 1) {
        ɵngcc0.ɵɵtemplate(0, TimelineViewComponent_ng_template_0_Template, 2, 24, "ng-template", null, 0, ɵngcc0.ɵɵtemplateRefExtractor);
    } }, directives: [TimelineMultiDayViewComponent,
        ViewFooterComponent,
        WorkHoursFooterDirective], encapsulation: 2, changeDetection: 0 });
/** @nocollapse */
TimelineViewComponent.ctorParameters = () => [
    { type: LocalizationService },
    { type: ChangeDetectorRef },
    { type: ViewContextService },
    { type: ViewStateService }
];
TimelineViewComponent.propDecorators = {
    selectedDateFormat: [{ type: Input }],
    selectedShortDateFormat: [{ type: Input }]
};
/*@__PURE__*/ (function () { ɵngcc0.ɵsetClassMetadata(TimelineViewComponent, [{
        type: Component,
        args: [{
                changeDetection: ChangeDetectionStrategy.OnPush,
                selector: 'kendo-scheduler-timeline-view',
                providers: [{
                        provide: SchedulerView,
                        // tslint:disable-next-line:no-forward-ref
                        useExisting: forwardRef(() => TimelineViewComponent)
                    }],
                template: `
        <ng-template #content>
            <timeline-multi-day-view
                [name]="name"
                [eventHeight]="viewEventHeight"
                [columnWidth]="viewColumnWidth"
                [currentTimeMarker]="viewCurrentTimeMarker"
                [showWorkHours]="shouldShowWorkHours"
                [scrollTime]="viewScrollTime"
                [startTime]="viewStartTime"
                [endTime]="viewEndTime"
                [workDayStart]="viewWorkDayStart"
                [workDayEnd]="viewWorkDayEnd"
                [workWeekStart]="viewWorkWeekStart"
                [workWeekEnd]="viewWorkWeekEnd"
                [slotDuration]="viewSlotDuration"
                [slotDivisions]="viewSlotDivisions"
                [slotClass]="viewSlotClass"
                [eventClass]="viewEventClass"
                [eventStyles]="viewEventStyles"
                [еventTemplate]="eventTemplate?.templateRef"
                [groupHeaderTemplate]="groupHeaderTemplate?.templateRef"
                [timeSlotTemplate]="timeSlotTemplate?.templateRef"
                [dateHeaderTemplate]="dateHeaderTemplate?.templateRef"
                [selectedDateFormat]="selectedDateFormat"
                [selectedShortDateFormat]="selectedShortDateFormat">
            </timeline-multi-day-view>
            <div viewFooter kendoWorkHoursFooter [showWorkHours]="shouldShowWorkHours" (itemClick)="showWorkHours = !shouldShowWorkHours"></div>
        </ng-template>
    `
            }]
    }], function () { return [{ type: ɵngcc2.LocalizationService }, { type: ɵngcc0.ChangeDetectorRef }, { type: ViewContextService }, { type: ViewStateService }]; }, { selectedDateFormat: [{
            type: Input
        }], selectedShortDateFormat: [{
            type: Input
        }] }); })();

/**
 * The component for rendering the **Week** timeline view.
 */
class TimelineWeekViewComponent extends TimelineBase {
    constructor(intl, localization, changeDetector, viewContext, viewState) {
        super(localization, changeDetector, viewContext, viewState);
        this.intl = intl;
        /**
         * The long-date format that will be used for displaying the
         * selected date in the Scheduler toolbar.
         * Defaults to `{0:D} - {1:D}`
         * where `0` is the start and `1` is the end date
         * ([more information]({% slug parsingandformatting_intl %}#toc-date-formatting)).
         */
        this.selectedDateFormat = '{0:D} - {1:D}';
        /**
         * The short date format that will be used for displaying the
         * selected date in the Scheduler toolbar.
         * Defaults to `{0:d} - {1:d}`
         * where `0` is the start and `1` is the end date
         * ([more information]({% slug parsingandformatting_intl %}#toc-date-formatting)).
         */
        this.selectedShortDateFormat = '{0:d} - {1:d}';
        /**
         * The invariant name for this view (`timelineWeek`).
         */
        this.name = 'timelineWeek';
        /**
         * @hidden
         */
        this.getStartDate = (selectedDate) => {
            return firstDayInWeek(getDate(selectedDate), this.intl.firstDay());
        };
    }
    /**
     * @hidden
     */
    get title() {
        return this.localization.get('timelineWeekViewTitle');
    }
}
TimelineWeekViewComponent.ɵfac = function TimelineWeekViewComponent_Factory(t) { return new (t || TimelineWeekViewComponent)(ɵngcc0.ɵɵdirectiveInject(ɵngcc3.IntlService), ɵngcc0.ɵɵdirectiveInject(ɵngcc2.LocalizationService), ɵngcc0.ɵɵdirectiveInject(ɵngcc0.ChangeDetectorRef), ɵngcc0.ɵɵdirectiveInject(ViewContextService), ɵngcc0.ɵɵdirectiveInject(ViewStateService)); };
TimelineWeekViewComponent.ɵcmp = ɵngcc0.ɵɵdefineComponent({ type: TimelineWeekViewComponent, selectors: [["kendo-scheduler-timeline-week-view"]], inputs: { selectedDateFormat: "selectedDateFormat", selectedShortDateFormat: "selectedShortDateFormat" }, features: [ɵngcc0.ɵɵProvidersFeature([{
                provide: SchedulerView,
                // tslint:disable-next-line:no-forward-ref
                useExisting: forwardRef(() => TimelineWeekViewComponent)
            }]), ɵngcc0.ɵɵInheritDefinitionFeature], decls: 2, vars: 0, consts: [["content", ""], ["viewName", "timeline-week", 3, "name", "numberOfDays", "getStartDate", "eventHeight", "columnWidth", "currentTimeMarker", "showWorkHours", "scrollTime", "startTime", "endTime", "workDayStart", "workDayEnd", "workWeekStart", "workWeekEnd", "slotDuration", "slotDivisions", "slotClass", "eventClass", "eventStyles", "\u0435ventTemplate", "groupHeaderTemplate", "timeSlotTemplate", "dateHeaderTemplate", "selectedDateFormat", "selectedShortDateFormat"], ["viewFooter", "", "kendoWorkHoursFooter", "", 3, "showWorkHours", "itemClick"]], template: function TimelineWeekViewComponent_Template(rf, ctx) { if (rf & 1) {
        ɵngcc0.ɵɵtemplate(0, TimelineWeekViewComponent_ng_template_0_Template, 2, 26, "ng-template", null, 0, ɵngcc0.ɵɵtemplateRefExtractor);
    } }, directives: [TimelineMultiDayViewComponent,
        ViewFooterComponent,
        WorkHoursFooterDirective], encapsulation: 2, changeDetection: 0 });
/** @nocollapse */
TimelineWeekViewComponent.ctorParameters = () => [
    { type: IntlService },
    { type: LocalizationService },
    { type: ChangeDetectorRef },
    { type: ViewContextService },
    { type: ViewStateService }
];
TimelineWeekViewComponent.propDecorators = {
    selectedDateFormat: [{ type: Input }],
    selectedShortDateFormat: [{ type: Input }]
};
/*@__PURE__*/ (function () { ɵngcc0.ɵsetClassMetadata(TimelineWeekViewComponent, [{
        type: Component,
        args: [{
                changeDetection: ChangeDetectionStrategy.OnPush,
                selector: 'kendo-scheduler-timeline-week-view',
                providers: [{
                        provide: SchedulerView,
                        // tslint:disable-next-line:no-forward-ref
                        useExisting: forwardRef(() => TimelineWeekViewComponent)
                    }],
                template: `
        <ng-template #content>
            <timeline-multi-day-view
                viewName="timeline-week"
                [name]="name"
                [numberOfDays]="7"
                [getStartDate]="getStartDate"
                [eventHeight]="viewEventHeight"
                [columnWidth]="viewColumnWidth"
                [currentTimeMarker]="viewCurrentTimeMarker"
                [showWorkHours]="shouldShowWorkHours"
                [scrollTime]="viewScrollTime"
                [startTime]="viewStartTime"
                [endTime]="viewEndTime"
                [workDayStart]="viewWorkDayStart"
                [workDayEnd]="viewWorkDayEnd"
                [workWeekStart]="viewWorkWeekStart"
                [workWeekEnd]="viewWorkWeekEnd"
                [slotDuration]="viewSlotDuration"
                [slotDivisions]="viewSlotDivisions"
                [slotClass]="viewSlotClass"
                [eventClass]="viewEventClass"
                [eventStyles]="viewEventStyles"
                [еventTemplate]="eventTemplate?.templateRef"
                [groupHeaderTemplate]="groupHeaderTemplate?.templateRef"
                [timeSlotTemplate]="timeSlotTemplate?.templateRef"
                [dateHeaderTemplate]="dateHeaderTemplate?.templateRef"
                [selectedDateFormat]="selectedDateFormat"
                [selectedShortDateFormat]="selectedShortDateFormat">
            </timeline-multi-day-view>
            <div viewFooter kendoWorkHoursFooter [showWorkHours]="shouldShowWorkHours" (itemClick)="showWorkHours = !shouldShowWorkHours"></div>
        </ng-template>
    `
            }]
    }], function () { return [{ type: ɵngcc3.IntlService }, { type: ɵngcc2.LocalizationService }, { type: ɵngcc0.ChangeDetectorRef }, { type: ViewContextService }, { type: ViewStateService }]; }, { selectedDateFormat: [{
            type: Input
        }], selectedShortDateFormat: [{
            type: Input
        }] }); })();

/**
 * The component for rendering the **Month** timeline view.
 */
class TimelineMonthViewComponent extends TimelineBase {
    constructor(localization, changeDetector, viewContext, viewState) {
        super(localization, changeDetector, viewContext, viewState);
        /**
         * The long-date format for displaying the
         * selected date in the Scheduler toolbar.
         * Defaults to `{0:Y}`
         * ([more information]({% slug parsingandformatting_intl %}#toc-date-formatting)).
         */
        this.selectedDateFormat = '{0:Y}';
        /**
         * The short-date format for displaying the
         * selected date in the Scheduler toolbar.
         * Defaults to `{0:y}`
         * ([more information]({% slug parsingandformatting_intl %}#toc-date-formatting)).
         */
        this.selectedShortDateFormat = '{0:y}';
        /**
         * The invariant name for this view (`timelineMonth`).
         */
        this.name = 'timelineMonth';
        /**
         * @hidden
         */
        this.getStartDate = (selectedDate) => {
            return firstDayOfMonth(getDate(selectedDate));
        };
        /**
         * @hidden
         */
        this.getEndDate = (selectedDate) => {
            return addMonths(this.getStartDate(selectedDate), 1);
        };
        /**
         * @hidden
         */
        this.getNextDate = (date, count) => {
            return addMonths(date, count);
        };
    }
    /**
     * @hidden
     */
    get title() {
        return this.localization.get('timelineMonthViewTitle');
    }
}
TimelineMonthViewComponent.ɵfac = function TimelineMonthViewComponent_Factory(t) { return new (t || TimelineMonthViewComponent)(ɵngcc0.ɵɵdirectiveInject(ɵngcc2.LocalizationService), ɵngcc0.ɵɵdirectiveInject(ɵngcc0.ChangeDetectorRef), ɵngcc0.ɵɵdirectiveInject(ViewContextService), ɵngcc0.ɵɵdirectiveInject(ViewStateService)); };
TimelineMonthViewComponent.ɵcmp = ɵngcc0.ɵɵdefineComponent({ type: TimelineMonthViewComponent, selectors: [["kendo-scheduler-timeline-month-view"]], inputs: { selectedDateFormat: "selectedDateFormat", selectedShortDateFormat: "selectedShortDateFormat" }, features: [ɵngcc0.ɵɵProvidersFeature([{
                provide: SchedulerView,
                // tslint:disable-next-line:no-forward-ref
                useExisting: forwardRef(() => TimelineMonthViewComponent)
            }]), ɵngcc0.ɵɵInheritDefinitionFeature], decls: 2, vars: 0, consts: [["content", ""], ["viewName", "timeline-month", 3, "name", "getNextDate", "getStartDate", "getEndDate", "eventHeight", "columnWidth", "currentTimeMarker", "showWorkHours", "scrollTime", "startTime", "endTime", "workDayStart", "workDayEnd", "workWeekStart", "workWeekEnd", "slotDuration", "slotDivisions", "slotClass", "eventClass", "eventStyles", "\u0435ventTemplate", "groupHeaderTemplate", "timeSlotTemplate", "dateHeaderTemplate", "selectedDateFormat", "selectedShortDateFormat"], ["viewFooter", "", "kendoWorkHoursFooter", "", 3, "showWorkHours", "itemClick"]], template: function TimelineMonthViewComponent_Template(rf, ctx) { if (rf & 1) {
        ɵngcc0.ɵɵtemplate(0, TimelineMonthViewComponent_ng_template_0_Template, 2, 27, "ng-template", null, 0, ɵngcc0.ɵɵtemplateRefExtractor);
    } }, directives: [TimelineMultiDayViewComponent,
        ViewFooterComponent,
        WorkHoursFooterDirective], encapsulation: 2, changeDetection: 0 });
/** @nocollapse */
TimelineMonthViewComponent.ctorParameters = () => [
    { type: LocalizationService },
    { type: ChangeDetectorRef },
    { type: ViewContextService },
    { type: ViewStateService }
];
TimelineMonthViewComponent.propDecorators = {
    selectedDateFormat: [{ type: Input }],
    selectedShortDateFormat: [{ type: Input }]
};
/*@__PURE__*/ (function () { ɵngcc0.ɵsetClassMetadata(TimelineMonthViewComponent, [{
        type: Component,
        args: [{
                changeDetection: ChangeDetectionStrategy.OnPush,
                selector: 'kendo-scheduler-timeline-month-view',
                providers: [{
                        provide: SchedulerView,
                        // tslint:disable-next-line:no-forward-ref
                        useExisting: forwardRef(() => TimelineMonthViewComponent)
                    }],
                template: `
        <ng-template #content>
            <timeline-multi-day-view
                viewName="timeline-month"
                [name]="name"
                [getNextDate]="getNextDate"
                [getStartDate]="getStartDate"
                [getEndDate]="getEndDate"
                [eventHeight]="viewEventHeight"
                [columnWidth]="viewColumnWidth"
                [currentTimeMarker]="viewCurrentTimeMarker"
                [showWorkHours]="shouldShowWorkHours"
                [scrollTime]="viewScrollTime"
                [startTime]="viewStartTime"
                [endTime]="viewEndTime"
                [workDayStart]="viewWorkDayStart"
                [workDayEnd]="viewWorkDayEnd"
                [workWeekStart]="viewWorkWeekStart"
                [workWeekEnd]="viewWorkWeekEnd"
                [slotDuration]="viewSlotDuration"
                [slotDivisions]="viewSlotDivisions"
                [slotClass]="viewSlotClass"
                [eventClass]="viewEventClass"
                [eventStyles]="viewEventStyles"
                [еventTemplate]="eventTemplate?.templateRef"
                [groupHeaderTemplate]="groupHeaderTemplate?.templateRef"
                [timeSlotTemplate]="timeSlotTemplate?.templateRef"
                [dateHeaderTemplate]="dateHeaderTemplate?.templateRef"
                [selectedDateFormat]="selectedDateFormat"
                [selectedShortDateFormat]="selectedShortDateFormat">
            </timeline-multi-day-view>
            <div viewFooter kendoWorkHoursFooter [showWorkHours]="shouldShowWorkHours" (itemClick)="showWorkHours = !shouldShowWorkHours"></div>
        </ng-template>
    `
            }]
    }], function () { return [{ type: ɵngcc2.LocalizationService }, { type: ɵngcc0.ChangeDetectorRef }, { type: ViewContextService }, { type: ViewStateService }]; }, { selectedDateFormat: [{
            type: Input
        }], selectedShortDateFormat: [{
            type: Input
        }] }); })();

const PUBLIC_DIRECTIVES$1 = [
    TimelineViewComponent,
    TimelineWeekViewComponent,
    TimelineMonthViewComponent
];
/**
 * @hidden
 */
class TimelineViewModule {
}
TimelineViewModule.ɵmod = ɵngcc0.ɵɵdefineNgModule({ type: TimelineViewModule });
TimelineViewModule.ɵinj = ɵngcc0.ɵɵdefineInjector({ factory: function TimelineViewModule_Factory(t) { return new (t || TimelineViewModule)(); }, imports: [[
            DayTimeModule,
            ViewsSharedModule
        ]] });
(function () { (typeof ngJitMode === "undefined" || ngJitMode) && ɵngcc0.ɵɵsetNgModuleScope(TimelineViewModule, { declarations: [TimelineViewComponent,
        TimelineWeekViewComponent,
        TimelineMonthViewComponent,
        TimelineMultiDayViewComponent], imports: [DayTimeModule,
        ViewsSharedModule], exports: [TimelineViewComponent,
        TimelineWeekViewComponent,
        TimelineMonthViewComponent] }); })();
/*@__PURE__*/ (function () { ɵngcc0.ɵsetClassMetadata(TimelineViewModule, [{
        type: NgModule,
        args: [{
                imports: [
                    DayTimeModule,
                    ViewsSharedModule
                ],
                exports: [
                    PUBLIC_DIRECTIVES$1
                ],
                declarations: [
                    ...PUBLIC_DIRECTIVES$1,
                    TimelineMultiDayViewComponent
                ]
            }]
    }], null, null); })();

const isRecurrenceMaster$1 = (ev) => !!(ev.id && ev.recurrenceRule);
/**
 * @hidden
 */
class LocalEditService {
    constructor(scheduler, localDataChangesService) {
        this.scheduler = scheduler;
        this.localDataChangesService = localDataChangesService;
    }
    get fields() {
        return this.scheduler.modelFields;
    }
    get hasLocalData() {
        return isPresent(this.localDataChangesService.data);
    }
    get data() {
        if (this.hasLocalData) {
            return this.localDataChangesService.data;
        }
        return this.scheduler.events;
    }
    create(item) {
        const idField = this.fields.id;
        const id = getField(item, idField);
        if (!isPresent(id)) {
            setField(item, idField, this.nextId());
        }
        this.data.push(item);
        this.dataChanged();
    }
    createException(item, value) {
        const exception = this.buildException(value);
        this.removeOccurrenceInternal(item);
        this.create(exception);
    }
    update(item, value) {
        assignValues(item, value);
        this.dataChanged();
    }
    remove(item) {
        const idField = this.fields.id;
        const itemId = getField(item, idField);
        const data = this.data;
        for (let idx = 0; idx < data.length; idx++) {
            if (itemId === getField(data[idx], idField)) {
                data.splice(idx, 1);
                break;
            }
        }
        this.dataChanged();
    }
    removeSeries(item) {
        const event = readEvent(item, this.fields);
        const isHead = isRecurrenceMaster$1(event);
        this.removeItemAndExceptions(isHead ? event.id : event.recurrenceId);
        this.dataChanged();
    }
    removeOccurrence(item) {
        this.removeOccurrenceInternal(item);
        this.dataChanged();
    }
    findRecurrenceMaster(item) {
        const fields = this.scheduler.modelFields;
        const event = readEvent(item, fields);
        const headId = isRecurrenceMaster$1(event) ? event.id : event.recurrenceId;
        return this.data.find((dataItem) => getField(dataItem, fields.id) === headId);
    }
    isRecurring(event) {
        return isRecurring(event, this.scheduler.modelFields);
    }
    isException(event) {
        return isException(event, this.scheduler.modelFields);
    }
    nextId() {
        return guid();
    }
    buildException(item) {
        const fields = this.fields;
        const head = this.findRecurrenceMaster(item);
        if (!head) {
            if (isDevMode()) {
                throw new Error('Unable to find recurrence head for event. Please check that recurrenceId is set and refers to an existing event.');
            }
            return;
        }
        const exception = clone(item);
        setField(exception, fields.id, this.nextId());
        setField(exception, fields.recurrenceId, getField(head, fields.id));
        setField(exception, fields.recurrenceRule, null);
        return exception;
    }
    removeItemAndExceptions(itemId) {
        const data = this.data;
        const fields = this.scheduler.modelFields;
        for (let idx = data.length - 1; idx >= 0; idx--) {
            if (itemId === getField(data[idx], fields.recurrenceId) || itemId === getField(data[idx], fields.id)) {
                data.splice(idx, 1);
            }
        }
    }
    removeOccurrenceInternal(item) {
        const fields = this.fields;
        const head = this.findRecurrenceMaster(item);
        const exceptionDate = getField(item, fields.start);
        const currentExceptions = getField(head, fields.recurrenceExceptions) || [];
        setField(head, fields.recurrenceExceptions, [...currentExceptions, exceptionDate]);
    }
    dataChanged() {
        if (this.hasLocalData) {
            this.localDataChangesService.changes.emit();
        }
    }
}

/**
 * @hidden
 */
const markAllAsTouched = (control) => {
    control.markAsTouched();
    if (control.hasOwnProperty('controls')) {
        let controls = control.controls;
        for (let inner in controls) {
            if (controls.hasOwnProperty(inner)) {
                markAllAsTouched(controls[inner]);
            }
        }
    }
};
/**
 * @hidden
 */
function diff(obj1, obj2, fields) {
    for (let idx = 0; idx < fields.length; idx++) {
        const field = fields[idx];
        if (!areEqual(getField(obj1, field), getField(obj2, field))) {
            return true;
        }
    }
    return false;
}
/**
 * @hidden
 */
function areEqual(value1, value2) {
    if (value1 && value1.getTime && value2 && value2.getTime) {
        return value1.getTime() === value2.getTime();
    }
    else if (Array.isArray(value1)) {
        if (!Array.isArray(value2) || value1.length !== value2.length) {
            return false;
        }
        for (let idx = 0; idx < value1.length; idx++) {
            if (value1[idx] !== value2[idx]) {
                return false;
            }
        }
        return true;
    }
    // tslint:disable-next-line:triple-equals
    return value1 == value2;
}
const DATE_ACCESSORS = ['getFullYear', 'getMonth', 'getDate', 'getHours', 'getMinutes', 'getSeconds', 'getMilliseconds'];
/**
 * @hidden
 */
function seriesDate(head, occurrence, current, field) {
    const values = [];
    const headDate = getField(head, field);
    const occurrenceDate = getField(occurrence, field);
    const currentDate = getField(current, field);
    DATE_ACCESSORS.forEach(accessor => {
        values.push(occurrenceDate[accessor]() === currentDate[accessor]() ? headDate[accessor]() : currentDate[accessor]());
    });
    return new Date(...values);
}

/**
 * @hidden
 */
class EditingDirectiveBase {
    constructor(scheduler, localDataChangesService, dialogsService) {
        this.scheduler = scheduler;
        this.localDataChangesService = localDataChangesService;
        this.dialogsService = dialogsService;
        /**
         * Fires before the editing directive renders the **Add** dialog.
         */
        this.add = new EventEmitter();
        /**
         * Fires before the editing directive renders the **Edit** dialog.
         */
        this.edit = new EventEmitter();
        this.defaultTitle = 'No title';
        this.defaultEditService = this.createDefaultService();
        this.scheduler.editable = true;
    }
    /**
     * The edit service that will handle the editing operations.
     */
    set editService(value) {
        this.userEditService = value;
    }
    get editService() {
        return this.userEditService || this.defaultEditService;
    }
    /**
     * @hidden
     */
    ngOnInit() {
        this.subscriptions = merge(this.scheduler.slotDblClick, this.scheduler.create).subscribe(this.addHandler.bind(this));
        this.subscriptions.add(this.scheduler.removeConfirmed.subscribe(this.removeHandler.bind(this)));
        this.subscriptions.add(this.scheduler.cancel.subscribe(this.cancelHandler.bind(this)));
        this.subscriptions.add(this.scheduler.resizeEndConfirmed.subscribe(this.resizeEndHandler.bind(this)));
        this.subscriptions.add(this.scheduler.dragEndConfirmed.subscribe(this.dragEndHandler.bind(this)));
    }
    /**
     * @hidden
     */
    ngOnDestroy() {
        this.subscriptions.unsubscribe();
    }
    createDefaultService() {
        return new LocalEditService(this.scheduler, this.localDataChangesService);
    }
    addHandler(args) {
        this.closeEditor();
        if (!this.isEnabled('add')) {
            return;
        }
        const fields = this.scheduler.modelFields;
        const dataItem = {};
        setField(dataItem, fields.start, args.start);
        setField(dataItem, fields.end, args.end);
        setField(dataItem, fields.isAllDay, args.isAllDay);
        setField(dataItem, fields.title, args.title);
        const resources = groupResources(this.scheduler.group, this.scheduler.resources);
        const slotResources = args.resources;
        for (let idx = 0; idx < resources.length; idx++) {
            const resource = resources[idx];
            const value = getField(slotResources[idx], resource.valueField);
            setField(dataItem, resource.field, resource.multiple ? [value] : value);
        }
        const addArgs = new AddEvent(this.scheduler, { dataItem });
        this.add.emit(addArgs);
        if (!addArgs.isDefaultPrevented()) {
            this.scheduler.addEvent(this.createModel({
                action: 'add',
                isNew: true,
                dataItem
            }));
        }
    }
    removeHandler({ dataItem }) {
        if (!this.isEnabled('remove')) {
            return;
        }
        if (this.editService.isRecurring(dataItem)) {
            this.dialogsService.openRecurringConfirmationDialog(1 /* Remove */)
                .subscribe((editMode) => {
                if (editMode !== undefined) {
                    this.handleRemove(dataItem, editMode);
                }
            });
        }
        else {
            this.dialogsService.openRemoveConfirmationDialog()
                .subscribe((shouldRemove) => {
                if (shouldRemove) {
                    this.handleRemove(dataItem, 0 /* Event */);
                }
            });
        }
    }
    cancelHandler() {
        this.closeEditor();
    }
    closeEditor() {
        this.scheduler.closeEvent();
    }
    handleUpdate(item, value, mode) {
        const svc = this.editService;
        if (mode === 1 /* Occurrence */) {
            svc.isException(item) ?
                svc.update(item, value) :
                svc.createException(item, value);
        }
        else {
            // Item is not recurring or we're editing the entire series
            svc.update(item, value);
        }
    }
    handleRemove(item, mode) {
        const svc = this.editService;
        if (mode === 2 /* Series */) {
            svc.removeSeries(item);
        }
        else if (mode === 1 /* Occurrence */) {
            svc.isException(item) ?
                svc.remove(item) :
                svc.removeOccurrence(item);
        }
        else {
            // Item is not recurring
            svc.remove(item);
        }
    }
    resizeEndHandler({ event, start, end }) {
        if (areEqual(start, event.start) && areEqual(end, event.end)) {
            return;
        }
        const dataItem = event.dataItem;
        const fields = this.scheduler.modelFields;
        let value = {};
        setField(value, fields.start, start);
        setField(value, fields.end, end);
        if (this.editService.isRecurring(dataItem)) {
            this.dialogsService.openRecurringConfirmationDialog(0 /* Edit */)
                .subscribe((result) => {
                let target = dataItem;
                if (result === 2 /* Series */) {
                    target = this.editService.findRecurrenceMaster(dataItem);
                    setField(value, fields.start, seriesDate(target, dataItem, value, fields.start));
                    setField(value, fields.end, seriesDate(target, dataItem, value, fields.end));
                }
                else if (result !== undefined) {
                    value = assignValues(clone(dataItem), value);
                }
                this.handleUpdate(target, value, result);
            });
        }
        else {
            this.editService.update(dataItem, value);
        }
    }
    dragEndHandler({ event: { dataItem }, start, end, resources, isAllDay }) {
        const modelFields = this.scheduler.modelFields;
        const resourceFields = groupResources(this.scheduler.group, this.scheduler.resources).map(r => r.field);
        const fields = [modelFields.start, modelFields.end, modelFields.isAllDay].concat(resourceFields);
        let value = clone(resources);
        setField(value, modelFields.start, start);
        setField(value, modelFields.end, end);
        setField(value, modelFields.isAllDay, isAllDay);
        if (!diff(dataItem, value, fields)) {
            return;
        }
        if (this.editService.isRecurring(dataItem)) {
            this.dialogsService.openRecurringConfirmationDialog(0 /* Edit */)
                .subscribe((result) => {
                let target = dataItem;
                if (result === 2 /* Series */) {
                    target = this.editService.findRecurrenceMaster(dataItem);
                    setField(value, modelFields.start, seriesDate(target, dataItem, value, modelFields.start));
                    setField(value, modelFields.end, seriesDate(target, dataItem, value, modelFields.end));
                }
                else if (result !== undefined) {
                    value = assignValues(clone(dataItem), value);
                }
                this.handleUpdate(target, value, result);
            });
        }
        else {
            this.editService.update(dataItem, value);
        }
    }
    isEnabled(action) {
        const editable = this.scheduler.editable;
        return editable && editable[action] !== false;
    }
}
EditingDirectiveBase.ɵfac = function EditingDirectiveBase_Factory(t) { ɵngcc0.ɵɵinvalidFactory(); };
EditingDirectiveBase.ɵdir = ɵngcc0.ɵɵdefineDirective({ type: EditingDirectiveBase, inputs: { editService: "editService" }, outputs: { add: "add", edit: "edit" } });
EditingDirectiveBase.propDecorators = {
    add: [{ type: Output }],
    edit: [{ type: Output }],
    editService: [{ type: Input }]
};


/**
 * A directive which encapsulates the editing operations when the Scheduler
 * uses the [Reactive Angular Forms]({{ site.data.urls.angular['reactiveforms'] }}).
 */
class ReactiveEditingDirective extends EditingDirectiveBase {
    constructor(scheduler, localDataChangesService, dialogsService) {
        super(scheduler, localDataChangesService, dialogsService);
        this.scheduler = scheduler;
        this.localDataChangesService = localDataChangesService;
        this.dialogsService = dialogsService;
    }
    ngOnInit() {
        super.ngOnInit();
        this.subscriptions.add(this.scheduler.eventDblClick.subscribe(this.editHandler.bind(this)));
        this.subscriptions.add(this.scheduler.save.subscribe(this.saveHandler.bind(this)));
    }
    editHandler(args) {
        if (!this.isEnabled('edit')) {
            return;
        }
        const editArgs = new EditEvent(this.scheduler, { dataItem: args.event.dataItem, event: args.event });
        this.edit.emit(editArgs);
        if (editArgs.isDefaultPrevented()) {
            return;
        }
        let dataItem = args.event.dataItem;
        if (this.editService.isRecurring(dataItem)) {
            this.dialogsService.openRecurringConfirmationDialog(0 /* Edit */)
                .pipe(filter(mode => mode !== undefined))
                .subscribe((mode) => {
                if (mode === 2 /* Series */) {
                    dataItem = this.editService.findRecurrenceMaster(dataItem);
                }
                const group = this.createModel({
                    action: 'edit',
                    isNew: false,
                    mode,
                    dataItem
                });
                this.scheduler.editEvent(dataItem, { group, mode });
            });
        }
        else {
            const group = this.createModel({
                action: 'edit',
                isNew: false,
                mode: 0 /* Event */,
                dataItem
            });
            this.scheduler.editEvent(dataItem, { group });
        }
    }
    saveHandler(args) {
        if (this.isFormValid(args)) {
            const formValue = args.formGroup.value;
            if (args.isNew) {
                this.editService.create(formValue);
            }
            else {
                this.handleUpdate(args.dataItem, formValue, args.mode);
            }
        }
        this.closeEditor();
    }
    createModel(args) {
        // Alias `event` for backwards compatibility.
        args.event = args.dataItem;
        return this.createFormGroup(args);
    }
    isFormValid({ formGroup, isNew }) {
        if (formGroup.valid) {
            return true;
        }
        if (!formGroup.dirty && !isNew) {
            return false;
        }
        markAllAsTouched(formGroup);
        return false;
    }
}
ReactiveEditingDirective.ɵfac = function ReactiveEditingDirective_Factory(t) { return new (t || ReactiveEditingDirective)(ɵngcc0.ɵɵdirectiveInject(SchedulerComponent), ɵngcc0.ɵɵdirectiveInject(LocalDataChangesService), ɵngcc0.ɵɵdirectiveInject(DialogsService)); };
ReactiveEditingDirective.ɵdir = ɵngcc0.ɵɵdefineDirective({ type: ReactiveEditingDirective, selectors: [["", "kendoSchedulerReactiveEditing", ""]], inputs: { createFormGroup: ["kendoSchedulerReactiveEditing", "createFormGroup"] }, features: [ɵngcc0.ɵɵInheritDefinitionFeature] });
/** @nocollapse */
ReactiveEditingDirective.ctorParameters = () => [
    { type: SchedulerComponent },
    { type: LocalDataChangesService },
    { type: DialogsService }
];
ReactiveEditingDirective.propDecorators = {
    createFormGroup: [{ type: Input, args: ['kendoSchedulerReactiveEditing',] }]
};
/*@__PURE__*/ (function () { ɵngcc0.ɵsetClassMetadata(ReactiveEditingDirective, [{
        type: Directive,
        args: [{
                selector: '[kendoSchedulerReactiveEditing]'
            }]
    }], function () { return [{ type: SchedulerComponent }, { type: LocalDataChangesService }, { type: DialogsService }]; }, { createFormGroup: [{
            type: Input,
            args: ['kendoSchedulerReactiveEditing']
        }] }); })();

/**
 * @hidden
 */
class ResourceEditorBase {
    constructor() {
        this.valueChange = new EventEmitter();
        this.getField = getField;
        this.onTouchedCallback = (_) => { };
        this.onChangeCallback = (_) => { };
    }
    /**
     * @hidden
     */
    writeValue(newValue) {
        this.resourceValue = newValue;
    }
    getResourceStyle(dataItem) {
        return {
            'background-color': getField(dataItem, this.resource.colorField),
            'margin-right': isPresent(getField(dataItem, this.resource.valueField)) ? '8px' : '4px'
        };
    }
    onResourceValueChange(newValue) {
        this.resourceValue = newValue;
        this.emitChange(this.resourceValue);
    }
    /**
     * @hidden
     */
    registerOnChange(fn) {
        this.onChangeCallback = fn;
    }
    /**
     * @hidden
     */
    registerOnTouched(fn) {
        this.onTouchedCallback = fn;
    }
    emitChange(value) {
        this.onChangeCallback(value);
        this.valueChange.emit(value);
    }
}
ResourceEditorBase.ɵfac = function ResourceEditorBase_Factory(t) { return new (t || ResourceEditorBase)(); };
ResourceEditorBase.ɵdir = ɵngcc0.ɵɵdefineDirective({ type: ResourceEditorBase, inputs: { resource: "resource" }, outputs: { valueChange: "valueChange" } });
ResourceEditorBase.propDecorators = {
    resource: [{ type: Input }],
    valueChange: [{ type: Output }]
};


/* tslint:disable: no-use-before-declare */
/* tslint:disable: no-forward-ref */
/**
 * @hidden
 */
const MULTIPLE_RESOURCE_VALUE_ACCESSOR = {
    multi: true,
    provide: NG_VALUE_ACCESSOR,
    useExisting: forwardRef(() => MultipleResourceEditorComponent)
};
/**
 * @hidden
 */
class MultipleResourceEditorComponent extends ResourceEditorBase {
    getTagStyle(dataItem) {
        return {
            'background-color': dataItem[this.resource.colorField]
        };
    }
    focus() {
        this.resourceMultiSelect.focus();
    }
}
MultipleResourceEditorComponent.ɵfac = function MultipleResourceEditorComponent_Factory(t) { return ɵMultipleResourceEditorComponent_BaseFactory(t || MultipleResourceEditorComponent); };
MultipleResourceEditorComponent.ɵcmp = ɵngcc0.ɵɵdefineComponent({ type: MultipleResourceEditorComponent, selectors: [["kendo-multiple-resource-editor"]], viewQuery: function MultipleResourceEditorComponent_Query(rf, ctx) { if (rf & 1) {
        ɵngcc0.ɵɵviewQuery(_c191, true);
    } if (rf & 2) {
        var _t;
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.resourceMultiSelect = _t.first);
    } }, features: [ɵngcc0.ɵɵProvidersFeature([
            MULTIPLE_RESOURCE_VALUE_ACCESSOR
        ]), ɵngcc0.ɵɵInheritDefinitionFeature], decls: 4, vars: 5, consts: [[3, "data", "textField", "valueField", "valuePrimitive", "value", "valueChange"], ["resourceMultiSelect", ""], ["kendoDropDownListItemTemplate", ""], ["kendoMultiSelectTagTemplate", ""], ["class", "k-scheduler-mark", 3, "ngStyle", 4, "ngIf"], [1, "k-scheduler-mark", 3, "ngStyle"]], template: function MultipleResourceEditorComponent_Template(rf, ctx) { if (rf & 1) {
        ɵngcc0.ɵɵelementStart(0, "kendo-multiselect", 0, 1);
        ɵngcc0.ɵɵlistener("valueChange", function MultipleResourceEditorComponent_Template_kendo_multiselect_valueChange_0_listener($event) { return ctx.onResourceValueChange($event); });
        ɵngcc0.ɵɵtemplate(2, MultipleResourceEditorComponent_ng_template_2_Template, 2, 2, "ng-template", 2);
        ɵngcc0.ɵɵtemplate(3, MultipleResourceEditorComponent_ng_template_3_Template, 2, 2, "ng-template", 3);
        ɵngcc0.ɵɵelementEnd();
    } if (rf & 2) {
        ɵngcc0.ɵɵproperty("data", ctx.resource.data)("textField", ctx.resource.textField)("valueField", ctx.resource.valueField)("valuePrimitive", true)("value", ctx.resourceValue);
    } }, directives: [ɵngcc8.MultiSelectComponent, ɵngcc8.ItemTemplateDirective, ɵngcc8.TagTemplateDirective, ɵngcc4.NgIf, ɵngcc4.NgStyle], encapsulation: 2 });
MultipleResourceEditorComponent.propDecorators = {
    resourceMultiSelect: [{ type: ViewChild, args: ['resourceMultiSelect',] }]
};
const ɵMultipleResourceEditorComponent_BaseFactory = ɵngcc0.ɵɵgetInheritedFactory(MultipleResourceEditorComponent);
/*@__PURE__*/ (function () { ɵngcc0.ɵsetClassMetadata(MultipleResourceEditorComponent, [{
        type: Component,
        args: [{
                providers: [
                    MULTIPLE_RESOURCE_VALUE_ACCESSOR
                ],
                selector: 'kendo-multiple-resource-editor',
                template: `
        <kendo-multiselect
            #resourceMultiSelect
            [data]='resource.data'
            [textField]='resource.textField'
            [valueField]='resource.valueField'
            [valuePrimitive]='true'
            [value]='resourceValue'
            (valueChange)='onResourceValueChange($event)'
        >
            <ng-template kendoDropDownListItemTemplate let-dataItem>
                <span *ngIf="resource.colorField" class="k-scheduler-mark"
                [ngStyle]="getResourceStyle(dataItem)"></span>
                {{ getField(dataItem, resource.textField) }}
            </ng-template>
            <ng-template kendoMultiSelectTagTemplate let-dataItem>
                <span *ngIf="resource.colorField" class="k-scheduler-mark"
                [ngStyle]="getTagStyle(dataItem)"></span>
                {{ getField(dataItem, resource.textField) }}
            </ng-template>
        </kendo-multiselect>
    `
            }]
    }], null, { resourceMultiSelect: [{
            type: ViewChild,
            args: ['resourceMultiSelect']
        }] }); })();

/* tslint:disable: no-use-before-declare */
/* tslint:disable: no-forward-ref */
/**
 * @hidden
 */
const SINGLE_RESOURCE_VALUE_ACCESSOR = {
    multi: true,
    provide: NG_VALUE_ACCESSOR,
    useExisting: forwardRef(() => SingleResourceEditorComponent)
};
/**
 * @hidden
 */
class SingleResourceEditorComponent extends ResourceEditorBase {
    focus() {
        this.resourceDropDown.focus();
    }
}
SingleResourceEditorComponent.ɵfac = function SingleResourceEditorComponent_Factory(t) { return ɵSingleResourceEditorComponent_BaseFactory(t || SingleResourceEditorComponent); };
SingleResourceEditorComponent.ɵcmp = ɵngcc0.ɵɵdefineComponent({ type: SingleResourceEditorComponent, selectors: [["kendo-single-resource-editor"]], viewQuery: function SingleResourceEditorComponent_Query(rf, ctx) { if (rf & 1) {
        ɵngcc0.ɵɵviewQuery(_c192, true);
    } if (rf & 2) {
        var _t;
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.resourceDropDown = _t.first);
    } }, features: [ɵngcc0.ɵɵProvidersFeature([
            SINGLE_RESOURCE_VALUE_ACCESSOR
        ]), ɵngcc0.ɵɵInheritDefinitionFeature], decls: 3, vars: 5, consts: [[3, "data", "textField", "valueField", "valuePrimitive", "value", "valueChange"], ["resourceDropDown", ""], ["kendoDropDownListItemTemplate", ""], ["class", "k-scheduler-mark", 3, "ngStyle", 4, "ngIf"], [1, "k-scheduler-mark", 3, "ngStyle"]], template: function SingleResourceEditorComponent_Template(rf, ctx) { if (rf & 1) {
        ɵngcc0.ɵɵelementStart(0, "kendo-dropdownlist", 0, 1);
        ɵngcc0.ɵɵlistener("valueChange", function SingleResourceEditorComponent_Template_kendo_dropdownlist_valueChange_0_listener($event) { return ctx.onResourceValueChange($event); });
        ɵngcc0.ɵɵtemplate(2, SingleResourceEditorComponent_ng_template_2_Template, 2, 2, "ng-template", 2);
        ɵngcc0.ɵɵelementEnd();
    } if (rf & 2) {
        ɵngcc0.ɵɵproperty("data", ctx.resource.data)("textField", ctx.resource.textField)("valueField", ctx.resource.valueField)("valuePrimitive", true)("value", ctx.resourceValue);
    } }, directives: [ɵngcc8.DropDownListComponent, ɵngcc8.ItemTemplateDirective, ɵngcc4.NgIf, ɵngcc4.NgStyle], encapsulation: 2 });
SingleResourceEditorComponent.propDecorators = {
    resourceDropDown: [{ type: ViewChild, args: ['resourceDropDown',] }]
};
const ɵSingleResourceEditorComponent_BaseFactory = ɵngcc0.ɵɵgetInheritedFactory(SingleResourceEditorComponent);
/*@__PURE__*/ (function () { ɵngcc0.ɵsetClassMetadata(SingleResourceEditorComponent, [{
        type: Component,
        args: [{
                providers: [
                    SINGLE_RESOURCE_VALUE_ACCESSOR
                ],
                selector: 'kendo-single-resource-editor',
                template: `
        <kendo-dropdownlist
            #resourceDropDown
            [data]='resource.data'
            [textField]='resource.textField'
            [valueField]='resource.valueField'
            [valuePrimitive]='true'
            [value]='resourceValue'
            (valueChange)='onResourceValueChange($event)'
        >
            <ng-template kendoDropDownListItemTemplate let-dataItem>
                <span *ngIf="resource.colorField" class="k-scheduler-mark"
                [ngStyle]="getResourceStyle(dataItem)"></span>
                {{ getField(dataItem, resource.textField) }}
            </ng-template>
        </kendo-dropdownlist>
    `
            }]
    }], null, { resourceDropDown: [{
            type: ViewChild,
            args: ['resourceDropDown']
        }] }); })();

// tslint:disable:no-bitwise
/**
 * @hidden
 */
var Modifiers;
(function (Modifiers) {
    Modifiers[Modifiers["None"] = 0] = "None";
    Modifiers[Modifiers["AltKey"] = 1] = "AltKey";
    Modifiers[Modifiers["CtrlKey"] = 2] = "CtrlKey";
    Modifiers[Modifiers["ShiftKey"] = 4] = "ShiftKey";
    Modifiers[Modifiers["MetaKey"] = 8] = "MetaKey";
})(Modifiers || (Modifiers = {}));
/**
 * @hidden
 */
function withModifiers(e, modifiers) {
    return e.altKey === ((modifiers & Modifiers.AltKey) === Modifiers.AltKey) &&
        e.ctrlKey === ((modifiers & Modifiers.CtrlKey) === Modifiers.CtrlKey) &&
        e.shiftKey === ((modifiers & Modifiers.ShiftKey) === Modifiers.ShiftKey) &&
        e.metaKey === ((modifiers & Modifiers.MetaKey) === Modifiers.MetaKey);
}
/**
 * @hidden
 */
function noModifiers(e) {
    return withModifiers(e, Modifiers.None);
}

/**
 * @hidden
 */
class EditDialogComponent {
    constructor(ngZone, editService, localization, changeDetector, element, focusService) {
        this.ngZone = ngZone;
        this.editService = editService;
        this.localization = localization;
        this.changeDetector = changeDetector;
        this.element = element;
        this.focusService = focusService;
        this.resources = [];
        this.timezone = 'Etc/UTC';
        this.setTimeZone = false;
        this.setSeparateStartEndTimeZones = false;
        this.subs = this.editService.changed.subscribe(() => {
            this.ngZone.run(() => { this.onChange(); });
        });
        this.subs.add(fromEvent(this.element.nativeElement, 'keydown')
            .pipe(filter(() => this.isActive))
            .subscribe((e) => {
            if (e.keyCode === Keys.Escape) {
                this.reset();
            }
            if (e.keyCode === Keys.Enter && (withModifiers(e, Modifiers.CtrlKey) || withModifiers(e, Modifiers.MetaKey))) {
                this.onSave(e);
            }
            e.stopPropagation();
        }));
    }
    get autoFocusedElement() {
        if (this.editTemplate) {
            return this.editTemplate.autoFocusedElement;
        }
        return '.k-edit-field input';
    }
    get isEditingSeries() {
        return this.editMode === 2 /* Series */ && Boolean(this.formGroup.get(this.fields.recurrenceRule));
    }
    get eventTimezone() {
        return formValueOrDefault(this.formGroup, this.fields.startTimezone, this.timezone);
    }
    get endTimezone() {
        return formValueOrDefault(this.formGroup, this.fields.endTimezone, this.eventTimezone);
    }
    onChange() {
        this.changeDetector.markForCheck();
        if (this.editService.hasNewEvent) {
            this.editMode = 2 /* Series */;
            this.formGroup = this.editService.context.formGroup;
            this.isNew = true;
            this.applyLocalTimezone();
        }
        else if (this.editService.isEditing()) {
            const { dataItem, mode } = this.editService.context;
            this.formGroup = this.editService.context.formGroup;
            this.isNew = false;
            this.editedEvent = dataItem;
            this.editMode = isPresent(mode) ? mode : 2 /* Series */;
            this.applyLocalTimezone();
        }
        else {
            this.reset();
            return;
        }
        if (!this.editTemplate) {
            this.addTimeZoneCheckboxesToFormGroup();
            this.subscribeToFormGroupChanges();
        }
        if (isPresent(this.formGroup)) {
            this.recurrenceStart = this.formGroup.get(this.fields.start).value;
        }
        this.isActive = true;
    }
    ngOnDestroy() {
        if (this.subs) {
            this.subs.unsubscribe();
        }
    }
    onCancel(e) {
        e.preventDefault();
        this.onClose();
        this.changeDetector.markForCheck();
    }
    onSave(e) {
        e.preventDefault();
        this.applyTimezone();
        this.editService.save();
        this.changeDetector.markForCheck();
    }
    onClose() {
        this.editService.endEdit();
        this.changeDetector.markForCheck();
        this.focusService.focus();
    }
    get hasAllDay() {
        return Boolean(this.formGroup.get(this.fields.isAllDay));
    }
    get hasStartTimeZone() {
        return Boolean(this.formGroup.get(this.fields.startTimezone));
    }
    get isStartTimeZoneVisible() {
        return this.formGroup && this.formGroup.get('startTimezoneCheckbox').value;
    }
    get hasEndTimeZone() {
        return Boolean(this.formGroup.get(this.fields.endTimezone));
    }
    get isEndTimeZoneVisible() {
        return this.formGroup && this.formGroup.get('endTimezoneCheckbox').value;
    }
    getFormValue(field) {
        if (field) {
            return this.formGroup.get(field);
        }
    }
    textFor(key) {
        return this.localization.get(key);
    }
    onResourceClick(resource) {
        const resourceEditors = resource.multiple ? this.multipleResourceEditors : this.singleResourceEditors;
        const currentEditor = resourceEditors.filter((editor) => editor.resource.field === resource.field).pop();
        if (currentEditor) {
            currentEditor.focus();
        }
    }
    reset() {
        this.isActive = false;
        this.setTimeZone = false;
        this.setSeparateStartEndTimeZones = false;
        this.removeTimeZoneCheckboxesFromFormGroup();
        this.focusService.focus();
    }
    addTimeZoneCheckboxesToFormGroup() {
        if (isPresent(this.formGroup)) {
            const startField = this.fields.startTimezone;
            this.formGroup.addControl('startTimezoneCheckbox', new FormControl(this.formGroup.contains(startField) &&
                this.formGroup.get(startField).value));
            const endField = this.fields.endTimezone;
            this.formGroup.addControl('endTimezoneCheckbox', new FormControl(this.formGroup.contains(endField) &&
                this.formGroup.get(endField).value));
        }
    }
    removeTimeZoneCheckboxesFromFormGroup() {
        if (isPresent(this.formGroup)) {
            this.formGroup.removeControl('startTimezoneCheckbox');
            this.formGroup.removeControl('endTimezoneCheckbox');
        }
    }
    subscribeToFormGroupChanges() {
        if (isPresent(this.formGroup)) {
            const fields = this.fields;
            this.formGroup.get('startTimezoneCheckbox').valueChanges.subscribe(isTrue => {
                if (!isTrue) {
                    this.formGroup.get(fields.startTimezone).setValue(null, { emitEvent: false });
                    this.formGroup.get(fields.endTimezone).setValue(null, { emitEvent: false });
                    this.formGroup.get('endTimezoneCheckbox').setValue(false, { emitEvent: false });
                }
            });
            this.formGroup.get('endTimezoneCheckbox').valueChanges.subscribe(isTrue => {
                if (!isTrue) {
                    this.formGroup.get(fields.endTimezone).setValue(null, { emitEvent: false });
                }
            });
            this.formGroup.get(fields.start).valueChanges.subscribe((newStart) => {
                this.recurrenceStart = newStart;
            });
        }
    }
    /**
     * Converts the event dates to "display dates" that look like the original date in its time zone.
     * The result does not represent the same moment in time and must be converted back to local dates.
     */
    applyLocalTimezone() {
        const fields = this.fields;
        const start = this.readDateAsLocal(fields.start, this.eventTimezone);
        const end = this.readDateAsLocal(fields.end, this.endTimezone);
        this.formGroup.get(fields.start).reset(start);
        this.formGroup.get(fields.end).reset(end);
    }
    /**
     * Converts the "display dates" used by the editors back to local dates that represent the true moment in time.
     */
    applyTimezone() {
        const fields = this.fields;
        const start = this.readDateWithTimezone(fields.start, this.eventTimezone);
        const end = this.readDateWithTimezone(fields.end, this.endTimezone);
        this.formGroup.get(fields.start).reset(start);
        this.formGroup.get(fields.end).reset(end);
    }
    readDateWithTimezone(field, timezone) {
        const value = this.formGroup.get(field).value;
        return ZonedDate.fromUTCDate(toUTCDateTime(value), timezone).toLocalDate();
    }
    readDateAsLocal(field, timezone) {
        const value = this.formGroup.get(field).value;
        return toLocalDate(ZonedDate.fromLocalDate(value, timezone).toUTCDate());
    }
}
EditDialogComponent.ɵfac = function EditDialogComponent_Factory(t) { return new (t || EditDialogComponent)(ɵngcc0.ɵɵdirectiveInject(ɵngcc0.NgZone), ɵngcc0.ɵɵdirectiveInject(EditService), ɵngcc0.ɵɵdirectiveInject(ɵngcc2.LocalizationService), ɵngcc0.ɵɵdirectiveInject(ɵngcc0.ChangeDetectorRef), ɵngcc0.ɵɵdirectiveInject(ɵngcc0.ElementRef), ɵngcc0.ɵɵdirectiveInject(FocusService)); };
EditDialogComponent.ɵcmp = ɵngcc0.ɵɵdefineComponent({ type: EditDialogComponent, selectors: [["kendo-scheduler-edit-dialog"]], viewQuery: function EditDialogComponent_Query(rf, ctx) { if (rf & 1) {
        ɵngcc0.ɵɵviewQuery(MultipleResourceEditorComponent, true);
        ɵngcc0.ɵɵviewQuery(SingleResourceEditorComponent, true);
    } if (rf & 2) {
        var _t;
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.multipleResourceEditors = _t);
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.singleResourceEditors = _t);
    } }, inputs: { resources: "resources", timezone: "timezone", fields: "fields", editTemplate: "editTemplate" }, decls: 1, vars: 1, consts: [["class", "k-scheduler-edit-dialog", 3, "minWidth", "title", "autoFocusedElement", "close", 4, "ngIf"], [1, "k-scheduler-edit-dialog", 3, "minWidth", "title", "autoFocusedElement", "close"], [4, "ngIf"], [1, "k-button", 3, "click"], [1, "k-button", "k-primary", 3, "disabled", "click"], [1, "k-scheduler-edit-form"], [1, "k-edit-form-container"], ["novalidate", "", 3, "formGroup"], [1, "k-edit-label"], ["for", "k-event-title"], [1, "k-edit-field"], ["id", "k-event-title", "placeholder", "Title", 1, "k-textbox", 3, "formControl"], ["title", ""], [3, "click"], [3, "formControl", "isAllDay"], ["startDateTimePicker", ""], ["endDateTimePicker", ""], ["class", "k-edit-field", 4, "ngIf"], [4, "ngFor", "ngForOf"], [3, "formControl"], ["startTzPicker", ""], ["endTzPicker", ""], ["type", "checkbox", "id", "k-is-allday-chkbox", 1, "k-checkbox", 3, "formControl"], ["for", "k-is-allday-chkbox", 1, "k-checkbox-label"], ["type", "checkbox", "id", "k-set-timezone", "formControlName", "startTimezoneCheckbox", 1, "k-checkbox"], ["for", "k-set-timezone", 1, "k-checkbox-label"], ["type", "checkbox", "id", "k-use-separate", "formControlName", "endTimezoneCheckbox", 1, "k-checkbox"], ["for", "k-use-separate", 1, "k-checkbox-label"], [3, "formControl", "start", "timezone"], ["for", "k-event-description"], ["id", "k-event-description", 1, "k-textbox", 3, "formControl"], [3, "formControl", "resource", 4, "ngIf"], [3, "formControl", "resource"], [3, "ngTemplateOutlet", "ngTemplateOutletContext"]], template: function EditDialogComponent_Template(rf, ctx) { if (rf & 1) {
        ɵngcc0.ɵɵtemplate(0, EditDialogComponent_kendo_dialog_0_Template, 8, 8, "kendo-dialog", 0);
    } if (rf & 2) {
        ɵngcc0.ɵɵproperty("ngIf", ctx.isActive);
    } }, directives: function () { return [ɵngcc4.NgIf, ɵngcc1.DialogComponent, ɵngcc1.DialogActionsComponent, ɵngcc9.ɵangular_packages_forms_forms_y, ɵngcc9.NgControlStatusGroup, ɵngcc9.FormGroupDirective, ɵngcc9.DefaultValueAccessor, ɵngcc9.NgControlStatus, ɵngcc9.FormControlDirective, SchedulerDateTimePickerComponent, ɵngcc4.NgForOf, TimeZoneEditorComponent, ɵngcc9.CheckboxControlValueAccessor, ɵngcc9.FormControlName, RecurrenceEditorComponent,
        MultipleResourceEditorComponent,
        SingleResourceEditorComponent, ɵngcc4.NgTemplateOutlet]; }, encapsulation: 2 });
/** @nocollapse */
EditDialogComponent.ctorParameters = () => [
    { type: NgZone },
    { type: EditService },
    { type: LocalizationService },
    { type: ChangeDetectorRef },
    { type: ElementRef },
    { type: FocusService }
];
EditDialogComponent.propDecorators = {
    multipleResourceEditors: [{ type: ViewChildren, args: [MultipleResourceEditorComponent,] }],
    singleResourceEditors: [{ type: ViewChildren, args: [SingleResourceEditorComponent,] }],
    resources: [{ type: Input }],
    timezone: [{ type: Input }],
    fields: [{ type: Input }],
    editTemplate: [{ type: Input }]
};
/*@__PURE__*/ (function () { ɵngcc0.ɵsetClassMetadata(EditDialogComponent, [{
        type: Component,
        args: [{
                selector: 'kendo-scheduler-edit-dialog',
                template: `
        <kendo-dialog (close)='onClose()' [minWidth]='700' *ngIf='isActive' title='{{ textFor("editorTitle") }}' class='k-scheduler-edit-dialog' [autoFocusedElement]="autoFocusedElement">
            <ng-container *ngIf='!editTemplate'>
                <div class='k-scheduler-edit-form'>
                    <div class='k-edit-form-container'>
                        <form novalidate [formGroup]='formGroup'>
                            <div class='k-edit-label'>
                                <label for='k-event-title'>{{ textFor('editorEventTitle') }}</label>
                            </div>
                            <div class='k-edit-field'>
                                <input #title id='k-event-title' class='k-textbox' placeholder='Title' [formControl]='formGroup.get(fields.title)' />
                            </div>

                            <div class='k-edit-label'>
                                <label (click)="startDateTimePicker.focus()">{{ textFor('editorEventStart') }}</label>
                            </div>
                            <div class='k-edit-field'>
                                <kendo-scheduler-datetime-picker #startDateTimePicker [formControl]='formGroup.get(fields.start)'
                                    [isAllDay]='getFormValue(fields.isAllDay)?.value'>
                                </kendo-scheduler-datetime-picker>
                            </div>

                            <ng-container *ngIf="isStartTimeZoneVisible">
                                <div class='k-edit-label'>
                                    <label (click)="startTzPicker.focus()">{{ textFor('editorEventStartTimeZone') }}</label>
                                </div>

                                <div class='k-edit-field'>
                                    <kendo-timezone-editor #startTzPicker [formControl]='formGroup.get(fields.startTimezone)'></kendo-timezone-editor>
                                </div>
                            </ng-container>

                            <div class='k-edit-label'>
                                <label (click)="endDateTimePicker.focus()">{{ textFor('editorEventEnd') }}</label>
                            </div>
                            <div class='k-edit-field'>
                                <kendo-scheduler-datetime-picker #endDateTimePicker [formControl]='formGroup.get(fields.end)'
                                    [isAllDay]='getFormValue(fields.isAllDay)?.value'>
                                </kendo-scheduler-datetime-picker>
                            </div>

                            <ng-container *ngIf="isEndTimeZoneVisible">
                                <div class='k-edit-label'>
                                    <label (click)="endTzPicker.focus()">{{ textFor('editorEventEndTimeZone') }}</label>
                                </div>

                                <div class='k-edit-field'>
                                    <kendo-timezone-editor #endTzPicker [formControl]='formGroup.get(fields.endTimezone)'></kendo-timezone-editor>
                                </div>
                            </ng-container>

                            <div class='k-edit-field' *ngIf="hasAllDay">
                                <input type='checkbox' id='k-is-allday-chkbox' class='k-checkbox' [formControl]='formGroup.get(fields.isAllDay)' />
                                <label class='k-checkbox-label' for='k-is-allday-chkbox'>{{ textFor('editorEventAllDay') }}</label>
                            </div>

                            <div class='k-edit-field' *ngIf="hasStartTimeZone">
                                <input type='checkbox' id='k-set-timezone' class='k-checkbox'
                                formControlName='startTimezoneCheckbox' />
                                <label class='k-checkbox-label' for='k-set-timezone'>{{ textFor('editorEventTimeZone') }}</label>

                                <ng-container *ngIf="isStartTimeZoneVisible && hasEndTimeZone">
                                    <input type='checkbox' id='k-use-separate' class='k-checkbox' formControlName='endTimezoneCheckbox' />
                                    <label class='k-checkbox-label' for='k-use-separate'>{{ textFor('editorEventSeparateTimeZones') }}</label>
                                </ng-container>
                            </div>

                            <ng-container *ngIf="isEditingSeries">
                                <kendo-recurrence-editor
                                    [formControl]='formGroup.get(fields.recurrenceRule)'
                                    [start]='recurrenceStart'
                                    [timezone]='eventTimezone'
                                ></kendo-recurrence-editor>
                            </ng-container>

                            <ng-container *ngIf='getFormValue(fields.description)'>
                                <div class='k-edit-label'>
                                    <label for='k-event-description'>{{ textFor('editorEventDescription') }}</label>
                                </div>
                                <div class='k-edit-field'>
                                    <textarea id='k-event-description' class='k-textbox' [formControl]='formGroup.get(fields.description)'></textarea>
                                </div>
                            </ng-container>

                            <ng-container *ngFor='let resource of resources'>
                                <ng-container *ngIf='getFormValue(resource.field)'>
                                    <div class='k-edit-label'>
                                        <label (click)="onResourceClick(resource)">
                                            {{ resource.name ? resource.name : resource.field }}
                                        </label>
                                    </div>
                                    <div class='k-edit-field'>
                                        <kendo-multiple-resource-editor
                                            *ngIf='resource.multiple'
                                            [formControl]='formGroup.get(resource.field)'
                                            [resource]='resource'>
                                        </kendo-multiple-resource-editor>
                                        <kendo-single-resource-editor
                                            *ngIf='!resource.multiple'
                                            [formControl]='formGroup.get(resource.field)'
                                            [resource]='resource'>
                                        </kendo-single-resource-editor>
                                    </div>
                                </ng-container>
                            </ng-container>
                        </form>
                    </div>
                </div>
            </ng-container>

            <ng-container *ngIf='editTemplate'>
                <form novalidate [formGroup]='formGroup'>
                    <ng-container [ngTemplateOutlet]='editTemplate.templateRef'
                        [ngTemplateOutletContext]="{
                            $implicit: formGroup,
                            formGroup: formGroup,
                            dataItem: editedEvent,
                            editMode: editMode,
                            isNew: isNew
                        }">
                    </ng-container>
                </form>
            </ng-container>

            <kendo-dialog-actions>
                <button class="k-button" (click)="onCancel($event)">{{ textFor('cancel') }}</button>
                <button class="k-button k-primary" (click)="onSave($event)" [disabled]="!formGroup.valid">{{ textFor('save') }}</button>
            </kendo-dialog-actions>
        </kendo-dialog>
    `
            }]
    }], function () { return [{ type: ɵngcc0.NgZone }, { type: EditService }, { type: ɵngcc2.LocalizationService }, { type: ɵngcc0.ChangeDetectorRef }, { type: ɵngcc0.ElementRef }, { type: FocusService }]; }, { resources: [{
            type: Input
        }], timezone: [{
            type: Input
        }], multipleResourceEditors: [{
            type: ViewChildren,
            args: [MultipleResourceEditorComponent]
        }], singleResourceEditors: [{
            type: ViewChildren,
            args: [SingleResourceEditorComponent]
        }], fields: [{
            type: Input
        }], editTemplate: [{
            type: Input
        }] }); })();

/* tslint:disable: no-use-before-declare */
/* tslint:disable: no-forward-ref */
/**
 * @hidden
 */
const SCHEDULER_DATETIMEPICKER_VALUE_ACCESSOR = {
    multi: true,
    provide: NG_VALUE_ACCESSOR,
    useExisting: forwardRef(() => SchedulerDateTimePickerComponent)
};
/**
 * @hidden
 */
class SchedulerDateTimePickerComponent {
    constructor() {
        this.valueChange = new EventEmitter();
        this.onTouchedCallback = (_) => { };
        this.onChangeCallback = (_) => { };
    }
    writeValue(newDate) {
        if (newDate instanceof Date) {
            this.date = newDate;
        }
    }
    onValueChange(newValue) {
        this.onChangeCallback(newValue);
        this.valueChange.emit(newValue);
    }
    /**
     * @hidden
     */
    focus() {
        this.datePicker.focus();
    }
    /**
     * @hidden
     */
    registerOnChange(fn) {
        this.onChangeCallback = fn;
    }
    /**
     * @hidden
     */
    registerOnTouched(fn) {
        this.onTouchedCallback = fn;
    }
}
SchedulerDateTimePickerComponent.ɵfac = function SchedulerDateTimePickerComponent_Factory(t) { return new (t || SchedulerDateTimePickerComponent)(); };
SchedulerDateTimePickerComponent.ɵcmp = ɵngcc0.ɵɵdefineComponent({ type: SchedulerDateTimePickerComponent, selectors: [["kendo-scheduler-datetime-picker"]], viewQuery: function SchedulerDateTimePickerComponent_Query(rf, ctx) { if (rf & 1) {
        ɵngcc0.ɵɵviewQuery(_c194, true);
    } if (rf & 2) {
        var _t;
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.datePicker = _t.first);
    } }, inputs: { isAllDay: "isAllDay" }, outputs: { valueChange: "valueChange" }, features: [ɵngcc0.ɵɵProvidersFeature([
            SCHEDULER_DATETIMEPICKER_VALUE_ACCESSOR
        ])], decls: 3, vars: 2, consts: [[3, "value", "valueChange"], ["datepicker", ""], [3, "value", "valueChange", 4, "ngIf"]], template: function SchedulerDateTimePickerComponent_Template(rf, ctx) { if (rf & 1) {
        ɵngcc0.ɵɵelementStart(0, "kendo-datepicker", 0, 1);
        ɵngcc0.ɵɵlistener("valueChange", function SchedulerDateTimePickerComponent_Template_kendo_datepicker_valueChange_0_listener($event) { return ctx.date = $event; })("valueChange", function SchedulerDateTimePickerComponent_Template_kendo_datepicker_valueChange_0_listener($event) { return ctx.onValueChange($event); });
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵtemplate(2, SchedulerDateTimePickerComponent_kendo_timepicker_2_Template, 1, 1, "kendo-timepicker", 2);
    } if (rf & 2) {
        ɵngcc0.ɵɵproperty("value", ctx.date);
        ɵngcc0.ɵɵadvance(2);
        ɵngcc0.ɵɵproperty("ngIf", !ctx.isAllDay);
    } }, directives: [ɵngcc7.DatePickerComponent, ɵngcc4.NgIf, ɵngcc7.TimePickerComponent], encapsulation: 2 });
SchedulerDateTimePickerComponent.propDecorators = {
    datePicker: [{ type: ViewChild, args: ['datepicker',] }],
    isAllDay: [{ type: Input }],
    valueChange: [{ type: Output }]
};
/*@__PURE__*/ (function () { ɵngcc0.ɵsetClassMetadata(SchedulerDateTimePickerComponent, [{
        type: Component,
        args: [{
                providers: [
                    SCHEDULER_DATETIMEPICKER_VALUE_ACCESSOR
                ],
                selector: 'kendo-scheduler-datetime-picker',
                template: `
    <kendo-datepicker
        #datepicker
        [(value)]='date'
        (valueChange)='onValueChange($event)'
    ></kendo-datepicker>
    <kendo-timepicker *ngIf='!isAllDay'
        [(value)]='date'
        (valueChange)='onValueChange($event)'
    ></kendo-timepicker>
    `
            }]
    }], function () { return []; }, { valueChange: [{
            type: Output
        }], datePicker: [{
            type: ViewChild,
            args: ['datepicker']
        }], isAllDay: [{
            type: Input
        }] }); })();

let uniqueIdCounter = 0;
const offsetPositions = ['first', 'second', 'third', 'fourth', 'last'];
const frequencies = ['never', 'daily', 'weekly', 'monthly', 'yearly'];
/**
 * @hidden
 */
const dayRule = [
    { day: 0, offset: 0 },
    { day: 1, offset: 0 },
    { day: 2, offset: 0 },
    { day: 3, offset: 0 },
    { day: 4, offset: 0 },
    { day: 5, offset: 0 },
    { day: 6, offset: 0 }
];
/**
 * @hidden
 */
const weekdayRule = [
    { day: 1, offset: 0 },
    { day: 2, offset: 0 },
    { day: 3, offset: 0 },
    { day: 4, offset: 0 },
    { day: 5, offset: 0 }
];
/**
 * @hidden
 */
const weekendRule = [
    { day: 0, offset: 0 },
    { day: 6, offset: 0 }
];
/**
 * @hidden
 *
 * The internal service for handling changes in the RecurrenceEditor component.
 */
class RecurrenceService {
    constructor(intl, localization) {
        this.intl = intl;
        this.localization = localization;
        this.change = new EventEmitter();
        this.endRuleChange = new EventEmitter();
        this.frequencyChange = new EventEmitter();
        this.repeatOnRuleChange = new EventEmitter();
    }
    init(rrule = "", start, timezone) {
        this.rrule = parseRule({
            recurrenceRule: rrule,
            weekStart: this.intl.firstDay()
        });
        this.start = start;
        this.timezone = timezone;
    }
    /**
     * @hidden
     */
    getUniqueId() {
        return uniqueIdCounter++;
    }
    get frequencies() {
        return frequencies.map((freq) => ({
            value: freq,
            text: this.localization.get('frequencies' + capitalize(freq))
        }));
    }
    get frequency() {
        if (isPresent(this.rrule) && !isNullOrEmptyString(this.rrule.freq)) {
            return this.rrule.freq;
        }
        return 'never';
    }
    setFrequency(freq) {
        this.rrule = {};
        this.rrule.freq = freq;
        this.rrule.interval = 1;
        if (freq === 'weekly') {
            this.rrule.byWeekDay = [{
                    day: this.start.getDay(),
                    offset: 0
                }];
        }
        if (freq === 'monthly' || freq === 'yearly') {
            this.rrule.byMonthDay = [this.start.getDate()];
        }
        if (freq === 'yearly') {
            this.rrule.byMonth = [this.start.getMonth() + 1];
        }
        this.frequencyChange.emit();
        this.onChange();
    }
    set interval(newInterval) {
        this.rrule.interval = newInterval;
        this.onChange();
    }
    set count(newCount) {
        this.rrule.count = newCount;
        this.onChange();
    }
    set until(newUntil) {
        this.rrule.until = ZonedDate.fromLocalDate(newUntil, this.timezone);
        this.onChange();
    }
    get until() {
        if (isPresent(this.rrule.until)) {
            return toLocalDate(this.rrule.until);
        }
    }
    setWeekDays(newWeekDays) {
        this.rrule.byWeekDay = newWeekDays;
        this.onChange();
    }
    set monthDays(newMonthDays) {
        this.rrule.byMonthDay = newMonthDays;
        this.onChange();
    }
    set positions(newPositions) {
        this.rrule.bySetPosition = newPositions;
        this.onChange();
    }
    setMonths(newMonths) {
        this.rrule.byMonth = newMonths;
        this.onChange();
    }
    get months() {
        return this.intl.dateFormatNames({
            type: 'months',
            nameType: 'wide'
        }).map((month, idx) => ({
            text: month,
            value: idx + 1
        }));
    }
    /*
        ToDo Refactor weekDays and extendedWeekDays getters into a single method
    */
    get weekDays() {
        const firstDay = this.intl.firstDay();
        const abbrNames = this.intl.dateFormatNames({
            type: 'days',
            nameType: 'abbreviated'
        }).map((day, idx) => ({
            text: day,
            value: idx
        }));
        /* Sorting according to first week day */
        return (abbrNames.slice(firstDay)).concat(abbrNames.slice(0, firstDay));
    }
    get extendedWeekDays() {
        const firstDay = this.intl.firstDay();
        let wideNames = this.intl.dateFormatNames({
            type: 'days',
            nameType: 'wide'
        }).map((day, idx) => ({
            text: day,
            value: idx
        }));
        const sortedWideNames = (wideNames.slice(firstDay)).concat(wideNames.slice(0, firstDay));
        const specialRules = [
            { text: this.localization.get('weekdaysDay'), value: 'day' },
            { text: this.localization.get('weekdaysWeekday'), value: 'weekday' },
            { text: this.localization.get('weekdaysWeekendday'), value: 'weekend' }
        ];
        return specialRules.concat(sortedWideNames);
    }
    get offsetPositions() {
        const values = [1, 2, 3, 4, -1];
        return offsetPositions.map((offset, idx) => ({
            text: this.localization.get('offsetPositions' + capitalize(offset)),
            value: values[idx]
        }));
    }
    get endRule() {
        if (isPresent(this.rrule.count)) {
            return 'count';
        }
        else if (isPresent(this.rrule.until)) {
            return 'until';
        }
        else {
            return 'never';
        }
    }
    set endRule(endRule) {
        if (endRule === 'count') {
            this.rrule.until = null;
        }
        else if (endRule === 'until') {
            this.rrule.count = null;
        }
        else {
            /* never */
            this.rrule.count = null;
            this.rrule.until = null;
        }
        this.endRuleChange.emit(endRule);
        this.onChange();
    }
    get repeatOnRule() {
        if (isPresent(this.rrule.byWeekDay)) {
            return 'weekday';
        }
        else if (isPresent(this.rrule.byMonthDay)) {
            return 'monthday';
        }
        return null;
    }
    set repeatOnRule(repeatOnRule) {
        if (repeatOnRule === 'monthday') {
            this.rrule.byWeekDay = null;
            this.rrule.bySetPosition = null;
        }
        else {
            /* weekDays */
            this.rrule.byMonthDay = null;
        }
        this.repeatOnRuleChange.emit(repeatOnRule);
        this.onChange();
    }
    onChange() {
        if (this.frequency === 'never') {
            this.change.emit(null);
        }
        else {
            this.change.emit(serializeRule(this.rrule, this.timezone));
        }
    }
}
RecurrenceService.ɵfac = function RecurrenceService_Factory(t) { return new (t || RecurrenceService)(ɵngcc0.ɵɵinject(ɵngcc3.IntlService), ɵngcc0.ɵɵinject(ɵngcc2.LocalizationService)); };
RecurrenceService.ɵprov = ɵngcc0.ɵɵdefineInjectable({ token: RecurrenceService, factory: RecurrenceService.ɵfac });
/** @nocollapse */
RecurrenceService.ctorParameters = () => [
    { type: IntlService },
    { type: LocalizationService }
];
/*@__PURE__*/ (function () { ɵngcc0.ɵsetClassMetadata(RecurrenceService, [{
        type: Injectable
    }], function () { return [{ type: ɵngcc3.IntlService }, { type: ɵngcc2.LocalizationService }]; }, null); })();

/**
 * @hidden
 */
class RecurrenceLocalizationService extends LocalizationService {
    constructor(prefix, messageService, _rtl, schedulerLocalization) {
        super(prefix, messageService, _rtl);
        this.schedulerLocalization = schedulerLocalization;
    }
    get(shortKey) {
        if (this.schedulerLocalization) {
            return this.schedulerLocalization.get('recurrenceEditor' + capitalize(shortKey));
        }
        return super.get(shortKey);
    }
}
RecurrenceLocalizationService.ɵfac = function RecurrenceLocalizationService_Factory(t) { return new (t || RecurrenceLocalizationService)(ɵngcc0.ɵɵinject(L10N_PREFIX), ɵngcc0.ɵɵinject(ɵngcc2.MessageService, 8), ɵngcc0.ɵɵinject(RTL, 8), ɵngcc0.ɵɵinject(SchedulerLocalizationService, 8)); };
RecurrenceLocalizationService.ɵprov = ɵngcc0.ɵɵdefineInjectable({ token: RecurrenceLocalizationService, factory: RecurrenceLocalizationService.ɵfac });
/** @nocollapse */
RecurrenceLocalizationService.ctorParameters = () => [
    { type: String, decorators: [{ type: Inject, args: [L10N_PREFIX,] }] },
    { type: MessageService, decorators: [{ type: Optional }] },
    { type: Boolean, decorators: [{ type: Optional }, { type: Inject, args: [RTL,] }] },
    { type: SchedulerLocalizationService, decorators: [{ type: Optional }, { type: Inject, args: [SchedulerLocalizationService,] }] }
];


/* tslint:disable: no-use-before-declare */
/* tslint:disable: no-forward-ref */
/**
 * @hidden
 */
const RECURRENCE_VALUE_ACCESSOR = {
    multi: true,
    provide: NG_VALUE_ACCESSOR,
    useExisting: forwardRef(() => RecurrenceEditorComponent)
};
/**
 * Represents the Kendo UI Recurrence Editor component for Angular. [This example]({% slug custom_reactive_editing_scheduler %}#toc-setup) demonstrates the Recurrence Editor, among other components.
 */
class RecurrenceEditorComponent {
    constructor(recurrenceService) {
        this.recurrenceService = recurrenceService;
        this.cssClass = true;
        /**
         * Specifies the id of the timezone that will be used.
         */
        this.timezone = 'Etc/UTC';
        /**
         * Fires when the value of the component has changed.
         */
        this.valueChange = new EventEmitter();
        this.onTouchedCallback = (_) => { };
        this.onChangeCallback = (_) => { };
        this.subscriptions = this.recurrenceService.change.subscribe((rrule) => {
            this.emitChange(rrule);
        });
    }
    /**
     * Specifies the start date of the event.
     */
    set start(value) {
        this._start = value;
    }
    get start() {
        return isPresent(this._start) ? this._start : getDate(new Date());
    }
    /**
     * @hidden
     */
    get currentFreq() {
        return this.recurrenceService.frequency;
    }
    /**
     * @hidden
     */
    ngOnInit() {
        this.recurrenceService.init('', this.start, this.timezone);
    }
    ngOnChanges(changes) {
        if (isChanged('start', changes)) {
            this.recurrenceService.start = this.start;
        }
    }
    /**
     * @hidden
     */
    ngOnDestroy() {
        if (this.subscriptions) {
            this.subscriptions.unsubscribe();
        }
    }
    /**
     * @hidden
     */
    writeValue(rrule) {
        this.recurrenceService.init(typeof rrule === 'string' ? rrule : '', this.start, this.timezone);
    }
    /**
     * @hidden
     */
    registerOnChange(fn) {
        this.onChangeCallback = fn;
    }
    /**
     * @hidden
     */
    registerOnTouched(fn) {
        this.onTouchedCallback = fn;
    }
    emitChange(rrule) {
        this.onChangeCallback(rrule);
        this.valueChange.emit(rrule);
    }
}
RecurrenceEditorComponent.ɵfac = function RecurrenceEditorComponent_Factory(t) { return new (t || RecurrenceEditorComponent)(ɵngcc0.ɵɵdirectiveInject(RecurrenceService)); };
RecurrenceEditorComponent.ɵcmp = ɵngcc0.ɵɵdefineComponent({ type: RecurrenceEditorComponent, selectors: [["kendo-recurrence-editor"]], hostVars: 2, hostBindings: function RecurrenceEditorComponent_HostBindings(rf, ctx) { if (rf & 2) {
        ɵngcc0.ɵɵclassProp("k-recurrence-editor", ctx.cssClass);
    } }, inputs: { timezone: "timezone", start: "start", repeatEveryOptions: "repeatEveryOptions", endAfterOptions: "endAfterOptions", repeatOnOptions: "repeatOnOptions", endOnOptions: "endOnOptions" }, outputs: { valueChange: "valueChange" }, exportAs: ["kendoRecurrenceEditor"], features: [ɵngcc0.ɵɵProvidersFeature([
            RecurrenceLocalizationService,
            {
                provide: LocalizationService,
                useExisting: RecurrenceLocalizationService
            },
            {
                provide: L10N_PREFIX,
                useValue: 'kendo.recurrenceeditor'
            },
            RECURRENCE_VALUE_ACCESSOR,
            RecurrenceService
        ]), ɵngcc0.ɵɵNgOnChangesFeature], decls: 8, vars: 4, consts: [["kendoRecurrenceEditorLocalizedMessages", "", "offsetPositionsFirst", "First", 6, "repeat", "dailyInterval", "dailyRepeatEvery", "weeklyInterval", "weeklyRepeatEvery", "weeklyRepeatOn", "monthlyDay", "monthlyInterval", "monthlyRepeatEvery", "monthlyRepeatOn", "yearlyOf", "yearlyRepeatEvery", "yearlyRepeatOn", "yearlyInterval", "frequenciesDaily", "frequenciesMonthly", "frequenciesNever", "frequenciesWeekly", "frequenciesYearly", "offsetPositionsSecond", "offsetPositionsThird", "offsetPositionsFourth", "offsetPositionsLast", "weekdaysDay", "weekdaysWeekday", "weekdaysWeekendday", "endAfter", "endOccurrence", "endLabel", "endNever", "endOn"], [1, "k-recur-view"], [3, "userNumericOptions", 4, "ngIf"], [4, "ngIf"], [3, "userNumericOptions", "userDatePickerOptions", 4, "ngIf"], [3, "userNumericOptions"], [3, "userNumericOptions", "userDatePickerOptions"]], template: function RecurrenceEditorComponent_Template(rf, ctx) { if (rf & 1) {
        ɵngcc0.ɵɵelementContainerStart(0, 0);
        ɵngcc0.ɵɵi18nAttributes(1, _c257);
        ɵngcc0.ɵɵelementContainerEnd();
        ɵngcc0.ɵɵelement(2, "kendo-recurrence-frequency-editor");
        ɵngcc0.ɵɵelementStart(3, "div", 1);
        ɵngcc0.ɵɵtemplate(4, RecurrenceEditorComponent_kendo_recurrence_interval_editor_4_Template, 1, 1, "kendo-recurrence-interval-editor", 2);
        ɵngcc0.ɵɵtemplate(5, RecurrenceEditorComponent_kendo_recurrence_weekday_rule_editor_5_Template, 1, 0, "kendo-recurrence-weekday-rule-editor", 3);
        ɵngcc0.ɵɵtemplate(6, RecurrenceEditorComponent_kendo_recurrence_monthly_yearly_editor_6_Template, 1, 1, "kendo-recurrence-monthly-yearly-editor", 2);
        ɵngcc0.ɵɵtemplate(7, RecurrenceEditorComponent_kendo_recurrence_end_rule_editor_7_Template, 1, 2, "kendo-recurrence-end-rule-editor", 4);
        ɵngcc0.ɵɵelementEnd();
    } if (rf & 2) {
        ɵngcc0.ɵɵadvance(4);
        ɵngcc0.ɵɵproperty("ngIf", ctx.currentFreq !== "never");
        ɵngcc0.ɵɵadvance(1);
        ɵngcc0.ɵɵproperty("ngIf", ctx.currentFreq === "weekly");
        ɵngcc0.ɵɵadvance(1);
        ɵngcc0.ɵɵproperty("ngIf", ctx.currentFreq === "monthly" || ctx.currentFreq === "yearly");
        ɵngcc0.ɵɵadvance(1);
        ɵngcc0.ɵɵproperty("ngIf", ctx.currentFreq !== "never");
    } }, directives: function () { return [RecurrenceEditorLocalizedMessagesDirective,
        RecurrenceFrequencyEditorComponent, ɵngcc4.NgIf, RecurrenceIntervalEditorComponent,
        RecurrenceWeekdayRuleEditorComponent,
        RecurrenceMonthlyYearlyEditorComponent,
        RecurrenceEndRuleEditorComponent]; }, encapsulation: 2 });
/** @nocollapse */
RecurrenceEditorComponent.ctorParameters = () => [
    { type: RecurrenceService }
];
RecurrenceEditorComponent.propDecorators = {
    cssClass: [{ type: HostBinding, args: ['class.k-recurrence-editor',] }],
    start: [{ type: Input }],
    timezone: [{ type: Input }],
    repeatEveryOptions: [{ type: Input }],
    endAfterOptions: [{ type: Input }],
    repeatOnOptions: [{ type: Input }],
    endOnOptions: [{ type: Input }],
    valueChange: [{ type: Output }]
};
/*@__PURE__*/ (function () { ɵngcc0.ɵsetClassMetadata(RecurrenceEditorComponent, [{
        type: Component,
        args: [{
                exportAs: 'kendoRecurrenceEditor',
                providers: [
                    RecurrenceLocalizationService,
                    {
                        provide: LocalizationService,
                        useExisting: RecurrenceLocalizationService
                    },
                    {
                        provide: L10N_PREFIX,
                        useValue: 'kendo.recurrenceeditor'
                    },
                    RECURRENCE_VALUE_ACCESSOR,
                    RecurrenceService
                ],
                selector: 'kendo-recurrence-editor',
                template: `
        <ng-container kendoRecurrenceEditorLocalizedMessages
            i18n-repeat="kendo.recurrenceeditor.repeat|The text similar to 'Repeat' displayed in the recurrence editor."
            repeat='Repeat'

            i18n-dailyInterval="kendo.recurrenceeditor.dailyInterval|The text similar to 'day(s)' displayed in the recurrence editor."
            dailyInterval='day(s)'

            i18n-dailyRepeatEvery="kendo.recurrenceeditor.dailyRepeatEvery|The text similar to 'Repeat every' displayed in the recurrence editor."
            dailyRepeatEvery='Repeat every'

            i18n-weeklyInterval="kendo.recurrenceeditor.weeklyInterval|The text similar to 'week(s)' displayed in the recurrence editor."
            weeklyInterval='week(s)'

            i18n-weeklyRepeatEvery="kendo.recurrenceeditor.weeklyRepeatEvery|The text similar to 'Repeat every' displayed in the recurrence editor."
            weeklyRepeatEvery='Repeat every'

            i18n-weeklyRepeatOn="kendo.recurrenceeditor.weeklyRepeatOn|The text similar to 'Repeat on' displayed in the recurrence editor."
            weeklyRepeatOn='Repeat on'

            i18n-monthlyDay="kendo.recurrenceeditor.monthlyDay|The text similar to 'Day' displayed in the recurrence editor."
            monthlyDay='Day'

            i18n-monthlyInterval="kendo.recurrenceeditor.monthlyInterval|The text similar to 'month(s)' displayed in the recurrence editor."
            monthlyInterval='month(s)'

            i18n-monthlyRepeatEvery="kendo.recurrenceeditor.monthlyRepeatEvery|The text similar to 'Repeat every' displayed in the recurrence editor."
            monthlyRepeatEvery='Repeat every'

            i18n-monthlyRepeatOn="kendo.recurrenceeditor.monthlyRepeatOn|The text similar to 'Repeat on' displayed in the recurrence editor."
            monthlyRepeatOn='Repeat on'

            i18n-yearlyOf="kendo.recurrenceeditor.yearlyOf|The text similar to 'of' displayed in the recurrence editor."
            yearlyOf='of'

            i18n-yearlyRepeatEvery="kendo.recurrenceeditor.yearlyRepeatEvery|The text similar to 'Repeat every' displayed in the recurrence editor."
            yearlyRepeatEvery='Repeat every'

            i18n-yearlyRepeatOn="kendo.recurrenceeditor.yearlyRepeatOn|The text similar to 'Repeat on' displayed in the recurrence editor."
            yearlyRepeatOn='Repeat on'

            i18n-yearlyInterval="kendo.recurrenceeditor.yearlyInterval|The text similar to 'year(s)' displayed in the recurrence editor."
            yearlyInterval='year(s)'

            i18n-frequenciesDaily="kendo.recurrenceeditor.frequenciesDaily|The text similar to 'Daily' displayed in the recurrence editor."
            frequenciesDaily='Daily'

            i18n-frequenciesMonthly="kendo.recurrenceeditor.frequenciesMonthly|The text similar to 'Monthly' displayed in the recurrence editor."
            frequenciesMonthly='Monthly'

            i18n-frequenciesNever="kendo.recurrenceeditor.frequenciesNever|The text similar to 'Never' displayed in the recurrence editor."
            frequenciesNever='Never'

            i18n-frequenciesWeekly="kendo.recurrenceeditor.frequenciesWeekly|The text similar to 'Weekly' displayed in the recurrence editor."
            frequenciesWeekly='Weekly'

            i18n-frequenciesYearly="kendo.recurrenceeditor.frequenciesYearly|The text similar to 'Yearly' displayed in the recurrence editor."
            frequenciesYearly='Yearly'

            i18n-fffsetPositionsFirst="kendo.recurrenceeditor.fffsetPositionsFirst|The text similar to 'First' displayed in the recurrence editor."
            offsetPositionsFirst='First'

            i18n-offsetPositionsSecond="kendo.recurrenceeditor.offsetPositionsSecond|The text similar to 'Second' displayed in the recurrence editor."
            offsetPositionsSecond='Second'

            i18n-offsetPositionsThird="kendo.recurrenceeditor.offsetPositionsThird|The text similar to 'Third' displayed in the recurrence editor."
            offsetPositionsThird='Third'

            i18n-offsetPositionsFourth="kendo.recurrenceeditor.offsetPositionsFourth|The text similar to 'Fourth' displayed in the recurrence editor."
            offsetPositionsFourth='Fourth'

            i18n-offsetPositionsLast="kendo.recurrenceeditor.offsetPositionsLast|The text similar to 'Last' displayed in the recurrence editor."
            offsetPositionsLast='Last'

            i18n-weekdaysDay="kendo.recurrenceeditor.weekdaysDay|The text similar to 'Day' displayed in the repeat by section of the monthly recurrence pattern."
            weekdaysDay='Day'

            i18n-weekdaysWeekday="kendo.recurrenceeditor.weekdaysWeekday|The text similar to 'Weekday' displayed in the repeat by section of the monthly recurrence pattern."
            weekdaysWeekday='Weekday'

            i18n-weekdaysWeekendday="kendo.recurrenceeditor.weekdaysWeekendday|The text similar to 'Weekend Day' displayed in the repeat by section of the monthly recurrence pattern."
            weekdaysWeekendday='Weekend Day'

            i18n-endAfter="kendo.recurrenceeditor.endAfter|The text similar to 'After' displayed in the recurrence editor."
            endAfter='After'

            i18n-endOccurrence="kendo.recurrenceeditor.endOccurrence|The text similar to 'occurrence(s)' displayed in the recurrence editor."
            endOccurrence='occurrence(s)'

            i18n-endLabel="kendo.recurrenceeditor.endLabel|The text similar to 'End' displayed in the recurrence editor."
            endLabel='End'

            i18n-endNever="kendo.recurrenceeditor.endNever|The text similar to 'Never' displayed in the recurrence editor."
            endNever='Never'

            i18n-endOn="kendo.recurrenceeditor.endOn|The text similar to 'On' displayed in the recurrence editor."
            endOn='On'
        >
        </ng-container>

        <kendo-recurrence-frequency-editor>
        </kendo-recurrence-frequency-editor>

        <div class='k-recur-view'>
            <kendo-recurrence-interval-editor
                *ngIf="currentFreq !== 'never'"
                [userNumericOptions]="repeatEveryOptions">
            </kendo-recurrence-interval-editor>

            <kendo-recurrence-weekday-rule-editor *ngIf="currentFreq === 'weekly'">
            </kendo-recurrence-weekday-rule-editor>

            <kendo-recurrence-monthly-yearly-editor
                *ngIf="currentFreq === 'monthly' || currentFreq === 'yearly'"
                [userNumericOptions]="repeatOnOptions">
            </kendo-recurrence-monthly-yearly-editor>

            <kendo-recurrence-end-rule-editor
                *ngIf="currentFreq !== 'never'"
                [userNumericOptions]="endAfterOptions"
                [userDatePickerOptions]="endOnOptions">
            </kendo-recurrence-end-rule-editor>
        </div>
    `
            }]
    }], function () { return [{ type: RecurrenceService }]; }, { cssClass: [{
            type: HostBinding,
            args: ['class.k-recurrence-editor']
        }], timezone: [{
            type: Input
        }], valueChange: [{
            type: Output
        }], start: [{
            type: Input
        }], repeatEveryOptions: [{
            type: Input
        }], endAfterOptions: [{
            type: Input
        }], repeatOnOptions: [{
            type: Input
        }], endOnOptions: [{
            type: Input
        }] }); })();

/**
 * @hidden
 */
class RecurrenceFrequencyEditorComponent {
    constructor(recurrence, localization) {
        this.recurrence = recurrence;
        this.localization = localization;
    }
    ngOnInit() {
        this.frequencies = this.recurrence.frequencies;
    }
    get selected() {
        return this.recurrence.frequency;
    }
    onClick(newFreq) {
        if (newFreq.value !== this.selected) {
            this.recurrence.setFrequency(newFreq.value);
        }
    }
    textFor(key) {
        return this.localization.get(key);
    }
    onFrequencyClick() {
        const selected = this.weekDayButtons.toArray().find(r => r.selected);
        if (selected) {
            selected.focus();
        }
    }
}
RecurrenceFrequencyEditorComponent.ɵfac = function RecurrenceFrequencyEditorComponent_Factory(t) { return new (t || RecurrenceFrequencyEditorComponent)(ɵngcc0.ɵɵdirectiveInject(RecurrenceService), ɵngcc0.ɵɵdirectiveInject(ɵngcc2.LocalizationService)); };
RecurrenceFrequencyEditorComponent.ɵcmp = ɵngcc0.ɵɵdefineComponent({ type: RecurrenceFrequencyEditorComponent, selectors: [["kendo-recurrence-frequency-editor"]], viewQuery: function RecurrenceFrequencyEditorComponent_Query(rf, ctx) { if (rf & 1) {
        ɵngcc0.ɵɵviewQuery(Button, true);
    } if (rf & 2) {
        var _t;
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.weekDayButtons = _t);
    } }, decls: 6, vars: 3, consts: [[1, "k-edit-label"], [3, "click"], [1, "k-edit-field"], [3, "selection"], ["kendoButton", "", 3, "width", "togglable", "selected", "click", 4, "ngFor", "ngForOf"], ["kendoButton", "", 3, "togglable", "selected", "click"]], template: function RecurrenceFrequencyEditorComponent_Template(rf, ctx) { if (rf & 1) {
        ɵngcc0.ɵɵelementStart(0, "div", 0);
        ɵngcc0.ɵɵelementStart(1, "label", 1);
        ɵngcc0.ɵɵlistener("click", function RecurrenceFrequencyEditorComponent_Template_label_click_1_listener() { return ctx.onFrequencyClick(); });
        ɵngcc0.ɵɵtext(2);
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵelementStart(3, "div", 2);
        ɵngcc0.ɵɵelementStart(4, "kendo-buttongroup", 3);
        ɵngcc0.ɵɵtemplate(5, RecurrenceFrequencyEditorComponent_button_5_Template, 2, 5, "button", 4);
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵelementEnd();
    } if (rf & 2) {
        ɵngcc0.ɵɵadvance(2);
        ɵngcc0.ɵɵtextInterpolate(ctx.textFor("repeat"));
        ɵngcc0.ɵɵadvance(2);
        ɵngcc0.ɵɵproperty("selection", "single");
        ɵngcc0.ɵɵadvance(1);
        ɵngcc0.ɵɵproperty("ngForOf", ctx.frequencies);
    } }, directives: [ɵngcc10.ButtonGroup, ɵngcc4.NgForOf, ɵngcc10.Button], encapsulation: 2 });
/** @nocollapse */
RecurrenceFrequencyEditorComponent.ctorParameters = () => [
    { type: RecurrenceService },
    { type: LocalizationService }
];
RecurrenceFrequencyEditorComponent.propDecorators = {
    weekDayButtons: [{ type: ViewChildren, args: [Button,] }]
};
/*@__PURE__*/ (function () { ɵngcc0.ɵsetClassMetadata(RecurrenceFrequencyEditorComponent, [{
        type: Component,
        args: [{
                selector: 'kendo-recurrence-frequency-editor',
                template: `
        <div class='k-edit-label'>
            <label (click)="onFrequencyClick()">{{ textFor('repeat') }}</label>
        </div>
        <div class='k-edit-field'>
            <kendo-buttongroup [selection]="'single'">
                <button *ngFor='let freq of frequencies' kendoButton
                        [style.width.px]="100"
                        [togglable]="true"
                        [selected]="freq.value === selected"
                        (click)="onClick(freq)"
                >{{ freq.text }}</button>
            </kendo-buttongroup>
        </div>
    `
            }]
    }], function () { return [{ type: RecurrenceService }, { type: ɵngcc2.LocalizationService }]; }, { weekDayButtons: [{
            type: ViewChildren,
            args: [Button]
        }] }); })();

/**
 * @hidden
 */
class EndRuleRadioButtonDirective {
    constructor(el, renderer, recurrence, changeDetector) {
        this.el = el;
        this.renderer = renderer;
        this.recurrence = recurrence;
        this.changeDetector = changeDetector;
        this.type = 'radio';
        this.radioClass = true;
        this.destroyChange = this.renderer.listen(this.elem, 'change', this.onChange.bind(this));
    }
    ngOnInit() {
        this.endRule = this.endRuleId.split('-')[2];
        this.renderer.setAttribute(this.elem, 'id', this.endRuleId);
        this.renderer.setAttribute(this.elem, 'name', `end-${this.endRuleId.split('-').pop()}`);
    }
    ngAfterContentChecked() {
        this.setCheckedState();
    }
    ngOnDestroy() {
        if (this.destroyChange) {
            this.destroyChange();
        }
    }
    onChange() {
        if (this.elem.checked) {
            this.recurrence.endRule = this.endRule;
            this.changeDetector.markForCheck();
        }
    }
    setCheckedState() {
        const isChecked = this.endRule === this.recurrence.endRule;
        this.renderer.setProperty(this.elem, 'checked', isChecked);
    }
    get elem() {
        return this.el.nativeElement;
    }
}
EndRuleRadioButtonDirective.ɵfac = function EndRuleRadioButtonDirective_Factory(t) { return new (t || EndRuleRadioButtonDirective)(ɵngcc0.ɵɵdirectiveInject(ɵngcc0.ElementRef), ɵngcc0.ɵɵdirectiveInject(ɵngcc0.Renderer2), ɵngcc0.ɵɵdirectiveInject(RecurrenceService), ɵngcc0.ɵɵdirectiveInject(ɵngcc0.ChangeDetectorRef)); };
EndRuleRadioButtonDirective.ɵdir = ɵngcc0.ɵɵdefineDirective({ type: EndRuleRadioButtonDirective, selectors: [["", "kendoRecurrenceEndRuleRadioButton", ""]], hostVars: 3, hostBindings: function EndRuleRadioButtonDirective_HostBindings(rf, ctx) { if (rf & 2) {
        ɵngcc0.ɵɵattribute("type", ctx.type);
        ɵngcc0.ɵɵclassProp("k-radio", ctx.radioClass);
    } }, inputs: { endRuleId: ["kendoRecurrenceEndRuleRadioButton", "endRuleId"] } });
/** @nocollapse */
EndRuleRadioButtonDirective.ctorParameters = () => [
    { type: ElementRef },
    { type: Renderer2 },
    { type: RecurrenceService },
    { type: ChangeDetectorRef }
];
EndRuleRadioButtonDirective.propDecorators = {
    type: [{ type: HostBinding, args: ['attr.type',] }],
    radioClass: [{ type: HostBinding, args: ['class.k-radio',] }],
    endRuleId: [{ type: Input, args: ["kendoRecurrenceEndRuleRadioButton",] }]
};
/*@__PURE__*/ (function () { ɵngcc0.ɵsetClassMetadata(EndRuleRadioButtonDirective, [{
        type: Directive,
        args: [{
                selector: '[kendoRecurrenceEndRuleRadioButton]'
            }]
    }], function () { return [{ type: ɵngcc0.ElementRef }, { type: ɵngcc0.Renderer2 }, { type: RecurrenceService }, { type: ɵngcc0.ChangeDetectorRef }]; }, { type: [{
            type: HostBinding,
            args: ['attr.type']
        }], radioClass: [{
            type: HostBinding,
            args: ['class.k-radio']
        }], endRuleId: [{
            type: Input,
            args: ["kendoRecurrenceEndRuleRadioButton"]
        }] }); })();

/**
 * @hidden
 */
class RecurrenceEndRuleEditorComponent {
    constructor(recurrence, localization) {
        this.recurrence = recurrence;
        this.localization = localization;
        this.numericOptions = {
            min: 1,
            format: '#',
            autoCorrect: true,
            step: 1,
            spinners: true
        };
        this.datePickerOptions = {
            activeView: 'month',
            bottomView: 'month',
            topView: 'century',
            disabledDatesValidation: true,
            navigation: true,
            format: 'd'
        };
        this.uniqueId = this.recurrence.getUniqueId();
        this.setInitialValues();
        this.subscribeChanges();
    }
    set userNumericOptions(options) {
        this.numericOptions = Object.assign({}, this.numericOptions, options);
    }
    set userDatePickerOptions(options) {
        this.datePickerOptions = Object.assign({}, this.datePickerOptions, options);
    }
    ngOnDestroy() {
        if (this.subscriptions) {
            this.subscriptions.unsubscribe();
        }
    }
    setEndRule(endRule) {
        if (endRule === 'count') {
            this.recurrence.rrule.count = this.countValue;
        }
        else if (endRule === 'until') {
            this.recurrence.until = this.untilValue;
        }
    }
    get rrule() {
        return this.recurrence.rrule;
    }
    get isCountDisabled() {
        return this.recurrence.endRule !== 'count';
    }
    get isUntilDisabled() {
        return this.recurrence.endRule !== 'until';
    }
    onCountChange(value) {
        if (isPresent(value)) {
            this.recurrence.count = value;
        }
    }
    onCountBlur() {
        if (!isPresent(this.countValue)) {
            this.recurrence.count = this.countValue = 1;
        }
    }
    onUntilChange(value) {
        if (isPresent(value)) {
            this.recurrence.until = this.createUntil(value);
        }
    }
    onUntilBlur() {
        if (!isPresent(this.untilValue)) {
            this.recurrence.until = this.untilValue = this.createUntil(this.recurrence.start);
        }
    }
    textFor(key) {
        return this.localization.get(key);
    }
    onEndLabelClick() {
        const selected = this.endRuleRadioButtons.toArray().find(r => r.elem.checked);
        if (selected) {
            selected.elem.focus();
        }
    }
    setInitialValues() {
        this.countValue = this.rrule.count || 1;
        const currentUntil = this.recurrence.until;
        const currentStart = this.recurrence.start;
        this.untilValue = isPresent(currentUntil) ? currentUntil : this.createUntil(currentStart);
    }
    subscribeChanges() {
        this.subscriptions = this.recurrence.endRuleChange.subscribe((endRule) => {
            this.setEndRule(endRule);
        });
        this.subscriptions.add(this.recurrence.frequencyChange.subscribe(() => {
            this.setInitialValues();
        }));
    }
    createUntil(until) {
        // Read the until date as UTC date parts to avoid interfering with the local time zone.
        const untilDate = toUTCDate(until);
        untilDate.setUTCDate(untilDate.getUTCDate() + 1);
        // Convert to the scheduler time zone.
        return ZonedDate.fromUTCDate(untilDate, this.recurrence.timezone).toLocalDate();
    }
}
RecurrenceEndRuleEditorComponent.ɵfac = function RecurrenceEndRuleEditorComponent_Factory(t) { return new (t || RecurrenceEndRuleEditorComponent)(ɵngcc0.ɵɵdirectiveInject(RecurrenceService), ɵngcc0.ɵɵdirectiveInject(ɵngcc2.LocalizationService)); };
RecurrenceEndRuleEditorComponent.ɵcmp = ɵngcc0.ɵɵdefineComponent({ type: RecurrenceEndRuleEditorComponent, selectors: [["kendo-recurrence-end-rule-editor"]], viewQuery: function RecurrenceEndRuleEditorComponent_Query(rf, ctx) { if (rf & 1) {
        ɵngcc0.ɵɵviewQuery(EndRuleRadioButtonDirective, true);
    } if (rf & 2) {
        var _t;
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.endRuleRadioButtons = _t);
    } }, inputs: { userNumericOptions: "userNumericOptions", userDatePickerOptions: "userDatePickerOptions" }, decls: 21, vars: 46, consts: [[1, "k-edit-label"], [3, "click"], [1, "k-edit-field"], [1, "k-reset"], [3, "kendoRecurrenceEndRuleRadioButton"], [1, "k-radio-label", 3, "for"], [3, "autoCorrect", "decimals", "disabled", "format", "min", "max", "readonly", "selectOnFocus", "spinners", "step", "title", "value", "valueChange", "blur"], [3, "disabled", "activeView", "bottomView", "disabledDatesValidation", "focusedDate", "format", "formatPlaceholder", "max", "min", "navigation", "placeholder", "readOnlyInput", "readonly", "title", "topView", "weekNumber", "disabledDates", "popupSettings", "value", "valueChange", "blur"]], template: function RecurrenceEndRuleEditorComponent_Template(rf, ctx) { if (rf & 1) {
        ɵngcc0.ɵɵelementStart(0, "div", 0);
        ɵngcc0.ɵɵelementStart(1, "label", 1);
        ɵngcc0.ɵɵlistener("click", function RecurrenceEndRuleEditorComponent_Template_label_click_1_listener() { return ctx.onEndLabelClick(); });
        ɵngcc0.ɵɵtext(2);
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵelementStart(3, "div", 2);
        ɵngcc0.ɵɵelementStart(4, "ul", 3);
        ɵngcc0.ɵɵelementStart(5, "li");
        ɵngcc0.ɵɵelement(6, "input", 4);
        ɵngcc0.ɵɵelementStart(7, "label", 5);
        ɵngcc0.ɵɵtext(8);
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵelementStart(9, "li");
        ɵngcc0.ɵɵelement(10, "input", 4);
        ɵngcc0.ɵɵelementStart(11, "label", 5);
        ɵngcc0.ɵɵtext(12);
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵelementStart(13, "kendo-numerictextbox", 6);
        ɵngcc0.ɵɵlistener("valueChange", function RecurrenceEndRuleEditorComponent_Template_kendo_numerictextbox_valueChange_13_listener($event) { return ctx.countValue = $event; })("blur", function RecurrenceEndRuleEditorComponent_Template_kendo_numerictextbox_blur_13_listener() { return ctx.onCountBlur(); })("valueChange", function RecurrenceEndRuleEditorComponent_Template_kendo_numerictextbox_valueChange_13_listener($event) { return ctx.onCountChange($event); });
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵelementStart(14, "span");
        ɵngcc0.ɵɵtext(15);
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵelementStart(16, "li");
        ɵngcc0.ɵɵelement(17, "input", 4);
        ɵngcc0.ɵɵelementStart(18, "label", 5);
        ɵngcc0.ɵɵtext(19);
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵelementStart(20, "kendo-datepicker", 7);
        ɵngcc0.ɵɵlistener("valueChange", function RecurrenceEndRuleEditorComponent_Template_kendo_datepicker_valueChange_20_listener($event) { return ctx.untilValue = $event; })("blur", function RecurrenceEndRuleEditorComponent_Template_kendo_datepicker_blur_20_listener() { return ctx.onUntilBlur(); })("valueChange", function RecurrenceEndRuleEditorComponent_Template_kendo_datepicker_valueChange_20_listener($event) { return ctx.onUntilChange($event); });
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵelementEnd();
    } if (rf & 2) {
        ɵngcc0.ɵɵadvance(2);
        ɵngcc0.ɵɵtextInterpolate(ctx.textFor("endLabel"));
        ɵngcc0.ɵɵadvance(4);
        ɵngcc0.ɵɵpropertyInterpolate1("kendoRecurrenceEndRuleRadioButton", "k-endrule-never-", ctx.uniqueId, "");
        ɵngcc0.ɵɵadvance(1);
        ɵngcc0.ɵɵpropertyInterpolate1("for", "k-endrule-never-", ctx.uniqueId, "");
        ɵngcc0.ɵɵadvance(1);
        ɵngcc0.ɵɵtextInterpolate(ctx.textFor("endNever"));
        ɵngcc0.ɵɵadvance(2);
        ɵngcc0.ɵɵpropertyInterpolate1("kendoRecurrenceEndRuleRadioButton", "k-endrule-count-", ctx.uniqueId, "");
        ɵngcc0.ɵɵadvance(1);
        ɵngcc0.ɵɵpropertyInterpolate1("for", "k-endrule-count-", ctx.uniqueId, "");
        ɵngcc0.ɵɵadvance(1);
        ɵngcc0.ɵɵtextInterpolate(ctx.textFor("endAfter"));
        ɵngcc0.ɵɵadvance(1);
        ɵngcc0.ɵɵstyleProp("width", 70, "px");
        ɵngcc0.ɵɵproperty("autoCorrect", ctx.numericOptions.autoCorrect)("decimals", 0)("disabled", ctx.isCountDisabled)("format", ctx.numericOptions.format)("min", ctx.numericOptions.min)("max", ctx.numericOptions.max)("readonly", ctx.numericOptions.readonly)("selectOnFocus", ctx.numericOptions.selectOnFocus)("spinners", ctx.numericOptions.spinners)("step", ctx.numericOptions.step)("title", ctx.numericOptions.title)("value", ctx.countValue);
        ɵngcc0.ɵɵadvance(2);
        ɵngcc0.ɵɵtextInterpolate(ctx.textFor("endOccurrence"));
        ɵngcc0.ɵɵadvance(2);
        ɵngcc0.ɵɵpropertyInterpolate1("kendoRecurrenceEndRuleRadioButton", "k-endrule-until-", ctx.uniqueId, "");
        ɵngcc0.ɵɵadvance(1);
        ɵngcc0.ɵɵpropertyInterpolate1("for", "k-endrule-until-", ctx.uniqueId, "");
        ɵngcc0.ɵɵadvance(1);
        ɵngcc0.ɵɵtextInterpolate(ctx.textFor("endOn"));
        ɵngcc0.ɵɵadvance(1);
        ɵngcc0.ɵɵstyleProp("width", 150, "px");
        ɵngcc0.ɵɵproperty("disabled", ctx.isUntilDisabled)("activeView", ctx.datePickerOptions.activeView)("bottomView", ctx.datePickerOptions.bottomView)("disabledDatesValidation", ctx.datePickerOptions.disabledDatesValidation)("focusedDate", ctx.datePickerOptions.focusedDate)("format", ctx.datePickerOptions.format)("formatPlaceholder", ctx.datePickerOptions.formatPlaceHolder)("max", ctx.datePickerOptions.max)("min", ctx.datePickerOptions.min)("navigation", ctx.datePickerOptions.navigation)("placeholder", ctx.datePickerOptions.placeholder)("readOnlyInput", ctx.datePickerOptions.readOnlyInput)("readonly", ctx.datePickerOptions.readonly)("title", ctx.datePickerOptions.title)("topView", ctx.datePickerOptions.topView)("weekNumber", ctx.datePickerOptions.weekNumber)("disabledDates", ctx.datePickerOptions.disabledDates)("popupSettings", ctx.datePickerOptions.popupSettings)("value", ctx.untilValue);
    } }, directives: [EndRuleRadioButtonDirective, ɵngcc11.NumericTextBoxComponent, ɵngcc7.DatePickerComponent], encapsulation: 2 });
/** @nocollapse */
RecurrenceEndRuleEditorComponent.ctorParameters = () => [
    { type: RecurrenceService },
    { type: LocalizationService }
];
RecurrenceEndRuleEditorComponent.propDecorators = {
    userNumericOptions: [{ type: Input }],
    userDatePickerOptions: [{ type: Input }],
    endRuleRadioButtons: [{ type: ViewChildren, args: [EndRuleRadioButtonDirective,] }]
};
/*@__PURE__*/ (function () { ɵngcc0.ɵsetClassMetadata(RecurrenceEndRuleEditorComponent, [{
        type: Component,
        args: [{
                selector: 'kendo-recurrence-end-rule-editor',
                template: `
        <div class='k-edit-label'>
            <label (click)="onEndLabelClick()">{{ textFor('endLabel') }}</label>
        </div>
        <div class='k-edit-field'>
            <ul class='k-reset'>
                <li>
                    <input kendoRecurrenceEndRuleRadioButton='k-endrule-never-{{uniqueId}}' />
                    <label class='k-radio-label' for='k-endrule-never-{{uniqueId}}'>{{ textFor('endNever') }}</label>
                </li>
                <li>
                    <input kendoRecurrenceEndRuleRadioButton='k-endrule-count-{{uniqueId}}' />
                    <label class='k-radio-label' for='k-endrule-count-{{uniqueId}}'>{{ textFor('endAfter') }}</label>

                    <kendo-numerictextbox
                        [style.width.px]='70'
                        [autoCorrect]='numericOptions.autoCorrect'
                        [decimals]='0'
                        [disabled]='isCountDisabled'
                        [format]="numericOptions.format"
                        [min]='numericOptions.min'
                        [max]="numericOptions.max"
                        [readonly]="numericOptions.readonly"
                        [selectOnFocus]="numericOptions.selectOnFocus"
                        [spinners]="numericOptions.spinners"
                        [step]="numericOptions.step"
                        [title]="numericOptions.title"
                        [(value)]='countValue'
                        (blur)="onCountBlur()"
                        (valueChange)='onCountChange($event)'>
                    </kendo-numerictextbox>
                    <span>{{ textFor('endOccurrence') }}</span>
                </li>
                <li>
                    <input kendoRecurrenceEndRuleRadioButton='k-endrule-until-{{uniqueId}}' />
                    <label class='k-radio-label' for='k-endrule-until-{{uniqueId}}'>{{ textFor('endOn') }}</label>

                    <kendo-datepicker
                        [style.width.px]='150'
                        [disabled]='isUntilDisabled'
                        [activeView]="datePickerOptions.activeView"
                        [bottomView]="datePickerOptions.bottomView"
                        [disabledDatesValidation]="datePickerOptions.disabledDatesValidation"
                        [focusedDate]="datePickerOptions.focusedDate"
                        [format]="datePickerOptions.format"
                        [formatPlaceholder]="datePickerOptions.formatPlaceHolder"
                        [max]="datePickerOptions.max"
                        [min]="datePickerOptions.min"
                        [navigation]="datePickerOptions.navigation"
                        [placeholder]="datePickerOptions.placeholder"
                        [readOnlyInput]="datePickerOptions.readOnlyInput"
                        [readonly]="datePickerOptions.readonly"
                        [title]="datePickerOptions.title"
                        [topView]="datePickerOptions.topView"
                        [weekNumber]="datePickerOptions.weekNumber"
                        [disabledDates]="datePickerOptions.disabledDates"
                        [popupSettings]="datePickerOptions.popupSettings"
                        [(value)]='untilValue'
                        (blur)="onUntilBlur()"
                        (valueChange)='onUntilChange($event)'>
                    </kendo-datepicker>
                </li>
            </ul>
        </div>
    `
            }]
    }], function () { return [{ type: RecurrenceService }, { type: ɵngcc2.LocalizationService }]; }, { userNumericOptions: [{
            type: Input
        }], userDatePickerOptions: [{
            type: Input
        }], endRuleRadioButtons: [{
            type: ViewChildren,
            args: [EndRuleRadioButtonDirective]
        }] }); })();

/**
 * @hidden
 */
class RecurrenceIntervalEditorComponent {
    constructor(recurrence, localization) {
        this.recurrence = recurrence;
        this.localization = localization;
        this.numericOptions = {
            min: 1,
            format: '#',
            autoCorrect: true,
            step: 1,
            spinners: true
        };
        this.intervalValue = this.recurrence.rrule.interval || 1;
    }
    set userNumericOptions(options) {
        this.numericOptions = Object.assign({}, this.numericOptions, options);
    }
    get currentFreq() {
        return this.recurrence.frequency;
    }
    onIntervalChange(newInterval) {
        if (isPresent(newInterval)) {
            this.recurrence.interval = newInterval;
        }
    }
    onIntervalBlur() {
        if (!isPresent(this.intervalValue)) {
            this.recurrence.interval = this.intervalValue = 1;
        }
    }
    textForRepeatEvery() {
        const freq = this.currentFreq;
        switch (freq) {
            case 'daily':
                return this.textFor('dailyRepeatEvery');
            case 'weekly':
                return this.textFor('weeklyRepeatEvery');
            case 'monthly':
                return this.textFor('monthlyRepeatEvery');
            case 'yearly':
                return this.textFor('yearlyRepeatEvery');
            default:
                break;
        }
    }
    textForFrequency() {
        const freq = this.currentFreq;
        switch (freq) {
            case 'daily':
                return this.textFor('dailyInterval');
            case 'weekly':
                return this.textFor('weeklyInterval');
            case 'monthly':
                return this.textFor('monthlyInterval');
            case 'yearly':
                return this.textFor('yearlyInterval');
            default:
                break;
        }
    }
    textFor(key) {
        return this.localization.get(key);
    }
}
RecurrenceIntervalEditorComponent.ɵfac = function RecurrenceIntervalEditorComponent_Factory(t) { return new (t || RecurrenceIntervalEditorComponent)(ɵngcc0.ɵɵdirectiveInject(RecurrenceService), ɵngcc0.ɵɵdirectiveInject(ɵngcc2.LocalizationService)); };
RecurrenceIntervalEditorComponent.ɵcmp = ɵngcc0.ɵɵdefineComponent({ type: RecurrenceIntervalEditorComponent, selectors: [["kendo-recurrence-interval-editor"]], inputs: { userNumericOptions: "userNumericOptions" }, decls: 8, vars: 15, consts: [[1, "k-edit-label"], [3, "click"], [1, "k-edit-field"], [3, "min", "max", "decimals", "format", "autoCorrect", "readonly", "selectOnFocus", "spinners", "step", "title", "value", "valueChange", "blur"], ["intervalNumeric", ""]], template: function RecurrenceIntervalEditorComponent_Template(rf, ctx) { if (rf & 1) {
        const _r1 = ɵngcc0.ɵɵgetCurrentView();
        ɵngcc0.ɵɵelementStart(0, "div", 0);
        ɵngcc0.ɵɵelementStart(1, "label", 1);
        ɵngcc0.ɵɵlistener("click", function RecurrenceIntervalEditorComponent_Template_label_click_1_listener() { ɵngcc0.ɵɵrestoreView(_r1); const _r0 = ɵngcc0.ɵɵreference(5); return _r0.focus(); });
        ɵngcc0.ɵɵtext(2);
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵelementStart(3, "div", 2);
        ɵngcc0.ɵɵelementStart(4, "kendo-numerictextbox", 3, 4);
        ɵngcc0.ɵɵlistener("valueChange", function RecurrenceIntervalEditorComponent_Template_kendo_numerictextbox_valueChange_4_listener($event) { return ctx.intervalValue = $event; })("blur", function RecurrenceIntervalEditorComponent_Template_kendo_numerictextbox_blur_4_listener() { return ctx.onIntervalBlur(); })("valueChange", function RecurrenceIntervalEditorComponent_Template_kendo_numerictextbox_valueChange_4_listener($event) { return ctx.onIntervalChange($event); });
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵelementStart(6, "span");
        ɵngcc0.ɵɵtext(7);
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵelementEnd();
    } if (rf & 2) {
        ɵngcc0.ɵɵadvance(2);
        ɵngcc0.ɵɵtextInterpolate(ctx.textForRepeatEvery());
        ɵngcc0.ɵɵadvance(2);
        ɵngcc0.ɵɵstyleProp("width", 70, "px");
        ɵngcc0.ɵɵproperty("min", ctx.numericOptions.min)("max", ctx.numericOptions.max)("decimals", 0)("format", ctx.numericOptions.format)("autoCorrect", ctx.numericOptions.autoCorrect)("readonly", ctx.numericOptions.readonly)("selectOnFocus", ctx.numericOptions.selectOnFocus)("spinners", ctx.numericOptions.spinners)("step", ctx.numericOptions.step)("title", ctx.numericOptions.title)("value", ctx.intervalValue);
        ɵngcc0.ɵɵadvance(3);
        ɵngcc0.ɵɵtextInterpolate(ctx.textForFrequency());
    } }, directives: [ɵngcc11.NumericTextBoxComponent], encapsulation: 2 });
/** @nocollapse */
RecurrenceIntervalEditorComponent.ctorParameters = () => [
    { type: RecurrenceService },
    { type: LocalizationService }
];
RecurrenceIntervalEditorComponent.propDecorators = {
    userNumericOptions: [{ type: Input }]
};
/*@__PURE__*/ (function () { ɵngcc0.ɵsetClassMetadata(RecurrenceIntervalEditorComponent, [{
        type: Component,
        args: [{
                selector: 'kendo-recurrence-interval-editor',
                template: `
        <div class="k-edit-label">
            <label (click)="intervalNumeric.focus()">{{ textForRepeatEvery() }}</label>
        </div>

        <div class="k-edit-field">
            <kendo-numerictextbox
                #intervalNumeric
                [style.width.px]="70"
                [min]="numericOptions.min"
                [max]="numericOptions.max"
                [decimals]="0"
                [format]="numericOptions.format"
                [autoCorrect]="numericOptions.autoCorrect"
                [readonly]="numericOptions.readonly"
                [selectOnFocus]="numericOptions.selectOnFocus"
                [spinners]="numericOptions.spinners"
                [step]="numericOptions.step"
                [title]="numericOptions.title"
                [(value)]="intervalValue"
                (blur)="onIntervalBlur()"
                (valueChange)="onIntervalChange($event)">
            </kendo-numerictextbox>

            <span>{{ textForFrequency() }}</span>
        </div>
    `
            }]
    }], function () { return [{ type: RecurrenceService }, { type: ɵngcc2.LocalizationService }]; }, { userNumericOptions: [{
            type: Input
        }] }); })();

/**
 * @hidden
 */
class RepeatOnRadioButtonDirective {
    constructor(el, renderer, recurrence, changeDetector) {
        this.el = el;
        this.renderer = renderer;
        this.recurrence = recurrence;
        this.changeDetector = changeDetector;
        this.type = 'radio';
        this.radioClass = true;
        this.destroyChange = this.renderer.listen(this.elem, 'change', this.onChange.bind(this));
    }
    /* tslint:disable-next-line:no-input-rename */
    set repeatOnRule(value) {
        const parts = value.split('-');
        this._repeatOnRule = parts[0];
        this._uniqueId = parts[1];
    }
    ngOnInit() {
        this.renderer.setAttribute(this.elem, 'id', `k-repeaton-${this._repeatOnRule}-${this._uniqueId}`);
        this.renderer.setAttribute(this.elem, 'name', `day-${this._uniqueId}`);
    }
    ngAfterContentChecked() {
        this.setCheckedState();
    }
    ngOnDestroy() {
        if (this.destroyChange) {
            this.destroyChange();
        }
    }
    onChange() {
        if (this.elem.checked) {
            this.recurrence.repeatOnRule = this._repeatOnRule;
            this.changeDetector.markForCheck();
        }
    }
    setCheckedState() {
        const isChecked = this._repeatOnRule === this.recurrence.repeatOnRule;
        this.renderer.setProperty(this.elem, 'checked', isChecked);
    }
    get elem() {
        return this.el.nativeElement;
    }
}
RepeatOnRadioButtonDirective.ɵfac = function RepeatOnRadioButtonDirective_Factory(t) { return new (t || RepeatOnRadioButtonDirective)(ɵngcc0.ɵɵdirectiveInject(ɵngcc0.ElementRef), ɵngcc0.ɵɵdirectiveInject(ɵngcc0.Renderer2), ɵngcc0.ɵɵdirectiveInject(RecurrenceService), ɵngcc0.ɵɵdirectiveInject(ɵngcc0.ChangeDetectorRef)); };
RepeatOnRadioButtonDirective.ɵdir = ɵngcc0.ɵɵdefineDirective({ type: RepeatOnRadioButtonDirective, selectors: [["", "kendoRecurrenceRepeatOnRadioButton", ""]], hostVars: 3, hostBindings: function RepeatOnRadioButtonDirective_HostBindings(rf, ctx) { if (rf & 2) {
        ɵngcc0.ɵɵattribute("type", ctx.type);
        ɵngcc0.ɵɵclassProp("k-radio", ctx.radioClass);
    } }, inputs: { repeatOnRule: ["kendoRecurrenceRepeatOnRadioButton", "repeatOnRule"] } });
/** @nocollapse */
RepeatOnRadioButtonDirective.ctorParameters = () => [
    { type: ElementRef },
    { type: Renderer2 },
    { type: RecurrenceService },
    { type: ChangeDetectorRef }
];
RepeatOnRadioButtonDirective.propDecorators = {
    type: [{ type: HostBinding, args: ['attr.type',] }],
    radioClass: [{ type: HostBinding, args: ['class.k-radio',] }],
    repeatOnRule: [{ type: Input, args: ["kendoRecurrenceRepeatOnRadioButton",] }]
};
/*@__PURE__*/ (function () { ɵngcc0.ɵsetClassMetadata(RepeatOnRadioButtonDirective, [{
        type: Directive,
        args: [{
                selector: '[kendoRecurrenceRepeatOnRadioButton]'
            }]
    }], function () { return [{ type: ɵngcc0.ElementRef }, { type: ɵngcc0.Renderer2 }, { type: RecurrenceService }, { type: ɵngcc0.ChangeDetectorRef }]; }, { type: [{
            type: HostBinding,
            args: ['attr.type']
        }], radioClass: [{
            type: HostBinding,
            args: ['class.k-radio']
        }], repeatOnRule: [{
            type: Input,
            args: ["kendoRecurrenceRepeatOnRadioButton"]
        }] }); })();

/**
 * @hidden
 */
class RecurrenceMonthlyYearlyEditorComponent {
    constructor(recurrence, localization) {
        this.recurrence = recurrence;
        this.localization = localization;
        this.uniqueId = this.recurrence.getUniqueId();
        this.numericOptions = {
            min: 1,
            max: 31,
            format: '#',
            autoCorrect: true,
            step: 1,
            spinners: true
        };
        this.setInitialValues();
        this.subscribeEventHandlers();
    }
    set userNumericOptions(options) {
        this.numericOptions = Object.assign({}, this.numericOptions, options);
    }
    setInitialValues() {
        this.extendedWeekDays = this.recurrence.extendedWeekDays;
        this.offsetPositions = this.recurrence.offsetPositions;
        this.currentOffset = this.defaultOffset;
        this.currentWeekDay = this.defaultWeekDay;
        if (this.currentFreq === 'yearly') {
            this.months = this.recurrence.months;
            this.currentMonthMonthDay = this.currentMonthWeekDay = this.recurrence.rrule.byMonth[0];
        }
    }
    subscribeEventHandlers() {
        this.subs = this.recurrence.repeatOnRuleChange.subscribe(this.onRepeatOnRuleChange.bind(this));
        this.subs.add(this.recurrence.frequencyChange.subscribe(this.onFrequencyChange.bind(this)));
    }
    onRepeatOnRuleChange(newRepeatOnRule) {
        if (newRepeatOnRule === 'monthday') {
            this.recurrence.rrule.byMonthDay = [this.monthDay];
            if (this.currentFreq === 'yearly') {
                this.recurrence.rrule.byMonth = [this.currentMonthMonthDay];
            }
        }
        else if (newRepeatOnRule === 'weekday') {
            if (typeof this.weekDay === 'string') {
                /* day, weekday or weekend */
                this.recurrence.rrule.bySetPosition = [this.offset];
                this.recurrence.rrule.byWeekDay = this.weekDayRuleFromString(this.weekDay);
            }
            else {
                /* specific weekday */
                this.recurrence.rrule.byWeekDay = [{
                        day: this.weekDay,
                        offset: this.offset
                    }];
            }
            if (this.currentFreq === 'yearly') {
                this.recurrence.rrule.byMonth = [this.currentMonthWeekDay];
            }
        }
    }
    onFrequencyChange() {
        this.setInitialValues();
    }
    ngOnDestroy() {
        if (this.subs) {
            this.subs.unsubscribe();
        }
    }
    get monthDay() {
        const rrule = this.recurrence.rrule;
        if (isPresent(rrule.byMonthDay) && rrule.byMonthDay.length > 0) {
            return rrule.byMonthDay[0];
        }
        else if (isPresent(this.currentMonthDay)) {
            return this.currentMonthDay;
        }
        else {
            return this.recurrence.start.getDate();
        }
    }
    get weekDay() {
        const rrule = this.recurrence.rrule;
        if (isPresent(rrule.byWeekDay)) {
            const weekDaysCount = rrule.byWeekDay.length;
            switch (weekDaysCount) {
                case 7:
                    return 'day';
                case 5:
                    return 'weekday';
                case 2:
                    return 'weekend';
                case 1:
                    return rrule.byWeekDay[0].day;
                default:
                    break;
            }
        }
        else if (isPresent(this.currentWeekDay)) {
            return this.currentWeekDay;
        }
        return this.defaultWeekDay;
    }
    get offset() {
        const rrule = this.recurrence.rrule;
        if (isPresent(rrule.byWeekDay)) {
            const weekDaysCount = rrule.byWeekDay.length;
            switch (weekDaysCount) {
                case 7:
                case 5:
                case 2:
                    return rrule.bySetPosition[0];
                case 1:
                    return rrule.byWeekDay[0].offset;
                default:
                    break;
            }
        }
        else if (isPresent(this.currentOffset)) {
            return this.currentOffset;
        }
        return this.defaultOffset;
    }
    onMonthChange(month, repeatOnRule) {
        if (repeatOnRule === 'monthday') {
            this.currentMonthMonthDay = month;
        }
        else {
            this.currentMonthWeekDay = month;
        }
        this.recurrence.setMonths([month]);
    }
    onMonthDayChange(monthDay) {
        this.currentMonthDay = monthDay;
        this.recurrence.monthDays = [monthDay];
    }
    onOffsetPositionChange(offset) {
        const rrule = this.recurrence.rrule;
        if (isPresent(rrule.byWeekDay)) {
            const weekDaysCount = rrule.byWeekDay.length;
            switch (weekDaysCount) {
                case 7:
                case 5:
                case 2:
                    this.recurrence.positions = [offset];
                    break;
                case 1:
                    rrule.byWeekDay[0].offset = offset;
                    this.recurrence.onChange();
                    break;
                default:
                    break;
            }
        }
        this.currentOffset = offset;
    }
    onWeekDayChange(weekDay) {
        let weekDays;
        if (typeof weekDay === 'string') {
            /* day, weekday or weekend */
            weekDays = this.weekDayRuleFromString(weekDay);
            this.recurrence.positions = [this.offset];
        }
        else {
            /* specific weekday */
            weekDays = [{
                    day: weekDay,
                    offset: this.offset
                }];
        }
        this.currentWeekDay = weekDay;
        this.recurrence.setWeekDays(weekDays);
    }
    isDisabled(repeatOn) {
        return this.recurrence.repeatOnRule !== repeatOn;
    }
    get currentFreq() {
        return this.recurrence.frequency;
    }
    get defaultOffset() {
        return 1;
    }
    get defaultWeekDay() {
        return this.recurrence.start.getDay();
    }
    weekDayRuleFromString(weekDay) {
        switch (weekDay) {
            case 'day':
                return dayRule;
            case 'weekday':
                return weekdayRule;
            case 'weekend':
                return weekendRule;
            default:
                break;
        }
        return null;
    }
    textForRepeatOn() {
        const freq = this.currentFreq;
        switch (freq) {
            case 'monthly':
                return this.textFor('monthlyRepeatOn');
            case 'yearly':
                return this.textFor('yearlyRepeatOn');
            default:
                break;
        }
    }
    textFor(key) {
        return this.localization.get(key);
    }
    onRepeatOnLabelClick() {
        const selected = this.repeatOnRadioButtons.toArray().find(r => r.elem.checked);
        if (selected) {
            selected.elem.focus();
        }
    }
}
RecurrenceMonthlyYearlyEditorComponent.ɵfac = function RecurrenceMonthlyYearlyEditorComponent_Factory(t) { return new (t || RecurrenceMonthlyYearlyEditorComponent)(ɵngcc0.ɵɵdirectiveInject(RecurrenceService), ɵngcc0.ɵɵdirectiveInject(ɵngcc2.LocalizationService)); };
RecurrenceMonthlyYearlyEditorComponent.ɵcmp = ɵngcc0.ɵɵdefineComponent({ type: RecurrenceMonthlyYearlyEditorComponent, selectors: [["kendo-recurrence-monthly-yearly-editor"]], viewQuery: function RecurrenceMonthlyYearlyEditorComponent_Query(rf, ctx) { if (rf & 1) {
        ɵngcc0.ɵɵviewQuery(RepeatOnRadioButtonDirective, true);
    } if (rf & 2) {
        var _t;
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.repeatOnRadioButtons = _t);
    } }, inputs: { userNumericOptions: "userNumericOptions" }, decls: 17, vars: 32, consts: [[1, "k-edit-label"], [3, "click"], [1, "k-edit-field"], [1, "k-reset"], [3, "kendoRecurrenceRepeatOnRadioButton"], [1, "k-radio-label", 3, "for"], [3, "ngIf"], [3, "min", "max", "decimals", "format", "autoCorrect", "readonly", "selectOnFocus", "spinners", "step", "title", "value", "disabled", "valueChange"], ["textField", "text", "valueField", "value", 3, "data", "value", "valuePrimitive", "disabled", "valueChange"]], template: function RecurrenceMonthlyYearlyEditorComponent_Template(rf, ctx) { if (rf & 1) {
        ɵngcc0.ɵɵelementStart(0, "div", 0);
        ɵngcc0.ɵɵelementStart(1, "label", 1);
        ɵngcc0.ɵɵlistener("click", function RecurrenceMonthlyYearlyEditorComponent_Template_label_click_1_listener() { return ctx.onRepeatOnLabelClick(); });
        ɵngcc0.ɵɵtext(2);
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵelementStart(3, "div", 2);
        ɵngcc0.ɵɵelementStart(4, "ul", 3);
        ɵngcc0.ɵɵelementStart(5, "li");
        ɵngcc0.ɵɵelement(6, "input", 4);
        ɵngcc0.ɵɵelementStart(7, "label", 5);
        ɵngcc0.ɵɵtemplate(8, RecurrenceMonthlyYearlyEditorComponent_ng_template_8_Template, 1, 1, "ng-template", 6);
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵtemplate(9, RecurrenceMonthlyYearlyEditorComponent_ng_template_9_Template, 1, 4, "ng-template", 6);
        ɵngcc0.ɵɵelementStart(10, "kendo-numerictextbox", 7);
        ɵngcc0.ɵɵlistener("valueChange", function RecurrenceMonthlyYearlyEditorComponent_Template_kendo_numerictextbox_valueChange_10_listener($event) { return ctx.onMonthDayChange($event); });
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵelementStart(11, "li");
        ɵngcc0.ɵɵelement(12, "input", 4);
        ɵngcc0.ɵɵelement(13, "label", 5);
        ɵngcc0.ɵɵelementStart(14, "kendo-dropdownlist", 8);
        ɵngcc0.ɵɵlistener("valueChange", function RecurrenceMonthlyYearlyEditorComponent_Template_kendo_dropdownlist_valueChange_14_listener($event) { return ctx.onOffsetPositionChange($event); });
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵelementStart(15, "kendo-dropdownlist", 8);
        ɵngcc0.ɵɵlistener("valueChange", function RecurrenceMonthlyYearlyEditorComponent_Template_kendo_dropdownlist_valueChange_15_listener($event) { return ctx.onWeekDayChange($event); });
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵtemplate(16, RecurrenceMonthlyYearlyEditorComponent_ng_template_16_Template, 3, 5, "ng-template", 6);
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵelementEnd();
    } if (rf & 2) {
        ɵngcc0.ɵɵadvance(2);
        ɵngcc0.ɵɵtextInterpolate(ctx.textForRepeatOn());
        ɵngcc0.ɵɵadvance(2);
        ɵngcc0.ɵɵstyleProp("width", 650, "px");
        ɵngcc0.ɵɵadvance(2);
        ɵngcc0.ɵɵpropertyInterpolate1("kendoRecurrenceRepeatOnRadioButton", "monthday-", ctx.uniqueId, "");
        ɵngcc0.ɵɵadvance(1);
        ɵngcc0.ɵɵpropertyInterpolate1("for", "k-repeaton-monthday-", ctx.uniqueId, "");
        ɵngcc0.ɵɵadvance(1);
        ɵngcc0.ɵɵproperty("ngIf", ctx.currentFreq === "monthly");
        ɵngcc0.ɵɵadvance(1);
        ɵngcc0.ɵɵproperty("ngIf", ctx.currentFreq === "yearly");
        ɵngcc0.ɵɵadvance(1);
        ɵngcc0.ɵɵstyleProp("width", 70, "px");
        ɵngcc0.ɵɵproperty("min", ctx.numericOptions.min)("max", ctx.numericOptions.max)("decimals", 0)("format", ctx.numericOptions.format)("autoCorrect", ctx.numericOptions.autoCorrect)("readonly", ctx.numericOptions.readonly)("selectOnFocus", ctx.numericOptions.selectOnFocus)("spinners", ctx.numericOptions.spinners)("step", ctx.numericOptions.step)("title", ctx.numericOptions.title)("value", ctx.monthDay)("disabled", ctx.isDisabled("monthday"));
        ɵngcc0.ɵɵadvance(2);
        ɵngcc0.ɵɵpropertyInterpolate1("kendoRecurrenceRepeatOnRadioButton", "weekday-", ctx.uniqueId, "");
        ɵngcc0.ɵɵadvance(1);
        ɵngcc0.ɵɵpropertyInterpolate1("for", "k-repeaton-weekday-", ctx.uniqueId, "");
        ɵngcc0.ɵɵadvance(1);
        ɵngcc0.ɵɵproperty("data", ctx.offsetPositions)("value", ctx.offset)("valuePrimitive", true)("disabled", ctx.isDisabled("weekday"));
        ɵngcc0.ɵɵadvance(1);
        ɵngcc0.ɵɵproperty("data", ctx.extendedWeekDays)("value", ctx.weekDay)("valuePrimitive", true)("disabled", ctx.isDisabled("weekday"));
        ɵngcc0.ɵɵadvance(1);
        ɵngcc0.ɵɵproperty("ngIf", ctx.currentFreq === "yearly");
    } }, directives: [RepeatOnRadioButtonDirective, ɵngcc4.NgIf, ɵngcc11.NumericTextBoxComponent, ɵngcc8.DropDownListComponent], encapsulation: 2 });
/** @nocollapse */
RecurrenceMonthlyYearlyEditorComponent.ctorParameters = () => [
    { type: RecurrenceService },
    { type: LocalizationService }
];
RecurrenceMonthlyYearlyEditorComponent.propDecorators = {
    userNumericOptions: [{ type: Input }],
    repeatOnRadioButtons: [{ type: ViewChildren, args: [RepeatOnRadioButtonDirective,] }]
};
/*@__PURE__*/ (function () { ɵngcc0.ɵsetClassMetadata(RecurrenceMonthlyYearlyEditorComponent, [{
        type: Component,
        args: [{
                selector: 'kendo-recurrence-monthly-yearly-editor',
                template: `
        <div class='k-edit-label'>
            <label (click)="onRepeatOnLabelClick()">{{ textForRepeatOn() }}</label>
        </div>
        <div class='k-edit-field'>
            <ul class='k-reset' [style.width.px]='650'>
                <li>
                    <input kendoRecurrenceRepeatOnRadioButton='monthday-{{uniqueId}}' />

                    <label class='k-radio-label' for='k-repeaton-monthday-{{uniqueId}}'>
                        <ng-template [ngIf]="currentFreq === 'monthly'">
                            {{ textFor('monthlyDay') }}
                        </ng-template>
                    </label>

                    <ng-template [ngIf]="currentFreq === 'yearly'">
                        <kendo-dropdownlist
                            [data]='months'
                            textField='text'
                            valueField='value'
                            [value]='currentMonthMonthDay'
                            [valuePrimitive]='true'
                            (valueChange)="onMonthChange($event, 'monthday')"
                            [disabled]="isDisabled('monthday')">
                        </kendo-dropdownlist>
                    </ng-template>

                    <kendo-numerictextbox
                        [style.width.px]='70'
                        [min]="numericOptions.min"
                        [max]="numericOptions.max"
                        [decimals]="0"
                        [format]="numericOptions.format"
                        [autoCorrect]="numericOptions.autoCorrect"
                        [readonly]="numericOptions.readonly"
                        [selectOnFocus]="numericOptions.selectOnFocus"
                        [spinners]="numericOptions.spinners"
                        [step]="numericOptions.step"
                        [title]="numericOptions.title"
                        [value]='monthDay'
                        (valueChange)='onMonthDayChange($event)'
                        [disabled]="isDisabled('monthday')">
                    </kendo-numerictextbox>
                </li>
                <li>
                    <input kendoRecurrenceRepeatOnRadioButton='weekday-{{uniqueId}}' />
                    <label class='k-radio-label' for='k-repeaton-weekday-{{uniqueId}}'></label>

                    <kendo-dropdownlist
                        [data]='offsetPositions'
                        textField='text'
                        valueField='value'
                        [value]='offset'
                        [valuePrimitive]='true'
                        (valueChange)='onOffsetPositionChange($event)'
                        [disabled]="isDisabled('weekday')">
                    </kendo-dropdownlist>

                    <kendo-dropdownlist
                        [data]="extendedWeekDays"
                        textField='text'
                        valueField='value'
                        [value]='weekDay'
                        [valuePrimitive]='true'
                        (valueChange)='onWeekDayChange($event)'
                        [disabled]="isDisabled('weekday')">
                    </kendo-dropdownlist>

                    <ng-template [ngIf]="currentFreq === 'yearly'">
                        <span>{{ textFor('yearlyOf') }}</span>

                        <kendo-dropdownlist
                            [data]='months'
                            textField='text'
                            valueField='value'
                            [value]='currentMonthWeekDay'
                            [valuePrimitive]='true'
                            (valueChange)="onMonthChange($event, 'weekday')"
                            [disabled]="isDisabled('weekday')">
                        </kendo-dropdownlist>
                    </ng-template>
                </li>
            </ul>
        </div>
    `
            }]
    }], function () { return [{ type: RecurrenceService }, { type: ɵngcc2.LocalizationService }]; }, { userNumericOptions: [{
            type: Input
        }], repeatOnRadioButtons: [{
            type: ViewChildren,
            args: [RepeatOnRadioButtonDirective]
        }] }); })();

/**
 * @hidden
 */
class RecurrenceWeekdayRuleEditorComponent {
    constructor(recurrence, localization) {
        this.recurrence = recurrence;
        this.localization = localization;
        this.selected = [];
        this.weekDays = this.recurrence.weekDays;
        this.setSelectedDays();
    }
    setSelectedDays() {
        for (let i = 0; i < 7; i++) {
            this.selected[i] = false;
        }
        if (isPresent(this.rrule.byWeekDay)) {
            this.rrule.byWeekDay.forEach((rule) => {
                this.selected[rule.day] = true;
            });
        }
    }
    onSelectedChange(isSelected, day) {
        this.selected[day] = isSelected;
        this.recurrence.setWeekDays(this.serializeToWeekDayRuleArray(this.selected));
    }
    isSelected(day) {
        return this.selected[day.value];
    }
    serializeToWeekDayRuleArray(arr) {
        let selectedValues = [];
        arr.forEach((isSelected, idx) => {
            if (isSelected) {
                selectedValues.push({ day: idx, offset: 0 });
            }
        });
        return selectedValues.length > 0 ? selectedValues : null;
    }
    get rrule() {
        return this.recurrence.rrule;
    }
    capitalize(day) {
        return capitalize(day);
    }
    textFor(key) {
        return this.localization.get(key);
    }
    onWeeklyRepeatOnClick() {
        const selected = this.weekDayButtons.toArray().find(r => r.selected);
        if (selected) {
            selected.focus();
        }
    }
}
RecurrenceWeekdayRuleEditorComponent.ɵfac = function RecurrenceWeekdayRuleEditorComponent_Factory(t) { return new (t || RecurrenceWeekdayRuleEditorComponent)(ɵngcc0.ɵɵdirectiveInject(RecurrenceService), ɵngcc0.ɵɵdirectiveInject(ɵngcc2.LocalizationService)); };
RecurrenceWeekdayRuleEditorComponent.ɵcmp = ɵngcc0.ɵɵdefineComponent({ type: RecurrenceWeekdayRuleEditorComponent, selectors: [["kendo-recurrence-weekday-rule-editor"]], viewQuery: function RecurrenceWeekdayRuleEditorComponent_Query(rf, ctx) { if (rf & 1) {
        ɵngcc0.ɵɵviewQuery(Button, true);
    } if (rf & 2) {
        var _t;
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.weekDayButtons = _t);
    } }, decls: 6, vars: 3, consts: [[1, "k-edit-label"], [3, "click"], [1, "k-edit-field"], [3, "selection"], ["kendoButton", "", 3, "width", "toggleable", "selected", "selectedChange", 4, "ngFor", "ngForOf"], ["kendoButton", "", 3, "toggleable", "selected", "selectedChange"]], template: function RecurrenceWeekdayRuleEditorComponent_Template(rf, ctx) { if (rf & 1) {
        ɵngcc0.ɵɵelementStart(0, "div", 0);
        ɵngcc0.ɵɵelementStart(1, "label", 1);
        ɵngcc0.ɵɵlistener("click", function RecurrenceWeekdayRuleEditorComponent_Template_label_click_1_listener() { return ctx.onWeeklyRepeatOnClick(); });
        ɵngcc0.ɵɵtext(2);
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵelementStart(3, "div", 2);
        ɵngcc0.ɵɵelementStart(4, "kendo-buttongroup", 3);
        ɵngcc0.ɵɵtemplate(5, RecurrenceWeekdayRuleEditorComponent_button_5_Template, 2, 5, "button", 4);
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵelementEnd();
    } if (rf & 2) {
        ɵngcc0.ɵɵadvance(2);
        ɵngcc0.ɵɵtextInterpolate(ctx.textFor("weeklyRepeatOn"));
        ɵngcc0.ɵɵadvance(2);
        ɵngcc0.ɵɵproperty("selection", "multiple");
        ɵngcc0.ɵɵadvance(1);
        ɵngcc0.ɵɵproperty("ngForOf", ctx.weekDays);
    } }, directives: [ɵngcc10.ButtonGroup, ɵngcc4.NgForOf, ɵngcc10.Button], encapsulation: 2 });
/** @nocollapse */
RecurrenceWeekdayRuleEditorComponent.ctorParameters = () => [
    { type: RecurrenceService },
    { type: LocalizationService }
];
RecurrenceWeekdayRuleEditorComponent.propDecorators = {
    weekDayButtons: [{ type: ViewChildren, args: [Button,] }]
};
/*@__PURE__*/ (function () { ɵngcc0.ɵsetClassMetadata(RecurrenceWeekdayRuleEditorComponent, [{
        type: Component,
        args: [{
                selector: 'kendo-recurrence-weekday-rule-editor',
                template: `
        <div class='k-edit-label'>
            <label (click)="onWeeklyRepeatOnClick()">{{ textFor('weeklyRepeatOn') }}</label>
        </div>
        <div class='k-edit-field'>
            <kendo-buttongroup [selection]="'multiple'">
                <button *ngFor='let day of weekDays' kendoButton
                        [style.width.px]="75"
                        [toggleable]="true"
                        [selected]="isSelected(day)"
                        (selectedChange)="onSelectedChange($event, day.value)"
                >{{ capitalize(day.text) }}</button>
            </kendo-buttongroup>
        </div>
    `
            }]
    }], function () { return [{ type: RecurrenceService }, { type: ɵngcc2.LocalizationService }]; }, { weekDayButtons: [{
            type: ViewChildren,
            args: [Button]
        }] }); })();

/**
 * @hidden
 */
class Messages$1 extends ComponentMessages {
}
Messages$1.ɵfac = function Messages$1_Factory(t) { return ɵMessages$1_BaseFactory(t || Messages$1); };
Messages$1.ɵdir = ɵngcc0.ɵɵdefineDirective({ type: Messages$1, inputs: { repeat: "repeat", dailyInterval: "dailyInterval", dailyRepeatEvery: "dailyRepeatEvery", weeklyInterval: "weeklyInterval", weeklyRepeatEvery: "weeklyRepeatEvery", weeklyRepeatOn: "weeklyRepeatOn", monthlyDay: "monthlyDay", monthlyInterval: "monthlyInterval", monthlyRepeatEvery: "monthlyRepeatEvery", monthlyRepeatOn: "monthlyRepeatOn", yearlyOf: "yearlyOf", yearlyRepeatEvery: "yearlyRepeatEvery", yearlyRepeatOn: "yearlyRepeatOn", yearlyInterval: "yearlyInterval", frequenciesDaily: "frequenciesDaily", frequenciesMonthly: "frequenciesMonthly", frequenciesNever: "frequenciesNever", frequenciesWeekly: "frequenciesWeekly", frequenciesYearly: "frequenciesYearly", offsetPositionsFirst: "offsetPositionsFirst", offsetPositionsSecond: "offsetPositionsSecond", offsetPositionsThird: "offsetPositionsThird", offsetPositionsFourth: "offsetPositionsFourth", offsetPositionsLast: "offsetPositionsLast", weekdaysDay: "weekdaysDay", weekdaysWeekday: "weekdaysWeekday", weekdaysWeekendday: "weekdaysWeekendday", endAfter: "endAfter", endOccurrence: "endOccurrence", endLabel: "endLabel", endNever: "endNever", endOn: "endOn" }, features: [ɵngcc0.ɵɵInheritDefinitionFeature] });
Messages$1.propDecorators = {
    repeat: [{ type: Input }],
    dailyInterval: [{ type: Input }],
    dailyRepeatEvery: [{ type: Input }],
    weeklyInterval: [{ type: Input }],
    weeklyRepeatEvery: [{ type: Input }],
    weeklyRepeatOn: [{ type: Input }],
    monthlyDay: [{ type: Input }],
    monthlyInterval: [{ type: Input }],
    monthlyRepeatEvery: [{ type: Input }],
    monthlyRepeatOn: [{ type: Input }],
    yearlyOf: [{ type: Input }],
    yearlyRepeatEvery: [{ type: Input }],
    yearlyRepeatOn: [{ type: Input }],
    yearlyInterval: [{ type: Input }],
    frequenciesDaily: [{ type: Input }],
    frequenciesMonthly: [{ type: Input }],
    frequenciesNever: [{ type: Input }],
    frequenciesWeekly: [{ type: Input }],
    frequenciesYearly: [{ type: Input }],
    offsetPositionsFirst: [{ type: Input }],
    offsetPositionsSecond: [{ type: Input }],
    offsetPositionsThird: [{ type: Input }],
    offsetPositionsFourth: [{ type: Input }],
    offsetPositionsLast: [{ type: Input }],
    weekdaysDay: [{ type: Input }],
    weekdaysWeekday: [{ type: Input }],
    weekdaysWeekendday: [{ type: Input }],
    endAfter: [{ type: Input }],
    endOccurrence: [{ type: Input }],
    endLabel: [{ type: Input }],
    endNever: [{ type: Input }],
    endOn: [{ type: Input }]
};
const ɵMessages$1_BaseFactory = ɵngcc0.ɵɵgetInheritedFactory(Messages$1);

/**
 * @hidden
 * Custom component messages override default component messages.
 */
class RecurrenceEditorCustomMessagesComponent extends Messages$1 {
    constructor(service) {
        super();
        this.service = service;
    }
    get override() {
        return true;
    }
}
RecurrenceEditorCustomMessagesComponent.ɵfac = function RecurrenceEditorCustomMessagesComponent_Factory(t) { return new (t || RecurrenceEditorCustomMessagesComponent)(ɵngcc0.ɵɵdirectiveInject(ɵngcc2.LocalizationService)); };
RecurrenceEditorCustomMessagesComponent.ɵcmp = ɵngcc0.ɵɵdefineComponent({ type: RecurrenceEditorCustomMessagesComponent, selectors: [["kendo-recurrence-editor-messages"]], features: [ɵngcc0.ɵɵProvidersFeature([
            {
                provide: Messages$1,
                useExisting: forwardRef(() => RecurrenceEditorCustomMessagesComponent) // tslint:disable-line:no-forward-ref
            }
        ]), ɵngcc0.ɵɵInheritDefinitionFeature], decls: 0, vars: 0, template: function RecurrenceEditorCustomMessagesComponent_Template(rf, ctx) { }, encapsulation: 2 });
/** @nocollapse */
RecurrenceEditorCustomMessagesComponent.ctorParameters = () => [
    { type: LocalizationService }
];
/*@__PURE__*/ (function () { ɵngcc0.ɵsetClassMetadata(RecurrenceEditorCustomMessagesComponent, [{
        type: Component,
        args: [{
                providers: [
                    {
                        provide: Messages$1,
                        useExisting: forwardRef(() => RecurrenceEditorCustomMessagesComponent) // tslint:disable-line:no-forward-ref
                    }
                ],
                selector: 'kendo-recurrence-editor-messages',
                template: ``
            }]
    }], function () { return [{ type: ɵngcc2.LocalizationService }]; }, null); })();

/**
 * @hidden
 */
class RecurrenceEditorLocalizedMessagesDirective extends Messages$1 {
    constructor(service) {
        super();
        this.service = service;
    }
}
RecurrenceEditorLocalizedMessagesDirective.ɵfac = function RecurrenceEditorLocalizedMessagesDirective_Factory(t) { return new (t || RecurrenceEditorLocalizedMessagesDirective)(ɵngcc0.ɵɵdirectiveInject(ɵngcc2.LocalizationService)); };
RecurrenceEditorLocalizedMessagesDirective.ɵdir = ɵngcc0.ɵɵdefineDirective({ type: RecurrenceEditorLocalizedMessagesDirective, selectors: [["", "kendoRecurrenceEditorLocalizedMessages", ""]], features: [ɵngcc0.ɵɵProvidersFeature([
            {
                provide: Messages$1,
                useExisting: forwardRef(() => RecurrenceEditorLocalizedMessagesDirective) // tslint:disable-line:no-forward-ref
            }
        ]), ɵngcc0.ɵɵInheritDefinitionFeature] });
/** @nocollapse */
RecurrenceEditorLocalizedMessagesDirective.ctorParameters = () => [
    { type: LocalizationService }
];
/*@__PURE__*/ (function () { ɵngcc0.ɵsetClassMetadata(RecurrenceEditorLocalizedMessagesDirective, [{
        type: Directive,
        args: [{
                providers: [
                    {
                        provide: Messages$1,
                        useExisting: forwardRef(() => RecurrenceEditorLocalizedMessagesDirective) // tslint:disable-line:no-forward-ref
                    }
                ],
                selector: '[kendoRecurrenceEditorLocalizedMessages]'
            }]
    }], function () { return [{ type: ɵngcc2.LocalizationService }]; }, null); })();

/* tslint:disable: no-use-before-declare */
/* tslint:disable: no-forward-ref */
/**
 * @hidden
 */
const TIME_ZONE_VALUE_ACCESSOR = {
    multi: true,
    provide: NG_VALUE_ACCESSOR,
    useExisting: forwardRef(() => TimeZoneEditorComponent)
};
/**
 * Represents the Kendo UI TimeZone Editor component for Angular.
 * `TimeZoneEditorComponent` displays the currently loaded timezones.
 * Used for editing the `start` and `end` timezones of the `SchedulerEvent` objects.
 */
class TimeZoneEditorComponent {
    constructor() {
        /**
         * Specifies the width of the ComboBox which contains the names of the timezones.
         */
        this.width = 260;
        /**
         * Fires when the value of the component has changed.
         */
        this.valueChange = new EventEmitter();
        this.onTouchedCallback = (_) => { };
        this.onChangeCallback = (_) => { };
        this.tzNames = timezoneNames();
        this.tzSource = this.tzNames.slice();
    }
    /**
     * @hidden
     */
    onTimeZoneChange(tzName) {
        this.tz = tzName;
        this.onChangeCallback(this.tz);
        this.valueChange.emit(tzName);
    }
    /**
     * @hidden
     */
    onTimeZoneFilterChange(value) {
        this.tzSource = this.tzNames.filter((tz) => tz.toLowerCase().indexOf(value.toLowerCase()) !== -1);
    }
    /**
     * @hidden
     */
    writeValue(value) {
        if (typeof value === 'string' && this.tzNames.indexOf(value) >= 0) {
            this.tz = value;
        }
    }
    /**
     * @hidden
     */
    focus() {
        this.tzComboBox.focus();
    }
    /**
     * @hidden
     */
    registerOnChange(fn) {
        this.onChangeCallback = fn;
    }
    /**
     * @hidden
     */
    registerOnTouched(fn) {
        this.onTouchedCallback = fn;
    }
}
TimeZoneEditorComponent.ɵfac = function TimeZoneEditorComponent_Factory(t) { return new (t || TimeZoneEditorComponent)(); };
TimeZoneEditorComponent.ɵcmp = ɵngcc0.ɵɵdefineComponent({ type: TimeZoneEditorComponent, selectors: [["kendo-timezone-editor"]], viewQuery: function TimeZoneEditorComponent_Query(rf, ctx) { if (rf & 1) {
        ɵngcc0.ɵɵviewQuery(_c258, true);
    } if (rf & 2) {
        var _t;
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.tzComboBox = _t.first);
    } }, inputs: { width: "width" }, outputs: { valueChange: "valueChange" }, features: [ɵngcc0.ɵɵProvidersFeature([
            TIME_ZONE_VALUE_ACCESSOR
        ])], decls: 2, vars: 7, consts: [[3, "allowCustom", "data", "filterable", "suggest", "value", "filterChange", "valueChange"], ["tzcombobox", ""]], template: function TimeZoneEditorComponent_Template(rf, ctx) { if (rf & 1) {
        ɵngcc0.ɵɵelementStart(0, "kendo-combobox", 0, 1);
        ɵngcc0.ɵɵlistener("filterChange", function TimeZoneEditorComponent_Template_kendo_combobox_filterChange_0_listener($event) { return ctx.onTimeZoneFilterChange($event); })("valueChange", function TimeZoneEditorComponent_Template_kendo_combobox_valueChange_0_listener($event) { return ctx.onTimeZoneChange($event); });
        ɵngcc0.ɵɵelementEnd();
    } if (rf & 2) {
        ɵngcc0.ɵɵstyleProp("width", ctx.width, "px");
        ɵngcc0.ɵɵproperty("allowCustom", false)("data", ctx.tzSource)("filterable", true)("suggest", true)("value", ctx.tz);
    } }, directives: [ɵngcc8.ComboBoxComponent], encapsulation: 2 });
/** @nocollapse */
TimeZoneEditorComponent.ctorParameters = () => [];
TimeZoneEditorComponent.propDecorators = {
    tzComboBox: [{ type: ViewChild, args: ['tzcombobox',] }],
    width: [{ type: Input }],
    valueChange: [{ type: Output }]
};
/*@__PURE__*/ (function () { ɵngcc0.ɵsetClassMetadata(TimeZoneEditorComponent, [{
        type: Component,
        args: [{
                providers: [
                    TIME_ZONE_VALUE_ACCESSOR
                ],
                selector: 'kendo-timezone-editor',
                template: `
        <kendo-combobox
            #tzcombobox
            [style.width.px]="width"
            [allowCustom]="false"
            [data]="tzSource"
            [filterable]="true"
            [suggest]="true"
            [value]="tz"
            (filterChange)="onTimeZoneFilterChange($event)"
            (valueChange)="onTimeZoneChange($event)">
        </kendo-combobox>
    `
            }]
    }], function () { return []; }, { width: [{
            type: Input
        }], valueChange: [{
            type: Output
        }], tzComboBox: [{
            type: ViewChild,
            args: ['tzcombobox']
        }] }); })();

const isContentWrapper = element => hasClasses(element, 'k-scheduler-content');
/**
 * @hidden
 */
class ShortcutsDirective {
    constructor(scheduler, domEvents, focusService, zone, changeDetector, viewState, dialogsService) {
        this.scheduler = scheduler;
        this.domEvents = domEvents;
        this.focusService = focusService;
        this.zone = zone;
        this.changeDetector = changeDetector;
        this.viewState = viewState;
        this.dialogsService = dialogsService;
        this.shortcuts = [{
                match: e => e.keyCode === Keys.KeyC && noModifiers(e),
                action: e => {
                    const scheduler = this.scheduler;
                    const hours = new Date().getHours();
                    const selected = scheduler.selectedDate;
                    const start = new Date(selected.getFullYear(), selected.getMonth(), selected.getDate(), hours + 1);
                    const end = new Date(selected.getFullYear(), selected.getMonth(), selected.getDate(), hours + 2);
                    let firstResource;
                    if (scheduler.group) {
                        const resources = scheduler.resources || [];
                        const group = scheduler.group || {};
                        const grouped = groupResources(group, resources);
                        if (grouped.length > 0) {
                            firstResource = grouped[0].data[0];
                        }
                    }
                    scheduler.create.emit({
                        start: ZonedDate.fromLocalDate(start, scheduler.timezone).toLocalDate(),
                        end: ZonedDate.fromLocalDate(end, scheduler.timezone).toLocalDate(),
                        isAllDay: false,
                        resources: [firstResource],
                        originalEvent: e,
                        sender: scheduler
                    });
                }
            }, {
                match: e => e.keyCode >= Keys.Digit1 && e.keyCode <= Keys.Digit9 && withModifiers(e, Modifiers.AltKey),
                action: e => {
                    const scheduler = this.scheduler;
                    const viewIndex = e.keyCode - Keys.Digit0 - 1;
                    const views = scheduler.views.toArray();
                    const view = views[viewIndex];
                    if (view) {
                        this.zone.run(() => {
                            const prevented = scheduler.onNavigationAction({ type: 'view-change', view });
                            if (!prevented) {
                                this.changeDetector.markForCheck();
                                this.focusWait();
                            }
                        });
                    }
                }
            }, {
                match: e => e.keyCode === Keys.KeyT && noModifiers(e),
                action: () => {
                    this.zone.run(() => {
                        this.scheduler.onNavigationAction({ type: 'today' });
                        this.focusWait();
                    });
                }
            }, {
                // tslint:disable-next-line:deprecation
                match: (e) => (e.keyCode === Keys.ArrowLeft || e.keyCode === Keys.ArrowRight) && withModifiers(e, Modifiers.ShiftKey),
                action: (e) => {
                    // tslint:disable-next-line:deprecation
                    const type = e.keyCode === Keys.ArrowLeft ? 'prev' : 'next';
                    this.zone.run(() => {
                        this.scheduler.onNavigationAction({ type });
                        this.focusWait();
                    });
                }
            }, {
                // tslint:disable-next-line:deprecation
                match: e => (e.keyCode === Keys.ArrowUp || e.keyCode === Keys.ArrowLeft) && noModifiers(e) && !isContentWrapper(e.target),
                action: e => {
                    const prevented = this.scheduler.onNavigationAction({ type: 'focus-prev' });
                    if (!prevented) {
                        this.focusService.focusNext({ offset: -1 });
                        e.preventDefault();
                    }
                }
            }, {
                // tslint:disable-next-line:deprecation
                match: e => (e.keyCode === Keys.ArrowDown || e.keyCode === Keys.ArrowRight) && noModifiers(e) && !isContentWrapper(e.target),
                action: e => {
                    const prevented = this.scheduler.onNavigationAction({ type: 'focus-next' });
                    if (!prevented) {
                        this.focusService.focusNext({ offset: 1 });
                        e.preventDefault();
                    }
                }
            }];
        this.taskShortcuts = [{
                match: e => (e.keyCode === Keys.Delete || e.keyCode === Keys.Backspace) && noModifiers(e),
                action: (e, event) => {
                    this.viewState.emitEvent('remove', { event: event, dataItem: event.dataItem });
                    e.preventDefault();
                }
            }, {
                match: e => e.keyCode === Keys.Enter && noModifiers(e),
                action: (e, event) => {
                    this.viewState.emitEvent('eventDblClick', { type: 'dblclick', event: event, originalEvent: e });
                    e.preventDefault();
                }
            }];
        this.subs = new Subscription();
        this.subs.add(this.domEvents.keydown.subscribe(e => this.onKeydown(e)));
        this.subs.add(this.scheduler.eventKeydown.subscribe(e => this.onEventKeydown(e)));
    }
    onKeydown(e) {
        const match = this.shortcuts.find(shortcut => shortcut.match(e));
        if (match && !this.dialogsService.isOpen) {
            match.action(e);
        }
    }
    onEventKeydown(e) {
        const match = this.taskShortcuts.find(shortcut => shortcut.match(e.originalEvent));
        if (match && !this.dialogsService.isOpen) {
            match.action(e.originalEvent, e.event);
        }
    }
    focusWait() {
        this.viewState.layoutEnd.pipe(take(1)).subscribe(() => this.focusService.focus());
    }
}
ShortcutsDirective.ɵfac = function ShortcutsDirective_Factory(t) { return new (t || ShortcutsDirective)(ɵngcc0.ɵɵdirectiveInject(SchedulerComponent), ɵngcc0.ɵɵdirectiveInject(DomEventsService), ɵngcc0.ɵɵdirectiveInject(FocusService), ɵngcc0.ɵɵdirectiveInject(ɵngcc0.NgZone), ɵngcc0.ɵɵdirectiveInject(ɵngcc0.ChangeDetectorRef), ɵngcc0.ɵɵdirectiveInject(ViewStateService), ɵngcc0.ɵɵdirectiveInject(DialogsService)); };
ShortcutsDirective.ɵdir = ɵngcc0.ɵɵdefineDirective({ type: ShortcutsDirective, selectors: [["kendo-scheduler"]] });
/** @nocollapse */
ShortcutsDirective.ctorParameters = () => [
    { type: SchedulerComponent },
    { type: DomEventsService },
    { type: FocusService },
    { type: NgZone },
    { type: ChangeDetectorRef },
    { type: ViewStateService },
    { type: DialogsService }
];
/*@__PURE__*/ (function () { ɵngcc0.ɵsetClassMetadata(ShortcutsDirective, [{
        type: Directive,
        args: [{
                // tslint:disable-next-line:directive-selector
                selector: 'kendo-scheduler'
            }]
    }], function () { return [{ type: SchedulerComponent }, { type: DomEventsService }, { type: FocusService }, { type: ɵngcc0.NgZone }, { type: ɵngcc0.ChangeDetectorRef }, { type: ViewStateService }, { type: DialogsService }]; }, null); })();

const TEMPLATES = [
    AgendaDateTemplateDirective,
    AgendaTimeTemplateDirective,
    AllDayEventTemplateDirective,
    AllDaySlotTemplateDirective,
    DateHeaderTemplateDirective,
    EventTemplateDirective,
    EditDialogTemplateDirective,
    GroupHeaderTemplateDirective,
    MajorTimeHeaderTemplateDirective,
    MinorTimeHeaderTemplateDirective,
    MonthDaySlotTemplateDirective,
    TimeSlotTemplateDirective
];
const declarations = [
    SchedulerComponent,
    SchedulerViewDirective,
    DataBindingDirective,
    ShortcutsDirective,
    ReactiveEditingDirective,
    SchedulerDateTimePickerComponent,
    RecurrenceEditorComponent,
    RecurrenceEndRuleEditorComponent,
    RecurrenceFrequencyEditorComponent,
    RecurrenceIntervalEditorComponent,
    RecurrenceMonthlyYearlyEditorComponent,
    RecurrenceWeekdayRuleEditorComponent,
    EndRuleRadioButtonDirective,
    RepeatOnRadioButtonDirective,
    MultipleResourceEditorComponent,
    SingleResourceEditorComponent,
    TimeZoneEditorComponent,
    EditDialogComponent,
    SchedulerCustomMessagesComponent,
    LocalizedMessagesDirective,
    RecurrenceEditorCustomMessagesComponent,
    RecurrenceEditorLocalizedMessagesDirective,
    LoadingComponent,
    ...TEMPLATES
];
const publicDirectives$1 = [
    AgendaViewComponent,
    MonthViewModule,
    MultiDayViewModule,
    ReactiveEditingDirective,
    TimelineViewModule,
    publicDirectives,
    ...declarations
];
const importedKendoModules = [
    ButtonsModule,
    DateInputsModule,
    DialogModule,
    NumericTextBoxModule,
    TextBoxModule,
    DropDownsModule,
    ReactiveFormsModule,
    SharedModule
];
/**
 * Represents the [NgModule]({{ site.data.urls.angular['ngmoduleapi'] }})
 * definition for the Scheduler component.
 *
 * @example
 * ```ts-no-run
 * import { BrowserModule } from '@angular/platform-browser';
 * import { NgModule } from '@angular/core';
 *
 * // Import the Scheduler module
 * import { SchedulerModule } from '@progress/kendo-angular-scheduler';
 *
 * import { AppComponent } from './app.component';
 *
 * _@NgModule({
 *     declarations: [
 *         AppComponent
 *     ],
 *     imports: [
 *         BrowserModule,
 *
 *         // Import the Scheduler module
 *         SchedulerModule
 *     ],
 *     bootstrap: [
 *         AppComponent
 *     ]
 * })
 * export class AppModule { }
 * ```
 */
class SchedulerModule {
}
SchedulerModule.ɵmod = ɵngcc0.ɵɵdefineNgModule({ type: SchedulerModule });
SchedulerModule.ɵinj = ɵngcc0.ɵɵdefineInjector({ factory: function SchedulerModule_Factory(t) { return new (t || SchedulerModule)(); }, providers: [{
            provide: IntlService,
            useClass: CldrIntlService
        }], imports: [[
            CommonModule,
            ToolbarModule,
            AgendaViewModule,
            MultiDayViewModule,
            ResizeSensorModule,
            MonthViewModule,
            TimelineViewModule,
            ...importedKendoModules
        ],
        MonthViewModule,
        MultiDayViewModule,
        TimelineViewModule] });
(function () { (typeof ngJitMode === "undefined" || ngJitMode) && ɵngcc0.ɵɵsetNgModuleScope(SchedulerModule, { declarations: function () { return [SchedulerComponent,
        SchedulerViewDirective,
        DataBindingDirective,
        ShortcutsDirective,
        ReactiveEditingDirective,
        SchedulerDateTimePickerComponent,
        RecurrenceEditorComponent,
        RecurrenceEndRuleEditorComponent,
        RecurrenceFrequencyEditorComponent,
        RecurrenceIntervalEditorComponent,
        RecurrenceMonthlyYearlyEditorComponent,
        RecurrenceWeekdayRuleEditorComponent,
        EndRuleRadioButtonDirective,
        RepeatOnRadioButtonDirective,
        MultipleResourceEditorComponent,
        SingleResourceEditorComponent,
        TimeZoneEditorComponent,
        EditDialogComponent,
        SchedulerCustomMessagesComponent,
        LocalizedMessagesDirective,
        RecurrenceEditorCustomMessagesComponent,
        RecurrenceEditorLocalizedMessagesDirective,
        LoadingComponent,
        AgendaDateTemplateDirective,
        AgendaTimeTemplateDirective,
        AllDayEventTemplateDirective,
        AllDaySlotTemplateDirective,
        DateHeaderTemplateDirective,
        EventTemplateDirective,
        EditDialogTemplateDirective,
        GroupHeaderTemplateDirective,
        MajorTimeHeaderTemplateDirective,
        MinorTimeHeaderTemplateDirective,
        MonthDaySlotTemplateDirective,
        TimeSlotTemplateDirective]; }, imports: function () { return [CommonModule,
        ToolbarModule,
        AgendaViewModule,
        MultiDayViewModule,
        ResizeSensorModule,
        MonthViewModule,
        TimelineViewModule,
        ButtonsModule,
        DateInputsModule,
        DialogModule,
        NumericTextBoxModule,
        TextBoxModule,
        DropDownsModule,
        ReactiveFormsModule,
        SharedModule]; }, exports: function () { return [AgendaViewComponent,
        MonthViewModule,
        MultiDayViewModule,
        ReactiveEditingDirective,
        TimelineViewModule,
        ToolbarNavigationComponent,
        ToolbarTemplateDirective,
        ToolbarViewSelectorComponent,
        SchedulerComponent,
        SchedulerViewDirective,
        DataBindingDirective,
        ShortcutsDirective,
        ReactiveEditingDirective,
        SchedulerDateTimePickerComponent,
        RecurrenceEditorComponent,
        RecurrenceEndRuleEditorComponent,
        RecurrenceFrequencyEditorComponent,
        RecurrenceIntervalEditorComponent,
        RecurrenceMonthlyYearlyEditorComponent,
        RecurrenceWeekdayRuleEditorComponent,
        EndRuleRadioButtonDirective,
        RepeatOnRadioButtonDirective,
        MultipleResourceEditorComponent,
        SingleResourceEditorComponent,
        TimeZoneEditorComponent,
        EditDialogComponent,
        SchedulerCustomMessagesComponent,
        LocalizedMessagesDirective,
        RecurrenceEditorCustomMessagesComponent,
        RecurrenceEditorLocalizedMessagesDirective,
        LoadingComponent,
        AgendaDateTemplateDirective,
        AgendaTimeTemplateDirective,
        AllDayEventTemplateDirective,
        AllDaySlotTemplateDirective,
        DateHeaderTemplateDirective,
        EventTemplateDirective,
        EditDialogTemplateDirective,
        GroupHeaderTemplateDirective,
        MajorTimeHeaderTemplateDirective,
        MinorTimeHeaderTemplateDirective,
        MonthDaySlotTemplateDirective,
        TimeSlotTemplateDirective]; } }); })();
/*@__PURE__*/ (function () { ɵngcc0.ɵsetClassMetadata(SchedulerModule, [{
        type: NgModule,
        args: [{
                imports: [
                    CommonModule,
                    ToolbarModule,
                    AgendaViewModule,
                    MultiDayViewModule,
                    ResizeSensorModule,
                    MonthViewModule,
                    TimelineViewModule,
                    ...importedKendoModules
                ],
                declarations: declarations,
                exports: publicDirectives$1,
                providers: [{
                        provide: IntlService,
                        useClass: CldrIntlService
                    }]
            }]
    }], null, null); })();

const DATE_FORMATS = [
    "yyyyMMddTHHmmssSSSXXX",
    "yyyyMMddTHHmmssXXX",
    "yyyyMMddTHHmmss",
    "yyyyMMddTHHmm",
    "yyyyMMddTHH",
    "yyyyMMdd"
];
/**
 * A base implementation of the [edit service]({% slug api_scheduler_editservice %}) which persists data to traditional CRUD services such as OData.
 *
 * To support custom models, the `BaseEditService` class requires a [field map]({% slug api_scheduler_schedulermodelfields %}) as a constructor parameter. Subclasses require you to
 * implement the `read` operation, which is not called directly by the base class, and the [`save`]({% slug api_scheduler_baseeditservice %}#toc-save) method which persists the created,
 * updated, and deleted entities.
 *
 * The [`events`](#toc-events) observable will publish the current data which is set upon subscription by using, for example, an [async pipe](https://angular.io/api/common/AsyncPipe)
 * ([more information]({% slug editing_directives_scheduler %}#toc-custom-service)).
 *
 * Implementations which utilize dedicated services, such as Google Calendar and Microsoft Exchange, will typically implement the
 * [`EditService`]({% slug api_scheduler_editservice %}) of the Scheduler directly.
 *
 * {% meta height:700 %}
 * {% embed_file editing/editing-directives/reactive-editing-service/app.component.ts preview %}
 * {% embed_file editing/editing-directives/reactive-editing-service/app.module.ts %}
 * {% embed_file shared/edit.service.ts %}
 * {% embed_file shared/my-event.interface.ts %}
 * {% embed_file shared/main.ts %}
 * {% endmeta %}
 */
class BaseEditService {
    /**
     * Initializes the base edit service.
     *
     * @param fields - A field map that will be used for reading and modifying model objects. Defaults to the [`SchedulerEvent`]({% slug api_scheduler_schedulerevent %}) fields.
     */
    constructor(fields) {
        /**
         * An array of the currently loaded events which is populated by the derived class.
         */
        this.data = [];
        /**
         * The source subject for the `events` observable.
         */
        this.source = new BehaviorSubject([]);
        this.createdItems = [];
        this.updatedItems = [];
        this.deletedItems = [];
        this.events = this.source.asObservable();
        this.fields = Object.assign({}, defaultModelFields, fields);
        this.getId = getter(this.fields.id);
        this.getRecurrenceId = getter(this.fields.recurrenceId);
        this.getRecurrenceRule = getter(this.fields.recurrenceRule);
        this.getRecurrenceExceptions = getter(this.fields.recurrenceExceptions);
        this.getStart = getter(this.fields.start);
        this.setId = setter(this.fields.id);
        this.setRecurrenceRule = setter(this.fields.recurrenceRule);
        this.setRecurrenceExceptions = setter(this.fields.recurrenceExceptions);
        this.setRecurrenceId = setter(this.fields.recurrenceId);
    }
    create(event) {
        this.logCreate(event);
        this.saveChanges();
    }
    /*
     * Creates an exception to a recurring series.
     *
     * The `createException` method performs the following operations:
     * * Adds the start date of the event to the `recurrenceExceptions` of the master event (recurrence head).
     * * Creates a new event that stores the recurrence exception itself.
     */
    createException(event, value) {
        const exception = this.buildException(value);
        this.logRemoveOccurrence(event);
        this.logCreate(exception);
        this.saveChanges();
    }
    update(event, value) {
        this.assignValues(event, value);
        this.logUpdate(event);
        this.saveChanges();
    }
    remove(event) {
        this.logRemove(event);
        this.saveChanges();
    }
    removeSeries(event) {
        const id = this.getId(event);
        const recurrenceId = this.getRecurrenceId(event);
        const isHead = this.isRecurrenceHead(event);
        this.removeItemAndExceptions(isHead ? id : recurrenceId);
        this.saveChanges();
    }
    removeOccurrence(event) {
        this.logRemoveOccurrence(event);
        this.saveChanges();
    }
    findRecurrenceMaster(event) {
        const id = this.getId(event);
        const recurrenceId = this.getRecurrenceId(event);
        const headId = this.isRecurrenceHead(event) ? id : recurrenceId;
        const index = this.itemIndex(headId, this.data);
        return this.data[index];
    }
    isRecurring(event) {
        return isRecurring(event, this.fields);
    }
    isException(event) {
        return isException(event, this.fields);
    }
    /**
     * Returns a Boolean value which indicates if the event is new.
     * If the `ID` field is defined, the default implementation returns `true`.
     * Can be overridden to implement different conditions.
     *
     * @param event - The event that will be checked.
     */
    isNew(event) {
        const id = this.getId(event);
        return !isPresent(id);
    }
    /**
     * Returns the next `ID` that will be used for new events.
     * The default implementation returns `undefined`.
     */
    nextId() {
        return undefined;
    }
    /**
     * Copies values to the target model instance.
     * To copy the top-level fields, the base implementation uses
     * [`Object.assign`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/assign).
     * To copy nested fields, override `assignValues` and handle the model-specific cases.
     *
     * @param target - The target object that will receive the field values.
     * @param source - The source object from which the fields will be read.
     */
    assignValues(target, source) {
        cloneTo(source, target);
    }
    /**
     * Clones an existing model object.
     * To copy the top-level model fields, the base creates an empty object and calls [`assignValues`](#toc-assignvalues).
     * To create models of the correct type, override `cloneEvent`.
     *
     * @param event - The model instance to copy.
     * @returns TEvent - The new model instance.
     */
    cloneEvent(event) {
        const result = {};
        this.assignValues(result, event);
        return result;
    }
    /**
     * A utility method which parses recurrence exception dates in an ISO format.
     *
     * @example
     * ```ts-no-run
     *   const exdates = '20180614T060000Z;20180615T060000Z';
     *   const result = super.parseExceptions(exdates);
     *
     *   // console.log(result);
     *   // Array [ Date 2018-06-14T03:00:00.000Z, Date 2018-06-15T03:00:00.000Z ]
     * ```
     *
     * @param value - A comma-separated list of ISO-formatted dates.
     * @returns Date[] - The recurrence exceptions as local dates.
     */
    parseExceptions(value) {
        if (!isPresent(value) || value === '') {
            return [];
        }
        return value
            .split(';')
            .map(ex => parseDate(ex, DATE_FORMATS) || undefined);
    }
    /**
     * A utility method which serializes recurrence exception dates in an ISO format.
     *
     * @example
     * ```ts-no-run
     *   const exdates = [ new Date(2018, 5, 14, 3, 0, 0), new Date(2018, 5, 15, 3, 0, 0) ];
     *   const result = super.serializeExceptions(exdates);
     *
     *   // console.log(result);
     *   // '20180614T060000Z;20180615T060000Z'
     * ```
     *
     * @param value - An array of `Date` instances.
     * @returns string - A comma-separated list of ISO-formatted dates.
     */
    serializeExceptions(exceptions) {
        if (!exceptions || exceptions.length === 0) {
            return '';
        }
        return exceptions.map(date => formatDate(toLocalDate(date), 'yyyyMMddTHHmmss') + 'Z').join(';');
    }
    reset() {
        this.data = [];
        this.deletedItems = [];
        this.updatedItems = [];
        this.createdItems = [];
    }
    itemIndex(id, items) {
        for (let idx = 0; idx < items.length; idx++) {
            if (this.getId(items[idx]) === id) {
                return idx;
            }
        }
        return -1;
    }
    buildException(item) {
        const fields = this.fields;
        const head = this.findRecurrenceMaster(item);
        const copy = this.cloneEvent(item);
        assignField(copy, head, fields.id);
        this.setId(copy, this.nextId());
        this.setRecurrenceRule(copy, undefined);
        this.setRecurrenceId(copy, this.getId(head));
        return copy;
    }
    isRecurrenceHead(item) {
        const id = this.getId(item);
        const recurrenceRule = this.getRecurrenceRule(item);
        return !!(id && recurrenceRule);
    }
    logCreate(item) {
        this.data = [...this.data, item];
        this.source.next(this.data);
        this.createdItems.push(item);
    }
    logUpdate(item) {
        const id = this.getId(item);
        if (!this.isNew(item)) {
            const index = this.itemIndex(id, this.updatedItems);
            if (index !== -1) {
                this.updatedItems.splice(index, 1, item);
            }
            else {
                this.updatedItems.push(item);
            }
        }
        else {
            const index = this.createdItems.indexOf(item);
            this.createdItems.splice(index, 1, item);
        }
    }
    logRemove(item) {
        const id = this.getId(item);
        let index = this.itemIndex(id, this.data);
        this.data = this.data.filter((_, i) => i !== index);
        this.source.next(this.data);
        index = this.itemIndex(id, this.createdItems);
        if (index >= 0) {
            this.createdItems.splice(index, 1);
        }
        else {
            this.deletedItems.push(item);
        }
        index = this.itemIndex(id, this.updatedItems);
        if (index >= 0) {
            this.updatedItems.splice(index, 1);
        }
    }
    logRemoveOccurrence(event) {
        const head = this.findRecurrenceMaster(event);
        const exceptionDate = this.getStart(event);
        const currentExceptions = this.getRecurrenceExceptions(head) || [];
        this.setRecurrenceExceptions(head, [...currentExceptions, exceptionDate]);
        this.logUpdate(head);
    }
    removeItemAndExceptions(itemId) {
        this.deletedItems = this.deletedItems.concat(this.data.filter(ev => this.getRecurrenceId(ev) === itemId || this.getId(ev) === itemId));
    }
    hasChanges() {
        return this.deletedItems.length + this.updatedItems.length + this.createdItems.length > 0;
    }
    saveChanges() {
        if (!this.hasChanges()) {
            return;
        }
        this.save(this.createdItems, this.updatedItems, this.deletedItems);
        this.reset();
    }
}

const createElement = (tagName, className) => {
    const element = document.createElement(tagName);
    if (className) {
        element.className = className;
    }
    return element;
};
const createDiv = (className) => createElement('div', className);
/**
 * Configures the settings for the export of Scheduler in PDF ([see example]({% slug pdfexport_scheduler %})).
 */
class PDFComponent {
    constructor(pdfService, ngZone) {
        this.pdfService = pdfService;
        this.ngZone = ngZone;
        /**
         * The creator of the PDF document.
         * Defaults to `Kendo UI PDF Generator`.
         */
        this.creator = 'Kendo UI PDF Generator';
        this.subscriptions = this.pdfService.elementReady.subscribe(this.createElement.bind(this));
        this.saveDataUri = this.saveDataUri.bind(this);
        this.exportGroup = this.exportGroup.bind(this);
        this.done = this.done.bind(this);
    }
    ngOnDestroy() {
        this.subscriptions.unsubscribe();
    }
    get drawOptions() {
        return {
            _destructive: true,
            avoidLinks: this.avoidLinks,
            margin: this.margin,
            scale: this.scale
        };
    }
    get pdfOptions() {
        return {
            author: this.author,
            creator: this.creator,
            date: this.date,
            imgDPI: this.imageResolution,
            keywords: this.keywords,
            margin: this.margin,
            producer: this.producer,
            subject: this.subject,
            title: this.title
        };
    }
    get saveOptions() {
        return {
            forceProxy: this.forceProxy,
            proxyData: this.proxyData,
            proxyTarget: this.proxyTarget,
            proxyURL: this.proxyURL
        };
    }
    createElement(args) {
        this.ngZone.runOutsideAngular(() => {
            const container = this.container = createDiv();
            container.style.top = container.style.left = '-10000px';
            container.style.position = 'absolute';
            const wrapper = createDiv('k-widget k-scheduler k-floatwrap');
            wrapper.style.position = 'relative';
            wrapper.appendChild(args.element);
            container.appendChild(wrapper);
            document.body.appendChild(container);
            this.save(wrapper);
        });
    }
    save(element) {
        this.drawElement(element, this.drawOptions)
            .then(this.exportGroup)
            .then(this.saveDataUri)
            .then(this.done, this.done);
    }
    drawElement(element, options) {
        return drawDOM(element, options);
    }
    exportGroup(group) {
        return exportPDF(group, this.pdfOptions);
    }
    saveDataUri(dataUri) {
        saveAs(dataUri, this.fileName, this.saveOptions);
    }
    done() {
        if (this.container) {
            document.body.removeChild(this.container);
            this.container = null;
        }
        this.pdfService.done.emit();
    }
}
PDFComponent.ɵfac = function PDFComponent_Factory(t) { return new (t || PDFComponent)(ɵngcc0.ɵɵdirectiveInject(PDFService), ɵngcc0.ɵɵdirectiveInject(ɵngcc0.NgZone)); };
PDFComponent.ɵcmp = ɵngcc0.ɵɵdefineComponent({ type: PDFComponent, selectors: [["kendo-scheduler-pdf"]], inputs: { creator: "creator", author: "author", avoidLinks: "avoidLinks", date: "date", imageResolution: "imageResolution", fileName: "fileName", forceProxy: "forceProxy", keywords: "keywords", margin: "margin", scale: "scale", proxyData: "proxyData", proxyURL: "proxyURL", proxyTarget: "proxyTarget", producer: "producer", subject: "subject", title: "title" }, decls: 0, vars: 0, template: function PDFComponent_Template(rf, ctx) { }, encapsulation: 2 });
/** @nocollapse */
PDFComponent.ctorParameters = () => [
    { type: PDFService },
    { type: NgZone }
];
PDFComponent.propDecorators = {
    author: [{ type: Input }],
    avoidLinks: [{ type: Input }],
    creator: [{ type: Input }],
    date: [{ type: Input }],
    imageResolution: [{ type: Input }],
    fileName: [{ type: Input }],
    forceProxy: [{ type: Input }],
    keywords: [{ type: Input }],
    margin: [{ type: Input }],
    scale: [{ type: Input }],
    proxyData: [{ type: Input }],
    proxyURL: [{ type: Input }],
    proxyTarget: [{ type: Input }],
    producer: [{ type: Input }],
    subject: [{ type: Input }],
    title: [{ type: Input }]
};
/*@__PURE__*/ (function () { ɵngcc0.ɵsetClassMetadata(PDFComponent, [{
        type: Component,
        args: [{
                selector: 'kendo-scheduler-pdf',
                template: ''
            }]
    }], function () { return [{ type: PDFService }, { type: ɵngcc0.NgZone }]; }, { creator: [{
            type: Input
        }], author: [{
            type: Input
        }], avoidLinks: [{
            type: Input
        }], date: [{
            type: Input
        }], imageResolution: [{
            type: Input
        }], fileName: [{
            type: Input
        }], forceProxy: [{
            type: Input
        }], keywords: [{
            type: Input
        }], margin: [{
            type: Input
        }], scale: [{
            type: Input
        }], proxyData: [{
            type: Input
        }], proxyURL: [{
            type: Input
        }], proxyTarget: [{
            type: Input
        }], producer: [{
            type: Input
        }], subject: [{
            type: Input
        }], title: [{
            type: Input
        }] }); })();

/**
 * Represents the `export-to-PDF` command of the Scheduler.
 * You can apply this directive to any `button` element inside a
 * [`ToolbarTemplate`]({% slug toolbar_scheduler %}).
 * When the user clicks a button that is associated with the directive, the
 * [`pdfExport`]({% slug api_scheduler_schedulercomponent %}#toc-pdfexport) event
 * fires ([see example]({% slug pdfexport_scheduler %})).
 *
 * @example
 * ```html-no-run
 * <kendo-scheduler>
 *      <ng-template kendoSchedulerToolbarTemplate>
 *          <button kendoSchedulerPDFCommand>Export PDF</button>
 *          <ul kendoSchedulerToolbarNavigation></ul>
 *          <ul kendoSchedulerToolbarViewSelector></ul>
 *      </ng-template>
 *      <kendo-scheduler-pdf fileName="Scheduler.pdf">
 *      </kendo-scheduler-pdf>
 * </kendo-scheduler>
 * ```
 */
class PDFCommandDirective extends Button {
    constructor(pdfService, element, renderer, localization, ngZone) {
        super(element, renderer, null, localization, ngZone);
        this.pdfService = pdfService;
    }
    /**
     * @hidden
     */
    onClick(e) {
        e.preventDefault();
        this.pdfService.exportClick.emit();
    }
    ngOnInit() {
        this.icon = 'pdf';
    }
}
PDFCommandDirective.ɵfac = function PDFCommandDirective_Factory(t) { return new (t || PDFCommandDirective)(ɵngcc0.ɵɵdirectiveInject(PDFService), ɵngcc0.ɵɵdirectiveInject(ɵngcc0.ElementRef), ɵngcc0.ɵɵdirectiveInject(ɵngcc0.Renderer2), ɵngcc0.ɵɵdirectiveInject(ɵngcc2.LocalizationService), ɵngcc0.ɵɵdirectiveInject(ɵngcc0.NgZone)); };
PDFCommandDirective.ɵdir = ɵngcc0.ɵɵdefineDirective({ type: PDFCommandDirective, selectors: [["", "kendoSchedulerPDFCommand", ""]], hostBindings: function PDFCommandDirective_HostBindings(rf, ctx) { if (rf & 1) {
        ɵngcc0.ɵɵlistener("click", function PDFCommandDirective_click_HostBindingHandler($event) { return ctx.onClick($event); });
    } }, features: [ɵngcc0.ɵɵInheritDefinitionFeature] });
/** @nocollapse */
PDFCommandDirective.ctorParameters = () => [
    { type: PDFService },
    { type: ElementRef },
    { type: Renderer2 },
    { type: LocalizationService },
    { type: NgZone }
];
PDFCommandDirective.propDecorators = {
    onClick: [{ type: HostListener, args: ['click', ['$event'],] }]
};
/*@__PURE__*/ (function () { ɵngcc0.ɵsetClassMetadata(PDFCommandDirective, [{
        type: Directive,
        args: [{
                selector: '[kendoSchedulerPDFCommand]'
            }]
    }], function () { return [{ type: PDFService }, { type: ɵngcc0.ElementRef }, { type: ɵngcc0.Renderer2 }, { type: ɵngcc2.LocalizationService }, { type: ɵngcc0.NgZone }]; }, { onClick: [{
            type: HostListener,
            args: ['click', ['$event']]
        }] }); })();

const declarations$1 = [
    PDFComponent,
    PDFCommandDirective
];
/**
 * Represents the [NgModule](https://angular.io/api/core/NgModule)
 * definition for the Scheduler PDF component.
 *
 * @example
 *
 * ```ts-no-run
 * // Import the Scheduler and PDF modules
 * import { SchedulerModule, PDFModule } from '@progress/kendo-angular-scheduler';
 *
 * // The browser platform with a compiler
 * import { platformBrowserDynamic } from '@angular/platform-browser-dynamic';
 *
 * import { NgModule } from '@angular/core';
 *
 * // Import the app component
 * import { AppComponent } from './app.component';
 *
 * // Define the app module
 * _@NgModule({
 *     declarations: [AppComponent], // declare app component
 *     imports:      [BrowserModule, SchedulerModule, PDFModule], // import Scheduler and PDF modules
 *     bootstrap:    [AppComponent]
 * })
 * export class AppModule {}
 *
 * // Compile and launch the module
 * platformBrowserDynamic().bootstrapModule(AppModule);
 *
 * ```
 */
class PDFModule {
}
PDFModule.ɵmod = ɵngcc0.ɵɵdefineNgModule({ type: PDFModule });
PDFModule.ɵinj = ɵngcc0.ɵɵdefineInjector({ factory: function PDFModule_Factory(t) { return new (t || PDFModule)(); } });
(function () { (typeof ngJitMode === "undefined" || ngJitMode) && ɵngcc0.ɵɵsetNgModuleScope(PDFModule, { declarations: [PDFComponent,
        PDFCommandDirective], exports: [PDFComponent,
        PDFCommandDirective] }); })();
/*@__PURE__*/ (function () { ɵngcc0.ɵsetClassMetadata(PDFModule, [{
        type: NgModule,
        args: [{
                declarations: [declarations$1],
                exports: [declarations$1]
            }]
    }], null, null); })();

/**
 * Generated bundle index. Do not edit.
 */

export { DataBindingDirective, EditingDirectiveBase, ReactiveEditingDirective, SCHEDULER_DATETIMEPICKER_VALUE_ACCESSOR, SchedulerDateTimePickerComponent, DialogsService, EditDialogTemplateDirective, EditDialogComponent, EditService, LocalDataChangesService, EndRuleRadioButtonDirective, RecurrenceEditorCustomMessagesComponent, RecurrenceEditorLocalizedMessagesDirective, Messages$1 as Messages, RecurrenceLocalizationService, RECURRENCE_VALUE_ACCESSOR, RecurrenceEndRuleEditorComponent, RecurrenceFrequencyEditorComponent, RecurrenceIntervalEditorComponent, RecurrenceMonthlyYearlyEditorComponent, RecurrenceWeekdayRuleEditorComponent, RecurrenceService, RepeatOnRadioButtonDirective, ResourceEditorBase, MULTIPLE_RESOURCE_VALUE_ACCESSOR, MultipleResourceEditorComponent, SINGLE_RESOURCE_VALUE_ACCESSOR, SingleResourceEditorComponent, TIME_ZONE_VALUE_ACCESSOR, TimeZoneEditorComponent, CreateEvent, PreventableEvent$1 as PreventableEvent, LoadingComponent, SchedulerCustomMessagesComponent, LocalizedMessagesDirective, Messages as Messages$1, SchedulerLocalizationService, FocusService, ShortcutsDirective, ToolbarNavigationComponent, ToolbarTemplateDirective, ToolbarComponent, ToolbarModule, publicDirectives, ToolbarViewSelectorComponent, AgendaHeaderItemComponent, AgendaHeaderComponent, AgendaTaskItemComponent, AgendaViewInternalComponent, AgendaListComponent, AgendaViewModule, BaseView, ConfigurationViewBase, DomEventsService, HintContainerComponent, RepeatPipe, ResizeHintComponent, ResourceIteratorPipe, ViewFooterComponent, ViewsSharedModule, WorkHoursFooterDirective, DayTimeSlotService, DayTimeViewBase, DayTimeViewItemComponent, DayTimeViewComponent, DayTimeModule, DaySlotDirective, TimeSlotDirective, MonthSlotDirective, MonthSlotService, MonthViewItemComponent, MonthViewRendererComponent, MonthViewComponent, MonthViewModule, MultiDayViewBase, MultiDayViewRendererComponent, MultiDayViewComponent, MultiDayViewModule, WorkWeekViewComponent, SchedulerViewDirective, AgendaDateTemplateDirective, AgendaTimeTemplateDirective, AllDayEventTemplateDirective, AllDaySlotTemplateDirective, DateHeaderTemplateDirective, EventTemplateDirective, GroupHeaderTemplateDirective, MajorTimeHeaderTemplateDirective, MinorTimeHeaderTemplateDirective, MonthDaySlotTemplateDirective, TimeSlotTemplateDirective, TimelineBase, TimelineMonthViewComponent, TimelineMultiDayViewComponent, TimelineViewComponent, TimelineViewModule, TimelineWeekViewComponent, BaseSlotDirective, BaseSlotService, BaseViewItem, SchedulerComponent, SchedulerModule, ViewContextService, ViewStateService, ToolbarService, AgendaViewComponent, DayViewComponent, WeekViewComponent, RecurrenceEditorComponent, BaseEditService, PDFModule, PDFComponent, PDFService, PDFCommandDirective, PDFExportEvent, FocusableDirective, SharedModule, SchedulerView, DateChangeEvent, NavigateEvent, SlotClickEvent, EventClickEvent, EventKeydownEvent, VIEW_EVENT_MAP, CancelEvent, EditEventBase, RemoveEvent, SaveEvent, ResizeStartEvent, ResizeEvent, ResizeEndEvent, DragStartEvent, DragEvent, DragEndEvent, EditEvent, AddEvent };

//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VzIjpbImluZGV4LmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7cUpBS0U7QUFDRjtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7a0NBQUU7QUFDRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OzBHQUdFO0FBQ0Y7QUFDQTs7O2dEQUF5QztBQUN6QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OzhKQUtFO0FBQ0Y7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7O2tDQUFFO0FBQ0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7OEpBS0U7QUFDRjtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7a0NBQUU7QUFDRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7aUtBS0U7QUFDRjtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7a0NBQUU7QUFDRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7OEpBS0U7QUFDRjtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7a0NBQUU7QUFDRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7OEpBS0U7QUFDRjtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7a0NBQUU7QUFDRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7K0lBS0U7QUFDRjtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7a0NBQUU7QUFDRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7aUtBS0U7QUFDRjtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7a0NBQUU7QUFDRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OzZLQUtFO0FBQ0Y7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7O2tDQUFFO0FBQ0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs2S0FLRTtBQUNGO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7OztrQ0FBRTtBQUNGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztvS0FLRTtBQUNGO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7OztrQ0FBRTtBQUNGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7d0pBS0U7QUFDRjtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7a0NBQUU7QUFDRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7c0hBR0U7QUFDRjtBQUNBOzs7Z0RBQTZDO0FBQzdDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O2dIQUdFO0FBQ0Y7QUFDQTs7O2dEQUEyQztBQUMzQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O2lHQUdFO0FBQ0Y7QUFDQTtBQUNBO0FBQ0E7Ozt1RUFBRTtBQUNGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O29OQUtFO0FBQ0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7b0JBQUU7QUFDRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7O2dEQUdFO0FBQ0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Z0RBR0U7QUFDRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7b0dBR0U7QUFDRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7OERBQUU7QUFDRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7MEdBR0U7QUFDRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7NE1BQUU7QUFDRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O29KQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUU7QUFDRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7OztnREFHRTtBQUNGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7NkJBVUU7QUFDRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7Ozs7Ozs7OztvQkFBRTtBQUNGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7d01BS0U7QUFDRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7OztvQkFBRTtBQUNGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O3NRQWtTRTtBQUNGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O29CQUFFO0FBQ0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7MExBS0U7QUFDRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7O29CQUFFO0FBQ0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzt3d0hBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7cUVBQUU7QUFDRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7OztrS0FZRTtBQUNGO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7O29GQUFFO0FBQ0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7a0RBV0U7QUFDRjtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7O29GQUFFO0FBQ0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OzRKQXdERTtBQUNGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O29CQUFFO0FBQ0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7OzhEQWtCRTtBQUNGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7b0JBQUU7QUFDRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7OEhBb0JFO0FBQ0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O29CQUFFO0FBQ0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OzBCQWtCRTtBQUNGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7OztpTEFBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBRTtBQUNGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7Ozs7OztvSEEwQkU7QUFDRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztvQkFBRTtBQUNGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7OytIQWlCRTtBQUNGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7b0JBQUU7QUFDRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7K0VBcUJFO0FBQ0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O29CQUFFO0FBQ0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztxR0F3QkU7QUFDRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7b0JBQUU7QUFDRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7Ozs7O2lGQTBDRTtBQUNGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztvQkFBRTtBQUNGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OzZFQStCRTtBQUNGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7b0JBQUU7QUFDRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7OzswQkFVRTtBQUNGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7Ozs7Ozs7OzBCQU9FO0FBQ0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O3FGQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7NFBBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUU7QUFDRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztpRkErQkU7QUFDRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O2tDQUFFO0FBQ0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7O21IQTBCRTtBQUNGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7b0JBQUU7QUFDRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7O29FQVNFO0FBQ0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7Ozs7b0JBQUU7QUFDRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozt5VkFBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFFO0FBQ0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OzsySkF3SEU7QUFDRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztvQkFBRTtBQUNGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7OztpQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQUU7QUFDRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztnTUFNRTtBQUNGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7O29CQUFFO0FBQ0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7MkVBZ0JFO0FBQ0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O29CQUFFO0FBQ0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O2lPQUtFO0FBQ0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7b0JBQUU7QUFDRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7OzBCQU1FO0FBQ0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7OzswQkFNRTtBQUNGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7Ozs7OztrRkFhRTtBQUNGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O29CQUFFO0FBQ0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7MEJBY0U7QUFDRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7MEJBZ0JFO0FBQ0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7O2thQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBRTtBQUNGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs4SkFBQztBQUNEO0FBQ0E7QUFDQTtBQUFFO0FBQ0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OEVBNkNFO0FBQ0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztvQkFBRTtBQUNGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs4RUErQ0U7QUFDRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztvQkFBRTtBQUNGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OEVBK0NFO0FBQ0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7b0JBQUU7QUFDRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7OEVBaURFO0FBQ0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Z05BQUU7QUFDRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozt5RkFBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7OztxbUJBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBRTtBQUNGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs2SUE2T0U7QUFDRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O29CQUFFO0FBQ0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7O2dTQU9FO0FBQ0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7b0JBQUU7QUFDRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7a0dBTUU7QUFDRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7OztvQkFBRTtBQUNGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O2lGQTZDRTtBQUNGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O29CQUFFO0FBQ0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OzBCQVdFO0FBQ0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7MEJBZUU7QUFDRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozt1REFVRTtBQUNGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7Ozs7Ozs7O29CQUFFO0FBQ0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztzRkFnS0U7QUFDRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7b0JBQUU7QUFDRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7NEpBQUM7QUFDRDtBQUNBO0FBQ0E7QUFBRTtBQUNGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7OzsyRUF5Q0U7QUFDRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O29CQUFFO0FBQ0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7OzJFQTRDRTtBQUNGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztvQkFBRTtBQUNGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7OzsyRUE2Q0U7QUFDRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztvQkFBRTtBQUNGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7MEJBZUU7QUFDRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7b0tBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUU7QUFDRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O3VSQUtFO0FBQ0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7b0JBQUU7QUFDRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs0SkFBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQUU7QUFDRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7Ozs7Ozs7O2dLQThCRTtBQUNGO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7b0JBQUU7QUFDRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7Ozs7OztvSUF5QkU7QUFDRjtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztvQkFBRTtBQUNGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7Ozs7Ozt3RkF1SUU7QUFDRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7b0JBQUU7QUFDRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7Ozs7Ozs7OztnSEFtQkU7QUFDRjtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7b0JBQUU7QUFDRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7bUhBR0U7QUFDRjtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7a0hBQUU7QUFDRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7dUpBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFFO0FBQ0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztrRUErSUU7QUFDRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztvQkFBRTtBQUNGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Z0dBb0JFO0FBQ0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O29CQUFFO0FBQ0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7c0ZBS0U7QUFDRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7Ozs7OztvQkFBRTtBQUNGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztxSUFzRUU7QUFDRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O29CQUFFO0FBQ0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OzRFQWdDRTtBQUNGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O29CQUFFO0FBQ0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7OzZGQUtFO0FBQ0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7Ozs7b0JBQUU7QUFDRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7cUpBMEZFO0FBQ0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7b0JBQUU7QUFDRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O2dHQW9CRTtBQUNGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztvQkFBRTtBQUNGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7d3RDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7eUVBQUU7QUFDRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7O3lLQVlFO0FBQ0Y7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7Ozs7b0ZBQUU7QUFDRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7OztrREFXRTtBQUNGO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7b0ZBQUU7QUFDRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7Ozs7Ozs7cUVBcUJFO0FBQ0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O29CQUFFO0FBQ0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O21IQU1FO0FBQ0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7bVBBQUU7QUFDRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OzswQkFvQkU7QUFDRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7aWpCQU1FO0FBQ0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O29CQUFFO0FBQ0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7OzswREFLRTtBQUNGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7OztvQkFBRTtBQUNGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7OzswQkFNRTtBQUNGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsInNvdXJjZXNDb250ZW50IjpbIi8qKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4qIENvcHlyaWdodCDCqSAyMDIwIFByb2dyZXNzIFNvZnR3YXJlIENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuKiBMaWNlbnNlZCB1bmRlciBjb21tZXJjaWFsIGxpY2Vuc2UuIFNlZSBMSUNFTlNFLm1kIGluIHRoZSBwcm9qZWN0IHJvb3QgZm9yIG1vcmUgaW5mb3JtYXRpb25cbiotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cbmltcG9ydCB7IERpcmVjdGl2ZSwgVGVtcGxhdGVSZWYsIE9wdGlvbmFsLCBJbmplY3RhYmxlLCBFdmVudEVtaXR0ZXIsIE5nWm9uZSwgSW5wdXQsIFJlbmRlcmVyMiwgRWxlbWVudFJlZiwgQ2hhbmdlRGV0ZWN0b3JSZWYsIEluamVjdCwgaXNEZXZNb2RlLCBDb21wb25lbnQsIEhvc3RCaW5kaW5nLCBDaGFuZ2VEZXRlY3Rpb25TdHJhdGVneSwgVmlld0VuY2Fwc3VsYXRpb24sIE91dHB1dCwgQ29udGVudENoaWxkLCBDb250ZW50Q2hpbGRyZW4sIFZpZXdDaGlsZCwgVmlld0NvbnRhaW5lclJlZiwgZm9yd2FyZFJlZiwgTmdNb2R1bGUsIExPQ0FMRV9JRCwgUGlwZSwgVmlld0NoaWxkcmVuLCBIb3N0TGlzdGVuZXIgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7IExvY2FsaXphdGlvblNlcnZpY2UsIEwxME5fUFJFRklYLCBNZXNzYWdlU2VydmljZSwgUlRMLCBDb21wb25lbnRNZXNzYWdlcyB9IGZyb20gJ0Bwcm9ncmVzcy9rZW5kby1hbmd1bGFyLWwxMG4nO1xuaW1wb3J0IHsgaGFzT2JzZXJ2ZXJzLCBpc0RvY3VtZW50QXZhaWxhYmxlLCBpc0NoYW5nZWQsIGFueUNoYW5nZWQsIFJlc2l6ZVNlbnNvckNvbXBvbmVudCwgRXZlbnRzTW9kdWxlLCBndWlkLCBLZXlzLCBSZXNpemVTZW5zb3JNb2R1bGUgfSBmcm9tICdAcHJvZ3Jlc3Mva2VuZG8tYW5ndWxhci1jb21tb24nO1xuaW1wb3J0IHsgZ2V0RGF0ZSwgRGF5LCBab25lZERhdGUsIGlzRXF1YWxEYXRlLCB0b0xvY2FsRGF0ZSwgTVNfUEVSX0RBWSwgYWRkRGF5cywgZmlyc3REYXlPZk1vbnRoLCBhZGRNb250aHMsIGZpcnN0RGF5SW5XZWVrLCB0aW1lem9uZU5hbWVzIH0gZnJvbSAnQHByb2dyZXNzL2tlbmRvLWRhdGUtbWF0aCc7XG5pbXBvcnQgeyBQcmV2ZW50YWJsZUV2ZW50LCBDYWxlbmRhck1vZHVsZSwgRGF0ZUlucHV0c01vZHVsZSB9IGZyb20gJ0Bwcm9ncmVzcy9rZW5kby1hbmd1bGFyLWRhdGVpbnB1dHMnO1xuaW1wb3J0IHsgU3ViamVjdCwgQmVoYXZpb3JTdWJqZWN0LCBmcm9tRXZlbnQsIFN1YnNjcmlwdGlvbiwgY29tYmluZUxhdGVzdCwgbWVyZ2UgfSBmcm9tICdyeGpzJztcbmltcG9ydCB7IGJ1ZmZlciwgZmlsdGVyLCBtYXAsIGF1ZGl0VGltZSwgZGVib3VuY2VUaW1lLCB0YWtlLCBzd2l0Y2hNYXAsIHRhcCB9IGZyb20gJ3J4anMvb3BlcmF0b3JzJztcbmltcG9ydCB7IEZvcm1Db250cm9sLCBGb3JtR3JvdXAsIE5HX1ZBTFVFX0FDQ0VTU09SLCBSZWFjdGl2ZUZvcm1zTW9kdWxlIH0gZnJvbSAnQGFuZ3VsYXIvZm9ybXMnO1xuaW1wb3J0IHsgRGlhbG9nQ2xvc2VSZXN1bHQsIERpYWxvZ1NlcnZpY2UsIERpYWxvZ01vZHVsZSB9IGZyb20gJ0Bwcm9ncmVzcy9rZW5kby1hbmd1bGFyLWRpYWxvZyc7XG5pbXBvcnQgeyBJbnRsU2VydmljZSwgZm9ybWF0RGF0ZSwgSW50bE1vZHVsZSwgQ2xkckludGxTZXJ2aWNlLCBwYXJzZURhdGUgfSBmcm9tICdAcHJvZ3Jlc3Mva2VuZG8tYW5ndWxhci1pbnRsJztcbmltcG9ydCB7IENvbW1vbk1vZHVsZSB9IGZyb20gJ0Bhbmd1bGFyL2NvbW1vbic7XG5pbXBvcnQgeyBwYXJzZVJ1bGUsIGV4cGFuZCwgc2VyaWFsaXplUnVsZSB9IGZyb20gJ0Bwcm9ncmVzcy9rZW5kby1yZWN1cnJlbmNlJztcbmltcG9ydCB7IFBvcHVwU2VydmljZSwgUG9wdXBNb2R1bGUgfSBmcm9tICdAcHJvZ3Jlc3Mva2VuZG8tYW5ndWxhci1wb3B1cCc7XG5pbXBvcnQgeyBvcmRlckJ5LCBncm91cEJ5IH0gZnJvbSAnQHByb2dyZXNzL2tlbmRvLWRhdGEtcXVlcnknO1xuaW1wb3J0IERyYWdnYWJsZSBmcm9tICdAdGVsZXJpay9rZW5kby1kcmFnZ2FibGUnO1xuaW1wb3J0IHsgRHJvcERvd25zTW9kdWxlIH0gZnJvbSAnQHByb2dyZXNzL2tlbmRvLWFuZ3VsYXItZHJvcGRvd25zJztcbmltcG9ydCB7IEJ1dHRvbiwgQnV0dG9uc01vZHVsZSB9IGZyb20gJ0Bwcm9ncmVzcy9rZW5kby1hbmd1bGFyLWJ1dHRvbnMnO1xuaW1wb3J0IHsgTnVtZXJpY1RleHRCb3hNb2R1bGUsIFRleHRCb3hNb2R1bGUgfSBmcm9tICdAcHJvZ3Jlc3Mva2VuZG8tYW5ndWxhci1pbnB1dHMnO1xuaW1wb3J0IHsgZHJhd0RPTSwgZXhwb3J0UERGIH0gZnJvbSAnQHByb2dyZXNzL2tlbmRvLWRyYXdpbmcnO1xuaW1wb3J0IHsgc2F2ZUFzIH0gZnJvbSAnQHByb2dyZXNzL2tlbmRvLWZpbGUtc2F2ZXInO1xuXG4vKipcbiAqIEFyZ3VtZW50cyBmb3IgdGhlIGBkYXRlQ2hhbmdlYCBldmVudC5cbiAqL1xuY2xhc3MgRGF0ZUNoYW5nZUV2ZW50IHtcbiAgICAvKipcbiAgICAgKiBAaGlkZGVuXG4gICAgICovXG4gICAgY29uc3RydWN0b3Ioc2VuZGVyLCBzZWxlY3RlZERhdGUsIGRhdGVSYW5nZSkge1xuICAgICAgICB0aGlzLnNlbmRlciA9IHNlbmRlcjtcbiAgICAgICAgdGhpcy5zZWxlY3RlZERhdGUgPSBzZWxlY3RlZERhdGU7XG4gICAgICAgIHRoaXMuZGF0ZVJhbmdlID0gZGF0ZVJhbmdlO1xuICAgIH1cbn1cblxuLyoqXG4gKiBBcmd1bWVudHMgZm9yIHRoZSBgbmF2aWdhdGVgIGV2ZW50LlxuICovXG5jbGFzcyBOYXZpZ2F0ZUV2ZW50IGV4dGVuZHMgUHJldmVudGFibGVFdmVudCB7XG4gICAgLyoqXG4gICAgICogQGhpZGRlblxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKHNlbmRlciwgYWN0aW9uKSB7XG4gICAgICAgIHN1cGVyKCk7XG4gICAgICAgIHRoaXMuc2VuZGVyID0gc2VuZGVyO1xuICAgICAgICB0aGlzLmFjdGlvbiA9IGFjdGlvbjtcbiAgICB9XG59XG5cbi8qKlxuICogQXJndW1lbnRzIGZvciBgc2xvdENsaWNrYCBhbmQgYHNsb3REYmxDbGlja2AgZXZlbnRzLlxuICovXG5jbGFzcyBTbG90Q2xpY2tFdmVudCB7XG4gICAgLyoqXG4gICAgICogQGhpZGRlblxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKHNlbmRlciwgYXJncykge1xuICAgICAgICB0aGlzLnNlbmRlciA9IHNlbmRlcjtcbiAgICAgICAgT2JqZWN0LmFzc2lnbih0aGlzLCBhcmdzKTtcbiAgICB9XG59XG5cbi8qKlxuICogQXJndW1lbnRzIGZvciB0aGUgYGV2ZW50Q2xpY2tgIGFuZCBgZXZlbnREYmxDbGlja2AgZXZlbnRzLlxuICovXG5jbGFzcyBFdmVudENsaWNrRXZlbnQge1xuICAgIC8qKlxuICAgICAqIEBoaWRkZW5cbiAgICAgKi9cbiAgICBjb25zdHJ1Y3RvcihzZW5kZXIsIGFyZ3MpIHtcbiAgICAgICAgdGhpcy5zZW5kZXIgPSBzZW5kZXI7XG4gICAgICAgIE9iamVjdC5hc3NpZ24odGhpcywgYXJncyk7XG4gICAgfVxufVxuXG4vKipcbiAqIEFyZ3VtZW50cyBmb3IgdGhlIGBldmVudEtleWRvd25gIGV2ZW50LlxuICovXG5jbGFzcyBFdmVudEtleWRvd25FdmVudCB7XG4gICAgLyoqXG4gICAgICogQGhpZGRlblxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKHNlbmRlciwgYXJncykge1xuICAgICAgICB0aGlzLnNlbmRlciA9IHNlbmRlcjtcbiAgICAgICAgT2JqZWN0LmFzc2lnbih0aGlzLCBhcmdzKTtcbiAgICB9XG59XG5cbi8qKlxuICogQXJndW1lbnRzIGZvciB0aGUgYGNyZWF0ZWAgZXZlbnQuXG4gKi9cbmNsYXNzIENyZWF0ZUV2ZW50IHtcbiAgICAvKipcbiAgICAgKiBAaGlkZGVuXG4gICAgICovXG4gICAgY29uc3RydWN0b3Ioc2VuZGVyLCBhcmdzKSB7XG4gICAgICAgIHRoaXMuc2VuZGVyID0gc2VuZGVyO1xuICAgICAgICBPYmplY3QuYXNzaWduKHRoaXMsIGFyZ3MpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBAaGlkZGVuXG4gKi9cbmNsYXNzIFByZXZlbnRhYmxlRXZlbnQkMSB7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHRoaXMucHJldmVudGVkID0gZmFsc2U7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFByZXZlbnRzIHRoZSBkZWZhdWx0IGFjdGlvbiBmb3IgYSBzcGVjaWZpZWQgZXZlbnQuXG4gICAgICogSW4gdGhpcyB3YXksIHRoZSBzb3VyY2UgY29tcG9uZW50IHN1cHByZXNzZXNcbiAgICAgKiB0aGUgYnVpbHQtaW4gYmVoYXZpb3IgdGhhdCBmb2xsb3dzIHRoZSBldmVudC5cbiAgICAgKi9cbiAgICBwcmV2ZW50RGVmYXVsdCgpIHtcbiAgICAgICAgdGhpcy5wcmV2ZW50ZWQgPSB0cnVlO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIGB0cnVlYCBpZiB0aGUgZXZlbnQgd2FzIHByZXZlbnRlZFxuICAgICAqIGJ5IGFueSBvZiBpdHMgc3Vic2NyaWJlcnMuXG4gICAgICpcbiAgICAgKiBAcmV0dXJucyBgdHJ1ZWAgaWYgdGhlIGRlZmF1bHQgYWN0aW9uIHdhcyBwcmV2ZW50ZWQuXG4gICAgICogT3RoZXJ3aXNlLCByZXR1cm5zIGBmYWxzZWAuXG4gICAgICovXG4gICAgaXNEZWZhdWx0UHJldmVudGVkKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcmV2ZW50ZWQ7XG4gICAgfVxufVxuXG4vKipcbiAqIEFyZ3VtZW50cyBmb3IgdGhlIGBkcmFnRW5kYCBldmVudC5cbiAqL1xuY2xhc3MgRHJhZ0VuZEV2ZW50IGV4dGVuZHMgUHJldmVudGFibGVFdmVudCQxIHtcbiAgICAvKipcbiAgICAgKiBAaGlkZGVuXG4gICAgICovXG4gICAgY29uc3RydWN0b3Ioc2VuZGVyLCBhcmdzKSB7XG4gICAgICAgIHN1cGVyKCk7XG4gICAgICAgIHRoaXMuc2VuZGVyID0gc2VuZGVyO1xuICAgICAgICBPYmplY3QuYXNzaWduKHRoaXMsIGFyZ3MpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBBcmd1bWVudHMgZm9yIHRoZSBgZHJhZ2AgZXZlbnQuXG4gKi9cbmNsYXNzIERyYWdFdmVudCBleHRlbmRzIFByZXZlbnRhYmxlRXZlbnQkMSB7XG4gICAgLyoqXG4gICAgICogQGhpZGRlblxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKHNlbmRlciwgYXJncykge1xuICAgICAgICBzdXBlcigpO1xuICAgICAgICB0aGlzLnNlbmRlciA9IHNlbmRlcjtcbiAgICAgICAgT2JqZWN0LmFzc2lnbih0aGlzLCBhcmdzKTtcbiAgICB9XG59XG5cbi8qKlxuICogQXJndW1lbnRzIGZvciB0aGUgYGRyYWdTdGFydGAgZXZlbnQuXG4gKi9cbmNsYXNzIERyYWdTdGFydEV2ZW50IGV4dGVuZHMgUHJldmVudGFibGVFdmVudCQxIHtcbiAgICAvKipcbiAgICAgKiBAaGlkZGVuXG4gICAgICovXG4gICAgY29uc3RydWN0b3Ioc2VuZGVyLCBhcmdzKSB7XG4gICAgICAgIHN1cGVyKCk7XG4gICAgICAgIHRoaXMuc2VuZGVyID0gc2VuZGVyO1xuICAgICAgICBPYmplY3QuYXNzaWduKHRoaXMsIGFyZ3MpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBBcmd1bWVudHMgZm9yIHRoZSBgcmVtb3ZlYCBldmVudC5cbiAqL1xuY2xhc3MgUmVtb3ZlRXZlbnQgZXh0ZW5kcyBQcmV2ZW50YWJsZUV2ZW50JDEge1xuICAgIC8qKlxuICAgICAqIEBoaWRkZW5cbiAgICAgKi9cbiAgICBjb25zdHJ1Y3RvcihzZW5kZXIsIGFyZ3MpIHtcbiAgICAgICAgc3VwZXIoKTtcbiAgICAgICAgdGhpcy5zZW5kZXIgPSBzZW5kZXI7XG4gICAgICAgIE9iamVjdC5hc3NpZ24odGhpcywgYXJncyk7XG4gICAgfVxufVxuXG4vKipcbiAqIEFyZ3VtZW50cyBmb3IgdGhlIGByZXNpemVFbmRgIGV2ZW50LlxuICovXG5jbGFzcyBSZXNpemVFbmRFdmVudCBleHRlbmRzIFByZXZlbnRhYmxlRXZlbnQkMSB7XG4gICAgLyoqXG4gICAgICogQGhpZGRlblxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKHNlbmRlciwgYXJncykge1xuICAgICAgICBzdXBlcigpO1xuICAgICAgICB0aGlzLnNlbmRlciA9IHNlbmRlcjtcbiAgICAgICAgT2JqZWN0LmFzc2lnbih0aGlzLCBhcmdzKTtcbiAgICB9XG59XG5cbi8qKlxuICogQXJndW1lbnRzIGZvciB0aGUgYHJlc2l6ZWAgZXZlbnQuXG4gKi9cbmNsYXNzIFJlc2l6ZUV2ZW50IGV4dGVuZHMgUHJldmVudGFibGVFdmVudCQxIHtcbiAgICAvKipcbiAgICAgKiBAaGlkZGVuXG4gICAgICovXG4gICAgY29uc3RydWN0b3Ioc2VuZGVyLCBhcmdzKSB7XG4gICAgICAgIHN1cGVyKCk7XG4gICAgICAgIHRoaXMuc2VuZGVyID0gc2VuZGVyO1xuICAgICAgICBPYmplY3QuYXNzaWduKHRoaXMsIGFyZ3MpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBBcmd1bWVudHMgZm9yIHRoZSBgcmVzaXplU3RhcnRgIGV2ZW50LlxuICovXG5jbGFzcyBSZXNpemVTdGFydEV2ZW50IGV4dGVuZHMgUHJldmVudGFibGVFdmVudCQxIHtcbiAgICAvKipcbiAgICAgKiBAaGlkZGVuXG4gICAgICovXG4gICAgY29uc3RydWN0b3Ioc2VuZGVyLCBhcmdzKSB7XG4gICAgICAgIHN1cGVyKCk7XG4gICAgICAgIHRoaXMuc2VuZGVyID0gc2VuZGVyO1xuICAgICAgICBPYmplY3QuYXNzaWduKHRoaXMsIGFyZ3MpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBAaGlkZGVuXG4gKlxuICogTWFwcyB0aGUgbmFtZSBvZiB0aGUgZXZlbnQgdG8gdGhlIGFyZ3VtZW50IHR5cGUgb2YgdGhlIGV2ZW50LlxuICovXG5jb25zdCBWSUVXX0VWRU5UX01BUCA9IHtcbiAgICBzbG90Q2xpY2s6IFNsb3RDbGlja0V2ZW50LFxuICAgIHNsb3REYmxDbGljazogU2xvdENsaWNrRXZlbnQsXG4gICAgZXZlbnRDbGljazogRXZlbnRDbGlja0V2ZW50LFxuICAgIGV2ZW50RGJsQ2xpY2s6IEV2ZW50Q2xpY2tFdmVudCxcbiAgICBldmVudEtleWRvd246IEV2ZW50S2V5ZG93bkV2ZW50LFxuICAgIGNyZWF0ZTogQ3JlYXRlRXZlbnQsXG4gICAgcmVtb3ZlOiBSZW1vdmVFdmVudCxcbiAgICByZXNpemVTdGFydDogUmVzaXplU3RhcnRFdmVudCxcbiAgICByZXNpemU6IFJlc2l6ZUV2ZW50LFxuICAgIHJlc2l6ZUVuZDogUmVzaXplRW5kRXZlbnQsXG4gICAgZHJhZ1N0YXJ0OiBEcmFnU3RhcnRFdmVudCxcbiAgICBkcmFnOiBEcmFnRXZlbnQsXG4gICAgZHJhZ0VuZDogRHJhZ0VuZEV2ZW50XG59O1xuXG4vKipcbiAqIEBoaWRkZW5cbiAqL1xuY2xhc3MgRWRpdEV2ZW50QmFzZSB7XG4gICAgLyoqXG4gICAgICogQGhpZGRlblxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKHNlbmRlciwgYXJncykge1xuICAgICAgICB0aGlzLnNlbmRlciA9IHNlbmRlcjtcbiAgICAgICAgT2JqZWN0LmFzc2lnbih0aGlzLCBhcmdzKTtcbiAgICB9XG59XG5cbi8qKlxuICogQXJndW1lbnRzIGZvciB0aGUgYGNhbmNlbGAgZXZlbnQuXG4gKi9cbmNsYXNzIENhbmNlbEV2ZW50IGV4dGVuZHMgRWRpdEV2ZW50QmFzZSB7XG59XG5cbi8qKlxuICogQXJndW1lbnRzIGZvciB0aGUgYHNhdmVgIGV2ZW50LlxuICovXG5jbGFzcyBTYXZlRXZlbnQgZXh0ZW5kcyBFZGl0RXZlbnRCYXNlIHtcbn1cblxuLyoqXG4gKiBBcmd1bWVudHMgZm9yIHRoZSBgZWRpdGAgZXZlbnQgb2YgdGhlIGVkaXRpbmcgZGlyZWN0aXZlcy5cbiAqL1xuY2xhc3MgRWRpdEV2ZW50IGV4dGVuZHMgUHJldmVudGFibGVFdmVudCQxIHtcbiAgICAvKipcbiAgICAgKiBAaGlkZGVuXG4gICAgICovXG4gICAgY29uc3RydWN0b3Ioc2VuZGVyLCBhcmdzKSB7XG4gICAgICAgIHN1cGVyKCk7XG4gICAgICAgIHRoaXMuc2VuZGVyID0gc2VuZGVyO1xuICAgICAgICBPYmplY3QuYXNzaWduKHRoaXMsIGFyZ3MpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBBcmd1bWVudHMgZm9yIHRoZSBgYWRkYCBldmVudCBvZiB0aGUgZWRpdGluZyBkaXJlY3RpdmVzLlxuICovXG5jbGFzcyBBZGRFdmVudCBleHRlbmRzIFByZXZlbnRhYmxlRXZlbnQkMSB7XG4gICAgLyoqXG4gICAgICogQGhpZGRlblxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKHNlbmRlciwgYXJncykge1xuICAgICAgICBzdXBlcigpO1xuICAgICAgICB0aGlzLnNlbmRlciA9IHNlbmRlcjtcbiAgICAgICAgT2JqZWN0LmFzc2lnbih0aGlzLCBhcmdzKTtcbiAgICB9XG59XG5cbi8qKlxuICogUmVwcmVzZW50cyB0aGUgdG9vbGJhciB0ZW1wbGF0ZSBvZiB0aGUgU2NoZWR1bGVyLiBUbyBkZWZpbmUgYSB0b29sYmFyXG4gKiB0ZW1wbGF0ZSwgbmVzdCBhbiBgPG5nLXRlbXBsYXRlIGtlbmRvU2NoZWR1bGVyVG9vbGJhclRlbXBsYXRlPmAgdGFnXG4gKiBpbnNpZGUgYDxrZW5kby1zY2hlZHVsZXI+YC4gRm9yIG1vcmUgaW5mb3JtYXRpb24gYW5kIGV4YW1wbGVzLCByZWZlciB0byB0aGUgYXJ0aWNsZSBvblxuICogW2N1c3RvbWl6aW5nIHRoZSB0b29sYmFyXSh7JSBzbHVnIHRvb2xiYXJfc2NoZWR1bGVyICV9KSBvZiB0aGUgU2NoZWR1bGVyLlxuICpcbiAqIFRoZSB0ZW1wbGF0ZSBjb250ZXh0IHJlY2VpdmVzIHRoZSBmb2xsb3dpbmcgdGVtcGxhdGUgdmFyaWFibGVzOlxuICogKiBgc2VsZWN0ZWREYXRlYCZtZGFzaDtUaGUgY3VycmVudGx5IHNlbGVjdGVkIGRhdGUuXG4gKiAqIGBkYXRlUmFuZ2VgJm1kYXNoO1RoZSBjdXJyZW50bHkgc2VsZWN0ZWQgW2BEYXRlUmFuZ2VgXSh7JSBzbHVnIGFwaV9zY2hlZHVsZXJfZGF0ZXJhbmdlICV9KS5cbiAqICogYHZpZXdzYCZtZGFzaDtBIFtgU2NoZWR1bGVyVmlld2BdKHslIHNsdWcgYXBpX3NjaGVkdWxlcl9zY2hlZHVsZXJ2aWV3ICV9KSBhcnJheSB3aXRoIHRoZSBhdmFpbGFibGUgdmlld3MuXG4gKiAqIGBzZWxlY3RlZFZpZXdgJm1kYXNoO1RoZSBjdXJyZW50bHkgc2VsZWN0ZWQgW2BTY2hlZHVsZXJWaWV3YF0oeyUgc2x1ZyBhcGlfc2NoZWR1bGVyX3NjaGVkdWxlcnZpZXcgJX0pLlxuICpcbiAqIFlvdSBjYW4gZGVjbGFyZSBlaXRoZXIgb2YgdGhlIGZvbGxvd2luZyBidWlsdC1pbiBuYXZpZ2F0aW9uIGNvbXBvbmVudHMgaW4gdGhlIHRvb2xiYXIgdGVtcGxhdGU6XG4gKiAqIGBrZW5kb1NjaGVkdWxlclRvb2xiYXJOYXZpZ2F0aW9uYCZtZGFzaDtSZW5kZXJzIG5hdmlnYXRpb24gYnV0dG9ucywgYSBjYWxlbmRhciwgYW5kIGEgZGF0ZS1yYW5nZSBsYWJlbC5cbiAqICogYGtlbmRvU2NoZWR1bGVyVG9vbGJhclZpZXdTZWxlY3RvcmAmbWRhc2g7UmVuZGVycyB0aGUgYnV0dG9ucyBmb3Igc2VsZWN0aW5nIHRoZSB2aWV3LlxuICpcbiAqIFRvIGVtaXQgbmF2aWdhdGlvbiBldmVudHMsIHRoZSBjb21wb25lbnRzIGluc2lkZSB0aGUgdG9vbGJhciBjYW4gaW5qZWN0XG4gKiB0aGUgW2BUb29sYmFyU2VydmljZWBdKHslIHNsdWcgYXBpX3NjaGVkdWxlcl90b29sYmFyc2VydmljZSAlfSkuXG4gKlxuICogeyUgbWV0YSBoZWlnaHQ6NzAwICV9XG4gKiB7JSBlbWJlZF9maWxlIHRvb2xiYXIvdGVtcGxhdGUvYXBwLmNvbXBvbmVudC50cyBwcmV2aWV3ICV9XG4gKiB7JSBlbWJlZF9maWxlIHRvb2xiYXIvdGVtcGxhdGUvbXktbmF2aWdhdGlvbi5jb21wb25lbnQudHMgJX1cbiAqIHslIGVtYmVkX2ZpbGUgdG9vbGJhci90ZW1wbGF0ZS9hcHAubW9kdWxlLnRzICV9XG4gKiB7JSBlbWJlZF9maWxlIHNoYXJlZC9ldmVudHMtdXRjLnRzICV9XG4gKiB7JSBlbWJlZF9maWxlIHNoYXJlZC9tYWluLnRzICV9XG4gKiB7JSBlbmRtZXRhICV9XG4gKi9cbmNsYXNzIFRvb2xiYXJUZW1wbGF0ZURpcmVjdGl2ZSB7XG4gICAgY29uc3RydWN0b3IodGVtcGxhdGVSZWYpIHtcbiAgICAgICAgdGhpcy50ZW1wbGF0ZVJlZiA9IHRlbXBsYXRlUmVmO1xuICAgIH1cbn1cblRvb2xiYXJUZW1wbGF0ZURpcmVjdGl2ZS5kZWNvcmF0b3JzID0gW1xuICAgIHsgdHlwZTogRGlyZWN0aXZlLCBhcmdzOiBbe1xuICAgICAgICAgICAgICAgIHNlbGVjdG9yOiAnW2tlbmRvU2NoZWR1bGVyVG9vbGJhclRlbXBsYXRlXSdcbiAgICAgICAgICAgIH0sXSB9LFxuXTtcbi8qKiBAbm9jb2xsYXBzZSAqL1xuVG9vbGJhclRlbXBsYXRlRGlyZWN0aXZlLmN0b3JQYXJhbWV0ZXJzID0gKCkgPT4gW1xuICAgIHsgdHlwZTogVGVtcGxhdGVSZWYsIGRlY29yYXRvcnM6IFt7IHR5cGU6IE9wdGlvbmFsIH1dIH1cbl07XG5cbi8qKlxuICogQSBzZXJ2aWNlIGZvciBjb21tdW5pY2F0aW9uIHdpdGggdGhlIHRvb2xiYXIgY29udHJvbHNcbiAqIHdoaWNoIGlzIHVzZWQgYnkgdGhlIHRvb2xiYXIgY29tcG9uZW50cyBmb3IgcHVibGlzaGluZyBuYXZpZ2F0aW9uIGFjdGlvbnNcbiAqIChbc2VlIGV4YW1wbGVdKHslIHNsdWcgdG9vbGJhcl9zY2hlZHVsZXIgJX0jdG9jLXVzaW5nLXRoZS10b29sYmFyLXNlcnZpY2UpKS5cbiAqL1xuY2xhc3MgVG9vbGJhclNlcnZpY2Uge1xuICAgIC8qKiBAaGlkZGVuICovXG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHRoaXMuYWN0aW9uU291cmNlID0gbmV3IFN1YmplY3QoKTtcbiAgICAgICAgdGhpcy5hY3Rpb24gPSB0aGlzLmFjdGlvblNvdXJjZS5hc09ic2VydmFibGUoKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogRW1pdHMgdGhlIHNwZWNpZmllZCBuYXZpZ2F0aW9uIGFjdGlvbi5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBhY3Rpb24gLSBUaGUgbmF2aWdhdGlvbiBhY3Rpb24gdGhhdCB3aWxsIGJlIGV4ZWN1dGVkLlxuICAgICAqL1xuICAgIG5hdmlnYXRlKGFjdGlvbikge1xuICAgICAgICB0aGlzLmFjdGlvblNvdXJjZS5uZXh0KGFjdGlvbik7XG4gICAgfVxufVxuVG9vbGJhclNlcnZpY2UuZGVjb3JhdG9ycyA9IFtcbiAgICB7IHR5cGU6IEluamVjdGFibGUgfSxcbl07XG4vKiogQG5vY29sbGFwc2UgKi9cblRvb2xiYXJTZXJ2aWNlLmN0b3JQYXJhbWV0ZXJzID0gKCkgPT4gW107XG5cbi8qKlxuICogQW4gYWJzdHJhY3QgY2xhc3Mgd2hpY2ggY29udGFpbnMgbWV0YSBpbmZvcm1hdGlvbiBhYm91dCBhIFNjaGVkdWxlciB2aWV3LlxuICovXG5jbGFzcyBTY2hlZHVsZXJWaWV3IHtcbn1cblxuLyoqXG4gKiBSZXByZXNlbnRzIHRoZSB0ZW1wbGF0ZSB3aGljaCByZW5kZXJzIHRoZSBkYXRlIGhlYWRlciBpbiB0aGUgKipBZ2VuZGEqKiB2aWV3LlxuICogVG8gZGVmaW5lIHRoZSBkYXRlIHRlbXBsYXRlLCBuZXN0IGFuIGA8bmctdGVtcGxhdGU+YCB0YWcgd2l0aCB0aGUgYGtlbmRvU2NoZWR1bGVyQWdlbmRhRGF0ZVRlbXBsYXRlYFxuICogZGlyZWN0aXZlIGluc2lkZSB0aGUgYDxrZW5kby1zY2hlZHVsZXItYWdlbmRhLXZpZXc+YCBvciBgPGtlbmRvLXNjaGVkdWxlcj5gIGNvbXBvbmVudHMuXG4gKlxuICogVGhlIGF2YWlsYWJsZSBmaWVsZHMgaW4gdGhlIHRlbXBsYXRlIGNvbnRleHQgYXJlOlxuICogLSBgZGF0ZWAmbWRhc2g7VGhlIGhlYWRlciBkYXRlLlxuICpcbiAqIHslIG1ldGEgaGVpZ2h0OjUwMCAlfVxuICogeyUgZW1iZWRfZmlsZSB0ZW1wbGF0ZXMvYWdlbmRhLWRhdGUtaGVhZGVyL2FwcC5jb21wb25lbnQudHMgcHJldmlldyAlfVxuICogeyUgZW1iZWRfZmlsZSB0ZW1wbGF0ZXMvYWdlbmRhLWRhdGUtaGVhZGVyL2FwcC5tb2R1bGUudHMgJX1cbiAqIHslIGVtYmVkX2ZpbGUgc2hhcmVkL21haW4udHMgJX1cbiAqIHslIGVtYmVkX2ZpbGUgc2hhcmVkL2V2ZW50cy11dGMudHMgJX1cbiAqIHslIGVuZG1ldGEgJX1cbiAqL1xuY2xhc3MgQWdlbmRhRGF0ZVRlbXBsYXRlRGlyZWN0aXZlIHtcbiAgICBjb25zdHJ1Y3Rvcih0ZW1wbGF0ZVJlZikge1xuICAgICAgICB0aGlzLnRlbXBsYXRlUmVmID0gdGVtcGxhdGVSZWY7XG4gICAgfVxufVxuQWdlbmRhRGF0ZVRlbXBsYXRlRGlyZWN0aXZlLmRlY29yYXRvcnMgPSBbXG4gICAgeyB0eXBlOiBEaXJlY3RpdmUsIGFyZ3M6IFt7XG4gICAgICAgICAgICAgICAgc2VsZWN0b3I6ICdba2VuZG9TY2hlZHVsZXJBZ2VuZGFEYXRlVGVtcGxhdGVdJ1xuICAgICAgICAgICAgfSxdIH0sXG5dO1xuLyoqIEBub2NvbGxhcHNlICovXG5BZ2VuZGFEYXRlVGVtcGxhdGVEaXJlY3RpdmUuY3RvclBhcmFtZXRlcnMgPSAoKSA9PiBbXG4gICAgeyB0eXBlOiBUZW1wbGF0ZVJlZiwgZGVjb3JhdG9yczogW3sgdHlwZTogT3B0aW9uYWwgfV0gfVxuXTtcblxuLyoqXG4gKiBSZXByZXNlbnRzIHRoZSB0ZW1wbGF0ZSB3aGljaCByZW5kZXJzIHRoZSB0aW1lIGhlYWRlciBpbiB0aGUgKipBZ2VuZGEqKiB2aWV3LlxuICogVG8gZGVmaW5lIHRoZSB0aW1lIHRlbXBsYXRlLCBuZXN0IGFuIGA8bmctdGVtcGxhdGU+YCB0YWcgd2l0aCB0aGUgYGtlbmRvU2NoZWR1bGVyQWdlbmRhVGltZVRlbXBsYXRlYFxuICogZGlyZWN0aXZlIGluc2lkZSB0aGUgYDxrZW5kby1zY2hlZHVsZXI+YCBvciBpbiB0aGUgYDxrZW5kby1zY2hlZHVsZXItYWdlbmRhLXZpZXc+YCBjb21wb25lbnQuXG4gKlxuICogVGhlIGF2YWlsYWJsZSBmaWVsZHMgaW4gdGhlIHRlbXBsYXRlIGNvbnRleHQgYXJlOlxuICogLSBgc3RhcnRgJm1kYXNoO1RoZSBzdGFydCBkYXRlIG9mIHRoZSBldmVudC5cbiAqIC0gYGVuZGAmbWRhc2g7VGhlIGVuZCBkYXRlIG9mIHRoZSBldmVudC5cbiAqIC0gYHRpdGxlYCZtZGFzaDtUaGUgdGl0bGUgb2YgdGhlIGV2ZW50LlxuICogLSBgZGVzY3JpcHRpb25gJm1kYXNoO1RoZSBkZXNjcmlwdGlvbiBvZiB0aGUgZXZlbnQuXG4gKiAtIGBpc0FsbERheWAmbWRhc2g7QSBCb29sZWFuIHZhbHVlIHdoaWNoIGluZGljYXRlcyBpZiB0aGUgZXZlbnQgaXMgYWxsLWRheS5cbiAqIC0gYHJlc291cmNlc2AmbWRhc2g7VGhlIHJlc291cmNlcyBvZiB0aGUgZXZlbnQuXG4gKlxuICogeyUgbWV0YSBoZWlnaHQ6NTAwICV9XG4gKiB7JSBlbWJlZF9maWxlIHRlbXBsYXRlcy9hZ2VuZGEtdGltZS1oZWFkZXIvYXBwLmNvbXBvbmVudC50cyBwcmV2aWV3ICV9XG4gKiB7JSBlbWJlZF9maWxlIHRlbXBsYXRlcy9hZ2VuZGEtdGltZS1oZWFkZXIvYXBwLm1vZHVsZS50cyAlfVxuICogeyUgZW1iZWRfZmlsZSBzaGFyZWQvbWFpbi50cyAlfVxuICogeyUgZW1iZWRfZmlsZSBzaGFyZWQvZXZlbnRzLXV0Yy50cyAlfVxuICogeyUgZW5kbWV0YSAlfVxuICovXG5jbGFzcyBBZ2VuZGFUaW1lVGVtcGxhdGVEaXJlY3RpdmUge1xuICAgIGNvbnN0cnVjdG9yKHRlbXBsYXRlUmVmKSB7XG4gICAgICAgIHRoaXMudGVtcGxhdGVSZWYgPSB0ZW1wbGF0ZVJlZjtcbiAgICB9XG59XG5BZ2VuZGFUaW1lVGVtcGxhdGVEaXJlY3RpdmUuZGVjb3JhdG9ycyA9IFtcbiAgICB7IHR5cGU6IERpcmVjdGl2ZSwgYXJnczogW3tcbiAgICAgICAgICAgICAgICBzZWxlY3RvcjogJ1trZW5kb1NjaGVkdWxlckFnZW5kYVRpbWVUZW1wbGF0ZV0nXG4gICAgICAgICAgICB9LF0gfSxcbl07XG4vKiogQG5vY29sbGFwc2UgKi9cbkFnZW5kYVRpbWVUZW1wbGF0ZURpcmVjdGl2ZS5jdG9yUGFyYW1ldGVycyA9ICgpID0+IFtcbiAgICB7IHR5cGU6IFRlbXBsYXRlUmVmLCBkZWNvcmF0b3JzOiBbeyB0eXBlOiBPcHRpb25hbCB9XSB9XG5dO1xuXG4vKipcbiAqIFJlcHJlc2VudHMgdGhlIHRlbXBsYXRlIGZvciBhbmQgYXNzaXN0cyB0aGUgY29udGVudCBjdXN0b21pemF0aW9uIG9mIGFsbC1kYXkgZXZlbnRzLlxuICogVG8gZGVmaW5lIHRoZSBhbGwtZGF5IGV2ZW50IHRlbXBsYXRlLCBuZXN0IGFuIGA8bmctdGVtcGxhdGU+YCB0YWcgd2l0aCB0aGUgYGtlbmRvU2NoZWR1bGVyQWxsRGF5RXZlbnRUZW1wbGF0ZWBcbiAqIGRpcmVjdGl2ZSBpbnNpZGUgdGhlIGA8a2VuZG8tc2NoZWR1bGVyPmAsIGA8a2VuZG8tc2NoZWR1bGVyLWRheS12aWV3PmAsIG9yIGBrZW5kby1zY2hlZHVsZXItd2Vlay12aWV3YCBjb21wb25lbnQuXG4gKlxuICogVGhlIGF2YWlsYWJsZSBmaWVsZHMgaW4gdGhlIHRlbXBsYXRlIGNvbnRleHQgYXJlOlxuICogLSBgZXZlbnRgJm1kYXNoO1RoZSBldmVudCB0aGF0IGlzIGFzc29jaWF0ZWQgd2l0aCB0aGUgaXRlbS5cbiAqIC0gYHJlc291cmNlc2AmbWRhc2g7VGhlIHJlc291cmNlcyBvZiB0aGUgZXZlbnQuXG4gKlxuICogeyUgbWV0YSBoZWlnaHQ6NTAwICV9XG4gKiB7JSBlbWJlZF9maWxlIHRlbXBsYXRlcy9hbGwtZGF5LWV2ZW50L2FwcC5jb21wb25lbnQudHMgcHJldmlldyAlfVxuICogeyUgZW1iZWRfZmlsZSB0ZW1wbGF0ZXMvYWxsLWRheS1ldmVudC9hcHAubW9kdWxlLnRzICV9XG4gKiB7JSBlbWJlZF9maWxlIHNoYXJlZC9tYWluLnRzICV9XG4gKiB7JSBlbWJlZF9maWxlIHNoYXJlZC9ldmVudHMtdXRjLnRzICV9XG4gKiB7JSBlbmRtZXRhICV9XG4gKi9cbmNsYXNzIEFsbERheUV2ZW50VGVtcGxhdGVEaXJlY3RpdmUge1xuICAgIGNvbnN0cnVjdG9yKHRlbXBsYXRlUmVmKSB7XG4gICAgICAgIHRoaXMudGVtcGxhdGVSZWYgPSB0ZW1wbGF0ZVJlZjtcbiAgICB9XG59XG5BbGxEYXlFdmVudFRlbXBsYXRlRGlyZWN0aXZlLmRlY29yYXRvcnMgPSBbXG4gICAgeyB0eXBlOiBEaXJlY3RpdmUsIGFyZ3M6IFt7XG4gICAgICAgICAgICAgICAgc2VsZWN0b3I6ICdba2VuZG9TY2hlZHVsZXJBbGxEYXlFdmVudFRlbXBsYXRlXSdcbiAgICAgICAgICAgIH0sXSB9LFxuXTtcbi8qKiBAbm9jb2xsYXBzZSAqL1xuQWxsRGF5RXZlbnRUZW1wbGF0ZURpcmVjdGl2ZS5jdG9yUGFyYW1ldGVycyA9ICgpID0+IFtcbiAgICB7IHR5cGU6IFRlbXBsYXRlUmVmLCBkZWNvcmF0b3JzOiBbeyB0eXBlOiBPcHRpb25hbCB9XSB9XG5dO1xuXG4vKipcbiAqIFJlcHJlc2VudHMgdGhlIHRlbXBsYXRlIGZvciBhbmQgYXNzaXN0cyB0aGUgY29udGVudCBjdXN0b21pemF0aW9uIG9mIGFsbC1kYXkgc2xvdHMuXG4gKiBUbyBkZWZpbmUgdGhlIGFsbC1kYXkgc2xvdCB0ZW1wbGF0ZSwgbmVzdCBhbiBgPG5nLXRlbXBsYXRlPmAgdGFnIHdpdGggdGhlIGBrZW5kb1NjaGVkdWxlckFsbERheVNsb3RUZW1wbGF0ZWBcbiAqIGRpcmVjdGl2ZSBpbnNpZGUgdGhlIGA8a2VuZG8tc2NoZWR1bGVyPmAsIGA8a2VuZG8tc2NoZWR1bGVyLWRheS12aWV3PmAsIG9yIGBrZW5kby1zY2hlZHVsZXItd2Vlay12aWV3YCBjb21wb25lbnQuXG4gKlxuICogVGhlIGF2YWlsYWJsZSBmaWVsZHMgaW4gdGhlIHRlbXBsYXRlIGNvbnRleHQgYXJlOlxuICogLSBgZGF0ZWAmbWRhc2g7VGhlIGRhdGUgb2YgdGhlIHNsb3QuXG4gKiAtIGByZXNvdXJjZXNgJm1kYXNoO1RoZSByZXNvdXJjZXMgb2YgdGhlIHNsb3QuXG4gKlxuICogeyUgbWV0YSBoZWlnaHQ6NTAwICV9XG4gKiB7JSBlbWJlZF9maWxlIHRlbXBsYXRlcy9hbGwtZGF5LXNsb3QvYXBwLmNvbXBvbmVudC50cyBwcmV2aWV3ICV9XG4gKiB7JSBlbWJlZF9maWxlIHRlbXBsYXRlcy9hbGwtZGF5LXNsb3QvYXBwLm1vZHVsZS50cyAlfVxuICogeyUgZW1iZWRfZmlsZSBzaGFyZWQvbWFpbi50cyAlfVxuICogeyUgZW1iZWRfZmlsZSBzaGFyZWQvZXZlbnRzLXV0Yy50cyAlfVxuICogeyUgZW5kbWV0YSAlfVxuICovXG5jbGFzcyBBbGxEYXlTbG90VGVtcGxhdGVEaXJlY3RpdmUge1xuICAgIGNvbnN0cnVjdG9yKHRlbXBsYXRlUmVmKSB7XG4gICAgICAgIHRoaXMudGVtcGxhdGVSZWYgPSB0ZW1wbGF0ZVJlZjtcbiAgICB9XG59XG5BbGxEYXlTbG90VGVtcGxhdGVEaXJlY3RpdmUuZGVjb3JhdG9ycyA9IFtcbiAgICB7IHR5cGU6IERpcmVjdGl2ZSwgYXJnczogW3tcbiAgICAgICAgICAgICAgICBzZWxlY3RvcjogJ1trZW5kb1NjaGVkdWxlckFsbERheVNsb3RUZW1wbGF0ZV0nXG4gICAgICAgICAgICB9LF0gfSxcbl07XG4vKiogQG5vY29sbGFwc2UgKi9cbkFsbERheVNsb3RUZW1wbGF0ZURpcmVjdGl2ZS5jdG9yUGFyYW1ldGVycyA9ICgpID0+IFtcbiAgICB7IHR5cGU6IFRlbXBsYXRlUmVmLCBkZWNvcmF0b3JzOiBbeyB0eXBlOiBPcHRpb25hbCB9XSB9XG5dO1xuXG4vKipcbiAqIFJlcHJlc2VudHMgdGhlIHRlbXBsYXRlIHdoaWNoIHJlbmRlcnMgdGhlIGRhdGUgaGVhZGVyIGluIHRoZSAqKkRheSoqLCAqKldlZWsqKiwgYW5kICoqVGltZWxpbmUqKiB2aWV3cy5cbiAqIFRvIGRlZmluZSB0aGUgZGF5IHRlbXBsYXRlLCBuZXN0IGFuIGA8bmctdGVtcGxhdGU+YCB0YWcgd2l0aCB0aGUgYGtlbmRvU2NoZWR1bGVyRGF0ZUhlYWRlclRlbXBsYXRlYFxuICogZGlyZWN0aXZlIGluc2lkZSB0aGUgYDxrZW5kby1zY2hlZHVsZXI+YCwgb3IgaW4gdGhlIGA8a2VuZG8tc2NoZWR1bGVyLWRheS12aWV3PmAsIGA8a2VuZG8tc2NoZWR1bGVyLXdlZWstdmlldz5gLFxuICogYDxrZW5kby1zY2hlZHVsZXItdGltZWxpbmUtdmlldz5gLCBgPGtlbmRvLXNjaGVkdWxlci10aW1lbGluZS13ZWVrLXZpZXc+YCwgYW5kIGA8a2VuZG8tc2NoZWR1bGVyLXRpbWVsaW5lLW1vbnRoLXZpZXc+YCBjb21wb25lbnRzLlxuICpcbiAqIFRoZSBhdmFpbGFibGUgZmllbGRzIGluIHRoZSB0ZW1wbGF0ZSBjb250ZXh0IGFyZTpcbiAqIC0gYGRhdGVgJm1kYXNoO1RoZSBoZWFkZXIgZGF0ZS5cbiAqXG4gKiB7JSBtZXRhIGhlaWdodDo1MDAgJX1cbiAqIHslIGVtYmVkX2ZpbGUgdGVtcGxhdGVzL2RhdGUtaGVhZGVyL2FwcC5jb21wb25lbnQudHMgcHJldmlldyAlfVxuICogeyUgZW1iZWRfZmlsZSB0ZW1wbGF0ZXMvZGF0ZS1oZWFkZXIvYXBwLm1vZHVsZS50cyAlfVxuICogeyUgZW1iZWRfZmlsZSBzaGFyZWQvbWFpbi50cyAlfVxuICogeyUgZW1iZWRfZmlsZSBzaGFyZWQvZXZlbnRzLXV0Yy50cyAlfVxuICogeyUgZW5kbWV0YSAlfVxuICovXG5jbGFzcyBEYXRlSGVhZGVyVGVtcGxhdGVEaXJlY3RpdmUge1xuICAgIGNvbnN0cnVjdG9yKHRlbXBsYXRlUmVmKSB7XG4gICAgICAgIHRoaXMudGVtcGxhdGVSZWYgPSB0ZW1wbGF0ZVJlZjtcbiAgICB9XG59XG5EYXRlSGVhZGVyVGVtcGxhdGVEaXJlY3RpdmUuZGVjb3JhdG9ycyA9IFtcbiAgICB7IHR5cGU6IERpcmVjdGl2ZSwgYXJnczogW3tcbiAgICAgICAgICAgICAgICBzZWxlY3RvcjogJ1trZW5kb1NjaGVkdWxlckRhdGVIZWFkZXJUZW1wbGF0ZV0nXG4gICAgICAgICAgICB9LF0gfSxcbl07XG4vKiogQG5vY29sbGFwc2UgKi9cbkRhdGVIZWFkZXJUZW1wbGF0ZURpcmVjdGl2ZS5jdG9yUGFyYW1ldGVycyA9ICgpID0+IFtcbiAgICB7IHR5cGU6IFRlbXBsYXRlUmVmLCBkZWNvcmF0b3JzOiBbeyB0eXBlOiBPcHRpb25hbCB9XSB9XG5dO1xuXG4vKipcbiAqIFJlcHJlc2VudHMgdGhlIHRlbXBsYXRlIGZvciBhbmQgYXNzaXN0cyB0aGUgY29udGVudCBjdXN0b21pemF0aW9uIG9mIHRoZSBTY2hlZHVsZXIgZXZlbnRzLlxuICogVG8gZGVmaW5lIHRoZSBldmVudCB0ZW1wbGF0ZSwgbmVzdCBhbiBgPG5nLXRlbXBsYXRlPmAgdGFnIHdpdGggdGhlIGBrZW5kb1NjaGVkdWxlckV2ZW50VGVtcGxhdGVgXG4gKiBkaXJlY3RpdmUgaW5zaWRlIHRoZSBgPGtlbmRvLXNjaGVkdWxlcj5gLCBvciBpbiB0aGUgdmlldyBjb21wb25lbnRzLlxuICpcbiAqIFRoZSBhdmFpbGFibGUgZmllbGRzIGluIHRoZSB0ZW1wbGF0ZSBjb250ZXh0IGFyZTpcbiAqIC0gYGV2ZW50YCZtZGFzaDtUaGUgZXZlbnQgdGhhdCBpcyBhc3NvY2lhdGVkIHdpdGggdGhlIGl0ZW0uXG4gKiAtIGByZXNvdXJjZXNgJm1kYXNoO1RoZSByZXNvdXJjZXMgb2YgdGhlIGV2ZW50LlxuICpcbiAqIHslIG1ldGEgaGVpZ2h0OjUwMCAlfVxuICogeyUgZW1iZWRfZmlsZSB0ZW1wbGF0ZXMvZXZlbnQvYXBwLmNvbXBvbmVudC50cyBwcmV2aWV3ICV9XG4gKiB7JSBlbWJlZF9maWxlIHRlbXBsYXRlcy9ldmVudC9hcHAubW9kdWxlLnRzICV9XG4gKiB7JSBlbWJlZF9maWxlIHNoYXJlZC9tYWluLnRzICV9XG4gKiB7JSBlbWJlZF9maWxlIHNoYXJlZC9ldmVudHMtdXRjLnRzICV9XG4gKiB7JSBlbmRtZXRhICV9XG4gKi9cbmNsYXNzIEV2ZW50VGVtcGxhdGVEaXJlY3RpdmUge1xuICAgIGNvbnN0cnVjdG9yKHRlbXBsYXRlUmVmKSB7XG4gICAgICAgIHRoaXMudGVtcGxhdGVSZWYgPSB0ZW1wbGF0ZVJlZjtcbiAgICB9XG59XG5FdmVudFRlbXBsYXRlRGlyZWN0aXZlLmRlY29yYXRvcnMgPSBbXG4gICAgeyB0eXBlOiBEaXJlY3RpdmUsIGFyZ3M6IFt7XG4gICAgICAgICAgICAgICAgc2VsZWN0b3I6ICdba2VuZG9TY2hlZHVsZXJFdmVudFRlbXBsYXRlXSdcbiAgICAgICAgICAgIH0sXSB9LFxuXTtcbi8qKiBAbm9jb2xsYXBzZSAqL1xuRXZlbnRUZW1wbGF0ZURpcmVjdGl2ZS5jdG9yUGFyYW1ldGVycyA9ICgpID0+IFtcbiAgICB7IHR5cGU6IFRlbXBsYXRlUmVmLCBkZWNvcmF0b3JzOiBbeyB0eXBlOiBPcHRpb25hbCB9XSB9XG5dO1xuXG4vKipcbiAqIFJlcHJlc2VudHMgdGhlIHRlbXBsYXRlIHdoaWNoIHJlbmRlcnMgdGhlIHJlc291cmNlIGdyb3VwIGhlYWRlciBpbiB0aGUgKipEYXkqKiwgKipXZWVrKiosIGFuZCAqKlRpbWVsaW5lKiogdmlld3MuXG4gKiBUbyBkZWZpbmUgdGhlIHRlbXBsYXRlLCBuZXN0IGFuIGA8bmctdGVtcGxhdGU+YCB0YWcgd2l0aCB0aGUgYGtlbmRvU2NoZWR1bGVyR3JvdXBIZWFkZXJUZW1wbGF0ZWBcbiAqIGRpcmVjdGl2ZSBpbnNpZGUgdGhlIGA8a2VuZG8tc2NoZWR1bGVyPmAsIG9yIGluIHRoZSBgPGtlbmRvLXNjaGVkdWxlci1kYXktdmlldz5gLCBgPGtlbmRvLXNjaGVkdWxlci13ZWVrLXZpZXc+YCxcbiAqIGA8a2VuZG8tc2NoZWR1bGVyLXRpbWVsaW5lLXZpZXc+YCwgYDxrZW5kby1zY2hlZHVsZXItdGltZWxpbmUtd2Vlay12aWV3PmAsIGFuZCBgPGtlbmRvLXNjaGVkdWxlci10aW1lbGluZS1tb250aC12aWV3PmAgY29tcG9uZW50cy5cbiAqXG4gKiBUaGUgYXZhaWxhYmxlIGZpZWxkcyBpbiB0aGUgdGVtcGxhdGUgY29udGV4dCBhcmU6XG4gKiAtIGByZXNvdXJjZWAmbWRhc2g7VGhlIHJlc291cmNlIGl0ZW0uXG4gKlxuICogeyUgbWV0YSBoZWlnaHQ6NTAwICV9XG4gKiB7JSBlbWJlZF9maWxlIHRlbXBsYXRlcy9ncm91cC1oZWFkZXIvYXBwLmNvbXBvbmVudC50cyBwcmV2aWV3ICV9XG4gKiB7JSBlbWJlZF9maWxlIHRlbXBsYXRlcy9ncm91cC1oZWFkZXIvYXBwLm1vZHVsZS50cyAlfVxuICogeyUgZW1iZWRfZmlsZSBzaGFyZWQvbWFpbi50cyAlfVxuICogeyUgZW1iZWRfZmlsZSBzaGFyZWQvZXZlbnRzLXV0Yy50cyAlfVxuICogeyUgZW5kbWV0YSAlfVxuICovXG5jbGFzcyBHcm91cEhlYWRlclRlbXBsYXRlRGlyZWN0aXZlIHtcbiAgICBjb25zdHJ1Y3Rvcih0ZW1wbGF0ZVJlZikge1xuICAgICAgICB0aGlzLnRlbXBsYXRlUmVmID0gdGVtcGxhdGVSZWY7XG4gICAgfVxufVxuR3JvdXBIZWFkZXJUZW1wbGF0ZURpcmVjdGl2ZS5kZWNvcmF0b3JzID0gW1xuICAgIHsgdHlwZTogRGlyZWN0aXZlLCBhcmdzOiBbe1xuICAgICAgICAgICAgICAgIHNlbGVjdG9yOiAnW2tlbmRvU2NoZWR1bGVyR3JvdXBIZWFkZXJUZW1wbGF0ZV0nXG4gICAgICAgICAgICB9LF0gfSxcbl07XG4vKiogQG5vY29sbGFwc2UgKi9cbkdyb3VwSGVhZGVyVGVtcGxhdGVEaXJlY3RpdmUuY3RvclBhcmFtZXRlcnMgPSAoKSA9PiBbXG4gICAgeyB0eXBlOiBUZW1wbGF0ZVJlZiwgZGVjb3JhdG9yczogW3sgdHlwZTogT3B0aW9uYWwgfV0gfVxuXTtcblxuLyoqXG4gKiBSZXByZXNlbnRzIHRoZSB0ZW1wbGF0ZSBmb3IgdGhlIG1ham9yLXRpbWUgaGVhZGVycyBpbiB0aGUgKipEYXkqKiBhbmQgKipXZWVrKiogdmlld3MuXG4gKiBUbyBkZWZpbmUgdGhlIG1ham9yLXRpbWUgaGVhZGVyIHRlbXBsYXRlLCBuZXN0IGFuIGA8bmctdGVtcGxhdGU+YCB0YWcgd2l0aCB0aGUgYGtlbmRvU2NoZWR1bGVyTWFqb3JUaW1lSGVhZGVyVGVtcGxhdGVgXG4gKiBkaXJlY3RpdmUgaW5zaWRlIHRoZSBgPGtlbmRvLXNjaGVkdWxlcj5gLCBvciBpbiB0aGUgYDxrZW5kby1zY2hlZHVsZXItZGF5LXZpZXc+YCBhbmQgYDxrZW5kby1zY2hlZHVsZXItd2Vlay12aWV3PmAgY29tcG9uZW50cy5cbiAqXG4gKiBUaGUgYXZhaWxhYmxlIGZpZWxkcyBpbiB0aGUgdGVtcGxhdGUgY29udGV4dCBhcmU6XG4gKiAtIGBkYXRlYCZtZGFzaDtUaGUgZGF0ZSBvZiB0aGUgaGVhZGVyLlxuICpcbiAqIHslIG1ldGEgaGVpZ2h0OjUwMCAlfVxuICogeyUgZW1iZWRfZmlsZSB0ZW1wbGF0ZXMvbWFqb3ItaGVhZGVyL2FwcC5jb21wb25lbnQudHMgcHJldmlldyAlfVxuICogeyUgZW1iZWRfZmlsZSB0ZW1wbGF0ZXMvbWFqb3ItaGVhZGVyL2FwcC5tb2R1bGUudHMgJX1cbiAqIHslIGVtYmVkX2ZpbGUgc2hhcmVkL21haW4udHMgJX1cbiAqIHslIGVtYmVkX2ZpbGUgc2hhcmVkL2V2ZW50cy11dGMudHMgJX1cbiAqIHslIGVuZG1ldGEgJX1cbiAqL1xuY2xhc3MgTWFqb3JUaW1lSGVhZGVyVGVtcGxhdGVEaXJlY3RpdmUge1xuICAgIGNvbnN0cnVjdG9yKHRlbXBsYXRlUmVmKSB7XG4gICAgICAgIHRoaXMudGVtcGxhdGVSZWYgPSB0ZW1wbGF0ZVJlZjtcbiAgICB9XG59XG5NYWpvclRpbWVIZWFkZXJUZW1wbGF0ZURpcmVjdGl2ZS5kZWNvcmF0b3JzID0gW1xuICAgIHsgdHlwZTogRGlyZWN0aXZlLCBhcmdzOiBbe1xuICAgICAgICAgICAgICAgIHNlbGVjdG9yOiAnW2tlbmRvU2NoZWR1bGVyTWFqb3JUaW1lSGVhZGVyVGVtcGxhdGVdJ1xuICAgICAgICAgICAgfSxdIH0sXG5dO1xuLyoqIEBub2NvbGxhcHNlICovXG5NYWpvclRpbWVIZWFkZXJUZW1wbGF0ZURpcmVjdGl2ZS5jdG9yUGFyYW1ldGVycyA9ICgpID0+IFtcbiAgICB7IHR5cGU6IFRlbXBsYXRlUmVmLCBkZWNvcmF0b3JzOiBbeyB0eXBlOiBPcHRpb25hbCB9XSB9XG5dO1xuXG4vKipcbiAqIFJlcHJlc2VudHMgdGhlIHRlbXBsYXRlIGZvciB0aGUgbWlub3ItdGltZSBoZWFkZXJzIGluIHRoZSAqKkRheSoqIGFuZCAqKldlZWsqKiB2aWV3cy5cbiAqIFRvIGRlZmluZSB0aGUgbWlub3ItdGltZSBoZWFkZXIgdGVtcGxhdGUsIG5lc3QgYW4gYDxuZy10ZW1wbGF0ZT5gIHRhZyB3aXRoIHRoZSBga2VuZG9TY2hlZHVsZXJNaW5vclRpbWVIZWFkZXJUZW1wbGF0ZWBcbiAqIGRpcmVjdGl2ZSBpbnNpZGUgdGhlIGA8a2VuZG8tc2NoZWR1bGVyPmAsIG9yIGluIHRoZSBgPGtlbmRvLXNjaGVkdWxlci1kYXktdmlldz5gIGFuZCBgPGtlbmRvLXNjaGVkdWxlci13ZWVrLXZpZXc+YCBjb21wb25lbnRzLlxuICpcbiAqIFRoZSBhdmFpbGFibGUgZmllbGRzIGluIHRoZSB0ZW1wbGF0ZSBjb250ZXh0IGFyZTpcbiAqIC0gYGRhdGVgJm1kYXNoO1RoZSBkYXRlIG9mIHRoZSBoZWFkZXIuXG4gKlxuICogeyUgbWV0YSBoZWlnaHQ6NTAwICV9XG4gKiB7JSBlbWJlZF9maWxlIHRlbXBsYXRlcy9taW5vci1oZWFkZXIvYXBwLmNvbXBvbmVudC50cyBwcmV2aWV3ICV9XG4gKiB7JSBlbWJlZF9maWxlIHRlbXBsYXRlcy9taW5vci1oZWFkZXIvYXBwLm1vZHVsZS50cyAlfVxuICogeyUgZW1iZWRfZmlsZSBzaGFyZWQvbWFpbi50cyAlfVxuICogeyUgZW1iZWRfZmlsZSBzaGFyZWQvZXZlbnRzLXV0Yy50cyAlfVxuICogeyUgZW5kbWV0YSAlfVxuICovXG5jbGFzcyBNaW5vclRpbWVIZWFkZXJUZW1wbGF0ZURpcmVjdGl2ZSB7XG4gICAgY29uc3RydWN0b3IodGVtcGxhdGVSZWYpIHtcbiAgICAgICAgdGhpcy50ZW1wbGF0ZVJlZiA9IHRlbXBsYXRlUmVmO1xuICAgIH1cbn1cbk1pbm9yVGltZUhlYWRlclRlbXBsYXRlRGlyZWN0aXZlLmRlY29yYXRvcnMgPSBbXG4gICAgeyB0eXBlOiBEaXJlY3RpdmUsIGFyZ3M6IFt7XG4gICAgICAgICAgICAgICAgc2VsZWN0b3I6ICdba2VuZG9TY2hlZHVsZXJNaW5vclRpbWVIZWFkZXJUZW1wbGF0ZV0nXG4gICAgICAgICAgICB9LF0gfSxcbl07XG4vKiogQG5vY29sbGFwc2UgKi9cbk1pbm9yVGltZUhlYWRlclRlbXBsYXRlRGlyZWN0aXZlLmN0b3JQYXJhbWV0ZXJzID0gKCkgPT4gW1xuICAgIHsgdHlwZTogVGVtcGxhdGVSZWYsIGRlY29yYXRvcnM6IFt7IHR5cGU6IE9wdGlvbmFsIH1dIH1cbl07XG5cbi8qKlxuICogUmVwcmVzZW50cyB0aGUgdGVtcGxhdGUgZm9yIHJlbmRlcmluZyB0aGUgZGF5IHNsb3RzIGluIHRoZSAqKk1vbnRoKiogdmlldy5cbiAqIFRvIGRlZmluZSB0aGUgZGF5IHRlbXBsYXRlLCBuZXN0IGFuIGA8bmctdGVtcGxhdGU+YCB0YWcgd2l0aCB0aGUgYGtlbmRvU2NoZWR1bGVyTW9udGhEYXlTbG90VGVtcGxhdGVgXG4gKiBkaXJlY3RpdmUgaW5zaWRlIHRoZSBgPGtlbmRvLXNjaGVkdWxlcj5gLCBvciBpbiB0aGUgYDxrZW5kby1zY2hlZHVsZXItbW9udGgtdmlldz5gIGNvbXBvbmVudC5cbiAqXG4gKiBUaGUgYXZhaWxhYmxlIGZpZWxkcyBpbiB0aGUgdGVtcGxhdGUgY29udGV4dCBhcmU6XG4gKiAtIGBkYXRlYCZtZGFzaDtUaGUgZGF0ZSBvZiB0aGUgc2xvdC5cbiAqIC0gYHJlc291cmNlc2AmbWRhc2g7VGhlIHJlc291cmNlcyBvZiB0aGUgc2xvdC5cbiAqXG4gKiB7JSBtZXRhIGhlaWdodDo1MDAgJX1cbiAqIHslIGVtYmVkX2ZpbGUgdGVtcGxhdGVzL21vbnRoLXNsb3QvYXBwLmNvbXBvbmVudC50cyBwcmV2aWV3ICV9XG4gKiB7JSBlbWJlZF9maWxlIHRlbXBsYXRlcy9tb250aC1zbG90L2FwcC5tb2R1bGUudHMgJX1cbiAqIHslIGVtYmVkX2ZpbGUgc2hhcmVkL21haW4udHMgJX1cbiAqIHslIGVtYmVkX2ZpbGUgc2hhcmVkL2V2ZW50cy11dGMudHMgJX1cbiAqIHslIGVuZG1ldGEgJX1cbiAqL1xuY2xhc3MgTW9udGhEYXlTbG90VGVtcGxhdGVEaXJlY3RpdmUge1xuICAgIGNvbnN0cnVjdG9yKHRlbXBsYXRlUmVmKSB7XG4gICAgICAgIHRoaXMudGVtcGxhdGVSZWYgPSB0ZW1wbGF0ZVJlZjtcbiAgICB9XG59XG5Nb250aERheVNsb3RUZW1wbGF0ZURpcmVjdGl2ZS5kZWNvcmF0b3JzID0gW1xuICAgIHsgdHlwZTogRGlyZWN0aXZlLCBhcmdzOiBbe1xuICAgICAgICAgICAgICAgIHNlbGVjdG9yOiAnW2tlbmRvU2NoZWR1bGVyTW9udGhEYXlTbG90VGVtcGxhdGVdJ1xuICAgICAgICAgICAgfSxdIH0sXG5dO1xuLyoqIEBub2NvbGxhcHNlICovXG5Nb250aERheVNsb3RUZW1wbGF0ZURpcmVjdGl2ZS5jdG9yUGFyYW1ldGVycyA9ICgpID0+IFtcbiAgICB7IHR5cGU6IFRlbXBsYXRlUmVmLCBkZWNvcmF0b3JzOiBbeyB0eXBlOiBPcHRpb25hbCB9XSB9XG5dO1xuLy8gUmVuYW1lIHRvIGluZGljYXRlIHRoYXQgaXQgaXMgb25seSBmb3IgdGhlIG1vbnRoIHZpZXcuXG5cbi8qKlxuICogUmVwcmVzZW50cyB0aGUgdGVtcGxhdGUgZm9yIHRoZSB0aW1lLXNsb3QgcmVuZGVyZXIgaW4gdGhlICoqRGF5KiosICoqV2VlayoqLCBhbmQgKipUaW1lbGluZSoqIHZpZXdzLlxuICogVG8gZGVmaW5lIHRoZSB0aW1lLXNsb3QgdGVtcGxhdGUsIG5lc3QgYW4gYDxuZy10ZW1wbGF0ZT5gIHRhZyB3aXRoIHRoZSBga2VuZG9TY2hlZHVsZXJUaW1lU2xvdFRlbXBsYXRlYFxuICogZGlyZWN0aXZlIGluc2lkZSB0aGUgYDxrZW5kby1zY2hlZHVsZXI+YCwgb3IgaW4gdGhlIGA8a2VuZG8tc2NoZWR1bGVyLWRheS12aWV3PmAsIGA8a2VuZG8tc2NoZWR1bGVyLXdlZWstdmlldz5gLFxuICogYDxrZW5kby1zY2hlZHVsZXItdGltZWxpbmUtdmlldz5gLCBgPGtlbmRvLXNjaGVkdWxlci10aW1lbGluZS13ZWVrLXZpZXc+YCwgYW5kIGA8a2VuZG8tc2NoZWR1bGVyLXRpbWVsaW5lLW1vbnRoLXZpZXc+YCBjb21wb25lbnRzLlxuICpcbiAqIFRoZSBhdmFpbGFibGUgZmllbGRzIGluIHRoZSB0ZW1wbGF0ZSBjb250ZXh0IGFyZTpcbiAqIC0gYGRhdGVgJm1kYXNoO1RoZSBkYXRlIG9mIHRoZSBzbG90LlxuICogLSBgcmVzb3VyY2VzYCZtZGFzaDtUaGUgcmVzb3VyY2VzIG9mIHRoZSBzbG90LlxuICpcbiAqIHslIG1ldGEgaGVpZ2h0OjUwMCAlfVxuICogeyUgZW1iZWRfZmlsZSB0ZW1wbGF0ZXMvdGltZS1zbG90L2FwcC5jb21wb25lbnQudHMgcHJldmlldyAlfVxuICogeyUgZW1iZWRfZmlsZSB0ZW1wbGF0ZXMvdGltZS1zbG90L2FwcC5tb2R1bGUudHMgJX1cbiAqIHslIGVtYmVkX2ZpbGUgc2hhcmVkL21haW4udHMgJX1cbiAqIHslIGVtYmVkX2ZpbGUgc2hhcmVkL2V2ZW50cy11dGMudHMgJX1cbiAqIHslIGVuZG1ldGEgJX1cbiAqL1xuY2xhc3MgVGltZVNsb3RUZW1wbGF0ZURpcmVjdGl2ZSB7XG4gICAgY29uc3RydWN0b3IodGVtcGxhdGVSZWYpIHtcbiAgICAgICAgdGhpcy50ZW1wbGF0ZVJlZiA9IHRlbXBsYXRlUmVmO1xuICAgIH1cbn1cblRpbWVTbG90VGVtcGxhdGVEaXJlY3RpdmUuZGVjb3JhdG9ycyA9IFtcbiAgICB7IHR5cGU6IERpcmVjdGl2ZSwgYXJnczogW3tcbiAgICAgICAgICAgICAgICBzZWxlY3RvcjogJ1trZW5kb1NjaGVkdWxlclRpbWVTbG90VGVtcGxhdGVdJ1xuICAgICAgICAgICAgfSxdIH0sXG5dO1xuLyoqIEBub2NvbGxhcHNlICovXG5UaW1lU2xvdFRlbXBsYXRlRGlyZWN0aXZlLmN0b3JQYXJhbWV0ZXJzID0gKCkgPT4gW1xuICAgIHsgdHlwZTogVGVtcGxhdGVSZWYsIGRlY29yYXRvcnM6IFt7IHR5cGU6IE9wdGlvbmFsIH1dIH1cbl07XG5cbi8qKlxuICogQSBzZXJ2aWNlIHdoaWNoIHB1Ymxpc2hlcyBpbmZvcm1hdGlvbiBmcm9tIHRoZSBTY2hlZHVsZXIgdG8gdGhlIHZpZXdzLlxuICogVmlld3Mgc3Vic2NyaWJlIHRvIGNoYW5nZXMgaW4gdGhlIGNvbnRleHQgKHNlbGVjdGVkIGRhdGUsIGV2ZW50LCBhbmQgcmVzb3VyY2UgZGF0YSkgdGhyb3VnaCB0aGlzIHNlcnZpY2UuXG4gKi9cbmNsYXNzIFZpZXdDb250ZXh0U2VydmljZSB7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHRoaXMuYWN0aW9uU291cmNlID0gbmV3IFN1YmplY3QoKTtcbiAgICAgICAgdGhpcy5pdGVtc1NvdXJjZSA9IG5ldyBCZWhhdmlvclN1YmplY3QoW10pO1xuICAgICAgICB0aGlzLnNlbGVjdGVkRGF0ZVNvdXJjZSA9IG5ldyBCZWhhdmlvclN1YmplY3QobnVsbCk7XG4gICAgICAgIHRoaXMucmVzaXplU291cmNlID0gbmV3IFN1YmplY3QoKTtcbiAgICAgICAgdGhpcy5vcHRpb25zQ2hhbmdlU291cmNlID0gbmV3IEJlaGF2aW9yU3ViamVjdCh7fSk7XG4gICAgICAgIHRoaXMuZXhlY3V0ZVNvdXJjZSA9IG5ldyBTdWJqZWN0KCk7XG4gICAgICAgIHRoaXMuYWN0aW9uID0gdGhpcy5hY3Rpb25Tb3VyY2UuYXNPYnNlcnZhYmxlKCk7XG4gICAgICAgIHRoaXMuaXRlbXMgPSB0aGlzLml0ZW1zU291cmNlLmFzT2JzZXJ2YWJsZSgpO1xuICAgICAgICB0aGlzLnNlbGVjdGVkRGF0ZSA9IHRoaXMuc2VsZWN0ZWREYXRlU291cmNlLmFzT2JzZXJ2YWJsZSgpO1xuICAgICAgICB0aGlzLnJlc2l6ZSA9IHRoaXMucmVzaXplU291cmNlLmFzT2JzZXJ2YWJsZSgpO1xuICAgICAgICB0aGlzLm9wdGlvbnNDaGFuZ2UgPSB0aGlzLm9wdGlvbnNDaGFuZ2VTb3VyY2UuYXNPYnNlcnZhYmxlKCk7XG4gICAgICAgIHRoaXMuZXhlY3V0ZSA9IHRoaXMuZXhlY3V0ZVNvdXJjZS5hc09ic2VydmFibGUoKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQW4gaW50ZXJuYWwgbWV0aG9kIHdoaWNoIGlzIHVzZWQgYnkgdGhlIFNjaGVkdWxlciB0byBwdWJsaXNoIHVuaGFuZGxlZCBuYXZpZ2F0aW9uIGFjdGlvbnMuXG4gICAgICpcbiAgICAgKiBAaGlkZGVuXG4gICAgICovXG4gICAgbm90aWZ5QWN0aW9uKGFjdGlvbikge1xuICAgICAgICB0aGlzLmFjdGlvblNvdXJjZS5uZXh0KGFjdGlvbik7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEFuIGludGVybmFsIG1ldGhvZCB3aGljaCBpcyB1c2VkIGJ5IHRoZSBTY2hlZHVsZXIgdG8gcHVibGlzaCB0aGUgY3VycmVudCBzZXQgb2YgaXRlbXMuXG4gICAgICpcbiAgICAgKiBAaGlkZGVuXG4gICAgICovXG4gICAgbm90aWZ5SXRlbXMoaXRlbXMpIHtcbiAgICAgICAgdGhpcy5pdGVtc1NvdXJjZS5uZXh0KGl0ZW1zKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQW4gaW50ZXJuYWwgbWV0aG9kIHdoaWNoIGlzIHVzZWQgYnkgdGhlIFNjaGVkdWxlciB0byBwdWJsaXNoIHRoZSBjdXJyZW50bHkgc2VsZWN0ZWQgZGF0ZS5cbiAgICAgKlxuICAgICAqIEBoaWRkZW5cbiAgICAgKi9cbiAgICBub3RpZnlTZWxlY3RlZERhdGUoZGF0ZSkge1xuICAgICAgICB0aGlzLnNlbGVjdGVkRGF0ZVNvdXJjZS5uZXh0KGRhdGUpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBBbiBpbnRlcm5hbCBtZXRob2Qgd2hpY2ggaXMgdXNlZCBieSB0aGUgU2NoZWR1bGVyIHRvIG5vdGlmeSB0aGF0IHRoZSBzaXplIGNoYW5nZWQuXG4gICAgICpcbiAgICAgKiBAaGlkZGVuXG4gICAgICovXG4gICAgbm90aWZ5UmVzaXplKCkge1xuICAgICAgICB0aGlzLnJlc2l6ZVNvdXJjZS5uZXh0KCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEFuIGludGVybmFsIG1ldGhvZCB3aGljaCBpcyB1c2VkIGJ5IHRoZSBTY2hlZHVsZXIgdG8gbm90aWZ5IHRoYXQgdGhlIG9wdGlvbnMgY2hhbmdlZC5cbiAgICAgKlxuICAgICAqIEBoaWRkZW5cbiAgICAgKi9cbiAgICBub3RpZnlPcHRpb25zQ2hhbmdlKGNoYW5nZXMpIHtcbiAgICAgICAgdGhpcy5vcHRpb25zQ2hhbmdlU291cmNlLm5leHQoY2hhbmdlcyk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEFuIGludGVybmFsIG1ldGhvZCB3aGljaCBpcyB1c2VkIGJ5IHRoZSBTY2hlZHVsZXIgdG8gZXhlY3V0ZSBhIHZpZXcgbWV0aG9kLlxuICAgICAqXG4gICAgICogQGhpZGRlblxuICAgICAqL1xuICAgIGV4ZWN1dGVNZXRob2QobmFtZSwgYXJncykge1xuICAgICAgICBsZXQgcmVzdWx0O1xuICAgICAgICB0aGlzLmV4ZWN1dGVTb3VyY2UubmV4dCh7IG5hbWUsIGFyZ3MsIHJlc3VsdDogKHIpID0+IHtcbiAgICAgICAgICAgICAgICByZXN1bHQgPSByO1xuICAgICAgICAgICAgfSB9KTtcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9XG59XG5WaWV3Q29udGV4dFNlcnZpY2UuZGVjb3JhdG9ycyA9IFtcbiAgICB7IHR5cGU6IEluamVjdGFibGUgfSxcbl07XG4vKiogQG5vY29sbGFwc2UgKi9cblZpZXdDb250ZXh0U2VydmljZS5jdG9yUGFyYW1ldGVycyA9ICgpID0+IFtdO1xuXG5jb25zdCBlbXB0eURhdGVSYW5nZSA9ICgpID0+ICh7XG4gICAgc3RhcnQ6IG5ldyBEYXRlKDApLFxuICAgIGVuZDogbmV3IERhdGUoMCksXG4gICAgdGV4dDogJycsXG4gICAgc2hvcnRUZXh0OiAnJ1xufSk7XG4vKipcbiAqIEEgc2VydmljZSBmb3IgcHVibGlzaGluZyB0aGUgdmlldyBzdGF0ZSBhbmQgYWN0aW9ucyB0byB0aGUgU2NoZWR1bGVyLlxuICovXG5jbGFzcyBWaWV3U3RhdGVTZXJ2aWNlIHtcbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgdGhpcy5kYXRlUmFuZ2VTb3VyY2UgPSBuZXcgQmVoYXZpb3JTdWJqZWN0KGVtcHR5RGF0ZVJhbmdlKCkpO1xuICAgICAgICB0aGlzLm5leHREYXRlU291cmNlID0gbmV3IFN1YmplY3QoKTtcbiAgICAgICAgdGhpcy5uYXZpZ2F0ZVNvdXJjZSA9IG5ldyBTdWJqZWN0KCk7XG4gICAgICAgIHRoaXMudmlld0V2ZW50U291cmNlID0gbmV3IFN1YmplY3QoKTtcbiAgICAgICAgdGhpcy5sYXlvdXRFbmRTb3VyY2UgPSBuZXcgU3ViamVjdCgpO1xuICAgICAgICB0aGlzLm9wdGlvbnNDaGFuZ2VTb3VyY2UgPSBuZXcgU3ViamVjdCgpO1xuICAgICAgICB0aGlzLmRhdGVSYW5nZSA9IHRoaXMuZGF0ZVJhbmdlU291cmNlLmFzT2JzZXJ2YWJsZSgpO1xuICAgICAgICB0aGlzLm5leHREYXRlID0gdGhpcy5uZXh0RGF0ZVNvdXJjZS5hc09ic2VydmFibGUoKTtcbiAgICAgICAgdGhpcy5uYXZpZ2F0ZSA9IHRoaXMubmF2aWdhdGVTb3VyY2UuYXNPYnNlcnZhYmxlKCk7XG4gICAgICAgIHRoaXMudmlld0V2ZW50ID0gdGhpcy52aWV3RXZlbnRTb3VyY2UuYXNPYnNlcnZhYmxlKCk7XG4gICAgICAgIHRoaXMubGF5b3V0RW5kID0gdGhpcy5sYXlvdXRFbmRTb3VyY2UuYXNPYnNlcnZhYmxlKCk7XG4gICAgICAgIHRoaXMub3B0aW9uc0NoYW5nZSA9IHRoaXMub3B0aW9uc0NoYW5nZVNvdXJjZS5hc09ic2VydmFibGUoKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUHVibGlzaGVzIHRoZSBkYXRlIHRoYXQgd2lsbCBiZSBkaXNwbGF5ZWQgYnkgdGhlIFNjaGVkdWxlclxuICAgICAqIHR5cGljYWxseSBhcyBhIHJlc3VsdCBmcm9tIHByb2Nlc3NpbmcgYSBuYXZpZ2F0aW9uIGFjdGlvbi5cbiAgICAgKi9cbiAgICBub3RpZnlOZXh0RGF0ZShkYXRlKSB7XG4gICAgICAgIHRoaXMubmV4dERhdGVTb3VyY2UubmV4dChkYXRlKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUHVibGlzaGVzIHRoZSB2aXNpYmxlIGRhdGUgcmFuZ2Ugb2YgdGhlIHZpZXcuXG4gICAgICogVGhlIHZpZXcgd2lsbCBjYWxjdWxhdGUgYW5kIHNldCB0aGUgbmV3IGRhdGEgcmFuZ2Ugd2hlblxuICAgICAqIHRoZSBzZWxlY3RlZCBkYXRlIGNoYW5nZXMuXG4gICAgICovXG4gICAgbm90aWZ5RGF0ZVJhbmdlKHJhbmdlKSB7XG4gICAgICAgIHRoaXMuZGF0ZVJhbmdlU291cmNlLm5leHQocmFuZ2UpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBOb3RpZmllcyB0aGUgU2NoZWR1bGVyIHRoYXQgdGhlIHZpZXcgaGFzIGNvbXBsZXRlZCBpdHMgbGF5b3V0LlxuICAgICAqL1xuICAgIG5vdGlmeUxheW91dEVuZCgpIHtcbiAgICAgICAgdGhpcy5sYXlvdXRFbmRTb3VyY2UubmV4dCgpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBOYXZpZ2F0ZXMgdG8gYW5vdGhlciB2aWV3LlxuICAgICAqL1xuICAgIG5hdmlnYXRlVG8oYXJncykge1xuICAgICAgICB0aGlzLm5hdmlnYXRlU291cmNlLm5leHQoYXJncyk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIE5vdGlmaWVzIHRoZSBTY2hlZHVsZXIgdGhhdCB0aGUgdmlldyBvcHRpb25zIGhhdmUgYmVlbiBjaGFuZ2VkLlxuICAgICAqL1xuICAgIG5vdGlmeU9wdGlvbnNDaGFuZ2UoKSB7XG4gICAgICAgIHRoaXMub3B0aW9uc0NoYW5nZVNvdXJjZS5uZXh0KG51bGwpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBFbWl0cyBhIERPTSBldmVudCB0byB0aGUgU2NoZWR1bGVyLlxuICAgICAqL1xuICAgIGVtaXRFdmVudChuYW1lLCBhcmdzKSB7XG4gICAgICAgIHRoaXMudmlld0V2ZW50U291cmNlLm5leHQoe1xuICAgICAgICAgICAgbmFtZTogbmFtZSxcbiAgICAgICAgICAgIGFyZ3M6IGFyZ3NcbiAgICAgICAgfSk7XG4gICAgfVxufVxuVmlld1N0YXRlU2VydmljZS5kZWNvcmF0b3JzID0gW1xuICAgIHsgdHlwZTogSW5qZWN0YWJsZSB9LFxuXTtcbi8qKiBAbm9jb2xsYXBzZSAqL1xuVmlld1N0YXRlU2VydmljZS5jdG9yUGFyYW1ldGVycyA9ICgpID0+IFtdO1xuXG5jb25zdCBGSUVMRF9SRUdFWCA9IC9cXFsoPzooXFxkKyl8WydcIl0oLio/KVsnXCJdKVxcXXwoKD86KD8hXFxbLio/XFxdfFxcLikuKSspL2c7XG5jb25zdCBnZXR0ZXJDYWNoZSA9IHt9O1xuZ2V0dGVyQ2FjaGVbJ3VuZGVmaW5lZCddID0gKCkgPT4gdW5kZWZpbmVkO1xuLyoqXG4gKiBAaGlkZGVuXG4gKlxuICogVE9ETzogTW92ZSB0byBAcHJvZ3Jlc3Mva2VuZG8tY29tbW9uXG4gKi9cbmZ1bmN0aW9uIGdldHRlcihmaWVsZCkge1xuICAgIGlmIChnZXR0ZXJDYWNoZVtmaWVsZF0pIHtcbiAgICAgICAgcmV0dXJuIGdldHRlckNhY2hlW2ZpZWxkXTtcbiAgICB9XG4gICAgY29uc3QgZmllbGRzID0gW107XG4gICAgZmllbGQucmVwbGFjZShGSUVMRF9SRUdFWCwgZnVuY3Rpb24gKF9tYXRjaCwgaW5kZXgsIGluZGV4QWNjZXNzb3IsIGZpZWxkTmFtZSkge1xuICAgICAgICBmaWVsZHMucHVzaChpbmRleCAhPT0gdW5kZWZpbmVkID8gaW5kZXggOiAoaW5kZXhBY2Nlc3NvciB8fCBmaWVsZE5hbWUpKTtcbiAgICB9KTtcbiAgICBnZXR0ZXJDYWNoZVtmaWVsZF0gPSBmdW5jdGlvbiAob2JqKSB7XG4gICAgICAgIGxldCByZXN1bHQgPSBvYmo7XG4gICAgICAgIGZvciAobGV0IGlkeCA9IDA7IGlkeCA8IGZpZWxkcy5sZW5ndGggJiYgcmVzdWx0OyBpZHgrKykge1xuICAgICAgICAgICAgcmVzdWx0ID0gcmVzdWx0W2ZpZWxkc1tpZHhdXTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH07XG4gICAgcmV0dXJuIGdldHRlckNhY2hlW2ZpZWxkXTtcbn1cblxuY29uc3QgRklFTERfUkVHRVgkMSA9IC9cXFsoPzooXFxkKyl8WydcIl0oLio/KVsnXCJdKVxcXXwoKD86KD8hXFxbLio/XFxdfFxcLikuKSspL2c7XG5jb25zdCBzZXR0ZXJDYWNoZSA9IHt9O1xuc2V0dGVyQ2FjaGVbJ3VuZGVmaW5lZCddID0gb2JqID0+IG9iajtcbi8qKlxuICogQGhpZGRlblxuICpcbiAqIFRPRE86IE1vdmUgdG8gQHByb2dyZXNzL2tlbmRvLWNvbW1vblxuICovXG5mdW5jdGlvbiBzZXR0ZXIoZmllbGQpIHtcbiAgICBpZiAoc2V0dGVyQ2FjaGVbZmllbGRdKSB7XG4gICAgICAgIHJldHVybiBzZXR0ZXJDYWNoZVtmaWVsZF07XG4gICAgfVxuICAgIGNvbnN0IGZpZWxkcyA9IFtdO1xuICAgIGZpZWxkLnJlcGxhY2UoRklFTERfUkVHRVgkMSwgZnVuY3Rpb24gKF9tYXRjaCwgaW5kZXgsIGluZGV4QWNjZXNzb3IsIGZpZWxkTmFtZSkge1xuICAgICAgICBmaWVsZHMucHVzaChpbmRleCAhPT0gdW5kZWZpbmVkID8gaW5kZXggOiAoaW5kZXhBY2Nlc3NvciB8fCBmaWVsZE5hbWUpKTtcbiAgICB9KTtcbiAgICBzZXR0ZXJDYWNoZVtmaWVsZF0gPSBmdW5jdGlvbiAob2JqLCB2YWx1ZSkge1xuICAgICAgICBsZXQgcm9vdCA9IG9iajtcbiAgICAgICAgY29uc3QgZGVwdGggPSBmaWVsZHMubGVuZ3RoIC0gMTtcbiAgICAgICAgZm9yIChsZXQgaWR4ID0gMDsgaWR4IDwgZGVwdGggJiYgcm9vdDsgaWR4KyspIHtcbiAgICAgICAgICAgIHJvb3QgPSByb290W2ZpZWxkc1tpZHhdXSA9IHJvb3RbZmllbGRzW2lkeF1dIHx8IHt9O1xuICAgICAgICB9XG4gICAgICAgIHJvb3RbZmllbGRzW2RlcHRoXV0gPSB2YWx1ZTtcbiAgICB9O1xuICAgIHJldHVybiBzZXR0ZXJDYWNoZVtmaWVsZF07XG59XG5cbi8qKlxuICogQGhpZGRlblxuICovXG5jb25zdCBPQ0NVUlJFTkNFX0lEID0gMDtcblxuLyoqXG4gKiBAaGlkZGVuXG4gKlxuICogVE9ETzogTW92ZSB0byBAcHJvZ3Jlc3Mva2VuZG8tY29tbW9uXG4gKi9cbmNvbnN0IGNhcGl0YWxpemUgPSAodmFsdWUpID0+IHZhbHVlLmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpICsgdmFsdWUuc2xpY2UoMSk7XG4vKipcbiAqIEBoaWRkZW5cbiAqXG4gKiBUT0RPOiBNb3ZlIHRvIEBwcm9ncmVzcy9rZW5kby1jb21tb25cbiAqL1xuY29uc3QgaXNQcmVzZW50ID0gKHZhbHVlKSA9PiB2YWx1ZSAhPT0gbnVsbCAmJiB2YWx1ZSAhPT0gdW5kZWZpbmVkO1xuLyoqXG4gKiBAaGlkZGVuXG4gKlxuICogVE9ETzogTW92ZSB0byBAcHJvZ3Jlc3Mva2VuZG8tY29tbW9uXG4gKi9cbmNvbnN0IGlzQmxhbmsgPSAodmFsdWUpID0+IHZhbHVlID09PSBudWxsIHx8IHZhbHVlID09PSB1bmRlZmluZWQ7XG4vKipcbiAqIEBoaWRkZW5cbiAqXG4gKiBUT0RPOiBNb3ZlIHRvIEBwcm9ncmVzcy9rZW5kby1jb21tb25cbiAqL1xuY29uc3QgaXNBcnJheSA9ICh2YWx1ZSkgPT4gQXJyYXkuaXNBcnJheSh2YWx1ZSk7XG4vKipcbiAqIEBoaWRkZW5cbiAqXG4gKiBUT0RPOiBNb3ZlIHRvIEBwcm9ncmVzcy9rZW5kby1jb21tb25cbiAqL1xuY29uc3QgaXNOdWxsT3JFbXB0eVN0cmluZyA9ICh2YWx1ZSkgPT4gaXNCbGFuayh2YWx1ZSkgfHwgKHZhbHVlLnRyaW0gJiYgdmFsdWUudHJpbSgpLmxlbmd0aCA9PT0gMCk7XG4vKipcbiAqIEBoaWRkZW5cbiAqXG4gKiBUT0RPOiBNb3ZlIHRvIEBwcm9ncmVzcy9rZW5kby1jb21tb25cbiAqL1xuY29uc3QgaXNOdW1iZXIgPSAodmFsdWUpID0+IHR5cGVvZiB2YWx1ZSA9PT0gXCJudW1iZXJcIiAmJiAhaXNOYU4odmFsdWUpO1xuLyoqXG4gKiBAaGlkZGVuXG4gKlxuICogVE9ETzogTW92ZSB0byBAcHJvZ3Jlc3Mva2VuZG8tY29tbW9uXG4gKi9cbmNvbnN0IGlzU3RyaW5nID0gKHZhbHVlKSA9PiB0eXBlb2YgdmFsdWUgPT09ICdzdHJpbmcnO1xuLyoqXG4gKiBAaGlkZGVuXG4gKlxuICogVE9ETzogTW92ZSB0byBAcHJvZ3Jlc3Mva2VuZG8tY29tbW9uXG4gKi9cbmNvbnN0IGlzT2JqZWN0ID0gKHZhbHVlKSA9PiB0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnO1xuLyoqXG4gKiBAaGlkZGVuXG4gKi9cbmNvbnN0IGlzUmVjdXJyaW5nID0gKGV2ZW50LCBmaWVsZHMpID0+IHtcbiAgICBjb25zdCByZWN1cnJlbmNlSWQgPSBnZXR0ZXIoZmllbGRzLnJlY3VycmVuY2VJZCkoZXZlbnQpO1xuICAgIGNvbnN0IHJlY3VycmVuY2VSdWxlID0gZ2V0dGVyKGZpZWxkcy5yZWN1cnJlbmNlUnVsZSkoZXZlbnQpO1xuICAgIHJldHVybiAhIShyZWN1cnJlbmNlUnVsZSB8fCByZWN1cnJlbmNlSWQpO1xufTtcbi8qKlxuICogQGhpZGRlblxuICovXG5jb25zdCBpc0V4Y2VwdGlvbiA9IChldmVudCwgZmllbGRzKSA9PiB7XG4gICAgY29uc3QgaWQgPSBnZXR0ZXIoZmllbGRzLmlkKShldmVudCk7XG4gICAgY29uc3QgcmVjdXJyZW5jZUlkID0gZ2V0dGVyKGZpZWxkcy5yZWN1cnJlbmNlSWQpKGV2ZW50KTtcbiAgICByZXR1cm4gaXNQcmVzZW50KGlkKSAmJiBpZCAhPT0gT0NDVVJSRU5DRV9JRCAmJiBpc1ByZXNlbnQocmVjdXJyZW5jZUlkKTtcbn07XG4vKipcbiAqIEBoaWRkZW5cbiAqL1xuY29uc3QgY29weVJlc291cmNlcyA9IChldmVudCwgcmVzb3VyY2VzKSA9PiB7XG4gICAgaWYgKHJlc291cmNlcykge1xuICAgICAgICBmb3IgKGxldCBpZHggPSAwOyBpZHggPCByZXNvdXJjZXMubGVuZ3RoOyBpZHgrKykge1xuICAgICAgICAgICAgYXNzaWduRmllbGQoZXZlbnQsIGV2ZW50LmRhdGFJdGVtLCByZXNvdXJjZXNbaWR4XS5maWVsZCk7XG4gICAgICAgIH1cbiAgICB9XG59O1xuLyoqXG4gKiBAaGlkZGVuXG4gKi9cbmNvbnN0IHJlYWRFdmVudCA9IChkYXRhSXRlbSwgZmllbGRzLCByZXNvdXJjZXMpID0+IHtcbiAgICBjb25zdCByZXN1bHQgPSB7XG4gICAgICAgIGlkOiBnZXR0ZXIoZmllbGRzLmlkKShkYXRhSXRlbSksXG4gICAgICAgIHN0YXJ0OiBnZXR0ZXIoZmllbGRzLnN0YXJ0KShkYXRhSXRlbSksXG4gICAgICAgIHN0YXJ0VGltZXpvbmU6IGdldHRlcihmaWVsZHMuc3RhcnRUaW1lem9uZSkoZGF0YUl0ZW0pLFxuICAgICAgICBlbmQ6IGdldHRlcihmaWVsZHMuZW5kKShkYXRhSXRlbSksXG4gICAgICAgIGVuZFRpbWV6b25lOiBnZXR0ZXIoZmllbGRzLmVuZFRpbWV6b25lKShkYXRhSXRlbSksXG4gICAgICAgIGlzQWxsRGF5OiBnZXR0ZXIoZmllbGRzLmlzQWxsRGF5KShkYXRhSXRlbSksXG4gICAgICAgIHRpdGxlOiBnZXR0ZXIoZmllbGRzLnRpdGxlKShkYXRhSXRlbSksXG4gICAgICAgIGRlc2NyaXB0aW9uOiBnZXR0ZXIoZmllbGRzLmRlc2NyaXB0aW9uKShkYXRhSXRlbSksXG4gICAgICAgIHJlY3VycmVuY2VSdWxlOiBnZXR0ZXIoZmllbGRzLnJlY3VycmVuY2VSdWxlKShkYXRhSXRlbSksXG4gICAgICAgIHJlY3VycmVuY2VFeGNlcHRpb25zOiBnZXR0ZXIoZmllbGRzLnJlY3VycmVuY2VFeGNlcHRpb25zKShkYXRhSXRlbSksXG4gICAgICAgIHJlY3VycmVuY2VJZDogZ2V0dGVyKGZpZWxkcy5yZWN1cnJlbmNlSWQpKGRhdGFJdGVtKSxcbiAgICAgICAgZGF0YUl0ZW1cbiAgICB9O1xuICAgIGNvcHlSZXNvdXJjZXMocmVzdWx0LCByZXNvdXJjZXMpO1xuICAgIHJldHVybiByZXN1bHQ7XG59O1xuLyoqXG4gKiBAaGlkZGVuXG4gKi9cbmNvbnN0IGlzUmVjdXJyZW5jZU1hc3RlciA9IChldmVudCkgPT4gZXZlbnQucmVjdXJyZW5jZVJ1bGUgJiYgIWlzUHJlc2VudChldmVudC5yZWN1cnJlbmNlSWQpO1xuLyoqXG4gKiBAaGlkZGVuXG4gKi9cbmZ1bmN0aW9uIGdyb3VwUmVzb3VyY2VzKGdyb3VwLCByZXNvdXJjZXMpIHtcbiAgICBjb25zdCByZXN1bHQgPSBbXTtcbiAgICBpZiAoZ3JvdXAgJiYgZ3JvdXAucmVzb3VyY2VzICYmIGdyb3VwLnJlc291cmNlcy5sZW5ndGgpIHtcbiAgICAgICAgY29uc3QgZ3JvdXBzID0gZ3JvdXAucmVzb3VyY2VzO1xuICAgICAgICBmb3IgKGxldCBpZHggPSAwOyBpZHggPCBncm91cHMubGVuZ3RoOyBpZHgrKykge1xuICAgICAgICAgICAgY29uc3QgcmVzb3VyY2UgPSByZXNvdXJjZXMuZmluZChyID0+IHIubmFtZSA9PT0gZ3JvdXBzW2lkeF0pO1xuICAgICAgICAgICAgcmVzdWx0LnB1c2gocmVzb3VyY2UpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiByZXN1bHQ7XG59XG4vKipcbiAqIEBoaWRkZW5cbiAqL1xuY29uc3QgZ2V0RmllbGQgPSAob2JqLCBmaWVsZCkgPT4gZ2V0dGVyKGZpZWxkKShvYmopO1xuLyoqXG4gKiBAaGlkZGVuXG4gKi9cbmNvbnN0IHNldEZpZWxkID0gKG9iaiwgZmllbGQsIHZhbHVlKSA9PiBzZXR0ZXIoZmllbGQpKG9iaiwgdmFsdWUpO1xuLyoqXG4gKiBAaGlkZGVuXG4gKi9cbmZ1bmN0aW9uIGFzc2lnbkZpZWxkKHRhcmdldCwgc291cmNlLCBmaWVsZCkge1xuICAgIHNldEZpZWxkKHRhcmdldCwgZmllbGQsIGdldEZpZWxkKHNvdXJjZSwgZmllbGQpKTtcbn1cbi8qKlxuICogQGhpZGRlblxuICovXG5mdW5jdGlvbiBhc3NpZ25WYWx1ZXModGFyZ2V0LCBzb3VyY2UpIHtcbiAgICBjbG9uZVRvKHNvdXJjZSwgdGFyZ2V0KTtcbiAgICByZXR1cm4gdGFyZ2V0O1xufVxuLyoqXG4gKiBAaGlkZGVuXG4gKi9cbmZ1bmN0aW9uIGNsb25lVG8ob2JqLCByZXN1bHQpIHtcbiAgICBmb3IgKGxldCBmaWVsZCBpbiBvYmopIHtcbiAgICAgICAgaWYgKG9iai5oYXNPd25Qcm9wZXJ0eShmaWVsZCkpIHtcbiAgICAgICAgICAgIGNvbnN0IHZhbHVlID0gb2JqW2ZpZWxkXTtcbiAgICAgICAgICAgIGlmIChBcnJheS5pc0FycmF5KHZhbHVlKSkge1xuICAgICAgICAgICAgICAgIHJlc3VsdFtmaWVsZF0gPSB2YWx1ZS5zbGljZSgwKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKHZhbHVlICYmIHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcgJiYgISh2YWx1ZSBpbnN0YW5jZW9mIERhdGUpKSB7XG4gICAgICAgICAgICAgICAgcmVzdWx0W2ZpZWxkXSA9IHJlc3VsdFtmaWVsZF0gfHwge307XG4gICAgICAgICAgICAgICAgY2xvbmVUbyh2YWx1ZSwgcmVzdWx0W2ZpZWxkXSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICByZXN1bHRbZmllbGRdID0gdmFsdWU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG59XG4vKipcbiAqIEBoaWRkZW5cbiAqL1xuZnVuY3Rpb24gY2xvbmUob2JqKSB7XG4gICAgY29uc3QgcmVzdWx0ID0ge307XG4gICAgY2xvbmVUbyhvYmosIHJlc3VsdCk7XG4gICAgcmV0dXJuIHJlc3VsdDtcbn1cbi8qKiBAaGlkZGVuICovXG5jb25zdCBpdGVyYXRvciA9IGdldEl0ZXJhdG9yKCk7XG4vLyBUT0RPOiBNb3ZlIHRvIGtlbmRvLWNvbW1vblxuZnVuY3Rpb24gZ2V0SXRlcmF0b3IoKSB7XG4gICAgaWYgKHR5cGVvZiBTeW1ib2wgPT09ICdmdW5jdGlvbicgJiYgU3ltYm9sLml0ZXJhdG9yKSB7XG4gICAgICAgIHJldHVybiBTeW1ib2wuaXRlcmF0b3I7XG4gICAgfVxuICAgIGNvbnN0IGtleXMgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyhNYXAucHJvdG90eXBlKTtcbiAgICBjb25zdCBwcm90byA9IE1hcC5wcm90b3R5cGU7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBrZXlzLmxlbmd0aDsgKytpKSB7XG4gICAgICAgIGNvbnN0IGtleSA9IGtleXNbaV07XG4gICAgICAgIGlmIChrZXkgIT09ICdlbnRyaWVzJyAmJiBrZXkgIT09ICdzaXplJyAmJiBwcm90b1trZXldID09PSBwcm90by5lbnRyaWVzKSB7XG4gICAgICAgICAgICByZXR1cm4ga2V5O1xuICAgICAgICB9XG4gICAgfVxufVxuLyoqXG4gKiBAaGlkZGVuXG4gKi9cbmZ1bmN0aW9uIGZyb21DbGljayhlbGVtZW50KSB7XG4gICAgcmV0dXJuIGZyb21FdmVudChlbGVtZW50LCAnY2xpY2snKTtcbn1cbi8qKlxuICogQGhpZGRlblxuICovXG5mdW5jdGlvbiBmcm9tRG91YmxlQ2xpY2soZWxlbWVudCkge1xuICAgIGNvbnN0IERCTENMSUNLX0RFTEFZID0gMjUwO1xuICAgIGNvbnN0IGNsaWNrcyA9IGZyb21DbGljayhlbGVtZW50KTtcbiAgICBjb25zdCBlbmRTZXF1ZW5jZSA9IGNsaWNrcy5waXBlKGF1ZGl0VGltZShEQkxDTElDS19ERUxBWSkpO1xuICAgIHJldHVybiBjbGlja3MucGlwZShidWZmZXIoZW5kU2VxdWVuY2UpLCBmaWx0ZXIoc2VxdWVuY2UgPT4gc2VxdWVuY2UubGVuZ3RoID09PSAyKSwgZmlsdGVyKChzZXF1ZW5jZSkgPT4gc2VxdWVuY2VbMV0udGFyZ2V0ID09PSBzZXF1ZW5jZVswXS50YXJnZXQpLCBtYXAoc2VxdWVuY2UgPT4gc2VxdWVuY2VbMV0pKTtcbn1cbi8qKlxuICogQGhpZGRlblxuICovXG5mdW5jdGlvbiBzb3J0VGFza3NCeVRpbWUodGFza3MpIHtcbiAgICB0YXNrcy5zb3J0KChhLCBiKSA9PiAoYS5zdGFydFRpbWUgLSBiLnN0YXJ0VGltZSkgfHwgKGIuZW5kVGltZSAtIGEuZW5kVGltZSkpO1xuICAgIHJldHVybiB0YXNrcztcbn1cblxuLy8gY29uc3QgdG9TaW1pbGFyRGF0ZSA9IChkYXRlOiBab25lZERhdGUpOiBEYXRlID0+IG5ldyBEYXRlKFxuLy8gICAgIGRhdGUuZ2V0RnVsbFllYXIoKSwgZGF0ZS5nZXRNb250aCgpLCBkYXRlLmdldERheSgpLFxuLy8gICAgIGRhdGUuZ2V0SG91cnMoKSwgZGF0ZS5nZXRNaW51dGVzKCksIGRhdGUuZ2V0U2Vjb25kcygpLFxuLy8gICAgIGRhdGUuZ2V0TWlsbGlzZWNvbmRzKClcbi8vICAgKTtcbi8vIGNvbnN0IHRvVVRDRGF0ZVRpbWUgPSAobG9jYWxEYXRlOiBEYXRlKTogRGF0ZSA9PiBuZXcgRGF0ZShEYXRlLlVUQyhcbi8vICAgICAgIGxvY2FsRGF0ZS5nZXRGdWxsWWVhcigpLFxuLy8gICAgICAgbG9jYWxEYXRlLmdldE1vbnRoKCksXG4vLyAgICAgICBsb2NhbERhdGUuZ2V0RGF0ZSgpLFxuLy8gICAgICAgbG9jYWxEYXRlLmdldEhvdXJzKCksXG4vLyAgICAgICBsb2NhbERhdGUuZ2V0TWludXRlcygpLFxuLy8gICAgICAgbG9jYWxEYXRlLmdldFNlY29uZHMoKSxcbi8vICAgICAgIGxvY2FsRGF0ZS5nZXRNaWxsaXNlY29uZHMoKVxuLy8gICAgICkpO1xuLyoqXG4gKiBAaGlkZGVuXG4gKi9cbmNsYXNzIEVkaXRTZXJ2aWNlIHtcbiAgICBjb25zdHJ1Y3RvcihuZ1pvbmUpIHtcbiAgICAgICAgdGhpcy5uZ1pvbmUgPSBuZ1pvbmU7XG4gICAgICAgIHRoaXMuY2hhbmdlcyA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcbiAgICAgICAgdGhpcy5jaGFuZ2VkU291cmNlID0gbmV3IFN1YmplY3QoKTtcbiAgICAgICAgdGhpcy5jaGFuZ2VkID0gdGhpcy5jaGFuZ2VkU291cmNlLmFzT2JzZXJ2YWJsZSgpLnBpcGUoZGVib3VuY2VUaW1lKDApKTtcbiAgICB9XG4gICAgZW5kRWRpdCgpIHtcbiAgICAgICAgY29uc3QgZm9ybUdyb3VwID0gdGhpcy5oYXNOZXdFdmVudCA/IHRoaXMubmV3RXZlbnRHcm91cC5ncm91cCA6IHRoaXMuZWRpdGVkRXZlbnQuZm9ybUdyb3VwO1xuICAgICAgICB0aGlzLmNoYW5nZXMuZW1pdCh7IGFjdGlvbjogJ2NhbmNlbCcsIGZvcm1Hcm91cCB9KTtcbiAgICB9XG4gICAgcmVtb3ZlRXZlbnQoZGF0YUl0ZW0pIHtcbiAgICAgICAgdGhpcy5jaGFuZ2VzLmVtaXQoeyBhY3Rpb246ICdyZW1vdmUnLCBkYXRhSXRlbSB9KTtcbiAgICB9XG4gICAgYWRkRXZlbnQoZm9ybUdyb3VwKSB7XG4gICAgICAgIHRoaXMubmV3RXZlbnRHcm91cCA9IHsgZm9ybUdyb3VwIH07XG4gICAgICAgIHRoaXMub25DaGFuZ2VkKCk7XG4gICAgfVxuICAgIGVkaXRFdmVudChkYXRhSXRlbSwgZm9ybUdyb3VwID0gdW5kZWZpbmVkLCBtb2RlKSB7XG4gICAgICAgIHRoaXMuZWRpdGVkRXZlbnQgPSB7IGRhdGFJdGVtLCBmb3JtR3JvdXAsIG1vZGUgfTtcbiAgICAgICAgdGhpcy5vbkNoYW5nZWQoKTtcbiAgICB9XG4gICAgY2xvc2UoKSB7XG4gICAgICAgIHRoaXMubmV3RXZlbnRHcm91cCA9IHRoaXMuZWRpdGVkRXZlbnQgPSBudWxsO1xuICAgICAgICB0aGlzLm9uQ2hhbmdlZCgpO1xuICAgIH1cbiAgICBzYXZlKCkge1xuICAgICAgICBjb25zdCB7IGRhdGFJdGVtLCBmb3JtR3JvdXAgfSA9IHRoaXMuY29udGV4dDtcbiAgICAgICAgdGhpcy5jaGFuZ2VzLmVtaXQoe1xuICAgICAgICAgICAgYWN0aW9uOiAnc2F2ZScsXG4gICAgICAgICAgICBkYXRhSXRlbSxcbiAgICAgICAgICAgIGZvcm1Hcm91cCxcbiAgICAgICAgICAgIGlzTmV3OiB0aGlzLmhhc05ld0V2ZW50LFxuICAgICAgICAgICAgbW9kZTogdGhpcy5vY2N1cnJlbmNlRWRpdE1vZGVcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIGlzRWRpdGluZygpIHtcbiAgICAgICAgcmV0dXJuIGlzUHJlc2VudCh0aGlzLmNvbnRleHQpO1xuICAgIH1cbiAgICBnZXQgb2NjdXJyZW5jZUVkaXRNb2RlKCkge1xuICAgICAgICBpZiAodGhpcy5oYXNOZXdFdmVudCkge1xuICAgICAgICAgICAgcmV0dXJuIDIgLyogU2VyaWVzICovO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZWRpdGVkRXZlbnQubW9kZSB8fCAwIC8qIEV2ZW50ICovO1xuICAgICAgICB9XG4gICAgfVxuICAgIGdldCBoYXNOZXdFdmVudCgpIHtcbiAgICAgICAgcmV0dXJuIGlzUHJlc2VudCh0aGlzLm5ld0V2ZW50R3JvdXApO1xuICAgIH1cbiAgICBnZXQgbmV3RXZlbnQoKSB7XG4gICAgICAgIGlmICh0aGlzLmhhc05ld0V2ZW50KSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5uZXdFdmVudEdyb3VwLmdyb3VwLnZhbHVlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB7fTtcbiAgICB9XG4gICAgZ2V0IGNvbnRleHQoKSB7XG4gICAgICAgIGlmICh0aGlzLmhhc05ld0V2ZW50KSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5uZXdFdmVudEdyb3VwO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLmVkaXRlZEV2ZW50O1xuICAgIH1cbiAgICBvbkNoYW5nZWQoKSB7XG4gICAgICAgIHRoaXMubmdab25lLnJ1bk91dHNpZGVBbmd1bGFyKCgpID0+IHtcbiAgICAgICAgICAgIHRoaXMuY2hhbmdlZFNvdXJjZS5uZXh0KCk7XG4gICAgICAgIH0pO1xuICAgIH1cbn1cbkVkaXRTZXJ2aWNlLmRlY29yYXRvcnMgPSBbXG4gICAgeyB0eXBlOiBJbmplY3RhYmxlIH0sXG5dO1xuLyoqIEBub2NvbGxhcHNlICovXG5FZGl0U2VydmljZS5jdG9yUGFyYW1ldGVycyA9ICgpID0+IFtcbiAgICB7IHR5cGU6IE5nWm9uZSB9XG5dO1xuXG4vKipcbiAqIFJlcHJlc2VudHMgdGhlIHRlbXBsYXRlIGZvciB0aGUgZWRpdCBkaWFsb2cgb2YgdGhlIFNjaGVkdWxlci5cbiAqIFRvIGRlZmluZSB0aGUgdGVtcGxhdGUsIG5lc3QgYW4gYDxuZy10ZW1wbGF0ZT5gIHRhZ1xuICogd2l0aCB0aGUgYGtlbmRvU2NoZWR1bGVyRWRpdERpYWxvZ1RlbXBsYXRlYCBkaXJlY3RpdmUgaW5zaWRlIHRoZSBgPGtlbmRvLXNjaGVkdWxlcj5gIHRhZy5cbiAqXG4gKiBUaGUgdGVtcGxhdGUgY29udGV4dCBpcyBzZXQgdG8gdGhlIGN1cnJlbnQgZXZlbnQgYW5kIHRoZW4gdGhlIGZvbGxvd2luZyBhZGRpdGlvbmFsIGZpZWxkcyBhcmUgcGFzc2VkOlxuICogLSBgZXZlbnRgJm1kYXNoO1RoZSBjdXJyZW50bHkgZWRpdGVkIGV2ZW50LiBSZXByZXNlbnRzIHRoZSBkZWZhdWx0IGNvbnRleHQgdGhhdCB3aWxsIGJlIGFzc2lnbmVkIHRvIGFueSB0ZW1wbGF0ZSB2YXJpYWJsZSB3aGljaCB1dGlsaXplcyB0aGUgYGxldC14YCBzeW50YXgmbWRhc2g7Zm9yIGV4YW1wbGUsIGBsZXQtZXZlbnRgLlxuICogLSBgZm9ybUdyb3VwYCZtZGFzaDtUaGUgY3VycmVudCBbYEZvcm1Hcm91cGBdKGh0dHBzOi8vYW5ndWxhci5pby9kb2NzL3RzL2xhdGVzdC9hcGkvZm9ybXMvaW5kZXgvRm9ybUdyb3VwLWNsYXNzLmh0bWwpLlxuICogLSBgZWRpdE1vZGVgJm1kYXNoO1RoZSBjdXJyZW50IGVkaXQgbW9kZS5cbiAqIC0gYGlzTmV3YCZtZGFzaDtUaGUgc3RhdGUgb2YgdGhlIGN1cnJlbnQgZXZlbnQuXG4gKi9cbmNsYXNzIEVkaXREaWFsb2dUZW1wbGF0ZURpcmVjdGl2ZSB7XG4gICAgY29uc3RydWN0b3IodGVtcGxhdGVSZWYpIHtcbiAgICAgICAgdGhpcy50ZW1wbGF0ZVJlZiA9IHRlbXBsYXRlUmVmO1xuICAgIH1cbn1cbkVkaXREaWFsb2dUZW1wbGF0ZURpcmVjdGl2ZS5kZWNvcmF0b3JzID0gW1xuICAgIHsgdHlwZTogRGlyZWN0aXZlLCBhcmdzOiBbe1xuICAgICAgICAgICAgICAgIHNlbGVjdG9yOiAnW2tlbmRvU2NoZWR1bGVyRWRpdERpYWxvZ1RlbXBsYXRlXSdcbiAgICAgICAgICAgIH0sXSB9LFxuXTtcbi8qKiBAbm9jb2xsYXBzZSAqL1xuRWRpdERpYWxvZ1RlbXBsYXRlRGlyZWN0aXZlLmN0b3JQYXJhbWV0ZXJzID0gKCkgPT4gW1xuICAgIHsgdHlwZTogVGVtcGxhdGVSZWYsIGRlY29yYXRvcnM6IFt7IHR5cGU6IE9wdGlvbmFsIH1dIH1cbl07XG5FZGl0RGlhbG9nVGVtcGxhdGVEaXJlY3RpdmUucHJvcERlY29yYXRvcnMgPSB7XG4gICAgYXV0b0ZvY3VzZWRFbGVtZW50OiBbeyB0eXBlOiBJbnB1dCB9XVxufTtcblxuLyoqXG4gKiBAaGlkZGVuXG4gKi9cbmNsYXNzIExvY2FsRGF0YUNoYW5nZXNTZXJ2aWNlIHtcbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgdGhpcy5jaGFuZ2VzID0gbmV3IEV2ZW50RW1pdHRlcigpO1xuICAgIH1cbn1cbkxvY2FsRGF0YUNoYW5nZXNTZXJ2aWNlLmRlY29yYXRvcnMgPSBbXG4gICAgeyB0eXBlOiBJbmplY3RhYmxlIH0sXG5dO1xuXG4vKipcbiAqIEBoaWRkZW5cbiAqL1xuY2xhc3MgRG9tRXZlbnRzU2VydmljZSB7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHRoaXMuZm9jdXMgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XG4gICAgICAgIHRoaXMuZm9jdXNJbiA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcbiAgICAgICAgdGhpcy5mb2N1c091dCA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcbiAgICAgICAgdGhpcy5jbGljayA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcbiAgICAgICAgdGhpcy5rZXlkb3duID0gbmV3IEV2ZW50RW1pdHRlcigpO1xuICAgICAgICB0aGlzLndpbmRvd0JsdXIgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XG4gICAgfVxufVxuRG9tRXZlbnRzU2VydmljZS5kZWNvcmF0b3JzID0gW1xuICAgIHsgdHlwZTogSW5qZWN0YWJsZSB9LFxuXTtcblxuLyoqXG4gKiBAaGlkZGVuXG4gKi9cbmNsYXNzIEZvY3VzU2VydmljZSB7XG4gICAgY29uc3RydWN0b3IocmVuZGVyZXIsIHdyYXBwZXIsIGRvbUV2ZW50cykge1xuICAgICAgICB0aGlzLnJlbmRlcmVyID0gcmVuZGVyZXI7XG4gICAgICAgIHRoaXMud3JhcHBlciA9IHdyYXBwZXI7XG4gICAgICAgIHRoaXMuZG9tRXZlbnRzID0gZG9tRXZlbnRzO1xuICAgICAgICB0aGlzLml0ZW1zID0gbmV3IFNldCgpO1xuICAgICAgICB0aGlzLmVsZW1lbnRNYXAgPSBuZXcgV2Vha01hcCgpO1xuICAgICAgICB0aGlzLnN1YnMgPSBuZXcgU3Vic2NyaXB0aW9uKCk7XG4gICAgICAgIHRoaXMuc3Vicy5hZGQodGhpcy5kb21FdmVudHMuZm9jdXMuc3Vic2NyaWJlKGUgPT4gdGhpcy5vbkZvY3VzSW4oZSkpKTtcbiAgICAgICAgdGhpcy5zdWJzLmFkZCh0aGlzLmRvbUV2ZW50cy5mb2N1c091dC5zdWJzY3JpYmUoKCkgPT4gdGhpcy5vbkZvY3VzT3V0KCkpKTtcbiAgICB9XG4gICAgZ2V0IGFjdGl2ZUVsZW1lbnQoKSB7XG4gICAgICAgIGlmICh0aGlzLmFjdGl2ZUl0ZW0pIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmFjdGl2ZUl0ZW0uZWxlbWVudDtcbiAgICAgICAgfVxuICAgIH1cbiAgICBuZ09uRGVzdHJveSgpIHtcbiAgICAgICAgdGhpcy5zdWJzLnVuc3Vic2NyaWJlKCk7XG4gICAgfVxuICAgIHJlZ2lzdGVyKGl0ZW0pIHtcbiAgICAgICAgaWYgKCF0aGlzLmFjdGl2ZUl0ZW0pIHtcbiAgICAgICAgICAgIHRoaXMuYWN0aXZlSXRlbSA9IGl0ZW07XG4gICAgICAgICAgICBpdGVtLnRvZ2dsZSh0cnVlKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLml0ZW1zLmFkZChpdGVtKTtcbiAgICAgICAgdGhpcy5lbGVtZW50TWFwLnNldChpdGVtLmVsZW1lbnQubmF0aXZlRWxlbWVudCwgaXRlbSk7XG4gICAgICAgIHRoaXMudG9nZ2xlV3JhcHBlcigpO1xuICAgIH1cbiAgICB1bnJlZ2lzdGVyKGl0ZW0pIHtcbiAgICAgICAgdGhpcy5pdGVtcy5kZWxldGUoaXRlbSk7XG4gICAgICAgIHRoaXMuZWxlbWVudE1hcC5kZWxldGUoaXRlbS5lbGVtZW50Lm5hdGl2ZUVsZW1lbnQpO1xuICAgICAgICBpZiAoaXRlbSA9PT0gdGhpcy5hY3RpdmVJdGVtKSB7XG4gICAgICAgICAgICB0aGlzLmFjdGl2YXRlTmV4dCgpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMudG9nZ2xlV3JhcHBlcigpO1xuICAgIH1cbiAgICBmb2N1cygpIHtcbiAgICAgICAgaWYgKHRoaXMuYWN0aXZlSXRlbSkge1xuICAgICAgICAgICAgdGhpcy5hY3RpdmVJdGVtLmZvY3VzKCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLndyYXBwZXIubmF0aXZlRWxlbWVudC5mb2N1cygpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGZvY3VzTmV4dChvcHRpb25zKSB7XG4gICAgICAgIGNvbnN0IGN1cnJlbnRJdGVtID0gdGhpcy5hY3RpdmVJdGVtO1xuICAgICAgICB0aGlzLmFjdGl2YXRlTmV4dChvcHRpb25zKTtcbiAgICAgICAgaWYgKHRoaXMuYWN0aXZlSXRlbSkge1xuICAgICAgICAgICAgdGhpcy5hY3RpdmVJdGVtLmZvY3VzKCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXMuYWN0aXZlSXRlbSAhPT0gY3VycmVudEl0ZW07XG4gICAgfVxuICAgIGFjdGl2YXRlKG5leHQpIHtcbiAgICAgICAgdGhpcy5pdGVtcy5mb3JFYWNoKGl0ZW0gPT4gaXRlbS50b2dnbGUoaXRlbSA9PT0gbmV4dCkpO1xuICAgICAgICB0aGlzLmFjdGl2ZUl0ZW0gPSBuZXh0O1xuICAgIH1cbiAgICBhY3RpdmF0ZU5leHQocG9zaXRpb24pIHtcbiAgICAgICAgdGhpcy5hY3RpdmVJdGVtID0gdGhpcy5maW5kTmV4dChwb3NpdGlvbik7XG4gICAgfVxuICAgIGZpbmROZXh0KHBvc2l0aW9uKSB7XG4gICAgICAgIGNvbnN0IHsgb2Zmc2V0LCBub3dyYXAgfSA9IE9iamVjdC5hc3NpZ24oeyBub3dyYXA6IGZhbHNlLCBvZmZzZXQ6IDEgfSwgcG9zaXRpb24pO1xuICAgICAgICBjb25zdCBpdGVtcyA9IEFycmF5LmZyb20odGhpcy5pdGVtcy52YWx1ZXMoKSlcbiAgICAgICAgICAgIC5maWx0ZXIoaXRlbSA9PiBpdGVtLmNhbkZvY3VzKCkpXG4gICAgICAgICAgICAuc29ydCgoYSwgYikgPT4gYS5mb2N1c0luZGV4IC0gYi5mb2N1c0luZGV4KTtcbiAgICAgICAgaWYgKGl0ZW1zLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCF0aGlzLmFjdGl2ZUl0ZW0pIHtcbiAgICAgICAgICAgIHJldHVybiBub3dyYXAgPyBudWxsIDogaXRlbXNbMF07XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgaW5kZXggPSBpdGVtcy5pbmRleE9mKHRoaXMuYWN0aXZlSXRlbSk7XG4gICAgICAgIGxldCBuZXh0SW5kZXggPSBpbmRleCArIG9mZnNldDtcbiAgICAgICAgaWYgKG5vd3JhcCkge1xuICAgICAgICAgICAgbmV4dEluZGV4ID0gTWF0aC5tYXgoMCwgTWF0aC5taW4oaXRlbXMubGVuZ3RoIC0gMSwgbmV4dEluZGV4KSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBuZXh0SW5kZXggPSBuZXh0SW5kZXggJSBpdGVtcy5sZW5ndGg7XG4gICAgICAgICAgICBpZiAobmV4dEluZGV4IDwgMCkge1xuICAgICAgICAgICAgICAgIG5leHRJbmRleCA9IGl0ZW1zLmxlbmd0aCAtIDE7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGl0ZW1zW25leHRJbmRleF07XG4gICAgfVxuICAgIHRvZ2dsZVdyYXBwZXIoKSB7XG4gICAgICAgIGlmICh0aGlzLndyYXBwZXIpIHtcbiAgICAgICAgICAgIHRoaXMucmVuZGVyZXIuc2V0QXR0cmlidXRlKHRoaXMud3JhcHBlci5uYXRpdmVFbGVtZW50LCAndGFiaW5kZXgnLCB0aGlzLmFjdGl2ZUl0ZW0gPyAnLTEnIDogJzAnKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBvbkZvY3VzSW4oZSkge1xuICAgICAgICBjb25zdCBpdGVtID0gdGhpcy5lbGVtZW50TWFwLmdldChlLnRhcmdldCk7XG4gICAgICAgIGlmICghaXRlbSB8fCBpdGVtID09PSB0aGlzLmZvY3VzZWRJdGVtKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuZm9jdXNlZEl0ZW0pIHtcbiAgICAgICAgICAgIHRoaXMuZm9jdXNlZEl0ZW0udG9nZ2xlRm9jdXMoZmFsc2UpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuYWN0aXZhdGUoaXRlbSk7XG4gICAgICAgIGl0ZW0udG9nZ2xlRm9jdXModHJ1ZSk7XG4gICAgICAgIHRoaXMuZm9jdXNlZEl0ZW0gPSBpdGVtO1xuICAgIH1cbiAgICBvbkZvY3VzT3V0KCkge1xuICAgICAgICBpZiAoIXRoaXMuZm9jdXNlZEl0ZW0pIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmZvY3VzZWRJdGVtLnRvZ2dsZUZvY3VzKGZhbHNlKTtcbiAgICAgICAgdGhpcy5mb2N1c2VkSXRlbSA9IG51bGw7XG4gICAgfVxufVxuRm9jdXNTZXJ2aWNlLmRlY29yYXRvcnMgPSBbXG4gICAgeyB0eXBlOiBJbmplY3RhYmxlIH0sXG5dO1xuLyoqIEBub2NvbGxhcHNlICovXG5Gb2N1c1NlcnZpY2UuY3RvclBhcmFtZXRlcnMgPSAoKSA9PiBbXG4gICAgeyB0eXBlOiBSZW5kZXJlcjIsIGRlY29yYXRvcnM6IFt7IHR5cGU6IE9wdGlvbmFsIH1dIH0sXG4gICAgeyB0eXBlOiBFbGVtZW50UmVmLCBkZWNvcmF0b3JzOiBbeyB0eXBlOiBPcHRpb25hbCB9XSB9LFxuICAgIHsgdHlwZTogRG9tRXZlbnRzU2VydmljZSB9XG5dO1xuXG4vKipcbiAqIEBoaWRkZW5cbiAqL1xuY2xhc3MgRGlhbG9nc1NlcnZpY2Uge1xuICAgIGNvbnN0cnVjdG9yKGRpYWxvZ1NlcnZpY2UsIGxvY2FsaXphdGlvbiwgY2hhbmdlRGV0ZWN0b3IsIGZvY3VzU2VydmljZSwgdmlld1N0YXRlKSB7XG4gICAgICAgIHRoaXMuZGlhbG9nU2VydmljZSA9IGRpYWxvZ1NlcnZpY2U7XG4gICAgICAgIHRoaXMubG9jYWxpemF0aW9uID0gbG9jYWxpemF0aW9uO1xuICAgICAgICB0aGlzLmNoYW5nZURldGVjdG9yID0gY2hhbmdlRGV0ZWN0b3I7XG4gICAgICAgIHRoaXMuZm9jdXNTZXJ2aWNlID0gZm9jdXNTZXJ2aWNlO1xuICAgICAgICB0aGlzLnZpZXdTdGF0ZSA9IHZpZXdTdGF0ZTtcbiAgICAgICAgdGhpcy5pc09wZW4gPSBmYWxzZTtcbiAgICB9XG4gICAgb3BlblJlbW92ZUNvbmZpcm1hdGlvbkRpYWxvZygpIHtcbiAgICAgICAgY29uc3QgZGlhbG9nID0gdGhpcy5kaWFsb2dTZXJ2aWNlLm9wZW4oe1xuICAgICAgICAgICAgdGl0bGU6IHRoaXMudGV4dEZvcignZGVsZXRlRGlhbG9nVGl0bGUnKSxcbiAgICAgICAgICAgIGNvbnRlbnQ6IHRoaXMudGV4dEZvcignZGVsZXRlQ29uZmlybWF0aW9uJyksXG4gICAgICAgICAgICBhY3Rpb25zOiBbXG4gICAgICAgICAgICAgICAgeyB0ZXh0OiB0aGlzLnRleHRGb3IoJ2NhbmNlbCcpLCB2YWx1ZTogZmFsc2UgfSxcbiAgICAgICAgICAgICAgICB7IHRleHQ6IHRoaXMudGV4dEZvcignZGVzdHJveScpLCB2YWx1ZTogdHJ1ZSB9XG4gICAgICAgICAgICBdLFxuICAgICAgICAgICAgYXBwZW5kVG86IHRoaXMuY29udGFpbmVyLFxuICAgICAgICAgICAgYXV0b0ZvY3VzZWRFbGVtZW50OiAnYnV0dG9uOm50aC1jaGlsZCgyKSdcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuaXNPcGVuID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5jaGFuZ2VEZXRlY3Rvci5tYXJrRm9yQ2hlY2soKTtcbiAgICAgICAgcmV0dXJuIGRpYWxvZy5yZXN1bHQucGlwZShtYXAoKHJlc3VsdCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5pc09wZW4gPSBmYWxzZTtcbiAgICAgICAgICAgIGlmIChyZXN1bHQgaW5zdGFuY2VvZiBEaWFsb2dDbG9zZVJlc3VsdCkge1xuICAgICAgICAgICAgICAgIHRoaXMuZm9jdXNTZXJ2aWNlLmZvY3VzKCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy52aWV3U3RhdGUubGF5b3V0RW5kLnBpcGUodGFrZSgxKSkuc3Vic2NyaWJlKCgpID0+IHRoaXMuZm9jdXNTZXJ2aWNlLmZvY3VzKCkpO1xuICAgICAgICAgICAgY29uc3QgcmVzID0gcmVzdWx0O1xuICAgICAgICAgICAgcmV0dXJuIHJlcy52YWx1ZTtcbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICBvcGVuUmVjdXJyaW5nQ29uZmlybWF0aW9uRGlhbG9nKG9wZXJhdGlvbikge1xuICAgICAgICBjb25zdCBkaWFsb2cgPSB0aGlzLmRpYWxvZ1NlcnZpY2Uub3Blbih7XG4gICAgICAgICAgICBhY3Rpb25zOiBbXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICB0ZXh0OiBvcGVyYXRpb24gPT09IDAgLyogRWRpdCAqLyA/IHRoaXMudGV4dEZvcignZWRpdE9jY3VycmVuY2UnKSA6IHRoaXMudGV4dEZvcignZGVsZXRlT2NjdXJyZW5jZScpLFxuICAgICAgICAgICAgICAgICAgICB2YWx1ZTogMSAvKiBPY2N1cnJlbmNlICovXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIHRleHQ6IG9wZXJhdGlvbiA9PT0gMCAvKiBFZGl0ICovID8gdGhpcy50ZXh0Rm9yKCdlZGl0U2VyaWVzJykgOiB0aGlzLnRleHRGb3IoJ2RlbGV0ZVNlcmllcycpLFxuICAgICAgICAgICAgICAgICAgICB2YWx1ZTogMiAvKiBTZXJpZXMgKi9cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICBdLFxuICAgICAgICAgICAgYXBwZW5kVG86IHRoaXMuY29udGFpbmVyLFxuICAgICAgICAgICAgYXV0b0ZvY3VzZWRFbGVtZW50OiAnYnV0dG9uOm50aC1jaGlsZCgxKScsXG4gICAgICAgICAgICBjb250ZW50OiBvcGVyYXRpb24gPT09IDAgLyogRWRpdCAqLyA/IHRoaXMudGV4dEZvcignZWRpdFJlY3VycmluZ0NvbmZpcm1hdGlvbicpIDogdGhpcy50ZXh0Rm9yKCdkZWxldGVSZWN1cnJpbmdDb25maXJtYXRpb24nKSxcbiAgICAgICAgICAgIHRpdGxlOiBvcGVyYXRpb24gPT09IDAgLyogRWRpdCAqLyA/IHRoaXMudGV4dEZvcignZWRpdFJlY3VycmluZ0RpYWxvZ1RpdGxlJykgOiB0aGlzLnRleHRGb3IoJ2RlbGV0ZVJlY3VycmluZ0RpYWxvZ1RpdGxlJylcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuaXNPcGVuID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5jaGFuZ2VEZXRlY3Rvci5tYXJrRm9yQ2hlY2soKTtcbiAgICAgICAgcmV0dXJuIGRpYWxvZy5yZXN1bHQucGlwZShtYXAoKHJlc3VsdCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5pc09wZW4gPSBmYWxzZTtcbiAgICAgICAgICAgIHRoaXMuZm9jdXNTZXJ2aWNlLmZvY3VzKCk7XG4gICAgICAgICAgICBpZiAocmVzdWx0IGluc3RhbmNlb2YgRGlhbG9nQ2xvc2VSZXN1bHQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29uc3QgcmVzID0gcmVzdWx0O1xuICAgICAgICAgICAgcmV0dXJuIHJlcy52YWx1ZTtcbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICB0ZXh0Rm9yKGtleSkge1xuICAgICAgICByZXR1cm4gdGhpcy5sb2NhbGl6YXRpb24uZ2V0KGtleSk7XG4gICAgfVxufVxuRGlhbG9nc1NlcnZpY2UuZGVjb3JhdG9ycyA9IFtcbiAgICB7IHR5cGU6IEluamVjdGFibGUgfSxcbl07XG4vKiogQG5vY29sbGFwc2UgKi9cbkRpYWxvZ3NTZXJ2aWNlLmN0b3JQYXJhbWV0ZXJzID0gKCkgPT4gW1xuICAgIHsgdHlwZTogRGlhbG9nU2VydmljZSB9LFxuICAgIHsgdHlwZTogTG9jYWxpemF0aW9uU2VydmljZSB9LFxuICAgIHsgdHlwZTogQ2hhbmdlRGV0ZWN0b3JSZWYgfSxcbiAgICB7IHR5cGU6IEZvY3VzU2VydmljZSB9LFxuICAgIHsgdHlwZTogVmlld1N0YXRlU2VydmljZSB9XG5dO1xuXG4vKipcbiAqIEBoaWRkZW5cbiAqL1xuY2xhc3MgU2NoZWR1bGVyTG9jYWxpemF0aW9uU2VydmljZSBleHRlbmRzIExvY2FsaXphdGlvblNlcnZpY2Uge1xuICAgIGNvbnN0cnVjdG9yKHByZWZpeCwgbWVzc2FnZVNlcnZpY2UsIF9ydGwpIHtcbiAgICAgICAgc3VwZXIocHJlZml4LCBtZXNzYWdlU2VydmljZSwgX3J0bCk7XG4gICAgfVxufVxuLyoqIEBub2NvbGxhcHNlICovXG5TY2hlZHVsZXJMb2NhbGl6YXRpb25TZXJ2aWNlLmN0b3JQYXJhbWV0ZXJzID0gKCkgPT4gW1xuICAgIHsgdHlwZTogU3RyaW5nLCBkZWNvcmF0b3JzOiBbeyB0eXBlOiBJbmplY3QsIGFyZ3M6IFtMMTBOX1BSRUZJWCxdIH1dIH0sXG4gICAgeyB0eXBlOiBNZXNzYWdlU2VydmljZSwgZGVjb3JhdG9yczogW3sgdHlwZTogT3B0aW9uYWwgfV0gfSxcbiAgICB7IHR5cGU6IEJvb2xlYW4sIGRlY29yYXRvcnM6IFt7IHR5cGU6IE9wdGlvbmFsIH0sIHsgdHlwZTogSW5qZWN0LCBhcmdzOiBbUlRMLF0gfV0gfVxuXTtcblxuLyoqXG4gKiBAaGlkZGVuXG4gKi9cbmNvbnN0IGRlZmF1bHRNb2RlbEZpZWxkcyA9IHtcbiAgICBpZDogJ2lkJyxcbiAgICBzdGFydDogJ3N0YXJ0JyxcbiAgICBzdGFydFRpbWV6b25lOiAnc3RhcnRUaW1lem9uZScsXG4gICAgZW5kOiAnZW5kJyxcbiAgICBlbmRUaW1lem9uZTogJ2VuZFRpbWV6b25lJyxcbiAgICBpc0FsbERheTogJ2lzQWxsRGF5JyxcbiAgICB0aXRsZTogJ3RpdGxlJyxcbiAgICBkZXNjcmlwdGlvbjogJ2Rlc2NyaXB0aW9uJyxcbiAgICByZWN1cnJlbmNlUnVsZTogJ3JlY3VycmVuY2VSdWxlJyxcbiAgICByZWN1cnJlbmNlSWQ6ICdyZWN1cnJlbmNlSWQnLFxuICAgIHJlY3VycmVuY2VFeGNlcHRpb25zOiAncmVjdXJyZW5jZUV4Y2VwdGlvbnMnXG59O1xuXG4vKipcbiAqIEBoaWRkZW5cbiAqL1xuY2xhc3MgUERGU2VydmljZSB7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHRoaXMuY3JlYXRlRWxlbWVudCA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcbiAgICAgICAgdGhpcy5leHBvcnRDbGljayA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcbiAgICAgICAgdGhpcy5kb25lID0gbmV3IEV2ZW50RW1pdHRlcigpO1xuICAgICAgICB0aGlzLmVsZW1lbnRSZWFkeSA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcbiAgICB9XG4gICAgc2F2ZSgpIHtcbiAgICAgICAgaWYgKCFoYXNPYnNlcnZlcnModGhpcy5lbGVtZW50UmVhZHkpKSB7XG4gICAgICAgICAgICBpZiAoaXNEZXZNb2RlKCkpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0NyZWF0aW5nIFBERiByZXF1aXJlcyBpbmNsdWRpbmcgdGhlIFBERk1vZHVsZSBhbmQgYWRkaW5nIHRoZSA8a2VuZG8tc2NoZWR1bGVyLXBkZj4gY29tcG9uZW50LicpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGlmICghaGFzT2JzZXJ2ZXJzKHRoaXMuY3JlYXRlRWxlbWVudCkpIHtcbiAgICAgICAgICAgIGlmIChpc0Rldk1vZGUoKSkge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignTm8gYWN0aXZlIFNjaGVkdWxlciB2aWV3IHRvIGV4cG9ydC4nKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmNyZWF0ZUVsZW1lbnQuZW1pdCgpO1xuICAgIH1cbn1cblBERlNlcnZpY2UuZGVjb3JhdG9ycyA9IFtcbiAgICB7IHR5cGU6IEluamVjdGFibGUgfSxcbl07XG5cbi8qKlxuICogVGhlIGFyZ3VtZW50cyBmb3IgdGhlIGBwZGZFeHBvcnRgIGV2ZW50LlxuICovXG5jbGFzcyBQREZFeHBvcnRFdmVudCBleHRlbmRzIFByZXZlbnRhYmxlRXZlbnQkMSB7XG59XG5cbi8qKlxuICogQGhpZGRlblxuICovXG5jbGFzcyBMb2FkaW5nQ29tcG9uZW50IHtcbiAgICBjb25zdHJ1Y3RvcihlbGVtZW50LCByZW5kZXJlcikge1xuICAgICAgICB0aGlzLmVsZW1lbnQgPSBlbGVtZW50O1xuICAgICAgICB0aGlzLnJlbmRlcmVyID0gcmVuZGVyZXI7XG4gICAgICAgIHRoaXMuaG9zdENsYXNzZXMgPSB0cnVlO1xuICAgIH1cbiAgICBnZXQgZGlzcGxheSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubG9hZGluZyB8fCB0aGlzLmZvcmNlID8gJ2Jsb2NrJyA6ICdub25lJztcbiAgICB9XG4gICAgdG9nZ2xlKHZhbHVlKSB7XG4gICAgICAgIHRoaXMuZm9yY2UgPSB2YWx1ZTtcbiAgICAgICAgdGhpcy5yZW5kZXJlci5zZXRTdHlsZSh0aGlzLmVsZW1lbnQubmF0aXZlRWxlbWVudCwgJ2Rpc3BsYXknLCB0aGlzLmRpc3BsYXkpO1xuICAgIH1cbn1cbkxvYWRpbmdDb21wb25lbnQuZGVjb3JhdG9ycyA9IFtcbiAgICB7IHR5cGU6IENvbXBvbmVudCwgYXJnczogW3tcbiAgICAgICAgICAgICAgICAvLyB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmU6Y29tcG9uZW50LXNlbGVjdG9yXG4gICAgICAgICAgICAgICAgc2VsZWN0b3I6ICdba2VuZG9TY2hlZHVsZXJMb2FkaW5nXScsXG4gICAgICAgICAgICAgICAgdGVtcGxhdGU6IGBcbiAgICAgICAgPGRpdiBjbGFzcz1cImstbG9hZGluZy1pbWFnZVwiPjwvZGl2PlxuICAgICAgICA8ZGl2IGNsYXNzPVwiay1sb2FkaW5nLWNvbG9yXCI+PC9kaXY+XG4gICAgYFxuICAgICAgICAgICAgfSxdIH0sXG5dO1xuLyoqIEBub2NvbGxhcHNlICovXG5Mb2FkaW5nQ29tcG9uZW50LmN0b3JQYXJhbWV0ZXJzID0gKCkgPT4gW1xuICAgIHsgdHlwZTogRWxlbWVudFJlZiB9LFxuICAgIHsgdHlwZTogUmVuZGVyZXIyIH1cbl07XG5Mb2FkaW5nQ29tcG9uZW50LnByb3BEZWNvcmF0b3JzID0ge1xuICAgIGhvc3RDbGFzc2VzOiBbeyB0eXBlOiBIb3N0QmluZGluZywgYXJnczogWydjbGFzcy5rLWxvYWRpbmctbWFzaycsXSB9XSxcbiAgICBsb2FkaW5nOiBbeyB0eXBlOiBJbnB1dCB9XSxcbiAgICBkaXNwbGF5OiBbeyB0eXBlOiBIb3N0QmluZGluZywgYXJnczogWydzdHlsZS5kaXNwbGF5JyxdIH1dXG59O1xuXG4vKipcbiAqIEBoaWRkZW5cbiAqL1xuY2xhc3MgRm9jdXNhYmxlRGlyZWN0aXZlIHtcbiAgICBjb25zdHJ1Y3RvcihlbGVtZW50LCByZW5kZXJlciwgZm9jdXNTZXJ2aWNlKSB7XG4gICAgICAgIHRoaXMuZWxlbWVudCA9IGVsZW1lbnQ7XG4gICAgICAgIHRoaXMucmVuZGVyZXIgPSByZW5kZXJlcjtcbiAgICAgICAgdGhpcy5mb2N1c1NlcnZpY2UgPSBmb2N1c1NlcnZpY2U7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBUaGUgb3JkZXIgb2YgdGhlIGVsZW1lbnQgd2l0aCByZXNwZWN0IHRvIHRoZSBvdGhlciBmb2N1c2FibGUgZWxlbWVudHMuXG4gICAgICAgICAqIElmIG11bHRpcGxlIGVsZW1lbnRzIHNoYXJlIHRoZSBzYW1lIHZhbHVlLCB0aGVpciByZWxhdGl2ZSB0byBlYWNoIG90aGVyIG9yZGVyIGZvbGxvd3MgdGhlaXIgcG9zaXRpb24gaW4gdGhlIGNvbXBvbmVudCB0cmVlLlxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5mb2N1c0luZGV4ID0gMDtcbiAgICAgICAgdGhpcy50b2dnbGUoZmFsc2UpO1xuICAgICAgICB0aGlzLmZvY3VzU2VydmljZS5yZWdpc3Rlcih0aGlzKTtcbiAgICB9XG4gICAgZ2V0IHZpc2libGUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmVsZW1lbnQubmF0aXZlRWxlbWVudC5zdHlsZS5kaXNwbGF5ICE9PSAnbm9uZSc7XG4gICAgfVxuICAgIGdldCBlbmFibGVkKCkge1xuICAgICAgICByZXR1cm4gIXRoaXMuZWxlbWVudC5uYXRpdmVFbGVtZW50LmRpc2FibGVkO1xuICAgIH1cbiAgICBuZ09uRGVzdHJveSgpIHtcbiAgICAgICAgdGhpcy5mb2N1c1NlcnZpY2UudW5yZWdpc3Rlcih0aGlzKTtcbiAgICB9XG4gICAgdG9nZ2xlKGFjdGl2ZSkge1xuICAgICAgICBpZiAoYWN0aXZlICE9PSB0aGlzLmFjdGl2ZSkge1xuICAgICAgICAgICAgY29uc3QgaW5kZXggPSBhY3RpdmUgPyAnMCcgOiAnLTEnO1xuICAgICAgICAgICAgdGhpcy5yZW5kZXJlci5zZXRBdHRyaWJ1dGUodGhpcy5lbGVtZW50Lm5hdGl2ZUVsZW1lbnQsICd0YWJJbmRleCcsIGluZGV4KTtcbiAgICAgICAgICAgIHRoaXMuYWN0aXZlID0gYWN0aXZlO1xuICAgICAgICB9XG4gICAgfVxuICAgIGNhbkZvY3VzKCkge1xuICAgICAgICByZXR1cm4gdGhpcy52aXNpYmxlICYmIHRoaXMuZW5hYmxlZDtcbiAgICB9XG4gICAgZm9jdXMoKSB7XG4gICAgICAgIHRoaXMuZWxlbWVudC5uYXRpdmVFbGVtZW50LmZvY3VzKCk7XG4gICAgfVxuICAgIHRvZ2dsZUZvY3VzKHZhbHVlKSB7XG4gICAgICAgIGNvbnN0IGZvY3VzZWRDbGFzcyA9ICdrLXN0YXRlLXNlbGVjdGVkJztcbiAgICAgICAgY29uc3QgZWxlbWVudCA9IHRoaXMuZWxlbWVudC5uYXRpdmVFbGVtZW50O1xuICAgICAgICBpZiAodmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMucmVuZGVyZXIuYWRkQ2xhc3MoZWxlbWVudCwgZm9jdXNlZENsYXNzKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMucmVuZGVyZXIucmVtb3ZlQ2xhc3MoZWxlbWVudCwgZm9jdXNlZENsYXNzKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnJlbmRlcmVyLnNldEF0dHJpYnV0ZShlbGVtZW50LCAnYXJpYS1zZWxlY3RlZCcsIHZhbHVlLnRvU3RyaW5nKCkpO1xuICAgIH1cbn1cbkZvY3VzYWJsZURpcmVjdGl2ZS5kZWNvcmF0b3JzID0gW1xuICAgIHsgdHlwZTogRGlyZWN0aXZlLCBhcmdzOiBbe1xuICAgICAgICAgICAgICAgIHNlbGVjdG9yOiAnW2tlbmRvU2NoZWR1bGVyRm9jdXNJbmRleF0nXG4gICAgICAgICAgICB9LF0gfSxcbl07XG4vKiogQG5vY29sbGFwc2UgKi9cbkZvY3VzYWJsZURpcmVjdGl2ZS5jdG9yUGFyYW1ldGVycyA9ICgpID0+IFtcbiAgICB7IHR5cGU6IEVsZW1lbnRSZWYgfSxcbiAgICB7IHR5cGU6IFJlbmRlcmVyMiB9LFxuICAgIHsgdHlwZTogRm9jdXNTZXJ2aWNlIH1cbl07XG5Gb2N1c2FibGVEaXJlY3RpdmUucHJvcERlY29yYXRvcnMgPSB7XG4gICAgZm9jdXNJbmRleDogW3sgdHlwZTogSW5wdXQsIGFyZ3M6IFsna2VuZG9TY2hlZHVsZXJGb2N1c0luZGV4JyxdIH1dXG59O1xuXG4vLyBUT0RPOiBNb3ZlIHRvIEBwcm9ncmVzcy9rZW5kby1jb21tb25cbmNvbnN0IHRvQ2xhc3NMaXN0ID0gKGNsYXNzTmFtZXMpID0+IFN0cmluZyhjbGFzc05hbWVzKS50cmltKCkuc3BsaXQoJyAnKTtcbi8qKlxuICogQGhpZGRlblxuICovXG5jb25zdCBoYXNDbGFzc2VzID0gKGVsZW1lbnQsIGNsYXNzTmFtZXMpID0+IHtcbiAgICBjb25zdCBuYW1lc0xpc3QgPSB0b0NsYXNzTGlzdChjbGFzc05hbWVzKTtcbiAgICByZXR1cm4gQm9vbGVhbih0b0NsYXNzTGlzdChlbGVtZW50LmNsYXNzTmFtZSkuZmluZCgoY2xhc3NOYW1lKSA9PiBuYW1lc0xpc3QuaW5kZXhPZihjbGFzc05hbWUpID49IDApKTtcbn07XG4vKipcbiAqIEBoaWRkZW5cbiAqL1xuY29uc3QgY2xvc2VzdCA9IChub2RlLCBwcmVkaWNhdGUpID0+IHtcbiAgICB3aGlsZSAobm9kZSAmJiAhcHJlZGljYXRlKG5vZGUpKSB7XG4gICAgICAgIG5vZGUgPSBub2RlLnBhcmVudE5vZGU7XG4gICAgfVxuICAgIHJldHVybiBub2RlO1xufTtcbi8qKlxuICogQGhpZGRlblxuICovXG5jb25zdCBmaXJzdEVsZW1lbnRDaGlsZCA9IChub2RlKSA9PiB7XG4gICAgY29uc3QgY2hpbGRyZW4gPSBub2RlLmNoaWxkcmVuO1xuICAgIGNvbnN0IGxlbmd0aCA9IGNoaWxkcmVuLmxlbmd0aDtcbiAgICBmb3IgKGxldCBpZHggPSAwOyBpZHggPCBsZW5ndGg7IGlkeCsrKSB7XG4gICAgICAgIGlmIChjaGlsZHJlbltpZHhdLm5vZGVUeXBlID09PSAxKSB7XG4gICAgICAgICAgICByZXR1cm4gY2hpbGRyZW5baWR4XTtcbiAgICAgICAgfVxuICAgIH1cbn07XG4vKipcbiAqIEBoaWRkZW5cbiAqL1xuY29uc3QgY2xvc2VzdEluU2NvcGUgPSAobm9kZSwgcHJlZGljYXRlLCBzY29wZSkgPT4ge1xuICAgIHdoaWxlIChub2RlICYmIG5vZGUgIT09IHNjb3BlICYmICFwcmVkaWNhdGUobm9kZSkpIHtcbiAgICAgICAgbm9kZSA9IG5vZGUucGFyZW50Tm9kZTtcbiAgICB9XG4gICAgaWYgKG5vZGUgIT09IHNjb3BlKSB7XG4gICAgICAgIHJldHVybiBub2RlO1xuICAgIH1cbn07XG4vKipcbiAqIEBoaWRkZW5cbiAqL1xuY29uc3Qgd2hlZWxEZWx0YVkgPSAoZSkgPT4ge1xuICAgIGNvbnN0IGRlbHRhWSA9IGUud2hlZWxEZWx0YVk7XG4gICAgaWYgKGUud2hlZWxEZWx0YSAmJiAoZGVsdGFZID09PSB1bmRlZmluZWQgfHwgZGVsdGFZKSkge1xuICAgICAgICByZXR1cm4gZS53aGVlbERlbHRhO1xuICAgIH1cbiAgICBlbHNlIGlmIChlLmRldGFpbCAmJiBlLmF4aXMgPT09IGUuVkVSVElDQUxfQVhJUykge1xuICAgICAgICByZXR1cm4gKC1lLmRldGFpbCkgKiAxMDtcbiAgICB9XG4gICAgcmV0dXJuIDA7XG59O1xuLyoqXG4gKiBAaGlkZGVuXG4gKi9cbmNvbnN0IHByZXZlbnRMb2NrZWRTY3JvbGwgPSBlbCA9PiBldmVudCA9PiB7XG4gICAgY29uc3QgZGVsdGEgPSB3aGVlbERlbHRhWShldmVudCk7XG4gICAgY29uc3Qgc2Nyb2xsVG9wID0gZWwuc2Nyb2xsVG9wO1xuICAgIGNvbnN0IGFsbG93U2Nyb2xsID0gKHNjcm9sbFRvcCA9PT0gMCAmJiAwIDwgZGVsdGEpIHx8IChlbC5zY3JvbGxIZWlnaHQgPD0gZWwub2Zmc2V0SGVpZ2h0ICsgc2Nyb2xsVG9wICYmIGRlbHRhIDwgMCk7XG4gICAgaWYgKCFhbGxvd1Njcm9sbCkge1xuICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIH1cbn07XG5sZXQgY2FjaGVkU2Nyb2xsYmFyV2lkdGggPSAwO1xuLyoqXG4gKiBAaGlkZGVuXG4gKi9cbmZ1bmN0aW9uIHNjcm9sbGJhcldpZHRoKCkge1xuICAgIGlmICghY2FjaGVkU2Nyb2xsYmFyV2lkdGggJiYgaXNEb2N1bWVudEF2YWlsYWJsZSgpKSB7XG4gICAgICAgIGNvbnN0IGRpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gICAgICAgIGRpdi5zdHlsZS5jc3NUZXh0ID0gXCJvdmVyZmxvdzpzY3JvbGw7b3ZlcmZsb3cteDpoaWRkZW47em9vbToxO2NsZWFyOmJvdGg7ZGlzcGxheTpibG9ja1wiO1xuICAgICAgICBkaXYuaW5uZXJIVE1MID0gXCImbmJzcDtcIjtcbiAgICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChkaXYpO1xuICAgICAgICBjYWNoZWRTY3JvbGxiYXJXaWR0aCA9IGRpdi5vZmZzZXRXaWR0aCAtIGRpdi5zY3JvbGxXaWR0aDtcbiAgICAgICAgZG9jdW1lbnQuYm9keS5yZW1vdmVDaGlsZChkaXYpO1xuICAgIH1cbiAgICByZXR1cm4gY2FjaGVkU2Nyb2xsYmFyV2lkdGg7XG59XG4vKipcbiAqIEBoaWRkZW5cbiAqL1xuZnVuY3Rpb24gaGFzU2Nyb2xsYmFyKGVsZW1lbnQsIHR5cGUpIHtcbiAgICBjb25zdCBzaXplRmllbGQgPSB0eXBlID09PSAndmVydGljYWwnID8gJ0hlaWdodCcgOiAnV2lkdGgnO1xuICAgIHJldHVybiBlbGVtZW50W2BzY3JvbGwke3NpemVGaWVsZH1gXSA+IGVsZW1lbnRbYGNsaWVudCR7c2l6ZUZpZWxkfWBdO1xufVxuLyoqXG4gKiBAaGlkZGVuXG4gKi9cbmZ1bmN0aW9uIHJ0bFNjcm9sbFBvc2l0aW9uKGVsZW1lbnQsIHBvc2l0aW9uKSB7XG4gICAgY29uc3QgaW5pdGlhbCA9IGVsZW1lbnQuc2Nyb2xsTGVmdDtcbiAgICBsZXQgcmVzdWx0ID0gcG9zaXRpb247XG4gICAgZWxlbWVudC5zY3JvbGxMZWZ0ID0gLTE7XG4gICAgaWYgKGVsZW1lbnQuc2Nyb2xsTGVmdCA8IDApIHtcbiAgICAgICAgcmVzdWx0ID0gLXBvc2l0aW9uO1xuICAgIH1cbiAgICBlbHNlIGlmIChpbml0aWFsID4gMCkge1xuICAgICAgICByZXN1bHQgPSBlbGVtZW50LnNjcm9sbFdpZHRoIC0gZWxlbWVudC5vZmZzZXRXaWR0aCAtIHBvc2l0aW9uO1xuICAgIH1cbiAgICByZXR1cm4gcmVzdWx0O1xufVxuXG5jb25zdCB0b2RheURhdGUgPSAoKSA9PiBnZXREYXRlKG5ldyBEYXRlKCkpO1xuY29uc3QgREFZU19JTl9XRUVLID0gNztcbi8qKlxuICogUmVwcmVzZW50cyB0aGUgW0tlbmRvIFVJIFNjaGVkdWxlciBjb21wb25lbnQgZm9yIEFuZ3VsYXJdKHslIHNsdWcgb3ZlcnZpZXdfc2NoZWR1bGVyICV9KS5cbiAqXG4gKiBAZXhhbXBsZVxuICogYGBgdHMtcHJldmlld1xuICogX0BDb21wb25lbnQoe1xuICogICAgc2VsZWN0b3I6ICdteS1hcHAnLFxuICogICAgdGVtcGxhdGU6IGBcbiAqICAgICAgICA8a2VuZG8tc2NoZWR1bGVyIHN0eWxlPVwiaGVpZ2h0OiA2MDBweFwiPlxuICogICAgICAgICAgICA8a2VuZG8tc2NoZWR1bGVyLWRheS12aWV3PlxuICogICAgICAgICAgICA8L2tlbmRvLXNjaGVkdWxlci1kYXktdmlldz5cbiAqICAgICAgICAgICAgPGtlbmRvLXNjaGVkdWxlci13ZWVrLXZpZXc+XG4gKiAgICAgICAgICAgIDwva2VuZG8tc2NoZWR1bGVyLXdlZWstdmlldz5cbiAqICAgICAgICA8L2tlbmRvLXNjaGVkdWxlcj5cbiAqICAgIGBcbiAqIH0pXG4gKiBjbGFzcyBBcHBDb21wb25lbnQge31cbiAqIGBgYFxuICovXG5jbGFzcyBTY2hlZHVsZXJDb21wb25lbnQge1xuICAgIGNvbnN0cnVjdG9yKHdyYXBwZXIsIHZpZXdDb250ZXh0LCB2aWV3U3RhdGUsIGVkaXRTZXJ2aWNlLCBkaWFsb2dzU2VydmljZSwgaW50bFNlcnZpY2UsIGNoYW5nZURldGVjdG9yLCB6b25lLCBwZGZTZXJ2aWNlLCBsb2NhbGl6YXRpb24sIGRvbUV2ZW50cywgcmVuZGVyZXIsIGZvY3VzU2VydmljZSkge1xuICAgICAgICB0aGlzLndyYXBwZXIgPSB3cmFwcGVyO1xuICAgICAgICB0aGlzLnZpZXdDb250ZXh0ID0gdmlld0NvbnRleHQ7XG4gICAgICAgIHRoaXMudmlld1N0YXRlID0gdmlld1N0YXRlO1xuICAgICAgICB0aGlzLmVkaXRTZXJ2aWNlID0gZWRpdFNlcnZpY2U7XG4gICAgICAgIHRoaXMuZGlhbG9nc1NlcnZpY2UgPSBkaWFsb2dzU2VydmljZTtcbiAgICAgICAgdGhpcy5pbnRsU2VydmljZSA9IGludGxTZXJ2aWNlO1xuICAgICAgICB0aGlzLmNoYW5nZURldGVjdG9yID0gY2hhbmdlRGV0ZWN0b3I7XG4gICAgICAgIHRoaXMuem9uZSA9IHpvbmU7XG4gICAgICAgIHRoaXMucGRmU2VydmljZSA9IHBkZlNlcnZpY2U7XG4gICAgICAgIHRoaXMubG9jYWxpemF0aW9uID0gbG9jYWxpemF0aW9uO1xuICAgICAgICB0aGlzLmRvbUV2ZW50cyA9IGRvbUV2ZW50cztcbiAgICAgICAgdGhpcy5yZW5kZXJlciA9IHJlbmRlcmVyO1xuICAgICAgICB0aGlzLmZvY3VzU2VydmljZSA9IGZvY3VzU2VydmljZTtcbiAgICAgICAgdGhpcy5ob3N0Q2xhc3NlcyA9IHRydWU7XG4gICAgICAgIHRoaXMucnRsID0gZmFsc2U7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBTcGVjaWZpZXMgaWYgdGhlIFNjaGVkdWxlciBpcyBlZGl0YWJsZS5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuZWRpdGFibGUgPSBmYWxzZTtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRoZSBoZWlnaHQgb2YgdGhlIGV2ZW50cyBpbiB0aGUgKipNb250aCoqIGFuZCAqKlRpbWVsaW5lKiogdmlld3MsIGFuZCB0aGUgaGVpZ2h0IG9mIHRoZSAqKkFsbCBkYXkqKiBldmVudHMgaW4gdGhlICoqRGF5KiogYW5kICoqV2VlayoqIHZpZXdzLlxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5ldmVudEhlaWdodCA9IDI1O1xuICAgICAgICAvKipcbiAgICAgICAgICogU3BlY2lmaWVzIHRoZSBjb2x1bW5zIHdpZHRoLiBBcHBsaWNhYmxlIGZvciB0aGUgKipUaW1lbGluZSoqIHZpZXdzLlxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5jb2x1bW5XaWR0aCA9IDEwMDtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRoZSBzdGFydCB0aW1lIG9mIHRoZSB2aWV3LiBUaGUgU2NoZWR1bGVyIGRpc3BsYXlzIGV2ZW50cyB3aGljaCBzdGFydCBhZnRlciB0aGUgc3RhcnQgdGltZS5cbiAgICAgICAgICogQWNjZXB0cyBzdHJpbmcgdmFsdWVzIGluIHRoZSBgSEg6bW1gIGZvcm1hdC4gQXBwbGljYWJsZSBmb3IgdGhlICoqRGF5KiosICoqV2VlayoqLCBhbmQgKipUaW1lbGluZSoqIHZpZXdzLlxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5zdGFydFRpbWUgPSAnMDA6MDAnO1xuICAgICAgICAvKipcbiAgICAgICAgICogVGhlIGVuZCB0aW1lIG9mIHRoZSB2aWV3LiBUaGUgU2NoZWR1bGVyIGRpc3BsYXlzIGV2ZW50cyB3aGljaCBlbmQgYmVmb3JlIHRoZSBlbmQgdGltZS5cbiAgICAgICAgICogQWNjZXB0cyBzdHJpbmcgdmFsdWVzIGluIHRoZSBgSEg6bW1gIGZvcm1hdC4gQXBwbGljYWJsZSBmb3IgdGhlICoqRGF5KiosICoqV2VlayoqLCBhbmQgKipUaW1lbGluZSoqIHZpZXdzLlxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5lbmRUaW1lID0gJzAwOjAwJztcbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRoZSBzdGFydCB0aW1lIG9mIHRoZSB2aWV3IHdoZW4gYHNob3dXb3JrSG91cnNgIGlzIHNldCB0byBgdHJ1ZWAuXG4gICAgICAgICAqIEFjY2VwdHMgc3RyaW5nIHZhbHVlcyBpbiB0aGUgYEhIOm1tYCBmb3JtYXQuIEFwcGxpY2FibGUgZm9yIHRoZSAqKkRheSoqLCAqKldlZWsqKiwgYW5kICoqVGltZWxpbmUqKiB2aWV3cy5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMud29ya0RheVN0YXJ0ID0gJzA4OjAwJztcbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRoZSBlbmQgdGltZSBvZiB0aGUgdmlldyB3aGVuIGBzaG93V29ya0hvdXJzYCBpcyBzZXQgdG8gYHRydWVgLlxuICAgICAgICAgKiBBY2NlcHRzIHN0cmluZyB2YWx1ZXMgaW4gdGhlIGBISDptbWAgZm9ybWF0LiBBcHBsaWNhYmxlIGZvciB0aGUgKipEYXkqKiwgKipXZWVrKiosIGFuZCAqKlRpbWVsaW5lKiogdmlld3MuXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLndvcmtEYXlFbmQgPSAnMTc6MDAnO1xuICAgICAgICAvKipcbiAgICAgICAgICogVGhlIGR1cmF0aW9uIChpbiBtaW51dGVzKSBvZiB0aGUgdGltZSBzbG90cy4gQXBwbGljYWJsZSBmb3IgdGhlIGRheSwgd2VlayBhbmQgdGltZWxpbmUgdmlld3MuXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLnNsb3REdXJhdGlvbiA9IDYwO1xuICAgICAgICAvKipcbiAgICAgICAgICogVGhlIG51bWJlciBvZiBkaXZpc2lvbnMgb2YgdGhlIHRpbWUgc2xvdHMuIEFwcGxpY2FibGUgZm9yIHRoZSAqKkRheSoqLCAqKldlZWsqKiwgYW5kICoqVGltZWxpbmUqKiB2aWV3cy5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuc2xvdERpdmlzaW9ucyA9IDI7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBBIG51bWVyaWMgdmFsdWUgYmV0d2VlbiAwIGFuZCAxIHRoYXQgc3BlY2lmaWVzIHdoYXQgcGVyY2VudGFnZSBvZiB0aGUgc2xvdCB3aWxsIGJlIGZpbGxlZCBieSB0aGUgZXZlbnRzLlxuICAgICAgICAgKiBBcHBsaWNhYmxlIGZvciB0aGUgKipEYXkqKiBhbmQgKipXZWVrKiogdmlld3MuXG4gICAgICAgICAqIERlZmF1bHRzIHRvIGAwLjlgICg5MCUgZmlsbCkuXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLnNsb3RGaWxsID0gMC45O1xuICAgICAgICAvKipcbiAgICAgICAgICogVGhlIHRpbWUgdG8gd2hpY2ggdGhlIHZpZXcgd2lsbCBpbml0aWFsbHkgYmUgc2Nyb2xsZWQuXG4gICAgICAgICAqIEFjY2VwdHMgc3RyaW5nIHZhbHVlcyBpbiB0aGUgYEhIOm1tYCBmb3JtYXQgb3IgYSBKYXZhU2NyaXB0IGBEYXRlYC4gQXBwbGljYWJsZSBmb3IgdGhlICoqRGF5KiosICoqV2VlayoqLCBhbmQgKipUaW1lbGluZSoqIHZpZXdzLlxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5zY3JvbGxUaW1lID0gdGhpcy53b3JrRGF5U3RhcnQ7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBTcGVjaWZpZXMgdGhlIFNjaGVkdWxlciBjdXJyZW50IHRpbWUgbWFya2VyIHNldHRpbmdzLlxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5jdXJyZW50VGltZU1hcmtlciA9IHRydWU7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAaGlkZGVuXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLnNlbGVjdGVkVmlld0luZGV4Q2hhbmdlID0gbmV3IEV2ZW50RW1pdHRlcigpO1xuICAgICAgICAvKipcbiAgICAgICAgICogRmlyZXMgd2hlbiB0aGUgU2NoZWR1bGVyIGlzIGFib3V0IHRvIGV4ZWN1dGUgYSBuYXZpZ2F0aW9uIGFjdGlvblxuICAgICAgICAgKiAoYSB2aWV3LCBkYXRlLCBvciBmb2N1cyBjaGFuZ2UpLlxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5uYXZpZ2F0ZSA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEZpcmVzIHdoZW4gdGhlIGRhdGUgcmFuZ2UgdGhhdCBpcyBkaXNwbGF5ZWQgaW4gdGhlIFNjaGVkdWxlciBjaGFuZ2VzLlxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5kYXRlQ2hhbmdlID0gbmV3IEV2ZW50RW1pdHRlcigpO1xuICAgICAgICAvKipcbiAgICAgICAgICogRmlyZXMgd2hlbiBhIFNjaGVkdWxlciB2aWV3IHNsb3QgaXMgY2xpY2tlZC5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuc2xvdENsaWNrID0gbmV3IEV2ZW50RW1pdHRlcigpO1xuICAgICAgICAvKipcbiAgICAgICAgICogRmlyZXMgd2hlbiBhIFNjaGVkdWxlciB2aWV3IHNsb3QgaXMgZG91YmxlLWNsaWNrZWQuXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLnNsb3REYmxDbGljayA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEZpcmVzIHdoZW4gdGhlIHVzZXIgY3JlYXRlcyBhIG5ldyBldmVudCB1c2luZyB0aGUgYCdjJ2Aga2V5LlxuICAgICAgICAgKiAoW3NlZSBleGFtcGxlXSh7JSBzbHVnIGtleWJvYXJkX25hdmlnYXRpb25fc2NoZWR1bGVyICV9KSkuXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmNyZWF0ZSA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEZpcmVzIHdoZW4gYSBTY2hlZHVsZXIgZXZlbnQgaXMgY2xpY2tlZC5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuZXZlbnRDbGljayA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEZpcmVzIHdoZW4gYSBTY2hlZHVsZXIgZXZlbnQgaXMgZG91YmxlLWNsaWNrZWQuXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmV2ZW50RGJsQ2xpY2sgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBGaXJlcyB3aGVuIGEga2V5IGlzIHByZXNzZWQgb24gYSBmb2N1c2VkIFNjaGVkdWxlciBldmVudC5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuZXZlbnRLZXlkb3duID0gbmV3IEV2ZW50RW1pdHRlcigpO1xuICAgICAgICAvKipcbiAgICAgICAgICogRmlyZXMgd2hlbiB0aGUgdXNlciBjYW5jZWxzIHRoZSBlZGl0aW5nIGJ5IGNsaWNraW5nIHRoZSAqKkNhbmNlbCoqIGNvbW1hbmQgYnV0dG9uLlxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5jYW5jZWwgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBGaXJlcyB3aGVuIHRoZSB1c2VyIGNsaWNrcyB0aGUgKipTYXZlKiogY29tbWFuZCBidXR0b24gdG8gc2F2ZSB0aGUgY2hhbmdlcyBvZiB0aGUgZWRpdGVkIGV2ZW50LlxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5zYXZlID0gbmV3IEV2ZW50RW1pdHRlcigpO1xuICAgICAgICAvKipcbiAgICAgICAgICogRmlyZXMgd2hlbiB0aGUgdXNlciBjbGlja3MgdGhlICoqUmVtb3ZlKiogaWNvbiBvZiBhIFNjaGVkdWxlciBldmVudC5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMucmVtb3ZlID0gbmV3IEV2ZW50RW1pdHRlcigpO1xuICAgICAgICAvKipcbiAgICAgICAgICogRmlyZXMgd2hlbiB0aGUgdXNlciBzdGFydHMgcmVzaXppbmcgYSBTY2hlZHVsZXIgZXZlbnQuXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLnJlc2l6ZVN0YXJ0ID0gbmV3IEV2ZW50RW1pdHRlcigpO1xuICAgICAgICAvKipcbiAgICAgICAgICogRmlyZXMgd2hlbiB0aGUgdXNlciBpcyByZXNpemluZyBhIFNjaGVkdWxlciBldmVudC5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMucmVzaXplID0gbmV3IEV2ZW50RW1pdHRlcigpO1xuICAgICAgICAvKipcbiAgICAgICAgICogRmlyZXMgd2hlbiB0aGUgdXNlciBzdG9wcyByZXNpemluZyBhIFNjaGVkdWxlciBldmVudC5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMucmVzaXplRW5kID0gbmV3IEV2ZW50RW1pdHRlcigpO1xuICAgICAgICAvKipcbiAgICAgICAgICogRmlyZXMgd2hlbiB0aGUgdXNlciBzdGFydHMgZHJhZ2dpbmcgYSBTY2hlZHVsZXIgZXZlbnQuXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmRyYWdTdGFydCA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEZpcmVzIHdoZW4gdGhlIHVzZXIgaXMgZHJhZ2dpbmcgYSBTY2hlZHVsZXIgZXZlbnQuXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmRyYWcgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBGaXJlcyB3aGVuIHRoZSB1c2VyIHN0b3BzIGRyYWdnaW5nIGEgU2NoZWR1bGVyIGV2ZW50LlxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5kcmFnRW5kID0gbmV3IEV2ZW50RW1pdHRlcigpO1xuICAgICAgICAvKipcbiAgICAgICAgICogRmlyZXMgd2hlbiB0aGUgdXNlciBjbGlja3MgdGhlICoqUERGIGV4cG9ydCoqIGNvbW1hbmQgYnV0dG9uLlxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5wZGZFeHBvcnQgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAaGlkZGVuXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmRyYWdFbmRDb25maXJtZWQgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAaGlkZGVuXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLnJlc2l6ZUVuZENvbmZpcm1lZCA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEBoaWRkZW5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMucmVtb3ZlQ29uZmlybWVkID0gbmV3IEV2ZW50RW1pdHRlcigpO1xuICAgICAgICB0aGlzLnZpZXdJbmRleCA9IDA7XG4gICAgICAgIHRoaXMuX3RpbWV6b25lID0gJyc7XG4gICAgICAgIHRoaXMuX21vZGVsRmllbGRzID0gZGVmYXVsdE1vZGVsRmllbGRzO1xuICAgICAgICB0aGlzLmRhdGVSYW5nZVN0cmVhbSA9IHZpZXdTdGF0ZS5kYXRlUmFuZ2U7XG4gICAgICAgIHRoaXMuc2VsZWN0ZWREYXRlU3RyZWFtID0gdmlld0NvbnRleHQuc2VsZWN0ZWREYXRlO1xuICAgIH1cbiAgICBnZXQgZGlyKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5kaXJlY3Rpb247XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFRoZSBpbmRleCBvZiB0aGUgY3VycmVudGx5IHNlbGVjdGVkIHZpZXcuXG4gICAgICpcbiAgICAgKiBCeSBkZWZhdWx0LCB0aGUgc2VsZWN0ZWQgdmlldyBpbmRleCBpcyBgMGAgYW5kXG4gICAgICogaW5kaWNhdGVzIHRoYXQgdGhlIGZpcnN0IGRlY2xhcmVkIHZpZXcgaXMgdmlzaWJsZS5cbiAgICAgKi9cbiAgICBzZXQgc2VsZWN0ZWRWaWV3SW5kZXgoaW5kZXgpIHtcbiAgICAgICAgdGhpcy52aWV3SW5kZXggPSBpbmRleDtcbiAgICAgICAgdGhpcy5vblZpZXdJbmRleENoYW5nZSgpO1xuICAgIH1cbiAgICBnZXQgc2VsZWN0ZWRWaWV3SW5kZXgoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnZpZXdJbmRleDtcbiAgICB9XG4gICAgLyoqXG4gICAgICogU3BlY2lmaWVzIHRoZSBpZCBvZiB0aGUgdGltZXpvbmUgdGhhdCB3aWxsIGJlIGRpc3BsYXllZCBpbiB0aGUgU2NoZWR1bGVyLlxuICAgICAqIEZvciBleGFtcGxlLCBgRXVyb3BlL1NvZmlhYC5cbiAgICAgKiBEZWZhdWx0cyB0byBgRXRjL1VUQ2AuXG4gICAgICovXG4gICAgc2V0IHRpbWV6b25lKHZhbHVlKSB7XG4gICAgICAgIHRoaXMuX3RpbWV6b25lID0gdmFsdWU7XG4gICAgICAgIHRoaXMuZXZlbnRzID0gdGhpcy5ldmVudHMgfHwgW107XG4gICAgfVxuICAgIGdldCB0aW1lem9uZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3RpbWV6b25lO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBBbiBhcnJheSBvZiBldmVudCBpbnN0YW5jZXMgd2hpY2ggd2lsbCBiZSBzaG93biBieSB0aGUgU2NoZWR1bGVyLlxuICAgICAqL1xuICAgIHNldCBldmVudHModmFsdWUpIHtcbiAgICAgICAgdGhpcy5fZXZlbnRzID0gdmFsdWU7XG4gICAgICAgIHRoaXMucHJvY2Vzc0V2ZW50cyh2YWx1ZSk7XG4gICAgfVxuICAgIGdldCBldmVudHMoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9ldmVudHM7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFRoZSBjdXJyZW50bHkgc2VsZWN0ZWQgZGF0ZSBvZiB0aGUgU2NoZWR1bGVyLlxuICAgICAqIERldGVybWluZXMgdGhlIHBlcmlvZCB3aGljaCBpcyBkaXNwbGF5ZWQuXG4gICAgICovXG4gICAgc2V0IHNlbGVjdGVkRGF0ZSh2YWx1ZSkge1xuICAgICAgICBpZiAoIXZhbHVlKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fc2VsZWN0ZWREYXRlID0gdmFsdWU7XG4gICAgICAgIHRoaXMudmlld0NvbnRleHQubm90aWZ5U2VsZWN0ZWREYXRlKHZhbHVlKTtcbiAgICB9XG4gICAgZ2V0IHNlbGVjdGVkRGF0ZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3NlbGVjdGVkRGF0ZTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogVGhlIG5hbWVzIG9mIHRoZSBtb2RlbCBmaWVsZHMgZnJvbSB3aGljaCB0aGUgU2NoZWR1bGVyIHdpbGwgcmVhZCBpdHMgZGF0YVxuICAgICAqIChbc2VlIGV4YW1wbGVdKHslIHNsdWcgZGF0YWJpbmRpbmdfc2NoZWR1bGVyICV9I3RvYy1iaW5kaW5nLXRvLW1vZGVscykpLlxuICAgICAqL1xuICAgIHNldCBtb2RlbEZpZWxkcyh2YWx1ZSkge1xuICAgICAgICB0aGlzLl9tb2RlbEZpZWxkcyA9IE9iamVjdC5hc3NpZ24oe30sIGRlZmF1bHRNb2RlbEZpZWxkcywgdmFsdWUpO1xuICAgIH1cbiAgICBnZXQgbW9kZWxGaWVsZHMoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9tb2RlbEZpZWxkcztcbiAgICB9XG4gICAgbmdPbkluaXQoKSB7XG4gICAgICAgIGlmICghdGhpcy5zZWxlY3RlZERhdGUpIHtcbiAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWREYXRlID0gdG9kYXlEYXRlKCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgbmdBZnRlckNvbnRlbnRJbml0KCkge1xuICAgICAgICBpZiAoaXNEZXZNb2RlKCkgJiYgdGhpcy52aWV3cy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignTm8gdmlld3MgZGVjbGFyZWQgZm9yIDxrZW5kby1zY2hlZHVsZXI+LiBQbGVhc2UsIGRlY2xhcmUgYXQgbGVhc3Qgb25lIHZpZXcuJyk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5zdWJzID0gdGhpcy52aWV3cy5jaGFuZ2VzLnN1YnNjcmliZSgoKSA9PiB0aGlzLnJlc2V0Vmlld0luZGV4KCkpO1xuICAgICAgICB0aGlzLnN1YnMuYWRkKHRoaXMuaW50bFNlcnZpY2UuY2hhbmdlcy5zdWJzY3JpYmUodGhpcy5pbnRsQ2hhbmdlLmJpbmQodGhpcykpKTtcbiAgICAgICAgdGhpcy5zdWJzLmFkZCh0aGlzLnZpZXdTdGF0ZS5uZXh0RGF0ZS5zdWJzY3JpYmUobmV4dERhdGUgPT4ge1xuICAgICAgICAgICAgdGhpcy5zZWxlY3RlZERhdGUgPSBuZXh0RGF0ZTtcbiAgICAgICAgfSkpO1xuICAgICAgICB0aGlzLnN1YnMuYWRkKHRoaXMudmlld1N0YXRlLmRhdGVSYW5nZS5zdWJzY3JpYmUoZGF0ZVJhbmdlID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGlzRW1wdHkgPSBkYXRlUmFuZ2Uuc3RhcnQuZ2V0VGltZSgpID09PSAwO1xuICAgICAgICAgICAgaWYgKCFpc0VtcHR5KSB7XG4gICAgICAgICAgICAgICAgY29uc3QgYXJncyA9IG5ldyBEYXRlQ2hhbmdlRXZlbnQodGhpcywgdGhpcy5zZWxlY3RlZERhdGUsIGRhdGVSYW5nZSk7XG4gICAgICAgICAgICAgICAgdGhpcy5kYXRlQ2hhbmdlLmVtaXQoYXJncyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pKTtcbiAgICAgICAgdGhpcy5zdWJzLmFkZCh0aGlzLnZpZXdTdGF0ZS5uYXZpZ2F0ZS5zdWJzY3JpYmUoKHsgdmlld05hbWUsIGRhdGUgfSkgPT4ge1xuICAgICAgICAgICAgY29uc3Qgdmlld3MgPSB0aGlzLnZpZXdzLnRvQXJyYXkoKTtcbiAgICAgICAgICAgIGNvbnN0IHZpZXcgPSB2aWV3cy5maW5kKHYgPT4gdi5uYW1lID09PSB2aWV3TmFtZSk7XG4gICAgICAgICAgICBjb25zdCBhcmdzID0gbmV3IE5hdmlnYXRlRXZlbnQodGhpcywge1xuICAgICAgICAgICAgICAgIHR5cGU6ICdzaG93LWRhdGUnLFxuICAgICAgICAgICAgICAgIHZpZXc6IHZpZXcgfHwge1xuICAgICAgICAgICAgICAgICAgICBuYW1lOiB2aWV3TmFtZSxcbiAgICAgICAgICAgICAgICAgICAgdGl0bGU6IHZpZXdOYW1lXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBkYXRlOiBkYXRlXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHRoaXMubmF2aWdhdGUubmV4dChhcmdzKTtcbiAgICAgICAgICAgIGlmICh2aWV3ICYmICFhcmdzLmlzRGVmYXVsdFByZXZlbnRlZCgpKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgaW5kZXggPSB2aWV3cy5pbmRleE9mKHZpZXcpO1xuICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWRWaWV3ID0gdmlldztcbiAgICAgICAgICAgICAgICB0aGlzLnNldFZpZXdJbmRleChpbmRleCk7XG4gICAgICAgICAgICAgICAgdGhpcy5zZWxlY3RlZERhdGUgPSBkYXRlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KSk7XG4gICAgICAgIHRoaXMuc3Vicy5hZGQodGhpcy52aWV3U3RhdGUudmlld0V2ZW50LnN1YnNjcmliZSgoeyBuYW1lLCBhcmdzIH0pID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGVtaXR0ZXIgPSB0aGlzW25hbWVdO1xuICAgICAgICAgICAgY29uc3QgY29uZmlybWVkRW1pdHRlciA9IHRoaXNbYCR7bmFtZX1Db25maXJtZWRgXTtcbiAgICAgICAgICAgIGlmIChoYXNPYnNlcnZlcnMoZW1pdHRlcikgfHwgKGNvbmZpcm1lZEVtaXR0ZXIgJiYgaGFzT2JzZXJ2ZXJzKGNvbmZpcm1lZEVtaXR0ZXIpKSkge1xuICAgICAgICAgICAgICAgIHRoaXMuem9uZS5ydW4oKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBldmVudEluc3RhbmNlID0gbmV3IFZJRVdfRVZFTlRfTUFQW25hbWVdKHRoaXMsIGFyZ3MpO1xuICAgICAgICAgICAgICAgICAgICBlbWl0dGVyLmVtaXQoZXZlbnRJbnN0YW5jZSk7XG4gICAgICAgICAgICAgICAgICAgIGFyZ3MucHJldmVudGVkID0gZXZlbnRJbnN0YW5jZS5wcmV2ZW50ZWQ7XG4gICAgICAgICAgICAgICAgICAgIGlmIChjb25maXJtZWRFbWl0dGVyICYmICFhcmdzLnByZXZlbnRlZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uZmlybWVkRW1pdHRlci5lbWl0KGV2ZW50SW5zdGFuY2UpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pKTtcbiAgICAgICAgdGhpcy5zdWJzLmFkZCh0aGlzLnZpZXdTdGF0ZS5sYXlvdXRFbmQuc3Vic2NyaWJlKCgpID0+IHtcbiAgICAgICAgICAgIGlmICh0aGlzLnJlc2l6ZVNlbnNvcikge1xuICAgICAgICAgICAgICAgIHRoaXMucmVzaXplU2Vuc29yLmFjY2VwdFNpemUoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSkpO1xuICAgICAgICB0aGlzLm9uVmlld0luZGV4Q2hhbmdlKCk7XG4gICAgICAgIHRoaXMubm90aWZ5T3B0aW9uc0NoYW5nZSA9IHRoaXMubm90aWZ5T3B0aW9uc0NoYW5nZS5iaW5kKHRoaXMpO1xuICAgICAgICB0aGlzLnN1YnMuYWRkKHRoaXMuYWxsRGF5RXZlbnRUZW1wbGF0ZS5jaGFuZ2VzLnN1YnNjcmliZSh0aGlzLm5vdGlmeU9wdGlvbnNDaGFuZ2UpKTtcbiAgICAgICAgdGhpcy5zdWJzLmFkZCh0aGlzLmV2ZW50VGVtcGxhdGUuY2hhbmdlcy5zdWJzY3JpYmUodGhpcy5ub3RpZnlPcHRpb25zQ2hhbmdlKSk7XG4gICAgICAgIHRoaXMuc3Vicy5hZGQodGhpcy50aW1lU2xvdFRlbXBsYXRlLmNoYW5nZXMuc3Vic2NyaWJlKHRoaXMubm90aWZ5T3B0aW9uc0NoYW5nZSkpO1xuICAgICAgICB0aGlzLnN1YnMuYWRkKHRoaXMudGltZVNsb3RUZW1wbGF0ZS5jaGFuZ2VzLnN1YnNjcmliZSh0aGlzLm5vdGlmeU9wdGlvbnNDaGFuZ2UpKTtcbiAgICAgICAgdGhpcy5zdWJzLmFkZCh0aGlzLm1pbm9yVGltZUhlYWRlclRlbXBsYXRlLmNoYW5nZXMuc3Vic2NyaWJlKHRoaXMubm90aWZ5T3B0aW9uc0NoYW5nZSkpO1xuICAgICAgICB0aGlzLnN1YnMuYWRkKHRoaXMubWFqb3JUaW1lSGVhZGVyVGVtcGxhdGUuY2hhbmdlcy5zdWJzY3JpYmUodGhpcy5ub3RpZnlPcHRpb25zQ2hhbmdlKSk7XG4gICAgICAgIHRoaXMuc3Vicy5hZGQodGhpcy5tb250aERheVNsb3RUZW1wbGF0ZS5jaGFuZ2VzLnN1YnNjcmliZSh0aGlzLm5vdGlmeU9wdGlvbnNDaGFuZ2UpKTtcbiAgICAgICAgdGhpcy5zdWJzLmFkZCh0aGlzLmRhdGVIZWFkZXJUZW1wbGF0ZS5jaGFuZ2VzLnN1YnNjcmliZSh0aGlzLm5vdGlmeU9wdGlvbnNDaGFuZ2UpKTtcbiAgICAgICAgdGhpcy5zdWJzLmFkZCh0aGlzLmFsbERheVNsb3RUZW1wbGF0ZS5jaGFuZ2VzLnN1YnNjcmliZSh0aGlzLm5vdGlmeU9wdGlvbnNDaGFuZ2UpKTtcbiAgICAgICAgdGhpcy5zdWJzLmFkZCh0aGlzLmdyb3VwSGVhZGVyVGVtcGxhdGUuY2hhbmdlcy5zdWJzY3JpYmUodGhpcy5ub3RpZnlPcHRpb25zQ2hhbmdlKSk7XG4gICAgICAgIHRoaXMuc3Vicy5hZGQodGhpcy5hZ2VuZGFEYXRlVGVtcGxhdGUuY2hhbmdlcy5zdWJzY3JpYmUodGhpcy5ub3RpZnlPcHRpb25zQ2hhbmdlKSk7XG4gICAgICAgIHRoaXMuc3Vicy5hZGQodGhpcy5hZ2VuZGFUaW1lVGVtcGxhdGUuY2hhbmdlcy5zdWJzY3JpYmUodGhpcy5ub3RpZnlPcHRpb25zQ2hhbmdlKSk7XG4gICAgICAgIHRoaXMuc3Vicy5hZGQodGhpcy52aWV3cy5jaGFuZ2VzLnN1YnNjcmliZSgoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLmNoYW5nZURldGVjdG9yLm1hcmtGb3JDaGVjaygpO1xuICAgICAgICB9KSk7XG4gICAgICAgIC8vdGhpcy5lZGl0U2VydmljZS50aW1lem9uZSA9IHRoaXMudGltZXpvbmU7XG4gICAgICAgIHRoaXMuYXR0YWNoRWRpdEhhbmRsZXJzKCk7XG4gICAgICAgIHRoaXMuZGlhbG9nc1NlcnZpY2UuY29udGFpbmVyID0gdGhpcy5jb25maXJtYXRpb25EaWFsb2dDb250YWluZXJSZWY7XG4gICAgICAgIHRoaXMubm90aWZ5T3B0aW9uc0NoYW5nZSgpO1xuICAgICAgICB0aGlzLnN1YnMuYWRkKHRoaXMucGRmU2VydmljZS5leHBvcnRDbGljay5zdWJzY3JpYmUoKCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgYXJncyA9IG5ldyBQREZFeHBvcnRFdmVudCgpO1xuICAgICAgICAgICAgdGhpcy5wZGZFeHBvcnQuZW1pdChhcmdzKTtcbiAgICAgICAgICAgIGlmICghYXJncy5pc0RlZmF1bHRQcmV2ZW50ZWQoKSkge1xuICAgICAgICAgICAgICAgIHRoaXMuc2F2ZUFzUERGKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pKTtcbiAgICAgICAgdGhpcy5zdWJzLmFkZCh0aGlzLnBkZlNlcnZpY2UuZG9uZS5zdWJzY3JpYmUoKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5sb2FkaW5nQ29tcG9uZW50LnRvZ2dsZShmYWxzZSk7XG4gICAgICAgIH0pKTtcbiAgICAgICAgdGhpcy5zdWJzLmFkZCh0aGlzLmxvY2FsaXphdGlvbi5jaGFuZ2VzLnN1YnNjcmliZSgoeyBydGwgfSkgPT4ge1xuICAgICAgICAgICAgdGhpcy5ydGwgPSBydGw7XG4gICAgICAgICAgICB0aGlzLmRpcmVjdGlvbiA9IHRoaXMucnRsID8gJ3J0bCcgOiAnbHRyJztcbiAgICAgICAgfSkpO1xuICAgICAgICB0aGlzLnN1YnMuYWRkKHRoaXMudmlld1N0YXRlLm9wdGlvbnNDaGFuZ2Uuc3Vic2NyaWJlKCgpID0+IHtcbiAgICAgICAgICAgIHRoaXMuY2hhbmdlRGV0ZWN0b3IubWFya0ZvckNoZWNrKCk7XG4gICAgICAgIH0pKTtcbiAgICAgICAgdGhpcy5hdHRhY2hFbGVtZW50RXZlbnRIYW5kbGVycygpO1xuICAgIH1cbiAgICBuZ09uQ2hhbmdlcyhjaGFuZ2VzKSB7XG4gICAgICAgIGlmIChpc0NoYW5nZWQoJ3Jlc291cmNlcycsIGNoYW5nZXMpICYmICFpc0NoYW5nZWQoJ2V2ZW50cycsIGNoYW5nZXMpICYmIHRoaXMudmlld0l0ZW1zKSB7XG4gICAgICAgICAgICB0aGlzLnZpZXdJdGVtcy5mb3JFYWNoKGl0ZW0gPT4ge1xuICAgICAgICAgICAgICAgIGNvcHlSZXNvdXJjZXMoaXRlbS5ldmVudCwgdGhpcy5yZXNvdXJjZXMpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGFueUNoYW5nZWQoWydncm91cCcsICdyZXNvdXJjZXMnLCAnbWluJywgJ21heCcsICdzaG93V29ya0hvdXJzJywgJ3N0YXJ0VGltZScsICdzY3JvbGxUaW1lJywgJ2VuZFRpbWUnLCAnZXZlbnRIZWlnaHQnLFxuICAgICAgICAgICAgJ3dvcmtEYXlTdGFydCcsICd3b3JrRGF5RW5kJywgJ3dvcmtXZWVrU3RhcnQnLCAnd29ya1dlZWtFbmQnLCAnc2xvdER1cmF0aW9uJywgJ3Nsb3REaXZpc2lvbnMnLFxuICAgICAgICAgICAgJ2VkaXRhYmxlJywgJ3RpbWV6b25lJywgJ3Nsb3RDbGFzcycsICdzbG90RmlsbCcsICdjb2x1bW5XaWR0aCcsICdldmVudENsYXNzJywgJ2V2ZW50U3R5bGVzJ10sIGNoYW5nZXMpKSB7XG4gICAgICAgICAgICB0aGlzLm5vdGlmeU9wdGlvbnNDaGFuZ2UoY2hhbmdlcyk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgbmdPbkRlc3Ryb3koKSB7XG4gICAgICAgIGlmICh0aGlzLnN1YnMpIHtcbiAgICAgICAgICAgIHRoaXMuc3Vicy51bnN1YnNjcmliZSgpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLmRldGFjaEVsZW1lbnRFdmVudEhhbmRsZXJzKSB7XG4gICAgICAgICAgICB0aGlzLmRldGFjaEVsZW1lbnRFdmVudEhhbmRsZXJzKCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogQGhpZGRlblxuICAgICAqL1xuICAgIG9uUmVzaXplKF9ldmVudCkge1xuICAgICAgICB0aGlzLnZpZXdDb250ZXh0Lm5vdGlmeVJlc2l6ZSgpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBAaGlkZGVuXG4gICAgICovXG4gICAgb25OYXZpZ2F0aW9uQWN0aW9uKGFjdGlvbikge1xuICAgICAgICBjb25zdCBhcmdzID0gbmV3IE5hdmlnYXRlRXZlbnQodGhpcywgYWN0aW9uKTtcbiAgICAgICAgdGhpcy5uYXZpZ2F0ZS5uZXh0KGFyZ3MpO1xuICAgICAgICBpZiAoYXJncy5pc0RlZmF1bHRQcmV2ZW50ZWQoKSkge1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGFjdGlvbi50eXBlID09PSAndmlldy1jaGFuZ2UnKSB7XG4gICAgICAgICAgICBjb25zdCB2aWV3cyA9IHRoaXMudmlld3MudG9BcnJheSgpO1xuICAgICAgICAgICAgY29uc3QgaW5kZXggPSB2aWV3cy5pbmRleE9mKGFjdGlvbi52aWV3KTtcbiAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWRWaWV3ID0gYWN0aW9uLnZpZXc7XG4gICAgICAgICAgICB0aGlzLnNldFZpZXdJbmRleChpbmRleCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoYWN0aW9uLnR5cGUgPT09ICdzZWxlY3QtZGF0ZScpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLmlzSW5SYW5nZShhY3Rpb24uZGF0ZSkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdGVkRGF0ZSA9IGFjdGlvbi5kYXRlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGFjdGlvbi50eXBlID09PSAndG9kYXknKSB7XG4gICAgICAgICAgICBjb25zdCBkYXRlID0gbmV3IERhdGUoKTtcbiAgICAgICAgICAgIGlmICh0aGlzLmlzSW5SYW5nZShkYXRlKSkge1xuICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWREYXRlID0gZGF0ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMudmlld0NvbnRleHQubm90aWZ5QWN0aW9uKGFjdGlvbik7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhIHBvcHVwIGVkaXRvciBmb3IgdGhlIG5ldyBldmVudC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBncm91cCAtIFRoZSBbYEZvcm1Hcm91cGBdKGh0dHBzOi8vYW5ndWxhci5pby9kb2NzL3RzL2xhdGVzdC9hcGkvZm9ybXMvaW5kZXgvRm9ybUdyb3VwLWNsYXNzLmh0bWwpIHRoYXQgZGVzY3JpYmVzXG4gICAgICogdGhlIGVkaXQgZm9ybS4gSWYgY2FsbGVkIHdpdGggYSBkYXRhIGl0ZW0sIHRoZSBwYXJhbWV0ZXIgd2lsbCBidWlsZCB0aGUgYEZvcm1Hcm91cGAgZnJvbSB0aGUgZGF0YSBpdGVtIGZpZWxkcy5cbiAgICAgKi9cbiAgICBhZGRFdmVudChncm91cCkge1xuICAgICAgICBjb25zdCBpc0Zvcm1Hcm91cCA9IGdyb3VwIGluc3RhbmNlb2YgRm9ybUdyb3VwO1xuICAgICAgICBpZiAoIWlzRm9ybUdyb3VwKSB7XG4gICAgICAgICAgICBjb25zdCBjcmVhdGVDb250cm9sID0gKHNvdXJjZSkgPT4gKGFjYywga2V5KSA9PiB7XG4gICAgICAgICAgICAgICAgYWNjW2tleV0gPSBuZXcgRm9ybUNvbnRyb2woc291cmNlW2tleV0pO1xuICAgICAgICAgICAgICAgIHJldHVybiBhY2M7XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgY29uc3QgZmllbGRzID0gT2JqZWN0LmtleXMoZ3JvdXApLnJlZHVjZShjcmVhdGVDb250cm9sKGdyb3VwKSwge30pO1xuICAgICAgICAgICAgZ3JvdXAgPSBuZXcgRm9ybUdyb3VwKGZpZWxkcyk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5lZGl0U2VydmljZS5hZGRFdmVudChncm91cCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFN3aXRjaGVzIHRoZSBzcGVjaWZpZWQgZXZlbnQgaW4gZWRpdCBtb2RlLlxuICAgICAqXG4gICAgICogQHBhcmFtIGRhdGFJdGVtIC0gVGhlIGV2ZW50IHRoYXQgd2lsbCBiZSBzd2l0Y2hlZCB0byBlZGl0IG1vZGUuXG4gICAgICogQHBhcmFtIG9wdGlvbnMgLSBBbiBvYmplY3Qgd2hpY2ggY29udGFpbnMgdGhlIGZvcm0gYGdyb3VwYCB0aGF0IHdpbGwgYmUgYm91bmQgaW4gdGhlIGVkaXQgZGlhbG9nIGFuZCB0aGUgY3VycmVudCBlZGl0IGBtb2RlYC5cbiAgICAgKlxuICAgICAqL1xuICAgIGVkaXRFdmVudChkYXRhSXRlbSwgb3B0aW9ucyA9IHt9KSB7XG4gICAgICAgIGNvbnN0IHsgZ3JvdXAsIG1vZGUgfSA9IG9wdGlvbnM7XG4gICAgICAgIHRoaXMuZWRpdFNlcnZpY2UuZWRpdEV2ZW50KGRhdGFJdGVtLCBncm91cCwgbW9kZSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENsb3NlcyB0aGUgZXZlbnQgZWRpdG9yLCBpZiBvcGVuLlxuICAgICAqL1xuICAgIGNsb3NlRXZlbnQoKSB7XG4gICAgICAgIHRoaXMuZWRpdFNlcnZpY2UuY2xvc2UoKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJucyBhIGZsYWcgd2hpY2ggaW5kaWNhdGVzIGlmIGFuIGV2ZW50IGlzIGN1cnJlbnRseSBlZGl0ZWQuXG4gICAgICpcbiAgICAgKiBAcmV0dXJuIHtib29sZWFufSAtIEEgZmxhZyB3aGljaCBpbmRpY2F0ZXMgaWYgYW4gZXZlbnQgaXMgY3VycmVudGx5IGVkaXRlZC5cbiAgICAgKi9cbiAgICBpc0VkaXRpbmcoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmVkaXRTZXJ2aWNlLmlzRWRpdGluZygpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBPcGVucyB0aGUgYnVpbHQtaW4gY29uZmlybWF0aW9uIGRpYWxvZyBmb3IgZGVmaW5pbmcgdGhlIGVkaXQgbW9kZVxuICAgICAqIHRoYXQgd2lsbCBiZSB1c2VkIHdoZW4gdGhlIHVzZXIgZWRpdHMgb3IgcmVtb3ZlcyBhIHJlY3VycmluZyBldmVudC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBvcGVyYXRpb24gLSBUaGUgdHlwZSBvZiBvcGVyYXRpb24gdGhhdCB3aWxsIGJlIGNvbmZpcm1lZC4gSGFzIHRvIGJlIGVpdGhlciAqKkVkaXQqKiBvciAqKlJlbW92ZSoqLlxuICAgICAqXG4gICAgICogQHJldHVybiB7T2JzZXJ2YWJsZTxFZGl0TW9kZT59XG4gICAgICovXG4gICAgb3BlblJlY3VycmluZ0NvbmZpcm1hdGlvbkRpYWxvZyhvcGVyYXRpb24pIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZGlhbG9nc1NlcnZpY2Uub3BlblJlY3VycmluZ0NvbmZpcm1hdGlvbkRpYWxvZyhvcGVyYXRpb24pO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBPcGVucyB0aGUgYnVpbHQtaW4gcmVtb3ZhbCBjb25maXJtYXRpb24gZGlhbG9nLlxuICAgICAqXG4gICAgICogQHJldHVybiB7T2JzZXJ2YWJsZTxib29sZWFuPn1cbiAgICAgKi9cbiAgICBvcGVuUmVtb3ZlQ29uZmlybWF0aW9uRGlhbG9nKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5kaWFsb2dzU2VydmljZS5vcGVuUmVtb3ZlQ29uZmlybWF0aW9uRGlhbG9nKCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFNhdmVzIHRoZSBjdXJyZW50IHZpZXcgYXMgUERGLlxuICAgICAqL1xuICAgIHNhdmVBc1BERigpIHtcbiAgICAgICAgdGhpcy5sb2FkaW5nQ29tcG9uZW50LnRvZ2dsZSh0cnVlKTtcbiAgICAgICAgdGhpcy56b25lLnJ1bk91dHNpZGVBbmd1bGFyKCgpID0+IHtcbiAgICAgICAgICAgIC8vIHdhaXQgYSB0aWNrIGluIG9yZGVyIGZvciB0aGUgbG9hZGluZyBlbGVtZW50IHN0eWxlIHRvIGJlIHVwZGF0ZWQgYnkgdGhlIGJyb3dzZXIuXG4gICAgICAgICAgICAvLyBpZiB0aGUgZXhwb3J0IGlzIHN5bmNocm9ub3VzLCB0aGUgYnJvd3NlciB3aWxsIG5vdCB1cGRhdGUgdGhlIGVsZW1lbnQgYmVmb3JlIHRoZSBleHBvcnQgaXMgZmluaXNoZWQuXG4gICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLnBkZlNlcnZpY2Uuc2F2ZSgpO1xuICAgICAgICAgICAgfSwgMCk7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBTY3JvbGxzIHRoZSB2aWV3IHRvIHRoZSBzcGVjaWZpZWQgdGltZS5cbiAgICAgKi9cbiAgICBzY3JvbGxUb1RpbWUodGltZSkge1xuICAgICAgICB0aGlzLnZpZXdDb250ZXh0Lm5vdGlmeUFjdGlvbih7XG4gICAgICAgICAgICB0eXBlOiAnc2Nyb2xsLXRpbWUnLFxuICAgICAgICAgICAgdGltZTogdGltZVxuICAgICAgICB9KTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJucyB0aGUgY3VycmVudCB2aWV3IHNsb3QgdGhhdCBtYXRjaGVzIHRoZSBwYXNzZWQgZG9jdW1lbnQgcG9zaXRpb24uXG4gICAgICpcbiAgICAgKiBAcGFyYW0geCAtIFRoZSB4IGRvY3VtZW50IHBvc2l0aW9uLlxuICAgICAqIEBwYXJhbSB5IC0gVGhlIHkgZG9jdW1lbnQgcG9zaXRpb24uXG4gICAgICpcbiAgICAgKiBAcmV0dXJuIHtTY2hlZHVsZXJTbG90fSAtIFRoZSBzbG90LlxuICAgICAqXG4gICAgICogeyUgZW1iZWRfZmlsZSBkcmFnLWFuZC1kcm9wL2FwcC5jb21wb25lbnQudHMgJX1cbiAgICAgKiB7JSBlbWJlZF9maWxlIGRyYWctYW5kLWRyb3AvZHJhZ2dhYmxlLmRpcmVjdGl2ZS50cyAlfVxuICAgICAqIHslIGVtYmVkX2ZpbGUgZHJhZy1hbmQtZHJvcC9hcHAubW9kdWxlLnRzICV9XG4gICAgICogeyUgZW1iZWRfZmlsZSBzaGFyZWQvbWFpbi50cyAlfVxuICAgICAqL1xuICAgIHNsb3RCeVBvc2l0aW9uKHgsIHkpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMudmlld0NvbnRleHQuZXhlY3V0ZU1ldGhvZCgnc2xvdEJ5UG9zaXRpb24nLCB7IHgsIHkgfSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldHVybnMgdGhlIGV2ZW50IGFzc29jaWF0ZWQgd2l0aCB0aGUgc3BlY2lmaWVkIERPTSBlbGVtZW50LCBpZiBhbnkuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gZWxlbWVudCAtIFRoZSBET00gZWxlbWVudCBkb2N1bWVudCBwb3NpdGlvbi5cbiAgICAgKiBAcmV0dXJuIHRoZSBldmVudCBpbnN0YW5jZSwgaWYgZm91bmQuXG4gICAgICovXG4gICAgZXZlbnRGcm9tRWxlbWVudChlbGVtZW50KSB7XG4gICAgICAgIHJldHVybiB0aGlzLnZpZXdDb250ZXh0LmV4ZWN1dGVNZXRob2QoJ2V2ZW50RnJvbUVsZW1lbnQnLCB7IGVsZW1lbnQgfSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEdldHMgdGhlIGN1cnJlbnRseSBhY3RpdmUgZXZlbnQsIGlmIGFueS5cbiAgICAgKiBUaGUgYWN0aXZlIGV2ZW50IGlzIHRoZSBldmVudCB0aGF0IGNhbiBjdXJyZW50bHkgcmVjZWl2ZSBmb2N1cy5cbiAgICAgKi9cbiAgICBnZXQgYWN0aXZlRXZlbnQoKSB7XG4gICAgICAgIGNvbnN0IGFjdGl2ZUVsZW1lbnQgPSB0aGlzLmZvY3VzU2VydmljZS5hY3RpdmVFbGVtZW50O1xuICAgICAgICBpZiAoYWN0aXZlRWxlbWVudCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZXZlbnRGcm9tRWxlbWVudChhY3RpdmVFbGVtZW50Lm5hdGl2ZUVsZW1lbnQpO1xuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEZvY3VzZXMgdGhlIG5leHQgZXZlbnQgb3IgYW4gZXZlbnQgYXQgYSBzcGVjaWZpZWQgcmVsYXRpdmUgcG9zaXRpb24uXG4gICAgICogVGhlIGBvcHRpb25zYCBwYXJhbWV0ZXIgY2FuIGJlIHVzZWQgdG8gc2V0IGEgcG9zaXRpdmUgb3IgbmVnYXRpdmUgb2Zmc2V0XG4gICAgICogdGhhdCBpcyByZWxhdGl2ZSB0byB0aGUgY3VycmVudGx5IGZvY3VzZWQgZXZlbnQuXG4gICAgICogQSBgbm93cmFwYCBmbGFnIHRvZ2dsZXMgdGhlIHdyYXBwaW5nIHRvIHRoZSBmaXJzdCBvciB0byB0aGUgbGFzdCBpdGVtLlxuICAgICAqXG4gICAgICogQGV4YW1wbGVcbiAgICAgKiBgYGB0cy1uby1ydW5cbiAgICAgKiBzY2hlZHVsZXIuZm9jdXNOZXh0KCk7IC8vIEZvY3VzZXMgdGhlIG5leHQgZXZlbnQuXG4gICAgICogc2NoZWR1bGVyLmZvY3VzTmV4dCh7IG9mZnNldDogMSB9KTsgLy8gRm9jdXNlcyB0aGUgbmV4dCBldmVudC5cbiAgICAgKiBzY2hlZHVsZXIuZm9jdXNOZXh0KHsgb2Zmc2V0OiAtMSB9KTsgLy8gRm9jdXNlcyB0aGUgcHJldmlvdXMgZXZlbnQuXG4gICAgICogc2NoZWR1bGVyLmZvY3VzTmV4dCh7IG5vd3JhcDogdHJ1ZSB9KTsgLy8gSWYgdGhlIGZvY3VzIGlzIG9uIHRoZSBsYXN0IGV2ZW50LCBkb2VzIG5vdCBtb3ZlIHRoZSBmb2N1cyB0byB0aGUgZmlyc3QgZXZlbnQuXG4gICAgICogYGBgXG4gICAgICpcbiAgICAgKiBAcGFyYW0gcG9zaXRpb24gVGhlIHJlbGF0aXZlIHBvc2l0aW9uIG9mIHRoZSBldmVudCB0byBmb2N1cy5cbiAgICAgKiBAcmV0dXJucyBgdHJ1ZWAgaWYgdGhlIGZvY3VzZWQgZXZlbnQgY2hhbmdlZC4gT3RoZXJ3aXNlLCByZXR1cm5zIGBmYWxzZWAuXG4gICAgICovXG4gICAgZm9jdXNOZXh0KHBvc2l0aW9uKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmZvY3VzU2VydmljZS5mb2N1c05leHQocG9zaXRpb24pO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBGb2N1c2VzIHRoZSBwcmV2aW91cyBldmVudCBvciBhbiBldmVudCBhdCBhIHNwZWNpZmllZCByZWxhdGl2ZSBwb3NpdGlvbi5cbiAgICAgKiBUaGUgYG9wdGlvbnNgIHBhcmFtZXRlciBjYW4gYmUgdXNlZCB0byBzZXQgYSBwb3NpdGl2ZSBvciBuZWdhdGl2ZSBvZmZzZXRcbiAgICAgKiB0aGF0IGlzIHJlbGF0aXZlIHRvIHRoZSBjdXJyZW50bHkgZm9jdXNlZCBldmVudC5cbiAgICAgKiBBIGBub3dyYXBgIGZsYWcgdG9nZ2xlcyB0aGUgd3JhcHBpbmcgdG8gdGhlIGZpcnN0IG9yIHRvIHRoZSBsYXN0IGl0ZW0uXG4gICAgICpcbiAgICAgKiBAZXhhbXBsZVxuICAgICAqIGBgYHRzLW5vLXJ1blxuICAgICAqIHNjaGVkdWxlci5mb2N1c1ByZXYoKTsgLy8gRm9jdXNlcyB0aGUgcHJldmlvdXMgZXZlbnRcbiAgICAgKiBzY2hlZHVsZXIuZm9jdXNQcmV2KHsgbm93cmFwOiB0cnVlIH0pOyAvLyBEb2VzIG5vdCBtb3ZlIHRoZSBmb2N1cyB0byB0aGUgbGFzdCBldmVudCwgaWYgZm9jdXMgaXMgb24gdGhlIGZpcnN0IG9uZS5cbiAgICAgKiBgYGBcbiAgICAgKlxuICAgICAqIEBwYXJhbSBwb3NpdGlvbiBUaGUgcmVsYXRpdmUgcG9zaXRpb24gb2YgdGhlIGV2ZW50IHRvIGZvY3VzLlxuICAgICAqIEByZXR1cm5zIGB0cnVlYCBpZiB0aGUgZm9jdXNlZCBldmVudCBjaGFuZ2VkLiBPdGhlcndpc2UsIHJldHVybnMgYGZhbHNlYC5cbiAgICAgKi9cbiAgICBmb2N1c1ByZXYocG9zaXRpb24pIHtcbiAgICAgICAgY29uc3QgcHJldlBvc2l0aW9uID0gT2JqZWN0LmFzc2lnbih7IG9mZnNldDogLTEgfSwgcG9zaXRpb24pO1xuICAgICAgICByZXR1cm4gdGhpcy5mb2N1c1NlcnZpY2UuZm9jdXNOZXh0KHByZXZQb3NpdGlvbik7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEZvY3VzZXMgdGhlIGxhc3QgZm9jdXNlZCBldmVudCBvciB0aGUgU2NoZWR1bGVyIGVsZW1lbnQsIGlmIG5vIGV2ZW50cyBhcmUgYXZhaWxhYmxlLlxuICAgICAqL1xuICAgIGZvY3VzKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5mb2N1c1NlcnZpY2UuZm9jdXMoKTtcbiAgICB9XG4gICAgaXNJblJhbmdlKGRhdGUpIHtcbiAgICAgICAgcmV0dXJuICghdGhpcy5taW4gfHwgdGhpcy5taW4gPD0gZGF0ZSkgJiYgKCF0aGlzLm1heCB8fCBkYXRlIDw9IHRoaXMubWF4KTtcbiAgICB9XG4gICAgbm90aWZ5T3B0aW9uc0NoYW5nZShjaGFuZ2VzKSB7XG4gICAgICAgIGNvbnN0IHdvcmt3ZWVrID0gdGhpcy53b3JrV2VlaztcbiAgICAgICAgdGhpcy52aWV3Q29udGV4dC5ub3RpZnlPcHRpb25zQ2hhbmdlKHtcbiAgICAgICAgICAgIGdyb3VwOiB0aGlzLmdyb3VwLFxuICAgICAgICAgICAgcmVzb3VyY2VzOiB0aGlzLnJlc291cmNlcyxcbiAgICAgICAgICAgIGFsbERheUV2ZW50VGVtcGxhdGU6IHRoaXMuYWxsRGF5RXZlbnRUZW1wbGF0ZSA/IHRoaXMuYWxsRGF5RXZlbnRUZW1wbGF0ZS5maXJzdCA6IG51bGwsXG4gICAgICAgICAgICBldmVudFRlbXBsYXRlOiB0aGlzLmV2ZW50VGVtcGxhdGUgPyB0aGlzLmV2ZW50VGVtcGxhdGUuZmlyc3QgOiBudWxsLFxuICAgICAgICAgICAgdGltZVNsb3RUZW1wbGF0ZTogdGhpcy50aW1lU2xvdFRlbXBsYXRlID8gdGhpcy50aW1lU2xvdFRlbXBsYXRlLmZpcnN0IDogbnVsbCxcbiAgICAgICAgICAgIG1pbm9yVGltZUhlYWRlclRlbXBsYXRlOiB0aGlzLm1pbm9yVGltZUhlYWRlclRlbXBsYXRlID8gdGhpcy5taW5vclRpbWVIZWFkZXJUZW1wbGF0ZS5maXJzdCA6IG51bGwsXG4gICAgICAgICAgICBtYWpvclRpbWVIZWFkZXJUZW1wbGF0ZTogdGhpcy5tYWpvclRpbWVIZWFkZXJUZW1wbGF0ZSA/IHRoaXMubWFqb3JUaW1lSGVhZGVyVGVtcGxhdGUuZmlyc3QgOiBudWxsLFxuICAgICAgICAgICAgbW9udGhEYXlTbG90VGVtcGxhdGU6IHRoaXMubW9udGhEYXlTbG90VGVtcGxhdGUgPyB0aGlzLm1vbnRoRGF5U2xvdFRlbXBsYXRlLmZpcnN0IDogbnVsbCxcbiAgICAgICAgICAgIGRhdGVIZWFkZXJUZW1wbGF0ZTogdGhpcy5kYXRlSGVhZGVyVGVtcGxhdGUgPyB0aGlzLmRhdGVIZWFkZXJUZW1wbGF0ZS5maXJzdCA6IG51bGwsXG4gICAgICAgICAgICBhbGxEYXlTbG90VGVtcGxhdGU6IHRoaXMuYWxsRGF5U2xvdFRlbXBsYXRlID8gdGhpcy5hbGxEYXlTbG90VGVtcGxhdGUuZmlyc3QgOiBudWxsLFxuICAgICAgICAgICAgZ3JvdXBIZWFkZXJUZW1wbGF0ZTogdGhpcy5ncm91cEhlYWRlclRlbXBsYXRlID8gdGhpcy5ncm91cEhlYWRlclRlbXBsYXRlLmZpcnN0IDogbnVsbCxcbiAgICAgICAgICAgIGFnZW5kYURhdGVUZW1wbGF0ZTogdGhpcy5hZ2VuZGFEYXRlVGVtcGxhdGUgPyB0aGlzLmFnZW5kYURhdGVUZW1wbGF0ZS5maXJzdCA6IG51bGwsXG4gICAgICAgICAgICBhZ2VuZGFUaW1lVGVtcGxhdGU6IHRoaXMuYWdlbmRhVGltZVRlbXBsYXRlID8gdGhpcy5hZ2VuZGFUaW1lVGVtcGxhdGUuZmlyc3QgOiBudWxsLFxuICAgICAgICAgICAgbWluOiB0aGlzLm1pbixcbiAgICAgICAgICAgIG1heDogdGhpcy5tYXgsXG4gICAgICAgICAgICBzaG93V29ya0hvdXJzOiB0aGlzLnNob3dXb3JrSG91cnMsXG4gICAgICAgICAgICBzdGFydFRpbWU6IHRoaXMuc3RhcnRUaW1lLFxuICAgICAgICAgICAgc2Nyb2xsVGltZTogdGhpcy5zY3JvbGxUaW1lLFxuICAgICAgICAgICAgZW5kVGltZTogdGhpcy5lbmRUaW1lLFxuICAgICAgICAgICAgd29ya0RheVN0YXJ0OiB0aGlzLndvcmtEYXlTdGFydCxcbiAgICAgICAgICAgIHdvcmtEYXlFbmQ6IHRoaXMud29ya0RheUVuZCxcbiAgICAgICAgICAgIHdvcmtXZWVrU3RhcnQ6IHdvcmt3ZWVrLnN0YXJ0LFxuICAgICAgICAgICAgd29ya1dlZWtFbmQ6IHdvcmt3ZWVrLmVuZCxcbiAgICAgICAgICAgIHNsb3REdXJhdGlvbjogdGhpcy5zbG90RHVyYXRpb24sXG4gICAgICAgICAgICBzbG90RGl2aXNpb25zOiB0aGlzLnNsb3REaXZpc2lvbnMsXG4gICAgICAgICAgICBldmVudEhlaWdodDogdGhpcy5ldmVudEhlaWdodCxcbiAgICAgICAgICAgIGVkaXRhYmxlOiB0aGlzLmVkaXRhYmxlLFxuICAgICAgICAgICAgdGltZXpvbmU6IHRoaXMudGltZXpvbmUsXG4gICAgICAgICAgICBjdXJyZW50VGltZU1hcmtlcjogdGhpcy5jdXJyZW50VGltZU1hcmtlcixcbiAgICAgICAgICAgIHNsb3RDbGFzczogdGhpcy5zbG90Q2xhc3MsXG4gICAgICAgICAgICBzbG90RmlsbDogdGhpcy5zbG90RmlsbCxcbiAgICAgICAgICAgIGNvbHVtbldpZHRoOiB0aGlzLmNvbHVtbldpZHRoLFxuICAgICAgICAgICAgZXZlbnRDbGFzczogdGhpcy5ldmVudENsYXNzLFxuICAgICAgICAgICAgZXZlbnRTdHlsZXM6IHRoaXMuZXZlbnRTdHlsZXMsXG4gICAgICAgICAgICBjaGFuZ2VzOiBjaGFuZ2VzXG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBnZXQgd29ya1dlZWsoKSB7XG4gICAgICAgIGxldCB7IHN0YXJ0LCBlbmQgfSA9IHRoaXMuaW50bFNlcnZpY2Uud2Vla2VuZFJhbmdlKCk7XG4gICAgICAgIGNvbnN0IHdvcmtXZWVrU3RhcnQgPSBpc1ByZXNlbnQodGhpcy53b3JrV2Vla1N0YXJ0KSA/IHRoaXMud29ya1dlZWtTdGFydCA6IChlbmQgKyAxKSAlIERBWVNfSU5fV0VFSztcbiAgICAgICAgY29uc3Qgd2Vla0VuZCA9IHN0YXJ0ID4gMCA/IHN0YXJ0IC0gMSA6IERheS5TYXR1cmRheTtcbiAgICAgICAgY29uc3Qgd29ya1dlZWtFbmQgPSBpc1ByZXNlbnQodGhpcy53b3JrV2Vla0VuZCkgPyB0aGlzLndvcmtXZWVrRW5kIDogd2Vla0VuZDtcbiAgICAgICAgcmV0dXJuIHsgc3RhcnQ6IHdvcmtXZWVrU3RhcnQsIGVuZDogd29ya1dlZWtFbmQgfTtcbiAgICB9XG4gICAgcmVzZXRWaWV3SW5kZXgoKSB7XG4gICAgICAgIGNvbnN0IGluZGV4ID0gdGhpcy5zZWxlY3RlZFZpZXdJbmRleDtcbiAgICAgICAgY29uc3QgbmV3SW5kZXggPSBNYXRoLm1heCgwLCBNYXRoLm1pbihpbmRleCwgdGhpcy52aWV3cy5sZW5ndGggLSAxKSk7XG4gICAgICAgIHRoaXMuc2V0Vmlld0luZGV4KG5ld0luZGV4KTtcbiAgICAgICAgdGhpcy5vblZpZXdJbmRleENoYW5nZSgpO1xuICAgIH1cbiAgICBvblZpZXdJbmRleENoYW5nZSgpIHtcbiAgICAgICAgaWYgKCF0aGlzLnZpZXdzKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgY29uc3Qgdmlld3MgPSB0aGlzLnZpZXdzLnRvQXJyYXkoKTtcbiAgICAgICAgY29uc3Qgc2VsZWN0ZWRWaWV3ID0gdmlld3NbdGhpcy52aWV3SW5kZXhdO1xuICAgICAgICBpZiAoc2VsZWN0ZWRWaWV3KSB7XG4gICAgICAgICAgICB0aGlzLnNlbGVjdGVkVmlldyA9IHNlbGVjdGVkVmlldztcbiAgICAgICAgfVxuICAgIH1cbiAgICBzZXRWaWV3SW5kZXgobmV3SW5kZXgpIHtcbiAgICAgICAgY29uc3QgY2hhbmdlZCA9IHRoaXMuc2VsZWN0ZWRWaWV3SW5kZXggIT09IG5ld0luZGV4O1xuICAgICAgICBpZiAoY2hhbmdlZCkge1xuICAgICAgICAgICAgdGhpcy5zZWxlY3RlZFZpZXdJbmRleCA9IG5ld0luZGV4O1xuICAgICAgICAgICAgdGhpcy5zZWxlY3RlZFZpZXdJbmRleENoYW5nZS5lbWl0KG5ld0luZGV4KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gY2hhbmdlZDtcbiAgICB9XG4gICAgcHJvY2Vzc0V2ZW50cyhkYXRhSXRlbXMpIHtcbiAgICAgICAgY29uc3QgdGltZXpvbmUgPSB0aGlzLnRpbWV6b25lO1xuICAgICAgICBjb25zdCBmaWVsZHMgPSB0aGlzLm1vZGVsRmllbGRzO1xuICAgICAgICBjb25zdCBpdGVtcyA9IGRhdGFJdGVtc1xuICAgICAgICAgICAgLm1hcChkYXRhSXRlbSA9PiByZWFkRXZlbnQoZGF0YUl0ZW0sIGZpZWxkcywgdGhpcy5yZXNvdXJjZXMpKVxuICAgICAgICAgICAgLmZpbHRlcihldmVudCA9PiAhaXNSZWN1cnJlbmNlTWFzdGVyKGV2ZW50KSlcbiAgICAgICAgICAgIC5tYXAoZXZlbnQgPT4ge1xuICAgICAgICAgICAgY29uc3Qgc3RhcnQgPSBab25lZERhdGUuZnJvbUxvY2FsRGF0ZShldmVudC5zdGFydCwgdGltZXpvbmUpO1xuICAgICAgICAgICAgY29uc3QgZW5kID0gWm9uZWREYXRlLmZyb21Mb2NhbERhdGUoZXZlbnQuZW5kLCB0aW1lem9uZSk7XG4gICAgICAgICAgICByZXR1cm4geyBzdGFydCwgZW5kLCBldmVudCB9O1xuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy52aWV3SXRlbXMgPSBpdGVtcztcbiAgICAgICAgdGhpcy52aWV3Q29udGV4dC5ub3RpZnlJdGVtcyhpdGVtcyk7XG4gICAgfVxuICAgIGF0dGFjaEVkaXRIYW5kbGVycygpIHtcbiAgICAgICAgaWYgKCF0aGlzLmVkaXRTZXJ2aWNlKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5zdWJzLmFkZCh0aGlzLmVkaXRTZXJ2aWNlLmNoYW5nZXMuc3Vic2NyaWJlKHRoaXMuZW1pdENSVURFdmVudC5iaW5kKHRoaXMpKSk7XG4gICAgfVxuICAgIGVtaXRDUlVERXZlbnQoYXJncykge1xuICAgICAgICBPYmplY3QuYXNzaWduKGFyZ3MsIHsgc2VuZGVyOiB0aGlzIH0pO1xuICAgICAgICBzd2l0Y2ggKGFyZ3MuYWN0aW9uKSB7XG4gICAgICAgICAgICBjYXNlICdjYW5jZWwnOlxuICAgICAgICAgICAgICAgIHRoaXMuY2FuY2VsLmVtaXQoYXJncyk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlICdzYXZlJzpcbiAgICAgICAgICAgICAgICB0aGlzLnNhdmUuZW1pdChhcmdzKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGRlZmF1bHQ6IGJyZWFrO1xuICAgICAgICB9XG4gICAgfVxuICAgIGludGxDaGFuZ2UoKSB7XG4gICAgICAgIGNvbnN0IGN1cnJlbnRWaWV3ID0gdGhpcy5zZWxlY3RlZFZpZXc7XG4gICAgICAgIHRoaXMuc2VsZWN0ZWRWaWV3ID0gbnVsbDtcbiAgICAgICAgaWYgKCFpc1ByZXNlbnQodGhpcy53b3JrV2Vla1N0YXJ0KSB8fCAhaXNQcmVzZW50KHRoaXMud29ya1dlZWtFbmQpKSB7XG4gICAgICAgICAgICB0aGlzLm5vdGlmeU9wdGlvbnNDaGFuZ2UoKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmNoYW5nZURldGVjdG9yLmRldGVjdENoYW5nZXMoKTtcbiAgICAgICAgdGhpcy5zZWxlY3RlZFZpZXcgPSBjdXJyZW50VmlldztcbiAgICAgICAgaWYgKE5nWm9uZS5pc0luQW5ndWxhclpvbmUoKSkge1xuICAgICAgICAgICAgdGhpcy5jaGFuZ2VEZXRlY3Rvci5tYXJrRm9yQ2hlY2soKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuY2hhbmdlRGV0ZWN0b3IuZGV0ZWN0Q2hhbmdlcygpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGF0dGFjaEVsZW1lbnRFdmVudEhhbmRsZXJzKCkge1xuICAgICAgICBpZiAoIWlzRG9jdW1lbnRBdmFpbGFibGUoKSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IHdyYXBwZXIgPSB0aGlzLndyYXBwZXIubmF0aXZlRWxlbWVudDtcbiAgICAgICAgdGhpcy56b25lLnJ1bk91dHNpZGVBbmd1bGFyKCgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHdpbmRvd0JsdXJTdWJzY3JpcHRpb24gPSB0aGlzLnJlbmRlcmVyLmxpc3Rlbignd2luZG93JywgJ2JsdXInLCAoYXJncykgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuZG9tRXZlbnRzLndpbmRvd0JsdXIuZW1pdChhcmdzKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgY29uc3QgY2xpY2tTdWJzY3JpcHRpb24gPSB0aGlzLnJlbmRlcmVyLmxpc3Rlbih3cmFwcGVyLCAnY2xpY2snLCAoYXJncykgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuZG9tRXZlbnRzLmNsaWNrLmVtaXQoYXJncyk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGNvbnN0IGtleWRvd25TdWJzY3JpcHRpb24gPSB0aGlzLnJlbmRlcmVyLmxpc3Rlbih3cmFwcGVyLCAna2V5ZG93bicsIGFyZ3MgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuZG9tRXZlbnRzLmtleWRvd24uZW1pdChhcmdzKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgbGV0IGZvY3VzZWQgPSBmYWxzZTtcbiAgICAgICAgICAgIGNvbnN0IGZvY3VzSW5TdWJzY3JpcHRpb24gPSB0aGlzLnJlbmRlcmVyLmxpc3Rlbih3cmFwcGVyLCAnZm9jdXNpbicsIChhcmdzKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5kb21FdmVudHMuZm9jdXMuZW1pdChhcmdzKTtcbiAgICAgICAgICAgICAgICBpZiAoIWZvY3VzZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5kb21FdmVudHMuZm9jdXNJbi5lbWl0KGFyZ3MpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnJlbmRlcmVyLmFkZENsYXNzKHRoaXMud3JhcHBlci5uYXRpdmVFbGVtZW50LCAnay1zdGF0ZS1mb2N1c2VkJyk7XG4gICAgICAgICAgICAgICAgICAgIGZvY3VzZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgY29uc3QgZm9jdXNPdXRTdWJzY3JpcHRpb24gPSB0aGlzLnJlbmRlcmVyLmxpc3Rlbih3cmFwcGVyLCAnZm9jdXNvdXQnLCAoYXJncykgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IG5leHQgPSBhcmdzLnJlbGF0ZWRUYXJnZXQgfHwgZG9jdW1lbnQuYWN0aXZlRWxlbWVudDtcbiAgICAgICAgICAgICAgICBjb25zdCBvdXRzaWRlID0gIWNsb3Nlc3QobmV4dCwgKG5vZGUpID0+IG5vZGUgPT09IHdyYXBwZXIpO1xuICAgICAgICAgICAgICAgIGlmIChvdXRzaWRlKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZG9tRXZlbnRzLmZvY3VzT3V0LmVtaXQoYXJncyk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucmVuZGVyZXIucmVtb3ZlQ2xhc3ModGhpcy53cmFwcGVyLm5hdGl2ZUVsZW1lbnQsICdrLXN0YXRlLWZvY3VzZWQnKTtcbiAgICAgICAgICAgICAgICAgICAgZm9jdXNlZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgdGhpcy5kZXRhY2hFbGVtZW50RXZlbnRIYW5kbGVycyA9ICgpID0+IHtcbiAgICAgICAgICAgICAgICB3aW5kb3dCbHVyU3Vic2NyaXB0aW9uKCk7XG4gICAgICAgICAgICAgICAgY2xpY2tTdWJzY3JpcHRpb24oKTtcbiAgICAgICAgICAgICAgICBrZXlkb3duU3Vic2NyaXB0aW9uKCk7XG4gICAgICAgICAgICAgICAgZm9jdXNJblN1YnNjcmlwdGlvbigpO1xuICAgICAgICAgICAgICAgIGZvY3VzT3V0U3Vic2NyaXB0aW9uKCk7XG4gICAgICAgICAgICB9O1xuICAgICAgICB9KTtcbiAgICB9XG59XG5TY2hlZHVsZXJDb21wb25lbnQuZGVjb3JhdG9ycyA9IFtcbiAgICB7IHR5cGU6IENvbXBvbmVudCwgYXJnczogW3tcbiAgICAgICAgICAgICAgICBjaGFuZ2VEZXRlY3Rpb246IENoYW5nZURldGVjdGlvblN0cmF0ZWd5Lk9uUHVzaCxcbiAgICAgICAgICAgICAgICBzZWxlY3RvcjogJ2tlbmRvLXNjaGVkdWxlcicsXG4gICAgICAgICAgICAgICAgcHJvdmlkZXJzOiBbXG4gICAgICAgICAgICAgICAgICAgIEVkaXRTZXJ2aWNlLFxuICAgICAgICAgICAgICAgICAgICBEaWFsb2dzU2VydmljZSxcbiAgICAgICAgICAgICAgICAgICAgRG9tRXZlbnRzU2VydmljZSxcbiAgICAgICAgICAgICAgICAgICAgTG9jYWxEYXRhQ2hhbmdlc1NlcnZpY2UsXG4gICAgICAgICAgICAgICAgICAgIEZvY3VzU2VydmljZSxcbiAgICAgICAgICAgICAgICAgICAgU2NoZWR1bGVyTG9jYWxpemF0aW9uU2VydmljZSxcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgcHJvdmlkZTogTG9jYWxpemF0aW9uU2VydmljZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHVzZUV4aXN0aW5nOiBTY2hlZHVsZXJMb2NhbGl6YXRpb25TZXJ2aWNlXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHByb3ZpZGU6IEwxME5fUFJFRklYLFxuICAgICAgICAgICAgICAgICAgICAgICAgdXNlVmFsdWU6ICdrZW5kby5zY2hlZHVsZXInXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIFRvb2xiYXJTZXJ2aWNlLFxuICAgICAgICAgICAgICAgICAgICBWaWV3Q29udGV4dFNlcnZpY2UsXG4gICAgICAgICAgICAgICAgICAgIFZpZXdTdGF0ZVNlcnZpY2UsXG4gICAgICAgICAgICAgICAgICAgIFBERlNlcnZpY2VcbiAgICAgICAgICAgICAgICBdLFxuICAgICAgICAgICAgICAgIC8vIFRPRE86IE1vdmUgdG8gdGhlbWVzXG4gICAgICAgICAgICAgICAgc3R5bGVzOiBbJy5rLXNjaGVkdWxlci5rLXN0YXRlLWZvY3VzZWQgeyBib3gtc2hhZG93OiAwIDAuNXB4IDAuNXB4IDAuNXB4IHJnYmEoMCwgMCwgMCwgLjEyKTsgfSddLFxuICAgICAgICAgICAgICAgIGVuY2Fwc3VsYXRpb246IFZpZXdFbmNhcHN1bGF0aW9uLk5vbmUsXG4gICAgICAgICAgICAgICAgdGVtcGxhdGU6IGBcbiAgICAgICAgPG5nLWNvbnRhaW5lciBrZW5kb1NjaGVkdWxlckxvY2FsaXplZE1lc3NhZ2VzXG4gICAgICAgICAgICBpMThuLWFsbEV2ZW50cz1cImtlbmRvLnNjaGVkdWxlci5hbGxFdmVudHN8VGhlIEFsbCBldmVudHMgdGV4dCBkaXNwbGF5ZWQgaW4gdGhlIHRpbWVsaW5lIHZpZXdzIHdoZW4gdGhlcmUgaXMgbm8gdmVydGljYWwgZ3JvdXBpbmcuXCJcbiAgICAgICAgICAgIGFsbEV2ZW50cz1cIkFsbCBldmVudHNcIlxuXG4gICAgICAgICAgICBpMThuLWFsbERheT1cImtlbmRvLnNjaGVkdWxlci5hbGxEYXl8VGhlIGFsbCBkYXkgdGV4dCBkaXNwbGF5ZWQgaW4gdGhlIGRheSBhbmQgd2VlayB2aWV3cy5cIlxuICAgICAgICAgICAgYWxsRGF5PVwiYWxsIGRheVwiXG5cbiAgICAgICAgICAgIGkxOG4tZGF0ZUhlYWRlcj1cImtlbmRvLnNjaGVkdWxlci5kYXRlSGVhZGVyfFRoZSBkYXRlIGhlYWRlciB0ZXh0IGRpc3BsYXllZCBpbiB0aGUgYWdlbmRhIHZpZXcuXCJcbiAgICAgICAgICAgIGRhdGVIZWFkZXI9XCJEYXRlXCJcblxuICAgICAgICAgICAgaTE4bi10aW1lSGVhZGVyPVwia2VuZG8uc2NoZWR1bGVyLnRpbWVIZWFkZXJ8VGhlIHRpbWUgaGVhZGVyIHRleHQgZGlzcGxheWVkIGluIHRoZSBhZ2VuZGEgdmlldy5cIlxuICAgICAgICAgICAgdGltZUhlYWRlcj1cIlRpbWVcIlxuXG4gICAgICAgICAgICBpMThuLWRlbGV0ZVRpdGxlPVwia2VuZG8uc2NoZWR1bGVyLmRlbGV0ZVRpdGxlfFRoZSBkZWxldGUgaWNvbiB0aXRsZS5cIlxuICAgICAgICAgICAgZGVsZXRlVGl0bGU9XCJEZWxldGVcIlxuXG4gICAgICAgICAgICBpMThuLWV2ZW50SGVhZGVyPVwia2VuZG8uc2NoZWR1bGVyLmV2ZW50SGVhZGVyfFRoZSBldmVudCBoZWFkZXIgdGV4dCBkaXNwbGF5ZWQgaW4gdGhlIGFnZW5kYSB2aWV3LlwiXG4gICAgICAgICAgICBldmVudEhlYWRlcj1cIkV2ZW50XCJcblxuICAgICAgICAgICAgaTE4bi1uZXh0VGl0bGU9XCJrZW5kby5zY2hlZHVsZXIubmV4dFRpdGxlfFRoZSB0aXRsZSBvZiB0aGUgbmF2aWdhdGlvbiBuZXh0IGJ1dHRvbi5cIlxuICAgICAgICAgICAgbmV4dFRpdGxlPVwiTmV4dFwiXG5cbiAgICAgICAgICAgIGkxOG4tcHJldmlvdXNUaXRsZT1cImtlbmRvLnNjaGVkdWxlci5wcmV2aW91c1RpdGxlfFRoZSB0aXRsZSBvZiB0aGUgbmF2aWdhdGlvbiBwcmV2aW91cyBidXR0b24uXCJcbiAgICAgICAgICAgIHByZXZpb3VzVGl0bGU9XCJQcmV2aW91c1wiXG5cbiAgICAgICAgICAgIGkxOG4tc2hvd0Z1bGxEYXk9XCJrZW5kby5zY2hlZHVsZXIuc2hvd0Z1bGxEYXl8VGhlIHRleHQgb2YgdGhlIHNob3cgZnVsbCBkYXkgYnV0dG9uIGRpc3BsYXllZCBpbiB0aGUgZm9vdGVyIG9mIHRoZSBkYXksIHdlZWsgYW5kIHRpbWVsaW5lIHZpZXdzLlwiXG4gICAgICAgICAgICBzaG93RnVsbERheT1cIlNob3cgZnVsbCBkYXlcIlxuXG4gICAgICAgICAgICBpMThuLXNob3dXb3JrRGF5PVwia2VuZG8uc2NoZWR1bGVyLnNob3dXb3JrRGF5fFRoZSB0ZXh0IG9mIHRoZSBzaG93IHdvcmsgZGF5IGJ1dHRvbiBkaXNwbGF5ZWQgaW4gdGhlIGZvb3RlciBvZiB0aGUgZGF5LCB3ZWVrIGFuZCB0aW1lbGluZSB2aWV3cy5cIlxuICAgICAgICAgICAgc2hvd1dvcmtEYXk9XCJTaG93IGJ1c2luZXNzIGhvdXJzXCJcblxuICAgICAgICAgICAgaTE4bi10b2RheT1cImtlbmRvLnNjaGVkdWxlci50b2RheXxUaGUgdG9kYXkgYnV0dG9uIHRleHQgZGlzcGxheWVkIGluIHRoZSBuYXZpZ2F0aW9uLlwiXG4gICAgICAgICAgICB0b2RheT1cIlRvZGF5XCJcblxuICAgICAgICAgICAgaTE4bi1jYWxlbmRhclRvZGF5PVwia2VuZG8uc2NoZWR1bGVyLmNhbGVuZGFyVG9kYXl8VGhlIHRleHQgb2YgdG9kYXkncyBkYXRlIGluIHRoZSBoZWFkZXIgb2YgdGhlIENhbGVuZGFyLlwiXG4gICAgICAgICAgICBjYWxlbmRhclRvZGF5PVwiVE9EQVlcIlxuXG4gICAgICAgICAgICBpMThuLWRheVZpZXdUaXRsZT1cImtlbmRvLnNjaGVkdWxlci5kYXlWaWV3VGl0bGV8VGhlIGRheSB2aWV3IHRpdGxlLlwiXG4gICAgICAgICAgICBkYXlWaWV3VGl0bGU9XCJEYXlcIlxuXG4gICAgICAgICAgICBpMThuLW11bHRpRGF5Vmlld1RpdGxlPVwia2VuZG8uc2NoZWR1bGVyLm11bHRpRGF5Vmlld1RpdGxlfFRoZSBtdWx0aSBkYXkgdmlldyB0aXRsZS5cIlxuICAgICAgICAgICAgbXVsdGlEYXlWaWV3VGl0bGU9XCJNdWx0aS1EYXlcIlxuXG4gICAgICAgICAgICBpMThuLXdlZWtWaWV3VGl0bGU9XCJrZW5kby5zY2hlZHVsZXIud2Vla1ZpZXdUaXRsZXxUaGUgd2VlayB2aWV3IHRpdGxlLlwiXG4gICAgICAgICAgICB3ZWVrVmlld1RpdGxlPVwiV2Vla1wiXG5cbiAgICAgICAgICAgIGkxOG4td29ya1dlZWtWaWV3VGl0bGU9XCJrZW5kby5zY2hlZHVsZXIud29ya1dlZWtWaWV3VGl0bGV8VGhlIHdvcmsgd2VlayB2aWV3IHRpdGxlLlwiXG4gICAgICAgICAgICB3b3JrV2Vla1ZpZXdUaXRsZT1cIldvcmsgV2Vla1wiXG5cbiAgICAgICAgICAgIGkxOG4tbW9udGhWaWV3VGl0bGU9XCJrZW5kby5zY2hlZHVsZXIubW9udGhWaWV3VGl0bGV8VGhlIG1vbnRoIHZpZXcgdGl0bGUuXCJcbiAgICAgICAgICAgIG1vbnRoVmlld1RpdGxlPVwiTW9udGhcIlxuXG4gICAgICAgICAgICBpMThuLXRpbWVsaW5lVmlld1RpdGxlPVwia2VuZG8uc2NoZWR1bGVyLnRpbWVsaW5lVmlld1RpdGxlfFRoZSB0aW1lbGluZSB2aWV3IHRpdGxlLlwiXG4gICAgICAgICAgICB0aW1lbGluZVZpZXdUaXRsZT1cIlRpbWVsaW5lXCJcblxuICAgICAgICAgICAgaTE4bi10aW1lbGluZVdlZWtWaWV3VGl0bGU9XCJrZW5kby5zY2hlZHVsZXIudGltZWxpbmVXZWVrVmlld1RpdGxlfFRoZSB0aW1lbGluZSB3ZWVrIHZpZXcgdGl0bGUuXCJcbiAgICAgICAgICAgIHRpbWVsaW5lV2Vla1ZpZXdUaXRsZT1cIlRpbWVsaW5lIFdlZWtcIlxuXG4gICAgICAgICAgICBpMThuLXRpbWVsaW5lTW9udGhWaWV3VGl0bGU9XCJrZW5kby5zY2hlZHVsZXIudGltZWxpbmVNb250aFZpZXdUaXRsZXxUaGUgdGltZWxpbmUgbW9udGggdmlldyB0aXRsZS5cIlxuICAgICAgICAgICAgdGltZWxpbmVNb250aFZpZXdUaXRsZT1cIlRpbWVsaW5lIE1vbnRoXCJcblxuICAgICAgICAgICAgaTE4bi1hZ2VuZGFWaWV3VGl0bGU9XCJrZW5kby5zY2hlZHVsZXIuYWdlbmRhVmlld1RpdGxlfFRoZSBhZ2VuZGEgdmlldyB0aXRsZS5cIlxuICAgICAgICAgICAgYWdlbmRhVmlld1RpdGxlPVwiQWdlbmRhXCJcblxuICAgICAgICAgICAgaTE4bi1jYW5jZWw9XCJrZW5kby5zY2hlZHVsZXIuY2FuY2VsfFRoZSB0ZXh0IHNpbWlsYXIgdG8gJ0NhbmNlbCcgZGlzcGxheWVkIGluIHNjaGVkdWxlci5cIlxuICAgICAgICAgICAgY2FuY2VsPVwiQ2FuY2VsXCJcblxuICAgICAgICAgICAgaTE4bi1zYXZlPVwia2VuZG8uc2NoZWR1bGVyLnNhdmV8VGhlIHRleHQgc2ltaWxhciB0byAnU2F2ZScgZGlzcGxheWVkIGluIHNjaGVkdWxlci5cIlxuICAgICAgICAgICAgc2F2ZT1cIlNhdmVcIlxuXG4gICAgICAgICAgICBpMThuLWVkaXRvckV2ZW50VGl0bGU9XCJrZW5kby5zY2hlZHVsZXIuZWRpdG9yRXZlbnRUaXRsZXxUaGUgdGV4dCBzaW1pbGFyIHRvICdUaXRsZScgZGlzcGxheWVkIGluIHRoZSBzY2hlZHVsZXIgZXZlbnQgZWRpdG9yLlwiXG4gICAgICAgICAgICBlZGl0b3JFdmVudFRpdGxlPSdUaXRsZSdcblxuICAgICAgICAgICAgaTE4bi1lZGl0b3JFdmVudFN0YXJ0PVwia2VuZG8uc2NoZWR1bGVyLmVkaXRvckV2ZW50U3RhcnR8VGhlIHRleHQgc2ltaWxhciB0byAnU3RhcnQnIGRpc3BsYXllZCBpbiB0aGUgc2NoZWR1bGVyIGV2ZW50IGVkaXRvci5cIlxuICAgICAgICAgICAgZWRpdG9yRXZlbnRTdGFydD1cIlN0YXJ0XCJcblxuICAgICAgICAgICAgaTE4bi1lZGl0b3JFdmVudFN0YXJ0VGltZVpvbmU9XCJrZW5kby5zY2hlZHVsZXIuZWRpdG9yRXZlbnRTdGFydFRpbWVab25lfFRoZSB0ZXh0IHNpbWlsYXIgdG8gJ1N0YXJ0IFRpbWUgWm9uZScgZGlzcGxheWVkIGluIHRoZSBzY2hlZHVsZXIgZXZlbnQgZWRpdG9yLlwiXG4gICAgICAgICAgICBlZGl0b3JFdmVudFN0YXJ0VGltZVpvbmU9XCJTdGFydCBUaW1lIFpvbmVcIlxuXG4gICAgICAgICAgICBpMThuLWVkaXRvckV2ZW50RW5kPVwia2VuZG8uc2NoZWR1bGVyLmVkaXRvckV2ZW50RW5kfFRoZSB0ZXh0IHNpbWlsYXIgdG8gJ0VuZCcgZGlzcGxheWVkIGluIHRoZSBzY2hlZHVsZXIgZXZlbnQgZWRpdG9yLlwiXG4gICAgICAgICAgICBlZGl0b3JFdmVudEVuZD1cIkVuZFwiXG5cbiAgICAgICAgICAgIGkxOG4tZWRpdG9yRXZlbnRFbmRUaW1lWm9uZT1cImtlbmRvLnNjaGVkdWxlci5lZGl0b3JFdmVudEVuZFRpbWVab25lfFRoZSB0ZXh0IHNpbWlsYXIgdG8gJ0VuZCBUaW1lIFpvbmUnIGRpc3BsYXllZCBpbiB0aGUgc2NoZWR1bGVyIGV2ZW50IGVkaXRvci5cIlxuICAgICAgICAgICAgZWRpdG9yRXZlbnRFbmRUaW1lWm9uZT1cIkVuZCBUaW1lIFpvbmVcIlxuXG4gICAgICAgICAgICBpMThuLWVkaXRvckV2ZW50QWxsRGF5PVwia2VuZG8uc2NoZWR1bGVyLmVkaXRvckV2ZW50QWxsRGF5fFRoZSB0ZXh0IHNpbWlsYXIgdG8gJ0FsbCBEYXkgZXZlbnQnIGRpc3BsYXllZCBpbiB0aGUgc2NoZWR1bGVyIGV2ZW50IGVkaXRvci5cIlxuICAgICAgICAgICAgZWRpdG9yRXZlbnRBbGxEYXk9XCJBbGwgRGF5IEV2ZW50XCJcblxuICAgICAgICAgICAgaTE4bi1lZGl0b3JFdmVudERlc2NyaXB0aW9uPVwia2VuZG8uc2NoZWR1bGVyLmVkaXRvckV2ZW50RGVzY3JpcHRpb258VGhlIHRleHQgc2ltaWxhciB0byAnRGVzY3JpcHRpb24nIGRpc3BsYXllZCBpbiB0aGUgc2NoZWR1bGVyIGV2ZW50IGVkaXRvci5cIlxuICAgICAgICAgICAgZWRpdG9yRXZlbnREZXNjcmlwdGlvbj1cIkRlc2NyaXB0aW9uXCJcblxuICAgICAgICAgICAgaTE4bi1lZGl0b3JFdmVudFNlcGFyYXRlVGltZVpvbmVzPVwia2VuZG8uc2NoZWR1bGVyLmVkaXRvckV2ZW50U2VwYXJhdGVUaW1lWm9uZXN8VGhlIHRleHQgc2ltaWxhciB0byAnVXNlIHNlcGFyYXRlIFN0YXJ0IGFuZCBFbmQgVGltZSBab25lcycgZGlzcGxheWVkIGluIHRoZSBzY2hlZHVsZXIgZXZlbnQgZWRpdG9yLlwiXG4gICAgICAgICAgICBlZGl0b3JFdmVudFNlcGFyYXRlVGltZVpvbmVzPVwiRW5kIGluIGRpZmZlcmVudCBUaW1lIFpvbmVcIlxuXG4gICAgICAgICAgICBpMThuLWVkaXRvckV2ZW50VGltZVpvbmU9XCJrZW5kby5zY2hlZHVsZXIuZWRpdG9yRXZlbnRUaW1lWm9uZXxUaGUgdGV4dCBzaW1pbGFyIHRvICdUaW1lIFpvbmUnIGRpc3BsYXllZCBpbiB0aGUgc2NoZWR1bGVyIGV2ZW50IGVkaXRvci5cIlxuICAgICAgICAgICAgZWRpdG9yRXZlbnRUaW1lWm9uZT0nU3BlY2lmeSBUaW1lIFpvbmUnXG5cbiAgICAgICAgICAgIGkxOG4tZWRpdG9yVGl0bGU9XCJrZW5kby5zY2hlZHVsZXIuZWRpdG9yVGl0bGV8VGhlIHRleHQgc2ltaWxhciB0byAnRXZlbnQnIGRpc3BsYXllZCBhcyB0aXRsZSBvZiB0aGUgc2NoZWR1bGVyIGV2ZW50IGVkaXRvci5cIlxuICAgICAgICAgICAgZWRpdG9yVGl0bGU9J0V2ZW50J1xuXG4gICAgICAgICAgICBpMThuLXJlY3VycmVuY2VFZGl0b3JSZXBlYXQ9XCJrZW5kby5zY2hlZHVsZXIucmVjdXJyZW5jZUVkaXRvclJlcGVhdHxUaGUgdGV4dCBzaW1pbGFyIHRvICdSZXBlYXQnIGRpc3BsYXllZCBpbiB0aGUgc2NoZWR1bGVyIHJlY3VycmVuY2UgZWRpdG9yLlwiXG4gICAgICAgICAgICByZWN1cnJlbmNlRWRpdG9yUmVwZWF0PSdSZXBlYXQnXG5cbiAgICAgICAgICAgIGkxOG4tcmVjdXJyZW5jZUVkaXRvckRhaWx5SW50ZXJ2YWw9XCJrZW5kby5zY2hlZHVsZXIucmVjdXJyZW5jZUVkaXRvckRhaWx5SW50ZXJ2YWx8VGhlIHRleHQgc2ltaWxhciB0byAnZGF5KHMpJyBkaXNwbGF5ZWQgaW4gdGhlIHNjaGVkdWxlciByZWN1cnJlbmNlIGVkaXRvci5cIlxuICAgICAgICAgICAgcmVjdXJyZW5jZUVkaXRvckRhaWx5SW50ZXJ2YWw9J2RheShzKSdcblxuICAgICAgICAgICAgaTE4bi1yZWN1cnJlbmNlRWRpdG9yRGFpbHlSZXBlYXRFdmVyeT1cImtlbmRvLnNjaGVkdWxlci5yZWN1cnJlbmNlRWRpdG9yRGFpbHlSZXBlYXRFdmVyeXxUaGUgdGV4dCBzaW1pbGFyIHRvICdSZXBlYXQgZXZlcnknIGRpc3BsYXllZCBpbiB0aGUgc2NoZWR1bGVyIHJlY3VycmVuY2UgZWRpdG9yLlwiXG4gICAgICAgICAgICByZWN1cnJlbmNlRWRpdG9yRGFpbHlSZXBlYXRFdmVyeT0nUmVwZWF0IGV2ZXJ5J1xuXG4gICAgICAgICAgICBpMThuLXJlY3VycmVuY2VFZGl0b3JXZWVrbHlJbnRlcnZhbD1cImtlbmRvLnNjaGVkdWxlci5yZWN1cnJlbmNlRWRpdG9yV2Vla2x5SW50ZXJ2YWx8VGhlIHRleHQgc2ltaWxhciB0byAnd2VlayhzKScgZGlzcGxheWVkIGluIHRoZSBzY2hlZHVsZXIgcmVjdXJyZW5jZSBlZGl0b3IuXCJcbiAgICAgICAgICAgIHJlY3VycmVuY2VFZGl0b3JXZWVrbHlJbnRlcnZhbD0nd2VlayhzKSdcblxuICAgICAgICAgICAgaTE4bi1yZWN1cnJlbmNlRWRpdG9yV2Vla2x5UmVwZWF0RXZlcnk9XCJrZW5kby5zY2hlZHVsZXIucmVjdXJyZW5jZUVkaXRvcldlZWtseVJlcGVhdEV2ZXJ5fFRoZSB0ZXh0IHNpbWlsYXIgdG8gJ1JlcGVhdCBldmVyeScgZGlzcGxheWVkIGluIHRoZSBzY2hlZHVsZXIgcmVjdXJyZW5jZSBlZGl0b3IuXCJcbiAgICAgICAgICAgIHJlY3VycmVuY2VFZGl0b3JXZWVrbHlSZXBlYXRFdmVyeT0nUmVwZWF0IGV2ZXJ5J1xuXG4gICAgICAgICAgICBpMThuLXJlY3VycmVuY2VFZGl0b3JXZWVrbHlSZXBlYXRPbj1cImtlbmRvLnNjaGVkdWxlci5yZWN1cnJlbmNlRWRpdG9yV2Vla2x5UmVwZWF0T258VGhlIHRleHQgc2ltaWxhciB0byAnUmVwZWF0IG9uJyBkaXNwbGF5ZWQgaW4gdGhlIHNjaGVkdWxlciByZWN1cnJlbmNlIGVkaXRvci5cIlxuICAgICAgICAgICAgcmVjdXJyZW5jZUVkaXRvcldlZWtseVJlcGVhdE9uPSdSZXBlYXQgb24nXG5cbiAgICAgICAgICAgIGkxOG4tcmVjdXJyZW5jZUVkaXRvck1vbnRobHlEYXk9XCJrZW5kby5zY2hlZHVsZXIucmVjdXJyZW5jZUVkaXRvck1vbnRobHlEYXl8VGhlIHRleHQgc2ltaWxhciB0byAnRGF5JyBkaXNwbGF5ZWQgaW4gdGhlIHNjaGVkdWxlciByZWN1cnJlbmNlIGVkaXRvci5cIlxuICAgICAgICAgICAgcmVjdXJyZW5jZUVkaXRvck1vbnRobHlEYXk9J0RheSdcblxuICAgICAgICAgICAgaTE4bi1yZWN1cnJlbmNlRWRpdG9yTW9udGhseUludGVydmFsPVwia2VuZG8uc2NoZWR1bGVyLnJlY3VycmVuY2VFZGl0b3JNb250aGx5SW50ZXJ2YWx8VGhlIHRleHQgc2ltaWxhciB0byAnbW9udGgocyknIGRpc3BsYXllZCBpbiB0aGUgc2NoZWR1bGVyIHJlY3VycmVuY2UgZWRpdG9yLlwiXG4gICAgICAgICAgICByZWN1cnJlbmNlRWRpdG9yTW9udGhseUludGVydmFsPSdtb250aChzKSdcblxuICAgICAgICAgICAgaTE4bi1yZWN1cnJlbmNlRWRpdG9yTW9udGhseVJlcGVhdEV2ZXJ5PVwia2VuZG8uc2NoZWR1bGVyLnJlY3VycmVuY2VFZGl0b3JNb250aGx5UmVwZWF0RXZlcnl8VGhlIHRleHQgc2ltaWxhciB0byAnUmVwZWF0IGV2ZXJ5JyBkaXNwbGF5ZWQgaW4gdGhlIHNjaGVkdWxlciByZWN1cnJlbmNlIGVkaXRvci5cIlxuICAgICAgICAgICAgcmVjdXJyZW5jZUVkaXRvck1vbnRobHlSZXBlYXRFdmVyeT0nUmVwZWF0IGV2ZXJ5J1xuXG4gICAgICAgICAgICBpMThuLXJlY3VycmVuY2VFZGl0b3JNb250aGx5UmVwZWF0T249XCJrZW5kby5zY2hlZHVsZXIucmVjdXJyZW5jZUVkaXRvck1vbnRobHlSZXBlYXRPbnxUaGUgdGV4dCBzaW1pbGFyIHRvICdSZXBlYXQgb24nIGRpc3BsYXllZCBpbiB0aGUgc2NoZWR1bGVyIHJlY3VycmVuY2UgZWRpdG9yLlwiXG4gICAgICAgICAgICByZWN1cnJlbmNlRWRpdG9yTW9udGhseVJlcGVhdE9uPSdSZXBlYXQgb24nXG5cbiAgICAgICAgICAgIGkxOG4tcmVjdXJyZW5jZUVkaXRvclllYXJseU9mPVwia2VuZG8uc2NoZWR1bGVyLnJlY3VycmVuY2VFZGl0b3JZZWFybHlPZnxUaGUgdGV4dCBzaW1pbGFyIHRvICdvZicgZGlzcGxheWVkIGluIHRoZSBzY2hlZHVsZXIgcmVjdXJyZW5jZSBlZGl0b3IuXCJcbiAgICAgICAgICAgIHJlY3VycmVuY2VFZGl0b3JZZWFybHlPZj0nb2YnXG5cbiAgICAgICAgICAgIGkxOG4tcmVjdXJyZW5jZUVkaXRvclllYXJseVJlcGVhdEV2ZXJ5PVwia2VuZG8uc2NoZWR1bGVyLnJlY3VycmVuY2VFZGl0b3JZZWFybHlSZXBlYXRFdmVyeXxUaGUgdGV4dCBzaW1pbGFyIHRvICdSZXBlYXQgZXZlcnknIGRpc3BsYXllZCBpbiB0aGUgc2NoZWR1bGVyIHJlY3VycmVuY2UgZWRpdG9yLlwiXG4gICAgICAgICAgICByZWN1cnJlbmNlRWRpdG9yWWVhcmx5UmVwZWF0RXZlcnk9J1JlcGVhdCBldmVyeSdcblxuICAgICAgICAgICAgaTE4bi1yZWN1cnJlbmNlRWRpdG9yWWVhcmx5UmVwZWF0T249XCJrZW5kby5zY2hlZHVsZXIucmVjdXJyZW5jZUVkaXRvclllYXJseVJlcGVhdE9ufFRoZSB0ZXh0IHNpbWlsYXIgdG8gJ1JlcGVhdCBvbicgZGlzcGxheWVkIGluIHRoZSBzY2hlZHVsZXIgcmVjdXJyZW5jZSBlZGl0b3IuXCJcbiAgICAgICAgICAgIHJlY3VycmVuY2VFZGl0b3JZZWFybHlSZXBlYXRPbj0nUmVwZWF0IG9uJ1xuXG4gICAgICAgICAgICBpMThuLXJlY3VycmVuY2VFZGl0b3JZZWFybHlJbnRlcnZhbD1cImtlbmRvLnNjaGVkdWxlci5yZWN1cnJlbmNlRWRpdG9yWWVhcmx5SW50ZXJ2YWx8VGhlIHRleHQgc2ltaWxhciB0byAneWVhcihzKScgZGlzcGxheWVkIGluIHRoZSBzY2hlZHVsZXIgcmVjdXJyZW5jZSBlZGl0b3IuXCJcbiAgICAgICAgICAgIHJlY3VycmVuY2VFZGl0b3JZZWFybHlJbnRlcnZhbD0neWVhcihzKSdcblxuICAgICAgICAgICAgaTE4bi1yZWN1cnJlbmNlRWRpdG9yRnJlcXVlbmNpZXNEYWlseT1cImtlbmRvLnNjaGVkdWxlci5yZWN1cnJlbmNlRWRpdG9yRnJlcXVlbmNpZXNEYWlseXxUaGUgdGV4dCBzaW1pbGFyIHRvICdEYWlseScgZGlzcGxheWVkIGluIHRoZSBzY2hlZHVsZXIgcmVjdXJyZW5jZSBlZGl0b3IuXCJcbiAgICAgICAgICAgIHJlY3VycmVuY2VFZGl0b3JGcmVxdWVuY2llc0RhaWx5PSdEYWlseSdcblxuICAgICAgICAgICAgaTE4bi1yZWN1cnJlbmNlRWRpdG9yRnJlcXVlbmNpZXNNb250aGx5PVwia2VuZG8uc2NoZWR1bGVyLnJlY3VycmVuY2VFZGl0b3JGcmVxdWVuY2llc01vbnRobHl8VGhlIHRleHQgc2ltaWxhciB0byAnTW9udGhseScgZGlzcGxheWVkIGluIHRoZSBzY2hlZHVsZXIgcmVjdXJyZW5jZSBlZGl0b3IuXCJcbiAgICAgICAgICAgIHJlY3VycmVuY2VFZGl0b3JGcmVxdWVuY2llc01vbnRobHk9J01vbnRobHknXG5cbiAgICAgICAgICAgIGkxOG4tcmVjdXJyZW5jZUVkaXRvckZyZXF1ZW5jaWVzTmV2ZXI9XCJrZW5kby5zY2hlZHVsZXIucmVjdXJyZW5jZUVkaXRvckZyZXF1ZW5jaWVzTmV2ZXJ8VGhlIHRleHQgc2ltaWxhciB0byAnTmV2ZXInIGRpc3BsYXllZCBpbiB0aGUgc2NoZWR1bGVyIHJlY3VycmVuY2UgZWRpdG9yLlwiXG4gICAgICAgICAgICByZWN1cnJlbmNlRWRpdG9yRnJlcXVlbmNpZXNOZXZlcj0nTmV2ZXInXG5cbiAgICAgICAgICAgIGkxOG4tcmVjdXJyZW5jZUVkaXRvckZyZXF1ZW5jaWVzV2Vla2x5PVwia2VuZG8uc2NoZWR1bGVyLnJlY3VycmVuY2VFZGl0b3JGcmVxdWVuY2llc1dlZWtseXxUaGUgdGV4dCBzaW1pbGFyIHRvICdXZWVrbHknIGRpc3BsYXllZCBpbiB0aGUgc2NoZWR1bGVyIHJlY3VycmVuY2UgZWRpdG9yLlwiXG4gICAgICAgICAgICByZWN1cnJlbmNlRWRpdG9yRnJlcXVlbmNpZXNXZWVrbHk9J1dlZWtseSdcblxuICAgICAgICAgICAgaTE4bi1yZWN1cnJlbmNlRWRpdG9yRnJlcXVlbmNpZXNZZWFybHk9XCJrZW5kby5zY2hlZHVsZXIucmVjdXJyZW5jZUVkaXRvckZyZXF1ZW5jaWVzWWVhcmx5fFRoZSB0ZXh0IHNpbWlsYXIgdG8gJ1llYXJseScgZGlzcGxheWVkIGluIHRoZSBzY2hlZHVsZXIgcmVjdXJyZW5jZSBlZGl0b3IuXCJcbiAgICAgICAgICAgIHJlY3VycmVuY2VFZGl0b3JGcmVxdWVuY2llc1llYXJseT0nWWVhcmx5J1xuXG4gICAgICAgICAgICBpMThuLXJlY3VycmVuY2VFZGl0b3JPZmZzZXRQb3NpdGlvbnNGaXJzdD1cImtlbmRvLnNjaGVkdWxlci5yZWN1cnJlbmNlRWRpdG9yT2Zmc2V0UG9zaXRpb25zRmlyc3R8VGhlIHRleHQgc2ltaWxhciB0byAnRmlyc3QnIGRpc3BsYXllZCBpbiB0aGUgc2NoZWR1bGVyIHJlY3VycmVuY2UgZWRpdG9yLlwiXG4gICAgICAgICAgICByZWN1cnJlbmNlRWRpdG9yT2Zmc2V0UG9zaXRpb25zRmlyc3Q9J0ZpcnN0J1xuXG4gICAgICAgICAgICBpMThuLXJlY3VycmVuY2VFZGl0b3JPZmZzZXRQb3NpdGlvbnNTZWNvbmQ9XCJrZW5kby5zY2hlZHVsZXIucmVjdXJyZW5jZUVkaXRvck9mZnNldFBvc2l0aW9uc1NlY29uZHxUaGUgdGV4dCBzaW1pbGFyIHRvICdTZWNvbmQnIGRpc3BsYXllZCBpbiB0aGUgc2NoZWR1bGVyIHJlY3VycmVuY2UgZWRpdG9yLlwiXG4gICAgICAgICAgICByZWN1cnJlbmNlRWRpdG9yT2Zmc2V0UG9zaXRpb25zU2Vjb25kPSdTZWNvbmQnXG5cbiAgICAgICAgICAgIGkxOG4tcmVjdXJyZW5jZUVkaXRvck9mZnNldFBvc2l0aW9uc1RoaXJkPVwia2VuZG8uc2NoZWR1bGVyLnJlY3VycmVuY2VFZGl0b3JPZmZzZXRQb3NpdGlvbnNUaGlyZHxUaGUgdGV4dCBzaW1pbGFyIHRvICdUaGlyZCcgZGlzcGxheWVkIGluIHRoZSBzY2hlZHVsZXIgcmVjdXJyZW5jZSBlZGl0b3IuXCJcbiAgICAgICAgICAgIHJlY3VycmVuY2VFZGl0b3JPZmZzZXRQb3NpdGlvbnNUaGlyZD0nVGhpcmQnXG5cbiAgICAgICAgICAgIGkxOG4tcmVjdXJyZW5jZUVkaXRvck9mZnNldFBvc2l0aW9uc0ZvdXJ0aD1cImtlbmRvLnNjaGVkdWxlci5yZWN1cnJlbmNlRWRpdG9yT2Zmc2V0UG9zaXRpb25zRm91cnRofFRoZSB0ZXh0IHNpbWlsYXIgdG8gJ0ZvdXJ0aCcgZGlzcGxheWVkIGluIHRoZSBzY2hlZHVsZXIgcmVjdXJyZW5jZSBlZGl0b3IuXCJcbiAgICAgICAgICAgIHJlY3VycmVuY2VFZGl0b3JPZmZzZXRQb3NpdGlvbnNGb3VydGg9J0ZvdXJ0aCdcblxuICAgICAgICAgICAgaTE4bi1yZWN1cnJlbmNlRWRpdG9yT2Zmc2V0UG9zaXRpb25zTGFzdD1cImtlbmRvLnNjaGVkdWxlci5yZWN1cnJlbmNlRWRpdG9yT2Zmc2V0UG9zaXRpb25zTGFzdHxUaGUgdGV4dCBzaW1pbGFyIHRvICdMYXN0JyBkaXNwbGF5ZWQgaW4gdGhlIHNjaGVkdWxlciByZWN1cnJlbmNlIGVkaXRvci5cIlxuICAgICAgICAgICAgcmVjdXJyZW5jZUVkaXRvck9mZnNldFBvc2l0aW9uc0xhc3Q9J0xhc3QnXG5cbiAgICAgICAgICAgIGkxOG4tcmVjdXJyZW5jZUVkaXRvcldlZWtkYXlzRGF5PVwia2VuZG8uc2NoZWR1bGVyLnJlY3VycmVuY2VFZGl0b3JXZWVrZGF5c0RheXxUaGUgdGV4dCBzaW1pbGFyIHRvICdEYXknIGRpc3BsYXllZCBpbiB0aGUgcmVwZWF0IGJ5IHNlY3Rpb24gb2YgdGhlIG1vbnRobHkgcmVjdXJyZW5jZSBwYXR0ZXJuLlwiXG4gICAgICAgICAgICByZWN1cnJlbmNlRWRpdG9yV2Vla2RheXNEYXk9J0RheSdcblxuICAgICAgICAgICAgaTE4bi1yZWN1cnJlbmNlRWRpdG9yV2Vla2RheXNXZWVrZGF5PVwia2VuZG8uc2NoZWR1bGVyLnJlY3VycmVuY2VFZGl0b3JXZWVrZGF5c1dlZWtkYXl8VGhlIHRleHQgc2ltaWxhciB0byAnV2Vla2RheScgZGlzcGxheWVkIGluIHRoZSByZXBlYXQgYnkgc2VjdGlvbiBvZiB0aGUgbW9udGhseSByZWN1cnJlbmNlIHBhdHRlcm4uXCJcbiAgICAgICAgICAgIHJlY3VycmVuY2VFZGl0b3JXZWVrZGF5c1dlZWtkYXk9J1dlZWtkYXknXG5cbiAgICAgICAgICAgIGkxOG4tcmVjdXJyZW5jZUVkaXRvcldlZWtkYXlzV2Vla2VuZGRheT1cImtlbmRvLnNjaGVkdWxlci5yZWN1cnJlbmNlRWRpdG9yV2Vla2RheXNXZWVrZW5kZGF5fFRoZSB0ZXh0IHNpbWlsYXIgdG8gJ1dlZWtlbmQgRGF5JyBkaXNwbGF5ZWQgaW4gdGhlIHJlcGVhdCBieSBzZWN0aW9uIG9mIHRoZSBtb250aGx5IHJlY3VycmVuY2UgcGF0dGVybi5cIlxuICAgICAgICAgICAgcmVjdXJyZW5jZUVkaXRvcldlZWtkYXlzV2Vla2VuZGRheT0nV2Vla2VuZCBEYXknXG5cbiAgICAgICAgICAgIGkxOG4tcmVjdXJyZW5jZUVkaXRvckVuZEFmdGVyPVwia2VuZG8uc2NoZWR1bGVyLnJlY3VycmVuY2VFZGl0b3JFbmRBZnRlcnxUaGUgdGV4dCBzaW1pbGFyIHRvICdBZnRlcicgZGlzcGxheWVkIGluIHRoZSBzY2hlZHVsZXIgcmVjdXJyZW5jZSBlZGl0b3IuXCJcbiAgICAgICAgICAgIHJlY3VycmVuY2VFZGl0b3JFbmRBZnRlcj0nQWZ0ZXInXG5cbiAgICAgICAgICAgIGkxOG4tcmVjdXJyZW5jZUVkaXRvckVuZE9jY3VycmVuY2U9XCJrZW5kby5zY2hlZHVsZXIucmVjdXJyZW5jZUVkaXRvckVuZE9jY3VycmVuY2V8VGhlIHRleHQgc2ltaWxhciB0byAnb2NjdXJyZW5jZShzKScgZGlzcGxheWVkIGluIHRoZSBzY2hlZHVsZXIgcmVjdXJyZW5jZSBlZGl0b3IuXCJcbiAgICAgICAgICAgIHJlY3VycmVuY2VFZGl0b3JFbmRPY2N1cnJlbmNlPSdvY2N1cnJlbmNlKHMpJ1xuXG4gICAgICAgICAgICBpMThuLXJlY3VycmVuY2VFZGl0b3JFbmRMYWJlbD1cImtlbmRvLnNjaGVkdWxlci5yZWN1cnJlbmNlRWRpdG9yRW5kTGFiZWx8VGhlIHRleHQgc2ltaWxhciB0byAnRW5kJyBkaXNwbGF5ZWQgaW4gdGhlIHNjaGVkdWxlciByZWN1cnJlbmNlIGVkaXRvci5cIlxuICAgICAgICAgICAgcmVjdXJyZW5jZUVkaXRvckVuZExhYmVsPSdFbmQnXG5cbiAgICAgICAgICAgIGkxOG4tcmVjdXJyZW5jZUVkaXRvckVuZE5ldmVyPVwia2VuZG8uc2NoZWR1bGVyLnJlY3VycmVuY2VFZGl0b3JFbmROZXZlcnxUaGUgdGV4dCBzaW1pbGFyIHRvICdOZXZlcicgZGlzcGxheWVkIGluIHRoZSBzY2hlZHVsZXIgcmVjdXJyZW5jZSBlZGl0b3IuXCJcbiAgICAgICAgICAgIHJlY3VycmVuY2VFZGl0b3JFbmROZXZlcj0nTmV2ZXInXG5cbiAgICAgICAgICAgIGkxOG4tcmVjdXJyZW5jZUVkaXRvckVuZE9uPVwia2VuZG8uc2NoZWR1bGVyLnJlY3VycmVuY2VFZGl0b3JFbmRPbnxUaGUgdGV4dCBzaW1pbGFyIHRvICdPbicgZGlzcGxheWVkIGluIHRoZSBzY2hlZHVsZXIgcmVjdXJyZW5jZSBlZGl0b3IuXCJcbiAgICAgICAgICAgIHJlY3VycmVuY2VFZGl0b3JFbmRPbj0nT24nXG5cbiAgICAgICAgICAgIGkxOG4tZGVzdHJveT1cImtlbmRvLnNjaGVkdWxlci5kZXN0cm95fFRoZSB0ZXh0IG9mIHRoZSAnRGVsZXRlJyBidXR0b24gZGlzcGxheWVkIGluIHRoZSBzY2hlZHVsZXIgcmVtb3ZlIGNvbmZpcm1hdGlvbiBkaWFsb2cuXCJcbiAgICAgICAgICAgIGRlc3Ryb3k9J0RlbGV0ZSdcblxuICAgICAgICAgICAgaTE4bi1kZWxldGVDb25maXJtYXRpb249XCJrZW5kby5zY2hlZHVsZXIuZGVsZXRlQ29uZmlybWF0aW9ufFRoZSB0ZXh0IHNpbWlsYXIgdG8gJ0FyZSB5b3Ugc3VyZSB5b3Ugd2FudCB0byBkZWxldGUgdGhpcyBldmVudD8nIGRpc3BsYXllZCBpbiBzY2hlZHVsZXIgcmVtb3ZlIGNvbmZpcm1hdGlvbiBkaWFsb2cuXCJcbiAgICAgICAgICAgIGRlbGV0ZUNvbmZpcm1hdGlvbj0nQXJlIHlvdSBzdXJlIHlvdSB3YW50IHRvIGRlbGV0ZSB0aGlzIGV2ZW50PydcblxuICAgICAgICAgICAgaTE4bi1lZGl0UmVjdXJyaW5nQ29uZmlybWF0aW9uPVwia2VuZG8uc2NoZWR1bGVyLmVkaXRSZWN1cnJpbmdDb25maXJtYXRpb258VGhlIHRleHQgc2ltaWxhciB0byAnRG8geW91IHdhbnQgdG8gZWRpdCBvbmx5IHRoaXMgZXZlbnQgb2NjdXJyZW5jZSBvciB0aGUgd2hvbGUgc2VyaWVzPycgZGlzcGxheWVkIGluIHRoZSBzY2hlZHVsZXIgcmVjdXJyaW5nIGNvbmZpcm1hdGlvbiBkaWFsb2cuXCJcbiAgICAgICAgICAgIGVkaXRSZWN1cnJpbmdDb25maXJtYXRpb249J0RvIHlvdSB3YW50IHRvIGVkaXQgb25seSB0aGlzIGV2ZW50IG9jY3VycmVuY2Ugb3IgdGhlIHdob2xlIHNlcmllcz8nXG5cbiAgICAgICAgICAgIGkxOG4tZWRpdE9jY3VycmVuY2U9XCJrZW5kby5zY2hlZHVsZXIuZWRpdE9jY3VycmVuY2V8VGhlIHRleHQgb2YgdGhlICdFZGl0IGN1cnJlbnQgb2NjdXJyZW5jZScgYnV0dG9uIGRpc3BsYXllZCBpbiB0aGUgc2NoZWR1bGVyIHJlY3VycmluZyBjb25maXJtYXRpb24gZGlhbG9nLlwiXG4gICAgICAgICAgICBlZGl0T2NjdXJyZW5jZT0nRWRpdCBjdXJyZW50IG9jY3VycmVuY2UnXG5cbiAgICAgICAgICAgIGkxOG4tZWRpdFNlcmllcz1cImtlbmRvLnNjaGVkdWxlci5lZGl0U2VyaWVzfFRoZSB0ZXh0IG9mIHRoZSAnRWRpdCB0aGUgc2VyaWVzJyBidXR0b24gZGlzcGxheWVkIGluIHRoZSBzY2hlZHVsZXIgcmVjdXJyaW5nIGNvbmZpcm1hdGlvbiBkaWFsb2cuXCJcbiAgICAgICAgICAgIGVkaXRTZXJpZXM9J0VkaXQgdGhlIHNlcmllcydcblxuICAgICAgICAgICAgaTE4bi1kZWxldGVSZWN1cnJpbmdDb25maXJtYXRpb249XCJrZW5kby5zY2hlZHVsZXIuZGVsZXRlUmVjdXJyaW5nQ29uZmlybWF0aW9ufFRoZSB0ZXh0IHNpbWlsYXIgdG8gJ0RvIHlvdSB3YW50IHRvIGRlbGV0ZSBvbmx5IHRoaXMgZXZlbnQgb2NjdXJyZW5jZSBvciB0aGUgd2hvbGUgc2VyaWVzPycgZGlzcGxheWVkIGluIHRoZSBzY2hlZHVsZXIgcmVjdXJyaW5nIGNvbmZpcm1hdGlvbiBkaWFsb2cuXCJcbiAgICAgICAgICAgIGRlbGV0ZVJlY3VycmluZ0NvbmZpcm1hdGlvbj0nRG8geW91IHdhbnQgdG8gZGVsZXRlIG9ubHkgdGhpcyBldmVudCBvY2N1cnJlbmNlIG9yIHRoZSB3aG9sZSBzZXJpZXM/J1xuXG4gICAgICAgICAgICBpMThuLWRlbGV0ZU9jY3VycmVuY2U9XCJrZW5kby5zY2hlZHVsZXIuZGVsZXRlT2NjdXJyZW5jZXxUaGUgdGV4dCBvZiB0aGUgJ0RlbGV0ZSBjdXJyZW50IG9jY3VycmVuY2UnIGJ1dHRvbiBkaXNwbGF5ZWQgaW4gdGhlIHNjaGVkdWxlciByZWN1cnJpbmcgY29uZmlybWF0aW9uIGRpYWxvZy5cIlxuICAgICAgICAgICAgZGVsZXRlT2NjdXJyZW5jZT0nRGVsZXRlIGN1cnJlbnQgb2NjdXJyZW5jZSdcblxuICAgICAgICAgICAgaTE4bi1kZWxldGVTZXJpZXM9XCJrZW5kby5zY2hlZHVsZXIuZGVsZXRlU2VyaWVzfFRoZSB0ZXh0IHNpbWlsYXIgb2YgdGhlICdEZWxldGUgdGhlIHNlcmllcycgYnV0dG9uIGRpc3BsYXllZCBpbiB0aGUgc2NoZWR1bGVyIHJlY3VycmluZyBjb25maXJtYXRpb24gZGlhbG9nLlwiXG4gICAgICAgICAgICBkZWxldGVTZXJpZXM9J0RlbGV0ZSB0aGUgc2VyaWVzJ1xuXG4gICAgICAgICAgICBpMThuLWRlbGV0ZURpYWxvZ1RpdGxlPVwia2VuZG8uc2NoZWR1bGVyLmRlbGV0ZURpYWxvZ1RpdGxlfFRoZSB0aXRsZSBvZiB0aGUgcmVtb3ZlIGNvbmZpcm1hdGlvbiBkaWFsb2csIHNpbWlsYXIgdG8gJ0RlbGV0ZSBFdmVudCcuXCJcbiAgICAgICAgICAgIGRlbGV0ZURpYWxvZ1RpdGxlPSdEZWxldGUgRXZlbnQnXG5cbiAgICAgICAgICAgIGkxOG4tZGVsZXRlUmVjdXJyaW5nRGlhbG9nVGl0bGU9XCJrZW5kby5zY2hlZHVsZXIuZGVsZXRlUmVjdXJyaW5nRGlhbG9nVGl0bGV8VGhlIHRpdGxlIG9mIHRoZSByZWN1cnJpbmcgcmVtb3ZlIGNvbmZpcm1hdGlvbiBkaWFsb2csIHNpbWlsYXIgdG8gJ0RlbGV0ZSBSZWN1cnJpbmcgSXRlbSdcIlxuICAgICAgICAgICAgZGVsZXRlUmVjdXJyaW5nRGlhbG9nVGl0bGU9J0RlbGV0ZSBSZWN1cnJpbmcgSXRlbSdcblxuICAgICAgICAgICAgaTE4bi1lZGl0UmVjdXJyaW5nRGlhbG9nVGl0bGU9XCJrZW5kby5zY2hlZHVsZXIuZWRpdFJlY3VycmluZ0RpYWxvZ1RpdGxlfFRoZSB0aXRsZSBvZiB0aGUgcmVjdXJyaW5nIGVkaXQgY29uZmlybWF0aW9uIGRpYWxvZywgc2ltaWxhciB0byAnRWRpdCBSZWN1cnJpbmcgSXRlbSdcIlxuICAgICAgICAgICAgZWRpdFJlY3VycmluZ0RpYWxvZ1RpdGxlPSdFZGl0IFJlY3VycmluZyBJdGVtJ1xuICAgICAgICA+XG4gICAgICAgIDwvbmctY29udGFpbmVyPlxuXG4gICAgICAgIDxrZW5kby1zY2hlZHVsZXItdG9vbGJhclxuICAgICAgICAgICAgW2RhdGVSYW5nZV09XCJkYXRlUmFuZ2VTdHJlYW1cIlxuICAgICAgICAgICAgW3NlbGVjdGVkRGF0ZV09XCJzZWxlY3RlZERhdGVTdHJlYW1cIlxuICAgICAgICAgICAgW3ZpZXdzXT1cInZpZXdzXCJcbiAgICAgICAgICAgIFtzZWxlY3RlZFZpZXddPVwic2VsZWN0ZWRWaWV3XCJcbiAgICAgICAgICAgIFt0ZW1wbGF0ZV09XCJ0b29sYmFyVGVtcGxhdGVcIlxuICAgICAgICAgICAgKG5hdmlnYXRlKT1cIm9uTmF2aWdhdGlvbkFjdGlvbigkZXZlbnQpXCJcbiAgICAgICAgICAgIFttaW5dPVwibWluXCJcbiAgICAgICAgICAgIFttYXhdPVwibWF4XCJcbiAgICAgICAgPjwva2VuZG8tc2NoZWR1bGVyLXRvb2xiYXI+XG5cbiAgICAgICAgPG5nLWNvbnRhaW5lciAqbmdUZW1wbGF0ZU91dGxldD1cInNlbGVjdGVkVmlldz8udGVtcGxhdGVcIj5cbiAgICAgICAgPC9uZy1jb250YWluZXI+XG5cbiAgICAgICAgPG5nLWNvbnRhaW5lciAjY29uZmlybWF0aW9uRGlhbG9nQ29udGFpbmVyPlxuICAgICAgICA8L25nLWNvbnRhaW5lcj5cblxuICAgICAgICA8a2VuZG8tc2NoZWR1bGVyLWVkaXQtZGlhbG9nXG4gICAgICAgICAgICBbcmVzb3VyY2VzXT1cInJlc291cmNlc1wiXG4gICAgICAgICAgICBbZWRpdFRlbXBsYXRlXT1cImVkaXREaWFsb2dUZW1wbGF0ZVwiXG4gICAgICAgICAgICBbdGltZXpvbmVdPVwidGltZXpvbmVcIlxuICAgICAgICAgICAgW2ZpZWxkc109XCJtb2RlbEZpZWxkc1wiXG4gICAgICAgID48L2tlbmRvLXNjaGVkdWxlci1lZGl0LWRpYWxvZz5cblxuICAgICAgICA8a2VuZG8tcmVzaXplLXNlbnNvciAocmVzaXplKT1cIm9uUmVzaXplKClcIj48L2tlbmRvLXJlc2l6ZS1zZW5zb3I+XG5cbiAgICAgICAgPGRpdiBbbG9hZGluZ109XCJsb2FkaW5nXCIga2VuZG9TY2hlZHVsZXJMb2FkaW5nPlxuICAgICAgICA8L2Rpdj5cbiAgICBgXG4gICAgICAgICAgICB9LF0gfSxcbl07XG4vKiogQG5vY29sbGFwc2UgKi9cblNjaGVkdWxlckNvbXBvbmVudC5jdG9yUGFyYW1ldGVycyA9ICgpID0+IFtcbiAgICB7IHR5cGU6IEVsZW1lbnRSZWYgfSxcbiAgICB7IHR5cGU6IFZpZXdDb250ZXh0U2VydmljZSB9LFxuICAgIHsgdHlwZTogVmlld1N0YXRlU2VydmljZSB9LFxuICAgIHsgdHlwZTogRWRpdFNlcnZpY2UgfSxcbiAgICB7IHR5cGU6IERpYWxvZ3NTZXJ2aWNlIH0sXG4gICAgeyB0eXBlOiBJbnRsU2VydmljZSB9LFxuICAgIHsgdHlwZTogQ2hhbmdlRGV0ZWN0b3JSZWYgfSxcbiAgICB7IHR5cGU6IE5nWm9uZSB9LFxuICAgIHsgdHlwZTogUERGU2VydmljZSB9LFxuICAgIHsgdHlwZTogTG9jYWxpemF0aW9uU2VydmljZSB9LFxuICAgIHsgdHlwZTogRG9tRXZlbnRzU2VydmljZSB9LFxuICAgIHsgdHlwZTogUmVuZGVyZXIyIH0sXG4gICAgeyB0eXBlOiBGb2N1c1NlcnZpY2UgfVxuXTtcblNjaGVkdWxlckNvbXBvbmVudC5wcm9wRGVjb3JhdG9ycyA9IHtcbiAgICBob3N0Q2xhc3NlczogW3sgdHlwZTogSG9zdEJpbmRpbmcsIGFyZ3M6IFsnY2xhc3Muay13aWRnZXQnLF0gfSwgeyB0eXBlOiBIb3N0QmluZGluZywgYXJnczogWydjbGFzcy5rLXNjaGVkdWxlcicsXSB9LCB7IHR5cGU6IEhvc3RCaW5kaW5nLCBhcmdzOiBbJ2NsYXNzLmstZmxvYXR3cmFwJyxdIH1dLFxuICAgIHJ0bDogW3sgdHlwZTogSG9zdEJpbmRpbmcsIGFyZ3M6IFsnY2xhc3Muay1ydGwnLF0gfV0sXG4gICAgZGlyOiBbeyB0eXBlOiBIb3N0QmluZGluZywgYXJnczogWydhdHRyLmRpcicsXSB9XSxcbiAgICBzZWxlY3RlZFZpZXdJbmRleDogW3sgdHlwZTogSW5wdXQgfV0sXG4gICAgZWRpdGFibGU6IFt7IHR5cGU6IElucHV0IH1dLFxuICAgIG1pbjogW3sgdHlwZTogSW5wdXQgfV0sXG4gICAgbWF4OiBbeyB0eXBlOiBJbnB1dCB9XSxcbiAgICBldmVudEhlaWdodDogW3sgdHlwZTogSW5wdXQgfV0sXG4gICAgY29sdW1uV2lkdGg6IFt7IHR5cGU6IElucHV0IH1dLFxuICAgIHNob3dXb3JrSG91cnM6IFt7IHR5cGU6IElucHV0IH1dLFxuICAgIHN0YXJ0VGltZTogW3sgdHlwZTogSW5wdXQgfV0sXG4gICAgZW5kVGltZTogW3sgdHlwZTogSW5wdXQgfV0sXG4gICAgd29ya0RheVN0YXJ0OiBbeyB0eXBlOiBJbnB1dCB9XSxcbiAgICB3b3JrRGF5RW5kOiBbeyB0eXBlOiBJbnB1dCB9XSxcbiAgICB3b3JrV2Vla1N0YXJ0OiBbeyB0eXBlOiBJbnB1dCB9XSxcbiAgICB3b3JrV2Vla0VuZDogW3sgdHlwZTogSW5wdXQgfV0sXG4gICAgc2xvdER1cmF0aW9uOiBbeyB0eXBlOiBJbnB1dCB9XSxcbiAgICBzbG90RGl2aXNpb25zOiBbeyB0eXBlOiBJbnB1dCB9XSxcbiAgICBzbG90RmlsbDogW3sgdHlwZTogSW5wdXQgfV0sXG4gICAgc2Nyb2xsVGltZTogW3sgdHlwZTogSW5wdXQgfV0sXG4gICAgZ3JvdXA6IFt7IHR5cGU6IElucHV0IH1dLFxuICAgIHJlc291cmNlczogW3sgdHlwZTogSW5wdXQgfV0sXG4gICAgbG9hZGluZzogW3sgdHlwZTogSW5wdXQgfV0sXG4gICAgdGltZXpvbmU6IFt7IHR5cGU6IElucHV0IH1dLFxuICAgIGV2ZW50czogW3sgdHlwZTogSW5wdXQgfV0sXG4gICAgc2VsZWN0ZWREYXRlOiBbeyB0eXBlOiBJbnB1dCB9XSxcbiAgICBtb2RlbEZpZWxkczogW3sgdHlwZTogSW5wdXQgfV0sXG4gICAgY3VycmVudFRpbWVNYXJrZXI6IFt7IHR5cGU6IElucHV0IH1dLFxuICAgIHNsb3RDbGFzczogW3sgdHlwZTogSW5wdXQgfV0sXG4gICAgZXZlbnRDbGFzczogW3sgdHlwZTogSW5wdXQgfV0sXG4gICAgZXZlbnRTdHlsZXM6IFt7IHR5cGU6IElucHV0IH1dLFxuICAgIHNlbGVjdGVkVmlld0luZGV4Q2hhbmdlOiBbeyB0eXBlOiBPdXRwdXQgfV0sXG4gICAgbmF2aWdhdGU6IFt7IHR5cGU6IE91dHB1dCB9XSxcbiAgICBkYXRlQ2hhbmdlOiBbeyB0eXBlOiBPdXRwdXQgfV0sXG4gICAgc2xvdENsaWNrOiBbeyB0eXBlOiBPdXRwdXQgfV0sXG4gICAgc2xvdERibENsaWNrOiBbeyB0eXBlOiBPdXRwdXQgfV0sXG4gICAgY3JlYXRlOiBbeyB0eXBlOiBPdXRwdXQgfV0sXG4gICAgZXZlbnRDbGljazogW3sgdHlwZTogT3V0cHV0IH1dLFxuICAgIGV2ZW50RGJsQ2xpY2s6IFt7IHR5cGU6IE91dHB1dCB9XSxcbiAgICBldmVudEtleWRvd246IFt7IHR5cGU6IE91dHB1dCB9XSxcbiAgICBjYW5jZWw6IFt7IHR5cGU6IE91dHB1dCB9XSxcbiAgICBzYXZlOiBbeyB0eXBlOiBPdXRwdXQgfV0sXG4gICAgcmVtb3ZlOiBbeyB0eXBlOiBPdXRwdXQgfV0sXG4gICAgcmVzaXplU3RhcnQ6IFt7IHR5cGU6IE91dHB1dCB9XSxcbiAgICByZXNpemU6IFt7IHR5cGU6IE91dHB1dCB9XSxcbiAgICByZXNpemVFbmQ6IFt7IHR5cGU6IE91dHB1dCB9XSxcbiAgICBkcmFnU3RhcnQ6IFt7IHR5cGU6IE91dHB1dCB9XSxcbiAgICBkcmFnOiBbeyB0eXBlOiBPdXRwdXQgfV0sXG4gICAgZHJhZ0VuZDogW3sgdHlwZTogT3V0cHV0IH1dLFxuICAgIHBkZkV4cG9ydDogW3sgdHlwZTogT3V0cHV0IH1dLFxuICAgIGVkaXREaWFsb2dUZW1wbGF0ZTogW3sgdHlwZTogQ29udGVudENoaWxkLCBhcmdzOiBbRWRpdERpYWxvZ1RlbXBsYXRlRGlyZWN0aXZlLF0gfV0sXG4gICAgdG9vbGJhclRlbXBsYXRlOiBbeyB0eXBlOiBDb250ZW50Q2hpbGQsIGFyZ3M6IFtUb29sYmFyVGVtcGxhdGVEaXJlY3RpdmUsXSB9XSxcbiAgICB2aWV3czogW3sgdHlwZTogQ29udGVudENoaWxkcmVuLCBhcmdzOiBbU2NoZWR1bGVyVmlldyxdIH1dLFxuICAgIHJlc2l6ZVNlbnNvcjogW3sgdHlwZTogVmlld0NoaWxkLCBhcmdzOiBbUmVzaXplU2Vuc29yQ29tcG9uZW50LF0gfV0sXG4gICAgY29uZmlybWF0aW9uRGlhbG9nQ29udGFpbmVyUmVmOiBbeyB0eXBlOiBWaWV3Q2hpbGQsIGFyZ3M6IFtcImNvbmZpcm1hdGlvbkRpYWxvZ0NvbnRhaW5lclwiLCB7IHJlYWQ6IFZpZXdDb250YWluZXJSZWYsIHN0YXRpYzogdHJ1ZSB9LF0gfV0sXG4gICAgbG9hZGluZ0NvbXBvbmVudDogW3sgdHlwZTogVmlld0NoaWxkLCBhcmdzOiBbTG9hZGluZ0NvbXBvbmVudCxdIH1dLFxuICAgIGFsbERheUV2ZW50VGVtcGxhdGU6IFt7IHR5cGU6IENvbnRlbnRDaGlsZHJlbiwgYXJnczogW0FsbERheUV2ZW50VGVtcGxhdGVEaXJlY3RpdmUsXSB9XSxcbiAgICBldmVudFRlbXBsYXRlOiBbeyB0eXBlOiBDb250ZW50Q2hpbGRyZW4sIGFyZ3M6IFtFdmVudFRlbXBsYXRlRGlyZWN0aXZlLF0gfV0sXG4gICAgdGltZVNsb3RUZW1wbGF0ZTogW3sgdHlwZTogQ29udGVudENoaWxkcmVuLCBhcmdzOiBbVGltZVNsb3RUZW1wbGF0ZURpcmVjdGl2ZSxdIH1dLFxuICAgIG1pbm9yVGltZUhlYWRlclRlbXBsYXRlOiBbeyB0eXBlOiBDb250ZW50Q2hpbGRyZW4sIGFyZ3M6IFtNaW5vclRpbWVIZWFkZXJUZW1wbGF0ZURpcmVjdGl2ZSxdIH1dLFxuICAgIG1ham9yVGltZUhlYWRlclRlbXBsYXRlOiBbeyB0eXBlOiBDb250ZW50Q2hpbGRyZW4sIGFyZ3M6IFtNYWpvclRpbWVIZWFkZXJUZW1wbGF0ZURpcmVjdGl2ZSxdIH1dLFxuICAgIG1vbnRoRGF5U2xvdFRlbXBsYXRlOiBbeyB0eXBlOiBDb250ZW50Q2hpbGRyZW4sIGFyZ3M6IFtNb250aERheVNsb3RUZW1wbGF0ZURpcmVjdGl2ZSxdIH1dLFxuICAgIGRhdGVIZWFkZXJUZW1wbGF0ZTogW3sgdHlwZTogQ29udGVudENoaWxkcmVuLCBhcmdzOiBbRGF0ZUhlYWRlclRlbXBsYXRlRGlyZWN0aXZlLF0gfV0sXG4gICAgYWxsRGF5U2xvdFRlbXBsYXRlOiBbeyB0eXBlOiBDb250ZW50Q2hpbGRyZW4sIGFyZ3M6IFtBbGxEYXlTbG90VGVtcGxhdGVEaXJlY3RpdmUsXSB9XSxcbiAgICBncm91cEhlYWRlclRlbXBsYXRlOiBbeyB0eXBlOiBDb250ZW50Q2hpbGRyZW4sIGFyZ3M6IFtHcm91cEhlYWRlclRlbXBsYXRlRGlyZWN0aXZlLF0gfV0sXG4gICAgYWdlbmRhRGF0ZVRlbXBsYXRlOiBbeyB0eXBlOiBDb250ZW50Q2hpbGRyZW4sIGFyZ3M6IFtBZ2VuZGFEYXRlVGVtcGxhdGVEaXJlY3RpdmUsXSB9XSxcbiAgICBhZ2VuZGFUaW1lVGVtcGxhdGU6IFt7IHR5cGU6IENvbnRlbnRDaGlsZHJlbiwgYXJnczogW0FnZW5kYVRpbWVUZW1wbGF0ZURpcmVjdGl2ZSxdIH1dXG59O1xuXG4vKiogQGhpZGRlbiAqL1xuY29uc3QgaW50ZXJzZWN0cyA9IChzdGFydFRpbWUsIGVuZFRpbWUsIHBlcmlvZFN0YXJ0LCBwZXJpb2RFbmQpID0+IChzdGFydFRpbWUgPCBwZXJpb2RTdGFydCAmJiBlbmRUaW1lID4gcGVyaW9kRW5kKSB8fFxuICAgIChwZXJpb2RTdGFydCA8PSBzdGFydFRpbWUgJiYgc3RhcnRUaW1lIDwgcGVyaW9kRW5kKSB8fFxuICAgIChwZXJpb2RTdGFydCA8IGVuZFRpbWUgJiYgZW5kVGltZSA8PSBwZXJpb2RFbmQgJiYgc3RhcnRUaW1lIDwgZW5kVGltZSk7XG4vKiogQGhpZGRlbiAqL1xuY29uc3QgZGF0ZUluUmFuZ2UgPSAoZGF0ZSwgc3RhcnQsIGVuZCkgPT4gc3RhcnQuZ2V0VGltZSgpIDw9IGRhdGUuZ2V0VGltZSgpICYmIGRhdGUuZ2V0VGltZSgpIDw9IGVuZC5nZXRUaW1lKCk7XG4vKiogQGhpZGRlbiAqL1xuY29uc3Qgcm91bmRBbGxEYXlFbmQgPSAoeyBzdGFydCwgZW5kIH0pID0+IHtcbiAgICBjb25zdCBzdGFydERhdGUgPSBzdGFydC5zdHJpcFRpbWUoKTtcbiAgICBjb25zdCBlbmREYXRlID0gZW5kLnN0cmlwVGltZSgpO1xuICAgIHJldHVybiBlbmREYXRlLmdldFRpbWUoKSAhPT0gZW5kLmdldFRpbWUoKSB8fCBzdGFydERhdGUuZ2V0VGltZSgpID09PSBlbmREYXRlLmdldFRpbWUoKSA/IGVuZERhdGUuYWRkRGF5cygxKSA6IGVuZERhdGU7XG59O1xuLyoqIEBoaWRkZW4gKi9cbmZ1bmN0aW9uIHRvSW52YXJpYW50VGltZShkYXRlKSB7XG4gICAgdmFyIHN0YXRpY0RhdGUgPSBuZXcgRGF0ZSgxOTgwLCAwLCAxLCAwLCAwLCAwKTtcbiAgICBpZiAoZGF0ZSkge1xuICAgICAgICBzdGF0aWNEYXRlLnNldEhvdXJzKGRhdGUuZ2V0SG91cnMoKSwgZGF0ZS5nZXRNaW51dGVzKCksIGRhdGUuZ2V0U2Vjb25kcygpLCBkYXRlLmdldE1pbGxpc2Vjb25kcygpKTtcbiAgICB9XG4gICAgcmV0dXJuIHN0YXRpY0RhdGU7XG59XG4vKipcbiAqIEBoaWRkZW5cbiAqIFRPRE8gTW92ZSB0byBkYXRlLW1hdGhcbiAqL1xuY29uc3QgYWRkVVRDRGF5cyA9IChkYXRlLCBvZmZzZXQpID0+IHtcbiAgICBjb25zdCBuZXdEYXRlID0gbmV3IERhdGUoZGF0ZS5nZXRUaW1lKCkpO1xuICAgIG5ld0RhdGUuc2V0VVRDRGF0ZShuZXdEYXRlLmdldFVUQ0RhdGUoKSArIG9mZnNldCk7XG4gICAgcmV0dXJuIG5ld0RhdGU7XG59O1xuLy8gVE9ETzogbmFtZT8gbW92ZSB0byBkYXRlLW1hdGhcbi8qKiBAaGlkZGVuICovXG5mdW5jdGlvbiB0b1VUQ1RpbWUobG9jYWxEYXRlLCBsb2NhbFRpbWUpIHtcbiAgICByZXR1cm4gbmV3IERhdGUoRGF0ZS5VVEMobG9jYWxEYXRlLmdldEZ1bGxZZWFyKCksIGxvY2FsRGF0ZS5nZXRNb250aCgpLCBsb2NhbERhdGUuZ2V0RGF0ZSgpLCBsb2NhbFRpbWUuZ2V0SG91cnMoKSwgbG9jYWxUaW1lLmdldE1pbnV0ZXMoKSwgbG9jYWxUaW1lLmdldFNlY29uZHMoKSwgbG9jYWxUaW1lLmdldE1pbGxpc2Vjb25kcygpKSk7XG59XG4vLyAgVE9ETzogbW92ZSB0byBkYXRlLW1hdGhcbi8qKiBAaGlkZGVuICovXG5mdW5jdGlvbiB0b1VUQ0RhdGUobG9jYWxEYXRlKSB7XG4gICAgcmV0dXJuIG5ldyBEYXRlKERhdGUuVVRDKGxvY2FsRGF0ZS5nZXRGdWxsWWVhcigpLCBsb2NhbERhdGUuZ2V0TW9udGgoKSwgbG9jYWxEYXRlLmdldERhdGUoKSkpO1xufVxuLy8gVE9ETzogbW92ZSB0byBkYXRlLW1hdGhcbi8qKiBAaGlkZGVuICovXG5mdW5jdGlvbiBnZXRVVENEYXRlKHV0Y0RhdGUpIHtcbiAgICByZXR1cm4gbmV3IERhdGUoRGF0ZS5VVEModXRjRGF0ZS5nZXRVVENGdWxsWWVhcigpLCB1dGNEYXRlLmdldFVUQ01vbnRoKCksIHV0Y0RhdGUuZ2V0VVRDRGF0ZSgpKSk7XG59XG4vLyBUT0RPOiBtb3ZlIHRvIGRhdGUtbWF0aFxuLyoqIEBoaWRkZW4gKi9cbmZ1bmN0aW9uIHRvVVRDRGF0ZVRpbWUobG9jYWxEYXRlKSB7XG4gICAgcmV0dXJuIG5ldyBEYXRlKERhdGUuVVRDKGxvY2FsRGF0ZS5nZXRGdWxsWWVhcigpLCBsb2NhbERhdGUuZ2V0TW9udGgoKSwgbG9jYWxEYXRlLmdldERhdGUoKSwgbG9jYWxEYXRlLmdldEhvdXJzKCksIGxvY2FsRGF0ZS5nZXRNaW51dGVzKCksIGxvY2FsRGF0ZS5nZXRTZWNvbmRzKCksIGxvY2FsRGF0ZS5nZXRNaWxsaXNlY29uZHMoKSkpO1xufVxuLyoqIEBoaWRkZW4gKi9cbmZ1bmN0aW9uIGRhdGVXaXRoVGltZSh0YXJnZXQsIHRpbWUpIHtcbiAgICByZXR1cm4gbmV3IERhdGUodGFyZ2V0LmdldEZ1bGxZZWFyKCksIHRhcmdldC5nZXRNb250aCgpLCB0YXJnZXQuZ2V0RGF0ZSgpLCB0aW1lLmdldEhvdXJzKCksIHRpbWUuZ2V0TWludXRlcygpKTtcbn1cbmZ1bmN0aW9uIGdldERhdGFJZHgodmFsdWUsIHJlc291cmNlKSB7XG4gICAgY29uc3QgZGF0YSA9IHJlc291cmNlLmRhdGE7XG4gICAgZm9yIChsZXQgZGF0YUlkeCA9IDA7IGRhdGFJZHggPCBkYXRhLmxlbmd0aDsgZGF0YUlkeCsrKSB7XG4gICAgICAgIGlmIChnZXRGaWVsZChkYXRhW2RhdGFJZHhdLCByZXNvdXJjZS52YWx1ZUZpZWxkKSA9PT0gdmFsdWUpIHtcbiAgICAgICAgICAgIHJldHVybiBkYXRhSWR4O1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiAtMTtcbn1cbmZ1bmN0aW9uIHJlc291cmNlSXRlbSh2YWx1ZSwgcmVzb3VyY2UpIHtcbiAgICBjb25zdCBpbmRleCA9IGdldERhdGFJZHgodmFsdWUsIHJlc291cmNlKTtcbiAgICByZXR1cm4gaW5kZXggPj0gMCA/IHJlc291cmNlLmRhdGFbaW5kZXhdIDoge307XG59XG5mdW5jdGlvbiByZXNvdXJjZUl0ZW1zKHZhbHVlcywgcmVzb3VyY2UpIHtcbiAgICByZXR1cm4gdmFsdWVzLm1hcCh2YWx1ZSA9PiByZXNvdXJjZUl0ZW0odmFsdWUsIHJlc291cmNlKSk7XG59XG5mdW5jdGlvbiBjbG9uZVJlc291cmNlcyhhcnIpIHtcbiAgICBjb25zdCByZXN1bHQgPSBbXTtcbiAgICBmb3IgKGxldCBpZHggPSAwOyBpZHggPCBhcnIubGVuZ3RoOyBpZHgrKykge1xuICAgICAgICBjb25zdCBjbG9uZSQkMSA9IE9iamVjdC5hc3NpZ24oe30sIGFycltpZHhdKTtcbiAgICAgICAgY2xvbmUkJDEucmVzb3VyY2VzID0gY2xvbmUkJDEucmVzb3VyY2VzLnNsaWNlKDApO1xuICAgICAgICByZXN1bHQucHVzaChjbG9uZSQkMSk7XG4gICAgfVxuICAgIHJldHVybiByZXN1bHQ7XG59XG4vKiogQGhpZGRlbiAqL1xuZnVuY3Rpb24gcmVzb3VyY2VJdGVtQnlWYWx1ZShldmVudCwgcmVzb3VyY2UpIHtcbiAgICBjb25zdCB2YWx1ZSA9IGdldEZpZWxkKGV2ZW50LCByZXNvdXJjZS5maWVsZCk7XG4gICAgaWYgKEFycmF5LmlzQXJyYXkodmFsdWUpKSB7XG4gICAgICAgIHJldHVybiByZXNvdXJjZUl0ZW1zKHZhbHVlLCByZXNvdXJjZSk7XG4gICAgfVxuICAgIHJldHVybiByZXNvdXJjZUl0ZW0odmFsdWUsIHJlc291cmNlKTtcbn1cbmZ1bmN0aW9uIGFkZE5vdEdyb3VwZWRSZXNvdXJjZXMoZXZlbnQsIHJlc291cmNlcywgYWxsUmVzb3VyY2VzKSB7XG4gICAgZm9yIChsZXQgcmVzb3VyY2VJZHggPSAwOyByZXNvdXJjZUlkeCA8IHJlc291cmNlcy5sZW5ndGg7IHJlc291cmNlSWR4KyspIHtcbiAgICAgICAgY29uc3QgY3VycmVudCA9IHJlc291cmNlc1tyZXNvdXJjZUlkeF07XG4gICAgICAgIGZvciAobGV0IGlkeCA9IDA7IGlkeCA8IGFsbFJlc291cmNlcy5sZW5ndGg7IGlkeCsrKSB7XG4gICAgICAgICAgICBjb25zdCBpdGVtID0gYWxsUmVzb3VyY2VzW2lkeF07XG4gICAgICAgICAgICBpZiAoIWN1cnJlbnQucmVzb3VyY2VzW2lkeF0gJiYgaXRlbS5kYXRhKSB7XG4gICAgICAgICAgICAgICAgY3VycmVudC5yZXNvdXJjZXNbaWR4XSA9IHJlc291cmNlSXRlbUJ5VmFsdWUoZXZlbnQsIGl0ZW0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxufVxuLyoqIEBoaWRkZW4gKi9cbmZ1bmN0aW9uIGV2ZW50UmVzb3VyY2VzKGV2ZW50LCB7IHRhc2tSZXNvdXJjZXMsIGhhc0dyb3Vwcywgc3BhbnMsIGFsbFJlc291cmNlcyA9IFtdIH0pIHtcbiAgICBsZXQgcmVzb3VyY2VzID0gW107XG4gICAgZm9yIChsZXQgcmVzb3VyY2VJZHggPSAwOyByZXNvdXJjZUlkeCA8IHRhc2tSZXNvdXJjZXMubGVuZ3RoOyByZXNvdXJjZUlkeCsrKSB7XG4gICAgICAgIGNvbnN0IHJlc291cmNlID0gdGFza1Jlc291cmNlc1tyZXNvdXJjZUlkeF07XG4gICAgICAgIGlmICghcmVzb3VyY2UuZGF0YSkge1xuICAgICAgICAgICAgcmVzb3VyY2VzID0gW3sgbGVhZklkeDogMCwgcmVzb3VyY2VzOiBbXSB9XTtcbiAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IHJlc291cmNlSW5kZXggPSBhbGxSZXNvdXJjZXMuaW5kZXhPZihyZXNvdXJjZSk7XG4gICAgICAgIGxldCB2YWx1ZXMgPSBnZXRGaWVsZChldmVudCwgcmVzb3VyY2UuZmllbGQpO1xuICAgICAgICBpZiAoIUFycmF5LmlzQXJyYXkodmFsdWVzKSkge1xuICAgICAgICAgICAgdmFsdWVzID0gW3ZhbHVlc107XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgZXhwYW5kZWRSZXNvdXJjZXMgPSBbXTtcbiAgICAgICAgZm9yIChsZXQgdmFsdWVJZHggPSAwOyB2YWx1ZUlkeCA8IHZhbHVlcy5sZW5ndGg7IHZhbHVlSWR4KyspIHtcbiAgICAgICAgICAgIGNvbnN0IGRhdGFJZHggPSBnZXREYXRhSWR4KHZhbHVlc1t2YWx1ZUlkeF0sIHJlc291cmNlKTtcbiAgICAgICAgICAgIGlmIChkYXRhSWR4IDwgMCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBbeyBsZWFmSWR4OiBoYXNHcm91cHMgPyAtMSA6IDAsIHJlc291cmNlczogW10gfV07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb25zdCBpdGVtID0gcmVzb3VyY2UuZGF0YVtkYXRhSWR4XTtcbiAgICAgICAgICAgIC8vIGhhcyBncm91cHMgLSBuZWVkIGFsbCBjb3BpZXMgb2YgdGhlIG11bHRpcGxlIHJlc291cmNlXG4gICAgICAgICAgICAvLyBubyBncm91cHMgLSBqdXN0IHRoZSBmaXJzdFxuICAgICAgICAgICAgaWYgKHJlc291cmNlSWR4ID09PSAwICYmIChoYXNHcm91cHMgfHwgdmFsdWVJZHggPT09IDApKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgcmVzb3VyY2VJdGVtcyA9IFtdO1xuICAgICAgICAgICAgICAgIHJlc291cmNlSXRlbXNbcmVzb3VyY2VJbmRleF0gPSByZXNvdXJjZS5tdWx0aXBsZSAmJiAhaGFzR3JvdXBzID8gW2l0ZW1dIDogaXRlbTtcbiAgICAgICAgICAgICAgICByZXNvdXJjZXMucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgIGxlYWZJZHg6IGhhc0dyb3VwcyA/IGRhdGFJZHggKiBzcGFuc1tyZXNvdXJjZUlkeF0gOiAwLFxuICAgICAgICAgICAgICAgICAgICBjb2xvcjogZ2V0RmllbGQoaXRlbSwgcmVzb3VyY2UuY29sb3JGaWVsZCksXG4gICAgICAgICAgICAgICAgICAgIHJlc291cmNlczogcmVzb3VyY2VJdGVtc1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoaGFzR3JvdXBzKSB7IC8vIGRvbid0IGNyZWF0ZSBtdWx0aXBsZSByZXNvdXJjZSBncm91cHMgaWYgbm8gZ3JvdXBzIGZvciBtdWx0aXBsZSByZXNvdXJjZXNcbiAgICAgICAgICAgICAgICBsZXQgY3VycmVudFJlc291cmNlcyA9IHJlc291cmNlcztcbiAgICAgICAgICAgICAgICBpZiAodmFsdWVzLmxlbmd0aCA+IDEpIHtcbiAgICAgICAgICAgICAgICAgICAgY3VycmVudFJlc291cmNlcyA9IGNsb25lUmVzb3VyY2VzKHJlc291cmNlcyk7XG4gICAgICAgICAgICAgICAgICAgIGV4cGFuZGVkUmVzb3VyY2VzLnB1c2guYXBwbHkoZXhwYW5kZWRSZXNvdXJjZXMsIGN1cnJlbnRSZXNvdXJjZXMpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBmb3IgKGxldCBjdXJyZW50SWR4ID0gMDsgY3VycmVudElkeCA8IGN1cnJlbnRSZXNvdXJjZXMubGVuZ3RoOyBjdXJyZW50SWR4KyspIHtcbiAgICAgICAgICAgICAgICAgICAgY3VycmVudFJlc291cmNlc1tjdXJyZW50SWR4XS5sZWFmSWR4ICs9IGRhdGFJZHggKiBzcGFuc1tyZXNvdXJjZUlkeF07XG4gICAgICAgICAgICAgICAgICAgIGN1cnJlbnRSZXNvdXJjZXNbY3VycmVudElkeF0ucmVzb3VyY2VzW3Jlc291cmNlSW5kZXhdID0gaXRlbTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmICh2YWx1ZUlkeCA+IDApIHtcbiAgICAgICAgICAgICAgICBmb3IgKGxldCBpZHggPSAwOyBpZHggPCByZXNvdXJjZXMubGVuZ3RoOyBpZHgrKykge1xuICAgICAgICAgICAgICAgICAgICByZXNvdXJjZXNbaWR4XS5yZXNvdXJjZXNbcmVzb3VyY2VJbmRleF0ucHVzaChpdGVtKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGV4cGFuZGVkUmVzb3VyY2VzLmxlbmd0aCkge1xuICAgICAgICAgICAgcmVzb3VyY2VzID0gZXhwYW5kZWRSZXNvdXJjZXM7XG4gICAgICAgIH1cbiAgICB9XG4gICAgYWRkTm90R3JvdXBlZFJlc291cmNlcyhldmVudCwgcmVzb3VyY2VzLCBhbGxSZXNvdXJjZXMpO1xuICAgIHJldHVybiByZXNvdXJjZXM7XG59XG4vKiogQGhpZGRlbiAqL1xuZnVuY3Rpb24gYXNzaWduVGFza3NSZXNvdXJjZXModGFza3MsIG9wdGlvbnMpIHtcbiAgICBmb3IgKGxldCBpZHggPSAwOyBpZHggPCB0YXNrcy5sZW5ndGg7IGlkeCsrKSB7XG4gICAgICAgIGNvbnN0IHRhc2sgPSB0YXNrc1tpZHhdO1xuICAgICAgICB0YXNrLnJlc291cmNlcyA9IGV2ZW50UmVzb3VyY2VzKHRhc2suZXZlbnQsIG9wdGlvbnMpO1xuICAgIH1cbn1cbi8qKiBAaGlkZGVuICovXG5mdW5jdGlvbiBmaW5kUm93SW5kZXgoZXZlbnRzLCBkYXRhKSB7XG4gICAgaWYgKGRhdGEucm93SW5kZXggIT09IHVuZGVmaW5lZCkge1xuICAgICAgICByZXR1cm4gZGF0YS5yb3dJbmRleDtcbiAgICB9XG4gICAgZm9yIChsZXQgaWR4ID0gMDsgaWR4IDwgZXZlbnRzLmxlbmd0aDsgaWR4KyspIHtcbiAgICAgICAgaWYgKCFldmVudHNbaWR4XSkge1xuICAgICAgICAgICAgcmV0dXJuIGlkeDtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gZXZlbnRzLmxlbmd0aDtcbn1cbi8qKiBAaGlkZGVuICovXG5mdW5jdGlvbiBpc1JlY3VycmVuY2UodGFzaykge1xuICAgIHJldHVybiBCb29sZWFuKHRhc2suZXZlbnQgJiYgdGFzay5ldmVudC5yZWN1cnJlbmNlUnVsZSk7XG59XG4vKiogQGhpZGRlbiAqL1xuZnVuY3Rpb24gaXNSZWN1cnJlbmNlRXhjZXB0aW9uKHRhc2spIHtcbiAgICByZXR1cm4gdGFzay5ldmVudCAmJiBpc1ByZXNlbnQodGFzay5ldmVudC5yZWN1cnJlbmNlSWQpICYmICF0YXNrLmV2ZW50LnJlY3VycmVuY2VSdWxlO1xufVxuLyoqIEBoaWRkZW4gKi9cbmNvbnN0IHJlY3RDb250YWlucyA9IChyZWN0LCBsZWZ0LCB0b3ApID0+IHJlY3QubGVmdCA8PSBsZWZ0ICYmIGxlZnQgPD0gcmVjdC5sZWZ0ICsgcmVjdC53aWR0aCAmJiByZWN0LnRvcCA8PSB0b3AgJiYgdG9wIDw9IHJlY3QudG9wICsgcmVjdC5oZWlnaHQ7XG4vKiogQGhpZGRlbiAqL1xuY29uc3QgcmVjdENvbnRhaW5zWCA9IChyZWN0LCBsZWZ0KSA9PiByZWN0LmxlZnQgPD0gbGVmdCAmJiBsZWZ0IDw9IHJlY3QubGVmdCArIHJlY3Qud2lkdGg7XG4vKiogQGhpZGRlbiAqL1xuY29uc3QgdG9QeCA9IHZhbHVlID0+IGAke3ZhbHVlfXB4YDtcbi8qKiBAaGlkZGVuICovXG5jb25zdCBlbGVtZW50T2Zmc2V0ID0gKGVsZW1lbnQpID0+IHtcbiAgICBpZiAoIWVsZW1lbnQpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICAgIGNvbnN0IGJveCA9IGVsZW1lbnQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG4gICAgY29uc3QgZG9jdW1lbnRFbGVtZW50ID0gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50O1xuICAgIHJldHVybiB7XG4gICAgICAgIHRvcDogYm94LnRvcCArICh3aW5kb3cucGFnZVlPZmZzZXQgfHwgZG9jdW1lbnRFbGVtZW50LnNjcm9sbFRvcCkgLSAoZG9jdW1lbnRFbGVtZW50LmNsaWVudFRvcCB8fCAwKSxcbiAgICAgICAgbGVmdDogYm94LmxlZnQgKyAod2luZG93LnBhZ2VYT2Zmc2V0IHx8IGRvY3VtZW50RWxlbWVudC5zY3JvbGxMZWZ0KSAtIChkb2N1bWVudEVsZW1lbnQuY2xpZW50TGVmdCB8fCAwKSxcbiAgICAgICAgd2lkdGg6IGJveC53aWR0aCxcbiAgICAgICAgaGVpZ2h0OiBib3guaGVpZ2h0XG4gICAgfTtcbn07XG4vKiogQGhpZGRlbiAqL1xuY29uc3QgcG9pbnREaXN0YW5jZSA9ICh4MSwgeTEsIHgyLCB5MikgPT4gTWF0aC5zcXJ0KE1hdGgucG93KHgxIC0geDIsIDIpICsgTWF0aC5wb3coeTEgLSB5MiwgMikpO1xuLyoqIEBoaWRkZW4gKi9cbmNvbnN0IGlnbm9yZUNvbnRlbnRDaGlsZCA9IGNoaWxkID0+IGNoaWxkLm5vZGVOYW1lID09PSAnS0VORE8tUkVTSVpFLVNFTlNPUicgfHwgaGFzQ2xhc3NlcyhjaGlsZCwgJ2stbG9hZGluZy1tYXNrJyk7XG4vKiogQGhpZGRlbiAqL1xuY29uc3Qgc2V0Q29vcmRpbmF0ZXMgPSAoZWxlbWVudCwgY29vcmRpbmF0ZXMpID0+IHtcbiAgICBmb3IgKGxldCBmaWVsZCBpbiBjb29yZGluYXRlcykge1xuICAgICAgICBpZiAoY29vcmRpbmF0ZXMuaGFzT3duUHJvcGVydHkoZmllbGQpKSB7XG4gICAgICAgICAgICBlbGVtZW50LnN0eWxlW2ZpZWxkXSA9IHRvUHgoY29vcmRpbmF0ZXNbZmllbGRdKTtcbiAgICAgICAgfVxuICAgIH1cbn07XG4vKiogQGhpZGRlbiAqL1xuY29uc3QgY29udmVydE5nQ2xhc3NCaW5kaW5ncyA9IChiaW5kaW5nVmFsdWVzKSA9PiB7XG4gICAgY29uc3QgcmVzdWx0ID0gW107XG4gICAgaWYgKGlzU3RyaW5nKGJpbmRpbmdWYWx1ZXMpKSB7XG4gICAgICAgIHJlc3VsdC5wdXNoKGJpbmRpbmdWYWx1ZXMpO1xuICAgIH1cbiAgICBlbHNlIGlmIChpc0FycmF5KGJpbmRpbmdWYWx1ZXMpKSB7XG4gICAgICAgIHJlc3VsdC5wdXNoLmFwcGx5KHJlc3VsdCwgYmluZGluZ1ZhbHVlcyk7XG4gICAgfVxuICAgIGVsc2UgaWYgKGlzT2JqZWN0KGJpbmRpbmdWYWx1ZXMpKSB7XG4gICAgICAgIGZvciAobGV0IGZpZWxkIGluIGJpbmRpbmdWYWx1ZXMpIHtcbiAgICAgICAgICAgIGlmIChiaW5kaW5nVmFsdWVzLmhhc093blByb3BlcnR5KGZpZWxkKSAmJiBiaW5kaW5nVmFsdWVzW2ZpZWxkXSkge1xuICAgICAgICAgICAgICAgIHJlc3VsdC5wdXNoKGZpZWxkKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gcmVzdWx0O1xufTtcbi8qKlxuICogQGhpZGRlblxuICovXG5mdW5jdGlvbiBmb3JtYXRFdmVudFRpbWUoc3RhcnQsIGVuZCwgaXNBbGxEYXksIGxvY2FsZUlkKSB7XG4gICAgY29uc3Qgc3RhcnRUaW1lRm9ybWF0ID0geyBza2VsZXRvbjogJ3lNTU1NRUVFRWRobScgfTtcbiAgICBjb25zdCBzdGFydERhdGVGb3JtYXQgPSB7IHNrZWxldG9uOiAneU1NTU1FRUVFZCcgfTtcbiAgICBjb25zdCBlbmRGb3JtYXQgPSBpc0VxdWFsRGF0ZShzdGFydCwgZW5kKSA/ICd0JyA6IHN0YXJ0VGltZUZvcm1hdDtcbiAgICByZXR1cm4gaXNBbGxEYXkgP1xuICAgICAgICBgJHtmb3JtYXREYXRlKHN0YXJ0LCBzdGFydERhdGVGb3JtYXQsIGxvY2FsZUlkKX1gIDpcbiAgICAgICAgYCR7Zm9ybWF0RGF0ZShzdGFydCwgc3RhcnRUaW1lRm9ybWF0LCBsb2NhbGVJZCl94oCTJHtmb3JtYXREYXRlKGVuZCwgZW5kRm9ybWF0LCBsb2NhbGVJZCl9YDtcbn1cbi8qKlxuICogQGhpZGRlblxuICovXG5mdW5jdGlvbiBmb3JtVmFsdWVPckRlZmF1bHQoZ3JvdXAsIGZpZWxkLCBkZWZhdWx0VmFsdWUpIHtcbiAgICBjb25zdCBjb250cm9sID0gZ3JvdXAuZ2V0KGZpZWxkKTtcbiAgICBpZiAoIWNvbnRyb2wpIHtcbiAgICAgICAgcmV0dXJuIGRlZmF1bHRWYWx1ZTtcbiAgICB9XG4gICAgcmV0dXJuIGNvbnRyb2wudmFsdWUgfHwgZGVmYXVsdFZhbHVlO1xufVxuLyoqXG4gKiBAaGlkZGVuXG4gKi9cbmNvbnN0IGlzV29ya1dlZWtEYXkgPSAoZGF5LCBzdGFydCwgZW5kKSA9PiB7XG4gICAgaWYgKGVuZCA8IHN0YXJ0KSB7XG4gICAgICAgIHJldHVybiBkYXkgPD0gZW5kIHx8IHN0YXJ0IDw9IGRheTtcbiAgICB9XG4gICAgcmV0dXJuIHN0YXJ0IDw9IGRheSAmJiBkYXkgPD0gZW5kO1xufTtcblxuLy8gVE9ET1xuLy8gRXh0cmFjdCBhcyBwdWJsaWMgbWV0aG9kXG5jb25zdCBvY2N1cnJlbmNlcyA9IChpdGVtLCBmaWVsZHMsIHJhbmdlLCB0aW1lem9uZSwgd2Vla1N0YXJ0KSA9PiB7XG4gICAgY29uc3QgcnJ1bGUgPSBwYXJzZVJ1bGUoe1xuICAgICAgICByZWN1cnJlbmNlUnVsZTogZ2V0RmllbGQoaXRlbSwgZmllbGRzLnJlY3VycmVuY2VSdWxlKSxcbiAgICAgICAgd2Vla1N0YXJ0OiB3ZWVrU3RhcnRcbiAgICB9KTtcbiAgICBpZiAoIXJydWxlLnN0YXJ0KSB7XG4gICAgICAgIGNvbnN0IHN0YXJ0ID0gZ2V0RmllbGQoaXRlbSwgZmllbGRzLnN0YXJ0KTtcbiAgICAgICAgcnJ1bGUuc3RhcnQgPSBab25lZERhdGUuZnJvbUxvY2FsRGF0ZShzdGFydCwgdGltZXpvbmUpO1xuICAgIH1cbiAgICBpZiAoIXJydWxlLmVuZCkge1xuICAgICAgICBjb25zdCBlbmQgPSBnZXRGaWVsZChpdGVtLCBmaWVsZHMuZW5kKTtcbiAgICAgICAgcnJ1bGUuZW5kID0gWm9uZWREYXRlLmZyb21Mb2NhbERhdGUoZW5kLCB0aW1lem9uZSk7XG4gICAgfVxuICAgIGNvbnN0IGV4Y2VwdGlvbnMgPSBnZXRGaWVsZChpdGVtLCBmaWVsZHMucmVjdXJyZW5jZUV4Y2VwdGlvbnMpO1xuICAgIGlmIChleGNlcHRpb25zKSB7XG4gICAgICAgIHJydWxlLmV4Y2VwdGlvbkRhdGVzID0gZXhjZXB0aW9uc1xuICAgICAgICAgICAgLm1hcChleERhdGUgPT4gWm9uZWREYXRlLmZyb21Mb2NhbERhdGUoZXhEYXRlLCB0aW1lem9uZSkpO1xuICAgICAgICAvLyBUT0RPOiBNZXJnZSBleGNlcHRpb25zIGZyb20gcmVjdXJyZW5jZSBydWxlIHdpdGggZXZlbnQucmVjdXJyZW5jZUV4Y2VwdGlvblxuICAgIH1cbiAgICBjb25zdCB1dGNSYW5nZVN0YXJ0ID0gdG9VVENEYXRlVGltZShyYW5nZS5zdGFydCk7XG4gICAgY29uc3QgdXRjUmFuZ2VFbmQgPSB0b1VUQ0RhdGVUaW1lKHJhbmdlLmVuZCk7XG4gICAgY29uc3Qgc2VyaWVzID0gZXhwYW5kKHJydWxlLCB7XG4gICAgICAgIHJhbmdlU3RhcnQ6IFpvbmVkRGF0ZS5mcm9tVVRDRGF0ZSh1dGNSYW5nZVN0YXJ0LCB0aW1lem9uZSksXG4gICAgICAgIHJhbmdlRW5kOiBab25lZERhdGUuZnJvbVVUQ0RhdGUodXRjUmFuZ2VFbmQsIHRpbWV6b25lKVxuICAgIH0pO1xuICAgIGlmICghc2VyaWVzLmV2ZW50cy5sZW5ndGgpIHtcbiAgICAgICAgcmV0dXJuIFtdO1xuICAgIH1cbiAgICBjb25zdCBleHBhbmRlZCA9IHNlcmllcy5ldmVudHMubWFwKG9jYyA9PiB7XG4gICAgICAgIGNvbnN0IGV2ZW50ID0gY2xvbmUoaXRlbSk7XG4gICAgICAgIHNldEZpZWxkKGV2ZW50LCBmaWVsZHMuaWQsIE9DQ1VSUkVOQ0VfSUQpO1xuICAgICAgICBzZXRGaWVsZChldmVudCwgZmllbGRzLnJlY3VycmVuY2VJZCwgZ2V0RmllbGQoaXRlbSwgZmllbGRzLmlkKSk7XG4gICAgICAgIHNldEZpZWxkKGV2ZW50LCBmaWVsZHMuc3RhcnQsIG9jYy5zdGFydC50b0xvY2FsRGF0ZSgpKTtcbiAgICAgICAgc2V0RmllbGQoZXZlbnQsIGZpZWxkcy5lbmQsIG9jYy5lbmQudG9Mb2NhbERhdGUoKSk7XG4gICAgICAgIHJldHVybiBldmVudDtcbiAgICB9KTtcbiAgICByZXR1cm4gW2l0ZW0sIC4uLmV4cGFuZGVkXTtcbn07XG4vKipcbiAqIEEgZGlyZWN0aXZlIHRoYXQgcHJvY2Vzc2VzIFNjaGVkdWxlciBldmVudHMgaW4tbWVtb3J5LlxuICpcbiAqIFByb2Nlc3NpbmcgaW5jbHVkZXMgdGhlIGV4cGFuZGluZyBvZiByZWN1cnJpbmcgZXZlbnRzIGFuZCB0aGUgZmlsdGVyaW5nIG9mIGRhdGEgZm9yXG4gKiB0aGUgY3VycmVudGx5IGFjdGl2ZSBwZXJpb2QuXG4gKlxuICogeyUgbWV0YSBoZWlnaHQ6NjUwICV9XG4gKiB7JSBlbWJlZF9maWxlIGJhc2ljLXVzYWdlL2FwcC5jb21wb25lbnQudHMgcHJldmlldyAlfVxuICogeyUgZW1iZWRfZmlsZSBzaGFyZWQvYXBwLm1vZHVsZS50cyAlfVxuICogeyUgZW1iZWRfZmlsZSBzaGFyZWQvbWFpbi50cyAlfVxuICogeyUgZW1iZWRfZmlsZSBzaGFyZWQvZXZlbnRzLXV0Yy50cyAlfVxuICogeyUgZW5kbWV0YSAlfVxuICovXG5jbGFzcyBEYXRhQmluZGluZ0RpcmVjdGl2ZSB7XG4gICAgY29uc3RydWN0b3Ioc2NoZWR1bGVyLCBjaGFuZ2VEZXRlY3RvciwgaW50bCwgbG9jYWxEYXRhQ2hhbmdlc1NlcnZpY2UpIHtcbiAgICAgICAgdGhpcy5zY2hlZHVsZXIgPSBzY2hlZHVsZXI7XG4gICAgICAgIHRoaXMuY2hhbmdlRGV0ZWN0b3IgPSBjaGFuZ2VEZXRlY3RvcjtcbiAgICAgICAgdGhpcy5pbnRsID0gaW50bDtcbiAgICAgICAgdGhpcy5sb2NhbERhdGFDaGFuZ2VzU2VydmljZSA9IGxvY2FsRGF0YUNoYW5nZXNTZXJ2aWNlO1xuICAgICAgICB0aGlzLm9yaWdpbmFsRGF0YSA9IFtdO1xuICAgICAgICBpZiAobG9jYWxEYXRhQ2hhbmdlc1NlcnZpY2UpIHtcbiAgICAgICAgICAgIHRoaXMuZGF0YUNoYW5nZWRTdWJzY3JpcHRpb24gPSB0aGlzLmxvY2FsRGF0YUNoYW5nZXNTZXJ2aWNlLmNoYW5nZXMuc3Vic2NyaWJlKHRoaXMucmViaW5kLmJpbmQodGhpcykpO1xuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFRoZSBhcnJheSBvZiBkYXRhIHdoaWNoIHdpbGwgcG9wdWxhdGUgdGhlIFNjaGVkdWxlci5cbiAgICAgKi9cbiAgICBzZXQgZGF0YSh2YWx1ZSkge1xuICAgICAgICB0aGlzLm9yaWdpbmFsRGF0YSA9IHZhbHVlIHx8IFtdO1xuICAgICAgICBpZiAodGhpcy5sb2NhbERhdGFDaGFuZ2VzU2VydmljZSkge1xuICAgICAgICAgICAgdGhpcy5sb2NhbERhdGFDaGFuZ2VzU2VydmljZS5kYXRhID0gdmFsdWU7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5zY2hlZHVsZXIuZXZlbnRzID0gdGhpcy5wcm9jZXNzKCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEBoaWRkZW5cbiAgICAgKi9cbiAgICBuZ09uSW5pdCgpIHtcbiAgICAgICAgdGhpcy5zdWJzY3JpcHRpb24gPSB0aGlzLnNjaGVkdWxlclxuICAgICAgICAgICAgLmRhdGVDaGFuZ2VcbiAgICAgICAgICAgIC5zdWJzY3JpYmUoZSA9PiB0aGlzLm9uRGF0ZUNoYW5nZShlKSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEBoaWRkZW5cbiAgICAgKi9cbiAgICBuZ09uRGVzdHJveSgpIHtcbiAgICAgICAgaWYgKHRoaXMuc3Vic2NyaXB0aW9uKSB7XG4gICAgICAgICAgICB0aGlzLnN1YnNjcmlwdGlvbi51bnN1YnNjcmliZSgpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLmRhdGFDaGFuZ2VkU3Vic2NyaXB0aW9uKSB7XG4gICAgICAgICAgICB0aGlzLmRhdGFDaGFuZ2VkU3Vic2NyaXB0aW9uLnVuc3Vic2NyaWJlKCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogQGhpZGRlblxuICAgICAqL1xuICAgIHJlYmluZCgpIHtcbiAgICAgICAgdGhpcy5kYXRhID0gdGhpcy5vcmlnaW5hbERhdGE7XG4gICAgICAgIHRoaXMuY2hhbmdlRGV0ZWN0b3IubWFya0ZvckNoZWNrKCk7XG4gICAgfVxuICAgIHByb2Nlc3MoKSB7XG4gICAgICAgIGlmICghdGhpcy5kYXRlUmFuZ2UpIHtcbiAgICAgICAgICAgIC8vIE5vIHByb2Nlc3NpbmcgdW50aWwgYSBkYXRlIHJhbmdlIGlzIHNldFxuICAgICAgICAgICAgcmV0dXJuIFtdO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGRhdGEgPSBbXTtcbiAgICAgICAgY29uc3QgZmllbGRzID0gdGhpcy5zY2hlZHVsZXIubW9kZWxGaWVsZHM7XG4gICAgICAgIHRoaXMub3JpZ2luYWxEYXRhXG4gICAgICAgICAgICAuZm9yRWFjaChpdGVtID0+IHtcbiAgICAgICAgICAgIGlmIChnZXRGaWVsZChpdGVtLCBmaWVsZHMucmVjdXJyZW5jZVJ1bGUpKSB7XG4gICAgICAgICAgICAgICAgY29uc3Qgc2VyaWVzID0gb2NjdXJyZW5jZXMoaXRlbSwgZmllbGRzLCB0aGlzLmRhdGVSYW5nZSwgdGhpcy5zY2hlZHVsZXIudGltZXpvbmUsIHRoaXMuaW50bC5maXJzdERheSgpKTtcbiAgICAgICAgICAgICAgICBkYXRhLnB1c2goLi4uc2VyaWVzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGRhdGEucHVzaChpdGVtKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBkYXRhO1xuICAgIH1cbiAgICBvbkRhdGVDaGFuZ2UoZSkge1xuICAgICAgICB0aGlzLmRhdGVSYW5nZSA9IGUuZGF0ZVJhbmdlO1xuICAgICAgICB0aGlzLnJlYmluZCgpO1xuICAgIH1cbn1cbkRhdGFCaW5kaW5nRGlyZWN0aXZlLmRlY29yYXRvcnMgPSBbXG4gICAgeyB0eXBlOiBEaXJlY3RpdmUsIGFyZ3M6IFt7XG4gICAgICAgICAgICAgICAgc2VsZWN0b3I6ICdba2VuZG9TY2hlZHVsZXJCaW5kaW5nXSdcbiAgICAgICAgICAgIH0sXSB9LFxuXTtcbi8qKiBAbm9jb2xsYXBzZSAqL1xuRGF0YUJpbmRpbmdEaXJlY3RpdmUuY3RvclBhcmFtZXRlcnMgPSAoKSA9PiBbXG4gICAgeyB0eXBlOiBTY2hlZHVsZXJDb21wb25lbnQgfSxcbiAgICB7IHR5cGU6IENoYW5nZURldGVjdG9yUmVmIH0sXG4gICAgeyB0eXBlOiBJbnRsU2VydmljZSB9LFxuICAgIHsgdHlwZTogTG9jYWxEYXRhQ2hhbmdlc1NlcnZpY2UgfVxuXTtcbkRhdGFCaW5kaW5nRGlyZWN0aXZlLnByb3BEZWNvcmF0b3JzID0ge1xuICAgIGRhdGE6IFt7IHR5cGU6IElucHV0LCBhcmdzOiBbJ2tlbmRvU2NoZWR1bGVyQmluZGluZycsXSB9XVxufTtcblxuLyoqXG4gKiBAaGlkZGVuXG4gKi9cbmNsYXNzIE1lc3NhZ2VzIGV4dGVuZHMgQ29tcG9uZW50TWVzc2FnZXMge1xufVxuTWVzc2FnZXMucHJvcERlY29yYXRvcnMgPSB7XG4gICAgYWxsRXZlbnRzOiBbeyB0eXBlOiBJbnB1dCB9XSxcbiAgICBhbGxEYXk6IFt7IHR5cGU6IElucHV0IH1dLFxuICAgIGRhdGVIZWFkZXI6IFt7IHR5cGU6IElucHV0IH1dLFxuICAgIHRpbWVIZWFkZXI6IFt7IHR5cGU6IElucHV0IH1dLFxuICAgIGV2ZW50SGVhZGVyOiBbeyB0eXBlOiBJbnB1dCB9XSxcbiAgICBkZWxldGVUaXRsZTogW3sgdHlwZTogSW5wdXQgfV0sXG4gICAgbmV4dFRpdGxlOiBbeyB0eXBlOiBJbnB1dCB9XSxcbiAgICBwcmV2aW91c1RpdGxlOiBbeyB0eXBlOiBJbnB1dCB9XSxcbiAgICB0b2RheTogW3sgdHlwZTogSW5wdXQgfV0sXG4gICAgY2FsZW5kYXJUb2RheTogW3sgdHlwZTogSW5wdXQgfV0sXG4gICAgc2hvd0Z1bGxEYXk6IFt7IHR5cGU6IElucHV0IH1dLFxuICAgIHNob3dXb3JrRGF5OiBbeyB0eXBlOiBJbnB1dCB9XSxcbiAgICBkYXlWaWV3VGl0bGU6IFt7IHR5cGU6IElucHV0IH1dLFxuICAgIG11bHRpRGF5Vmlld1RpdGxlOiBbeyB0eXBlOiBJbnB1dCB9XSxcbiAgICB3ZWVrVmlld1RpdGxlOiBbeyB0eXBlOiBJbnB1dCB9XSxcbiAgICB3b3JrV2Vla1ZpZXdUaXRsZTogW3sgdHlwZTogSW5wdXQgfV0sXG4gICAgbW9udGhWaWV3VGl0bGU6IFt7IHR5cGU6IElucHV0IH1dLFxuICAgIHRpbWVsaW5lVmlld1RpdGxlOiBbeyB0eXBlOiBJbnB1dCB9XSxcbiAgICB0aW1lbGluZVdlZWtWaWV3VGl0bGU6IFt7IHR5cGU6IElucHV0IH1dLFxuICAgIHRpbWVsaW5lTW9udGhWaWV3VGl0bGU6IFt7IHR5cGU6IElucHV0IH1dLFxuICAgIGFnZW5kYVZpZXdUaXRsZTogW3sgdHlwZTogSW5wdXQgfV0sXG4gICAgY2FuY2VsOiBbeyB0eXBlOiBJbnB1dCB9XSxcbiAgICBzYXZlOiBbeyB0eXBlOiBJbnB1dCB9XSxcbiAgICBlZGl0b3JFdmVudFRpdGxlOiBbeyB0eXBlOiBJbnB1dCB9XSxcbiAgICBlZGl0b3JFdmVudFN0YXJ0OiBbeyB0eXBlOiBJbnB1dCB9XSxcbiAgICBlZGl0b3JFdmVudFN0YXJ0VGltZVpvbmU6IFt7IHR5cGU6IElucHV0IH1dLFxuICAgIGVkaXRvckV2ZW50RW5kOiBbeyB0eXBlOiBJbnB1dCB9XSxcbiAgICBlZGl0b3JFdmVudEVuZFRpbWVab25lOiBbeyB0eXBlOiBJbnB1dCB9XSxcbiAgICBlZGl0b3JFdmVudEFsbERheTogW3sgdHlwZTogSW5wdXQgfV0sXG4gICAgZWRpdG9yRXZlbnREZXNjcmlwdGlvbjogW3sgdHlwZTogSW5wdXQgfV0sXG4gICAgZWRpdG9yRXZlbnRTZXBhcmF0ZVRpbWVab25lczogW3sgdHlwZTogSW5wdXQgfV0sXG4gICAgZWRpdG9yRXZlbnRUaW1lWm9uZTogW3sgdHlwZTogSW5wdXQgfV0sXG4gICAgcmVjdXJyZW5jZUVkaXRvclJlcGVhdDogW3sgdHlwZTogSW5wdXQgfV0sXG4gICAgcmVjdXJyZW5jZUVkaXRvckRhaWx5SW50ZXJ2YWw6IFt7IHR5cGU6IElucHV0IH1dLFxuICAgIHJlY3VycmVuY2VFZGl0b3JEYWlseVJlcGVhdEV2ZXJ5OiBbeyB0eXBlOiBJbnB1dCB9XSxcbiAgICByZWN1cnJlbmNlRWRpdG9yV2Vla2x5SW50ZXJ2YWw6IFt7IHR5cGU6IElucHV0IH1dLFxuICAgIHJlY3VycmVuY2VFZGl0b3JXZWVrbHlSZXBlYXRFdmVyeTogW3sgdHlwZTogSW5wdXQgfV0sXG4gICAgcmVjdXJyZW5jZUVkaXRvcldlZWtseVJlcGVhdE9uOiBbeyB0eXBlOiBJbnB1dCB9XSxcbiAgICByZWN1cnJlbmNlRWRpdG9yTW9udGhseURheTogW3sgdHlwZTogSW5wdXQgfV0sXG4gICAgcmVjdXJyZW5jZUVkaXRvck1vbnRobHlJbnRlcnZhbDogW3sgdHlwZTogSW5wdXQgfV0sXG4gICAgcmVjdXJyZW5jZUVkaXRvck1vbnRobHlSZXBlYXRFdmVyeTogW3sgdHlwZTogSW5wdXQgfV0sXG4gICAgcmVjdXJyZW5jZUVkaXRvck1vbnRobHlSZXBlYXRPbjogW3sgdHlwZTogSW5wdXQgfV0sXG4gICAgcmVjdXJyZW5jZUVkaXRvclllYXJseU9mOiBbeyB0eXBlOiBJbnB1dCB9XSxcbiAgICByZWN1cnJlbmNlRWRpdG9yWWVhcmx5UmVwZWF0RXZlcnk6IFt7IHR5cGU6IElucHV0IH1dLFxuICAgIHJlY3VycmVuY2VFZGl0b3JZZWFybHlSZXBlYXRPbjogW3sgdHlwZTogSW5wdXQgfV0sXG4gICAgcmVjdXJyZW5jZUVkaXRvclllYXJseUludGVydmFsOiBbeyB0eXBlOiBJbnB1dCB9XSxcbiAgICByZWN1cnJlbmNlRWRpdG9yRnJlcXVlbmNpZXNEYWlseTogW3sgdHlwZTogSW5wdXQgfV0sXG4gICAgcmVjdXJyZW5jZUVkaXRvckZyZXF1ZW5jaWVzTW9udGhseTogW3sgdHlwZTogSW5wdXQgfV0sXG4gICAgcmVjdXJyZW5jZUVkaXRvckZyZXF1ZW5jaWVzTmV2ZXI6IFt7IHR5cGU6IElucHV0IH1dLFxuICAgIHJlY3VycmVuY2VFZGl0b3JGcmVxdWVuY2llc1dlZWtseTogW3sgdHlwZTogSW5wdXQgfV0sXG4gICAgcmVjdXJyZW5jZUVkaXRvckZyZXF1ZW5jaWVzWWVhcmx5OiBbeyB0eXBlOiBJbnB1dCB9XSxcbiAgICByZWN1cnJlbmNlRWRpdG9yT2Zmc2V0UG9zaXRpb25zRmlyc3Q6IFt7IHR5cGU6IElucHV0IH1dLFxuICAgIHJlY3VycmVuY2VFZGl0b3JPZmZzZXRQb3NpdGlvbnNTZWNvbmQ6IFt7IHR5cGU6IElucHV0IH1dLFxuICAgIHJlY3VycmVuY2VFZGl0b3JPZmZzZXRQb3NpdGlvbnNUaGlyZDogW3sgdHlwZTogSW5wdXQgfV0sXG4gICAgcmVjdXJyZW5jZUVkaXRvck9mZnNldFBvc2l0aW9uc0ZvdXJ0aDogW3sgdHlwZTogSW5wdXQgfV0sXG4gICAgcmVjdXJyZW5jZUVkaXRvck9mZnNldFBvc2l0aW9uc0xhc3Q6IFt7IHR5cGU6IElucHV0IH1dLFxuICAgIHJlY3VycmVuY2VFZGl0b3JXZWVrZGF5c0RheTogW3sgdHlwZTogSW5wdXQgfV0sXG4gICAgcmVjdXJyZW5jZUVkaXRvcldlZWtkYXlzV2Vla2RheTogW3sgdHlwZTogSW5wdXQgfV0sXG4gICAgcmVjdXJyZW5jZUVkaXRvcldlZWtkYXlzV2Vla2VuZGRheTogW3sgdHlwZTogSW5wdXQgfV0sXG4gICAgcmVjdXJyZW5jZUVkaXRvckVuZEFmdGVyOiBbeyB0eXBlOiBJbnB1dCB9XSxcbiAgICByZWN1cnJlbmNlRWRpdG9yRW5kT2NjdXJyZW5jZTogW3sgdHlwZTogSW5wdXQgfV0sXG4gICAgcmVjdXJyZW5jZUVkaXRvckVuZExhYmVsOiBbeyB0eXBlOiBJbnB1dCB9XSxcbiAgICByZWN1cnJlbmNlRWRpdG9yRW5kTmV2ZXI6IFt7IHR5cGU6IElucHV0IH1dLFxuICAgIHJlY3VycmVuY2VFZGl0b3JFbmRPbjogW3sgdHlwZTogSW5wdXQgfV0sXG4gICAgZWRpdG9yVGl0bGU6IFt7IHR5cGU6IElucHV0IH1dLFxuICAgIGRlc3Ryb3k6IFt7IHR5cGU6IElucHV0IH1dLFxuICAgIGRlbGV0ZUNvbmZpcm1hdGlvbjogW3sgdHlwZTogSW5wdXQgfV0sXG4gICAgZWRpdFJlY3VycmluZ0NvbmZpcm1hdGlvbjogW3sgdHlwZTogSW5wdXQgfV0sXG4gICAgZWRpdE9jY3VycmVuY2U6IFt7IHR5cGU6IElucHV0IH1dLFxuICAgIGVkaXRTZXJpZXM6IFt7IHR5cGU6IElucHV0IH1dLFxuICAgIGRlbGV0ZVJlY3VycmluZ0NvbmZpcm1hdGlvbjogW3sgdHlwZTogSW5wdXQgfV0sXG4gICAgZGVsZXRlT2NjdXJyZW5jZTogW3sgdHlwZTogSW5wdXQgfV0sXG4gICAgZGVsZXRlU2VyaWVzOiBbeyB0eXBlOiBJbnB1dCB9XSxcbiAgICBkZWxldGVEaWFsb2dUaXRsZTogW3sgdHlwZTogSW5wdXQgfV0sXG4gICAgZGVsZXRlUmVjdXJyaW5nRGlhbG9nVGl0bGU6IFt7IHR5cGU6IElucHV0IH1dLFxuICAgIGVkaXRSZWN1cnJpbmdEaWFsb2dUaXRsZTogW3sgdHlwZTogSW5wdXQgfV1cbn07XG5cbi8qKlxuICogQ3VzdG9tIGNvbXBvbmVudCBtZXNzYWdlcyBvdmVycmlkZSBkZWZhdWx0IGNvbXBvbmVudCBtZXNzYWdlcy5cbiAqL1xuY2xhc3MgU2NoZWR1bGVyQ3VzdG9tTWVzc2FnZXNDb21wb25lbnQgZXh0ZW5kcyBNZXNzYWdlcyB7XG4gICAgY29uc3RydWN0b3Ioc2VydmljZSkge1xuICAgICAgICBzdXBlcigpO1xuICAgICAgICB0aGlzLnNlcnZpY2UgPSBzZXJ2aWNlO1xuICAgIH1cbiAgICBnZXQgb3ZlcnJpZGUoKSB7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbn1cblNjaGVkdWxlckN1c3RvbU1lc3NhZ2VzQ29tcG9uZW50LmRlY29yYXRvcnMgPSBbXG4gICAgeyB0eXBlOiBDb21wb25lbnQsIGFyZ3M6IFt7XG4gICAgICAgICAgICAgICAgcHJvdmlkZXJzOiBbXG4gICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHByb3ZpZGU6IE1lc3NhZ2VzLFxuICAgICAgICAgICAgICAgICAgICAgICAgdXNlRXhpc3Rpbmc6IGZvcndhcmRSZWYoKCkgPT4gU2NoZWR1bGVyQ3VzdG9tTWVzc2FnZXNDb21wb25lbnQpIC8vIHRzbGludDpkaXNhYmxlLWxpbmU6bm8tZm9yd2FyZC1yZWZcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIF0sXG4gICAgICAgICAgICAgICAgc2VsZWN0b3I6ICdrZW5kby1zY2hlZHVsZXItbWVzc2FnZXMnLFxuICAgICAgICAgICAgICAgIHRlbXBsYXRlOiBgYFxuICAgICAgICAgICAgfSxdIH0sXG5dO1xuLyoqIEBub2NvbGxhcHNlICovXG5TY2hlZHVsZXJDdXN0b21NZXNzYWdlc0NvbXBvbmVudC5jdG9yUGFyYW1ldGVycyA9ICgpID0+IFtcbiAgICB7IHR5cGU6IExvY2FsaXphdGlvblNlcnZpY2UgfVxuXTtcblxuLyoqXG4gKiBAaGlkZGVuXG4gKi9cbmNsYXNzIExvY2FsaXplZE1lc3NhZ2VzRGlyZWN0aXZlIGV4dGVuZHMgTWVzc2FnZXMge1xuICAgIGNvbnN0cnVjdG9yKHNlcnZpY2UpIHtcbiAgICAgICAgc3VwZXIoKTtcbiAgICAgICAgdGhpcy5zZXJ2aWNlID0gc2VydmljZTtcbiAgICB9XG59XG5Mb2NhbGl6ZWRNZXNzYWdlc0RpcmVjdGl2ZS5kZWNvcmF0b3JzID0gW1xuICAgIHsgdHlwZTogRGlyZWN0aXZlLCBhcmdzOiBbe1xuICAgICAgICAgICAgICAgIHByb3ZpZGVyczogW1xuICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICBwcm92aWRlOiBNZXNzYWdlcyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHVzZUV4aXN0aW5nOiBmb3J3YXJkUmVmKCgpID0+IExvY2FsaXplZE1lc3NhZ2VzRGlyZWN0aXZlKSAvLyB0c2xpbnQ6ZGlzYWJsZS1saW5lOm5vLWZvcndhcmQtcmVmXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBdLFxuICAgICAgICAgICAgICAgIHNlbGVjdG9yOiAnW2tlbmRvU2NoZWR1bGVyTG9jYWxpemVkTWVzc2FnZXNdJ1xuICAgICAgICAgICAgfSxdIH0sXG5dO1xuLyoqIEBub2NvbGxhcHNlICovXG5Mb2NhbGl6ZWRNZXNzYWdlc0RpcmVjdGl2ZS5jdG9yUGFyYW1ldGVycyA9ICgpID0+IFtcbiAgICB7IHR5cGU6IExvY2FsaXphdGlvblNlcnZpY2UgfVxuXTtcblxuLyoqXG4gKiBBIHRvb2xiYXIgY29tcG9uZW50IHdoaWNoIGNvbnRhaW5zIHRoZSBjb250cm9scyBmb3IgZGF0ZSBuYXZpZ2F0aW9uXG4gKiAoW3NlZSBleGFtcGxlXSh7JSBzbHVnIHRvb2xiYXJfc2NoZWR1bGVyICV9I3RvYy1pbmNsdWRpbmctdGhlLWJ1aWx0LWluLWNvbXBvbmVudHMpKS5cbiAqXG4gKiBUbyByZW5kZXIgdGhlICoqUHJldmlvdXMqKiwgKipUb2RheSoqLCAqKk5leHQqKiwgYW5kICoqRGF0ZSBwaWNrZXIqKlxuICogYnV0dG9ucywgaW5jbHVkZSB0aGUgY29tcG9uZW50IGluIHRoZVxuICogW3Rvb2xiYXIgdGVtcGxhdGVdKHslIHNsdWcgYXBpX3NjaGVkdWxlcl90b29sYmFydGVtcGxhdGVkaXJlY3RpdmUgJX0pLlxuICpcbiAqIHslIG1ldGEgaGVpZ2h0OjcwMCAlfVxuICogeyUgZW1iZWRfZmlsZSB0b29sYmFyL3RlbXBsYXRlL2FwcC5jb21wb25lbnQudHMgcHJldmlldyAlfVxuICogeyUgZW1iZWRfZmlsZSB0b29sYmFyL3RlbXBsYXRlL215LW5hdmlnYXRpb24uY29tcG9uZW50LnRzICV9XG4gKiB7JSBlbWJlZF9maWxlIHRvb2xiYXIvdGVtcGxhdGUvYXBwLm1vZHVsZS50cyAlfVxuICogeyUgZW1iZWRfZmlsZSBzaGFyZWQvZXZlbnRzLXV0Yy50cyAlfVxuICogeyUgZW1iZWRfZmlsZSBzaGFyZWQvbWFpbi50cyAlfVxuICogeyUgZW5kbWV0YSAlfVxuICovXG5jbGFzcyBUb29sYmFyTmF2aWdhdGlvbkNvbXBvbmVudCB7XG4gICAgY29uc3RydWN0b3IocG9wdXBTZXJ2aWNlLCB0b29sYmFyU2VydmljZSwgbG9jYWxpemF0aW9uLCBjZCkge1xuICAgICAgICB0aGlzLnBvcHVwU2VydmljZSA9IHBvcHVwU2VydmljZTtcbiAgICAgICAgdGhpcy50b29sYmFyU2VydmljZSA9IHRvb2xiYXJTZXJ2aWNlO1xuICAgICAgICB0aGlzLmxvY2FsaXphdGlvbiA9IGxvY2FsaXphdGlvbjtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEBoaWRkZW5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuaG9zdENsYXNzZXMgPSB0cnVlO1xuICAgICAgICB0aGlzLnN1YnMgPSB0aGlzLmxvY2FsaXphdGlvbi5jaGFuZ2VzLnN1YnNjcmliZSgoeyBydGwgfSkgPT4ge1xuICAgICAgICAgICAgY2QubWFya0ZvckNoZWNrKCk7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBzZXQgY2FsZW5kYXIoY2FsZW5kYXIpIHtcbiAgICAgICAgaWYgKGNhbGVuZGFyKSB7XG4gICAgICAgICAgICBjYWxlbmRhci5mb2N1cygpO1xuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEBoaWRkZW5cbiAgICAgKi9cbiAgICBnZXQgdG9kYXlUZXh0KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5sb2NhbGl6YXRpb24uZ2V0KCd0b2RheScpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBAaGlkZGVuXG4gICAgICovXG4gICAgZ2V0IGNhbGVuZGFyVG9kYXlUZXh0KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5sb2NhbGl6YXRpb24uZ2V0KCdjYWxlbmRhclRvZGF5Jyk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEBoaWRkZW5cbiAgICAgKi9cbiAgICBnZXQgbmV4dFRleHQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmxvY2FsaXphdGlvbi5nZXQoJ25leHRUaXRsZScpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBAaGlkZGVuXG4gICAgICovXG4gICAgZ2V0IHByZXZpb3VzVGV4dCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubG9jYWxpemF0aW9uLmdldCgncHJldmlvdXNUaXRsZScpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBAaGlkZGVuXG4gICAgICovXG4gICAgZ2V0IGN0eCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMudG9vbGJhclNlcnZpY2UuY29udGV4dDtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQGhpZGRlblxuICAgICAqL1xuICAgIG9uQmx1cigpIHtcbiAgICAgICAgdGhpcy5jbG9zZVBvcHVwKCk7XG4gICAgfVxuICAgIG5nT25EZXN0cm95KCkge1xuICAgICAgICB0aGlzLnN1YnMudW5zdWJzY3JpYmUoKTtcbiAgICAgICAgdGhpcy5jbG9zZVBvcHVwKCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEBoaWRkZW5cbiAgICAgKi9cbiAgICB0b2dnbGVTZWxlY3RlZERhdGUoYW5jaG9yLCB0ZW1wbGF0ZSkge1xuICAgICAgICBpZiAodGhpcy5wb3B1cFJlZikge1xuICAgICAgICAgICAgdGhpcy5jbG9zZVBvcHVwKCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBjb25zdCBwb3B1cFNldHRpbmdzID0ge1xuICAgICAgICAgICAgICAgIGFuY2hvcjogYW5jaG9yLFxuICAgICAgICAgICAgICAgIGNvbnRlbnQ6IHRlbXBsYXRlXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgaWYgKHRoaXMubG9jYWxpemF0aW9uLnJ0bCkge1xuICAgICAgICAgICAgICAgIHBvcHVwU2V0dGluZ3MucG9wdXBDbGFzcyA9ICdrLXJ0bCc7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLnBvcHVwUmVmID0gdGhpcy5wb3B1cFNlcnZpY2Uub3Blbihwb3B1cFNldHRpbmdzKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEBoaWRkZW5cbiAgICAgKi9cbiAgICBzZWxlY3REYXRlKHZhbHVlKSB7XG4gICAgICAgIHRoaXMuY2xvc2VQb3B1cCgpO1xuICAgICAgICB0aGlzLnRvb2xiYXJTZXJ2aWNlLm5hdmlnYXRlKHtcbiAgICAgICAgICAgIHR5cGU6ICdzZWxlY3QtZGF0ZScsXG4gICAgICAgICAgICBkYXRlOiB2YWx1ZVxuICAgICAgICB9KTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQGhpZGRlblxuICAgICAqL1xuICAgIHByZXZDbGljaygpIHtcbiAgICAgICAgdGhpcy50b29sYmFyU2VydmljZS5uYXZpZ2F0ZSh7XG4gICAgICAgICAgICB0eXBlOiAncHJldidcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQGhpZGRlblxuICAgICAqL1xuICAgIG5leHRDbGljaygpIHtcbiAgICAgICAgdGhpcy50b29sYmFyU2VydmljZS5uYXZpZ2F0ZSh7XG4gICAgICAgICAgICB0eXBlOiAnbmV4dCdcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQGhpZGRlblxuICAgICAqL1xuICAgIHRvZGF5Q2xpY2soKSB7XG4gICAgICAgIHRoaXMudG9vbGJhclNlcnZpY2UubmF2aWdhdGUoe1xuICAgICAgICAgICAgdHlwZTogJ3RvZGF5J1xuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICBjbG9zZVBvcHVwKCkge1xuICAgICAgICBpZiAodGhpcy5wb3B1cFJlZikge1xuICAgICAgICAgICAgdGhpcy5wb3B1cFJlZi5jbG9zZSgpO1xuICAgICAgICAgICAgdGhpcy5wb3B1cFJlZiA9IG51bGw7XG4gICAgICAgIH1cbiAgICB9XG59XG5Ub29sYmFyTmF2aWdhdGlvbkNvbXBvbmVudC5kZWNvcmF0b3JzID0gW1xuICAgIHsgdHlwZTogQ29tcG9uZW50LCBhcmdzOiBbe1xuICAgICAgICAgICAgICAgIC8vIHRzbGludDpkaXNhYmxlLW5leHQtbGluZTpjb21wb25lbnQtc2VsZWN0b3JcbiAgICAgICAgICAgICAgICBzZWxlY3RvcjogJ1trZW5kb1NjaGVkdWxlclRvb2xiYXJOYXZpZ2F0aW9uXScsXG4gICAgICAgICAgICAgICAgY2hhbmdlRGV0ZWN0aW9uOiBDaGFuZ2VEZXRlY3Rpb25TdHJhdGVneS5PblB1c2gsXG4gICAgICAgICAgICAgICAgcHJvdmlkZXJzOiBbXG4gICAgICAgICAgICAgICAgICAgIFBvcHVwU2VydmljZVxuICAgICAgICAgICAgICAgIF0sXG4gICAgICAgICAgICAgICAgdGVtcGxhdGU6IGBcbiAgICAgICAgPGxpIGNsYXNzPVwiay1zdGF0ZS1kZWZhdWx0IGstaGVhZGVyIGstbmF2LXRvZGF5XCI+XG4gICAgICAgICAgICA8YSByb2xlPVwiYnV0dG9uXCJcbiAgICAgICAgICAgICAgICAoY2xpY2spPVwidG9kYXlDbGljaygpXCJcbiAgICAgICAgICAgICAgICBocmVmPVwiI1wiXG4gICAgICAgICAgICAgICAgY2xhc3M9XCJrLWxpbmtcIlxuICAgICAgICAgICAgICAgIHRhYmluZGV4PVwiLTFcIlxuICAgICAgICAgICAgICAgIFthdHRyLnRpdGxlXT1cInRvZGF5VGV4dFwiPnt7dG9kYXlUZXh0fX08L2E+XG4gICAgICAgIDwvbGk+XG4gICAgICAgIDxsaSBjbGFzcz1cImstc3RhdGUtZGVmYXVsdCBrLWhlYWRlciBrLW5hdi1wcmV2XCI+XG4gICAgICAgICAgICA8YSByb2xlPVwiYnV0dG9uXCJcbiAgICAgICAgICAgICAgICAoY2xpY2spPVwicHJldkNsaWNrKClcIlxuICAgICAgICAgICAgICAgIGhyZWY9XCIjXCJcbiAgICAgICAgICAgICAgICBjbGFzcz1cImstbGlua1wiXG4gICAgICAgICAgICAgICAgdGFiaW5kZXg9XCItMVwiXG4gICAgICAgICAgICAgICAgW2F0dHIudGl0bGVdPVwicHJldmlvdXNUZXh0XCJcbiAgICAgICAgICAgICAgICBbYXR0ci5hcmlhLWxhYmVsXT1cInByZXZpb3VzVGV4dFwiPlxuICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzPVwiay1pY29uIGstaS1hcnJvdy02MC1sZWZ0XCIgc3R5bGU9XCJwb2ludGVyLWV2ZW50czogbm9uZVwiPjwvc3Bhbj5cbiAgICAgICAgICAgIDwvYT5cbiAgICAgICAgPC9saT5cbiAgICAgICAgPGxpIGNsYXNzPVwiay1zdGF0ZS1kZWZhdWx0IGstaGVhZGVyIGstbmF2LW5leHRcIj5cbiAgICAgICAgICAgIDxhIHJvbGU9XCJidXR0b25cIlxuICAgICAgICAgICAgICAgIChjbGljayk9XCJuZXh0Q2xpY2soKVwiXG4gICAgICAgICAgICAgICAgaHJlZj1cIiNcIlxuICAgICAgICAgICAgICAgIGNsYXNzPVwiay1saW5rXCJcbiAgICAgICAgICAgICAgICB0YWJpbmRleD1cIi0xXCJcbiAgICAgICAgICAgICAgICBbYXR0ci50aXRsZV09XCJuZXh0VGV4dFwiXG4gICAgICAgICAgICAgICAgW2F0dHIuYXJpYS1sYWJlbF09XCJuZXh0VGV4dFwiPlxuICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzPVwiay1pY29uIGstaS1hcnJvdy02MC1yaWdodFwiIHN0eWxlPVwicG9pbnRlci1ldmVudHM6IG5vbmVcIj48L3NwYW4+XG4gICAgICAgICAgICA8L2E+XG4gICAgICAgIDwvbGk+XG4gICAgICAgIDxsaSBjbGFzcz1cImstc3RhdGUtZGVmYXVsdCBrLW5hdi1jdXJyZW50XCI+XG4gICAgICAgICAgICA8YSByb2xlPVwiYnV0dG9uXCIgI2FuY2hvciBocmVmPVwiI1wiIGNsYXNzPVwiay1saW5rXCIgdGFiaW5kZXg9XCItMVwiIChjbGljayk9XCJ0b2dnbGVTZWxlY3RlZERhdGUoYW5jaG9yLCB0ZW1wbGF0ZSlcIj5cbiAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz1cImstaWNvbiBrLWktY2FsZW5kYXJcIj48L3NwYW4+XG4gICAgICAgICAgICAgICAgPHNwYW4gY2xhc3M9XCJrLXNtLWRhdGUtZm9ybWF0XCI+e3sgKGN0eC5kYXRlUmFuZ2UgfCBhc3luYyk/LnNob3J0VGV4dCB9fTwvc3Bhbj5cbiAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz1cImstbGctZGF0ZS1mb3JtYXRcIj57eyAoY3R4LmRhdGVSYW5nZSB8IGFzeW5jKT8udGV4dCB9fTwvc3Bhbj5cbiAgICAgICAgICAgIDwvYT5cbiAgICAgICAgPC9saT5cblxuICAgICAgICA8bmctdGVtcGxhdGUgI3RlbXBsYXRlPlxuICAgICAgICAgICAgPGtlbmRvLWNhbGVuZGFyICNjYWxlbmRhciAoYmx1cik9XCJvbkJsdXIoKVwiICh2YWx1ZUNoYW5nZSk9XCJzZWxlY3REYXRlKCRldmVudClcIiBbdmFsdWVdPVwiY3R4LnNlbGVjdGVkRGF0ZSB8IGFzeW5jXCIgW21pbl09XCJtaW5cIiBbbWF4XT1cIm1heFwiPlxuICAgICAgICAgICAgICAgIDxrZW5kby1jYWxlbmRhci1tZXNzYWdlcyBbdG9kYXldPVwiY2FsZW5kYXJUb2RheVRleHRcIj5cbiAgICAgICAgICAgICAgICA8L2tlbmRvLWNhbGVuZGFyLW1lc3NhZ2VzPlxuICAgICAgICAgICAgPC9rZW5kby1jYWxlbmRhcj5cbiAgICAgICAgPC9uZy10ZW1wbGF0ZT5cbiAgICBgXG4gICAgICAgICAgICB9LF0gfSxcbl07XG4vKiogQG5vY29sbGFwc2UgKi9cblRvb2xiYXJOYXZpZ2F0aW9uQ29tcG9uZW50LmN0b3JQYXJhbWV0ZXJzID0gKCkgPT4gW1xuICAgIHsgdHlwZTogUG9wdXBTZXJ2aWNlIH0sXG4gICAgeyB0eXBlOiBUb29sYmFyU2VydmljZSB9LFxuICAgIHsgdHlwZTogTG9jYWxpemF0aW9uU2VydmljZSB9LFxuICAgIHsgdHlwZTogQ2hhbmdlRGV0ZWN0b3JSZWYgfVxuXTtcblRvb2xiYXJOYXZpZ2F0aW9uQ29tcG9uZW50LnByb3BEZWNvcmF0b3JzID0ge1xuICAgIGNhbGVuZGFyOiBbeyB0eXBlOiBWaWV3Q2hpbGQsIGFyZ3M6IFsnY2FsZW5kYXInLF0gfV0sXG4gICAgaG9zdENsYXNzZXM6IFt7IHR5cGU6IEhvc3RCaW5kaW5nLCBhcmdzOiBbJ2NsYXNzLmstc2NoZWR1bGVyLW5hdmlnYXRpb24nLF0gfSwgeyB0eXBlOiBIb3N0QmluZGluZywgYXJnczogWydjbGFzcy5rLXJlc2V0JyxdIH1dLFxuICAgIG1pbjogW3sgdHlwZTogSW5wdXQgfV0sXG4gICAgbWF4OiBbeyB0eXBlOiBJbnB1dCB9XVxufTtcblxuLyoqXG4gKiBAaGlkZGVuXG4gKi9cbmNsYXNzIFRvb2xiYXJDb21wb25lbnQge1xuICAgIGNvbnN0cnVjdG9yKHNlcnZpY2UpIHtcbiAgICAgICAgdGhpcy5zZXJ2aWNlID0gc2VydmljZTtcbiAgICAgICAgdGhpcy5ob3N0Q2xhc3NlcyA9IHRydWU7XG4gICAgICAgIHRoaXMubmF2aWdhdGUgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XG4gICAgICAgIC8vIFRoZSB0ZW1wbGF0ZSBjb250ZXh0IGlzIHRoZSBzYW1lIGFzIHRoZSBzZXJ2aWNlIGNvbnRleHQsXG4gICAgICAgIC8vIGJ1dCB3aXRoIHJlc29sdmVkIHZhbHVlcyBpbnN0ZWFkIG9mIG9ic2VydmFibGVzLlxuICAgICAgICB0aGlzLnRlbXBsYXRlQ29udGV4dCA9IHt9O1xuICAgICAgICB0aGlzLnN1YnMgPSBuZXcgU3Vic2NyaXB0aW9uKCk7XG4gICAgICAgIHRoaXMuc3Vicy5hZGQoc2VydmljZS5hY3Rpb24uc3Vic2NyaWJlKGFjdGlvbiA9PiB0aGlzLm5hdmlnYXRlLm5leHQoYWN0aW9uKSkpO1xuICAgIH1cbiAgICBuZ09uSW5pdCgpIHtcbiAgICAgICAgdGhpcy5zdWJzLmFkZCh0aGlzLnNlbGVjdGVkRGF0ZS5zdWJzY3JpYmUoZGF0ZSA9PiB0aGlzLnRlbXBsYXRlQ29udGV4dC5zZWxlY3RlZERhdGUgPSBkYXRlKSk7XG4gICAgICAgIHRoaXMuc3Vicy5hZGQodGhpcy5kYXRlUmFuZ2Uuc3Vic2NyaWJlKGRhdGVSYW5nZSA9PiB0aGlzLnRlbXBsYXRlQ29udGV4dC5kYXRlUmFuZ2UgPSBkYXRlUmFuZ2UpKTtcbiAgICB9XG4gICAgbmdPbkNoYW5nZXMoKSB7XG4gICAgICAgIHRoaXMuc2VydmljZS5jb250ZXh0ID0ge1xuICAgICAgICAgICAgZGF0ZVJhbmdlOiB0aGlzLmRhdGVSYW5nZSxcbiAgICAgICAgICAgIHNlbGVjdGVkRGF0ZTogdGhpcy5zZWxlY3RlZERhdGUsXG4gICAgICAgICAgICB2aWV3czogdGhpcy52aWV3cyxcbiAgICAgICAgICAgIHNlbGVjdGVkVmlldzogdGhpcy5zZWxlY3RlZFZpZXdcbiAgICAgICAgfTtcbiAgICAgICAgT2JqZWN0LmFzc2lnbih0aGlzLnRlbXBsYXRlQ29udGV4dCwge1xuICAgICAgICAgICAgdmlld3M6IHRoaXMudmlld3MsXG4gICAgICAgICAgICBzZWxlY3RlZFZpZXc6IHRoaXMuc2VsZWN0ZWRWaWV3XG4gICAgICAgICAgICAvLyBUaGUgZGF0ZVJhbmdlIGFuZCBzZWxlY3RlZERhdGUgY29udGV4dCBmaWVsZHNcbiAgICAgICAgICAgIC8vIGFyZSB1cGRhdGVkIHRocm91Z2ggdGhlIHN1YnNjcmlwdGlvbnMgYWRkZWQgaW4gbmdPbkluaXQuXG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBuZ09uRGVzdHJveSgpIHtcbiAgICAgICAgdGhpcy5zdWJzLnVuc3Vic2NyaWJlKCk7XG4gICAgfVxufVxuVG9vbGJhckNvbXBvbmVudC5kZWNvcmF0b3JzID0gW1xuICAgIHsgdHlwZTogQ29tcG9uZW50LCBhcmdzOiBbe1xuICAgICAgICAgICAgICAgIHNlbGVjdG9yOiAna2VuZG8tc2NoZWR1bGVyLXRvb2xiYXInLFxuICAgICAgICAgICAgICAgIHRlbXBsYXRlOiBgXG4gICAgICAgIDxuZy10ZW1wbGF0ZVxuICAgICAgICAgICAgKm5nSWY9XCJ0ZW1wbGF0ZTsgZWxzZSBkZWZhdWx0VGVtcGxhdGVcIlxuICAgICAgICAgICAgW25nVGVtcGxhdGVPdXRsZXRdPVwidGVtcGxhdGUudGVtcGxhdGVSZWZcIlxuICAgICAgICAgICAgW25nVGVtcGxhdGVPdXRsZXRDb250ZXh0XT1cInRlbXBsYXRlQ29udGV4dFwiXG4gICAgICAgID5cbiAgICAgICAgPC9uZy10ZW1wbGF0ZT5cblxuICAgICAgICA8bmctdGVtcGxhdGUgI2RlZmF1bHRUZW1wbGF0ZT5cbiAgICAgICAgICAgIDx1bCBrZW5kb1NjaGVkdWxlclRvb2xiYXJOYXZpZ2F0aW9uIFttaW5dPVwibWluXCIgW21heF09XCJtYXhcIj48L3VsPlxuICAgICAgICAgICAgPHVsIGtlbmRvU2NoZWR1bGVyVG9vbGJhclZpZXdTZWxlY3Rvcj48L3VsPlxuICAgICAgICA8L25nLXRlbXBsYXRlPlxuICAgIGBcbiAgICAgICAgICAgIH0sXSB9LFxuXTtcbi8qKiBAbm9jb2xsYXBzZSAqL1xuVG9vbGJhckNvbXBvbmVudC5jdG9yUGFyYW1ldGVycyA9ICgpID0+IFtcbiAgICB7IHR5cGU6IFRvb2xiYXJTZXJ2aWNlIH1cbl07XG5Ub29sYmFyQ29tcG9uZW50LnByb3BEZWNvcmF0b3JzID0ge1xuICAgIGhvc3RDbGFzc2VzOiBbeyB0eXBlOiBIb3N0QmluZGluZywgYXJnczogWydjbGFzcy5rLXNjaGVkdWxlci10b29sYmFyJyxdIH0sIHsgdHlwZTogSG9zdEJpbmRpbmcsIGFyZ3M6IFsnY2xhc3Muay1oZWFkZXInLF0gfSwgeyB0eXBlOiBIb3N0QmluZGluZywgYXJnczogWydjbGFzcy5rLWZsb2F0d3JhcCcsXSB9XSxcbiAgICBzZWxlY3RlZFZpZXc6IFt7IHR5cGU6IElucHV0IH1dLFxuICAgIHZpZXdzOiBbeyB0eXBlOiBJbnB1dCB9XSxcbiAgICBkYXRlUmFuZ2U6IFt7IHR5cGU6IElucHV0IH1dLFxuICAgIHNlbGVjdGVkRGF0ZTogW3sgdHlwZTogSW5wdXQgfV0sXG4gICAgdGVtcGxhdGU6IFt7IHR5cGU6IElucHV0IH1dLFxuICAgIG5hdmlnYXRlOiBbeyB0eXBlOiBPdXRwdXQgfV0sXG4gICAgbWluOiBbeyB0eXBlOiBJbnB1dCB9XSxcbiAgICBtYXg6IFt7IHR5cGU6IElucHV0IH1dXG59O1xuXG4vKipcbiAqIEEgdG9vbGJhciBjb21wb25lbnQgd2hpY2ggY29udGFpbnMgdGhlIGNvbnRyb2xzIGZvciBzd2l0Y2hpbmcgdGhlIHZpZXdzXG4gKiAoW3NlZSBleGFtcGxlXSh7JSBzbHVnIHRvb2xiYXJfc2NoZWR1bGVyICV9I3RvYy1pbmNsdWRpbmctdGhlLWJ1aWx0LWluLWNvbXBvbmVudHMpKS5cbiAqXG4gKiBUbyByZW5kZXIgdGhlIHZpZXctc2VsZWN0aW9uIGJ1dHRvbnMsIGluY2x1ZGUgdGhlIGNvbXBvbmVudCBpbiB0aGVcbiAqIFt0b29sYmFyIHRlbXBsYXRlXSh7JSBzbHVnIGFwaV9zY2hlZHVsZXJfdG9vbGJhcnRlbXBsYXRlZGlyZWN0aXZlICV9KS5cbiAqXG4gKiB7JSBtZXRhIGhlaWdodDo3MDAgJX1cbiAqIHslIGVtYmVkX2ZpbGUgdG9vbGJhci90ZW1wbGF0ZS9hcHAuY29tcG9uZW50LnRzIHByZXZpZXcgJX1cbiAqIHslIGVtYmVkX2ZpbGUgdG9vbGJhci90ZW1wbGF0ZS9teS1uYXZpZ2F0aW9uLmNvbXBvbmVudC50cyAlfVxuICogeyUgZW1iZWRfZmlsZSB0b29sYmFyL3RlbXBsYXRlL2FwcC5tb2R1bGUudHMgJX1cbiAqIHslIGVtYmVkX2ZpbGUgc2hhcmVkL2V2ZW50cy11dGMudHMgJX1cbiAqIHslIGVtYmVkX2ZpbGUgc2hhcmVkL21haW4udHMgJX1cbiAqIHslIGVuZG1ldGEgJX1cbiAqL1xuY2xhc3MgVG9vbGJhclZpZXdTZWxlY3RvckNvbXBvbmVudCB7XG4gICAgY29uc3RydWN0b3Ioc2VydmljZSwgZWxlbWVudCwgcmVuZGVyZXIsIGRvbUV2ZW50cywgbmdab25lKSB7XG4gICAgICAgIHRoaXMuc2VydmljZSA9IHNlcnZpY2U7XG4gICAgICAgIHRoaXMuZWxlbWVudCA9IGVsZW1lbnQ7XG4gICAgICAgIHRoaXMucmVuZGVyZXIgPSByZW5kZXJlcjtcbiAgICAgICAgdGhpcy5kb21FdmVudHMgPSBkb21FdmVudHM7XG4gICAgICAgIHRoaXMubmdab25lID0gbmdab25lO1xuICAgICAgICAvKipcbiAgICAgICAgICogQGhpZGRlblxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5ob3N0Q2xhc3NlcyA9IHRydWU7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEBoaWRkZW5cbiAgICAgKi9cbiAgICBnZXQgZXhwYW5kZWQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9leHBhbmRlZDtcbiAgICB9XG4gICAgc2V0IGV4cGFuZGVkKHZhbHVlKSB7XG4gICAgICAgIHRoaXMuX2V4cGFuZGVkID0gdmFsdWU7XG4gICAgICAgIGNvbnN0IGV4cGFuZGVkQ2xhc3MgPSAnay1zdGF0ZS1leHBhbmRlZCc7XG4gICAgICAgIGNvbnN0IGVsZW1lbnQgPSB0aGlzLmVsZW1lbnQubmF0aXZlRWxlbWVudDtcbiAgICAgICAgaWYgKHZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLnJlbmRlcmVyLmFkZENsYXNzKGVsZW1lbnQsIGV4cGFuZGVkQ2xhc3MpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5yZW5kZXJlci5yZW1vdmVDbGFzcyhlbGVtZW50LCBleHBhbmRlZENsYXNzKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBAaGlkZGVuXG4gICAgICovXG4gICAgZ2V0IGN0eCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuc2VydmljZS5jb250ZXh0O1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBAaGlkZGVuXG4gICAgICovXG4gICAgZ2V0IGl0ZW1EaXNwbGF5KCkge1xuICAgICAgICBpZiAodGhpcy5jdHgudmlld3MgJiYgdGhpcy5jdHgudmlld3MubGVuZ3RoID09PSAxKSB7XG4gICAgICAgICAgICByZXR1cm4gJ2xpc3QtaXRlbSc7XG4gICAgICAgIH1cbiAgICB9XG4gICAgbmdBZnRlclZpZXdJbml0KCkge1xuICAgICAgICB0aGlzLmF0dGFjaEVsZW1lbnRFdmVudEhhbmRsZXJzKCk7XG4gICAgfVxuICAgIG5nT25EZXN0cm95KCkge1xuICAgICAgICBpZiAodGhpcy5kZXRhY2hEb21FdmVudHMpIHtcbiAgICAgICAgICAgIHRoaXMuZGV0YWNoRG9tRXZlbnRzKCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogQGhpZGRlblxuICAgICAqL1xuICAgIG9uQ2xpY2sodmlldykge1xuICAgICAgICBpZiAodGhpcy5jdHguc2VsZWN0ZWRWaWV3ICE9PSB2aWV3KSB7XG4gICAgICAgICAgICB0aGlzLnNlcnZpY2UubmF2aWdhdGUoe1xuICAgICAgICAgICAgICAgIHR5cGU6ICd2aWV3LWNoYW5nZScsXG4gICAgICAgICAgICAgICAgdmlldzogdmlld1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5leHBhbmRlZCA9IGZhbHNlO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBAaGlkZGVuXG4gICAgICovXG4gICAgb25DdXJyZW50Vmlld0NsaWNrKCkge1xuICAgICAgICB0aGlzLmV4cGFuZGVkID0gIXRoaXMuZXhwYW5kZWQ7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEBoaWRkZW5cbiAgICAgKi9cbiAgICBpc1NlbGVjdGVkKHZpZXcpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuY3R4LnNlbGVjdGVkVmlldyA9PT0gdmlldztcbiAgICB9XG4gICAgYXR0YWNoRWxlbWVudEV2ZW50SGFuZGxlcnMoKSB7XG4gICAgICAgIGNvbnN0IGVsZW1lbnQgPSB0aGlzLmVsZW1lbnQubmF0aXZlRWxlbWVudDtcbiAgICAgICAgdGhpcy5uZ1pvbmUucnVuT3V0c2lkZUFuZ3VsYXIoKCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgZm9jdXNPdXRMaXN0ZW5lciA9IHRoaXMucmVuZGVyZXIubGlzdGVuKGVsZW1lbnQsICdmb2N1c291dCcsIChhcmdzKSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgbmV4dCA9IGFyZ3MucmVsYXRlZFRhcmdldCB8fCBkb2N1bWVudC5hY3RpdmVFbGVtZW50O1xuICAgICAgICAgICAgICAgIGNvbnN0IG91dHNpZGUgPSAhY2xvc2VzdChuZXh0LCAobm9kZSkgPT4gbm9kZSA9PT0gZWxlbWVudCk7XG4gICAgICAgICAgICAgICAgaWYgKG91dHNpZGUpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5leHBhbmRlZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgY29uc3Qgd2luZG93Qmx1clN1YnNjcmlwdGlvbiA9IHRoaXMuZG9tRXZlbnRzLndpbmRvd0JsdXIuc3Vic2NyaWJlKCgpID0+IHRoaXMuZXhwYW5kZWQgPSBmYWxzZSk7XG4gICAgICAgICAgICB0aGlzLmRldGFjaERvbUV2ZW50cyA9ICgpID0+IHtcbiAgICAgICAgICAgICAgICBmb2N1c091dExpc3RlbmVyKCk7XG4gICAgICAgICAgICAgICAgd2luZG93Qmx1clN1YnNjcmlwdGlvbi51bnN1YnNjcmliZSgpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfSk7XG4gICAgfVxufVxuVG9vbGJhclZpZXdTZWxlY3RvckNvbXBvbmVudC5kZWNvcmF0b3JzID0gW1xuICAgIHsgdHlwZTogQ29tcG9uZW50LCBhcmdzOiBbe1xuICAgICAgICAgICAgICAgIC8vIHRzbGludDpkaXNhYmxlLW5leHQtbGluZTpjb21wb25lbnQtc2VsZWN0b3JcbiAgICAgICAgICAgICAgICBzZWxlY3RvcjogJ1trZW5kb1NjaGVkdWxlclRvb2xiYXJWaWV3U2VsZWN0b3JdJyxcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZTogYFxuICAgICAgICA8bGkgY2xhc3M9XCJrLWN1cnJlbnQtdmlld1wiICpuZ0lmPVwiY3R4LnZpZXdzPy5sZW5ndGggPiAxXCI+XG4gICAgICAgICAgICA8c3BhbiByb2xlPVwiYnV0dG9uXCIgY2xhc3M9XCJrLWxpbmtcIiB0YWJpbmRleD1cIi0xXCIgW2tlbmRvRXZlbnRzT3V0c2lkZUFuZ3VsYXJdPVwieyBjbGljazogb25DdXJyZW50Vmlld0NsaWNrIH1cIiBbc2NvcGVdPVwidGhpc1wiPlxuICAgICAgICAgICAgICAgIHt7IGN0eC5zZWxlY3RlZFZpZXc/LnRpdGxlIH19XG4gICAgICAgICAgICA8L3NwYW4+XG4gICAgICAgIDwvbGk+XG4gICAgICAgIDxsaSAqbmdGb3I9XCJsZXQgdmlldyBvZiBjdHgudmlld3NcIlxuICAgICAgICAgICAgW2NsYXNzLmstc3RhdGUtc2VsZWN0ZWRdPVwiaXNTZWxlY3RlZCh2aWV3KVwiIFtuZ1N0eWxlXT1cInsgZGlzcGxheTogaXRlbURpc3BsYXkgfVwiXG4gICAgICAgICA+XG4gICAgICAgICAgICA8c3BhbiByb2xlPVwiYnV0dG9uXCIgY2xhc3M9XCJrLWxpbmtcIiB0YWJpbmRleD1cIi0xXCIgKGNsaWNrKT1cIm9uQ2xpY2sodmlldylcIj5cbiAgICAgICAgICAgICAgICB7eyB2aWV3LnRpdGxlIH19XG4gICAgICAgICAgICA8L3NwYW4+XG4gICAgICAgIDwvbGk+XG4gICAgYFxuICAgICAgICAgICAgfSxdIH0sXG5dO1xuLyoqIEBub2NvbGxhcHNlICovXG5Ub29sYmFyVmlld1NlbGVjdG9yQ29tcG9uZW50LmN0b3JQYXJhbWV0ZXJzID0gKCkgPT4gW1xuICAgIHsgdHlwZTogVG9vbGJhclNlcnZpY2UgfSxcbiAgICB7IHR5cGU6IEVsZW1lbnRSZWYgfSxcbiAgICB7IHR5cGU6IFJlbmRlcmVyMiB9LFxuICAgIHsgdHlwZTogRG9tRXZlbnRzU2VydmljZSB9LFxuICAgIHsgdHlwZTogTmdab25lIH1cbl07XG5Ub29sYmFyVmlld1NlbGVjdG9yQ29tcG9uZW50LnByb3BEZWNvcmF0b3JzID0ge1xuICAgIGhvc3RDbGFzc2VzOiBbeyB0eXBlOiBIb3N0QmluZGluZywgYXJnczogWydjbGFzcy5rLXNjaGVkdWxlci12aWV3cycsXSB9LCB7IHR5cGU6IEhvc3RCaW5kaW5nLCBhcmdzOiBbJ2NsYXNzLmstcmVzZXQnLF0gfV1cbn07XG5cbi8qKlxuICogQGhpZGRlblxuICovXG5jb25zdCBwdWJsaWNEaXJlY3RpdmVzID0gW1xuICAgIFRvb2xiYXJOYXZpZ2F0aW9uQ29tcG9uZW50LFxuICAgIFRvb2xiYXJUZW1wbGF0ZURpcmVjdGl2ZSxcbiAgICBUb29sYmFyVmlld1NlbGVjdG9yQ29tcG9uZW50XG5dO1xuLyoqXG4gKiBAaGlkZGVuXG4gKi9cbmNsYXNzIFRvb2xiYXJNb2R1bGUge1xufVxuVG9vbGJhck1vZHVsZS5kZWNvcmF0b3JzID0gW1xuICAgIHsgdHlwZTogTmdNb2R1bGUsIGFyZ3M6IFt7XG4gICAgICAgICAgICAgICAgaW1wb3J0czogW1xuICAgICAgICAgICAgICAgICAgICBDb21tb25Nb2R1bGUsXG4gICAgICAgICAgICAgICAgICAgIENhbGVuZGFyTW9kdWxlLFxuICAgICAgICAgICAgICAgICAgICBQb3B1cE1vZHVsZSxcbiAgICAgICAgICAgICAgICAgICAgRXZlbnRzTW9kdWxlXG4gICAgICAgICAgICAgICAgXSxcbiAgICAgICAgICAgICAgICBleHBvcnRzOiBbXG4gICAgICAgICAgICAgICAgICAgIFRvb2xiYXJDb21wb25lbnQsXG4gICAgICAgICAgICAgICAgICAgIC4uLnB1YmxpY0RpcmVjdGl2ZXNcbiAgICAgICAgICAgICAgICBdLFxuICAgICAgICAgICAgICAgIGRlY2xhcmF0aW9uczogW1xuICAgICAgICAgICAgICAgICAgICBUb29sYmFyQ29tcG9uZW50LFxuICAgICAgICAgICAgICAgICAgICAuLi5wdWJsaWNEaXJlY3RpdmVzXG4gICAgICAgICAgICAgICAgXVxuICAgICAgICAgICAgfSxdIH0sXG5dO1xuXG5jb25zdCBkZWZhdWx0U2xvdENsYXNzID0gKF9hcmdzKSA9PiBudWxsO1xuLyoqXG4gKiBAaGlkZGVuXG4gKi9cbmNsYXNzIENvbmZpZ3VyYXRpb25WaWV3QmFzZSBleHRlbmRzIFNjaGVkdWxlclZpZXcge1xuICAgIGNvbnN0cnVjdG9yKGxvY2FsaXphdGlvbiwgY2hhbmdlRGV0ZWN0b3IsIHZpZXdDb250ZXh0LCB2aWV3U3RhdGUpIHtcbiAgICAgICAgc3VwZXIoKTtcbiAgICAgICAgdGhpcy5sb2NhbGl6YXRpb24gPSBsb2NhbGl6YXRpb247XG4gICAgICAgIHRoaXMuY2hhbmdlRGV0ZWN0b3IgPSBjaGFuZ2VEZXRlY3RvcjtcbiAgICAgICAgdGhpcy52aWV3Q29udGV4dCA9IHZpZXdDb250ZXh0O1xuICAgICAgICB0aGlzLnZpZXdTdGF0ZSA9IHZpZXdTdGF0ZTtcbiAgICAgICAgdGhpcy5zY2hlZHVsZXJPcHRpb25zID0ge307XG4gICAgICAgIHRoaXMuc3VicyA9IHRoaXMubG9jYWxpemF0aW9uLmNoYW5nZXMuc3Vic2NyaWJlKCh7IHJ0bCB9KSA9PiB7XG4gICAgICAgICAgICBjaGFuZ2VEZXRlY3Rvci5tYXJrRm9yQ2hlY2soKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuc3Vicy5hZGQodGhpcy52aWV3Q29udGV4dC5vcHRpb25zQ2hhbmdlLnN1YnNjcmliZSh0aGlzLm9wdGlvbnNDaGFuZ2UuYmluZCh0aGlzKSkpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBAaGlkZGVuXG4gICAgICovXG4gICAgZ2V0IHZpZXdTbG90Q2xhc3MoKSB7XG4gICAgICAgIHJldHVybiBpc1ByZXNlbnQodGhpcy5zbG90Q2xhc3MpID8gdGhpcy5zbG90Q2xhc3MgOiAodGhpcy5zY2hlZHVsZXJPcHRpb25zLnNsb3RDbGFzcyB8fCBkZWZhdWx0U2xvdENsYXNzKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQGhpZGRlblxuICAgICAqL1xuICAgIGdldCB2aWV3RXZlbnRDbGFzcygpIHtcbiAgICAgICAgcmV0dXJuIGlzUHJlc2VudCh0aGlzLmV2ZW50Q2xhc3MpID8gdGhpcy5ldmVudENsYXNzIDogdGhpcy5zY2hlZHVsZXJPcHRpb25zLmV2ZW50Q2xhc3M7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEBoaWRkZW5cbiAgICAgKi9cbiAgICBnZXQgdmlld0V2ZW50U3R5bGVzKCkge1xuICAgICAgICByZXR1cm4gaXNQcmVzZW50KHRoaXMuZXZlbnRTdHlsZXMpID8gdGhpcy5ldmVudFN0eWxlcyA6IHRoaXMuc2NoZWR1bGVyT3B0aW9ucy5ldmVudFN0eWxlcztcbiAgICB9XG4gICAgbmdPbkNoYW5nZXMoX2NoYW5nZXMpIHtcbiAgICAgICAgdGhpcy52aWV3U3RhdGUubm90aWZ5T3B0aW9uc0NoYW5nZSgpO1xuICAgIH1cbiAgICBuZ09uRGVzdHJveSgpIHtcbiAgICAgICAgdGhpcy5zdWJzLnVuc3Vic2NyaWJlKCk7XG4gICAgfVxuICAgIG9wdGlvbnNDaGFuZ2Uob3B0aW9ucykge1xuICAgICAgICB0aGlzLnNjaGVkdWxlck9wdGlvbnMgPSBvcHRpb25zO1xuICAgIH1cbn1cbkNvbmZpZ3VyYXRpb25WaWV3QmFzZS5wcm9wRGVjb3JhdG9ycyA9IHtcbiAgICBzbG90Q2xhc3M6IFt7IHR5cGU6IElucHV0IH1dLFxuICAgIGV2ZW50Q2xhc3M6IFt7IHR5cGU6IElucHV0IH1dLFxuICAgIGV2ZW50U3R5bGVzOiBbeyB0eXBlOiBJbnB1dCB9XSxcbiAgICB0ZW1wbGF0ZTogW3sgdHlwZTogVmlld0NoaWxkLCBhcmdzOiBbJ2NvbnRlbnQnLCB7IHN0YXRpYzogdHJ1ZSB9LF0gfV0sXG4gICAgZXZlbnRUZW1wbGF0ZTogW3sgdHlwZTogQ29udGVudENoaWxkLCBhcmdzOiBbRXZlbnRUZW1wbGF0ZURpcmVjdGl2ZSxdIH1dLFxuICAgIGdyb3VwSGVhZGVyVGVtcGxhdGU6IFt7IHR5cGU6IENvbnRlbnRDaGlsZCwgYXJnczogW0dyb3VwSGVhZGVyVGVtcGxhdGVEaXJlY3RpdmUsXSB9XVxufTtcblxuLyoqXG4gKiBUaGUgY29tcG9uZW50IGZvciByZW5kZXJpbmcgdGhlICoqQWdlbmRhKiogdmlldy5cbiAqL1xuY2xhc3MgQWdlbmRhVmlld0NvbXBvbmVudCBleHRlbmRzIENvbmZpZ3VyYXRpb25WaWV3QmFzZSB7XG4gICAgY29uc3RydWN0b3IobG9jYWxpemF0aW9uLCBjaGFuZ2VEZXRlY3Rvciwgdmlld0NvbnRleHQsIHZpZXdTdGF0ZSkge1xuICAgICAgICBzdXBlcihsb2NhbGl6YXRpb24sIGNoYW5nZURldGVjdG9yLCB2aWV3Q29udGV4dCwgdmlld1N0YXRlKTtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRoZSBsb25nLWRhdGUgZm9ybWF0IGZvciBkaXNwbGF5aW5nIHRoZVxuICAgICAgICAgKiBzZWxlY3RlZCBkYXRlIGluIHRoZSBTY2hlZHVsZXIgdG9vbGJhci5cbiAgICAgICAgICogRGVmYXVsdHMgdG8gYHswOkR9IC0gezE6RH1gLFxuICAgICAgICAgKiB3aGVyZSBgMGAgaXMgdGhlIHN0YXJ0IGFuZCBgMWAgaXMgdGhlIGVuZCBkYXRlXG4gICAgICAgICAqIChbbW9yZSBpbmZvcm1hdGlvbl0oeyUgc2x1ZyBwYXJzaW5nYW5kZm9ybWF0dGluZ19pbnRsICV9I3RvYy1kYXRlLWZvcm1hdHRpbmcpKS5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuc2VsZWN0ZWREYXRlRm9ybWF0ID0gJ3swOkR9IC0gezE6RH0nO1xuICAgICAgICAvKipcbiAgICAgICAgICogVGhlIHNob3J0LWRhdGUgZm9ybWF0IGZvciBkaXNwbGF5aW5nIHRoZVxuICAgICAgICAgKiBzZWxlY3RlZCBkYXRlIGluIHRoZSBTY2hlZHVsZXIgdG9vbGJhci5cbiAgICAgICAgICogRGVmYXVsdHMgdG8gYHswOmR9IC0gezE6ZH1gLFxuICAgICAgICAgKiB3aGVyZSBgMGAgaXMgdGhlIHN0YXJ0IGFuZCBgMWAgaXMgdGhlIGVuZCBkYXRlXG4gICAgICAgICAqIChbbW9yZSBpbmZvcm1hdGlvbl0oeyUgc2x1ZyBwYXJzaW5nYW5kZm9ybWF0dGluZ19pbnRsICV9I3RvYy1kYXRlLWZvcm1hdHRpbmcpKS5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuc2VsZWN0ZWRTaG9ydERhdGVGb3JtYXQgPSAnezA6ZH0gLSB7MTpkfSc7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBTcGVjaWZpZXMgdGhlIG51bWJlciBvZiBkYXlzIHRoYXQgdGhlIHZpZXcgd2lsbCByZW5kZXIuXG4gICAgICAgICAqIERlZmF1bHRzIHRvIGA3YC5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMubnVtYmVyT2ZEYXlzID0gNztcbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRoZSBpbnZhcmlhbnQgbmFtZSBmb3IgdGhpcyB2aWV3IChgYWdlbmRhYCkuXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLm5hbWUgPSAnYWdlbmRhJztcbiAgICB9XG4gICAgLyoqXG4gICAgICogQGhpZGRlblxuICAgICAqL1xuICAgIGdldCB0aXRsZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubG9jYWxpemF0aW9uLmdldCgnYWdlbmRhVmlld1RpdGxlJyk7XG4gICAgfVxufVxuQWdlbmRhVmlld0NvbXBvbmVudC5kZWNvcmF0b3JzID0gW1xuICAgIHsgdHlwZTogQ29tcG9uZW50LCBhcmdzOiBbe1xuICAgICAgICAgICAgICAgIGNoYW5nZURldGVjdGlvbjogQ2hhbmdlRGV0ZWN0aW9uU3RyYXRlZ3kuT25QdXNoLFxuICAgICAgICAgICAgICAgIHNlbGVjdG9yOiAna2VuZG8tc2NoZWR1bGVyLWFnZW5kYS12aWV3JyxcbiAgICAgICAgICAgICAgICBwcm92aWRlcnM6IFt7XG4gICAgICAgICAgICAgICAgICAgICAgICBwcm92aWRlOiBTY2hlZHVsZXJWaWV3LFxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOm5vLWZvcndhcmQtcmVmXG4gICAgICAgICAgICAgICAgICAgICAgICB1c2VFeGlzdGluZzogZm9yd2FyZFJlZigoKSA9PiBBZ2VuZGFWaWV3Q29tcG9uZW50KVxuICAgICAgICAgICAgICAgICAgICB9XSxcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZTogYFxuICAgICAgICA8bmctdGVtcGxhdGUgI2NvbnRlbnQ+XG4gICAgICAgICAgICA8YWdlbmRhLXZpZXctaW50ZXJuYWxcbiAgICAgICAgICAgICAgICBbbnVtYmVyT2ZEYXlzXT1cIm51bWJlck9mRGF5c1wiXG4gICAgICAgICAgICAgICAgW2V2ZW50VGVtcGxhdGVdPVwiZXZlbnRUZW1wbGF0ZT8udGVtcGxhdGVSZWZcIlxuICAgICAgICAgICAgICAgIFtzbG90Q2xhc3NdPVwidmlld1Nsb3RDbGFzc1wiXG4gICAgICAgICAgICAgICAgW2V2ZW50Q2xhc3NdPVwidmlld0V2ZW50Q2xhc3NcIlxuICAgICAgICAgICAgICAgIFtldmVudFN0eWxlc109XCJ2aWV3RXZlbnRTdHlsZXNcIlxuICAgICAgICAgICAgICAgIFthZ2VuZGFUaW1lVGVtcGxhdGVdPVwiYWdlbmRhVGltZVRlbXBsYXRlPy50ZW1wbGF0ZVJlZlwiXG4gICAgICAgICAgICAgICAgW2FnZW5kYURhdGVUZW1wbGF0ZV09XCJhZ2VuZGFEYXRlVGVtcGxhdGU/LnRlbXBsYXRlUmVmXCJcbiAgICAgICAgICAgICAgICBbc2VsZWN0ZWREYXRlRm9ybWF0XT1cInNlbGVjdGVkRGF0ZUZvcm1hdFwiXG4gICAgICAgICAgICAgICAgW3NlbGVjdGVkU2hvcnREYXRlRm9ybWF0XT1cInNlbGVjdGVkU2hvcnREYXRlRm9ybWF0XCI+XG4gICAgICAgICAgICA8L2FnZW5kYS12aWV3LWludGVybmFsPlxuICAgICAgICA8L25nLXRlbXBsYXRlPlxuICAgIGBcbiAgICAgICAgICAgIH0sXSB9LFxuXTtcbi8qKiBAbm9jb2xsYXBzZSAqL1xuQWdlbmRhVmlld0NvbXBvbmVudC5jdG9yUGFyYW1ldGVycyA9ICgpID0+IFtcbiAgICB7IHR5cGU6IExvY2FsaXphdGlvblNlcnZpY2UgfSxcbiAgICB7IHR5cGU6IENoYW5nZURldGVjdG9yUmVmIH0sXG4gICAgeyB0eXBlOiBWaWV3Q29udGV4dFNlcnZpY2UgfSxcbiAgICB7IHR5cGU6IFZpZXdTdGF0ZVNlcnZpY2UgfVxuXTtcbkFnZW5kYVZpZXdDb21wb25lbnQucHJvcERlY29yYXRvcnMgPSB7XG4gICAgc2VsZWN0ZWREYXRlRm9ybWF0OiBbeyB0eXBlOiBJbnB1dCB9XSxcbiAgICBzZWxlY3RlZFNob3J0RGF0ZUZvcm1hdDogW3sgdHlwZTogSW5wdXQgfV0sXG4gICAgbnVtYmVyT2ZEYXlzOiBbeyB0eXBlOiBJbnB1dCB9XSxcbiAgICBldmVudFRlbXBsYXRlOiBbeyB0eXBlOiBDb250ZW50Q2hpbGQsIGFyZ3M6IFtFdmVudFRlbXBsYXRlRGlyZWN0aXZlLF0gfV0sXG4gICAgYWdlbmRhVGltZVRlbXBsYXRlOiBbeyB0eXBlOiBDb250ZW50Q2hpbGQsIGFyZ3M6IFtBZ2VuZGFUaW1lVGVtcGxhdGVEaXJlY3RpdmUsXSB9XSxcbiAgICBhZ2VuZGFEYXRlVGVtcGxhdGU6IFt7IHR5cGU6IENvbnRlbnRDaGlsZCwgYXJnczogW0FnZW5kYURhdGVUZW1wbGF0ZURpcmVjdGl2ZSxdIH1dXG59O1xuXG4vKipcbiAqIEBoaWRkZW5cbiAqL1xuY2xhc3MgQWdlbmRhSGVhZGVySXRlbUNvbXBvbmVudCB7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHRoaXMuY2xhc3NlcyA9IHRydWU7XG4gICAgfVxuICAgIGdldCByb3dTcGFuKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5pdGVtLnJvd1NwYW47XG4gICAgfVxuICAgIGdldCBpdGVtRGF0ZSgpIHtcbiAgICAgICAgcmV0dXJuIHRvTG9jYWxEYXRlKHRoaXMuaXRlbS5kYXRhSXRlbS52YWx1ZSk7XG4gICAgfVxufVxuQWdlbmRhSGVhZGVySXRlbUNvbXBvbmVudC5kZWNvcmF0b3JzID0gW1xuICAgIHsgdHlwZTogQ29tcG9uZW50LCBhcmdzOiBbe1xuICAgICAgICAgICAgICAgIGNoYW5nZURldGVjdGlvbjogQ2hhbmdlRGV0ZWN0aW9uU3RyYXRlZ3kuT25QdXNoLFxuICAgICAgICAgICAgICAgIC8vIHRzbGludDpkaXNhYmxlLW5leHQtbGluZTpjb21wb25lbnQtc2VsZWN0b3JcbiAgICAgICAgICAgICAgICBzZWxlY3RvcjogJ1trZW5kb1NjaGVkdWxlckFnZW5kYUhlYWRlckl0ZW1dJyxcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZTogYFxuICAgICAgICA8bmctY29udGFpbmVyICpuZ0lmPVwiIWFnZW5kYURhdGVUZW1wbGF0ZVwiPlxuICAgICAgICAgICAgPHN0cm9uZyBjbGFzcz1cImstc2NoZWR1bGVyLWFnZW5kYWRheVwiPnt7aXRlbURhdGUgfCBrZW5kb0RhdGU6ICdkZCd9fTwvc3Ryb25nPlxuICAgICAgICAgICAgPGVtIGNsYXNzPVwiay1zY2hlZHVsZXItYWdlbmRhd2Vla1wiPnt7aXRlbURhdGUgfCBrZW5kb0RhdGU6ICdFRUVFJ319PC9lbT5cbiAgICAgICAgICAgIDxzcGFuIGNsYXNzPVwiay1zY2hlZHVsZXItYWdlbmRhZGF0ZVwiPnt7aXRlbURhdGUgfCBrZW5kb0RhdGU6ICd5J319PC9zcGFuPlxuICAgICAgICA8L25nLWNvbnRhaW5lcj5cbiAgICAgICAgPG5nLWNvbnRhaW5lciAqbmdJZj1cImFnZW5kYURhdGVUZW1wbGF0ZVwiIFtuZ1RlbXBsYXRlT3V0bGV0XT1cImFnZW5kYURhdGVUZW1wbGF0ZVwiXG4gICAgICAgICAgICBbbmdUZW1wbGF0ZU91dGxldENvbnRleHRdPVwieyBkYXRlOiBpdGVtRGF0ZSB9XCI+XG4gICAgICAgIDwvbmctY29udGFpbmVyPlxuICAgIGBcbiAgICAgICAgICAgIH0sXSB9LFxuXTtcbkFnZW5kYUhlYWRlckl0ZW1Db21wb25lbnQucHJvcERlY29yYXRvcnMgPSB7XG4gICAgY2xhc3NlczogW3sgdHlwZTogSG9zdEJpbmRpbmcsIGFyZ3M6IFtcImNsYXNzLmstc2NoZWR1bGVyLWRhdGVjb2x1bW5cIixdIH1dLFxuICAgIHJvd1NwYW46IFt7IHR5cGU6IEhvc3RCaW5kaW5nLCBhcmdzOiBbXCJhdHRyLnJvd3NwYW5cIixdIH1dLFxuICAgIGl0ZW06IFt7IHR5cGU6IElucHV0LCBhcmdzOiBbXCJrZW5kb1NjaGVkdWxlckFnZW5kYUhlYWRlckl0ZW1cIixdIH1dLFxuICAgIGFnZW5kYURhdGVUZW1wbGF0ZTogW3sgdHlwZTogSW5wdXQgfV1cbn07XG5cbi8qKlxuICogQGhpZGRlblxuICovXG5jbGFzcyBBZ2VuZGFIZWFkZXJDb21wb25lbnQge1xuICAgIGNvbnN0cnVjdG9yKGxvY2FsaXphdGlvbikge1xuICAgICAgICB0aGlzLmxvY2FsaXphdGlvbiA9IGxvY2FsaXphdGlvbjtcbiAgICAgICAgdGhpcy5jbGFzc2VzID0gdHJ1ZTtcbiAgICB9XG4gICAgZ2V0IGRhdGVNZXNzYWdlKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5sb2NhbGl6YXRpb24uZ2V0KCdkYXRlSGVhZGVyJyk7XG4gICAgfVxuICAgIGdldCB0aW1lTWVzc2FnZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubG9jYWxpemF0aW9uLmdldCgndGltZUhlYWRlcicpO1xuICAgIH1cbiAgICBnZXQgZXZlbnRNZXNzYWdlKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5sb2NhbGl6YXRpb24uZ2V0KCdldmVudEhlYWRlcicpO1xuICAgIH1cbn1cbkFnZW5kYUhlYWRlckNvbXBvbmVudC5kZWNvcmF0b3JzID0gW1xuICAgIHsgdHlwZTogQ29tcG9uZW50LCBhcmdzOiBbe1xuICAgICAgICAgICAgICAgIGNoYW5nZURldGVjdGlvbjogQ2hhbmdlRGV0ZWN0aW9uU3RyYXRlZ3kuT25QdXNoLFxuICAgICAgICAgICAgICAgIC8vIHRzbGludDpkaXNhYmxlLW5leHQtbGluZTpjb21wb25lbnQtc2VsZWN0b3JcbiAgICAgICAgICAgICAgICBzZWxlY3RvcjogJ1trZW5kb1NjaGVkdWxlckFnZW5kYUhlYWRlcl0nLFxuICAgICAgICAgICAgICAgIHRlbXBsYXRlOiBgXG4gICAgICAgIDxkaXYgY2xhc3M9XCJrLXNjaGVkdWxlci1oZWFkZXItd3JhcFwiPlxuICAgICAgICAgICAgPHRhYmxlIGNsYXNzPVwiay1zY2hlZHVsZXItdGFibGVcIiByb2xlPVwicHJlc2VudGF0aW9uXCI+XG4gICAgICAgICAgICAgICAgPHRib2R5PlxuICAgICAgICAgICAgICAgICAgICA8dHI+XG4gICAgICAgICAgICAgICAgICAgICAgICA8dGggKm5nRm9yPVwibGV0IHJlc291cmNlIG9mIHJlc291cmNlc1wiIGNsYXNzPVwiay1zY2hlZHVsZXItZ3JvdXBjb2x1bW5cIj48L3RoPlxuICAgICAgICAgICAgICAgICAgICAgICAgPHRoIGNsYXNzPVwiay1zY2hlZHVsZXItZGF0ZWNvbHVtblwiPnt7IGRhdGVNZXNzYWdlIH19PC90aD5cbiAgICAgICAgICAgICAgICAgICAgICAgIDx0aCBjbGFzcz1cImstc2NoZWR1bGVyLXRpbWVjb2x1bW5cIj57eyB0aW1lTWVzc2FnZSB9fTwvdGg+XG4gICAgICAgICAgICAgICAgICAgICAgICA8dGg+e3sgZXZlbnRNZXNzYWdlIH19PC90aD5cbiAgICAgICAgICAgICAgICAgICAgPC90cj5cbiAgICAgICAgICAgICAgICA8L3Rib2R5PlxuICAgICAgICAgICAgPC90YWJsZT5cbiAgICAgICAgPC9kaXY+XG4gICAgYFxuICAgICAgICAgICAgfSxdIH0sXG5dO1xuLyoqIEBub2NvbGxhcHNlICovXG5BZ2VuZGFIZWFkZXJDb21wb25lbnQuY3RvclBhcmFtZXRlcnMgPSAoKSA9PiBbXG4gICAgeyB0eXBlOiBMb2NhbGl6YXRpb25TZXJ2aWNlIH1cbl07XG5BZ2VuZGFIZWFkZXJDb21wb25lbnQucHJvcERlY29yYXRvcnMgPSB7XG4gICAgY2xhc3NlczogW3sgdHlwZTogSG9zdEJpbmRpbmcsIGFyZ3M6IFtcImNsYXNzLmstc2NoZWR1bGVyLWhlYWRlclwiLF0gfSwgeyB0eXBlOiBIb3N0QmluZGluZywgYXJnczogW1wiY2xhc3Muay1zdGF0ZS1kZWZhdWx0XCIsXSB9XSxcbiAgICByZXNvdXJjZXM6IFt7IHR5cGU6IElucHV0IH1dXG59O1xuXG4vKipcbiAqIEBoaWRkZW5cbiAqL1xuY2xhc3MgQWdlbmRhVGFza0l0ZW1Db21wb25lbnQge1xuICAgIGNvbnN0cnVjdG9yKGxvY2FsaXphdGlvbiwgbG9jYWxlSWQpIHtcbiAgICAgICAgdGhpcy5sb2NhbGl6YXRpb24gPSBsb2NhbGl6YXRpb247XG4gICAgICAgIHRoaXMubG9jYWxlSWQgPSBsb2NhbGVJZDtcbiAgICB9XG4gICAgZ2V0IGV2ZW50VGl0bGUoKSB7XG4gICAgICAgIGNvbnN0IHN0YXJ0ID0gdG9Mb2NhbERhdGUodGhpcy5pdGVtLnN0YXJ0KTtcbiAgICAgICAgY29uc3QgZW5kID0gdG9Mb2NhbERhdGUodGhpcy5pdGVtLmVuZCk7XG4gICAgICAgIGNvbnN0IHRpbWUgPSBmb3JtYXRFdmVudFRpbWUoc3RhcnQsIGVuZCwgdGhpcy5pdGVtLmlzQWxsRGF5LCB0aGlzLmxvY2FsZUlkKTtcbiAgICAgICAgcmV0dXJuIGAke3RpbWV9LCAke3RoaXMuaXRlbS5ldmVudC50aXRsZX1gO1xuICAgIH1cbiAgICBnZXQgZXZlbnRDb2xvcigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuaXRlbS5jb2xvcjtcbiAgICB9XG4gICAgZ2V0IGRlbGV0ZU1lc3NhZ2UoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmxvY2FsaXphdGlvbi5nZXQoJ2RlbGV0ZVRpdGxlJyk7XG4gICAgfVxuICAgIGdldCBpc1JlY3VycmVuY2UoKSB7XG4gICAgICAgIHJldHVybiBpc1JlY3VycmVuY2UodGhpcy5pdGVtKTtcbiAgICB9XG4gICAgZ2V0IGlzUmVjdXJyZW5jZUV4Y2VwdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIGlzUmVjdXJyZW5jZUV4Y2VwdGlvbih0aGlzLml0ZW0pO1xuICAgIH1cbiAgICBnZXQgcmVtb3ZhYmxlKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5lZGl0YWJsZSAmJiB0aGlzLmVkaXRhYmxlLnJlbW92ZSAhPT0gZmFsc2U7XG4gICAgfVxufVxuQWdlbmRhVGFza0l0ZW1Db21wb25lbnQuZGVjb3JhdG9ycyA9IFtcbiAgICB7IHR5cGU6IENvbXBvbmVudCwgYXJnczogW3tcbiAgICAgICAgICAgICAgICBjaGFuZ2VEZXRlY3Rpb246IENoYW5nZURldGVjdGlvblN0cmF0ZWd5Lk9uUHVzaCxcbiAgICAgICAgICAgICAgICAvLyB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmU6Y29tcG9uZW50LXNlbGVjdG9yXG4gICAgICAgICAgICAgICAgc2VsZWN0b3I6ICdba2VuZG9TY2hlZHVsZXJBZ2VuZGFUYXNrSXRlbV0nLFxuICAgICAgICAgICAgICAgIHRlbXBsYXRlOiBgXG4gICAgICAgIDxkaXYgY2xhc3M9XCJrLXRhc2tcIiBbdGl0bGVdPVwiaXRlbS50aXRsZVwiPlxuICAgICAgICAgICAgPHNwYW4gY2xhc3M9XCJrLXNjaGVkdWxlci1tYXJrXCIgKm5nSWY9XCJldmVudENvbG9yXCIgW3N0eWxlLmJhY2tncm91bmQtY29sb3JdPVwiZXZlbnRDb2xvclwiPjwvc3Bhbj5cbiAgICAgICAgICAgIDxzcGFuIGNsYXNzPVwiay1pY29uIGstaS1yZWxvYWRcIiAqbmdJZj1cImlzUmVjdXJyZW5jZVwiPjwvc3Bhbj5cbiAgICAgICAgICAgIDxzcGFuIGNsYXNzPVwiay1pY29uIGstaS1ub24tcmVjdXJyZW5jZVwiICpuZ0lmPVwiaXNSZWN1cnJlbmNlRXhjZXB0aW9uXCI+PC9zcGFuPlxuICAgICAgICAgICAgPG5nLWNvbnRhaW5lciAqbmdJZj1cIiFldmVudFRlbXBsYXRlXCI+XG4gICAgICAgICAgICAgICAge3tpdGVtPy50aXRsZSB9fVxuICAgICAgICAgICAgPC9uZy1jb250YWluZXI+XG4gICAgICAgICAgICA8bmctY29udGFpbmVyICpuZ0lmPVwiZXZlbnRUZW1wbGF0ZVwiIFtuZ1RlbXBsYXRlT3V0bGV0XT1cImV2ZW50VGVtcGxhdGVcIlxuICAgICAgICAgICAgICAgIFtuZ1RlbXBsYXRlT3V0bGV0Q29udGV4dF09XCJ7ICRpbXBsaWNpdDogaXRlbS5ldmVudCwgZXZlbnQ6IGl0ZW0uZXZlbnQsIHJlc291cmNlczogaXRlbS5yZXNvdXJjZXMgfVwiPlxuICAgICAgICAgICAgPC9uZy1jb250YWluZXI+XG5cbiAgICAgICAgICAgIDxzcGFuICpuZ0lmPVwicmVtb3ZhYmxlXCIgY2xhc3M9XCJrLWxpbmsgay1ldmVudC1kZWxldGVcIiBhcmlhLWhpZGRlbj1cInRydWVcIiBbYXR0ci50aXRsZV09XCJkZWxldGVNZXNzYWdlXCI+XG4gICAgICAgICAgICAgICAgPHNwYW4gY2xhc3M9XCJrLWljb24gay1pLWNsb3NlXCI+PC9zcGFuPlxuICAgICAgICAgICAgPC9zcGFuPlxuICAgICAgICA8L2Rpdj5cbiAgICBgXG4gICAgICAgICAgICB9LF0gfSxcbl07XG4vKiogQG5vY29sbGFwc2UgKi9cbkFnZW5kYVRhc2tJdGVtQ29tcG9uZW50LmN0b3JQYXJhbWV0ZXJzID0gKCkgPT4gW1xuICAgIHsgdHlwZTogTG9jYWxpemF0aW9uU2VydmljZSB9LFxuICAgIHsgdHlwZTogU3RyaW5nLCBkZWNvcmF0b3JzOiBbeyB0eXBlOiBJbmplY3QsIGFyZ3M6IFtMT0NBTEVfSUQsXSB9XSB9XG5dO1xuQWdlbmRhVGFza0l0ZW1Db21wb25lbnQucHJvcERlY29yYXRvcnMgPSB7XG4gICAgaXRlbTogW3sgdHlwZTogSW5wdXQsIGFyZ3M6IFtcImtlbmRvU2NoZWR1bGVyQWdlbmRhVGFza0l0ZW1cIixdIH1dLFxuICAgIGNvbG9yOiBbeyB0eXBlOiBJbnB1dCB9XSxcbiAgICBldmVudFRlbXBsYXRlOiBbeyB0eXBlOiBJbnB1dCB9XSxcbiAgICBlZGl0YWJsZTogW3sgdHlwZTogSW5wdXQgfV0sXG4gICAgZXZlbnRUaXRsZTogW3sgdHlwZTogSG9zdEJpbmRpbmcsIGFyZ3M6IFsnYXR0ci5hcmlhLWxhYmVsJyxdIH1dXG59O1xuXG4vKipcbiAqIEBoaWRkZW5cbiAqL1xuY2xhc3MgQWdlbmRhTGlzdENvbXBvbmVudCB7XG4gICAgY29uc3RydWN0b3IoaW50bFNlcnZpY2UsIGxvY2FsaXphdGlvbikge1xuICAgICAgICB0aGlzLmludGxTZXJ2aWNlID0gaW50bFNlcnZpY2U7XG4gICAgICAgIHRoaXMubG9jYWxpemF0aW9uID0gbG9jYWxpemF0aW9uO1xuICAgICAgICB0aGlzLmNsYXNzZXMgPSB0cnVlO1xuICAgIH1cbiAgICBleHRyYWN0RGF0YUl0ZW0oaXRlbSkge1xuICAgICAgICByZXR1cm4gaXRlbS50eXBlID09PSBcImdyb3VwXCIgPyBpdGVtLmRhdGFJdGVtLml0ZW1zWzBdIDogaXRlbS5kYXRhSXRlbTtcbiAgICB9XG4gICAgZm9ybWF0VGltZShkYXRhSXRlbSkge1xuICAgICAgICBpZiAoZGF0YUl0ZW0uaXNBbGxEYXkpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmxvY2FsaXphdGlvbi5nZXQoJ2FsbERheScpO1xuICAgICAgICB9XG4gICAgICAgIGxldCBmb3JtYXQgPSBcInswOnR9LXsxOnR9XCI7XG4gICAgICAgIGlmIChkYXRhSXRlbS5oZWFkKSB7XG4gICAgICAgICAgICBmb3JtYXQgPSBcInswOnR9XCI7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoZGF0YUl0ZW0udGFpbCkge1xuICAgICAgICAgICAgZm9ybWF0ID0gXCJ7MTp0fVwiO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLmludGxTZXJ2aWNlLmZvcm1hdChmb3JtYXQsIHRvTG9jYWxEYXRlKGRhdGFJdGVtLnN0YXJ0KSwgdG9Mb2NhbERhdGUoZGF0YUl0ZW0uZW5kKSk7XG4gICAgfVxuICAgIHRyYWNrQnlGbihpbmRleCwgX2l0ZW0pIHtcbiAgICAgICAgcmV0dXJuIGluZGV4O1xuICAgIH1cbiAgICBjZWxsQ2xhc3NlcyhpdGVtKSB7XG4gICAgICAgIGNvbnN0IHRhc2sgPSB0aGlzLmV4dHJhY3REYXRhSXRlbShpdGVtKTtcbiAgICAgICAgbGV0IHJlc3VsdCA9IFtdO1xuICAgICAgICBpZiAodGhpcy5zbG90Q2xhc3MpIHtcbiAgICAgICAgICAgIHJlc3VsdCA9IHJlc3VsdC5jb25jYXQoY29udmVydE5nQ2xhc3NCaW5kaW5ncyh0aGlzLnNsb3RDbGFzcyh7XG4gICAgICAgICAgICAgICAgc3RhcnQ6IHRhc2suc3RhcnQsXG4gICAgICAgICAgICAgICAgZW5kOiB0YXNrLmVuZCxcbiAgICAgICAgICAgICAgICByZXNvdXJjZXM6IHRhc2sucmVzb3VyY2VzLFxuICAgICAgICAgICAgICAgIGV2ZW50OiB0YXNrLmV2ZW50XG4gICAgICAgICAgICB9KSkpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLmV2ZW50Q2xhc3MpIHtcbiAgICAgICAgICAgIHJlc3VsdCA9IHJlc3VsdC5jb25jYXQoY29udmVydE5nQ2xhc3NCaW5kaW5ncyh0aGlzLmV2ZW50Q2xhc3Moe1xuICAgICAgICAgICAgICAgIGV2ZW50OiB0YXNrLmV2ZW50LFxuICAgICAgICAgICAgICAgIHJlc291cmNlczogdGFzay5yZXNvdXJjZXNcbiAgICAgICAgICAgIH0pKSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9XG4gICAgZ2V0RXZlbnRTdHlsZXMoaXRlbSkge1xuICAgICAgICBpZiAodGhpcy5ldmVudFN0eWxlcykge1xuICAgICAgICAgICAgY29uc3QgdGFzayA9IHRoaXMuZXh0cmFjdERhdGFJdGVtKGl0ZW0pO1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZXZlbnRTdHlsZXMoe1xuICAgICAgICAgICAgICAgIGV2ZW50OiB0YXNrLmV2ZW50LFxuICAgICAgICAgICAgICAgIHJlc291cmNlczogdGFzay5yZXNvdXJjZXNcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfVxufVxuQWdlbmRhTGlzdENvbXBvbmVudC5kZWNvcmF0b3JzID0gW1xuICAgIHsgdHlwZTogQ29tcG9uZW50LCBhcmdzOiBbe1xuICAgICAgICAgICAgICAgIC8vIHRzbGludDpkaXNhYmxlLW5leHQtbGluZTpjb21wb25lbnQtc2VsZWN0b3JcbiAgICAgICAgICAgICAgICBzZWxlY3RvcjogJ1trZW5kb1NjaGVkdWxlckFnZW5kYUxpc3RdJyxcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZTogYFxuICAgICAgICA8dGFibGUgY2xhc3M9XCJrLXNjaGVkdWxlci10YWJsZVwiIHJvbGU9XCJwcmVzZW50YXRpb25cIj5cbiAgICAgICAgICAgIDx0Ym9keT5cbiAgICAgICAgICAgICAgICA8bmctY29udGFpbmVyICpuZ0Zvcj1cImxldCBncm91cCBvZiB0YXNrczsgbGV0IGdyb3VwSW5kZXggPSBpbmRleDtcIj5cbiAgICAgICAgICAgICAgICAgICAgPHRyICpuZ0Zvcj1cImxldCBpdGVtIG9mIGdyb3VwLnRhc2tzO2xldCBpbmRleCA9IGluZGV4OyB0cmFja0J5OiB0cmFja0J5Rm5cIj5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxuZy1jb250YWluZXIgKm5nRm9yPVwibGV0IHJlc291cmNlIG9mIGdyb3VwLnJlc291cmNlcztsZXQgcmVzb3VyY2VJbmRleCA9IGluZGV4XCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRkICpuZ0lmPVwiZ3JvdXAuc3BhbnNbcmVzb3VyY2VJbmRleF0gJiYgaW5kZXggPT09IDBcIiBjbGFzcz1cImstc2NoZWR1bGVyLWdyb3VwY29sdW1uXCIgW2F0dHIucm93c3Bhbl09XCJncm91cC5zcGFuc1tyZXNvdXJjZUluZGV4XVwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7eyByZXNvdXJjZSB9fVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvdGQ+XG4gICAgICAgICAgICAgICAgICAgICAgICA8L25nLWNvbnRhaW5lcj5cbiAgICAgICAgICAgICAgICAgICAgICAgIDx0ZCAqbmdJZj1cIml0ZW0udHlwZSA9PT0gJ2dyb3VwJ1wiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgW2tlbmRvU2NoZWR1bGVyQWdlbmRhSGVhZGVySXRlbV09XCJpdGVtXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbYWdlbmRhRGF0ZVRlbXBsYXRlXT1cImFnZW5kYURhdGVUZW1wbGF0ZVwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgPC90ZD5cbiAgICAgICAgICAgICAgICAgICAgICAgIDx0ZCBjbGFzcz1cImstc2NoZWR1bGVyLXRpbWVjb2x1bW5cIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2ICpuZ0lmPVwiIWFnZW5kYVRpbWVUZW1wbGF0ZVwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz1cImstaWNvbiBrLWktYXJyb3ctNjAtbGVmdFwiICpuZ0lmPVwiZXh0cmFjdERhdGFJdGVtKGl0ZW0pLnRhaWxcIj48L3NwYW4+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHt7Zm9ybWF0VGltZShleHRyYWN0RGF0YUl0ZW0oaXRlbSkpIH19XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzPVwiay1pY29uIGstaS1hcnJvdy02MC1yaWdodFwiICpuZ0lmPVwiZXh0cmFjdERhdGFJdGVtKGl0ZW0pLmhlYWRcIj48L3NwYW4+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPG5nLWNvbnRhaW5lciAqbmdJZj1cImFnZW5kYVRpbWVUZW1wbGF0ZVwiIFtuZ1RlbXBsYXRlT3V0bGV0XT1cImFnZW5kYVRpbWVUZW1wbGF0ZVwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFtuZ1RlbXBsYXRlT3V0bGV0Q29udGV4dF09XCJleHRyYWN0RGF0YUl0ZW0oaXRlbSlcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L25nLWNvbnRhaW5lcj5cbiAgICAgICAgICAgICAgICAgICAgICAgIDwvdGQ+XG4gICAgICAgICAgICAgICAgICAgICAgICA8dGQgW2F0dHIuZGF0YS1ncm91cC1pbmRleF09XCJncm91cEluZGV4XCIgW2F0dHIuZGF0YS10YXNrLWluZGV4XT1cImluZGV4XCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbbmdDbGFzc109XCJjZWxsQ2xhc3NlcyhpdGVtKVwiIFtuZ1N0eWxlXT1cImdldEV2ZW50U3R5bGVzKGl0ZW0pXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBba2VuZG9TY2hlZHVsZXJGb2N1c0luZGV4XT1cImdyb3VwSW5kZXhcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFtrZW5kb1NjaGVkdWxlckFnZW5kYVRhc2tJdGVtXT1cImV4dHJhY3REYXRhSXRlbShpdGVtKVwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFtlZGl0YWJsZV09XCJlZGl0YWJsZVwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFtldmVudFRlbXBsYXRlXT1cImV2ZW50VGVtcGxhdGVcIlxuICAgICAgICAgICAgICAgICAgICAgICAgPjwvdGQ+XG4gICAgICAgICAgICAgICAgICAgIDwvdHI+XG4gICAgICAgICAgICAgICAgPC9uZy1jb250YWluZXI+XG4gICAgICAgICAgICA8L3Rib2R5PlxuICAgICAgICA8L3RhYmxlPlxuICAgIGBcbiAgICAgICAgICAgIH0sXSB9LFxuXTtcbi8qKiBAbm9jb2xsYXBzZSAqL1xuQWdlbmRhTGlzdENvbXBvbmVudC5jdG9yUGFyYW1ldGVycyA9ICgpID0+IFtcbiAgICB7IHR5cGU6IEludGxTZXJ2aWNlIH0sXG4gICAgeyB0eXBlOiBMb2NhbGl6YXRpb25TZXJ2aWNlIH1cbl07XG5BZ2VuZGFMaXN0Q29tcG9uZW50LnByb3BEZWNvcmF0b3JzID0ge1xuICAgIGNsYXNzZXM6IFt7IHR5cGU6IEhvc3RCaW5kaW5nLCBhcmdzOiBbJ2NsYXNzLmstc2NoZWR1bGVyLWNvbnRlbnQnLF0gfV0sXG4gICAgdGFza3M6IFt7IHR5cGU6IElucHV0IH1dLFxuICAgIGV2ZW50VGVtcGxhdGU6IFt7IHR5cGU6IElucHV0IH1dLFxuICAgIHNsb3RDbGFzczogW3sgdHlwZTogSW5wdXQgfV0sXG4gICAgZXZlbnRDbGFzczogW3sgdHlwZTogSW5wdXQgfV0sXG4gICAgZXZlbnRTdHlsZXM6IFt7IHR5cGU6IElucHV0IH1dLFxuICAgIGFnZW5kYVRpbWVUZW1wbGF0ZTogW3sgdHlwZTogSW5wdXQgfV0sXG4gICAgYWdlbmRhRGF0ZVRlbXBsYXRlOiBbeyB0eXBlOiBJbnB1dCB9XSxcbiAgICBlZGl0YWJsZTogW3sgdHlwZTogSW5wdXQgfV1cbn07XG5cbmNvbnN0IGZsaXAgPSBmbiA9PiBhID0+IGIgPT4gZm4oYiwgYSk7XG5jb25zdCBzb3J0ID0gZmxpcChvcmRlckJ5KTtcbmNvbnN0IGdyb3VwID0gZmxpcChncm91cEJ5KTtcbi8qKlxuICogQGhpZGRlblxuICovXG5jb25zdCBjb21wb3NlID0gKC4uLmFyZ3MpID0+IChkYXRhKSA9PiBhcmdzLnJlZHVjZVJpZ2h0KChhY2MsIGN1cnIpID0+IGN1cnIoYWNjKSwgZGF0YSk7XG4vKipcbiAqIEBoaWRkZW5cbiAqL1xuY29uc3QgcHJvY2Vzc0V2ZW50cyA9IChzdGFydCwgZW5kKSA9PiBjb21wb3NlKGdyb3VwKFt7IGZpZWxkOiBcInN0YXJ0RGF0ZVwiIH1dKSwgc29ydChbeyBmaWVsZDogXCJzdGFydFwiLCBkaXI6IFwiYXNjXCIgfSwgeyBmaWVsZDogXCJlbmRcIiwgZGlyOiBcImFzY1wiIH1dKSk7XG5mdW5jdGlvbiogZmxhdHRlbkdyb3Vwcyhncm91cHMpIHtcbiAgICBmb3IgKGxldCBpbmRleCA9IDA7IGluZGV4IDwgZ3JvdXBzLmxlbmd0aDsgaW5kZXgrKykge1xuICAgICAgICBjb25zdCBncm91cEl0ZW0gPSBncm91cHNbaW5kZXhdO1xuICAgICAgICB5aWVsZCB7XG4gICAgICAgICAgICB0eXBlOiBcImdyb3VwXCIsXG4gICAgICAgICAgICBkYXRhSXRlbTogZ3JvdXBJdGVtLFxuICAgICAgICAgICAgcm93U3BhbjogZ3JvdXBJdGVtLml0ZW1zLmxlbmd0aFxuICAgICAgICB9O1xuICAgICAgICBmb3IgKGxldCBpdGVtSW5kZXggPSAxOyBpdGVtSW5kZXggPCBncm91cEl0ZW0uaXRlbXMubGVuZ3RoOyBpdGVtSW5kZXgrKykge1xuICAgICAgICAgICAgY29uc3QgaXRlbSA9IGdyb3VwSXRlbS5pdGVtc1tpdGVtSW5kZXhdO1xuICAgICAgICAgICAgeWllbGQge1xuICAgICAgICAgICAgICAgIHR5cGU6IFwiZXZlbnRcIixcbiAgICAgICAgICAgICAgICBkYXRhSXRlbTogaXRlbVxuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgIH1cbn1cbi8qKiBAaGlkZGVuICovXG5jbGFzcyBFbXB0eUl0ZXJhdG9yIHtcbiAgICBbaXRlcmF0b3JdKCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgbmV4dDogKCkgPT4gKHsgZG9uZTogdHJ1ZSwgdmFsdWU6IG51bGwgfSlcbiAgICAgICAgfTtcbiAgICB9XG4gICAgdG9TdHJpbmcoKSB7XG4gICAgICAgIHJldHVybiBcIkVtcHR5IEl0ZXJhdG9yXCI7XG4gICAgfVxufVxuLyoqXG4gKiBAaGlkZGVuXG4gKi9cbmNsYXNzIFRhc2tDb2xsZWN0aW9uIHtcbiAgICBjb25zdHJ1Y3RvcihzdGFydCwgZW5kLCBldmVudHMpIHtcbiAgICAgICAgdGhpcy5zdGFydCA9IHN0YXJ0O1xuICAgICAgICB0aGlzLmVuZCA9IGVuZDtcbiAgICAgICAgdGhpcy5ldmVudHMgPSBldmVudHM7XG4gICAgICAgIHRoaXMuY3JlYXRlSXRlcmF0b3IgPSBjb21wb3NlKGZsYXR0ZW5Hcm91cHMsIHByb2Nlc3NFdmVudHModGhpcy5zdGFydCwgdGhpcy5lbmQpKTtcbiAgICB9XG4gICAgc3RhdGljIGVtcHR5KCkge1xuICAgICAgICByZXR1cm4gKG5ldyBFbXB0eUl0ZXJhdG9yKCkpO1xuICAgIH1cbiAgICBbaXRlcmF0b3JdKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5jcmVhdGVJdGVyYXRvcih0aGlzLmV2ZW50cyk7XG4gICAgfVxuICAgIGl0ZW1BdChpbmRleCkge1xuICAgICAgICBjb25zdCB0YXNrSXRlcmF0b3IgPSB0aGlzLmNyZWF0ZUl0ZXJhdG9yKHRoaXMuZXZlbnRzKTtcbiAgICAgICAgbGV0IGlkeCA9IDA7XG4gICAgICAgIGxldCBpdGVtO1xuICAgICAgICBkbyB7XG4gICAgICAgICAgICBpdGVtID0gdGFza0l0ZXJhdG9yLm5leHQoKTtcbiAgICAgICAgICAgIGlmIChpdGVtICYmIGlkeCA9PT0gaW5kZXgpIHtcbiAgICAgICAgICAgICAgICBjb25zdCB2YWx1ZSA9IGl0ZW0udmFsdWU7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHZhbHVlLnR5cGUgPT09ICdncm91cCcgPyB2YWx1ZS5kYXRhSXRlbS5pdGVtc1swXSA6IHZhbHVlLmRhdGFJdGVtO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWR4Kys7XG4gICAgICAgIH0gd2hpbGUgKGl0ZW0pO1xuICAgIH1cbiAgICB0b1N0cmluZygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZXZlbnRzLnRvU3RyaW5nKCk7XG4gICAgfVxufVxuXG4vKipcbiAqIEBoaWRkZW5cbiAqL1xuZnVuY3Rpb24gY3JlYXRlUmVzb3VyY2VHcm91cHMoZ3JvdXBlZFJlc291cmNlcykge1xuICAgIGxldCByZXN1bHQgPSBbXTtcbiAgICBjb25zdCBmaXJzdFJlc291cmNlID0gZ3JvdXBlZFJlc291cmNlc1swXTtcbiAgICBjb25zdCBmaXJzdFJlc291cmNlRGF0YSA9IGZpcnN0UmVzb3VyY2UuZGF0YTtcbiAgICBmb3IgKGxldCBkYXRhSWR4ID0gMDsgZGF0YUlkeCA8IGZpcnN0UmVzb3VyY2VEYXRhLmxlbmd0aDsgZGF0YUlkeCsrKSB7XG4gICAgICAgIGNvbnN0IGl0ZW0gPSBmaXJzdFJlc291cmNlRGF0YVtkYXRhSWR4XTtcbiAgICAgICAgcmVzdWx0LnB1c2goeyByZXNvdXJjZXM6IFtnZXRGaWVsZChpdGVtLCBmaXJzdFJlc291cmNlLnRleHRGaWVsZCldIH0pO1xuICAgIH1cbiAgICBmb3IgKGxldCBpZHggPSAxOyBpZHggPCBncm91cGVkUmVzb3VyY2VzLmxlbmd0aDsgaWR4KyspIHtcbiAgICAgICAgY29uc3QgcmVzb3VyY2UgPSBncm91cGVkUmVzb3VyY2VzW2lkeF07XG4gICAgICAgIGNvbnN0IGRhdGEgPSByZXNvdXJjZS5kYXRhO1xuICAgICAgICBjb25zdCBjdXJyZW50ID0gW107XG4gICAgICAgIGZvciAobGV0IHJlc291cmNlSWR4ID0gMDsgcmVzb3VyY2VJZHggPCByZXN1bHQubGVuZ3RoOyByZXNvdXJjZUlkeCsrKSB7XG4gICAgICAgICAgICBjb25zdCByZXNvdXJjZUl0ZW0gPSByZXN1bHRbcmVzb3VyY2VJZHhdO1xuICAgICAgICAgICAgZm9yIChsZXQgZGF0YUlkeCA9IDA7IGRhdGFJZHggPCBkYXRhLmxlbmd0aDsgZGF0YUlkeCsrKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgaXRlbSA9IGRhdGFbZGF0YUlkeF07XG4gICAgICAgICAgICAgICAgY3VycmVudC5wdXNoKHsgcmVzb3VyY2VzOiByZXNvdXJjZUl0ZW0ucmVzb3VyY2VzLmNvbmNhdChnZXRGaWVsZChpdGVtLCByZXNvdXJjZS50ZXh0RmllbGQpKSB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXN1bHQgPSBjdXJyZW50O1xuICAgIH1cbiAgICByZXR1cm4gcmVzdWx0O1xufVxuZnVuY3Rpb24gY3JlYXRlVGFzayhpdGVtLCByZXNvdXJjZUlkeCwgcmVzb3VyY2VzLCBjb2xvcikge1xuICAgIGNvbnN0IGV2ZW50ID0gaXRlbS5ldmVudDtcbiAgICByZXR1cm4ge1xuICAgICAgICBldmVudCxcbiAgICAgICAgc3RhcnQ6IGl0ZW0uc3RhcnQudG9VVENEYXRlKCksXG4gICAgICAgIGVuZDogaXRlbS5lbmQudG9VVENEYXRlKCksXG4gICAgICAgIHRpdGxlOiBldmVudC50aXRsZSxcbiAgICAgICAgaXNBbGxEYXk6IGV2ZW50LmlzQWxsRGF5LFxuICAgICAgICBjb2xvcixcbiAgICAgICAgcmVzb3VyY2VJZHgsXG4gICAgICAgIHJlc291cmNlc1xuICAgIH07XG59XG5jb25zdCBkdXJhdGlvbkluRGF5cyA9ICh7IHN0YXJ0LCBlbmQsIGlzQWxsRGF5ID0gZmFsc2UgfSkgPT4ge1xuICAgIGNvbnN0IGV2ZW50RW5kID0gaXNBbGxEYXkgPyBnZXRVVENEYXRlKGVuZCkgOiBlbmQ7XG4gICAgY29uc3QgZHVyYXRpb24gPSBNYXRoLmNlaWwoKGV2ZW50RW5kIC0gK2dldFVUQ0RhdGUoc3RhcnQpKSAvIE1TX1BFUl9EQVkpO1xuICAgIGlmIChpc0FsbERheSkge1xuICAgICAgICByZXR1cm4gZHVyYXRpb24gKyAxO1xuICAgIH1cbiAgICByZXR1cm4gZHVyYXRpb247XG59O1xuY29uc3QgY3VycnkgPSBmbiA9PiB7XG4gICAgY29uc3QgbGVuID0gZm4ubGVuZ3RoO1xuICAgIHJldHVybiAoLi4uYXJncykgPT4gbGVuID09PSBhcmdzLmxlbmd0aFxuICAgICAgICA/IGZuLmFwcGx5KG51bGwsIGFyZ3MpXG4gICAgICAgIDogY3VycnkoZm4uYmluZChudWxsLCAuLi5hcmdzKSk7XG59O1xuY29uc3QgcmFuZ2UgPSBudW0gPT4gQXJyYXkuZnJvbShuZXcgQXJyYXkobnVtKS5rZXlzKCkpO1xuY29uc3QgY2xvbmVUYXNrID0gKGV2ZW50U3RhcnQsIGV2ZW50RW5kKSA9PiB0YXNrID0+IChPYmplY3QuYXNzaWduKHt9LCB0YXNrLCB7IHN0YXJ0OiBnZXRVVENEYXRlKGV2ZW50U3RhcnQpLCBlbmQ6IHRhc2sudGFpbCAmJiAhdGFzay5pc0FsbERheSA/IGV2ZW50RW5kIDogYWRkVVRDRGF5cyhldmVudFN0YXJ0LCAxKSwgc3RhcnREYXRlOiBnZXRVVENEYXRlKGV2ZW50U3RhcnQpIH0pKTtcbmNvbnN0IHByZXZpb3VzRXZlbnRFbmQgPSAoc3RhcnQsIGV2ZW50cykgPT4gZXZlbnRzLmxlbmd0aFxuICAgID8gZXZlbnRzW2V2ZW50cy5sZW5ndGggLSAxXS5lbmRcbiAgICA6IHN0YXJ0O1xuY29uc3QgbWFya0FzVGFpbCA9IGlzTGFzdCA9PiB0YXNrID0+IHtcbiAgICBpZiAoaXNMYXN0KSB7XG4gICAgICAgIHRhc2sudGFpbCA9IHRydWU7XG4gICAgfVxuICAgIHJldHVybiB0YXNrO1xufTtcbmNvbnN0IG1hcmtBc01pZCA9IHRhc2sgPT4ge1xuICAgIGlmICghdGFzay50YWlsKSB7XG4gICAgICAgIHRhc2subWlkID0gdHJ1ZTtcbiAgICB9XG4gICAgcmV0dXJuIHRhc2s7XG59O1xuY29uc3QgYWRkVGFza1BhcnQgPSAodGFzaywgc3RhcnQpID0+ICh0YXNrcywgXywgZGF5LCBkYXlzKSA9PiB0YXNrcy5jb25jYXQoY29tcG9zZShtYXJrQXNNaWQsIGNsb25lVGFzayhwcmV2aW91c0V2ZW50RW5kKHN0YXJ0LCB0YXNrcyksIHRhc2suZW5kKSwgbWFya0FzVGFpbChkYXkgPT09IGRheXMubGVuZ3RoIC0gMSkpKHRhc2spKTtcbmNvbnN0IHNwbGl0TXVsdGlEYXlUYXNrID0gKHRhc2ssIHN0YXJ0KSA9PiByYW5nZShkdXJhdGlvbkluRGF5cyh0YXNrKSAtIDEpXG4gICAgLnJlZHVjZShhZGRUYXNrUGFydCh0YXNrLCBzdGFydCksIFtdKTtcbi8qKlxuICogQGhpZGRlblxuICovXG5jb25zdCBzcGxpdFRhc2tzID0gY3VycnkoKHBlcmlvZFN0YXJ0LCBwZXJpb2RFbmQsIHRhc2tzKSA9PiB7XG4gICAgY29uc3QgcmVzdWx0ID0gW107XG4gICAgZm9yIChsZXQgaW5kZXggPSAwOyBpbmRleCA8IHRhc2tzLmxlbmd0aDsgaW5kZXgrKykge1xuICAgICAgICBsZXQgdGFzayA9IE9iamVjdC5hc3NpZ24oe30sIHRhc2tzW2luZGV4XSk7XG4gICAgICAgIHRhc2suc3RhcnREYXRlID0gZ2V0VVRDRGF0ZSh0YXNrLnN0YXJ0KTtcbiAgICAgICAgaWYgKHRhc2suc3RhcnQgPj0gcGVyaW9kU3RhcnQgJiYgdGFzay5zdGFydCA8PSBwZXJpb2RFbmQpIHtcbiAgICAgICAgICAgIHJlc3VsdC5wdXNoKHRhc2spO1xuICAgICAgICB9XG4gICAgICAgIGlmIChkdXJhdGlvbkluRGF5cyh0YXNrKSA+IDEpIHtcbiAgICAgICAgICAgIHRhc2suZW5kID0gYWRkVVRDRGF5cyh0YXNrLnN0YXJ0RGF0ZSwgMSk7XG4gICAgICAgICAgICB0YXNrLmhlYWQgPSB0cnVlO1xuICAgICAgICAgICAgcmVzdWx0LnB1c2goLi4uc3BsaXRNdWx0aURheVRhc2soT2JqZWN0LmFzc2lnbih7fSwgdGFza3NbaW5kZXhdKSwgdGFzay5lbmQpXG4gICAgICAgICAgICAgICAgLmZpbHRlcih0c2sgPT4gZ2V0VVRDRGF0ZSh0c2suZW5kKSA8PSBwZXJpb2RFbmQgJiYgdHNrLnN0YXJ0ID49IHBlcmlvZFN0YXJ0KSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHJlc3VsdDtcbn0pO1xuZnVuY3Rpb24gZ3JvdXBCeVJlc291cmNlKGdyb3VwZWRSZXNvdXJjZXMsIHJlc291cmNlR3JvdXBzLCBkYXRlUmFuZ2UpIHtcbiAgICBjb25zdCBncm91cHMgPSByZXNvdXJjZUdyb3Vwcy5maWx0ZXIoZ3JvdXAgPT4gZ3JvdXAudGFza3MgJiYgZ3JvdXAudGFza3MubGVuZ3RoKTtcbiAgICBpZiAoIWdyb3Vwcy5sZW5ndGgpIHtcbiAgICAgICAgcmV0dXJuIFtdO1xuICAgIH1cbiAgICBjb25zdCB2YWx1ZXMgPSBncm91cHNbMF0ucmVzb3VyY2VzLm1hcChyZXNvdXJjZSA9PiAoeyB2YWx1ZTogcmVzb3VyY2UsIHNwYW46IDAsIGdyb3VwSWR4OiAwIH0pKTtcbiAgICBjb25zdCBwZXJpb2RTdGFydCA9IHRvVVRDRGF0ZShkYXRlUmFuZ2Uuc3RhcnQpO1xuICAgIGNvbnN0IHBlcmlvZEVuZCA9IHRvVVRDRGF0ZShkYXRlUmFuZ2UuZW5kKTtcbiAgICBmb3IgKGxldCBncm91cElkeCA9IDA7IGdyb3VwSWR4IDwgZ3JvdXBzLmxlbmd0aDsgZ3JvdXBJZHgrKykge1xuICAgICAgICBjb25zdCBncm91cCA9IGdyb3Vwc1tncm91cElkeF07XG4gICAgICAgIGdyb3VwLnRhc2tzID0gc3BsaXRUYXNrcyhwZXJpb2RTdGFydCwgcGVyaW9kRW5kLCBncm91cC50YXNrcyk7XG4gICAgICAgIGNvbnN0IGNvdW50ID0gZ3JvdXAudGFza3MubGVuZ3RoO1xuICAgICAgICBncm91cC50YXNrcyA9IG5ldyBUYXNrQ29sbGVjdGlvbihwZXJpb2RTdGFydCwgcGVyaW9kRW5kLCBncm91cC50YXNrcyk7XG4gICAgICAgIGxldCBpbnZhbGlkYXRlID0gZmFsc2U7XG4gICAgICAgIGZvciAobGV0IHJlc291cmNlSWR4ID0gMDsgcmVzb3VyY2VJZHggPCBncm91cGVkUmVzb3VyY2VzLmxlbmd0aDsgcmVzb3VyY2VJZHgrKykge1xuICAgICAgICAgICAgY29uc3QgcmVzb3VyY2VWYWx1ZSA9IHZhbHVlc1tyZXNvdXJjZUlkeF07XG4gICAgICAgICAgICBpZiAocmVzb3VyY2VWYWx1ZS52YWx1ZSAhPT0gZ3JvdXAucmVzb3VyY2VzW3Jlc291cmNlSWR4XSB8fCBpbnZhbGlkYXRlKSB7XG4gICAgICAgICAgICAgICAgcmVzb3VyY2VWYWx1ZS52YWx1ZSA9IGdyb3VwLnJlc291cmNlc1tyZXNvdXJjZUlkeF07XG4gICAgICAgICAgICAgICAgY29uc3Qgc3Bhbkdyb3VwID0gZ3JvdXBzW3Jlc291cmNlVmFsdWUuZ3JvdXBJZHhdO1xuICAgICAgICAgICAgICAgIHNwYW5Hcm91cC5zcGFucyA9IHNwYW5Hcm91cC5zcGFucyB8fCBbXTtcbiAgICAgICAgICAgICAgICBzcGFuR3JvdXAuc3BhbnNbcmVzb3VyY2VJZHhdID0gcmVzb3VyY2VWYWx1ZS5zcGFuO1xuICAgICAgICAgICAgICAgIHJlc291cmNlVmFsdWUuc3BhbiA9IGNvdW50O1xuICAgICAgICAgICAgICAgIHJlc291cmNlVmFsdWUuZ3JvdXBJZHggPSBncm91cElkeDtcbiAgICAgICAgICAgICAgICBpbnZhbGlkYXRlID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHJlc291cmNlVmFsdWUuc3BhbiArPSBjb3VudDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICB2YWx1ZXMuZm9yRWFjaCgodmFsdWUsIGluZGV4KSA9PiB7XG4gICAgICAgIGNvbnN0IGdyb3VwID0gZ3JvdXBzW3ZhbHVlLmdyb3VwSWR4XTtcbiAgICAgICAgZ3JvdXAuc3BhbnMgPSBncm91cC5zcGFucyB8fCBbXTtcbiAgICAgICAgZ3JvdXAuc3BhbnNbaW5kZXhdID0gdmFsdWUuc3BhbjtcbiAgICB9KTtcbiAgICByZXR1cm4gZ3JvdXBzO1xufVxuLyoqXG4gKiBAaGlkZGVuXG4gKi9cbmZ1bmN0aW9uIGdyb3VwRXZlbnRzKGl0ZW1zLCB7IHRhc2tSZXNvdXJjZXMsIHJlc291cmNlR3JvdXBzLCBzcGFucywgYWxsUmVzb3VyY2VzLCBkYXRlUmFuZ2UgfSkge1xuICAgIGNvbnN0IGdyb3VwcyA9IHJlc291cmNlR3JvdXBzIHx8IFt7fV07XG4gICAgY29uc3QgcGVyaW9kU3RhcnQgPSB0b1VUQ0RhdGUoZGF0ZVJhbmdlLnN0YXJ0KTtcbiAgICBjb25zdCBwZXJpb2RFbmQgPSB0b1VUQ0RhdGUoZGF0ZVJhbmdlLmVuZCk7XG4gICAgZm9yIChsZXQgaWR4ID0gMDsgaWR4IDwgaXRlbXMubGVuZ3RoOyBpZHgrKykge1xuICAgICAgICBjb25zdCBpdGVtID0gaXRlbXNbaWR4XTtcbiAgICAgICAgY29uc3QgZXZlbnQgPSBpdGVtLmV2ZW50O1xuICAgICAgICBpZiAoIWludGVyc2VjdHMoaXRlbS5zdGFydC50b1VUQ0RhdGUoKSwgaXRlbS5lbmQudG9VVENEYXRlKCksIHBlcmlvZFN0YXJ0LCBwZXJpb2RFbmQpKSB7XG4gICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCByZXNvdXJjZXMgPSBldmVudFJlc291cmNlcyhldmVudCwgeyB0YXNrUmVzb3VyY2VzLCBoYXNHcm91cHM6IHJlc291cmNlR3JvdXBzICYmIHJlc291cmNlR3JvdXBzLmxlbmd0aCA+IDAsIHNwYW5zLCBhbGxSZXNvdXJjZXMgfSk7XG4gICAgICAgIGlmIChyZXNvdXJjZXMubGVuZ3RoICYmIHJlc291cmNlc1swXS5sZWFmSWR4ID49IDApIHtcbiAgICAgICAgICAgIGZvciAobGV0IHJlc291cmNlSWR4ID0gMDsgcmVzb3VyY2VJZHggPCByZXNvdXJjZXMubGVuZ3RoOyByZXNvdXJjZUlkeCsrKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgY3VycmVudCA9IHJlc291cmNlc1tyZXNvdXJjZUlkeF07XG4gICAgICAgICAgICAgICAgY29uc3QgdGFzayA9IGNyZWF0ZVRhc2soaXRlbSwgY3VycmVudC5sZWFmSWR4LCBjdXJyZW50LnJlc291cmNlcywgY3VycmVudC5jb2xvcik7XG4gICAgICAgICAgICAgICAgY29uc3QgdGFza3MgPSBncm91cHNbY3VycmVudC5sZWFmSWR4XS50YXNrcyA9IGdyb3Vwc1tjdXJyZW50LmxlYWZJZHhdLnRhc2tzIHx8IFtdO1xuICAgICAgICAgICAgICAgIHRhc2tzLnB1c2godGFzayk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgaWYgKHJlc291cmNlR3JvdXBzKSB7XG4gICAgICAgIHJldHVybiBncm91cEJ5UmVzb3VyY2UodGFza1Jlc291cmNlcywgZ3JvdXBzLCBkYXRlUmFuZ2UpO1xuICAgIH1cbiAgICBncm91cHNbMF0udGFza3MgPSBuZXcgVGFza0NvbGxlY3Rpb24ocGVyaW9kU3RhcnQsIHBlcmlvZEVuZCwgc3BsaXRUYXNrcyhwZXJpb2RTdGFydCwgcGVyaW9kRW5kLCBncm91cHNbMF0udGFza3MgfHwgW10pKTtcbiAgICByZXR1cm4gZ3JvdXBzO1xufVxuXG4vKipcbiAqIEBoaWRkZW5cbiAqL1xuY2xhc3MgQWdlbmRhVmlld0ludGVybmFsQ29tcG9uZW50IHtcbiAgICBjb25zdHJ1Y3Rvcih2aWV3Q29udGV4dCwgdmlld1N0YXRlLCBpbnRsLCByZW5kZXJlciwgZWxlbWVudCwgem9uZSwgcGRmU2VydmljZSwgbG9jYWxpemF0aW9uKSB7XG4gICAgICAgIHRoaXMudmlld0NvbnRleHQgPSB2aWV3Q29udGV4dDtcbiAgICAgICAgdGhpcy52aWV3U3RhdGUgPSB2aWV3U3RhdGU7XG4gICAgICAgIHRoaXMuaW50bCA9IGludGw7XG4gICAgICAgIHRoaXMucmVuZGVyZXIgPSByZW5kZXJlcjtcbiAgICAgICAgdGhpcy5lbGVtZW50ID0gZWxlbWVudDtcbiAgICAgICAgdGhpcy56b25lID0gem9uZTtcbiAgICAgICAgdGhpcy5wZGZTZXJ2aWNlID0gcGRmU2VydmljZTtcbiAgICAgICAgdGhpcy5sb2NhbGl6YXRpb24gPSBsb2NhbGl6YXRpb247XG4gICAgICAgIHRoaXMudGFza3MgPSBuZXcgQmVoYXZpb3JTdWJqZWN0KG51bGwpO1xuICAgICAgICB0aGlzLmdyb3VwZWRSZXNvdXJjZXMgPSBbXTtcbiAgICAgICAgdGhpcy5zcGFucyA9IFtdO1xuICAgICAgICB0aGlzLnN1YnMgPSBuZXcgU3Vic2NyaXB0aW9uKCk7XG4gICAgfVxuICAgIGdldCBldmVudFRlbXBsYXRlUmVmKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5ldmVudFRlbXBsYXRlIHx8ICh0aGlzLnNjaGVkdWxlckV2ZW50VGVtcGxhdGUgfHwge30pLnRlbXBsYXRlUmVmO1xuICAgIH1cbiAgICBnZXQgYWdlbmRhVGltZVRlbXBsYXRlUmVmKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5hZ2VuZGFUaW1lVGVtcGxhdGUgfHwgKHRoaXMuc2NoZWR1bGVyQWdlbmRhVGltZVRlbXBsYXRlIHx8IHt9KS50ZW1wbGF0ZVJlZjtcbiAgICB9XG4gICAgZ2V0IGFnZW5kYURhdGVUZW1wbGF0ZVJlZigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuYWdlbmRhRGF0ZVRlbXBsYXRlIHx8ICh0aGlzLnNjaGVkdWxlckFnZW5kYURhdGVUZW1wbGF0ZSB8fCB7fSkudGVtcGxhdGVSZWY7XG4gICAgfVxuICAgIG5nT25Jbml0KCkge1xuICAgICAgICB0aGlzLnVwZGF0ZUNvbnRlbnRIZWlnaHQgPSB0aGlzLnVwZGF0ZUNvbnRlbnRIZWlnaHQuYmluZCh0aGlzKTtcbiAgICAgICAgdGhpcy5zdWJzLmFkZCh0aGlzLnZpZXdDb250ZXh0LnNlbGVjdGVkRGF0ZS5zdWJzY3JpYmUodGhpcy5vblNlbGVjdERhdGUuYmluZCh0aGlzKSkpO1xuICAgICAgICB0aGlzLnN1YnMuYWRkKHRoaXMudmlld0NvbnRleHQuYWN0aW9uLnN1YnNjcmliZSh0aGlzLm9uQWN0aW9uLmJpbmQodGhpcykpKTtcbiAgICAgICAgdGhpcy5zdWJzLmFkZCh0aGlzLnZpZXdDb250ZXh0LmV4ZWN1dGUuc3Vic2NyaWJlKHRoaXMuZXhlY3V0ZS5iaW5kKHRoaXMpKSk7XG4gICAgICAgIHRoaXMuc3Vicy5hZGQodGhpcy52aWV3Q29udGV4dC5yZXNpemUuc3Vic2NyaWJlKHRoaXMudXBkYXRlQ29udGVudEhlaWdodCkpO1xuICAgICAgICB0aGlzLnN1YnMuYWRkKGNvbWJpbmVMYXRlc3QodGhpcy52aWV3Q29udGV4dC5pdGVtcywgdGhpcy52aWV3U3RhdGUuZGF0ZVJhbmdlKS5waXBlKG1hcCgoW2l0ZW1zLCBkYXRlUmFuZ2VdKSA9PiB7XG4gICAgICAgICAgICB0aGlzLml0ZW1zID0gaXRlbXM7XG4gICAgICAgICAgICB0aGlzLnJhbmdlID0gZGF0ZVJhbmdlO1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuY3JlYXRlRXZlbnRHcm91cHMoKTtcbiAgICAgICAgfSkpXG4gICAgICAgICAgICAuc3Vic2NyaWJlKCh0YXNrcykgPT4ge1xuICAgICAgICAgICAgdGhpcy50YXNrcy5uZXh0KHRhc2tzKTtcbiAgICAgICAgfSkpO1xuICAgICAgICB0aGlzLnN1YnMuYWRkKHRoaXMudmlld0NvbnRleHQub3B0aW9uc0NoYW5nZS5zdWJzY3JpYmUodGhpcy5vcHRpb25zQ2hhbmdlLmJpbmQodGhpcykpKTtcbiAgICAgICAgY29uc3Qgb25TdGFibGUgPSAoKSA9PiB0aGlzLnpvbmUub25TdGFibGUucGlwZSh0YWtlKDEpKTtcbiAgICAgICAgdGhpcy5zdWJzLmFkZChjb21iaW5lTGF0ZXN0KHRoaXMudGFza3MsIHRoaXMubG9jYWxpemF0aW9uLmNoYW5nZXMpLnBpcGUoc3dpdGNoTWFwKG9uU3RhYmxlKSlcbiAgICAgICAgICAgIC5zdWJzY3JpYmUodGhpcy51cGRhdGVDb250ZW50SGVpZ2h0KSk7XG4gICAgICAgIHRoaXMuc3Vicy5hZGQodGhpcy5wZGZTZXJ2aWNlLmNyZWF0ZUVsZW1lbnQuc3Vic2NyaWJlKHRoaXMuY3JlYXRlUERGRWxlbWVudC5iaW5kKHRoaXMpKSk7XG4gICAgfVxuICAgIG5nT25DaGFuZ2VzKGNoYW5nZXMpIHtcbiAgICAgICAgaWYgKGFueUNoYW5nZWQoWydzZWxlY3RlZERhdGVGb3JtYXQnLCAnc2VsZWN0ZWRTaG9ydERhdGVGb3JtYXQnLCAnbnVtYmVyT2ZEYXlzJ10sIGNoYW5nZXMpKSB7XG4gICAgICAgICAgICB0aGlzLnZpZXdTdGF0ZS5ub3RpZnlEYXRlUmFuZ2UodGhpcy5kYXRlUmFuZ2UodGhpcy5zZWxlY3RlZERhdGUpKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBuZ0FmdGVyVmlld0luaXQoKSB7XG4gICAgICAgIGlmICghdGhpcy5lbGVtZW50KSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgY29udGVudEVsZW1lbnQgPSB0aGlzLmNvbnRlbnQubmF0aXZlRWxlbWVudDtcbiAgICAgICAgdGhpcy56b25lLnJ1bk91dHNpZGVBbmd1bGFyKCgpID0+IHtcbiAgICAgICAgICAgIHRoaXMuc3Vicy5hZGQobWVyZ2UoZnJvbUV2ZW50KGNvbnRlbnRFbGVtZW50LCAnY2xpY2snKSwgZnJvbUV2ZW50KGNvbnRlbnRFbGVtZW50LCAnY29udGV4dG1lbnUnKSwgZnJvbUV2ZW50KGNvbnRlbnRFbGVtZW50LCAnZGJsY2xpY2snKSlcbiAgICAgICAgICAgICAgICAuc3Vic2NyaWJlKGUgPT4gdGhpcy5vbkNsaWNrKGUpKSk7XG4gICAgICAgICAgICB0aGlzLnN1YnMuYWRkKGZyb21FdmVudChjb250ZW50RWxlbWVudCwgJ2tleWRvd24nKVxuICAgICAgICAgICAgICAgIC5zdWJzY3JpYmUoZSA9PiB0aGlzLm9uS2V5ZG93bihlKSkpO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgb25DbGljayhlKSB7XG4gICAgICAgIGNvbnN0IHRhcmdldFRhc2sgPSB0aGlzLnRhcmdldFRhc2soZS50YXJnZXQpO1xuICAgICAgICBpZiAodGFyZ2V0VGFzaykge1xuICAgICAgICAgICAgY29uc3QgeyB0YXNrLCBldmVudFRhcmdldCB9ID0gdGFyZ2V0VGFzaztcbiAgICAgICAgICAgIGNvbnN0IGV2ZW50VHlwZSA9IGUudHlwZTtcbiAgICAgICAgICAgIGNvbnN0IGlzU2luZ2xlID0gZXZlbnRUeXBlID09PSAnY2xpY2snO1xuICAgICAgICAgICAgY29uc3QgaXNEb3VibGUgPSBldmVudFR5cGUgPT09ICdkYmxjbGljayc7XG4gICAgICAgICAgICBpZiAoaXNTaW5nbGUgJiYgY2xvc2VzdEluU2NvcGUoZS50YXJnZXQsIG5vZGUgPT4gaGFzQ2xhc3Nlcyhub2RlLCAnay1ldmVudC1kZWxldGUnKSwgZXZlbnRUYXJnZXQpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy52aWV3U3RhdGUuZW1pdEV2ZW50KCdyZW1vdmUnLCB7IGV2ZW50OiB0YXNrLmV2ZW50LCBkYXRhSXRlbTogdGFzay5ldmVudC5kYXRhSXRlbSB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGNvbnN0IG5hbWUgPSBpc0RvdWJsZSA/ICdldmVudERibENsaWNrJyA6ICdldmVudENsaWNrJztcbiAgICAgICAgICAgICAgICB0aGlzLnZpZXdTdGF0ZS5lbWl0RXZlbnQobmFtZSwgeyB0eXBlOiBldmVudFR5cGUsIGV2ZW50OiB0YXNrLmV2ZW50LCBvcmlnaW5hbEV2ZW50OiBlIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIG9uS2V5ZG93bihlKSB7XG4gICAgICAgIGNvbnN0IHRhcmdldFRhc2sgPSB0aGlzLnRhcmdldFRhc2soZS50YXJnZXQpO1xuICAgICAgICBpZiAodGFyZ2V0VGFzaykge1xuICAgICAgICAgICAgY29uc3QgdGFzayA9IHRhcmdldFRhc2sudGFzaztcbiAgICAgICAgICAgIHRoaXMudmlld1N0YXRlLmVtaXRFdmVudCgnZXZlbnRLZXlkb3duJywgeyBldmVudDogdGFzay5ldmVudCwgZGF0YUl0ZW06IHRhc2suZXZlbnQuZGF0YUl0ZW0sIG9yaWdpbmFsRXZlbnQ6IGUgfSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgdGFyZ2V0VGFzayh0YXJnZXQpIHtcbiAgICAgICAgY29uc3QgZXZlbnRUYXJnZXQgPSBjbG9zZXN0SW5TY29wZSh0YXJnZXQsIG5vZGUgPT4gbm9kZS5oYXNBdHRyaWJ1dGUoJ2RhdGEtdGFzay1pbmRleCcpLCB0aGlzLmVsZW1lbnQubmF0aXZlRWxlbWVudCk7XG4gICAgICAgIGlmIChldmVudFRhcmdldCkge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBldmVudFRhcmdldCxcbiAgICAgICAgICAgICAgICB0YXNrOiB0aGlzLmVsZW1lbnRUYXNrKGV2ZW50VGFyZ2V0KVxuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgIH1cbiAgICB1cGRhdGVDb250ZW50SGVpZ2h0KCkge1xuICAgICAgICBjb25zdCBlbGVtZW50ID0gdGhpcy5lbGVtZW50Lm5hdGl2ZUVsZW1lbnQ7XG4gICAgICAgIGNvbnN0IHBhcmVudCA9IGVsZW1lbnQucGFyZW50Tm9kZTtcbiAgICAgICAgY29uc3QgY29udGVudCA9IHRoaXMuY29udGVudC5uYXRpdmVFbGVtZW50O1xuICAgICAgICB0aGlzLnJlbmRlcmVyLnNldFN0eWxlKGNvbnRlbnQsICdoZWlnaHQnLCAnJyk7XG4gICAgICAgIGxldCBoZWlnaHQgPSBwYXJlbnQuY2xpZW50SGVpZ2h0O1xuICAgICAgICBmb3IgKGxldCBpZHggPSAwOyBpZHggPCBwYXJlbnQuY2hpbGRyZW4ubGVuZ3RoOyBpZHgrKykge1xuICAgICAgICAgICAgY29uc3QgY2hpbGQgPSBwYXJlbnQuY2hpbGRyZW5baWR4XTtcbiAgICAgICAgICAgIGlmIChjaGlsZCAhPT0gZWxlbWVudCAmJiAhaWdub3JlQ29udGVudENoaWxkKGNoaWxkKSkge1xuICAgICAgICAgICAgICAgIGhlaWdodCAtPSBjaGlsZC5vZmZzZXRIZWlnaHQ7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgaGVhZGVyRWxlbWVudCA9IHRoaXMuaGVhZGVyV3JhcC5uYXRpdmVFbGVtZW50O1xuICAgICAgICBoZWlnaHQgLT0gdGhpcy5oZWFkZXJXcmFwID8gaGVhZGVyRWxlbWVudC5vZmZzZXRIZWlnaHQgOiAwO1xuICAgICAgICB0aGlzLnJlbmRlcmVyLnNldFN0eWxlKGNvbnRlbnQsICdoZWlnaHQnLCBgJHtoZWlnaHR9cHhgKTtcbiAgICAgICAgY29uc3QgcnRsID0gdGhpcy5sb2NhbGl6YXRpb24ucnRsO1xuICAgICAgICBjb25zdCBwYWRkaW5nID0gaGFzU2Nyb2xsYmFyKGNvbnRlbnQsICd2ZXJ0aWNhbCcpID8gc2Nyb2xsYmFyV2lkdGgoKSA6IDA7XG4gICAgICAgIHRoaXMucmVuZGVyZXIuc2V0U3R5bGUoaGVhZGVyRWxlbWVudCwgIXJ0bCA/ICdwYWRkaW5nLXJpZ2h0JyA6ICdwYWRkaW5nLWxlZnQnLCBgJHtwYWRkaW5nfXB4YCk7XG4gICAgICAgIHRoaXMucmVuZGVyZXIuc2V0U3R5bGUoaGVhZGVyRWxlbWVudCwgcnRsID8gJ3BhZGRpbmctcmlnaHQnIDogJ3BhZGRpbmctbGVmdCcsICcwcHgnKTtcbiAgICAgICAgdGhpcy52aWV3U3RhdGUubm90aWZ5TGF5b3V0RW5kKCk7XG4gICAgfVxuICAgIG5nT25EZXN0cm95KCkge1xuICAgICAgICB0aGlzLnN1YnMudW5zdWJzY3JpYmUoKTtcbiAgICB9XG4gICAgb3B0aW9uc0NoYW5nZShjaGFuZ2VzKSB7XG4gICAgICAgIHRoaXMuZ3JvdXAgPSBjaGFuZ2VzLmdyb3VwO1xuICAgICAgICB0aGlzLnJlc291cmNlcyA9IGNoYW5nZXMucmVzb3VyY2VzO1xuICAgICAgICB0aGlzLmdyb3VwUmVzb3VyY2VzKCk7XG4gICAgICAgIHRoaXMubWluID0gY2hhbmdlcy5taW47XG4gICAgICAgIHRoaXMubWF4ID0gY2hhbmdlcy5tYXg7XG4gICAgICAgIHRoaXMuZWRpdGFibGUgPSBjaGFuZ2VzLmVkaXRhYmxlO1xuICAgICAgICBpZiAodGhpcy5pdGVtcyAmJiB0aGlzLml0ZW1zLmxlbmd0aCkge1xuICAgICAgICAgICAgdGhpcy50YXNrcy5uZXh0KHRoaXMuY3JlYXRlRXZlbnRHcm91cHMoKSk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5zY2hlZHVsZXJFdmVudFRlbXBsYXRlID0gY2hhbmdlcy5ldmVudFRlbXBsYXRlO1xuICAgICAgICB0aGlzLnNjaGVkdWxlckFnZW5kYVRpbWVUZW1wbGF0ZSA9IGNoYW5nZXMuYWdlbmRhVGltZVRlbXBsYXRlO1xuICAgICAgICB0aGlzLnNjaGVkdWxlckFnZW5kYURhdGVUZW1wbGF0ZSA9IGNoYW5nZXMuYWdlbmRhRGF0ZVRlbXBsYXRlO1xuICAgIH1cbiAgICBvblNlbGVjdERhdGUoZGF0ZSkge1xuICAgICAgICB0aGlzLnNlbGVjdGVkRGF0ZSA9IGRhdGU7XG4gICAgICAgIHRoaXMudmlld1N0YXRlLm5vdGlmeURhdGVSYW5nZSh0aGlzLmRhdGVSYW5nZSgpKTtcbiAgICB9XG4gICAgb25BY3Rpb24oZSkge1xuICAgICAgICBjb25zdCBub3cgPSBnZXREYXRlKHRoaXMuc2VsZWN0ZWREYXRlKTtcbiAgICAgICAgaWYgKGUudHlwZSA9PT0gJ25leHQnKSB7XG4gICAgICAgICAgICBjb25zdCBuZXh0ID0gZ2V0RGF0ZShhZGREYXlzKG5vdywgdGhpcy5udW1iZXJPZkRheXMpKTtcbiAgICAgICAgICAgIGlmICh0aGlzLmlzSW5SYW5nZShuZXh0KSkge1xuICAgICAgICAgICAgICAgIHRoaXMudmlld1N0YXRlLm5vdGlmeU5leHREYXRlKG5leHQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmIChlLnR5cGUgPT09ICdwcmV2Jykge1xuICAgICAgICAgICAgY29uc3QgbmV4dCA9IGdldERhdGUoYWRkRGF5cyhub3csIC10aGlzLm51bWJlck9mRGF5cykpO1xuICAgICAgICAgICAgaWYgKHRoaXMuaXNJblJhbmdlKG5leHQpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy52aWV3U3RhdGUubm90aWZ5TmV4dERhdGUobmV4dCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgY3JlYXRlRXZlbnRHcm91cHMoKSB7XG4gICAgICAgIGNvbnN0IHJlc291cmNlR3JvdXBzID0gdGhpcy5ncm91cGVkUmVzb3VyY2VzLmxlbmd0aCA/IGNyZWF0ZVJlc291cmNlR3JvdXBzKHRoaXMuZ3JvdXBlZFJlc291cmNlcykgOiBudWxsO1xuICAgICAgICBjb25zdCBldmVudEdyb3VwcyA9IHRoaXMuZ3JvdXBzID0gZ3JvdXBFdmVudHModGhpcy5pdGVtcywge1xuICAgICAgICAgICAgdGFza1Jlc291cmNlczogdGhpcy50YXNrUmVzb3VyY2VzLFxuICAgICAgICAgICAgcmVzb3VyY2VHcm91cHMsXG4gICAgICAgICAgICBhbGxSZXNvdXJjZXM6IHRoaXMucmVzb3VyY2VzLFxuICAgICAgICAgICAgc3BhbnM6IHRoaXMuc3BhbnMsXG4gICAgICAgICAgICBkYXRlUmFuZ2U6IHRoaXMucmFuZ2VcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBldmVudEdyb3VwcztcbiAgICB9XG4gICAgZGF0ZVJhbmdlKGRhdGUgPSB0aGlzLnNlbGVjdGVkRGF0ZSkge1xuICAgICAgICBjb25zdCBzdGFydCA9IGdldERhdGUoZGF0ZSk7XG4gICAgICAgIGNvbnN0IGVuZCA9IGdldERhdGUoYWRkRGF5cyhzdGFydCwgdGhpcy5udW1iZXJPZkRheXMpKTtcbiAgICAgICAgY29uc3QgcmFuZ2VFbmQgPSBnZXREYXRlKGFkZERheXMoc3RhcnQsIHRoaXMubnVtYmVyT2ZEYXlzIC0gMSkpO1xuICAgICAgICBjb25zdCB0ZXh0ID0gdGhpcy5pbnRsLmZvcm1hdCh0aGlzLnNlbGVjdGVkRGF0ZUZvcm1hdCwgc3RhcnQsIHJhbmdlRW5kKTtcbiAgICAgICAgY29uc3Qgc2hvcnRUZXh0ID0gdGhpcy5pbnRsLmZvcm1hdCh0aGlzLnNlbGVjdGVkU2hvcnREYXRlRm9ybWF0LCBzdGFydCwgcmFuZ2VFbmQpO1xuICAgICAgICByZXR1cm4geyBzdGFydCwgZW5kLCB0ZXh0LCBzaG9ydFRleHQgfTtcbiAgICB9XG4gICAgZ3JvdXBSZXNvdXJjZXMoKSB7XG4gICAgICAgIGNvbnN0IHJlc291cmNlcyA9IHRoaXMucmVzb3VyY2VzIHx8IFtdO1xuICAgICAgICBjb25zdCBncm91cCA9IHRoaXMuZ3JvdXAgfHwge307XG4gICAgICAgIGNvbnN0IGdyb3VwZWQgPSBncm91cC5yZXNvdXJjZXM7XG4gICAgICAgIGNvbnN0IGdyb3VwZWRSZXNvdXJjZXMgPSB0aGlzLmdyb3VwZWRSZXNvdXJjZXMgPSBbXTtcbiAgICAgICAgaWYgKGdyb3VwZWQgJiYgZ3JvdXBlZC5sZW5ndGgpIHtcbiAgICAgICAgICAgIGZvciAobGV0IGdyb3VwSWR4ID0gMDsgZ3JvdXBJZHggPCBncm91cGVkLmxlbmd0aDsgZ3JvdXBJZHgrKykge1xuICAgICAgICAgICAgICAgIGNvbnN0IG5hbWUgPSBncm91cGVkW2dyb3VwSWR4XTtcbiAgICAgICAgICAgICAgICBjb25zdCByZXNvdXJjZSA9IHJlc291cmNlcy5maW5kKGl0ZW0gPT4gaXRlbS5uYW1lID09PSBuYW1lKTtcbiAgICAgICAgICAgICAgICBpZiAocmVzb3VyY2UpIHtcbiAgICAgICAgICAgICAgICAgICAgZ3JvdXBlZFJlc291cmNlcy5wdXNoKHJlc291cmNlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5zcGFucyA9IHRoaXMucmVzb3VyY2VTcGFucygpO1xuICAgIH1cbiAgICByZXNvdXJjZVNwYW5zKCkge1xuICAgICAgICBjb25zdCBzcGFucyA9IFsxXTtcbiAgICAgICAgY29uc3QgcmVzb3VyY2VzID0gdGhpcy5ncm91cGVkUmVzb3VyY2VzO1xuICAgICAgICBsZXQgc3BhbiA9IDE7XG4gICAgICAgIGZvciAobGV0IGlkeCA9IHJlc291cmNlcy5sZW5ndGggLSAxOyBpZHggPiAwOyBpZHgtLSkge1xuICAgICAgICAgICAgc3BhbiAqPSAoKHJlc291cmNlc1tpZHhdLmRhdGEgfHwgW10pLmxlbmd0aCB8fCAxKTtcbiAgICAgICAgICAgIHNwYW5zLnVuc2hpZnQoc3Bhbik7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHNwYW5zO1xuICAgIH1cbiAgICBnZXQgdGFza1Jlc291cmNlcygpIHtcbiAgICAgICAgaWYgKHRoaXMuZ3JvdXBlZFJlc291cmNlcy5sZW5ndGgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmdyb3VwZWRSZXNvdXJjZXM7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAodGhpcy5yZXNvdXJjZXMgJiYgdGhpcy5yZXNvdXJjZXMubGVuZ3RoKSB7XG4gICAgICAgICAgICByZXR1cm4gW3RoaXMucmVzb3VyY2VzWzBdXTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiBbe31dO1xuICAgICAgICB9XG4gICAgfVxuICAgIGlzSW5SYW5nZShkYXRlKSB7XG4gICAgICAgIGNvbnN0IGRhdGVSYW5nZSA9IHRoaXMuZGF0ZVJhbmdlKGRhdGUpO1xuICAgICAgICByZXR1cm4gKCF0aGlzLm1pbiB8fCB0aGlzLm1pbiA8IGRhdGVSYW5nZS5lbmQpICYmICghdGhpcy5tYXggfHwgZGF0ZVJhbmdlLnN0YXJ0IDw9IHRoaXMubWF4KTtcbiAgICB9XG4gICAgY3JlYXRlUERGRWxlbWVudCgpIHtcbiAgICAgICAgY29uc3QgZWxlbWVudCA9IHRoaXMuZWxlbWVudC5uYXRpdmVFbGVtZW50LmNsb25lTm9kZSh0cnVlKTtcbiAgICAgICAgZWxlbWVudC5zdHlsZS53aWR0aCA9IGAke3RoaXMuZWxlbWVudC5uYXRpdmVFbGVtZW50Lm9mZnNldFdpZHRofXB4YDtcbiAgICAgICAgZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuay1zY2hlZHVsZXItY29udGVudCcpLnN0eWxlLmhlaWdodCA9ICdhdXRvJztcbiAgICAgICAgY29uc3QgaGVhZGVyID0gZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuay1zY2hlZHVsZXItaGVhZGVyJyk7XG4gICAgICAgIGhlYWRlci5zdHlsZS5wYWRkaW5nUmlnaHQgPSAwO1xuICAgICAgICBoZWFkZXIuc3R5bGUucGFkZGluZ0xlZnQgPSAwO1xuICAgICAgICB0aGlzLnBkZlNlcnZpY2UuZWxlbWVudFJlYWR5LmVtaXQoe1xuICAgICAgICAgICAgZWxlbWVudDogZWxlbWVudFxuICAgICAgICB9KTtcbiAgICB9XG4gICAgZWxlbWVudFRhc2soZWxlbWVudCkge1xuICAgICAgICBjb25zdCBpbmRleCA9IHBhcnNlSW50KGVsZW1lbnQuZ2V0QXR0cmlidXRlKCdkYXRhLXRhc2staW5kZXgnKSwgMTApO1xuICAgICAgICBjb25zdCBncm91cEluZGV4ID0gcGFyc2VJbnQoZWxlbWVudC5nZXRBdHRyaWJ1dGUoJ2RhdGEtZ3JvdXAtaW5kZXgnKSwgMTApO1xuICAgICAgICBjb25zdCBncm91cCA9IHRoaXMuZ3JvdXBzW2dyb3VwSW5kZXhdO1xuICAgICAgICBjb25zdCB0YXNrID0gZ3JvdXAudGFza3MuaXRlbUF0KGluZGV4KTtcbiAgICAgICAgcmV0dXJuIHRhc2s7XG4gICAgfVxuICAgIGV4ZWN1dGUoZSkge1xuICAgICAgICBpZiAoZS5uYW1lID09PSAnc2xvdEJ5UG9zaXRpb24nKSB7XG4gICAgICAgICAgICBjb25zdCBzbG90ID0gdGhpcy5zbG90QnlQb3NpdGlvbihlLmFyZ3MpO1xuICAgICAgICAgICAgZS5yZXN1bHQoc2xvdCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoZS5uYW1lID09PSAnZXZlbnRGcm9tRWxlbWVudCcpIHtcbiAgICAgICAgICAgIGNvbnN0IHRhc2sgPSB0aGlzLmVsZW1lbnRUYXNrKGUuYXJncy5lbGVtZW50KTtcbiAgICAgICAgICAgIGlmICh0YXNrKSB7XG4gICAgICAgICAgICAgICAgZS5yZXN1bHQodGFzay5ldmVudCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgc2xvdEJ5UG9zaXRpb24oeyB4LCB5IH0pIHtcbiAgICAgICAgY29uc3QgY29udGVudFRhYmxlID0gdGhpcy5jb250ZW50Lm5hdGl2ZUVsZW1lbnQucXVlcnlTZWxlY3RvcigndGFibGUnKTtcbiAgICAgICAgY29uc3Qgb2Zmc2V0ID0gZWxlbWVudE9mZnNldChjb250ZW50VGFibGUpO1xuICAgICAgICBpZiAob2Zmc2V0LnRvcCA8PSB5ICYmIHkgPD0gb2Zmc2V0LnRvcCArIG9mZnNldC5oZWlnaHQpIHtcbiAgICAgICAgICAgIGNvbnN0IGNvbnRlbnRSb3dzID0gY29udGVudFRhYmxlLnJvd3M7XG4gICAgICAgICAgICBpZiAoIWNvbnRlbnRSb3dzLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnN0IHRhc2tPZmZzZXQgPSBlbGVtZW50T2Zmc2V0KGNvbnRlbnRSb3dzWzBdLmNlbGxzW2NvbnRlbnRSb3dzWzBdLmNlbGxzLmxlbmd0aCAtIDFdKTtcbiAgICAgICAgICAgIGlmICh0YXNrT2Zmc2V0LmxlZnQgPD0geCAmJiB4IDw9IHRhc2tPZmZzZXQubGVmdCArIHRhc2tPZmZzZXQud2lkdGgpIHtcbiAgICAgICAgICAgICAgICBmb3IgKGxldCBpZHggPSAwOyBpZHggPCBjb250ZW50Um93cy5sZW5ndGg7IGlkeCsrKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHJvdyA9IGNvbnRlbnRSb3dzW2lkeF07XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHJvd09mZnNldCA9IGVsZW1lbnRPZmZzZXQocm93KTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHJvd09mZnNldC50b3AgPD0geSAmJiB5IDw9IHJvd09mZnNldC50b3AgKyByb3dPZmZzZXQuaGVpZ2h0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBlbGVtZW50ID0gcm93LnF1ZXJ5U2VsZWN0b3IoJ1tkYXRhLXRhc2staW5kZXhdJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB0YXNrID0gdGhpcy5lbGVtZW50VGFzayhlbGVtZW50KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGV2ZW50ID0gdGFzay5ldmVudDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxlbWVudDogbmV3IEVsZW1lbnRSZWYoZWxlbWVudCksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhcnQ6IGV2ZW50LnN0YXJ0LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZDogZXZlbnQuZW5kLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV2ZW50OiBldmVudCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvdXJjZXM6IHRhc2sucmVzb3VyY2VzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlzQWxsRGF5OiB0YXNrLmlzQWxsRGF5XG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxufVxuQWdlbmRhVmlld0ludGVybmFsQ29tcG9uZW50LmRlY29yYXRvcnMgPSBbXG4gICAgeyB0eXBlOiBDb21wb25lbnQsIGFyZ3M6IFt7XG4gICAgICAgICAgICAgICAgLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOmNvbXBvbmVudC1zZWxlY3RvclxuICAgICAgICAgICAgICAgIHNlbGVjdG9yOiAnYWdlbmRhLXZpZXctaW50ZXJuYWwnLFxuICAgICAgICAgICAgICAgIHRlbXBsYXRlOiBgXG4gICAgICAgIDx0YWJsZSBjbGFzcz1cImstc2NoZWR1bGVyLWxheW91dCBrLXNjaGVkdWxlci1hZ2VuZGF2aWV3IGstc2NoZWR1bGVyLWFnZW5kYVwiPlxuICAgICAgICAgICAgPHRib2R5PlxuICAgICAgICAgICAgICAgIDx0cj5cbiAgICAgICAgICAgICAgICAgICAgPHRkPlxuICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBrZW5kb1NjaGVkdWxlckFnZW5kYUhlYWRlciBbcmVzb3VyY2VzXT1cImdyb3VwZWRSZXNvdXJjZXNcIiAjaGVhZGVyV3JhcD48L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgPC90ZD5cbiAgICAgICAgICAgICAgICA8L3RyPlxuICAgICAgICAgICAgICAgIDx0cj5cbiAgICAgICAgICAgICAgICAgICAgPHRkPlxuICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBrZW5kb1NjaGVkdWxlckFnZW5kYUxpc3QgI2NvbnRlbnRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbZWRpdGFibGVdPVwiZWRpdGFibGVcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFtldmVudFRlbXBsYXRlXT1cImV2ZW50VGVtcGxhdGVSZWZcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFtzbG90Q2xhc3NdPVwic2xvdENsYXNzXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbZXZlbnRDbGFzc109XCJldmVudENsYXNzXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbZXZlbnRTdHlsZXNdPVwiZXZlbnRTdHlsZXNcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFthZ2VuZGFUaW1lVGVtcGxhdGVdPVwiYWdlbmRhVGltZVRlbXBsYXRlUmVmXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbYWdlbmRhRGF0ZVRlbXBsYXRlXT1cImFnZW5kYURhdGVUZW1wbGF0ZVJlZlwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgW3Rhc2tzXT1cInRhc2tzIHwgYXN5bmNcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICA8L3RkPlxuICAgICAgICAgICAgICAgIDwvdHI+XG4gICAgICAgICAgICA8L3Rib2R5PlxuICAgICAgICA8L3RhYmxlPlxuICAgIGBcbiAgICAgICAgICAgIH0sXSB9LFxuXTtcbi8qKiBAbm9jb2xsYXBzZSAqL1xuQWdlbmRhVmlld0ludGVybmFsQ29tcG9uZW50LmN0b3JQYXJhbWV0ZXJzID0gKCkgPT4gW1xuICAgIHsgdHlwZTogVmlld0NvbnRleHRTZXJ2aWNlIH0sXG4gICAgeyB0eXBlOiBWaWV3U3RhdGVTZXJ2aWNlIH0sXG4gICAgeyB0eXBlOiBJbnRsU2VydmljZSB9LFxuICAgIHsgdHlwZTogUmVuZGVyZXIyIH0sXG4gICAgeyB0eXBlOiBFbGVtZW50UmVmIH0sXG4gICAgeyB0eXBlOiBOZ1pvbmUgfSxcbiAgICB7IHR5cGU6IFBERlNlcnZpY2UgfSxcbiAgICB7IHR5cGU6IExvY2FsaXphdGlvblNlcnZpY2UgfVxuXTtcbkFnZW5kYVZpZXdJbnRlcm5hbENvbXBvbmVudC5wcm9wRGVjb3JhdG9ycyA9IHtcbiAgICBldmVudFRlbXBsYXRlOiBbeyB0eXBlOiBJbnB1dCB9XSxcbiAgICBzbG90Q2xhc3M6IFt7IHR5cGU6IElucHV0IH1dLFxuICAgIGV2ZW50Q2xhc3M6IFt7IHR5cGU6IElucHV0IH1dLFxuICAgIGV2ZW50U3R5bGVzOiBbeyB0eXBlOiBJbnB1dCB9XSxcbiAgICBhZ2VuZGFUaW1lVGVtcGxhdGU6IFt7IHR5cGU6IElucHV0IH1dLFxuICAgIGFnZW5kYURhdGVUZW1wbGF0ZTogW3sgdHlwZTogSW5wdXQgfV0sXG4gICAgc2VsZWN0ZWREYXRlRm9ybWF0OiBbeyB0eXBlOiBJbnB1dCB9XSxcbiAgICBzZWxlY3RlZFNob3J0RGF0ZUZvcm1hdDogW3sgdHlwZTogSW5wdXQgfV0sXG4gICAgbnVtYmVyT2ZEYXlzOiBbeyB0eXBlOiBJbnB1dCB9XSxcbiAgICBoZWFkZXJXcmFwOiBbeyB0eXBlOiBWaWV3Q2hpbGQsIGFyZ3M6IFsnaGVhZGVyV3JhcCcsIHsgcmVhZDogRWxlbWVudFJlZiB9LF0gfV0sXG4gICAgY29udGVudDogW3sgdHlwZTogVmlld0NoaWxkLCBhcmdzOiBbJ2NvbnRlbnQnLCB7IHJlYWQ6IEVsZW1lbnRSZWYgfSxdIH1dXG59O1xuXG4vKipcbiAqIEBoaWRkZW5cbiAqL1xuY2xhc3MgU2hhcmVkTW9kdWxlIHtcbiAgICBzdGF0aWMgZXhwb3J0cygpIHtcbiAgICAgICAgcmV0dXJuIFtcbiAgICAgICAgICAgIEZvY3VzYWJsZURpcmVjdGl2ZVxuICAgICAgICBdO1xuICAgIH1cbn1cblNoYXJlZE1vZHVsZS5kZWNvcmF0b3JzID0gW1xuICAgIHsgdHlwZTogTmdNb2R1bGUsIGFyZ3M6IFt7XG4gICAgICAgICAgICAgICAgZGVjbGFyYXRpb25zOiBbXG4gICAgICAgICAgICAgICAgICAgIEZvY3VzYWJsZURpcmVjdGl2ZVxuICAgICAgICAgICAgICAgIF0sXG4gICAgICAgICAgICAgICAgZXhwb3J0czogW1xuICAgICAgICAgICAgICAgICAgICBGb2N1c2FibGVEaXJlY3RpdmVcbiAgICAgICAgICAgICAgICBdXG4gICAgICAgICAgICB9LF0gfSxcbl07XG5cbmNvbnN0IENPTVBPTkVOVFMgPSBbXG4gICAgQWdlbmRhSGVhZGVyQ29tcG9uZW50LFxuICAgIEFnZW5kYUhlYWRlckl0ZW1Db21wb25lbnQsXG4gICAgQWdlbmRhTGlzdENvbXBvbmVudCxcbiAgICBBZ2VuZGFUYXNrSXRlbUNvbXBvbmVudCxcbiAgICBBZ2VuZGFWaWV3Q29tcG9uZW50LFxuICAgIEFnZW5kYVZpZXdJbnRlcm5hbENvbXBvbmVudFxuXTtcbi8qKlxuICogQGhpZGRlblxuICovXG5jbGFzcyBBZ2VuZGFWaWV3TW9kdWxlIHtcbn1cbkFnZW5kYVZpZXdNb2R1bGUuZGVjb3JhdG9ycyA9IFtcbiAgICB7IHR5cGU6IE5nTW9kdWxlLCBhcmdzOiBbe1xuICAgICAgICAgICAgICAgIGltcG9ydHM6IFtDb21tb25Nb2R1bGUsIEludGxNb2R1bGUsIFNoYXJlZE1vZHVsZV0sXG4gICAgICAgICAgICAgICAgZXhwb3J0czogW0FnZW5kYVZpZXdDb21wb25lbnRdLFxuICAgICAgICAgICAgICAgIGRlY2xhcmF0aW9uczogW0NPTVBPTkVOVFNdXG4gICAgICAgICAgICB9LF0gfSxcbl07XG5cbi8qKlxuICogQGhpZGRlblxuICovXG5jbGFzcyBJdGVtTWFwIHtcbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgdGhpcy5jb3VudCA9IDA7XG4gICAgICAgIHRoaXMuaXRlbXMgPSB7fTtcbiAgICB9XG4gICAgZ2V0IGZpcnN0KCkge1xuICAgICAgICBpZiAodGhpcy5jb3VudCA+IDApIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLml0ZW1zW09iamVjdC5rZXlzKHRoaXMuaXRlbXMpWzBdXTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBnZXQgbGFzdCgpIHtcbiAgICAgICAgaWYgKHRoaXMuY291bnQgPiAwKSB7XG4gICAgICAgICAgICBjb25zdCBrZXlzID0gT2JqZWN0LmtleXModGhpcy5pdGVtcyk7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5pdGVtc1trZXlzW2tleXMubGVuZ3RoIC0gMV1dO1xuICAgICAgICB9XG4gICAgfVxuICAgIGFkZEl0ZW0oaW5kZXgsIGl0ZW0pIHtcbiAgICAgICAgaWYgKCF0aGlzLml0ZW1zW2luZGV4XSkge1xuICAgICAgICAgICAgdGhpcy5jb3VudCsrO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuaXRlbXNbaW5kZXhdID0gaXRlbTtcbiAgICB9XG4gICAgcmVtb3ZlSXRlbShpbmRleCwgaXRlbSkge1xuICAgICAgICBjb25zdCBjdXJyZW50ID0gdGhpcy5pdGVtc1tpbmRleF07XG4gICAgICAgIGlmIChjdXJyZW50ID09PSBpdGVtKSB7XG4gICAgICAgICAgICBkZWxldGUgdGhpcy5pdGVtc1tpbmRleF07XG4gICAgICAgICAgICB0aGlzLmNvdW50LS07XG4gICAgICAgIH1cbiAgICB9XG4gICAgdG9BcnJheSgpIHtcbiAgICAgICAgcmV0dXJuIE9iamVjdC5rZXlzKHRoaXMuaXRlbXMpLm1hcChpbmRleCA9PiB0aGlzLml0ZW1zW2luZGV4XSk7XG4gICAgfVxufVxuXG4vKipcbiAqIEBoaWRkZW5cbiAqL1xuY2xhc3MgQmFzZVNsb3RTZXJ2aWNlIHtcbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgdGhpcy5jb250YWluZXJTaXplID0gMDtcbiAgICAgICAgdGhpcy5zbG90c0NoYW5nZSA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcbiAgICAgICAgdGhpcy5ncm91cHMgPSBbXTtcbiAgICB9XG4gICAgcmVnaXN0ZXJJdGVtKGNvbXBvbmVudCkge1xuICAgICAgICBjb25zdCBncm91cCA9IHRoaXMuaXRlbUdyb3VwKGNvbXBvbmVudCk7XG4gICAgICAgIGdyb3VwLnJlZ2lzdGVySXRlbShjb21wb25lbnQpO1xuICAgIH1cbiAgICB1bnJlZ2lzdGVySXRlbShjb21wb25lbnQsIGlkKSB7XG4gICAgICAgIGlkID0gaWQgfHwge1xuICAgICAgICAgICAgaW5kZXg6IGNvbXBvbmVudC5pbmRleCxcbiAgICAgICAgICAgIHJlc291cmNlSW5kZXg6IGNvbXBvbmVudC5yZXNvdXJjZUluZGV4LFxuICAgICAgICAgICAgcmFuZ2VJbmRleDogY29tcG9uZW50LnJhbmdlSW5kZXhcbiAgICAgICAgfTtcbiAgICAgICAgY29uc3QgZ3JvdXAgPSB0aGlzLmdyb3Vwc1tpZC5yZXNvdXJjZUluZGV4XTtcbiAgICAgICAgaWYgKGdyb3VwKSB7XG4gICAgICAgICAgICBncm91cC51bnJlZ2lzdGVySXRlbShjb21wb25lbnQsIGlkKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZWdpc3RlclNsb3Qoc2xvdCkge1xuICAgICAgICBjb25zdCBncm91cCA9IHRoaXMuc2xvdEdyb3VwKHNsb3QpO1xuICAgICAgICBncm91cC5yZWdpc3RlclNsb3Qoc2xvdCk7XG4gICAgfVxuICAgIHVucmVnaXN0ZXJTbG90KHNsb3QpIHtcbiAgICAgICAgY29uc3QgZ3JvdXAgPSB0aGlzLmdyb3Vwc1tzbG90LmlkLnJlc291cmNlSW5kZXhdO1xuICAgICAgICBpZiAoZ3JvdXApIHtcbiAgICAgICAgICAgIGdyb3VwLnVucmVnaXN0ZXJTbG90KHNsb3QpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGludmFsaWRhdGUoKSB7XG4gICAgICAgIHRoaXMuY2xlYXJFbXB0eUdyb3VwcygpO1xuICAgICAgICB0aGlzLmNsZWFuUmFuZ2VzKCk7XG4gICAgICAgIHRoaXMuc2xvdHNDaGFuZ2UuZW1pdCgpO1xuICAgICAgICB0aGlzLmZvckVhY2hTbG90KHNsb3QgPT4ge1xuICAgICAgICAgICAgc2xvdC5pbnZhbGlkYXRlKCk7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBjbGVhblJhbmdlcygpIHtcbiAgICAgICAgdGhpcy5ncm91cHMuZm9yRWFjaChncm91cCA9PiB7XG4gICAgICAgICAgICBncm91cC5jbGVhblJhbmdlcygpO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgY2xlYXJFbXB0eUdyb3VwcygpIHtcbiAgICAgICAgY29uc3QgZ3JvdXBzID0gdGhpcy5ncm91cHM7XG4gICAgICAgIGxldCBpbmRleCA9IHRoaXMuZ3JvdXBzLmxlbmd0aCAtIDE7XG4gICAgICAgIHdoaWxlIChpbmRleCA+IDAgJiYgIWdyb3Vwc1tpbmRleF0uaGFzU2xvdHMpIHtcbiAgICAgICAgICAgIGdyb3Vwcy5zcGxpY2UoaW5kZXgsIDEpO1xuICAgICAgICAgICAgaW5kZXgtLTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBpdGVtR3JvdXAoaXRlbSkge1xuICAgICAgICBjb25zdCBpbmRleCA9IGl0ZW0ucmVzb3VyY2VJbmRleDtcbiAgICAgICAgaWYgKCF0aGlzLmdyb3Vwc1tpbmRleF0pIHtcbiAgICAgICAgICAgIHRoaXMuZ3JvdXBzW2luZGV4XSA9IHRoaXMuY3JlYXRlR3JvdXAoaW5kZXgpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLmdyb3Vwc1tpbmRleF07XG4gICAgfVxuICAgIHNsb3RHcm91cChzbG90KSB7XG4gICAgICAgIGNvbnN0IGluZGV4ID0gc2xvdC5pZC5yZXNvdXJjZUluZGV4O1xuICAgICAgICBpZiAoIXRoaXMuZ3JvdXBzW2luZGV4XSkge1xuICAgICAgICAgICAgdGhpcy5ncm91cHNbaW5kZXhdID0gdGhpcy5jcmVhdGVHcm91cChpbmRleCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXMuZ3JvdXBzW2luZGV4XTtcbiAgICB9XG59XG5cbi8qKiBAaGlkZGVuICovXG5jb25zdCBNSUROSUdIVF9JTlZBUklBTlQgPSBuZXcgRGF0ZSgxOTgwLCAwLCAxKTtcbi8qKiBAaGlkZGVuICovXG5jb25zdCBJTlZBUklBTlRfRU5EID0gbmV3IERhdGUoMTk4MCwgMCwgMik7XG4vKiogQGhpZGRlbiAqL1xuY29uc3QgTVNfUEVSX1NFQ09ORCA9IDEwMDA7XG4vKiogQGhpZGRlbiAqL1xuY29uc3QgTVNfUEVSX01JTlVURSA9IDYwICogTVNfUEVSX1NFQ09ORDtcbi8vcHJvYmFibHkgc2hvdWxkIGNhbGN1bGF0ZSB0aGlzXG4vKiogQGhpZGRlbiAqL1xuY29uc3QgQk9SREVSX1dJRFRIID0gMTtcbi8qKiBAaGlkZGVuICovXG5jb25zdCBERUZBVUxUX0VWRU5UX0hFSUdIVCA9IDI1O1xuXG4vL2JldHRlciB0cnkgdG8gbWVhc3VyZSB0aGlzIG9uZVxuY29uc3QgTU9SRV9CVVRUT05fSEVJR0hUID0gMTM7XG5jb25zdCBFVkVOVF9PRkZTRVQgPSAyO1xuLyoqXG4gKiBAaGlkZGVuXG4gKi9cbmNsYXNzIFNsb3RSYW5nZSB7XG4gICAgY29uc3RydWN0b3IoaW5kZXgpIHtcbiAgICAgICAgdGhpcy5pbmRleCA9IGluZGV4O1xuICAgICAgICB0aGlzLnNsb3RNYXAgPSBuZXcgSXRlbU1hcCgpO1xuICAgICAgICB0aGlzLml0ZW1NYXAgPSBuZXcgSXRlbU1hcCgpO1xuICAgIH1cbiAgICBnZXQgc2xvdHMoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnNsb3RNYXAudG9BcnJheSgpO1xuICAgIH1cbiAgICBnZXQgaXRlbXMoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLml0ZW1NYXAudG9BcnJheSgpO1xuICAgIH1cbiAgICBnZXQgc3RhcnQoKSB7XG4gICAgICAgIGNvbnN0IGZpcnN0ID0gdGhpcy5zbG90TWFwLmZpcnN0O1xuICAgICAgICBpZiAoIWZpcnN0KSB7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZmlyc3Quc3RhcnQ7XG4gICAgfVxuICAgIGdldCBlbmQoKSB7XG4gICAgICAgIGNvbnN0IGxhc3QgPSB0aGlzLnNsb3RNYXAubGFzdDtcbiAgICAgICAgaWYgKCFsYXN0KSB7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gYWRkVVRDRGF5cyhsYXN0LmVuZCwgMSk7XG4gICAgfVxuICAgIGdldCBoYXNTbG90cygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuc2xvdE1hcC5jb3VudCA+IDA7XG4gICAgfVxuICAgIGdldCBoYXNJdGVtcygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuaXRlbU1hcC5jb3VudCA+IDA7XG4gICAgfVxuICAgIGdldCBmaXJzdFNsb3QoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnNsb3RNYXAuZmlyc3Q7XG4gICAgfVxuICAgIGdldCBsYXN0U2xvdCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuc2xvdE1hcC5sYXN0O1xuICAgIH1cbiAgICBnZXQgcmVjdCgpIHtcbiAgICAgICAgY29uc3QgZmlyc3QgPSB0aGlzLmZpcnN0U2xvdC5yZWN0O1xuICAgICAgICBjb25zdCBsYXN0ID0gdGhpcy5sYXN0U2xvdC5yZWN0O1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgbGVmdDogZmlyc3QubGVmdCxcbiAgICAgICAgICAgIHRvcDogZmlyc3QudG9wLFxuICAgICAgICAgICAgd2lkdGg6IGxhc3QubGVmdCAtIGZpcnN0LmxlZnQgKyBsYXN0LndpZHRoLFxuICAgICAgICAgICAgaGVpZ2h0OiBsYXN0LnRvcCAtIGZpcnN0LnRvcCArIGxhc3QuaGVpZ2h0XG4gICAgICAgIH07XG4gICAgfVxuICAgIHJlZ2lzdGVySXRlbShjb21wb25lbnQpIHtcbiAgICAgICAgdGhpcy5pdGVtTWFwLmFkZEl0ZW0oY29tcG9uZW50Lml0ZW0uaW5kZXgsIGNvbXBvbmVudCk7XG4gICAgfVxuICAgIHVucmVnaXN0ZXJJdGVtKGNvbXBvbmVudCwgaW5kZXgpIHtcbiAgICAgICAgdGhpcy5pdGVtTWFwLnJlbW92ZUl0ZW0oaW5kZXgsIGNvbXBvbmVudCk7XG4gICAgfVxuICAgIHJlZ2lzdGVyU2xvdChzbG90KSB7XG4gICAgICAgIHRoaXMuc2xvdE1hcC5hZGRJdGVtKHNsb3QuaWQuaW5kZXgsIHNsb3QpO1xuICAgIH1cbiAgICB1bnJlZ2lzdGVyU2xvdChzbG90KSB7XG4gICAgICAgIHRoaXMuc2xvdE1hcC5yZW1vdmVJdGVtKHNsb3QuaWQuaW5kZXgsIHNsb3QpO1xuICAgIH1cbiAgICBsYXlvdXQoZXZlbnRIZWlnaHQpIHtcbiAgICAgICAgaWYgKCF0aGlzLmhhc0l0ZW1zKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgaXRlbXMgPSB0aGlzLml0ZW1zO1xuICAgICAgICBjb25zdCBzb3J0ZWQgPSBvcmRlckJ5KGl0ZW1zLCBbeyBmaWVsZDogXCJpdGVtLnN0YXJ0VGltZVwiLCBkaXI6IFwiYXNjXCIgfSwgeyBmaWVsZDogXCJpdGVtLmVuZFRpbWVcIiwgZGlyOiBcImRlc2NcIiB9XSk7XG4gICAgICAgIGNvbnN0IHNsb3RJdGVtcyA9IHt9O1xuICAgICAgICBjb25zdCBzbG90cyA9IHRoaXMuc2xvdHM7XG4gICAgICAgIHNvcnRlZC5mb3JFYWNoKGV2ZW50ID0+IHNsb3RzXG4gICAgICAgICAgICAuZmlsdGVyKHNsb3QgPT4gaW50ZXJzZWN0cyhldmVudC5pdGVtLnN0YXJ0VGltZSwgZXZlbnQuaXRlbS5lbmRUaW1lLCBzbG90LnN0YXJ0LCBzbG90LmVuZCkpXG4gICAgICAgICAgICAuZm9yRWFjaChzbG90ID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHZhbHVlID0gc2xvdEl0ZW1zW3Nsb3Qua2V5XSA9IHNsb3RJdGVtc1tzbG90LmtleV0gfHwgeyBldmVudHM6IFtdLCBoZWlnaHQ6IHNsb3QubGlua0hlaWdodCB9O1xuICAgICAgICAgICAgdmFsdWUuc2xvdCA9IHNsb3Q7XG4gICAgICAgICAgICBjb25zdCByZWN0ID0gc2xvdC5yZWN0O1xuICAgICAgICAgICAgY29uc3QgZGF0YSA9IGV2ZW50Lml0ZW0uZGF0YVtldmVudC5yZXNvdXJjZUluZGV4XTtcbiAgICAgICAgICAgIGRhdGEucm93SW5kZXggPSBmaW5kUm93SW5kZXgodmFsdWUuZXZlbnRzLCBkYXRhKTtcbiAgICAgICAgICAgIGlmICh2YWx1ZS5oZWlnaHQgKyBldmVudEhlaWdodCArIEVWRU5UX09GRlNFVCArIE1PUkVfQlVUVE9OX0hFSUdIVCA+IHJlY3QuaGVpZ2h0IHx8IGRhdGEuaGlkZGVuKSB7XG4gICAgICAgICAgICAgICAgZGF0YS5oaWRkZW4gPSB0cnVlO1xuICAgICAgICAgICAgICAgIHNsb3Quc2hvd01vcmUoeyB3aWR0aDogcmVjdC53aWR0aCwgbGVmdDogcmVjdC5sZWZ0LCB0b3A6IHJlY3QudG9wICsgc2xvdC5saW5rSGVpZ2h0ICsgKChkYXRhLnJvd0luZGV4KSAqIChldmVudEhlaWdodCArIEVWRU5UX09GRlNFVCkpIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdmFsdWUuZXZlbnRzW2RhdGEucm93SW5kZXhdID0gZXZlbnQ7XG4gICAgICAgICAgICAgICAgaWYgKCFldmVudC5yZWN0KSB7XG4gICAgICAgICAgICAgICAgICAgIGV2ZW50LnJlY3QgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0b3A6IHJlY3QudG9wICsgc2xvdC5saW5rSGVpZ2h0ICsgKGRhdGEucm93SW5kZXggKiAoZXZlbnRIZWlnaHQgKyBFVkVOVF9PRkZTRVQpKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGxlZnQ6IHJlY3QubGVmdCxcbiAgICAgICAgICAgICAgICAgICAgICAgIGhlaWdodDogZXZlbnRIZWlnaHQsXG4gICAgICAgICAgICAgICAgICAgICAgICB3aWR0aDogMFxuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBldmVudC5yZWN0LndpZHRoICs9IHJlY3Qud2lkdGggKyBCT1JERVJfV0lEVEg7XG4gICAgICAgICAgICAgICAgdmFsdWUuaGVpZ2h0ICs9IGV2ZW50SGVpZ2h0ICsgRVZFTlRfT0ZGU0VUO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KSk7XG4gICAgICAgIHNvcnRlZC5mb3JFYWNoKGV2ZW50ID0+IHtcbiAgICAgICAgICAgIGlmIChldmVudC5yZWN0KSB7XG4gICAgICAgICAgICAgICAgZXZlbnQucmVjdC53aWR0aCAtPSBCT1JERVJfV0lEVEg7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBldmVudC5yZWZsb3coKTtcbiAgICAgICAgfSk7XG4gICAgfVxufVxuLyoqXG4gKiBAaGlkZGVuXG4gKi9cbmNsYXNzIE1vbnRoUmVzb3VyY2VHcm91cCB7XG4gICAgY29uc3RydWN0b3IoaW5kZXgpIHtcbiAgICAgICAgdGhpcy5pbmRleCA9IGluZGV4O1xuICAgICAgICB0aGlzLmRheVJhbmdlcyA9IFtdO1xuICAgIH1cbiAgICBnZXQgaGFzU2xvdHMoKSB7XG4gICAgICAgIHJldHVybiBCb29sZWFuKHRoaXMuZGF5UmFuZ2VzLmZpbmQocmFuZ2UgPT4gcmFuZ2UgJiYgcmFuZ2UuaGFzU2xvdHMpKTtcbiAgICB9XG4gICAgcmVnaXN0ZXJTbG90KHNsb3QpIHtcbiAgICAgICAgY29uc3QgcmFuZ2UgPSB0aGlzLnNsb3RSYW5nZShzbG90KTtcbiAgICAgICAgcmFuZ2UucmVnaXN0ZXJTbG90KHNsb3QpO1xuICAgIH1cbiAgICB1bnJlZ2lzdGVyU2xvdChzbG90KSB7XG4gICAgICAgIGNvbnN0IHJhbmdlID0gdGhpcy5kYXlSYW5nZXNbc2xvdC5pZC5yYW5nZUluZGV4XTtcbiAgICAgICAgcmFuZ2UudW5yZWdpc3RlclNsb3Qoc2xvdCk7XG4gICAgICAgIGlmICghcmFuZ2UuaGFzU2xvdHMpIHtcbiAgICAgICAgICAgIGRlbGV0ZSB0aGlzLmRheVJhbmdlc1tzbG90LmlkLnJhbmdlSW5kZXhdO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJlZ2lzdGVySXRlbShjb21wb25lbnQpIHtcbiAgICAgICAgY29uc3QgcmFuZ2UgPSB0aGlzLmRheVJhbmdlc1tjb21wb25lbnQucmFuZ2VJbmRleF07XG4gICAgICAgIHJhbmdlLnJlZ2lzdGVySXRlbShjb21wb25lbnQpO1xuICAgIH1cbiAgICB1bnJlZ2lzdGVySXRlbShjb21wb25lbnQsIGlkKSB7XG4gICAgICAgIGNvbnN0IHJhbmdlID0gdGhpcy5kYXlSYW5nZXNbaWQucmFuZ2VJbmRleF07XG4gICAgICAgIGlmIChyYW5nZSkge1xuICAgICAgICAgICAgcmFuZ2UudW5yZWdpc3Rlckl0ZW0oY29tcG9uZW50LCBpZC5pbmRleCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc2xvdFJhbmdlKHNsb3QpIHtcbiAgICAgICAgY29uc3QgcmFuZ2VzID0gdGhpcy5kYXlSYW5nZXM7XG4gICAgICAgIGNvbnN0IHJhbmdlSW5kZXggPSBzbG90LmlkLnJhbmdlSW5kZXg7XG4gICAgICAgIGlmICghcmFuZ2VzW3JhbmdlSW5kZXhdKSB7XG4gICAgICAgICAgICByYW5nZXNbcmFuZ2VJbmRleF0gPSBuZXcgU2xvdFJhbmdlKHJhbmdlSW5kZXgpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByYW5nZXNbcmFuZ2VJbmRleF07XG4gICAgfVxuICAgIGZvckVhY2hSYW5nZShjYWxsYmFjaykge1xuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMuZGF5UmFuZ2VzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBjYWxsYmFjayh0aGlzLmRheVJhbmdlc1tpXSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgY2xlYW5SYW5nZXMoKSB7XG4gICAgICAgIHRoaXMuZGF5UmFuZ2VzID0gdGhpcy5kYXlSYW5nZXMuZmlsdGVyKHIgPT4gQm9vbGVhbihyKSk7XG4gICAgfVxufVxuLyoqXG4gKiBAaGlkZGVuXG4gKi9cbmNsYXNzIE1vbnRoU2xvdFNlcnZpY2UgZXh0ZW5kcyBCYXNlU2xvdFNlcnZpY2Uge1xuICAgIGxheW91dChldmVudEhlaWdodCkge1xuICAgICAgICB0aGlzLmdyb3Vwcy5mb3JFYWNoKChncm91cCkgPT4gZ3JvdXAuZm9yRWFjaFJhbmdlKHJhbmdlID0+IHJhbmdlLmxheW91dChldmVudEhlaWdodCkpKTtcbiAgICB9XG4gICAgc2xvdEJ5SW5kZXgoc2xvdEluZGV4KSB7XG4gICAgICAgIGNvbnN0IFtyZXNvdXJjZUluZGV4LCByYW5nZUluZGV4LCBpbmRleF0gPSBzbG90SW5kZXguc3BsaXQoJzonKS5tYXAocGFydCA9PiBwYXJzZUludChwYXJ0LCAxMCkpO1xuICAgICAgICByZXR1cm4gdGhpcy5ncm91cHNbcmVzb3VyY2VJbmRleF0uZGF5UmFuZ2VzW3JhbmdlSW5kZXhdLnNsb3RzW2luZGV4XTtcbiAgICB9XG4gICAgZm9yRWFjaFNsb3QoY2FsbGJhY2spIHtcbiAgICAgICAgdGhpcy5ncm91cHMuZm9yRWFjaCgoZ3JvdXApID0+IHtcbiAgICAgICAgICAgIGdyb3VwLmRheVJhbmdlcy5mb3JFYWNoKHJhbmdlID0+IHtcbiAgICAgICAgICAgICAgICByYW5nZS5zbG90cy5mb3JFYWNoKHNsb3QgPT4gY2FsbGJhY2soc2xvdCkpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBmb3JFYWNoSXRlbShjYWxsYmFjaykge1xuICAgICAgICB0aGlzLmdyb3Vwcy5mb3JFYWNoKChncm91cCkgPT4ge1xuICAgICAgICAgICAgZ3JvdXAuZGF5UmFuZ2VzLmZvckVhY2gocmFuZ2UgPT4ge1xuICAgICAgICAgICAgICAgIHJhbmdlLml0ZW1zLmZvckVhY2godmlld0l0ZW0gPT4gY2FsbGJhY2sodmlld0l0ZW0pKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgY3JlYXRlR3JvdXAoaW5kZXgpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBNb250aFJlc291cmNlR3JvdXAoaW5kZXgpO1xuICAgIH1cbiAgICBpbnZhbGlkYXRlKCkge1xuICAgICAgICBzdXBlci5pbnZhbGlkYXRlKCk7XG4gICAgICAgIHRoaXMuZm9yRWFjaEl0ZW0oKHZpZXdJdGVtKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBkYXRhID0gdmlld0l0ZW0uaXRlbS5kYXRhO1xuICAgICAgICAgICAgT2JqZWN0LmtleXMoZGF0YSkuZm9yRWFjaChyZXNvdXJjZUluZGV4ID0+IHtcbiAgICAgICAgICAgICAgICBkYXRhW3Jlc291cmNlSW5kZXhdLmhpZGRlbiA9IGZhbHNlO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBzbG90QnlQb3NpdGlvbih4LCB5KSB7XG4gICAgICAgIGxldCByYW5nZTtcbiAgICAgICAgdGhpcy5ncm91cHMuZmluZCgoZ3JvdXApID0+IHtcbiAgICAgICAgICAgIHJhbmdlID0gZ3JvdXAuZGF5UmFuZ2VzLmZpbmQociA9PiByZWN0Q29udGFpbnMoci5yZWN0LCB4LCB5KSk7XG4gICAgICAgICAgICByZXR1cm4gcmFuZ2U7XG4gICAgICAgIH0pO1xuICAgICAgICBpZiAocmFuZ2UpIHtcbiAgICAgICAgICAgIHJldHVybiByYW5nZS5zbG90cy5maW5kKHNsb3QgPT4gcmVjdENvbnRhaW5zKHNsb3QucmVjdCwgeCwgeSkpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGRyYWdSYW5nZXMoY3VycmVudFNsb3QsIG9mZnNldCkge1xuICAgICAgICBjb25zdCBzdGFydCA9IG5ldyBEYXRlKGN1cnJlbnRTbG90LnN0YXJ0LmdldFRpbWUoKSAtIG9mZnNldC5zdGFydCk7XG4gICAgICAgIGNvbnN0IGVuZCA9IG5ldyBEYXRlKGN1cnJlbnRTbG90LnN0YXJ0LmdldFRpbWUoKSArIG9mZnNldC5lbmQpO1xuICAgICAgICBjb25zdCBncm91cCA9IHRoaXMuZ3JvdXBzW2N1cnJlbnRTbG90LmlkLnJlc291cmNlSW5kZXhdO1xuICAgICAgICBjb25zdCByYW5nZXMgPSBbXTtcbiAgICAgICAgZ3JvdXAuZGF5UmFuZ2VzLmZvckVhY2gocmFuZ2UgPT4ge1xuICAgICAgICAgICAgY29uc3Qgc2xvdHMgPSByYW5nZS5zbG90cy5maWx0ZXIocyA9PiBpbnRlcnNlY3RzKHN0YXJ0LCBlbmQsIHMuc3RhcnQsIHMuZW5kKSk7XG4gICAgICAgICAgICBpZiAoc2xvdHMubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgcmFuZ2VzLnB1c2goc2xvdHMpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHN0YXJ0LFxuICAgICAgICAgICAgZW5kLFxuICAgICAgICAgICAgcmFuZ2VzXG4gICAgICAgIH07XG4gICAgfVxuICAgIGdyb3VwU2xvdEJ5UG9zaXRpb24oY3VycmVudFNsb3QsIHgsIHkpIHtcbiAgICAgICAgY29uc3QgcmFuZ2UgPSB0aGlzLmdyb3Vwc1tjdXJyZW50U2xvdC5pZC5yZXNvdXJjZUluZGV4XS5kYXlSYW5nZXMuZmluZChyID0+IHJlY3RDb250YWlucyhyLnJlY3QsIHgsIHkpKTtcbiAgICAgICAgaWYgKHJhbmdlKSB7XG4gICAgICAgICAgICByZXR1cm4gcmFuZ2Uuc2xvdHMuZmluZChzbG90ID0+IHJlY3RDb250YWlucyhzbG90LnJlY3QsIHgsIHkpKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXNpemVSYW5nZXMoY3VycmVudFNsb3QsIHRhc2ssIHJlc2l6ZVN0YXJ0LCBvZmZzZXQpIHtcbiAgICAgICAgY29uc3QgZ3JvdXAgPSB0aGlzLmdyb3Vwc1t0YXNrLnJlc291cmNlc1swXS5sZWFmSWR4XTtcbiAgICAgICAgY29uc3QgcmFuZ2VzID0gW107XG4gICAgICAgIGNvbnN0IHN0YXJ0RGF0ZSA9IHRhc2suc3RhcnQudG9VVENEYXRlKCk7XG4gICAgICAgIGNvbnN0IGVuZERhdGUgPSB0YXNrLmVuZC50b1VUQ0RhdGUoKTtcbiAgICAgICAgbGV0IHN0YXJ0LCBlbmQ7XG4gICAgICAgIGlmIChyZXNpemVTdGFydCkge1xuICAgICAgICAgICAgc3RhcnQgPSBjdXJyZW50U2xvdC5zdGFydC5nZXRUaW1lKCkgKyBvZmZzZXQuc3RhcnQ7XG4gICAgICAgICAgICBpZiAoc3RhcnQgPiBlbmREYXRlLmdldFRpbWUoKSkge1xuICAgICAgICAgICAgICAgIHN0YXJ0ID0gbmV3IERhdGUoTWF0aC5taW4oZGF0ZVdpdGhUaW1lKGVuZERhdGUsIHN0YXJ0RGF0ZSkuZ2V0VGltZSgpLCBlbmREYXRlLmdldFRpbWUoKSkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZW5kID0gZW5kRGF0ZTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHN0YXJ0ID0gc3RhcnREYXRlO1xuICAgICAgICAgICAgZW5kID0gY3VycmVudFNsb3Quc3RhcnQuZ2V0VGltZSgpICsgb2Zmc2V0LmVuZDtcbiAgICAgICAgICAgIGlmIChlbmQgPCBzdGFydC5nZXRUaW1lKCkpIHtcbiAgICAgICAgICAgICAgICBlbmQgPSBuZXcgRGF0ZShNYXRoLm1heChkYXRlV2l0aFRpbWUoc3RhcnREYXRlLCBlbmREYXRlKS5nZXRUaW1lKCksIHN0YXJ0LmdldFRpbWUoKSkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGdyb3VwLmRheVJhbmdlcy5mb3JFYWNoKHJhbmdlID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHNsb3RzID0gcmFuZ2Uuc2xvdHMuZmlsdGVyKHMgPT4gaW50ZXJzZWN0cyhzdGFydCwgZW5kLCBzLnN0YXJ0LCBzLmVuZCkpO1xuICAgICAgICAgICAgaWYgKHNsb3RzLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgIHJhbmdlcy5wdXNoKHNsb3RzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBzdGFydDogbmV3IERhdGUoc3RhcnQpLFxuICAgICAgICAgICAgZW5kOiBuZXcgRGF0ZShlbmQpLFxuICAgICAgICAgICAgcmFuZ2VzOiByYW5nZXNcbiAgICAgICAgfTtcbiAgICB9XG59XG5cbi8qKlxuICogQGhpZGRlblxuICovXG5jbGFzcyBCYXNlVmlld0l0ZW0ge1xuICAgIGNvbnN0cnVjdG9yKHNsb3RTZXJ2aWNlLCBsb2NhbGl6YXRpb24sIGZvY3VzU2VydmljZSwgZWxlbWVudCwgcmVuZGVyZXIsIGxvY2FsZUlkKSB7XG4gICAgICAgIHRoaXMuc2xvdFNlcnZpY2UgPSBzbG90U2VydmljZTtcbiAgICAgICAgdGhpcy5sb2NhbGl6YXRpb24gPSBsb2NhbGl6YXRpb247XG4gICAgICAgIHRoaXMuZm9jdXNTZXJ2aWNlID0gZm9jdXNTZXJ2aWNlO1xuICAgICAgICB0aGlzLmVsZW1lbnQgPSBlbGVtZW50O1xuICAgICAgICB0aGlzLnJlbmRlcmVyID0gcmVuZGVyZXI7XG4gICAgICAgIHRoaXMubG9jYWxlSWQgPSBsb2NhbGVJZDtcbiAgICAgICAgdGhpcy5jbGFzc05hbWUgPSB0cnVlO1xuICAgICAgICB0aGlzLnN1YnMgPSBuZXcgU3Vic2NyaXB0aW9uKCk7XG4gICAgfVxuICAgIGdldCB0YXNrSW5kZXgoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLml0ZW0uaW5kZXg7XG4gICAgfVxuICAgIGdldCB0b3VjaEFjdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZWRpdGFibGUgJiYgdGhpcy5lZGl0YWJsZS5kcmFnICE9PSBmYWxzZSA/ICdub25lJyA6IG51bGw7XG4gICAgfVxuICAgIGdldCBldmVudFRpdGxlKCkge1xuICAgICAgICBjb25zdCBzdGFydFRpbWUgPSB0b0xvY2FsRGF0ZSh0aGlzLml0ZW0uc3RhcnRUaW1lKTtcbiAgICAgICAgY29uc3QgZW5kVGltZSA9IHRvTG9jYWxEYXRlKHRoaXMuaXRlbS5lbmRUaW1lKTtcbiAgICAgICAgY29uc3QgdGltZSA9IGZvcm1hdEV2ZW50VGltZShzdGFydFRpbWUsIGVuZFRpbWUsIHRoaXMuaXRlbS5pc0FsbERheSwgdGhpcy5sb2NhbGVJZCk7XG4gICAgICAgIHJldHVybiBgJHt0aW1lfSwgJHt0aGlzLml0ZW0uZXZlbnQudGl0bGV9YDtcbiAgICB9XG4gICAgZ2V0IGRlbGV0ZU1lc3NhZ2UoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmxvY2FsaXphdGlvbi5nZXQoJ2RlbGV0ZVRpdGxlJyk7XG4gICAgfVxuICAgIGdldCByZXNpemFibGUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmVkaXRhYmxlICYmIHRoaXMuZWRpdGFibGUucmVzaXplICE9PSBmYWxzZTtcbiAgICB9XG4gICAgZ2V0IHJlbW92YWJsZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZWRpdGFibGUgJiYgdGhpcy5lZGl0YWJsZS5yZW1vdmUgIT09IGZhbHNlO1xuICAgIH1cbiAgICBnZXQgaXNSZWN1cnJlbmNlKCkge1xuICAgICAgICByZXR1cm4gaXNSZWN1cnJlbmNlKHRoaXMuaXRlbSk7XG4gICAgfVxuICAgIGdldCBpc1JlY3VycmVuY2VFeGNlcHRpb24oKSB7XG4gICAgICAgIHJldHVybiBpc1JlY3VycmVuY2VFeGNlcHRpb24odGhpcy5pdGVtKTtcbiAgICB9XG4gICAgZ2V0IG5hdGl2ZUVsZW1lbnQoKSB7XG4gICAgICAgIGlmICh0aGlzLmVsZW1lbnQpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmVsZW1lbnQubmF0aXZlRWxlbWVudDtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzZXRTdHlsZXMoc3R5bGVzKSB7XG4gICAgICAgIGNvbnN0IGVsZW1lbnQgPSB0aGlzLm5hdGl2ZUVsZW1lbnQ7XG4gICAgICAgIGlmIChlbGVtZW50KSB7XG4gICAgICAgICAgICBmb3IgKGxldCBuYW1lIGluIHN0eWxlcykge1xuICAgICAgICAgICAgICAgIGlmIChzdHlsZXMuaGFzT3duUHJvcGVydHkobmFtZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5yZW5kZXJlci5zZXRTdHlsZShlbGVtZW50LCBuYW1lLCBzdHlsZXNbbmFtZV0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICB0b2dnbGUodmlzaWJsZSkge1xuICAgICAgICB0aGlzLnNldFN0eWxlcyh7IGRpc3BsYXk6IHZpc2libGUgPyAnYmxvY2snIDogJ25vbmUnIH0pO1xuICAgIH1cbiAgICByZWZsb3coKSB7XG4gICAgICAgIGNvbnN0IHJlY3QgPSB0aGlzLnJlY3Q7XG4gICAgICAgIGlmIChyZWN0KSB7XG4gICAgICAgICAgICB0aGlzLnNldFN0eWxlcyh7XG4gICAgICAgICAgICAgICAgbGVmdDogIXRoaXMubG9jYWxpemF0aW9uLnJ0bCA/IGAke3JlY3QubGVmdH1weGAgOiAnJyxcbiAgICAgICAgICAgICAgICByaWdodDogdGhpcy5sb2NhbGl6YXRpb24ucnRsID8gYCR7cmVjdC5sZWZ0fXB4YCA6ICcnLFxuICAgICAgICAgICAgICAgIHRvcDogYCR7cmVjdC50b3B9cHhgLFxuICAgICAgICAgICAgICAgIHdpZHRoOiBgJHtyZWN0LndpZHRofXB4YCxcbiAgICAgICAgICAgICAgICBoZWlnaHQ6IGAke3JlY3QuaGVpZ2h0fXB4YCxcbiAgICAgICAgICAgICAgICBkaXNwbGF5OiAnYmxvY2snXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBuZ09uSW5pdCgpIHtcbiAgICAgICAgaWYgKHRoaXMuZHJhZ0hpbnQpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnN1YnMuYWRkKHRoaXMuc2xvdFNlcnZpY2Uuc2xvdHNDaGFuZ2Uuc3Vic2NyaWJlKCgpID0+IHtcbiAgICAgICAgICAgIHRoaXMucmVjdCA9IG51bGw7XG4gICAgICAgICAgICB0aGlzLnNldFN0eWxlcyh7XG4gICAgICAgICAgICAgICAgZGlzcGxheTogJ25vbmUnLFxuICAgICAgICAgICAgICAgIHdpZHRoOiAwLFxuICAgICAgICAgICAgICAgIGxlZnQ6IDBcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgY29uc3Qgc2xvdElkID0geyBpbmRleDogdGhpcy5pbmRleCwgcmVzb3VyY2VJbmRleDogdGhpcy5yZXNvdXJjZUluZGV4LCByYW5nZUluZGV4OiB0aGlzLnJhbmdlSW5kZXggfTtcbiAgICAgICAgICAgIHRoaXMuc2xvdFNlcnZpY2UudW5yZWdpc3Rlckl0ZW0odGhpcywgc2xvdElkKTtcbiAgICAgICAgICAgIGlmICh0aGlzLnJlc291cmNlSW5kZXggPj0gMCkge1xuICAgICAgICAgICAgICAgIHRoaXMuc2xvdFNlcnZpY2UucmVnaXN0ZXJJdGVtKHRoaXMpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIG5nT25DaGFuZ2VzKGNoYW5nZXMpIHtcbiAgICAgICAgaWYgKHRoaXMuZHJhZ0hpbnQpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBpZiAoYW55Q2hhbmdlZChbJ2luZGV4JywgJ3Jlc291cmNlSW5kZXgnLCAncmFuZ2VJbmRleCddLCBjaGFuZ2VzKSkge1xuICAgICAgICAgICAgY29uc3QgeyByZXNvdXJjZUluZGV4LCBpbmRleCwgcmFuZ2VJbmRleCB9ID0gY2hhbmdlcztcbiAgICAgICAgICAgIGNvbnN0IHByZXZpb3VzUmVzb3VyY2VJbmRleCA9IHJlc291cmNlSW5kZXggPyByZXNvdXJjZUluZGV4LnByZXZpb3VzVmFsdWUgOiB0aGlzLnJlc291cmNlSW5kZXg7XG4gICAgICAgICAgICBjb25zdCBwcmV2aW91c0luZGV4ID0gaW5kZXggPyBpbmRleC5wcmV2aW91c1ZhbHVlIDogdGhpcy5pbmRleDtcbiAgICAgICAgICAgIGNvbnN0IHByZXZpb3VzUmFuZ2VJbmRleCA9IHJhbmdlSW5kZXggPyByYW5nZUluZGV4LnByZXZpb3VzVmFsdWUgOiB0aGlzLnJhbmdlSW5kZXg7XG4gICAgICAgICAgICBjb25zdCBzbG90SWQgPSB7XG4gICAgICAgICAgICAgICAgaW5kZXg6IHByZXZpb3VzSW5kZXgsXG4gICAgICAgICAgICAgICAgcmVzb3VyY2VJbmRleDogcHJldmlvdXNSZXNvdXJjZUluZGV4LFxuICAgICAgICAgICAgICAgIHJhbmdlSW5kZXg6IHByZXZpb3VzUmFuZ2VJbmRleFxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHRoaXMuc2xvdFNlcnZpY2UudW5yZWdpc3Rlckl0ZW0odGhpcywgc2xvdElkKTtcbiAgICAgICAgICAgIGlmICh0aGlzLnJlc291cmNlSW5kZXggPj0gMCkge1xuICAgICAgICAgICAgICAgIHRoaXMuc2xvdFNlcnZpY2UucmVnaXN0ZXJJdGVtKHRoaXMpO1xuICAgICAgICAgICAgICAgIHRoaXMudG9nZ2xlKHRydWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy50b2dnbGUoZmFsc2UpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIG5nT25EZXN0cm95KCkge1xuICAgICAgICBpZiAodGhpcy5kcmFnSGludCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuc2xvdFNlcnZpY2UudW5yZWdpc3Rlckl0ZW0odGhpcyk7XG4gICAgICAgIHRoaXMuc3Vicy51bnN1YnNjcmliZSgpO1xuICAgIH1cbn1cbkJhc2VWaWV3SXRlbS5wcm9wRGVjb3JhdG9ycyA9IHtcbiAgICBpdGVtOiBbeyB0eXBlOiBJbnB1dCB9XSxcbiAgICByZXNvdXJjZUluZGV4OiBbeyB0eXBlOiBJbnB1dCB9XSxcbiAgICByYW5nZUluZGV4OiBbeyB0eXBlOiBJbnB1dCB9XSxcbiAgICBpbmRleDogW3sgdHlwZTogSW5wdXQgfV0sXG4gICAgZXZlbnRUZW1wbGF0ZTogW3sgdHlwZTogSW5wdXQgfV0sXG4gICAgZWRpdGFibGU6IFt7IHR5cGU6IElucHV0IH1dLFxuICAgIGRyYWdIaW50OiBbeyB0eXBlOiBJbnB1dCB9XSxcbiAgICByZXNvdXJjZXM6IFt7IHR5cGU6IElucHV0IH1dLFxuICAgIGNsYXNzTmFtZTogW3sgdHlwZTogSG9zdEJpbmRpbmcsIGFyZ3M6IFsnY2xhc3Muay1ldmVudCcsXSB9XSxcbiAgICB0YXNrSW5kZXg6IFt7IHR5cGU6IEhvc3RCaW5kaW5nLCBhcmdzOiBbJ2F0dHIuZGF0YS10YXNrLWluZGV4JyxdIH1dLFxuICAgIHRvdWNoQWN0aW9uOiBbeyB0eXBlOiBIb3N0QmluZGluZywgYXJnczogWydzdHlsZS50b3VjaC1hY3Rpb24nLF0gfV0sXG4gICAgZXZlbnRUaXRsZTogW3sgdHlwZTogSG9zdEJpbmRpbmcsIGFyZ3M6IFsnYXR0ci5hcmlhLWxhYmVsJyxdIH1dXG59O1xuXG4vKipcbiAqIEBoaWRkZW5cbiAqL1xuY2xhc3MgTW9udGhWaWV3SXRlbUNvbXBvbmVudCBleHRlbmRzIEJhc2VWaWV3SXRlbSB7XG4gICAgY29uc3RydWN0b3Ioc2xvdFNlcnZpY2UsIGxvY2FsaXphdGlvbiwgZm9jdXNTZXJ2aWNlLCBlbGVtZW50LCByZW5kZXJlciwgbG9jYWxlSWQpIHtcbiAgICAgICAgc3VwZXIoc2xvdFNlcnZpY2UsIGxvY2FsaXphdGlvbiwgZm9jdXNTZXJ2aWNlLCBlbGVtZW50LCByZW5kZXJlciwgbG9jYWxlSWQpO1xuICAgICAgICB0aGlzLmxvY2FsZUlkID0gbG9jYWxlSWQ7XG4gICAgfVxuICAgIHJlZmxvdygpIHtcbiAgICAgICAgaWYgKHRoaXMuaXRlbS5kYXRhW3RoaXMucmVzb3VyY2VJbmRleF0uaGlkZGVuKSB7XG4gICAgICAgICAgICB0aGlzLnRvZ2dsZShmYWxzZSk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgc3VwZXIucmVmbG93KCk7XG4gICAgfVxufVxuTW9udGhWaWV3SXRlbUNvbXBvbmVudC5kZWNvcmF0b3JzID0gW1xuICAgIHsgdHlwZTogQ29tcG9uZW50LCBhcmdzOiBbe1xuICAgICAgICAgICAgICAgIC8vIHRzbGludDpkaXNhYmxlLW5leHQtbGluZTpjb21wb25lbnQtc2VsZWN0b3JcbiAgICAgICAgICAgICAgICBzZWxlY3RvcjogJ1ttb250aFZpZXdJdGVtXScsXG4gICAgICAgICAgICAgICAgdGVtcGxhdGU6IGBcbiAgICAgICAgPHNwYW4gY2xhc3M9XCJrLWV2ZW50LWFjdGlvbnNcIj5cbiAgICAgICAgICAgIDxzcGFuIGNsYXNzPVwiay1pY29uIGstaS1hcnJvdy02MC1sZWZ0XCIgKm5nSWY9XCJpdGVtLnRhaWxcIj48L3NwYW4+XG4gICAgICAgICAgICA8c3BhbiBjbGFzcz1cImstaWNvbiBrLWktcmVsb2FkXCIgKm5nSWY9XCJpc1JlY3VycmVuY2VcIj48L3NwYW4+XG4gICAgICAgICAgICA8c3BhbiBjbGFzcz1cImstaWNvbiBrLWktbm9uLXJlY3VycmVuY2VcIiAqbmdJZj1cImlzUmVjdXJyZW5jZUV4Y2VwdGlvblwiPjwvc3Bhbj5cbiAgICAgICAgPC9zcGFuPlxuICAgICAgICA8bmctY29udGFpbmVyICpuZ0lmPVwiZXZlbnRUZW1wbGF0ZVwiIFtuZ1RlbXBsYXRlT3V0bGV0XT1cImV2ZW50VGVtcGxhdGVcIlxuICAgICAgICAgICAgW25nVGVtcGxhdGVPdXRsZXRDb250ZXh0XT1cInsgJGltcGxpY2l0OiBpdGVtLmV2ZW50LCBldmVudDogaXRlbS5ldmVudCwgcmVzb3VyY2VzOiByZXNvdXJjZXMgfVwiPlxuICAgICAgICA8L25nLWNvbnRhaW5lcj5cbiAgICAgICAgPGRpdiAqbmdJZj1cIiFldmVudFRlbXBsYXRlXCIgW2F0dHIudGl0bGVdPVwiZXZlbnRUaXRsZVwiPlxuICAgICAgICAgICAgPGRpdiBjbGFzcz1cImstZXZlbnQtdGVtcGxhdGVcIj57eyBpdGVtLmV2ZW50LnRpdGxlIH19PC9kaXY+XG4gICAgICAgIDwvZGl2PlxuXG4gICAgICAgIDxzcGFuIGNsYXNzPVwiay1ldmVudC1hY3Rpb25zXCI+XG4gICAgICAgICAgICA8c3BhbiAqbmdJZj1cInJlbW92YWJsZVwiIGNsYXNzPVwiay1saW5rIGstZXZlbnQtZGVsZXRlXCIgYXJpYS1oaWRkZW49XCJ0cnVlXCIgW2F0dHIudGl0bGVdPVwiZGVsZXRlTWVzc2FnZVwiPlxuICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzPVwiay1pY29uIGstaS1jbG9zZVwiPjwvc3Bhbj5cbiAgICAgICAgICAgIDwvc3Bhbj5cbiAgICAgICAgICAgIDxzcGFuIGNsYXNzPVwiay1pY29uIGstaS1hcnJvdy02MC1yaWdodFwiICpuZ0lmPVwiaXRlbS5oZWFkXCI+PC9zcGFuPlxuICAgICAgICA8L3NwYW4+XG5cbiAgICAgICAgPG5nLWNvbnRhaW5lciAqbmdJZj1cInJlc2l6YWJsZVwiPlxuICAgICAgICAgICAgPHNwYW4gY2xhc3M9XCJrLXJlc2l6ZS1oYW5kbGUgay1yZXNpemUtd1wiPjwvc3Bhbj5cbiAgICAgICAgICAgIDxzcGFuIGNsYXNzPVwiay1yZXNpemUtaGFuZGxlIGstcmVzaXplLWVcIj48L3NwYW4+XG4gICAgICAgIDwvbmctY29udGFpbmVyPlxuICAgIGBcbiAgICAgICAgICAgIH0sXSB9LFxuXTtcbi8qKiBAbm9jb2xsYXBzZSAqL1xuTW9udGhWaWV3SXRlbUNvbXBvbmVudC5jdG9yUGFyYW1ldGVycyA9ICgpID0+IFtcbiAgICB7IHR5cGU6IE1vbnRoU2xvdFNlcnZpY2UgfSxcbiAgICB7IHR5cGU6IExvY2FsaXphdGlvblNlcnZpY2UgfSxcbiAgICB7IHR5cGU6IEZvY3VzU2VydmljZSB9LFxuICAgIHsgdHlwZTogRWxlbWVudFJlZiB9LFxuICAgIHsgdHlwZTogUmVuZGVyZXIyIH0sXG4gICAgeyB0eXBlOiBTdHJpbmcsIGRlY29yYXRvcnM6IFt7IHR5cGU6IEluamVjdCwgYXJnczogW0xPQ0FMRV9JRCxdIH1dIH1cbl07XG5cbi8qKlxuICogVGhlIGNvbXBvbmVudCBmb3IgcmVuZGVyaW5nIHRoZSAqKk1vbnRoKiogdmlldy5cbiAqL1xuY2xhc3MgTW9udGhWaWV3Q29tcG9uZW50IGV4dGVuZHMgQ29uZmlndXJhdGlvblZpZXdCYXNlIHtcbiAgICBjb25zdHJ1Y3Rvcihsb2NhbGl6YXRpb24sIGNoYW5nZURldGVjdG9yLCB2aWV3Q29udGV4dCwgdmlld1N0YXRlKSB7XG4gICAgICAgIHN1cGVyKGxvY2FsaXphdGlvbiwgY2hhbmdlRGV0ZWN0b3IsIHZpZXdDb250ZXh0LCB2aWV3U3RhdGUpO1xuICAgICAgICAvKipcbiAgICAgICAgICogVGhlIGxvbmctZGF0ZSBmb3JtYXQgZm9yIGRpc3BsYXlpbmcgdGhlXG4gICAgICAgICAqIHNlbGVjdGVkIGRhdGUgaW4gdGhlIFNjaGVkdWxlciB0b29sYmFyLlxuICAgICAgICAgKiBEZWZhdWx0cyB0byBgezA6WX1gXG4gICAgICAgICAqIChbbW9yZSBpbmZvcm1hdGlvbl0oeyUgc2x1ZyBwYXJzaW5nYW5kZm9ybWF0dGluZ19pbnRsICV9I3RvYy1kYXRlLWZvcm1hdHRpbmcpKS5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuc2VsZWN0ZWREYXRlRm9ybWF0ID0gJ3swOll9JztcbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRoZSBzaG9ydC1kYXRlIGZvcm1hdCBmb3IgZGlzcGxheWluZyB0aGVcbiAgICAgICAgICogc2VsZWN0ZWQgZGF0ZSBpbiB0aGUgU2NoZWR1bGVyIHRvb2xiYXIuXG4gICAgICAgICAqIERlZmF1bHRzIHRvIGB7MDp5fWBcbiAgICAgICAgICogKFttb3JlIGluZm9ybWF0aW9uXSh7JSBzbHVnIHBhcnNpbmdhbmRmb3JtYXR0aW5nX2ludGwgJX0jdG9jLWRhdGUtZm9ybWF0dGluZy5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuc2VsZWN0ZWRTaG9ydERhdGVGb3JtYXQgPSAnezA6eX0nO1xuICAgICAgICAvKipcbiAgICAgICAgICogVGhlIGludmFyaWFudCBuYW1lIGZvciB0aGlzIHZpZXcgKGBtb250aGApLlxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5uYW1lID0gJ21vbnRoJztcbiAgICB9XG4gICAgLyoqXG4gICAgICogQGhpZGRlblxuICAgICAqL1xuICAgIGdldCB0aXRsZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubG9jYWxpemF0aW9uLmdldCgnbW9udGhWaWV3VGl0bGUnKTtcbiAgICB9XG4gICAgZ2V0IHZpZXdFdmVudEhlaWdodCgpIHtcbiAgICAgICAgcmV0dXJuIGlzUHJlc2VudCh0aGlzLmV2ZW50SGVpZ2h0KSA/IHRoaXMuZXZlbnRIZWlnaHQgOiAodGhpcy5zY2hlZHVsZXJPcHRpb25zLmV2ZW50SGVpZ2h0IHx8IERFRkFVTFRfRVZFTlRfSEVJR0hUKTtcbiAgICB9XG59XG5Nb250aFZpZXdDb21wb25lbnQuZGVjb3JhdG9ycyA9IFtcbiAgICB7IHR5cGU6IENvbXBvbmVudCwgYXJnczogW3tcbiAgICAgICAgICAgICAgICBjaGFuZ2VEZXRlY3Rpb246IENoYW5nZURldGVjdGlvblN0cmF0ZWd5Lk9uUHVzaCxcbiAgICAgICAgICAgICAgICBzZWxlY3RvcjogJ2tlbmRvLXNjaGVkdWxlci1tb250aC12aWV3JyxcbiAgICAgICAgICAgICAgICBwcm92aWRlcnM6IFt7XG4gICAgICAgICAgICAgICAgICAgICAgICBwcm92aWRlOiBTY2hlZHVsZXJWaWV3LFxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOm5vLWZvcndhcmQtcmVmXG4gICAgICAgICAgICAgICAgICAgICAgICB1c2VFeGlzdGluZzogZm9yd2FyZFJlZigoKSA9PiBNb250aFZpZXdDb21wb25lbnQpXG4gICAgICAgICAgICAgICAgICAgIH1dLFxuICAgICAgICAgICAgICAgIHRlbXBsYXRlOiBgXG4gICAgICAgIDxuZy10ZW1wbGF0ZSAjY29udGVudD5cbiAgICAgICAgICAgIDxtb250aC12aWV3XG4gICAgICAgICAgICAgICAgW2V2ZW50SGVpZ2h0XT1cInZpZXdFdmVudEhlaWdodFwiXG4gICAgICAgICAgICAgICAgW9C1dmVudFRlbXBsYXRlXT1cImV2ZW50VGVtcGxhdGU/LnRlbXBsYXRlUmVmXCJcbiAgICAgICAgICAgICAgICBbc2xvdENsYXNzXT1cInZpZXdTbG90Q2xhc3NcIlxuICAgICAgICAgICAgICAgIFtldmVudENsYXNzXT1cInZpZXdFdmVudENsYXNzXCJcbiAgICAgICAgICAgICAgICBbZXZlbnRTdHlsZXNdPVwidmlld0V2ZW50U3R5bGVzXCJcbiAgICAgICAgICAgICAgICBbZ3JvdXBIZWFkZXJUZW1wbGF0ZV09XCJncm91cEhlYWRlclRlbXBsYXRlPy50ZW1wbGF0ZVJlZlwiXG4gICAgICAgICAgICAgICAgW21vbnRoRGF5U2xvdFRlbXBsYXRlXT1cIm1vbnRoRGF5U2xvdFRlbXBsYXRlPy50ZW1wbGF0ZVJlZlwiXG4gICAgICAgICAgICAgICAgW3NlbGVjdGVkRGF0ZUZvcm1hdF09XCJzZWxlY3RlZERhdGVGb3JtYXRcIlxuICAgICAgICAgICAgICAgIFtzZWxlY3RlZFNob3J0RGF0ZUZvcm1hdF09XCJzZWxlY3RlZFNob3J0RGF0ZUZvcm1hdFwiPlxuICAgICAgICAgICAgPC9tb250aC12aWV3PlxuICAgICAgICA8L25nLXRlbXBsYXRlPlxuICAgIGBcbiAgICAgICAgICAgIH0sXSB9LFxuXTtcbi8qKiBAbm9jb2xsYXBzZSAqL1xuTW9udGhWaWV3Q29tcG9uZW50LmN0b3JQYXJhbWV0ZXJzID0gKCkgPT4gW1xuICAgIHsgdHlwZTogTG9jYWxpemF0aW9uU2VydmljZSB9LFxuICAgIHsgdHlwZTogQ2hhbmdlRGV0ZWN0b3JSZWYgfSxcbiAgICB7IHR5cGU6IFZpZXdDb250ZXh0U2VydmljZSB9LFxuICAgIHsgdHlwZTogVmlld1N0YXRlU2VydmljZSB9XG5dO1xuTW9udGhWaWV3Q29tcG9uZW50LnByb3BEZWNvcmF0b3JzID0ge1xuICAgIGV2ZW50SGVpZ2h0OiBbeyB0eXBlOiBJbnB1dCB9XSxcbiAgICBzZWxlY3RlZERhdGVGb3JtYXQ6IFt7IHR5cGU6IElucHV0IH1dLFxuICAgIHNlbGVjdGVkU2hvcnREYXRlRm9ybWF0OiBbeyB0eXBlOiBJbnB1dCB9XSxcbiAgICBtb250aERheVNsb3RUZW1wbGF0ZTogW3sgdHlwZTogQ29udGVudENoaWxkLCBhcmdzOiBbTW9udGhEYXlTbG90VGVtcGxhdGVEaXJlY3RpdmUsXSB9XVxufTtcblxuY29uc3QgbGFzdCA9IChhcnIpID0+IGFyclthcnIubGVuZ3RoIC0gMV07XG4vKipcbiAqIEBoaWRkZW5cbiAqL1xuY29uc3QgY3JlYXRlVGFza3MgPSAocGVyaW9kU3RhcnQsIHBlcmlvZEVuZCwgaXRlbXMsIHJhbmdlcykgPT4ge1xuICAgIGNvbnN0IHRhc2tzID0gW107XG4gICAgY29uc3QgdXRjU3RhcnQgPSB0b1VUQ0RhdGUocGVyaW9kU3RhcnQpO1xuICAgIGNvbnN0IHV0Y0VuZCA9IHRvVVRDRGF0ZShwZXJpb2RFbmQpO1xuICAgIGZvciAobGV0IGluZGV4ID0gMDsgaW5kZXggPCBpdGVtcy5sZW5ndGg7IGluZGV4KyspIHtcbiAgICAgICAgY29uc3QgaXRlbSA9IGl0ZW1zW2luZGV4XTtcbiAgICAgICAgY29uc3QgZGF0YSA9IHt9O1xuICAgICAgICBjb25zdCBzdGFydFRpbWUgPSBpdGVtLnN0YXJ0LnRvVVRDRGF0ZSgpO1xuICAgICAgICBjb25zdCBlbmQgPSBpdGVtLmVuZDtcbiAgICAgICAgY29uc3QgZW5kVGltZSA9IChpdGVtLmVuZC5nZXRUaW1lKCkgIT09IGVuZC5nZXRUaW1lKCkgPyBlbmQuYWRkRGF5cygxKSA6IGVuZCkudG9VVENEYXRlKCk7XG4gICAgICAgIGlmIChpbnRlcnNlY3RzKHN0YXJ0VGltZSwgZW5kVGltZSwgdXRjU3RhcnQsIHV0Y0VuZCkpIHtcbiAgICAgICAgICAgIGZvciAobGV0IHJhbmdlSWR4ID0gMDsgcmFuZ2VJZHggPCByYW5nZXMubGVuZ3RoOyByYW5nZUlkeCsrKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgcmFuZ2UgPSByYW5nZXNbcmFuZ2VJZHhdO1xuICAgICAgICAgICAgICAgIGNvbnN0IHJhbmdlU3RhcnQgPSB0b1VUQ0RhdGUocmFuZ2VbMF0pO1xuICAgICAgICAgICAgICAgIGNvbnN0IHJhbmdlRW5kID0gYWRkVVRDRGF5cyh0b1VUQ0RhdGUobGFzdChyYW5nZSkpLCAxKTtcbiAgICAgICAgICAgICAgICBpZiAoaW50ZXJzZWN0cyhzdGFydFRpbWUsIGVuZFRpbWUsIHJhbmdlU3RhcnQsIHJhbmdlRW5kKSkge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCB0YXNrID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgaW5kZXgsXG4gICAgICAgICAgICAgICAgICAgICAgICBzdGFydFRpbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICBlbmRUaW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgc3RhcnQ6IGl0ZW0uc3RhcnQsXG4gICAgICAgICAgICAgICAgICAgICAgICBlbmQ6IGl0ZW0uZW5kLFxuICAgICAgICAgICAgICAgICAgICAgICAgZXZlbnQ6IGl0ZW0uZXZlbnQsXG4gICAgICAgICAgICAgICAgICAgICAgICBpc0FsbERheTogaXRlbS5ldmVudC5pc0FsbERheSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHJhbmdlSW5kZXg6IHJhbmdlSWR4LFxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YTogZGF0YVxuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICB0YXNrcy5wdXNoKHRhc2spO1xuICAgICAgICAgICAgICAgICAgICB0YXNrLmhlYWQgPSB0YXNrLmVuZFRpbWUgPiByYW5nZUVuZDtcbiAgICAgICAgICAgICAgICAgICAgdGFzay50YWlsID0gdGFzay5zdGFydFRpbWUgPCByYW5nZVN0YXJ0O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gc29ydFRhc2tzQnlUaW1lKHRhc2tzKTtcbn07XG5mdW5jdGlvbiBjbGVhclRhc2tEYXRhKHRhc2spIHtcbiAgICBjb25zdCBkYXRhID0gdGFzay5kYXRhO1xuICAgIGZvciAobGV0IGtleSBpbiBkYXRhKSB7XG4gICAgICAgIGlmIChkYXRhLmhhc093blByb3BlcnR5KGtleSkpIHtcbiAgICAgICAgICAgIGRlbGV0ZSBkYXRhW2tleV07XG4gICAgICAgIH1cbiAgICB9XG59XG4vKipcbiAqIEBoaWRkZW5cbiAqL1xuZnVuY3Rpb24gdXBkYXRlVGFza0RhdGEodGFza3MpIHtcbiAgICBmb3IgKGxldCBpZHggPSAwOyBpZHggPCB0YXNrcy5sZW5ndGg7IGlkeCsrKSB7XG4gICAgICAgIGNvbnN0IHRhc2sgPSB0YXNrc1tpZHhdO1xuICAgICAgICBjb25zdCByZXNvdXJjZXMgPSB0YXNrLnJlc291cmNlcztcbiAgICAgICAgY2xlYXJUYXNrRGF0YSh0YXNrKTtcbiAgICAgICAgZm9yIChsZXQgcmVzb3VyY2VJZHggPSAwOyByZXNvdXJjZUlkeCA8IHJlc291cmNlcy5sZW5ndGg7IHJlc291cmNlSWR4KyspIHtcbiAgICAgICAgICAgIHRhc2suZGF0YVtyZXNvdXJjZXNbcmVzb3VyY2VJZHhdLmxlYWZJZHhdID0ge307XG4gICAgICAgIH1cbiAgICB9XG59XG5cbi8qKlxuICogQGhpZGRlblxuICovXG5jbGFzcyBIaW50Q29udGFpbmVyQ29tcG9uZW50IHtcbiAgICBjb25zdHJ1Y3RvcihjaGFuZ2VEZXRlY3Rvcikge1xuICAgICAgICB0aGlzLmNoYW5nZURldGVjdG9yID0gY2hhbmdlRGV0ZWN0b3I7XG4gICAgICAgIHRoaXMuY2hhbmdlRGV0ZWN0b3IuZGV0YWNoKCk7XG4gICAgfVxuICAgIGRldGVjdENoYW5nZXMoKSB7XG4gICAgICAgIHRoaXMuY2hhbmdlRGV0ZWN0b3IuZGV0ZWN0Q2hhbmdlcygpO1xuICAgIH1cbn1cbkhpbnRDb250YWluZXJDb21wb25lbnQuZGVjb3JhdG9ycyA9IFtcbiAgICB7IHR5cGU6IENvbXBvbmVudCwgYXJnczogW3tcbiAgICAgICAgICAgICAgICBzZWxlY3RvcjogJ2tlbmRvLWhpbnQtY29udGFpbmVyJyxcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZTogYFxuICAgICAgICA8bmctY29udGFpbmVyIFtuZ1RlbXBsYXRlT3V0bGV0XT1cImhpbnRUZW1wbGF0ZVwiPlxuICAgICAgICA8L25nLWNvbnRhaW5lcj5cbiAgICBgXG4gICAgICAgICAgICB9LF0gfSxcbl07XG4vKiogQG5vY29sbGFwc2UgKi9cbkhpbnRDb250YWluZXJDb21wb25lbnQuY3RvclBhcmFtZXRlcnMgPSAoKSA9PiBbXG4gICAgeyB0eXBlOiBDaGFuZ2VEZXRlY3RvclJlZiB9XG5dO1xuSGludENvbnRhaW5lckNvbXBvbmVudC5wcm9wRGVjb3JhdG9ycyA9IHtcbiAgICBoaW50VGVtcGxhdGU6IFt7IHR5cGU6IENvbnRlbnRDaGlsZCwgYXJnczogW1RlbXBsYXRlUmVmLF0gfV1cbn07XG5cbmNvbnN0IFNDUk9MTF9DSEFOR0UgPSAxNTtcbmNvbnN0IE1JTl9ESVNUQU5DRSA9IDYwO1xuY29uc3QgU0NST0xMX0lOVEVSVkFMID0gNTA7XG5jb25zdCBNSU5fTU9WRV9ESVNUQU5DRSA9IDEwO1xuLyoqIEBoaWRkZW4gKi9cbmNsYXNzIEJhc2VWaWV3IHtcbiAgICBjb25zdHJ1Y3Rvcih2aWV3Q29udGV4dCwgdmlld1N0YXRlLCBpbnRsLCBzbG90U2VydmljZSwgem9uZSwgcmVuZGVyZXIsIGVsZW1lbnQsIHBkZlNlcnZpY2UsIGxvY2FsaXphdGlvbikge1xuICAgICAgICB0aGlzLnZpZXdDb250ZXh0ID0gdmlld0NvbnRleHQ7XG4gICAgICAgIHRoaXMudmlld1N0YXRlID0gdmlld1N0YXRlO1xuICAgICAgICB0aGlzLmludGwgPSBpbnRsO1xuICAgICAgICB0aGlzLnNsb3RTZXJ2aWNlID0gc2xvdFNlcnZpY2U7XG4gICAgICAgIHRoaXMuem9uZSA9IHpvbmU7XG4gICAgICAgIHRoaXMucmVuZGVyZXIgPSByZW5kZXJlcjtcbiAgICAgICAgdGhpcy5lbGVtZW50ID0gZWxlbWVudDtcbiAgICAgICAgdGhpcy5wZGZTZXJ2aWNlID0gcGRmU2VydmljZTtcbiAgICAgICAgdGhpcy5sb2NhbGl6YXRpb24gPSBsb2NhbGl6YXRpb247XG4gICAgICAgIHRoaXMuaXRlbXMgPSBuZXcgQmVoYXZpb3JTdWJqZWN0KG51bGwpO1xuICAgICAgICB0aGlzLmhvcml6b250YWxSZXNvdXJjZXMgPSBbXTtcbiAgICAgICAgdGhpcy52ZXJ0aWNhbFJlc291cmNlcyA9IFtdO1xuICAgICAgICB0aGlzLmRyYWdIaW50cyA9IFtdO1xuICAgICAgICB0aGlzLnJlc2l6ZUhpbnRzID0gW107XG4gICAgICAgIHRoaXMuZ2V0RmllbGQgPSBnZXRGaWVsZDtcbiAgICAgICAgdGhpcy5jaGFuZ2VzID0gbmV3IEJlaGF2aW9yU3ViamVjdChudWxsKTtcbiAgICAgICAgdGhpcy52aWV3UmFuZ2VDaGFuZ2UgPSBuZXcgQmVoYXZpb3JTdWJqZWN0KG51bGwpO1xuICAgICAgICB0aGlzLnN1YnMgPSBuZXcgU3Vic2NyaXB0aW9uKCk7XG4gICAgICAgIHRoaXMuZ3JvdXBlZFJlc291cmNlcyA9IFtdO1xuICAgICAgICB0aGlzLnNwYW5zID0gW107XG4gICAgICAgIHRoaXMuZG9tRXZlbnRzID0gW107XG4gICAgICAgIHRoaXMucmVzb3VyY2VzQ2FjaGUgPSB7fTtcbiAgICAgICAgdGhpcy5hdXRvSGVpZ2h0ID0gZmFsc2U7XG4gICAgICAgIHRoaXMucnRsID0gZmFsc2U7XG4gICAgICAgIHRoaXMuc2V0U2xvdENsYXNzID0gdGhpcy5zZXRTbG90Q2xhc3MuYmluZCh0aGlzKTtcbiAgICAgICAgdGhpcy5zZXRIaW50Q2xhc3MgPSB0aGlzLnNldEhpbnRDbGFzcy5iaW5kKHRoaXMpO1xuICAgIH1cbiAgICBnZXQgZXZlbnRUZW1wbGF0ZVJlZigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMu0LV2ZW50VGVtcGxhdGUgfHwgKHRoaXMuc2NoZWR1bGVyRXZlbnRUZW1wbGF0ZSB8fCB7fSkudGVtcGxhdGVSZWY7XG4gICAgfVxuICAgIGdldCBncm91cEhlYWRlclRlbXBsYXRlUmVmKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5ncm91cEhlYWRlclRlbXBsYXRlIHx8ICh0aGlzLnNjaGVkdWxlckdyb3VwSGVhZGVyVGVtcGxhdGUgfHwge30pLnRlbXBsYXRlUmVmO1xuICAgIH1cbiAgICBuZ09uSW5pdCgpIHtcbiAgICAgICAgY29uc3QgdXBkYXRlVmlldyA9IHRoaXMudXBkYXRlVmlldy5iaW5kKHRoaXMpO1xuICAgICAgICB0aGlzLnJlc291cmNlc0J5SW5kZXggPSB0aGlzLnJlc291cmNlc0J5SW5kZXguYmluZCh0aGlzKTtcbiAgICAgICAgdGhpcy5zdWJzLmFkZCh0aGlzLnZpZXdDb250ZXh0LnNlbGVjdGVkRGF0ZS5zdWJzY3JpYmUodGhpcy5vblNlbGVjdERhdGUuYmluZCh0aGlzKSkpO1xuICAgICAgICB0aGlzLnN1YnMuYWRkKHRoaXMudmlld0NvbnRleHQuYWN0aW9uLnN1YnNjcmliZSh0aGlzLm9uQWN0aW9uLmJpbmQodGhpcykpKTtcbiAgICAgICAgdGhpcy5zdWJzLmFkZCh0aGlzLnZpZXdDb250ZXh0LmV4ZWN1dGUuc3Vic2NyaWJlKHRoaXMuZXhlY3V0ZS5iaW5kKHRoaXMpKSk7XG4gICAgICAgIHRoaXMuc3Vicy5hZGQodGhpcy52aWV3Q29udGV4dC5yZXNpemUuc3Vic2NyaWJlKCgpID0+IHtcbiAgICAgICAgICAgIHRoaXMudG9nZ2xlRWxlbWVudChmYWxzZSk7XG4gICAgICAgICAgICB0aGlzLnVwZGF0ZVZpZXcoKTtcbiAgICAgICAgfSkpO1xuICAgICAgICB0aGlzLnN1YnMuYWRkKHRoaXMudmlld0NvbnRleHQub3B0aW9uc0NoYW5nZS5zdWJzY3JpYmUodGhpcy5vcHRpb25zQ2hhbmdlLmJpbmQodGhpcykpKTtcbiAgICAgICAgdGhpcy5zdWJzLmFkZCh0aGlzLmNoYW5nZXMuc3Vic2NyaWJlKCgpID0+IHtcbiAgICAgICAgICAgIHRoaXMudG9nZ2xlRWxlbWVudChmYWxzZSk7XG4gICAgICAgIH0pKTtcbiAgICAgICAgdGhpcy5zdWJzLmFkZChjb21iaW5lTGF0ZXN0KHRoaXMudmlld0NvbnRleHQuaXRlbXMsIHRoaXMudmlld1N0YXRlLmRhdGVSYW5nZSwgdGhpcy52aWV3UmFuZ2VDaGFuZ2UpXG4gICAgICAgICAgICAucGlwZShtYXAoKFtpdGVtcywgZGF0ZVJhbmdlXSkgPT4gdGhpcy5jcmVhdGVUYXNrcyhpdGVtcywgZGF0ZVJhbmdlKSkpXG4gICAgICAgICAgICAuc3Vic2NyaWJlKCh0YXNrcykgPT4ge1xuICAgICAgICAgICAgdGhpcy50YXNrcyA9IHRhc2tzO1xuICAgICAgICAgICAgdGhpcy5hc3NpZ25SZXNvdXJjZXMoKTtcbiAgICAgICAgICAgIHRoaXMub25UYXNrc0NoYW5nZSgpO1xuICAgICAgICB9KSk7XG4gICAgICAgIHRoaXMuc3Vicy5hZGQoY29tYmluZUxhdGVzdCh0aGlzLml0ZW1zLCB0aGlzLmNoYW5nZXMsIHRoaXMubG9jYWxpemF0aW9uLmNoYW5nZXMpLnBpcGUoc3dpdGNoTWFwKCgpID0+IHRoaXMub25TdGFibGUoKSkpXG4gICAgICAgICAgICAuc3Vic2NyaWJlKHVwZGF0ZVZpZXcpKTtcbiAgICAgICAgdGhpcy5zdWJzLmFkZCh0aGlzLnBkZlNlcnZpY2UuY3JlYXRlRWxlbWVudC5zdWJzY3JpYmUodGhpcy5jcmVhdGVQREZFbGVtZW50LmJpbmQodGhpcykpKTtcbiAgICB9XG4gICAgbmdPbkNoYW5nZXMoY2hhbmdlcykge1xuICAgICAgICBpZiAoYW55Q2hhbmdlZChbJ3NlbGVjdGVkRGF0ZUZvcm1hdCcsICdzZWxlY3RlZFNob3J0RGF0ZUZvcm1hdCddLCBjaGFuZ2VzKSkge1xuICAgICAgICAgICAgdGhpcy52aWV3U3RhdGUubm90aWZ5RGF0ZVJhbmdlKHRoaXMuZGF0ZVJhbmdlKHRoaXMuc2VsZWN0ZWREYXRlKSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGNoYW5nZXMuZXZlbnRIZWlnaHQpIHtcbiAgICAgICAgICAgIHRoaXMuY2hhbmdlcy5uZXh0KG51bGwpO1xuICAgICAgICB9XG4gICAgfVxuICAgIG5nQWZ0ZXJWaWV3SW5pdCgpIHtcbiAgICAgICAgdGhpcy5iaW5kRXZlbnRzKCk7XG4gICAgICAgIHRoaXMuc3Vicy5hZGQodGhpcy5sb2NhbGl6YXRpb24uY2hhbmdlcy5zdWJzY3JpYmUoKHsgcnRsIH0pID0+IHtcbiAgICAgICAgICAgIHRoaXMucnRsID0gcnRsO1xuICAgICAgICB9KSk7XG4gICAgfVxuICAgIG5nT25EZXN0cm95KCkge1xuICAgICAgICB0aGlzLnN1YnMudW5zdWJzY3JpYmUoKTtcbiAgICAgICAgdGhpcy5kb21FdmVudHMuZm9yRWFjaCh1bmJpbmRIYW5kbGVyID0+IHVuYmluZEhhbmRsZXIoKSk7XG4gICAgICAgIHRoaXMuZG9tRXZlbnRzID0gW107XG4gICAgICAgIGlmICh0aGlzLmRyYWdnYWJsZSkge1xuICAgICAgICAgICAgdGhpcy5kcmFnZ2FibGUuZGVzdHJveSgpO1xuICAgICAgICAgICAgdGhpcy5kcmFnZ2FibGUgPSBudWxsO1xuICAgICAgICB9XG4gICAgfVxuICAgIGl0ZW1JbmRleChpbmRleCwgXykge1xuICAgICAgICByZXR1cm4gaW5kZXg7XG4gICAgfVxuICAgIHJlc291cmNlc0J5SW5kZXgoaW5kZXgpIHtcbiAgICAgICAgaWYgKCF0aGlzLnJlc291cmNlc0NhY2hlW2luZGV4XSkge1xuICAgICAgICAgICAgY29uc3QgcmVzb3VyY2VzID0gdGhpcy50YXNrUmVzb3VyY2VzO1xuICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gW107XG4gICAgICAgICAgICBsZXQgY3VycmVudEluZGV4ID0gaW5kZXg7XG4gICAgICAgICAgICBmb3IgKGxldCBpZHggPSAwOyBpZHggPCByZXNvdXJjZXMubGVuZ3RoOyBpZHgrKykge1xuICAgICAgICAgICAgICAgIGNvbnN0IGRhdGEgPSByZXNvdXJjZXNbaWR4XS5kYXRhIHx8IFtdO1xuICAgICAgICAgICAgICAgIGNvbnN0IGRhdGFJZHggPSBNYXRoLmZsb29yKGN1cnJlbnRJbmRleCAvIHRoaXMuc3BhbnNbaWR4XSk7XG4gICAgICAgICAgICAgICAgcmVzdWx0LnB1c2goZGF0YVtkYXRhSWR4XSk7XG4gICAgICAgICAgICAgICAgY3VycmVudEluZGV4IC09IGRhdGFJZHggKiB0aGlzLnNwYW5zW2lkeF07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLnJlc291cmNlc0NhY2hlW2luZGV4XSA9IHJlc3VsdDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5yZXNvdXJjZXNDYWNoZVtpbmRleF07XG4gICAgfVxuICAgIGRyYWdSZXNvdXJjZXNCeUluZGV4KGluZGV4KSB7XG4gICAgICAgIGNvbnN0IGFsbFJlc291cmNlcyA9IHRoaXMucmVzb3VyY2VzIHx8IFtdO1xuICAgICAgICBjb25zdCByZXN1bHQgPSBbXTtcbiAgICAgICAgaWYgKHRoaXMuZ3JvdXBlZFJlc291cmNlcy5sZW5ndGgpIHtcbiAgICAgICAgICAgIGNvbnN0IHJlc291cmNlcyA9IHRoaXMucmVzb3VyY2VzQnlJbmRleChpbmRleCkuc2xpY2UoMCk7XG4gICAgICAgICAgICBjb25zdCB0YXNrUmVzb3VyY2VzID0gdGhpcy50YXNrUmVzb3VyY2VzO1xuICAgICAgICAgICAgZm9yIChsZXQgaWR4ID0gMDsgaWR4IDwgdGFza1Jlc291cmNlcy5sZW5ndGg7IGlkeCsrKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgaW5kZXggPSB0aGlzLnJlc291cmNlcy5pbmRleE9mKHRhc2tSZXNvdXJjZXNbaWR4XSk7XG4gICAgICAgICAgICAgICAgaWYgKGluZGV4ID49IDApIHtcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0W2luZGV4XSA9IHJlc291cmNlc1tpZHhdO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBmb3IgKGxldCBpZHggPSAwOyBpZHggPCBhbGxSZXNvdXJjZXMubGVuZ3RoOyBpZHgrKykge1xuICAgICAgICAgICAgaWYgKCFyZXN1bHRbaWR4XSkge1xuICAgICAgICAgICAgICAgIHJlc3VsdFtpZHhdID0gcmVzb3VyY2VJdGVtQnlWYWx1ZSh0aGlzLmRyYWdnaW5nLnRhc2suZXZlbnQsIGFsbFJlc291cmNlc1tpZHhdKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH1cbiAgICBnZXRFdmVudENsYXNzZXMoaXRlbSwgcmVzb3VyY2VzLCBpc0FsbERheSkge1xuICAgICAgICBpZiAodGhpcy5ldmVudENsYXNzKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5ldmVudENsYXNzKHtcbiAgICAgICAgICAgICAgICBldmVudDogaXRlbS5ldmVudCxcbiAgICAgICAgICAgICAgICByZXNvdXJjZXMsXG4gICAgICAgICAgICAgICAgaXNBbGxEYXlcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfVxuICAgIGdldEV2ZW50U3R5bGVzKGl0ZW0sIGl0ZW1SZXNvdXJjZSwgaXNBbGxEYXkpIHtcbiAgICAgICAgY29uc3QgcmVzdWx0ID0geyBiYWNrZ3JvdW5kQ29sb3I6IGl0ZW1SZXNvdXJjZS5jb2xvciwgYm9yZGVyQ29sb3I6IGl0ZW1SZXNvdXJjZS5jb2xvciB9O1xuICAgICAgICBpZiAodGhpcy5ldmVudFN0eWxlcykge1xuICAgICAgICAgICAgT2JqZWN0LmFzc2lnbihyZXN1bHQsIHRoaXMuZXZlbnRTdHlsZXMoe1xuICAgICAgICAgICAgICAgIGV2ZW50OiBpdGVtLmV2ZW50LFxuICAgICAgICAgICAgICAgIHJlc291cmNlczogaXRlbVJlc291cmNlLnJlc291cmNlcyxcbiAgICAgICAgICAgICAgICBpc0FsbERheVxuICAgICAgICAgICAgfSkpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfVxuICAgIG9wdGlvbnNDaGFuZ2Uob3B0aW9ucykge1xuICAgICAgICB0aGlzLnNjaGVkdWxlckV2ZW50VGVtcGxhdGUgPSBvcHRpb25zLmV2ZW50VGVtcGxhdGU7XG4gICAgICAgIHRoaXMuc2NoZWR1bGVyR3JvdXBIZWFkZXJUZW1wbGF0ZSA9IG9wdGlvbnMuZ3JvdXBIZWFkZXJUZW1wbGF0ZTtcbiAgICAgICAgdGhpcy5taW4gPSBvcHRpb25zLm1pbjtcbiAgICAgICAgdGhpcy5tYXggPSBvcHRpb25zLm1heDtcbiAgICAgICAgdGhpcy5lZGl0YWJsZSA9IG9wdGlvbnMuZWRpdGFibGU7XG4gICAgICAgIHRoaXMudGltZXpvbmUgPSBvcHRpb25zLnRpbWV6b25lO1xuICAgICAgICBpZiAoIW9wdGlvbnMuY2hhbmdlcyB8fCBhbnlDaGFuZ2VkKFsnZ3JvdXAnLCAncmVzb3VyY2VzJ10sIG9wdGlvbnMuY2hhbmdlcywgZmFsc2UpIHx8XG4gICAgICAgICAgICBvcHRpb25zLmdyb3VwICE9PSB0aGlzLmdyb3VwIHx8IG9wdGlvbnMucmVzb3VyY2VzICE9PSB0aGlzLnJlc291cmNlcykge1xuICAgICAgICAgICAgdGhpcy5ncm91cCA9IG9wdGlvbnMuZ3JvdXA7XG4gICAgICAgICAgICB0aGlzLnJlc291cmNlcyA9IG9wdGlvbnMucmVzb3VyY2VzO1xuICAgICAgICAgICAgdGhpcy5ncm91cFJlc291cmNlcygpO1xuICAgICAgICAgICAgdGhpcy5yZXNvdXJjZXNDYWNoZSA9IHt9O1xuICAgICAgICAgICAgaWYgKHRoaXMudGFza3MgJiYgdGhpcy50YXNrcy5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmFzc2lnblJlc291cmNlcygpO1xuICAgICAgICAgICAgICAgIHRoaXMub25UYXNrc0NoYW5nZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5jaGFuZ2VzLm5leHQobnVsbCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgdG9nZ2xlRWxlbWVudCh2aXNpYmxlKSB7XG4gICAgICAgIGlmICh0aGlzLmVsZW1lbnQpIHtcbiAgICAgICAgICAgIHRoaXMucmVuZGVyZXIuc2V0U3R5bGUodGhpcy5lbGVtZW50Lm5hdGl2ZUVsZW1lbnQsICdkaXNwbGF5JywgdmlzaWJsZSA/ICdibG9jaycgOiAnbm9uZScpO1xuICAgICAgICB9XG4gICAgfVxuICAgIG9uU3RhYmxlKCkge1xuICAgICAgICByZXR1cm4gdGhpcy56b25lLm9uU3RhYmxlLmFzT2JzZXJ2YWJsZSgpLnBpcGUodGFrZSgxKSk7XG4gICAgfVxuICAgIHVwZGF0ZVZpZXcoKSB7XG4gICAgICAgIHRoaXMuc2xvdFNlcnZpY2UuaW52YWxpZGF0ZSgpO1xuICAgICAgICB0aGlzLnRvZ2dsZUVsZW1lbnQodHJ1ZSk7XG4gICAgICAgIHRoaXMucmVmbG93KCk7XG4gICAgICAgIHRoaXMudmlld1N0YXRlLm5vdGlmeUxheW91dEVuZCgpO1xuICAgIH1cbiAgICBhc3NpZ25SZXNvdXJjZXMoKSB7XG4gICAgICAgIGFzc2lnblRhc2tzUmVzb3VyY2VzKHRoaXMudGFza3MsIHtcbiAgICAgICAgICAgIHRhc2tSZXNvdXJjZXM6IHRoaXMudGFza1Jlc291cmNlcyxcbiAgICAgICAgICAgIGhhc0dyb3VwczogdGhpcy5ncm91cGVkUmVzb3VyY2VzLmxlbmd0aCA+IDAsXG4gICAgICAgICAgICBhbGxSZXNvdXJjZXM6IHRoaXMucmVzb3VyY2VzLFxuICAgICAgICAgICAgc3BhbnM6IHRoaXMuc3BhbnNcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIGJpbmRFdmVudHMoKSB7XG4gICAgICAgIGNvbnN0IGNvbnRlbnRFbGVtZW50ID0gdGhpcy5jb250ZW50Lm5hdGl2ZUVsZW1lbnQ7XG4gICAgICAgIGNvbnN0IGVsZW1lbnQgPSB0aGlzLmVsZW1lbnQubmF0aXZlRWxlbWVudDtcbiAgICAgICAgdGhpcy56b25lLnJ1bk91dHNpZGVBbmd1bGFyKCgpID0+IHtcbiAgICAgICAgICAgIGlmICh0aGlzLnRpbWVzKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zdWJzLmFkZChtZXJnZShmcm9tRXZlbnQodGhpcy50aW1lcy5uYXRpdmVFbGVtZW50LCAnbW91c2V3aGVlbCcpLCBmcm9tRXZlbnQodGhpcy50aW1lcy5uYXRpdmVFbGVtZW50LCAnRE9NTW91c2VTY3JvbGwnKSkucGlwZShmaWx0ZXIoKGV2ZW50KSA9PiAhZXZlbnQuY3RybEtleSksIHRhcChwcmV2ZW50TG9ja2VkU2Nyb2xsKGNvbnRlbnRFbGVtZW50KSksIG1hcCh3aGVlbERlbHRhWSkpXG4gICAgICAgICAgICAgICAgICAgIC5zdWJzY3JpYmUoeCA9PiBjb250ZW50RWxlbWVudC5zY3JvbGxUb3AgLT0geCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5zdWJzLmFkZChtZXJnZShmcm9tQ2xpY2soY29udGVudEVsZW1lbnQpLCBmcm9tRXZlbnQoY29udGVudEVsZW1lbnQsICdjb250ZXh0bWVudScpKVxuICAgICAgICAgICAgICAgIC5zdWJzY3JpYmUoZSA9PiB0aGlzLm9uQ2xpY2soZSkpKTtcbiAgICAgICAgICAgIHRoaXMuc3Vicy5hZGQoZnJvbURvdWJsZUNsaWNrKGNvbnRlbnRFbGVtZW50KVxuICAgICAgICAgICAgICAgIC5zdWJzY3JpYmUoZSA9PiB0aGlzLm9uQ2xpY2soZSwgJ2RibGNsaWNrJykpKTtcbiAgICAgICAgICAgIHRoaXMuc3Vicy5hZGQoZnJvbUV2ZW50KGVsZW1lbnQsICdrZXlkb3duJylcbiAgICAgICAgICAgICAgICAuc3Vic2NyaWJlKGUgPT4gdGhpcy5vbktleWRvd24oZSkpKTtcbiAgICAgICAgICAgIHRoaXMuZG9tRXZlbnRzLnB1c2godGhpcy5yZW5kZXJlci5saXN0ZW4oY29udGVudEVsZW1lbnQsICdzY3JvbGwnLCAoKSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuaGVhZGVyV3JhcCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmhlYWRlcldyYXAubmF0aXZlRWxlbWVudC5zY3JvbGxMZWZ0ID0gY29udGVudEVsZW1lbnQuc2Nyb2xsTGVmdDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMudGltZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy50aW1lcy5uYXRpdmVFbGVtZW50LnNjcm9sbFRvcCA9IGNvbnRlbnRFbGVtZW50LnNjcm9sbFRvcDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KSk7XG4gICAgICAgICAgICB0aGlzLmRyYWdnYWJsZSA9IG5ldyBEcmFnZ2FibGUoe1xuICAgICAgICAgICAgICAgIHByZXNzOiB0aGlzLm9uUHJlc3MuYmluZCh0aGlzKSxcbiAgICAgICAgICAgICAgICBkcmFnOiB0aGlzLm9uRHJhZy5iaW5kKHRoaXMpLFxuICAgICAgICAgICAgICAgIHJlbGVhc2U6IHRoaXMub25SZWxlYXNlLmJpbmQodGhpcylcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgdGhpcy5kcmFnZ2FibGUuYmluZFRvKGVsZW1lbnQpO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgb25QcmVzcyhhcmdzKSB7XG4gICAgICAgIGNvbnN0IHJlc2l6YWJsZSA9IHRoaXMuZWRpdGFibGUgJiYgdGhpcy5lZGl0YWJsZS5yZXNpemUgIT09IGZhbHNlO1xuICAgICAgICBjb25zdCBkcmFnZ2FibGUgPSB0aGlzLmVkaXRhYmxlICYmIHRoaXMuZWRpdGFibGUuZHJhZyAhPT0gZmFsc2U7XG4gICAgICAgIGNvbnN0IHRhcmdldCA9IGFyZ3Mub3JpZ2luYWxFdmVudC50YXJnZXQ7XG4gICAgICAgIGlmIChoYXNDbGFzc2VzKHRhcmdldCwgJ2stcmVzaXplLWhhbmRsZScpKSB7XG4gICAgICAgICAgICBpZiAoIXJlc2l6YWJsZSkge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuaW5pdFJlc2l6ZShhcmdzKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChkcmFnZ2FibGUpIHtcbiAgICAgICAgICAgIGNvbnN0IHRhc2sgPSB0aGlzLnRhcmdldFRhc2sodGFyZ2V0KTtcbiAgICAgICAgICAgIGlmICh0YXNrKSB7XG4gICAgICAgICAgICAgICAgaWYgKCFhcmdzLmlzVG91Y2gpIHtcbiAgICAgICAgICAgICAgICAgICAgYXJncy5vcmlnaW5hbEV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXMucHJlc3NMb2NhdGlvbiA9IHsgeDogYXJncy5wYWdlWCwgeTogYXJncy5wYWdlWSB9O1xuICAgICAgICAgICAgICAgIHRoaXMucHJlc3NUYXJnZXQgPSB0YXNrO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHRoaXMuZHJhZ0FyZ3MgPSBhcmdzO1xuICAgIH1cbiAgICBvbkRyYWcoYXJncykge1xuICAgICAgICBpZiAodGhpcy5yZXNpemluZykge1xuICAgICAgICAgICAgdGhpcy5yZXNpemUoYXJncyk7XG4gICAgICAgICAgICB0aGlzLnNjcm9sbENvbnRhaW5lcih0aGlzLnJlc2l6ZSwgYXJncyk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLmluaXREcmFnKGFyZ3MpO1xuICAgICAgICAgICAgaWYgKHRoaXMuZHJhZ2dpbmcpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmRyYWcoYXJncyk7XG4gICAgICAgICAgICAgICAgYXJncy5vcmlnaW5hbEV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgdGhpcy5zY3JvbGxDb250YWluZXIodGhpcy5kcmFnLCBhcmdzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB0aGlzLmRyYWdBcmdzID0gYXJncztcbiAgICB9XG4gICAgb25SZWxlYXNlKCkge1xuICAgICAgICBjbGVhckludGVydmFsKHRoaXMuc2Nyb2xsSW50ZXJ2YWwpO1xuICAgICAgICBjb25zdCB7IHJlc2l6aW5nLCBkcmFnZ2luZyB9ID0gdGhpcztcbiAgICAgICAgaWYgKHJlc2l6aW5nKSB7XG4gICAgICAgICAgICB0aGlzLmVtaXRFdmVudCgncmVzaXplRW5kJywge1xuICAgICAgICAgICAgICAgIGV2ZW50OiByZXNpemluZy50YXNrLmV2ZW50LFxuICAgICAgICAgICAgICAgIGRhdGFJdGVtOiByZXNpemluZy50YXNrLmV2ZW50LmRhdGFJdGVtLFxuICAgICAgICAgICAgICAgIHN0YXJ0OiB0aGlzLmNvbnZlcnREYXRlKHJlc2l6aW5nLnN0YXJ0KSxcbiAgICAgICAgICAgICAgICBlbmQ6IHRoaXMuY29udmVydERhdGUocmVzaXppbmcuZW5kKVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB0aGlzLnJlc2l6ZUhpbnRzID0gW107XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGRyYWdnaW5nKSB7XG4gICAgICAgICAgICB0aGlzLmVtaXRFdmVudCgnZHJhZ0VuZCcsIHtcbiAgICAgICAgICAgICAgICBldmVudDogZHJhZ2dpbmcudGFzay5ldmVudCxcbiAgICAgICAgICAgICAgICBkYXRhSXRlbTogZHJhZ2dpbmcudGFzay5ldmVudC5kYXRhSXRlbSxcbiAgICAgICAgICAgICAgICBzdGFydDogZHJhZ2dpbmcuc3RhcnQgPyB0aGlzLmNvbnZlcnREYXRlKGRyYWdnaW5nLnN0YXJ0KSA6IGRyYWdnaW5nLnRhc2suc3RhcnQudG9Mb2NhbERhdGUoKSxcbiAgICAgICAgICAgICAgICBlbmQ6IGRyYWdnaW5nLmVuZCA/IHRoaXMuY29udmVydERhdGUoZHJhZ2dpbmcuZW5kKSA6IGRyYWdnaW5nLnRhc2suZW5kLnRvTG9jYWxEYXRlKCksXG4gICAgICAgICAgICAgICAgcmVzb3VyY2VzOiBkcmFnZ2luZy5yZXNvdXJjZXMsXG4gICAgICAgICAgICAgICAgaXNBbGxEYXk6IHRoaXMuZHJhZ2dlZElzQWxsRGF5KGRyYWdnaW5nLnRhc2ssIGRyYWdnaW5nLnNsb3QpXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHRoaXMuZHJhZ0hpbnRzID0gW107XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHJlc2l6aW5nIHx8IGRyYWdnaW5nKSB7XG4gICAgICAgICAgICB0aGlzLnJlbW92ZVNsb3RDbGFzcygpO1xuICAgICAgICAgICAgdGhpcy51cGRhdGVIaW50Q29udGFpbmVyKCk7XG4gICAgICAgICAgICB0aGlzLnJlc2l6aW5nID0gbnVsbDtcbiAgICAgICAgICAgIHRoaXMuZHJhZ2dpbmcgPSBudWxsO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuY29udGFpbmVyID0gbnVsbDtcbiAgICAgICAgdGhpcy5kcmFnQXJncyA9IG51bGw7XG4gICAgICAgIHRoaXMucHJlc3NMb2NhdGlvbiA9IG51bGw7XG4gICAgICAgIHRoaXMucHJlc3NUYXJnZXQgPSBudWxsO1xuICAgIH1cbiAgICBzZXRIaW50Q2xhc3MoY2xhc3NOYW1lKSB7XG4gICAgICAgICh0aGlzLmRyYWdnaW5nIHx8IHRoaXMucmVzaXppbmcpLmhpbnRDbGFzcyA9IGNsYXNzTmFtZTtcbiAgICB9XG4gICAgdXBkYXRlSGludENsYXNzKCkge1xuICAgICAgICBjb25zdCBjdXJyZW50ID0gdGhpcy5kcmFnZ2luZyB8fCB0aGlzLnJlc2l6aW5nO1xuICAgICAgICBsZXQgdXBkYXRlID0gZmFsc2U7XG4gICAgICAgIHRoaXMuaGludHMuZm9yRWFjaChoaW50ID0+IHtcbiAgICAgICAgICAgIGlmIChoaW50LmNsYXNzICE9PSBjdXJyZW50LmhpbnRDbGFzcykge1xuICAgICAgICAgICAgICAgIGhpbnQuY2xhc3MgPSBjdXJyZW50LmhpbnRDbGFzcztcbiAgICAgICAgICAgICAgICB1cGRhdGUgPSB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgaWYgKHVwZGF0ZSkge1xuICAgICAgICAgICAgdGhpcy51cGRhdGVIaW50Q29udGFpbmVyKCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmVtb3ZlSGludENsYXNzKCkge1xuICAgICAgICAodGhpcy5kcmFnZ2luZyB8fCB0aGlzLnJlc2l6aW5nKS5oaW50Q2xhc3MgPSBudWxsO1xuICAgIH1cbiAgICBzZXRTbG90Q2xhc3MoY2xhc3NOYW1lKSB7XG4gICAgICAgIGNvbnN0IGN1cnJlbnQgPSB0aGlzLmRyYWdnaW5nIHx8IHRoaXMucmVzaXppbmc7XG4gICAgICAgIGN1cnJlbnQuc2xvdENsYXNzID0gY2xhc3NOYW1lO1xuICAgICAgICB0aGlzLnJlbmRlcmVyLmFkZENsYXNzKGN1cnJlbnQuc2xvdC5uYXRpdmVFbGVtZW50LCBjdXJyZW50LnNsb3RDbGFzcyk7XG4gICAgfVxuICAgIHJlbW92ZVNsb3RDbGFzcygpIHtcbiAgICAgICAgY29uc3QgY3VycmVudCA9IHRoaXMuZHJhZ2dpbmcgfHwgdGhpcy5yZXNpemluZztcbiAgICAgICAgaWYgKGN1cnJlbnQuc2xvdENsYXNzKSB7XG4gICAgICAgICAgICB0aGlzLnJlbmRlcmVyLnJlbW92ZUNsYXNzKGN1cnJlbnQuc2xvdC5uYXRpdmVFbGVtZW50LCBjdXJyZW50LnNsb3RDbGFzcyk7XG4gICAgICAgICAgICBjdXJyZW50LnNsb3RDbGFzcyA9IG51bGw7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZ2V0IGhpbnRzKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5kcmFnZ2luZyA/IHRoaXMuZHJhZ0hpbnRzIDogdGhpcy5yZXNpemVIaW50cztcbiAgICB9XG4gICAgaW5pdERyYWcoYXJncykge1xuICAgICAgICBpZiAoIXRoaXMuZHJhZ2dpbmcgJiYgdGhpcy5wcmVzc0xvY2F0aW9uICYmIHBvaW50RGlzdGFuY2UodGhpcy5wcmVzc0xvY2F0aW9uLngsIHRoaXMucHJlc3NMb2NhdGlvbi55LCBhcmdzLnBhZ2VYLCBhcmdzLnBhZ2VZKSA+PSBNSU5fTU9WRV9ESVNUQU5DRSkge1xuICAgICAgICAgICAgY29uc3QgZHJhZ2dpbmcgPSB0aGlzLnByZXNzVGFyZ2V0O1xuICAgICAgICAgICAgY29uc3QgdGFzayA9IGRyYWdnaW5nLnRhc2s7XG4gICAgICAgICAgICBpZiAodGhpcy5lbWl0RXZlbnQoJ2RyYWdTdGFydCcsIHsgZXZlbnQ6IHRhc2suZXZlbnQsIGRhdGFJdGVtOiB0YXNrLmV2ZW50LmRhdGFJdGVtIH0pKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5wcmVzc0xvY2F0aW9uID0gbnVsbDtcbiAgICAgICAgICAgICAgICB0aGlzLnByZXNzVGFyZ2V0ID0gbnVsbDtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLmRyYWdnaW5nID0gZHJhZ2dpbmc7XG4gICAgICAgICAgICB0aGlzLnVwZGF0ZURyYWdDb250YWluZXIoYXJncyk7XG4gICAgICAgICAgICBjb25zdCB7IHgsIHkgfSA9IHRoaXMuY29vcmRpbmF0ZXNPZmZzZXQodGhpcy5wcmVzc0xvY2F0aW9uLngsIHRoaXMucHJlc3NMb2NhdGlvbi55KTtcbiAgICAgICAgICAgIGNvbnN0IHNsb3QgPSB0aGlzLnNsb3RCeVBvc2l0aW9uKHgsIHksIHRoaXMuY29udGFpbmVyKTtcbiAgICAgICAgICAgIHRoaXMuZHJhZ2dpbmcub2Zmc2V0ID0ge1xuICAgICAgICAgICAgICAgIHN0YXJ0OiBzbG90LnN0YXJ0LmdldFRpbWUoKSAtIHRhc2suc3RhcnQudG9VVENEYXRlKCkuZ2V0VGltZSgpLFxuICAgICAgICAgICAgICAgIGVuZDogdGFzay5lbmQudG9VVENEYXRlKCkuZ2V0VGltZSgpIC0gc2xvdC5zdGFydC5nZXRUaW1lKClcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICB0aGlzLmRyYWdnaW5nLnNsb3QgPSBzbG90O1xuICAgICAgICAgICAgdGhpcy5kcmFnZ2luZy5zdGFydFJlc291cmNlcyA9IHRoaXMuZHJhZ2dpbmcucmVzb3VyY2VJdGVtcyA9IHRoaXMuZHJhZ1Jlc291cmNlc0J5SW5kZXgoc2xvdC5pZC5yZXNvdXJjZUluZGV4KTtcbiAgICAgICAgICAgIHRoaXMuZHJhZ2dpbmcucmVzb3VyY2VzID0gdGhpcy5yZXNvdXJjZVZhbHVlcyh0YXNrLCB0aGlzLmRyYWdnaW5nLnN0YXJ0UmVzb3VyY2VzKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICB1cGRhdGVEcmFnQ29udGFpbmVyKGFyZ3MpIHtcbiAgICAgICAgaWYgKCF0aGlzLmNvbnRhaW5lcikge1xuICAgICAgICAgICAgdGhpcy5jb250YWluZXIgPSB0aGlzLmNvbnRlbnQubmF0aXZlRWxlbWVudDtcbiAgICAgICAgICAgIHRoaXMuY29udGFpbmVyT2Zmc2V0ID0gZWxlbWVudE9mZnNldCh0aGlzLmNvbnRhaW5lcik7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZHJhZyhhcmdzKSB7XG4gICAgICAgIHRoaXMudXBkYXRlRHJhZ0NvbnRhaW5lcihhcmdzKTtcbiAgICAgICAgaWYgKCF0aGlzLmNvbnRhaW5lcikge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IHsgeCwgeSB9ID0gdGhpcy5jb29yZGluYXRlc09mZnNldChhcmdzLnBhZ2VYLCBhcmdzLnBhZ2VZKTtcbiAgICAgICAgY29uc3Qgc2xvdCA9IHRoaXMuc2xvdEJ5UG9zaXRpb24oeCwgeSwgdGhpcy5jb250YWluZXIpO1xuICAgICAgICBpZiAoc2xvdCAmJiAoc2xvdCAhPT0gdGhpcy5kcmFnZ2luZy5zbG90IHx8ICF0aGlzLmRyYWdIaW50cy5sZW5ndGgpKSB7XG4gICAgICAgICAgICBjb25zdCBkcmFnZ2luZyA9IHRoaXMuZHJhZ2dpbmc7XG4gICAgICAgICAgICBjb25zdCB7IHNsb3Q6IGN1cnJlbnRTbG90LCB0YXNrIH0gPSBkcmFnZ2luZztcbiAgICAgICAgICAgIGNvbnN0IHsgcmFuZ2VzLCBzdGFydCwgZW5kLCBpc0FsbERheSB9ID0gdGhpcy5kcmFnUmFuZ2VzKHNsb3QpO1xuICAgICAgICAgICAgbGV0IHJlc291cmNlSXRlbXMsIHJlc291cmNlVmFsdWVzO1xuICAgICAgICAgICAgaWYgKGN1cnJlbnRTbG90LmlkLnJlc291cmNlSW5kZXggIT09IHNsb3QuaWQucmVzb3VyY2VJbmRleCkge1xuICAgICAgICAgICAgICAgIHJlc291cmNlSXRlbXMgPSB0aGlzLmRyYWdSZXNvdXJjZXNCeUluZGV4KHNsb3QuaWQucmVzb3VyY2VJbmRleCk7XG4gICAgICAgICAgICAgICAgcmVzb3VyY2VWYWx1ZXMgPSB0aGlzLnJlc291cmNlVmFsdWVzKHRhc2ssIHJlc291cmNlSXRlbXMpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgcmVzb3VyY2VJdGVtcyA9IGRyYWdnaW5nLnJlc291cmNlSXRlbXM7XG4gICAgICAgICAgICAgICAgcmVzb3VyY2VWYWx1ZXMgPSBkcmFnZ2luZy5yZXNvdXJjZXM7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLnJlbW92ZVNsb3RDbGFzcygpO1xuICAgICAgICAgICAgZHJhZ2dpbmcuc3RhcnQgPSBzdGFydDtcbiAgICAgICAgICAgIGRyYWdnaW5nLmVuZCA9IGVuZDtcbiAgICAgICAgICAgIGRyYWdnaW5nLnNsb3QgPSBzbG90O1xuICAgICAgICAgICAgZHJhZ2dpbmcucmVzb3VyY2VzID0gcmVzb3VyY2VWYWx1ZXM7XG4gICAgICAgICAgICBkcmFnZ2luZy5yZXNvdXJjZUl0ZW1zID0gcmVzb3VyY2VJdGVtcztcbiAgICAgICAgICAgIGRyYWdnaW5nLmhpbnRDbGFzcyA9IG51bGw7XG4gICAgICAgICAgICBpZiAodGhpcy5lbWl0RXZlbnQoJ2RyYWcnLCB7XG4gICAgICAgICAgICAgICAgZXZlbnQ6IHRhc2suZXZlbnQsXG4gICAgICAgICAgICAgICAgZGF0YUl0ZW06IHRhc2suZXZlbnQuZGF0YUl0ZW0sXG4gICAgICAgICAgICAgICAgc3RhcnQ6IHRoaXMuY29udmVydERhdGUoc3RhcnQpLFxuICAgICAgICAgICAgICAgIGVuZDogdGhpcy5jb252ZXJ0RGF0ZShlbmQpLFxuICAgICAgICAgICAgICAgIHJlc291cmNlczogcmVzb3VyY2VWYWx1ZXMsXG4gICAgICAgICAgICAgICAgaXNBbGxEYXksXG4gICAgICAgICAgICAgICAgc2V0SGludENsYXNzOiB0aGlzLnNldEhpbnRDbGFzcyxcbiAgICAgICAgICAgICAgICBzZXRTbG90Q2xhc3M6IHRoaXMuc2V0U2xvdENsYXNzXG4gICAgICAgICAgICB9KSkge1xuICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlSGludENsYXNzKCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29uc3QgY29sb3IgPSB0aGlzLmRyYWdSZXNvdXJjZUNvbG9yKHRhc2ssIHJlc291cmNlSXRlbXMpO1xuICAgICAgICAgICAgY29uc3QgaGludENsYXNzZXMgPSB0aGlzLmRyYWdIaW50Q2xhc3NlcygpO1xuICAgICAgICAgICAgdGhpcy5kcmFnSGludHMgPSBbXTtcbiAgICAgICAgICAgIGZvciAobGV0IGlkeCA9IDA7IGlkeCA8IHJhbmdlcy5sZW5ndGg7IGlkeCsrKSB7XG4gICAgICAgICAgICAgICAgY29uc3Qgc2xvdHMgPSByYW5nZXNbaWR4XTtcbiAgICAgICAgICAgICAgICBjb25zdCBmaXJzdCA9IHNsb3RzWzBdO1xuICAgICAgICAgICAgICAgIGNvbnN0IGxhc3QgPSBzbG90c1tzbG90cy5sZW5ndGggLSAxXTtcbiAgICAgICAgICAgICAgICBjb25zdCBzaXplID0gdGhpcy5kcmFnSGludFNpemUoZmlyc3QsIGxhc3QpO1xuICAgICAgICAgICAgICAgIGxldCBvcmlnaW4gPSBmaXJzdC5yZWN0LmxlZnQ7XG4gICAgICAgICAgICAgICAgY29uc3Qgc3R5bGVzID0ge1xuICAgICAgICAgICAgICAgICAgICB0b3A6IHRvUHgoZmlyc3QucmVjdC50b3ApLFxuICAgICAgICAgICAgICAgICAgICBsZWZ0OiB0aGlzLmxvY2FsaXphdGlvbi5ydGwgPyAnJyA6IHRvUHgob3JpZ2luKSxcbiAgICAgICAgICAgICAgICAgICAgcmlnaHQ6ICF0aGlzLmxvY2FsaXphdGlvbi5ydGwgPyAnJyA6IHRvUHgob3JpZ2luKSxcbiAgICAgICAgICAgICAgICAgICAgd2lkdGg6IHNpemUud2lkdGgsXG4gICAgICAgICAgICAgICAgICAgIGhlaWdodDogc2l6ZS5oZWlnaHQsXG4gICAgICAgICAgICAgICAgICAgIGJhY2tncm91bmRDb2xvcjogY29sb3IsXG4gICAgICAgICAgICAgICAgICAgIGJvcmRlckNvbG9yOiBjb2xvclxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuZXZlbnRTdHlsZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgT2JqZWN0LmFzc2lnbihzdHlsZXMsIHRoaXMuZXZlbnRTdHlsZXModGhpcy5kcmFnSGludEV2ZW50U3R5bGVBcmdzKCkpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpcy5kcmFnSGludHMucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgIGl0ZW06IE9iamVjdC5hc3NpZ24oe30sIHRoaXMuZHJhZ2dpbmcudGFzaywge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3RhcnRUaW1lOiBzdGFydCxcbiAgICAgICAgICAgICAgICAgICAgICAgIGVuZFRpbWU6IGVuZFxuICAgICAgICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgICAgICAgICAgcmVzb3VyY2VzOiByZXNvdXJjZUl0ZW1zLFxuICAgICAgICAgICAgICAgICAgICBjbGFzczogaGludENsYXNzZXMsXG4gICAgICAgICAgICAgICAgICAgIHN0eWxlOiBzdHlsZXNcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMudXBkYXRlSGludENvbnRhaW5lcigpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGRyYWdIaW50Q2xhc3NlcygpIHtcbiAgICAgICAgY29uc3QgaGludENsYXNzID0gdGhpcy5kcmFnZ2luZy5oaW50Q2xhc3M7XG4gICAgICAgIGxldCByZXN1bHQgPSBbXTtcbiAgICAgICAgaWYgKGhpbnRDbGFzcykge1xuICAgICAgICAgICAgcmVzdWx0LnB1c2goaGludENsYXNzKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5ldmVudENsYXNzKSB7XG4gICAgICAgICAgICBjb25zdCBldmVudENsYXNzID0gdGhpcy5ldmVudENsYXNzKHRoaXMuZHJhZ0hpbnRFdmVudFN0eWxlQXJncygpKTtcbiAgICAgICAgICAgIHJlc3VsdCA9IHJlc3VsdC5jb25jYXQoY29udmVydE5nQ2xhc3NCaW5kaW5ncyhldmVudENsYXNzKSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9XG4gICAgZHJhZ0hpbnRFdmVudFN0eWxlQXJncygpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGV2ZW50OiB0aGlzLmRyYWdnaW5nLnRhc2suZXZlbnQsXG4gICAgICAgICAgICByZXNvdXJjZXM6IHRoaXMuZHJhZ2dpbmcucmVzb3VyY2VJdGVtc1xuICAgICAgICB9O1xuICAgIH1cbiAgICBkcmFnZ2VkSXNBbGxEYXkodGFzaywgX3Nsb3QpIHtcbiAgICAgICAgcmV0dXJuIEJvb2xlYW4odGFzay5ldmVudC5pc0FsbERheSk7XG4gICAgfVxuICAgIGRyYWdSZXNvdXJjZUNvbG9yKHRhc2ssIHNsb3RSZXNvdXJjZXMpIHtcbiAgICAgICAgaWYgKHRoaXMuZ3JvdXBlZFJlc291cmNlcy5sZW5ndGgpIHtcbiAgICAgICAgICAgIGNvbnN0IGluZGV4ID0gdGhpcy5yZXNvdXJjZXMuaW5kZXhPZih0aGlzLmdyb3VwZWRSZXNvdXJjZXNbMF0pO1xuICAgICAgICAgICAgcmV0dXJuIGdldEZpZWxkKHNsb3RSZXNvdXJjZXNbaW5kZXhdLCB0aGlzLmdyb3VwZWRSZXNvdXJjZXNbMF0uY29sb3JGaWVsZCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAodGhpcy5yZXNvdXJjZXMgJiYgdGhpcy5yZXNvdXJjZXMubGVuZ3RoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGFzay5yZXNvdXJjZXNbMF0uY29sb3I7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuICcnO1xuICAgIH1cbiAgICByZXNvdXJjZVZhbHVlcyh0YXNrLCBjdXJyZW50UmVzb3VyY2VzKSB7XG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IHt9O1xuICAgICAgICBmb3IgKGxldCBpZHggPSAwOyBpZHggPCBjdXJyZW50UmVzb3VyY2VzLmxlbmd0aDsgaWR4KyspIHtcbiAgICAgICAgICAgIGNvbnN0IHJlc291cmNlID0gdGhpcy5yZXNvdXJjZXNbaWR4XTtcbiAgICAgICAgICAgIGNvbnN0IHJlc291cmNlSXRlbSA9IGN1cnJlbnRSZXNvdXJjZXNbaWR4XTtcbiAgICAgICAgICAgIGxldCB2YWx1ZTtcbiAgICAgICAgICAgIGlmIChBcnJheS5pc0FycmF5KHJlc291cmNlSXRlbSkpIHsgLy8gbm90IGdyb3VwZWQgbXVsdGlwbGUgcmVzb3VyY2VcbiAgICAgICAgICAgICAgICB2YWx1ZSA9IGdldEZpZWxkKHRhc2suZXZlbnQsIHJlc291cmNlLmZpZWxkKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHZhbHVlID0gZ2V0RmllbGQoY3VycmVudFJlc291cmNlc1tpZHhdLCByZXNvdXJjZS52YWx1ZUZpZWxkKTtcbiAgICAgICAgICAgICAgICBpZiAocmVzb3VyY2UubXVsdGlwbGUpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3Qgc3RhcnRWYWx1ZSA9IGdldEZpZWxkKHRoaXMuZHJhZ2dpbmcuc3RhcnRSZXNvdXJjZXNbaWR4XSwgcmVzb3VyY2UudmFsdWVGaWVsZCk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChzdGFydFZhbHVlICE9PSB2YWx1ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSBbdmFsdWVdO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSBnZXRGaWVsZCh0YXNrLmV2ZW50LmRhdGFJdGVtLCByZXNvdXJjZS5maWVsZCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBzZXRGaWVsZChyZXN1bHQsIHJlc291cmNlLmZpZWxkLCB2YWx1ZSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9XG4gICAgaW5pdFJlc2l6ZShhcmdzKSB7XG4gICAgICAgIGFyZ3Mub3JpZ2luYWxFdmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICBjb25zdCB0YXJnZXQgPSBhcmdzLm9yaWdpbmFsRXZlbnQudGFyZ2V0O1xuICAgICAgICBjb25zdCByZXNpemluZyA9IHRoaXMudGFyZ2V0VGFzayh0YXJnZXQpO1xuICAgICAgICBpZiAodGhpcy5lbWl0RXZlbnQoJ3Jlc2l6ZVN0YXJ0JywgeyBldmVudDogcmVzaXppbmcudGFzay5ldmVudCwgZGF0YUl0ZW06IHJlc2l6aW5nLnRhc2suZXZlbnQuZGF0YUl0ZW0gfSkpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnJlc2l6aW5nID0gcmVzaXppbmc7XG4gICAgICAgIHJlc2l6aW5nLnN0YXJ0ID0gcmVzaXppbmcudGFzay5zdGFydC50b1VUQ0RhdGUoKTtcbiAgICAgICAgcmVzaXppbmcuZW5kID0gcmVzaXppbmcudGFzay5lbmQudG9VVENEYXRlKCk7XG4gICAgICAgIGlmIChoYXNDbGFzc2VzKHRhcmdldCwgJ2stcmVzaXplLW4nKSkge1xuICAgICAgICAgICAgcmVzaXppbmcuZGlyZWN0aW9uID0gJ24nO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGhhc0NsYXNzZXModGFyZ2V0LCAnay1yZXNpemUtcycpKSB7XG4gICAgICAgICAgICByZXNpemluZy5kaXJlY3Rpb24gPSAncyc7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoaGFzQ2xhc3Nlcyh0YXJnZXQsICdrLXJlc2l6ZS13JykpIHtcbiAgICAgICAgICAgIHJlc2l6aW5nLmRpcmVjdGlvbiA9ICd3JztcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJlc2l6aW5nLmRpcmVjdGlvbiA9ICdlJztcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnVwZGF0ZURyYWdDb250YWluZXIoYXJncyk7XG4gICAgICAgIGNvbnN0IHsgeCwgeSB9ID0gdGhpcy5jb29yZGluYXRlc09mZnNldChhcmdzLnBhZ2VYLCBhcmdzLnBhZ2VZKTtcbiAgICAgICAgcmVzaXppbmcuc2xvdCA9IHRoaXMuc2xvdEJ5UG9zaXRpb24oeCwgeSwgdGhpcy5jb250YWluZXIpO1xuICAgICAgICByZXNpemluZy5vZmZzZXQgPSB7XG4gICAgICAgICAgICBzdGFydDogcmVzaXppbmcudGFzay5zdGFydC50b1VUQ0RhdGUoKS5nZXRUaW1lKCkgLSByZXNpemluZy5zbG90LnN0YXJ0LmdldFRpbWUoKSxcbiAgICAgICAgICAgIGVuZDogcmVzaXppbmcudGFzay5lbmQudG9VVENEYXRlKCkuZ2V0VGltZSgpIC0gcmVzaXppbmcuc2xvdC5zdGFydC5nZXRUaW1lKClcbiAgICAgICAgfTtcbiAgICB9XG4gICAgcmVzaXplKGFyZ3MpIHtcbiAgICAgICAgY29uc3QgeyB4LCB5IH0gPSB0aGlzLmNvb3JkaW5hdGVzT2Zmc2V0KGFyZ3MucGFnZVgsIGFyZ3MucGFnZVkpO1xuICAgICAgICBjb25zdCByZXNpemluZyA9IHRoaXMucmVzaXppbmc7XG4gICAgICAgIGNvbnN0IHsgZGlyZWN0aW9uLCB0YXNrLCBvZmZzZXQgfSA9IHJlc2l6aW5nO1xuICAgICAgICBjb25zdCBzbG90ID0gdGhpcy5zbG90U2VydmljZS5ncm91cFNsb3RCeVBvc2l0aW9uKHJlc2l6aW5nLnNsb3QsIHgsIHkpO1xuICAgICAgICBpZiAoIXNsb3QgfHwgc2xvdCA9PT0gcmVzaXppbmcuc2xvdCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMucmVtb3ZlU2xvdENsYXNzKCk7XG4gICAgICAgIGNvbnN0IHsgc3RhcnQsIGVuZCwgcmFuZ2VzIH0gPSB0aGlzLnNsb3RTZXJ2aWNlLnJlc2l6ZVJhbmdlcyhzbG90LCB0YXNrLCBkaXJlY3Rpb24gPT09ICd3JyB8fCBkaXJlY3Rpb24gPT09ICduJywgb2Zmc2V0KTtcbiAgICAgICAgcmVzaXppbmcuaGludENsYXNzID0gbnVsbDtcbiAgICAgICAgcmVzaXppbmcuc3RhcnQgPSBzdGFydDtcbiAgICAgICAgcmVzaXppbmcuZW5kID0gZW5kO1xuICAgICAgICByZXNpemluZy5zbG90ID0gc2xvdDtcbiAgICAgICAgaWYgKHRoaXMuZW1pdEV2ZW50KCdyZXNpemUnLCB7XG4gICAgICAgICAgICBldmVudDogdGFzay5ldmVudCxcbiAgICAgICAgICAgIGRhdGFJdGVtOiB0YXNrLmV2ZW50LmRhdGFJdGVtLFxuICAgICAgICAgICAgc3RhcnQ6IHRoaXMuY29udmVydERhdGUoc3RhcnQpLFxuICAgICAgICAgICAgZW5kOiB0aGlzLmNvbnZlcnREYXRlKGVuZCksXG4gICAgICAgICAgICBzZXRIaW50Q2xhc3M6IHRoaXMuc2V0SGludENsYXNzLFxuICAgICAgICAgICAgc2V0U2xvdENsYXNzOiB0aGlzLnNldFNsb3RDbGFzc1xuICAgICAgICB9KSkge1xuICAgICAgICAgICAgdGhpcy51cGRhdGVIaW50Q2xhc3MoKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnVwZGF0ZVJlc2l6ZUhpbnRzKHJhbmdlcywgc3RhcnQsIGVuZCk7XG4gICAgICAgIHRoaXMudXBkYXRlSGludENvbnRhaW5lcigpO1xuICAgIH1cbiAgICB1cGRhdGVSZXNpemVIaW50cyhyYW5nZXMsIHN0YXJ0LCBlbmQpIHtcbiAgICAgICAgY29uc3QgcmVzaXppbmcgPSB0aGlzLnJlc2l6aW5nO1xuICAgICAgICBjb25zdCBkaXJlY3Rpb24gPSByZXNpemluZy5kaXJlY3Rpb247XG4gICAgICAgIGNvbnN0IGhvcml6b250YWwgPSBkaXJlY3Rpb24gPT09ICd3JyB8fCBkaXJlY3Rpb24gPT09ICdlJztcbiAgICAgICAgY29uc3QgcmVzaXplU3RhcnQgPSBkaXJlY3Rpb24gPT09ICd3JyB8fCBkaXJlY3Rpb24gPT09ICduJztcbiAgICAgICAgdGhpcy5yZXNpemVIaW50cyA9IFtdO1xuICAgICAgICBmb3IgKGxldCBpZHggPSAwOyBpZHggPCByYW5nZXMubGVuZ3RoOyBpZHgrKykge1xuICAgICAgICAgICAgY29uc3QgcmFuZ2UgPSByYW5nZXNbaWR4XTtcbiAgICAgICAgICAgIGNvbnN0IGZpcnN0U2xvdCA9IHJhbmdlWzBdO1xuICAgICAgICAgICAgY29uc3QgbGFzdFNsb3QgPSByYW5nZVtyYW5nZS5sZW5ndGggLSAxXTtcbiAgICAgICAgICAgIGNvbnN0IGZpcnN0ID0gaWR4ID09PSAwO1xuICAgICAgICAgICAgY29uc3QgbGFzdCA9IGlkeCA9PT0gcmFuZ2VzLmxlbmd0aCAtIDE7XG4gICAgICAgICAgICB0aGlzLnJlc2l6ZUhpbnRzLnB1c2goe1xuICAgICAgICAgICAgICAgIGZpcnN0OiBmaXJzdCxcbiAgICAgICAgICAgICAgICBsYXN0OiBsYXN0LFxuICAgICAgICAgICAgICAgIHJlY3Q6IHtcbiAgICAgICAgICAgICAgICAgICAgbGVmdDogZmlyc3RTbG90LnJlY3QubGVmdCxcbiAgICAgICAgICAgICAgICAgICAgdG9wOiBmaXJzdFNsb3QudG9wLFxuICAgICAgICAgICAgICAgICAgICBoZWlnaHQ6IGhvcml6b250YWwgPyBmaXJzdFNsb3QuaGVpZ2h0IDogTWF0aC5hYnMobGFzdFNsb3QucmVjdC50b3AgLSBmaXJzdFNsb3QucmVjdC50b3ApICsgbGFzdFNsb3QucmVjdC5oZWlnaHQsXG4gICAgICAgICAgICAgICAgICAgIHdpZHRoOiBob3Jpem9udGFsID8gTWF0aC5hYnMobGFzdFNsb3QucmVjdC5sZWZ0IC0gZmlyc3RTbG90LnJlY3QubGVmdCkgKyBsYXN0U2xvdC5yZWN0LndpZHRoIDogZmlyc3RTbG90LndpZHRoXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBzdGFydDogZmlyc3QgJiYgIXJlc2l6ZVN0YXJ0ID8gcmVzaXppbmcuc3RhcnQgOiBmaXJzdFNsb3Quc3RhcnQsXG4gICAgICAgICAgICAgICAgZW5kOiBsYXN0ICYmIHJlc2l6ZVN0YXJ0ID8gcmVzaXppbmcuZW5kIDogbGFzdFNsb3QuZW5kLFxuICAgICAgICAgICAgICAgIGNsYXNzOiByZXNpemluZy5oaW50Q2xhc3NcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfVxuICAgIGNvb3JkaW5hdGVzT2Zmc2V0KHgsIHksIGNvbnRhaW5lciA9IHRoaXMuY29udGFpbmVyLCBvZmZzZXQgPSB0aGlzLmNvbnRhaW5lck9mZnNldCkge1xuICAgICAgICBjb25zdCBwb3NpdGlvbiA9IHggLSBvZmZzZXQubGVmdCArIGNvbnRhaW5lci5zY3JvbGxMZWZ0O1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgeDogIXRoaXMubG9jYWxpemF0aW9uLnJ0bCA/IHBvc2l0aW9uIDogdGhpcy5zbG90U2VydmljZS5jb250YWluZXJTaXplIC0gcG9zaXRpb24sXG4gICAgICAgICAgICB5OiB5IC0gb2Zmc2V0LnRvcCArIGNvbnRhaW5lci5zY3JvbGxUb3BcbiAgICAgICAgfTtcbiAgICB9XG4gICAgc2Nyb2xsQ29udGFpbmVyKGNhbGxiYWNrLCBhcmdzKSB7XG4gICAgICAgIGNsZWFySW50ZXJ2YWwodGhpcy5zY3JvbGxJbnRlcnZhbCk7XG4gICAgICAgIGNvbnN0IGNvbnRhaW5lciA9IHRoaXMuY29udGFpbmVyO1xuICAgICAgICBpZiAoIWNvbnRhaW5lcikge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IHZpZXdQb3J0WSA9IGFyZ3MucGFnZVkgLSB0aGlzLmNvbnRhaW5lck9mZnNldC50b3A7XG4gICAgICAgIGNvbnN0IHBvaW50ZXJZRGlzdGFuY2UgPSBNYXRoLmFicyhjb250YWluZXIub2Zmc2V0SGVpZ2h0IC0gdmlld1BvcnRZKTtcbiAgICAgICAgY29uc3QgZGVsdGFZID0gYXJncy5wYWdlWSAtIHRoaXMuZHJhZ0FyZ3MucGFnZVk7XG4gICAgICAgIGNvbnN0IHZpZXdQb3J0WCA9IGFyZ3MucGFnZVggLSB0aGlzLmNvbnRhaW5lck9mZnNldC5sZWZ0O1xuICAgICAgICBjb25zdCBwb2ludGVyWERpc3RhbmNlID0gTWF0aC5hYnMoY29udGFpbmVyLm9mZnNldFdpZHRoIC0gdmlld1BvcnRYKTtcbiAgICAgICAgY29uc3QgZGVsdGFYID0gYXJncy5wYWdlWCAtIHRoaXMuZHJhZ0FyZ3MucGFnZVg7XG4gICAgICAgIGxldCBzY3JvbGwgPSBmYWxzZTtcbiAgICAgICAgbGV0IGxlZnRDaGFuZ2UgPSAwO1xuICAgICAgICBsZXQgdG9wQ2hhbmdlID0gMDtcbiAgICAgICAgaWYgKHBvaW50ZXJZRGlzdGFuY2UgPCBNSU5fRElTVEFOQ0UgJiYgY29udGFpbmVyLnNjcm9sbFRvcCArIGNvbnRhaW5lci5vZmZzZXRIZWlnaHQgPCBjb250YWluZXIuc2Nyb2xsSGVpZ2h0ICYmIGRlbHRhWSA+IDApIHtcbiAgICAgICAgICAgIHNjcm9sbCA9IHRydWU7XG4gICAgICAgICAgICB0b3BDaGFuZ2UgPSBTQ1JPTExfQ0hBTkdFO1xuICAgICAgICAgICAgdGhpcy5jb250YWluZXIuc2Nyb2xsVG9wICs9IE1JTl9ESVNUQU5DRSAtIHBvaW50ZXJZRGlzdGFuY2U7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAodmlld1BvcnRZIDwgTUlOX0RJU1RBTkNFICYmIGNvbnRhaW5lci5zY3JvbGxUb3AgPiAwICYmIGRlbHRhWSA8IDApIHtcbiAgICAgICAgICAgIHNjcm9sbCA9IHRydWU7XG4gICAgICAgICAgICB0b3BDaGFuZ2UgPSAtU0NST0xMX0NIQU5HRTtcbiAgICAgICAgICAgIHRoaXMuY29udGFpbmVyLnNjcm9sbFRvcCAtPSBNSU5fRElTVEFOQ0UgLSB2aWV3UG9ydFk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHBvaW50ZXJYRGlzdGFuY2UgPCBNSU5fRElTVEFOQ0UgJiYgY29udGFpbmVyLnNjcm9sbExlZnQgKyBjb250YWluZXIub2Zmc2V0V2lkdGggPCBjb250YWluZXIuc2Nyb2xsV2lkdGggJiYgZGVsdGFYID4gMCkge1xuICAgICAgICAgICAgc2Nyb2xsID0gdHJ1ZTtcbiAgICAgICAgICAgIGxlZnRDaGFuZ2UgPSBTQ1JPTExfQ0hBTkdFO1xuICAgICAgICAgICAgdGhpcy5jb250YWluZXIuc2Nyb2xsTGVmdCArPSBNSU5fRElTVEFOQ0UgLSBwb2ludGVyWERpc3RhbmNlO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHZpZXdQb3J0WCA8IE1JTl9ESVNUQU5DRSAmJiBjb250YWluZXIuc2Nyb2xsTGVmdCA+IDAgJiYgZGVsdGFZIDwgMCkge1xuICAgICAgICAgICAgc2Nyb2xsID0gdHJ1ZTtcbiAgICAgICAgICAgIGxlZnRDaGFuZ2UgPSAtU0NST0xMX0NIQU5HRTtcbiAgICAgICAgICAgIHRoaXMuY29udGFpbmVyLnNjcm9sbExlZnQgLT0gTUlOX0RJU1RBTkNFIC0gdmlld1BvcnRYO1xuICAgICAgICB9XG4gICAgICAgIGlmIChzY3JvbGwpIHtcbiAgICAgICAgICAgIHRoaXMuc2Nyb2xsSW50ZXJ2YWwgPSBzZXRJbnRlcnZhbCgoKSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuY29udGFpbmVyKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY29udGFpbmVyLnNjcm9sbExlZnQgKz0gbGVmdENoYW5nZTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jb250YWluZXIuc2Nyb2xsVG9wICs9IHRvcENoYW5nZTtcbiAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2suY2FsbCh0aGlzLCBhcmdzKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGNsZWFySW50ZXJ2YWwodGhpcy5zY3JvbGxJbnRlcnZhbCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwgU0NST0xMX0lOVEVSVkFMKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBlbWl0RXZlbnQobmFtZSwgYXJncykge1xuICAgICAgICB0aGlzLnZpZXdTdGF0ZS5lbWl0RXZlbnQobmFtZSwgYXJncyk7XG4gICAgICAgIHJldHVybiBhcmdzLnByZXZlbnRlZDtcbiAgICB9XG4gICAgdGFyZ2V0VGFzayh0YXJnZXQpIHtcbiAgICAgICAgY29uc3QgZXZlbnRUYXJnZXQgPSBjbG9zZXN0SW5TY29wZSh0YXJnZXQsIG5vZGUgPT4gbm9kZS5oYXNBdHRyaWJ1dGUoJ2RhdGEtdGFzay1pbmRleCcpLCB0aGlzLmVsZW1lbnQubmF0aXZlRWxlbWVudCk7XG4gICAgICAgIGlmIChldmVudFRhcmdldCkge1xuICAgICAgICAgICAgY29uc3QgaW5kZXggPSBwYXJzZUludChldmVudFRhcmdldC5nZXRBdHRyaWJ1dGUoJ2RhdGEtdGFzay1pbmRleCcpLCAxMCk7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHRhcmdldDogZXZlbnRUYXJnZXQsXG4gICAgICAgICAgICAgICAgdGFzazogdGhpcy50YXNrcy5maW5kKHQgPT4gdC5pbmRleCA9PT0gaW5kZXgpXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgfVxuICAgIHVwZGF0ZUhpbnRDb250YWluZXIoKSB7XG4gICAgICAgIGlmICh0aGlzLmhpbnRDb250YWluZXIpIHtcbiAgICAgICAgICAgIHRoaXMuaGludENvbnRhaW5lci5kZXRlY3RDaGFuZ2VzKCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogQ29udmVydHMgYSBcInZpZXcgZGF0ZVwiIChkYXRlIHN0b3JlZCBpbiB0aGUgVVRDIHBhcnRzIG9mIGEgRGF0ZSBvYmplY3QpIHRvIGEgbG9jYWwgZGF0ZS5cbiAgICAgKi9cbiAgICBjb252ZXJ0RGF0ZShkYXRlKSB7XG4gICAgICAgIHJldHVybiBab25lZERhdGUuZnJvbVVUQ0RhdGUoZGF0ZSwgdGhpcy50aW1lem9uZSkudG9Mb2NhbERhdGUoKTtcbiAgICB9XG4gICAgb25DbGljayhlLCBldmVudFR5cGUgPSBlLnR5cGUpIHtcbiAgICAgICAgdGhpcy5lbWl0U2xvdEV2ZW50KGUsIGV2ZW50VHlwZSk7XG4gICAgICAgIHRoaXMuZW1pdFRhc2tFdmVudChlLCBldmVudFR5cGUpO1xuICAgIH1cbiAgICBlbWl0U2xvdEV2ZW50KGUsIGV2ZW50VHlwZSkge1xuICAgICAgICBjb25zdCB0YXJnZXRTbG90ID0gY2xvc2VzdEluU2NvcGUoZS50YXJnZXQsIG5vZGUgPT4gbm9kZS5oYXNBdHRyaWJ1dGUoJ2RhdGEtc2xvdC1pbmRleCcpLCB0aGlzLmVsZW1lbnQubmF0aXZlRWxlbWVudCk7XG4gICAgICAgIGlmICh0YXJnZXRTbG90KSB7XG4gICAgICAgICAgICBjb25zdCBzbG90SW5kZXggPSB0YXJnZXRTbG90LmdldEF0dHJpYnV0ZSgnZGF0YS1zbG90LWluZGV4Jyk7XG4gICAgICAgICAgICBjb25zdCBuYW1lID0gZXZlbnRUeXBlID09PSAnZGJsY2xpY2snID8gJ3Nsb3REYmxDbGljaycgOiAnc2xvdENsaWNrJztcbiAgICAgICAgICAgIGNvbnN0IHNsb3QgPSB0aGlzLnNsb3RCeUluZGV4KHNsb3RJbmRleCwgZSk7XG4gICAgICAgICAgICB0aGlzLnZpZXdTdGF0ZS5lbWl0RXZlbnQobmFtZSwge1xuICAgICAgICAgICAgICAgIHR5cGU6IGV2ZW50VHlwZSxcbiAgICAgICAgICAgICAgICBzbG90OiBzbG90LFxuICAgICAgICAgICAgICAgIHN0YXJ0OiB0aGlzLmNvbnZlcnREYXRlKHNsb3Quc3RhcnQpLFxuICAgICAgICAgICAgICAgIGVuZDogdGhpcy5jb252ZXJ0RGF0ZShzbG90LmVuZCksXG4gICAgICAgICAgICAgICAgaXNBbGxEYXk6IHNsb3QuaXNEYXlTbG90LFxuICAgICAgICAgICAgICAgIG9yaWdpbmFsRXZlbnQ6IGUsXG4gICAgICAgICAgICAgICAgcmVzb3VyY2VzOiB0aGlzLnJlc291cmNlcyAmJiB0aGlzLnJlc291cmNlcy5sZW5ndGggP1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnJlc291cmNlc0J5SW5kZXgoc2xvdC5pZC5yZXNvdXJjZUluZGV4KSA6IFtdXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBlbWl0VGFza0V2ZW50KGUsIGV2ZW50VHlwZSkge1xuICAgICAgICBjb25zdCB0YXJnZXRUYXNrID0gdGhpcy50YXJnZXRUYXNrKGUudGFyZ2V0KTtcbiAgICAgICAgaWYgKHRhcmdldFRhc2spIHtcbiAgICAgICAgICAgIGNvbnN0IHRhc2sgPSB0YXJnZXRUYXNrLnRhc2s7XG4gICAgICAgICAgICBjb25zdCBpc1NpbmdsZSA9IGV2ZW50VHlwZSA9PT0gJ2NsaWNrJztcbiAgICAgICAgICAgIGNvbnN0IGlzRG91YmxlID0gZXZlbnRUeXBlID09PSAnZGJsY2xpY2snO1xuICAgICAgICAgICAgaWYgKGlzU2luZ2xlICYmIGNsb3Nlc3RJblNjb3BlKGUudGFyZ2V0LCBub2RlID0+IGhhc0NsYXNzZXMobm9kZSwgJ2stZXZlbnQtZGVsZXRlJyksIHRhcmdldFRhc2sudGFyZ2V0KSkge1xuICAgICAgICAgICAgICAgIHRoaXMudmlld1N0YXRlLmVtaXRFdmVudCgncmVtb3ZlJywgeyBldmVudDogdGFzay5ldmVudCwgZGF0YUl0ZW06IHRhc2suZXZlbnQuZGF0YUl0ZW0gfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBjb25zdCBuYW1lID0gaXNEb3VibGUgPyAnZXZlbnREYmxDbGljaycgOiAnZXZlbnRDbGljayc7XG4gICAgICAgICAgICAgICAgdGhpcy52aWV3U3RhdGUuZW1pdEV2ZW50KG5hbWUsIHsgdHlwZTogZXZlbnRUeXBlLCBldmVudDogdGFzay5ldmVudCwgb3JpZ2luYWxFdmVudDogZSB9KTtcbiAgICAgICAgICAgICAgICB0YXJnZXRUYXNrLnRhcmdldC5mb2N1cygpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIG9uS2V5ZG93bihlKSB7XG4gICAgICAgIGNvbnN0IHRhcmdldFRhc2sgPSB0aGlzLnRhcmdldFRhc2soZS50YXJnZXQpO1xuICAgICAgICBpZiAodGFyZ2V0VGFzaykge1xuICAgICAgICAgICAgY29uc3QgdGFzayA9IHRhcmdldFRhc2sudGFzaztcbiAgICAgICAgICAgIHRoaXMudmlld1N0YXRlLmVtaXRFdmVudCgnZXZlbnRLZXlkb3duJywgeyBldmVudDogdGFzay5ldmVudCwgZGF0YUl0ZW06IHRhc2suZXZlbnQuZGF0YUl0ZW0sIG9yaWdpbmFsRXZlbnQ6IGUgfSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3luY1RhYmxlcygpIHtcbiAgICAgICAgaWYgKHRoaXMudGltZXNUYWJsZSkge1xuICAgICAgICAgICAgdGhpcy5yZW5kZXJlci5zZXRTdHlsZSh0aGlzLnRpbWVzVGFibGUubmF0aXZlRWxlbWVudCwgJ2hlaWdodCcsIGAke3RoaXMuY29udGVudFRhYmxlLm5hdGl2ZUVsZW1lbnQub2Zmc2V0SGVpZ2h0fXB4YCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuaGVhZGVyKSB7XG4gICAgICAgICAgICB0aGlzLnJlbmRlcmVyLnNldFN0eWxlKHRoaXMuaGVhZGVyLm5hdGl2ZUVsZW1lbnQsICF0aGlzLmxvY2FsaXphdGlvbi5ydGwgPyAncGFkZGluZy1yaWdodCcgOiAncGFkZGluZy1sZWZ0JywgYCR7aGFzU2Nyb2xsYmFyKHRoaXMuY29udGVudC5uYXRpdmVFbGVtZW50LCAndmVydGljYWwnKSA/IHNjcm9sbGJhcldpZHRoKCkgLSBCT1JERVJfV0lEVEggOiAwfXB4YCk7XG4gICAgICAgICAgICB0aGlzLnJlbmRlcmVyLnNldFN0eWxlKHRoaXMuaGVhZGVyLm5hdGl2ZUVsZW1lbnQsIHRoaXMubG9jYWxpemF0aW9uLnJ0bCA/ICdwYWRkaW5nLXJpZ2h0JyA6ICdwYWRkaW5nLWxlZnQnLCAnMHB4Jyk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMudGltZXMpIHtcbiAgICAgICAgICAgIGNvbnN0IHRpbWVzID0gdGhpcy50aW1lcy5uYXRpdmVFbGVtZW50O1xuICAgICAgICAgICAgdGhpcy50aW1lc0hlYWRlci5uYXRpdmVFbGVtZW50LnN0eWxlLndpZHRoID0gYCR7dGltZXMub2Zmc2V0V2lkdGh9cHhgO1xuICAgICAgICAgICAgY29uc3QgY29udGVudEhlaWdodCA9IHRoaXMuY29udGVudEhlaWdodCA9PT0gJ2F1dG8nID8gdGhpcy5jb250ZW50Lm5hdGl2ZUVsZW1lbnQub2Zmc2V0SGVpZ2h0IDogdGhpcy5jb250ZW50SGVpZ2h0O1xuICAgICAgICAgICAgdGhpcy5yZW5kZXJlci5zZXRTdHlsZSh0aW1lcywgJ2hlaWdodCcsIGAke2NvbnRlbnRIZWlnaHQgLSAoaGFzU2Nyb2xsYmFyKHRoaXMuY29udGVudC5uYXRpdmVFbGVtZW50LCAnaG9yaXpvbnRhbCcpID8gc2Nyb2xsYmFyV2lkdGgoKSA6IDApfXB4YCk7XG4gICAgICAgICAgICB0aW1lcy5zY3JvbGxUb3AgPSB0aGlzLmNvbnRlbnQubmF0aXZlRWxlbWVudC5zY3JvbGxUb3A7XG4gICAgICAgIH1cbiAgICB9XG4gICAgdXBkYXRlQ29udGVudEhlaWdodCgpIHtcbiAgICAgICAgY29uc3QgZWxlbWVudCA9IHRoaXMuZWxlbWVudC5uYXRpdmVFbGVtZW50O1xuICAgICAgICBjb25zdCBwYXJlbnQgPSBlbGVtZW50LnBhcmVudE5vZGU7XG4gICAgICAgIGNvbnN0IGNvbnRlbnQgPSB0aGlzLmNvbnRlbnQubmF0aXZlRWxlbWVudDtcbiAgICAgICAgY29uc3QgYXV0b0hlaWdodCA9IHRoaXMuYXV0b0hlaWdodCB8fCAhcGFyZW50LnN0eWxlLmhlaWdodDtcbiAgICAgICAgY29uc3Qgc2Nyb2xsTGVmdCA9IGNvbnRlbnQuc2Nyb2xsTGVmdDtcbiAgICAgICAgY29uc3Qgc2Nyb2xsVG9wID0gY29udGVudC5zY3JvbGxUb3A7XG4gICAgICAgIHRoaXMucmVuZGVyZXIuc2V0U3R5bGUoY29udGVudCwgJ2hlaWdodCcsICcnKTtcbiAgICAgICAgaWYgKHRoaXMudGltZXMpIHtcbiAgICAgICAgICAgIHRoaXMucmVuZGVyZXIuc2V0U3R5bGUodGhpcy50aW1lcy5uYXRpdmVFbGVtZW50LCAnaGVpZ2h0JywgJycpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChhdXRvSGVpZ2h0KSB7XG4gICAgICAgICAgICB0aGlzLmNvbnRlbnRIZWlnaHQgPSAnYXV0byc7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgbGV0IGhlaWdodCA9IHBhcmVudC5jbGllbnRIZWlnaHQ7XG4gICAgICAgIGZvciAobGV0IGlkeCA9IDA7IGlkeCA8IHBhcmVudC5jaGlsZHJlbi5sZW5ndGg7IGlkeCsrKSB7XG4gICAgICAgICAgICBjb25zdCBjaGlsZCA9IHBhcmVudC5jaGlsZHJlbltpZHhdO1xuICAgICAgICAgICAgaWYgKGNoaWxkICE9PSBlbGVtZW50ICYmICFpZ25vcmVDb250ZW50Q2hpbGQoY2hpbGQpKSB7XG4gICAgICAgICAgICAgICAgaGVpZ2h0IC09IGNoaWxkLm9mZnNldEhlaWdodDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBoZWlnaHQgLT0gdGhpcy5oZWFkZXJXcmFwID8gdGhpcy5oZWFkZXJXcmFwLm5hdGl2ZUVsZW1lbnQub2Zmc2V0SGVpZ2h0IDogMDtcbiAgICAgICAgdGhpcy5yZW5kZXJlci5zZXRTdHlsZShjb250ZW50LCAnaGVpZ2h0JywgYCR7aGVpZ2h0fXB4YCk7XG4gICAgICAgIHRoaXMuY29udGVudEhlaWdodCA9IGhlaWdodDtcbiAgICAgICAgY29udGVudC5zY3JvbGxMZWZ0ID0gc2Nyb2xsTGVmdDtcbiAgICAgICAgY29udGVudC5zY3JvbGxUb3AgPSBzY3JvbGxUb3A7XG4gICAgfVxuICAgIGdyb3VwUmVzb3VyY2VzKCkge1xuICAgICAgICBjb25zdCByZXNvdXJjZXMgPSB0aGlzLnJlc291cmNlcyB8fCBbXTtcbiAgICAgICAgY29uc3QgZ3JvdXAgPSB0aGlzLmdyb3VwIHx8IHt9O1xuICAgICAgICB0aGlzLmdyb3VwZWRSZXNvdXJjZXMgPSBncm91cFJlc291cmNlcyhncm91cCwgcmVzb3VyY2VzKTtcbiAgICAgICAgaWYgKGdyb3VwLm9yaWVudGF0aW9uICE9PSAndmVydGljYWwnKSB7XG4gICAgICAgICAgICB0aGlzLmhvcml6b250YWxSZXNvdXJjZXMgPSB0aGlzLmdyb3VwZWRSZXNvdXJjZXM7XG4gICAgICAgICAgICB0aGlzLnZlcnRpY2FsUmVzb3VyY2VzID0gW107XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLnZlcnRpY2FsUmVzb3VyY2VzID0gdGhpcy5ncm91cGVkUmVzb3VyY2VzO1xuICAgICAgICAgICAgdGhpcy5ob3Jpem9udGFsUmVzb3VyY2VzID0gW107XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5zcGFucyA9IHRoaXMucmVzb3VyY2VTcGFucygpO1xuICAgIH1cbiAgICBnZXQgdGFza1Jlc291cmNlcygpIHtcbiAgICAgICAgaWYgKHRoaXMuZ3JvdXBlZFJlc291cmNlcy5sZW5ndGgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmdyb3VwZWRSZXNvdXJjZXM7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAodGhpcy5yZXNvdXJjZXMgJiYgdGhpcy5yZXNvdXJjZXMubGVuZ3RoKSB7XG4gICAgICAgICAgICByZXR1cm4gW3RoaXMucmVzb3VyY2VzWzBdXTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiBbe31dO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJlc291cmNlU3BhbnMoKSB7XG4gICAgICAgIGNvbnN0IHNwYW5zID0gWzFdO1xuICAgICAgICBjb25zdCByZXNvdXJjZXMgPSB0aGlzLmdyb3VwZWRSZXNvdXJjZXM7XG4gICAgICAgIGxldCBzcGFuID0gMTtcbiAgICAgICAgZm9yIChsZXQgaWR4ID0gcmVzb3VyY2VzLmxlbmd0aCAtIDE7IGlkeCA+IDA7IGlkeC0tKSB7XG4gICAgICAgICAgICBzcGFuICo9ICgocmVzb3VyY2VzW2lkeF0uZGF0YSB8fCBbXSkubGVuZ3RoIHx8IDEpO1xuICAgICAgICAgICAgc3BhbnMudW5zaGlmdChzcGFuKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gc3BhbnM7XG4gICAgfVxuICAgIGlzSW5SYW5nZShkYXRlKSB7XG4gICAgICAgIGNvbnN0IGRhdGVSYW5nZSA9IHRoaXMuZGF0ZVJhbmdlKGRhdGUpO1xuICAgICAgICByZXR1cm4gKCF0aGlzLm1pbiB8fCB0aGlzLm1pbiA8IGRhdGVSYW5nZS5lbmQpICYmICghdGhpcy5tYXggfHwgZGF0ZVJhbmdlLnN0YXJ0IDw9IHRoaXMubWF4KTtcbiAgICB9XG4gICAgY3JlYXRlUERGRWxlbWVudCgpIHtcbiAgICAgICAgY29uc3QgY29udGVudEhlaWdodCA9IHRoaXMuY29udGVudEhlaWdodDtcbiAgICAgICAgY29uc3Qgc2Nyb2xsVG9wID0gdGhpcy5jb250ZW50Lm5hdGl2ZUVsZW1lbnQuc2Nyb2xsVG9wO1xuICAgICAgICBpZiAoY29udGVudEhlaWdodCAhPT0gJ2F1dG8nKSB7XG4gICAgICAgICAgICB0aGlzLmF1dG9IZWlnaHQgPSB0cnVlO1xuICAgICAgICAgICAgdGhpcy51cGRhdGVWaWV3KCk7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgZWxlbWVudCA9IHRoaXMuZWxlbWVudC5uYXRpdmVFbGVtZW50LmNsb25lTm9kZSh0cnVlKTtcbiAgICAgICAgZWxlbWVudC5zdHlsZS53aWR0aCA9IGAke3RoaXMucGRmV2lkdGgoKX1weGA7XG4gICAgICAgIGlmIChjb250ZW50SGVpZ2h0ICE9PSAnYXV0bycpIHtcbiAgICAgICAgICAgIHRoaXMuYXV0b0hlaWdodCA9IGZhbHNlO1xuICAgICAgICAgICAgdGhpcy51cGRhdGVWaWV3KCk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5wZGZTZXJ2aWNlLmVsZW1lbnRSZWFkeS5lbWl0KHtcbiAgICAgICAgICAgIGVsZW1lbnQ6IGVsZW1lbnRcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuY29udGVudC5uYXRpdmVFbGVtZW50LnNjcm9sbFRvcCA9IHNjcm9sbFRvcDtcbiAgICB9XG4gICAgcGRmV2lkdGgoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmVsZW1lbnQubmF0aXZlRWxlbWVudC5vZmZzZXRXaWR0aDtcbiAgICB9XG4gICAgY29udGFpbmVyQnlQb3NpdGlvbih7IHgsIHkgfSkge1xuICAgICAgICBjb25zdCBjb250ZW50ID0gdGhpcy5jb250ZW50Lm5hdGl2ZUVsZW1lbnQ7XG4gICAgICAgIGNvbnN0IG9mZnNldCA9IGVsZW1lbnRPZmZzZXQoY29udGVudCk7XG4gICAgICAgIGlmIChvZmZzZXQudG9wIDw9IHkgJiYgeSA8PSBvZmZzZXQudG9wICsgb2Zmc2V0LmhlaWdodCAmJiBvZmZzZXQubGVmdCA8PSB4ICYmIHggPD0gb2Zmc2V0LmxlZnQgKyBvZmZzZXQud2lkdGgpIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgZWxlbWVudDogY29udGVudCxcbiAgICAgICAgICAgICAgICBvZmZzZXQ6IG9mZnNldFxuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBleGVjdXRlKGUpIHtcbiAgICAgICAgaWYgKGUubmFtZSA9PT0gJ3Nsb3RCeVBvc2l0aW9uJykge1xuICAgICAgICAgICAgY29uc3QgY29udGFpbmVyID0gdGhpcy5jb250YWluZXJCeVBvc2l0aW9uKGUuYXJncyk7XG4gICAgICAgICAgICBpZiAoY29udGFpbmVyKSB7XG4gICAgICAgICAgICAgICAgY29uc3Qgb2Zmc2V0ID0gdGhpcy5jb29yZGluYXRlc09mZnNldChlLmFyZ3MueCwgZS5hcmdzLnksIGNvbnRhaW5lci5lbGVtZW50LCBjb250YWluZXIub2Zmc2V0KTtcbiAgICAgICAgICAgICAgICBjb25zdCBzbG90ID0gdGhpcy5zbG90QnlQb3NpdGlvbihvZmZzZXQueCwgb2Zmc2V0LnksIGNvbnRhaW5lci5lbGVtZW50KTtcbiAgICAgICAgICAgICAgICBlLnJlc3VsdCh0aGlzLnNsb3RGaWVsZHMoc2xvdCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGUubmFtZSA9PT0gJ2V2ZW50RnJvbUVsZW1lbnQnKSB7XG4gICAgICAgICAgICBjb25zdCB0YXJnZXQgPSB0aGlzLnRhcmdldFRhc2soZS5hcmdzLmVsZW1lbnQpO1xuICAgICAgICAgICAgaWYgKHRhcmdldCkge1xuICAgICAgICAgICAgICAgIGUucmVzdWx0KHRhcmdldC50YXNrLmV2ZW50KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICBzbG90RmllbGRzKHNsb3QpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGVsZW1lbnQ6IHNsb3QuZWxlbWVudCxcbiAgICAgICAgICAgIHJlc291cmNlczogdGhpcy5ncm91cGVkUmVzb3VyY2VzLmxlbmd0aCA/IHRoaXMucmVzb3VyY2VzQnlJbmRleChzbG90LmlkLnJlc291cmNlSW5kZXgpIDogW10sXG4gICAgICAgICAgICBzdGFydDogdGhpcy5jb252ZXJ0RGF0ZShzbG90LnN0YXJ0KSxcbiAgICAgICAgICAgIGVuZDogdGhpcy5jb252ZXJ0RGF0ZShzbG90LmVuZClcbiAgICAgICAgfTtcbiAgICB9XG59XG5CYXNlVmlldy5wcm9wRGVjb3JhdG9ycyA9IHtcbiAgICDQtXZlbnRUZW1wbGF0ZTogW3sgdHlwZTogSW5wdXQgfV0sXG4gICAgZ3JvdXBIZWFkZXJUZW1wbGF0ZTogW3sgdHlwZTogSW5wdXQgfV0sXG4gICAgc2VsZWN0ZWREYXRlRm9ybWF0OiBbeyB0eXBlOiBJbnB1dCB9XSxcbiAgICBzZWxlY3RlZFNob3J0RGF0ZUZvcm1hdDogW3sgdHlwZTogSW5wdXQgfV0sXG4gICAgZXZlbnRIZWlnaHQ6IFt7IHR5cGU6IElucHV0IH1dLFxuICAgIHNsb3RDbGFzczogW3sgdHlwZTogSW5wdXQgfV0sXG4gICAgZXZlbnRDbGFzczogW3sgdHlwZTogSW5wdXQgfV0sXG4gICAgZXZlbnRTdHlsZXM6IFt7IHR5cGU6IElucHV0IH1dLFxuICAgIGNvbnRlbnQ6IFt7IHR5cGU6IFZpZXdDaGlsZCwgYXJnczogWydjb250ZW50JyxdIH1dLFxuICAgIGhlYWRlcjogW3sgdHlwZTogVmlld0NoaWxkLCBhcmdzOiBbJ2hlYWRlcicsXSB9XSxcbiAgICBjb250ZW50VGFibGU6IFt7IHR5cGU6IFZpZXdDaGlsZCwgYXJnczogWydjb250ZW50VGFibGUnLF0gfV0sXG4gICAgdGltZXM6IFt7IHR5cGU6IFZpZXdDaGlsZCwgYXJnczogWyd0aW1lcycsXSB9XSxcbiAgICB0aW1lc0hlYWRlcjogW3sgdHlwZTogVmlld0NoaWxkLCBhcmdzOiBbJ3RpbWVzSGVhZGVyJyxdIH1dLFxuICAgIHRpbWVzVGFibGU6IFt7IHR5cGU6IFZpZXdDaGlsZCwgYXJnczogWyd0aW1lc1RhYmxlJyxdIH1dLFxuICAgIGhlYWRlcldyYXA6IFt7IHR5cGU6IFZpZXdDaGlsZCwgYXJnczogWydoZWFkZXJXcmFwJyxdIH1dLFxuICAgIGhpbnRDb250YWluZXI6IFt7IHR5cGU6IFZpZXdDaGlsZCwgYXJnczogWydoaW50Q29udGFpbmVyJyxdIH1dXG59O1xuXG5jb25zdCBEQVlTX0lOX1dFRUtfQ09VTlQgPSA3O1xuY29uc3QgV0VFS1NfQ09VTlQgPSA2O1xuLyoqXG4gKiBAaGlkZGVuXG4gKi9cbmNsYXNzIE1vbnRoVmlld1JlbmRlcmVyQ29tcG9uZW50IGV4dGVuZHMgQmFzZVZpZXcge1xuICAgIGNvbnN0cnVjdG9yKHZpZXdDb250ZXh0LCB2aWV3U3RhdGUsIGludGwsIHNsb3RTZXJ2aWNlLCB6b25lLCBlbGVtZW50LCByZW5kZXJlciwgcGRmU2VydmljZSwgbG9jYWxpemF0aW9uKSB7XG4gICAgICAgIHN1cGVyKHZpZXdDb250ZXh0LCB2aWV3U3RhdGUsIGludGwsIHNsb3RTZXJ2aWNlLCB6b25lLCByZW5kZXJlciwgZWxlbWVudCwgcGRmU2VydmljZSwgbG9jYWxpemF0aW9uKTtcbiAgICAgICAgdGhpcy5yZXNpemVIaW50Rm9ybWF0ID0geyBza2VsZXRvbjogJ01kJyB9O1xuICAgICAgICB0aGlzLndlZWtzID0gW107XG4gICAgfVxuICAgIGdldCBtb250aERheVNsb3RUZW1wbGF0ZVJlZigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubW9udGhEYXlTbG90VGVtcGxhdGUgfHwgKHRoaXMuc2NoZWR1bGVyTW9udGhEYXlTbG90VGVtcGxhdGUgfHwge30pLnRlbXBsYXRlUmVmO1xuICAgIH1cbiAgICBob3Jpem9udGFsQ29sc3BhbihyZXNvdXJjZUluZGV4KSB7XG4gICAgICAgIGNvbnN0IHJlc291cmNlcyA9IHRoaXMuaG9yaXpvbnRhbFJlc291cmNlcztcbiAgICAgICAgbGV0IHJlc3VsdCA9IERBWVNfSU5fV0VFS19DT1VOVDtcbiAgICAgICAgZm9yIChsZXQgaWR4ID0gcmVzb3VyY2VJbmRleCArIDE7IGlkeCA8IHJlc291cmNlcy5sZW5ndGg7IGlkeCsrKSB7XG4gICAgICAgICAgICByZXN1bHQgKj0gKHJlc291cmNlc1tpZHhdLmRhdGEgfHwgW10pLmxlbmd0aCB8fCAxO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfVxuICAgIHZlcnRpY2FsUm93c3BhbihyZXNvdXJjZUluZGV4KSB7XG4gICAgICAgIGNvbnN0IHJlc291cmNlcyA9IHRoaXMudmVydGljYWxSZXNvdXJjZXM7XG4gICAgICAgIGxldCByZXN1bHQgPSBXRUVLU19DT1VOVDtcbiAgICAgICAgZm9yIChsZXQgaWR4ID0gcmVzb3VyY2VJbmRleCArIDE7IGlkeCA8IHJlc291cmNlcy5sZW5ndGg7IGlkeCsrKSB7XG4gICAgICAgICAgICByZXN1bHQgKj0gKHJlc291cmNlc1tpZHhdLmRhdGEgfHwgW10pLmxlbmd0aCB8fCAxO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfVxuICAgIHZlcnRpY2FsSXRlbShsZWFmSW5kZXgsIHJlc291cmNlSW5kZXgpIHtcbiAgICAgICAgY29uc3QgZGF0YSA9IHRoaXMudmVydGljYWxSZXNvdXJjZXNbcmVzb3VyY2VJbmRleF0uZGF0YSB8fCBbXTtcbiAgICAgICAgY29uc3QgcmVzb3VyY2VzID0gdGhpcy52ZXJ0aWNhbFJlc291cmNlcztcbiAgICAgICAgbGV0IHJlc3VsdCA9IDE7XG4gICAgICAgIGZvciAobGV0IGlkeCA9IHJlc291cmNlSW5kZXggKyAxOyBpZHggPCByZXNvdXJjZXMubGVuZ3RoOyBpZHgrKykge1xuICAgICAgICAgICAgcmVzdWx0ICo9ICgocmVzb3VyY2VzW2lkeF0uZGF0YSB8fCBbXSkubGVuZ3RoIHx8IDEpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBkYXRhWyhsZWFmSW5kZXggLyByZXN1bHQpICUgZGF0YS5sZW5ndGhdO1xuICAgIH1cbiAgICBkYXlTbG90Q2xhc3MoZGF5LCByZXNvdXJjZUluZGV4KSB7XG4gICAgICAgIGlmICh0aGlzLnNsb3RDbGFzcykge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc2xvdENsYXNzKHtcbiAgICAgICAgICAgICAgICBzdGFydDogZGF5LFxuICAgICAgICAgICAgICAgIGVuZDogYWRkRGF5cyhkYXksIDEpLFxuICAgICAgICAgICAgICAgIHJlc291cmNlczogdGhpcy5yZXNvdXJjZXNCeUluZGV4KHJlc291cmNlSW5kZXgpLFxuICAgICAgICAgICAgICAgIGlzQWxsRGF5OiBmYWxzZVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgb3B0aW9uc0NoYW5nZShjaGFuZ2VzKSB7XG4gICAgICAgIHRoaXMuc2NoZWR1bGVyTW9udGhEYXlTbG90VGVtcGxhdGUgPSBjaGFuZ2VzLm1vbnRoRGF5U2xvdFRlbXBsYXRlO1xuICAgICAgICBzdXBlci5vcHRpb25zQ2hhbmdlKGNoYW5nZXMpO1xuICAgIH1cbiAgICBjcmVhdGVUYXNrcyhpdGVtcywgZGF0ZVJhbmdlKSB7XG4gICAgICAgIHRoaXMud2Vla3MgPSB0aGlzLmNyZWF0ZURheVNsb3RzKGRhdGVSYW5nZSk7XG4gICAgICAgIHJldHVybiBjcmVhdGVUYXNrcyhkYXRlUmFuZ2Uuc3RhcnQsIGRhdGVSYW5nZS5lbmQsIGl0ZW1zLCB0aGlzLndlZWtzKTtcbiAgICB9XG4gICAgb25UYXNrc0NoYW5nZSgpIHtcbiAgICAgICAgdXBkYXRlVGFza0RhdGEodGhpcy50YXNrcyk7XG4gICAgICAgIHRoaXMuaXRlbXMubmV4dCh0aGlzLnRhc2tzKTtcbiAgICB9XG4gICAgcmVmbG93KCkge1xuICAgICAgICB0aGlzLnVwZGF0ZUNvbnRlbnRIZWlnaHQoKTtcbiAgICAgICAgY29uc3QgY29udGVudCA9IHRoaXMuY29udGVudC5uYXRpdmVFbGVtZW50O1xuICAgICAgICB0aGlzLnNsb3RTZXJ2aWNlLmNvbnRhaW5lclNpemUgPSBjb250ZW50LnNjcm9sbFdpZHRoO1xuICAgICAgICBpZiAodGhpcy5jb250ZW50SGVpZ2h0ID09PSAnYXV0bycpIHtcbiAgICAgICAgICAgIC8vIGJpZ2dlciBzaXplIGNoYW5nZXMgY2F1c2UgdGhlIHRhYmxlIHRvIG92ZXJmbG93IHRoZSBjb250YWluZXIgYW5kIGluIGhvcml6b250YWwgc2Nyb2xsYmFyc1xuICAgICAgICAgICAgLy8gdGhpcyBjaGFuZ2VzIHRoZSB0YWJsZSBhbmQgc2xvdHMgc2l6ZSBkdXJpbmcgcmVuZGVyaW5nIGJlZm9yZSB0aGUgYnJvd3NlciByZS1hZGp1c3RzIHRoZSAxMDAlIHRhYmxlIHdpZHRoXG4gICAgICAgICAgICBjb250ZW50LnN0eWxlLm92ZXJmbG93ID0gJ3Zpc2libGUnO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuc2xvdFNlcnZpY2UubGF5b3V0KHRoaXMuZXZlbnRIZWlnaHQpO1xuICAgICAgICBpZiAodGhpcy5jb250ZW50SGVpZ2h0ID09PSAnYXV0bycpIHtcbiAgICAgICAgICAgIGNvbnRlbnQuc3R5bGUub3ZlcmZsb3cgPSAnJztcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnN5bmNUYWJsZXMoKTtcbiAgICB9XG4gICAgb25DbGljayhlLCBldmVudFR5cGUgPSBlLnR5cGUpIHtcbiAgICAgICAgaWYgKGV2ZW50VHlwZSA9PT0gJ2NsaWNrJykge1xuICAgICAgICAgICAgY29uc3QgZXZlbnRTbG90ID0gY2xvc2VzdEluU2NvcGUoZS50YXJnZXQsIG5vZGUgPT4gbm9kZS5oYXNBdHRyaWJ1dGUoJ2RhdGEtc2xvdC1pbmRleCcpLCB0aGlzLmVsZW1lbnQubmF0aXZlRWxlbWVudCk7XG4gICAgICAgICAgICBjb25zdCBuYXZpZ2F0ZVRvRGF5ID0gY2xvc2VzdEluU2NvcGUoZS50YXJnZXQsIG5vZGUgPT4gaGFzQ2xhc3Nlcyhub2RlLCAnay1tb3JlLWV2ZW50cyBrLW5hdi1kYXknKSwgZXZlbnRTbG90KTtcbiAgICAgICAgICAgIGlmIChldmVudFNsb3QgJiYgbmF2aWdhdGVUb0RheSkge1xuICAgICAgICAgICAgICAgIGNvbnN0IGluZGV4ID0gZXZlbnRTbG90LmdldEF0dHJpYnV0ZSgnZGF0YS1zbG90LWluZGV4Jyk7XG4gICAgICAgICAgICAgICAgY29uc3Qgc2xvdCA9IHRoaXMuc2xvdFNlcnZpY2Uuc2xvdEJ5SW5kZXgoaW5kZXgpO1xuICAgICAgICAgICAgICAgIHRoaXMuem9uZS5ydW4oKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnZpZXdTdGF0ZS5uYXZpZ2F0ZVRvKHsgdmlld05hbWU6ICdkYXknLCBkYXRlOiB0b0xvY2FsRGF0ZShzbG90LnN0YXJ0KSB9KTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgc3VwZXIub25DbGljayhlLCBldmVudFR5cGUpO1xuICAgIH1cbiAgICBzbG90QnlJbmRleChpbmRleCwgX2FyZ3MpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuc2xvdFNlcnZpY2Uuc2xvdEJ5SW5kZXgoaW5kZXgpO1xuICAgIH1cbiAgICBvblNlbGVjdERhdGUoZGF0ZSkge1xuICAgICAgICBjb25zdCBkYXRlUmFuZ2UgPSB0aGlzLmRhdGVSYW5nZShkYXRlKTtcbiAgICAgICAgdGhpcy5zZWxlY3RlZERhdGUgPSBkYXRlO1xuICAgICAgICB0aGlzLnZpZXdTdGF0ZS5ub3RpZnlEYXRlUmFuZ2UoZGF0ZVJhbmdlKTtcbiAgICAgICAgdGhpcy53ZWVrcyA9IHRoaXMuY3JlYXRlRGF5U2xvdHMoZGF0ZVJhbmdlKTtcbiAgICB9XG4gICAgb25BY3Rpb24oZSkge1xuICAgICAgICBjb25zdCBub3cgPSBnZXREYXRlKHRoaXMuc2VsZWN0ZWREYXRlKTtcbiAgICAgICAgaWYgKGUudHlwZSA9PT0gJ25leHQnKSB7XG4gICAgICAgICAgICBjb25zdCBuZXh0ID0gZmlyc3REYXlPZk1vbnRoKGFkZE1vbnRocyhub3csIDEpKTtcbiAgICAgICAgICAgIGlmICh0aGlzLmlzSW5SYW5nZShuZXh0KSkge1xuICAgICAgICAgICAgICAgIHRoaXMudmlld1N0YXRlLm5vdGlmeU5leHREYXRlKG5leHQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmIChlLnR5cGUgPT09ICdwcmV2Jykge1xuICAgICAgICAgICAgY29uc3QgbmV4dCA9IGZpcnN0RGF5T2ZNb250aChhZGRNb250aHMobm93LCAtMSkpO1xuICAgICAgICAgICAgaWYgKHRoaXMuaXNJblJhbmdlKG5leHQpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy52aWV3U3RhdGUubm90aWZ5TmV4dERhdGUobmV4dCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgZGF0ZVJhbmdlKGRhdGUgPSB0aGlzLnNlbGVjdGVkRGF0ZSkge1xuICAgICAgICBjb25zdCBtb250aFN0YXJ0ID0gZmlyc3REYXlPZk1vbnRoKGdldERhdGUoZGF0ZSkpO1xuICAgICAgICBjb25zdCBzdGFydCA9IGZpcnN0RGF5SW5XZWVrKG1vbnRoU3RhcnQsIHRoaXMuaW50bC5maXJzdERheSgpKTtcbiAgICAgICAgY29uc3QgZW5kID0gYWRkRGF5cyhzdGFydCwgREFZU19JTl9XRUVLX0NPVU5UICogV0VFS1NfQ09VTlQpO1xuICAgICAgICBjb25zdCB0ZXh0ID0gdGhpcy5pbnRsLmZvcm1hdCh0aGlzLnNlbGVjdGVkRGF0ZUZvcm1hdCwgbW9udGhTdGFydCk7XG4gICAgICAgIGNvbnN0IHNob3J0VGV4dCA9IHRoaXMuaW50bC5mb3JtYXQodGhpcy5zZWxlY3RlZFNob3J0RGF0ZUZvcm1hdCwgbW9udGhTdGFydCk7XG4gICAgICAgIHJldHVybiB7IHN0YXJ0LCBlbmQsIHRleHQsIHNob3J0VGV4dCB9O1xuICAgIH1cbiAgICBkcmFnUmFuZ2VzKHNsb3QpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuc2xvdFNlcnZpY2UuZHJhZ1JhbmdlcyhzbG90LCB0aGlzLmRyYWdnaW5nLm9mZnNldCk7XG4gICAgfVxuICAgIGRyYWdIaW50U2l6ZShmaXJzdCwgbGFzdCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgd2lkdGg6IHRvUHgobGFzdC5yZWN0LmxlZnQgLSBmaXJzdC5yZWN0LmxlZnQgKyBsYXN0LnJlY3Qud2lkdGgpLFxuICAgICAgICAgICAgaGVpZ2h0OiB0b1B4KGZpcnN0LmhlaWdodClcbiAgICAgICAgfTtcbiAgICB9XG4gICAgc2xvdEJ5UG9zaXRpb24oeCwgeSkge1xuICAgICAgICByZXR1cm4gdGhpcy5zbG90U2VydmljZS5zbG90QnlQb3NpdGlvbih4LCB5KTtcbiAgICB9XG4gICAgY3JlYXRlRGF5U2xvdHMoeyBzdGFydCB9KSB7XG4gICAgICAgIGNvbnN0IHdlZWtzID0gW107XG4gICAgICAgIGxldCBkYXRlID0gc3RhcnQ7XG4gICAgICAgIGZvciAobGV0IGlkeCA9IDA7IGlkeCA8IFdFRUtTX0NPVU5UOyBpZHgrKykge1xuICAgICAgICAgICAgY29uc3Qgd2VlayA9IFtdO1xuICAgICAgICAgICAgd2Vla3MucHVzaCh3ZWVrKTtcbiAgICAgICAgICAgIGZvciAobGV0IGRheUlkeCA9IDA7IGRheUlkeCA8IERBWVNfSU5fV0VFS19DT1VOVDsgZGF5SWR4KyspIHtcbiAgICAgICAgICAgICAgICB3ZWVrLnB1c2goZGF0ZSk7XG4gICAgICAgICAgICAgICAgZGF0ZSA9IGFkZERheXMoZGF0ZSwgMSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHdlZWtzO1xuICAgIH1cbn1cbk1vbnRoVmlld1JlbmRlcmVyQ29tcG9uZW50LmRlY29yYXRvcnMgPSBbXG4gICAgeyB0eXBlOiBDb21wb25lbnQsIGFyZ3M6IFt7XG4gICAgICAgICAgICAgICAgLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOmNvbXBvbmVudC1zZWxlY3RvclxuICAgICAgICAgICAgICAgIHNlbGVjdG9yOiAnbW9udGgtdmlldycsXG4gICAgICAgICAgICAgICAgcHJvdmlkZXJzOiBbXG4gICAgICAgICAgICAgICAgICAgIE1vbnRoU2xvdFNlcnZpY2VcbiAgICAgICAgICAgICAgICBdLFxuICAgICAgICAgICAgICAgIHRlbXBsYXRlOiBgXG4gICAgICAgIDxkaXYgY2xhc3M9XCJrLXNjaGVkdWxlci1sYXlvdXQgay1zY2hlZHVsZXItbW9udGh2aWV3IGstc2NoZWR1bGVyLWZsZXgtbGF5b3V0XCI+XG4gICAgICAgICAgICA8ZGl2IGNsYXNzPVwiay1zY2hlZHVsZXItcGFuZVwiPlxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJrLXNjaGVkdWxlci10aW1lc1wiICN0aW1lc0hlYWRlciAqbmdJZj1cInZlcnRpY2FsUmVzb3VyY2VzLmxlbmd0aFwiPlxuICAgICAgICAgICAgICAgICAgICA8dGFibGUgY2xhc3M9XCJrLXNjaGVkdWxlci10YWJsZVwiIGFyaWEtaGlkZGVuPVwidHJ1ZVwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgPHRyPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0aD48L3RoPlxuICAgICAgICAgICAgICAgICAgICAgICAgPC90cj5cbiAgICAgICAgICAgICAgICAgICAgPC90YWJsZT5cbiAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwiay1zY2hlZHVsZXItaGVhZGVyIGstc3RhdGUtZGVmYXVsdFwiICNoZWFkZXI+XG4gICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJrLXNjaGVkdWxlci1oZWFkZXItd3JhcFwiICNoZWFkZXJXcmFwPlxuICAgICAgICAgICAgICAgICAgICAgICA8dGFibGUgY2xhc3M9XCJrLXNjaGVkdWxlci10YWJsZVwiIGFyaWEtaGlkZGVuPVwidHJ1ZVwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgIDx0ciAqbmdGb3I9XCJsZXQgcmVzb3VyY2Ugb2YgaG9yaXpvbnRhbFJlc291cmNlczsgbGV0IHJlc291cmNlSW5kZXggPSBpbmRleDsgdHJhY2tCeTogaXRlbUluZGV4XCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0aCAqbmdGb3I9XCJsZXQgaXRlbSBvZiBob3Jpem9udGFsUmVzb3VyY2VzIHwgcmVzb3VyY2VJdGVyYXRvciA6IHJlc291cmNlSW5kZXg7IHRyYWNrQnk6IGl0ZW1JbmRleFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzcz1cImstc2xvdC1jZWxsXCIgW2F0dHIuY29sc3Bhbl09XCJob3Jpem9udGFsQ29sc3BhbihyZXNvdXJjZUluZGV4KVwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8bmctY29udGFpbmVyICpuZ0lmPVwiIWdyb3VwSGVhZGVyVGVtcGxhdGVSZWZcIj57eyBnZXRGaWVsZChpdGVtLCByZXNvdXJjZS50ZXh0RmllbGQpIH19PC9uZy1jb250YWluZXI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxuZy1jb250YWluZXIgKm5nSWY9XCJncm91cEhlYWRlclRlbXBsYXRlUmVmXCIgW25nVGVtcGxhdGVPdXRsZXRdPVwiZ3JvdXBIZWFkZXJUZW1wbGF0ZVJlZlwiIFtuZ1RlbXBsYXRlT3V0bGV0Q29udGV4dF09XCJ7IHJlc291cmNlOiBpdGVtIH1cIj48L25nLWNvbnRhaW5lcj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC90aD5cbiAgICAgICAgICAgICAgICAgICAgICAgICA8L3RyPlxuICAgICAgICAgICAgICAgICAgICAgICAgIDx0cj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPG5nLWNvbnRhaW5lciAqbmdGb3I9XCJsZXQgcmVzb3VyY2Ugb2YgaG9yaXpvbnRhbFJlc291cmNlcyB8IHJlc291cmNlSXRlcmF0b3I7IHRyYWNrQnk6IGl0ZW1JbmRleFwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRoICpuZ0Zvcj1cImxldCBkYXkgb2Ygd2Vla3NbMF07IHRyYWNrQnk6IGl0ZW1JbmRleFwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHt7IGRheSB8IGtlbmRvRGF0ZTogJ0VFRUUnIH19XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3RoPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L25nLWNvbnRhaW5lcj5cbiAgICAgICAgICAgICAgICAgICAgICAgICA8L3RyPlxuICAgICAgICAgICAgICAgICAgICAgICA8L3RhYmxlPlxuICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgPGRpdiBjbGFzcz1cImstc2NoZWR1bGVyLXBhbmVcIj5cbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwiay1zY2hlZHVsZXItdGltZXMgay1zY2hlZHVsZXItcmVzb3VyY2VzXCIgI3RpbWVzICpuZ0lmPVwidmVydGljYWxSZXNvdXJjZXMubGVuZ3RoXCI+XG4gICAgICAgICAgICAgICAgICAgIDx0YWJsZSBjbGFzcz1cImstc2NoZWR1bGVyLXRhYmxlXCIgI3RpbWVzVGFibGUgYXJpYS1oaWRkZW49XCJ0cnVlXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICA8bmctY29udGFpbmVyICpuZ0Zvcj1cImxldCByZXNvdXJjZUl0ZW0gb2YgdmVydGljYWxSZXNvdXJjZXMgfCByZXNvdXJjZUl0ZXJhdG9yOyBsZXQgbGVhZkluZGV4ID0gaW5kZXg7IHRyYWNrQnk6IGl0ZW1JbmRleFwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0cj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPG5nLWNvbnRhaW5lciAqbmdGb3I9XCJsZXQgcmVzb3VyY2Ugb2YgdmVydGljYWxSZXNvdXJjZXM7IGxldCByZXNvdXJjZUluZGV4ID0gaW5kZXg7IHRyYWNrQnk6IGl0ZW1JbmRleFwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRoICpuZ0lmPVwidmVydGljYWxJdGVtKGxlYWZJbmRleCwgcmVzb3VyY2VJbmRleClcIiBbYXR0ci5yb3dzcGFuXT1cInZlcnRpY2FsUm93c3BhbihyZXNvdXJjZUluZGV4KVwiIGNsYXNzPVwiay1zbG90LWNlbGxcIiBbbmdDbGFzc109XCJ7ICdrLWxhc3QtcmVzb3VyY2UnOiByZXNvdXJjZUluZGV4ID09PSB2ZXJ0aWNhbFJlc291cmNlcy5sZW5ndGggLSAxIH1cIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8bmctY29udGFpbmVyICpuZ0lmPVwiIWdyb3VwSGVhZGVyVGVtcGxhdGVSZWZcIj57eyBnZXRGaWVsZCh2ZXJ0aWNhbEl0ZW0obGVhZkluZGV4LCByZXNvdXJjZUluZGV4KSwgcmVzb3VyY2UudGV4dEZpZWxkKSB9fTwvbmctY29udGFpbmVyPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxuZy1jb250YWluZXIgKm5nSWY9XCJncm91cEhlYWRlclRlbXBsYXRlUmVmXCIgW25nVGVtcGxhdGVPdXRsZXRdPVwiZ3JvdXBIZWFkZXJUZW1wbGF0ZVJlZlwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFtuZ1RlbXBsYXRlT3V0bGV0Q29udGV4dF09XCJ7IHJlc291cmNlOiB2ZXJ0aWNhbEl0ZW0obGVhZkluZGV4LCByZXNvdXJjZUluZGV4KSB9XCI+PC9uZy1jb250YWluZXI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3RoPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L25nLWNvbnRhaW5lcj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRoIGNsYXNzPVwiay1zbG90LWNlbGwgay1lbXB0eS1zbG90XCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvdGg+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPC90cj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dHIgKm5nRm9yPVwibGV0IGluZGV4IG9mIDUgfCByZXBlYXQ7IHRyYWNrQnk6IGl0ZW1JbmRleFwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGggY2xhc3M9XCJrLXNsb3QtY2VsbCBrLWVtcHR5LXNsb3RcIj48L3RoPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvdHI+XG4gICAgICAgICAgICAgICAgICAgICAgICA8L25nLWNvbnRhaW5lcj5cbiAgICAgICAgICAgICAgICAgICAgPC90YWJsZT5cbiAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwiay1zY2hlZHVsZXItY29udGVudFwiICNjb250ZW50PlxuICAgICAgICAgICAgICAgICAgICAgPHRhYmxlIGNsYXNzPVwiay1zY2hlZHVsZXItdGFibGVcIiAjY29udGVudFRhYmxlIHJvbGU9XCJwcmVzZW50YXRpb25cIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICA8bmctY29udGFpbmVyICpuZ0Zvcj1cImxldCByZXNvdXJjZUl0ZW0gb2YgdmVydGljYWxSZXNvdXJjZXMgfCByZXNvdXJjZUl0ZXJhdG9yOyBsZXQgdmVydGljYWxJbmRleCA9IGluZGV4OyB0cmFja0J5OiBpdGVtSW5kZXhcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRyICpuZ0Zvcj1cImxldCB3ZWVrIG9mIHdlZWtzOyAgbGV0IHJhbmdlSW5kZXggPSBpbmRleDsgdHJhY2tCeTogaXRlbUluZGV4XCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxuZy1jb250YWluZXIgKm5nRm9yPVwibGV0IHJlc291cmNlIG9mIGhvcml6b250YWxSZXNvdXJjZXMgfCByZXNvdXJjZUl0ZXJhdG9yOyBsZXQgaG9yaXpvbnRhbEluZGV4ID0gaW5kZXg7IHRyYWNrQnk6IGl0ZW1JbmRleFwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0ZCAqbmdGb3I9XCJsZXQgZGF5IG9mIHdlZWs7IGxldCBpbmRleCA9IGluZGV4OyB0cmFja0J5OiBpdGVtSW5kZXhcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtb250aFNsb3RcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgW25nQ2xhc3NdPVwiZGF5U2xvdENsYXNzKGRheSwgdmVydGljYWxSZXNvdXJjZXMubGVuZ3RoID8gdmVydGljYWxJbmRleCA6IGhvcml6b250YWxJbmRleClcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbc3RhcnRdPVwiZGF5XCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgW2lkXT1cInsgcmVzb3VyY2VJbmRleDogdmVydGljYWxSZXNvdXJjZXMubGVuZ3RoID8gdmVydGljYWxJbmRleCA6IGhvcml6b250YWxJbmRleCwgcmFuZ2VJbmRleDogcmFuZ2VJbmRleCwgaW5kZXg6IGluZGV4IH1cIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz1cImstbGluayBrLW5hdi1kYXlcIiAqbmdJZj1cIiFtb250aERheVNsb3RUZW1wbGF0ZVJlZlwiPnt7IGRheSB8IGtlbmRvRGF0ZTogJ2RkJyB9fTwvc3Bhbj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8bmctY29udGFpbmVyICpuZ0lmPVwibW9udGhEYXlTbG90VGVtcGxhdGVSZWZcIiBbbmdUZW1wbGF0ZU91dGxldF09XCJtb250aERheVNsb3RUZW1wbGF0ZVJlZlwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFtuZ1RlbXBsYXRlT3V0bGV0Q29udGV4dF09XCJ7IGRhdGU6IGRheSwgcmVzb3VyY2VzOiByZXNvdXJjZXNCeUluZGV4KHZlcnRpY2FsUmVzb3VyY2VzLmxlbmd0aCA/IHZlcnRpY2FsSW5kZXggOiBob3Jpem9udGFsSW5kZXgpIH1cIj48L25nLWNvbnRhaW5lcj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3RkPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L25nLWNvbnRhaW5lcj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC90cj5cbiAgICAgICAgICAgICAgICAgICAgICAgICA8L25nLWNvbnRhaW5lcj5cbiAgICAgICAgICAgICAgICAgICAgIDwvdGFibGU+XG4gICAgICAgICAgICAgICAgICAgICA8bmctY29udGFpbmVyICpuZ0Zvcj1cImxldCBpdGVtIG9mIGl0ZW1zIHwgYXN5bmM7IHRyYWNrQnk6IGl0ZW1JbmRleFwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgKm5nRm9yPVwibGV0IGl0ZW1SZXNvdXJjZSBvZiBpdGVtLnJlc291cmNlczsgdHJhY2tCeTogaXRlbUluZGV4XCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbbmdDbGFzc109XCJnZXRFdmVudENsYXNzZXMoaXRlbSwgaXRlbVJlc291cmNlLnJlc291cmNlcylcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFtuZ1N0eWxlXT1cImdldEV2ZW50U3R5bGVzKGl0ZW0sIGl0ZW1SZXNvdXJjZSlcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFtrZW5kb1NjaGVkdWxlckZvY3VzSW5kZXhdPVwiaXRlbVJlc291cmNlLmxlYWZJZHhcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1vbnRoVmlld0l0ZW1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgW2VkaXRhYmxlXT1cImVkaXRhYmxlXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgW2l0ZW1dPVwiaXRlbVwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFtpbmRleF09XCJpdGVtLmluZGV4XCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgW3JhbmdlSW5kZXhdPVwiaXRlbS5yYW5nZUluZGV4XCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgW2V2ZW50VGVtcGxhdGVdPVwiZXZlbnRUZW1wbGF0ZVJlZlwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFtyZXNvdXJjZXNdPVwiaXRlbVJlc291cmNlLnJlc291cmNlc1wiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFtyZXNvdXJjZUluZGV4XT1cIml0ZW1SZXNvdXJjZS5sZWFmSWR4XCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgICA8L25nLWNvbnRhaW5lcj5cbiAgICAgICAgICAgICAgICAgICAgIDxrZW5kby1oaW50LWNvbnRhaW5lciAjaGludENvbnRhaW5lcj5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxuZy10ZW1wbGF0ZT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2ICpuZ0Zvcj1cImxldCBoaW50IG9mIGRyYWdIaW50czsgdHJhY2tCeTogaXRlbUluZGV4O1wiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzPVwiay1ldmVudC1kcmFnLWhpbnRcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtb250aFZpZXdJdGVtXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbbmdTdHlsZV09XCJoaW50LnN0eWxlXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFtuZ0NsYXNzXT1cImhpbnQuY2xhc3NcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgW2RyYWdIaW50XT1cInRydWVcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgW2V2ZW50VGVtcGxhdGVdPVwiZXZlbnRUZW1wbGF0ZVJlZlwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbaXRlbV09XCJoaW50Lml0ZW1cIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgW3Jlc291cmNlc109XCJoaW50LnJlc291cmNlc1wiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiAqbmdGb3I9XCJsZXQgaGludCBvZiByZXNpemVIaW50czsgdHJhY2tCeTogaXRlbUluZGV4O1wiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGtlbmRvUmVzaXplSGludFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgW2hpbnRdPVwiaGludFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbbmdDbGFzc109XCJoaW50LmNsYXNzXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFtmb3JtYXRdPVwicmVzaXplSGludEZvcm1hdFwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICAgICAgPC9uZy10ZW1wbGF0ZT5cbiAgICAgICAgICAgICAgICAgICAgIDwva2VuZG8taGludC1jb250YWluZXI+XG4gICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgPC9kaXY+XG4gICAgYFxuICAgICAgICAgICAgfSxdIH0sXG5dO1xuLyoqIEBub2NvbGxhcHNlICovXG5Nb250aFZpZXdSZW5kZXJlckNvbXBvbmVudC5jdG9yUGFyYW1ldGVycyA9ICgpID0+IFtcbiAgICB7IHR5cGU6IFZpZXdDb250ZXh0U2VydmljZSB9LFxuICAgIHsgdHlwZTogVmlld1N0YXRlU2VydmljZSB9LFxuICAgIHsgdHlwZTogSW50bFNlcnZpY2UgfSxcbiAgICB7IHR5cGU6IE1vbnRoU2xvdFNlcnZpY2UgfSxcbiAgICB7IHR5cGU6IE5nWm9uZSB9LFxuICAgIHsgdHlwZTogRWxlbWVudFJlZiB9LFxuICAgIHsgdHlwZTogUmVuZGVyZXIyIH0sXG4gICAgeyB0eXBlOiBQREZTZXJ2aWNlIH0sXG4gICAgeyB0eXBlOiBMb2NhbGl6YXRpb25TZXJ2aWNlIH1cbl07XG5Nb250aFZpZXdSZW5kZXJlckNvbXBvbmVudC5wcm9wRGVjb3JhdG9ycyA9IHtcbiAgICBtb250aERheVNsb3RUZW1wbGF0ZTogW3sgdHlwZTogSW5wdXQgfV1cbn07XG5cbi8qKlxuICogQGhpZGRlblxuICovXG5jbGFzcyBCYXNlU2xvdERpcmVjdGl2ZSB7XG4gICAgY29uc3RydWN0b3IoZWxlbWVudCwgc2xvdFNlcnZpY2UsIGxvY2FsaXphdGlvbikge1xuICAgICAgICB0aGlzLmVsZW1lbnQgPSBlbGVtZW50O1xuICAgICAgICB0aGlzLnNsb3RTZXJ2aWNlID0gc2xvdFNlcnZpY2U7XG4gICAgICAgIHRoaXMubG9jYWxpemF0aW9uID0gbG9jYWxpemF0aW9uO1xuICAgICAgICB0aGlzLl9yZWN0ID0gbnVsbDtcbiAgICB9XG4gICAgZ2V0IHNsb3RJbmRleCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMua2V5O1xuICAgIH1cbiAgICBnZXQgcmVjdCgpIHtcbiAgICAgICAgaWYgKHRoaXMuX3JlY3QpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9yZWN0O1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGVsID0gdGhpcy5uYXRpdmVFbGVtZW50O1xuICAgICAgICB0aGlzLl9yZWN0ID0ge1xuICAgICAgICAgICAgbGVmdDogIXRoaXMubG9jYWxpemF0aW9uLnJ0bCA/IGVsLm9mZnNldExlZnQgOiB0aGlzLnNsb3RTZXJ2aWNlLmNvbnRhaW5lclNpemUgLSAoZWwub2Zmc2V0TGVmdCArIGVsLmNsaWVudFdpZHRoKSxcbiAgICAgICAgICAgIHRvcDogZWwub2Zmc2V0VG9wLFxuICAgICAgICAgICAgd2lkdGg6IGVsLmNsaWVudFdpZHRoLFxuICAgICAgICAgICAgaGVpZ2h0OiBlbC5jbGllbnRIZWlnaHRcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3JlY3Q7XG4gICAgfVxuICAgIGdldCB0b3AoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmVsZW1lbnQgPyB0aGlzLm5hdGl2ZUVsZW1lbnQub2Zmc2V0VG9wIDogMDtcbiAgICB9XG4gICAgZ2V0IHBhZGRpbmcoKSB7XG4gICAgICAgIGlmICghdGhpcy5lbGVtZW50IHx8ICFpc0RvY3VtZW50QXZhaWxhYmxlKCkpIHtcbiAgICAgICAgICAgIHJldHVybiAwO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBwYXJzZUludCh3aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZSh0aGlzLm5hdGl2ZUVsZW1lbnQpLnBhZGRpbmdUb3AsIDEwKSAqIDI7XG4gICAgfVxuICAgIGdldCBoZWlnaHQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmVsZW1lbnQgPyB0aGlzLm5hdGl2ZUVsZW1lbnQub2Zmc2V0SGVpZ2h0IDogMDtcbiAgICB9XG4gICAgc2V0IGhlaWdodCh2YWx1ZSkge1xuICAgICAgICBpZiAodGhpcy5lbGVtZW50KSB7XG4gICAgICAgICAgICB0aGlzLm5hdGl2ZUVsZW1lbnQuc3R5bGUuaGVpZ2h0ID0gYCR7dmFsdWV9cHhgO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLl9yZWN0KSB7XG4gICAgICAgICAgICB0aGlzLl9yZWN0LmhlaWdodCA9IHZhbHVlO1xuICAgICAgICB9XG4gICAgfVxuICAgIGdldCB3aWR0aCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZWxlbWVudCA/IHRoaXMubmF0aXZlRWxlbWVudC5vZmZzZXRXaWR0aCA6IDA7XG4gICAgfVxuICAgIGdldCBrZXkoKSB7XG4gICAgICAgIHJldHVybiBgJHt0aGlzLmlkLnJlc291cmNlSW5kZXh9OiR7dGhpcy5pZC5yYW5nZUluZGV4fToke3RoaXMuaWQuaW5kZXh9YDtcbiAgICB9XG4gICAgZ2V0IG5hdGl2ZUVsZW1lbnQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmVsZW1lbnQubmF0aXZlRWxlbWVudDtcbiAgICB9XG4gICAgbmdPbkluaXQoKSB7XG4gICAgICAgIHRoaXMuc2xvdFNlcnZpY2UucmVnaXN0ZXJTbG90KHRoaXMpO1xuICAgIH1cbiAgICBuZ09uRGVzdHJveSgpIHtcbiAgICAgICAgdGhpcy5zbG90U2VydmljZS51bnJlZ2lzdGVyU2xvdCh0aGlzKTtcbiAgICB9XG4gICAgaW52YWxpZGF0ZSgpIHtcbiAgICAgICAgdGhpcy5fcmVjdCA9IG51bGw7XG4gICAgfVxufVxuQmFzZVNsb3REaXJlY3RpdmUucHJvcERlY29yYXRvcnMgPSB7XG4gICAgaWQ6IFt7IHR5cGU6IElucHV0IH1dLFxuICAgIHNsb3RJbmRleDogW3sgdHlwZTogSG9zdEJpbmRpbmcsIGFyZ3M6IFsnYXR0ci5kYXRhLXNsb3QtaW5kZXgnLF0gfV1cbn07XG5cbi8qKlxuICogQGhpZGRlblxuICovXG5jbGFzcyBNb250aFNsb3REaXJlY3RpdmUgZXh0ZW5kcyBCYXNlU2xvdERpcmVjdGl2ZSB7XG4gICAgY29uc3RydWN0b3IoZWxlbWVudCwgc2xvdFNlcnZpY2UsIGxvY2FsaXphdGlvbikge1xuICAgICAgICBzdXBlcihlbGVtZW50LCBzbG90U2VydmljZSwgbG9jYWxpemF0aW9uKTtcbiAgICAgICAgdGhpcy5pc0RheVNsb3QgPSB0cnVlO1xuICAgICAgICB0aGlzLl9saW5rSGVpZ2h0ID0gbnVsbDtcbiAgICB9XG4gICAgc2V0IHN0YXJ0KHZhbHVlKSB7XG4gICAgICAgIHRoaXMuc3RhcnREYXRlID0gdG9VVENEYXRlKHZhbHVlKTtcbiAgICB9XG4gICAgZ2V0IHN0YXJ0KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5zdGFydERhdGU7XG4gICAgfVxuICAgIGdldCBlbmQoKSB7XG4gICAgICAgIHJldHVybiBhZGRVVENEYXlzKHRoaXMuc3RhcnQsIDEpO1xuICAgIH1cbiAgICBnZXQgbGlua0hlaWdodCgpIHtcbiAgICAgICAgaWYgKHRoaXMuX2xpbmtIZWlnaHQgPT09IG51bGwpIHtcbiAgICAgICAgICAgIGNvbnN0IGVsZW1lbnQgPSBmaXJzdEVsZW1lbnRDaGlsZCh0aGlzLm5hdGl2ZUVsZW1lbnQpO1xuICAgICAgICAgICAgdGhpcy5fbGlua0hlaWdodCA9IGVsZW1lbnQgPyBlbGVtZW50Lm9mZnNldEhlaWdodCArIGVsZW1lbnQub2Zmc2V0VG9wIDogMDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5fbGlua0hlaWdodDtcbiAgICB9XG4gICAgbmdPbkRlc3Ryb3koKSB7XG4gICAgICAgIHN1cGVyLm5nT25EZXN0cm95KCk7XG4gICAgICAgIHRoaXMucmVtb3ZlU2hvd01vcmUoKTtcbiAgICB9XG4gICAgc2hvd01vcmUocmVjdCkge1xuICAgICAgICBpZiAoIXRoaXMuc2hvd01vcmVFbGVtZW50KSB7XG4gICAgICAgICAgICBjb25zdCBlbGVtZW50ID0gdGhpcy5zaG93TW9yZUVsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgICAgIGVsZW1lbnQuaW5uZXJIVE1MID0gJzxzcGFuIGNsYXNzPVwiay1pY29uIGstaS1tb3JlLWhvcml6b250YWxcIj48L3NwYW4+JztcbiAgICAgICAgICAgIGVsZW1lbnQuY2xhc3NOYW1lID0gJ2stbW9yZS1ldmVudHMgay1idXR0b24nO1xuICAgICAgICAgICAgZWxlbWVudC5zdHlsZS53aWR0aCA9IGAke3JlY3Qud2lkdGh9cHhgO1xuICAgICAgICAgICAgZWxlbWVudC5zdHlsZS5sZWZ0ID0gYCR7cmVjdC5sZWZ0fXB4YDtcbiAgICAgICAgICAgIGVsZW1lbnQuc3R5bGUudG9wID0gYCR7cmVjdC50b3B9cHhgO1xuICAgICAgICAgICAgdGhpcy5uYXRpdmVFbGVtZW50LmFwcGVuZENoaWxkKGVsZW1lbnQpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGhpZGVNb3JlKCkge1xuICAgICAgICB0aGlzLnJlbW92ZVNob3dNb3JlKCk7XG4gICAgfVxuICAgIGludmFsaWRhdGUoKSB7XG4gICAgICAgIHN1cGVyLmludmFsaWRhdGUoKTtcbiAgICAgICAgdGhpcy5fbGlua0hlaWdodCA9IG51bGw7XG4gICAgICAgIHRoaXMucmVtb3ZlU2hvd01vcmUoKTtcbiAgICB9XG4gICAgcmVtb3ZlU2hvd01vcmUoKSB7XG4gICAgICAgIGlmICh0aGlzLnNob3dNb3JlRWxlbWVudCkge1xuICAgICAgICAgICAgdGhpcy5zaG93TW9yZUVsZW1lbnQucGFyZW50Tm9kZS5yZW1vdmVDaGlsZCh0aGlzLnNob3dNb3JlRWxlbWVudCk7XG4gICAgICAgICAgICB0aGlzLnNob3dNb3JlRWxlbWVudCA9IG51bGw7XG4gICAgICAgIH1cbiAgICB9XG59XG5Nb250aFNsb3REaXJlY3RpdmUuZGVjb3JhdG9ycyA9IFtcbiAgICB7IHR5cGU6IERpcmVjdGl2ZSwgYXJnczogW3tcbiAgICAgICAgICAgICAgICAvLyB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmU6ZGlyZWN0aXZlLXNlbGVjdG9yXG4gICAgICAgICAgICAgICAgc2VsZWN0b3I6ICdbbW9udGhTbG90XSdcbiAgICAgICAgICAgIH0sXSB9LFxuXTtcbi8qKiBAbm9jb2xsYXBzZSAqL1xuTW9udGhTbG90RGlyZWN0aXZlLmN0b3JQYXJhbWV0ZXJzID0gKCkgPT4gW1xuICAgIHsgdHlwZTogRWxlbWVudFJlZiB9LFxuICAgIHsgdHlwZTogTW9udGhTbG90U2VydmljZSB9LFxuICAgIHsgdHlwZTogTG9jYWxpemF0aW9uU2VydmljZSB9XG5dO1xuTW9udGhTbG90RGlyZWN0aXZlLnByb3BEZWNvcmF0b3JzID0ge1xuICAgIHN0YXJ0OiBbeyB0eXBlOiBJbnB1dCB9XVxufTtcblxuLyoqXG4gKiBAaGlkZGVuXG4gKi9cbmNsYXNzIFZpZXdGb290ZXJDb21wb25lbnQge1xuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICB0aGlzLmhvc3RDbGFzc2VzID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5pdGVtQ2xpY2sgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XG4gICAgfVxuICAgIG9uSXRlbUNsaWNrKGUsIGl0ZW0pIHtcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICB0aGlzLml0ZW1DbGljay5lbWl0KGl0ZW0pO1xuICAgIH1cbn1cblZpZXdGb290ZXJDb21wb25lbnQuZGVjb3JhdG9ycyA9IFtcbiAgICB7IHR5cGU6IENvbXBvbmVudCwgYXJnczogW3tcbiAgICAgICAgICAgICAgICAvLyB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmU6Y29tcG9uZW50LXNlbGVjdG9yXG4gICAgICAgICAgICAgICAgc2VsZWN0b3I6ICdbdmlld0Zvb3Rlcl0nLFxuICAgICAgICAgICAgICAgIHRlbXBsYXRlOiBgXG4gICAgICAgIDx1bCBjbGFzcz1cImstcmVzZXQgay1oZWFkZXJcIj5cbiAgICAgICAgICAgIDxsaSBjbGFzcz1cImstc3RhdGUtZGVmYXVsdFwiICpuZ0Zvcj1cImxldCBpdGVtIG9mIGl0ZW1zXCIgW25nQ2xhc3NdPVwiaXRlbS5jc3NDbGFzc1wiIChjbGljayk9XCJvbkl0ZW1DbGljaygkZXZlbnQsIGl0ZW0pXCI+XG4gICAgICAgICAgICAgICAgPGEgaHJlZj1cIiNcIiBjbGFzcz1cImstbGlua1wiIHRhYmluZGV4PVwiLTFcIj5cbiAgICAgICAgICAgICAgICAgICAgPHNwYW4gY2xhc3M9XCJrLWljb25cIiBbbmdDbGFzc109XCJpdGVtLmljb25DbGFzc1wiPjwvc3Bhbj5cbiAgICAgICAgICAgICAgICAgICAge3sgaXRlbS50ZXh0IH19XG4gICAgICAgICAgICAgICAgPC9hPlxuICAgICAgICAgICAgPC9saT5cbiAgICAgICAgPC91bD5cbiAgICBgXG4gICAgICAgICAgICB9LF0gfSxcbl07XG5WaWV3Rm9vdGVyQ29tcG9uZW50LnByb3BEZWNvcmF0b3JzID0ge1xuICAgIGhvc3RDbGFzc2VzOiBbeyB0eXBlOiBIb3N0QmluZGluZywgYXJnczogWydjbGFzcy5rLWhlYWRlcicsXSB9LCB7IHR5cGU6IEhvc3RCaW5kaW5nLCBhcmdzOiBbJ2NsYXNzLmstc2NoZWR1bGVyLWZvb3RlcicsXSB9XSxcbiAgICBpdGVtQ2xpY2s6IFt7IHR5cGU6IE91dHB1dCB9XSxcbiAgICBpdGVtczogW3sgdHlwZTogSW5wdXQgfV1cbn07XG5cbi8qKlxuICogQGhpZGRlblxuICovXG5jbGFzcyBXb3JrSG91cnNGb290ZXJEaXJlY3RpdmUge1xuICAgIGNvbnN0cnVjdG9yKGZvb3RlciwgbG9jYWxpemF0aW9uKSB7XG4gICAgICAgIHRoaXMuZm9vdGVyID0gZm9vdGVyO1xuICAgICAgICB0aGlzLmxvY2FsaXphdGlvbiA9IGxvY2FsaXphdGlvbjtcbiAgICAgICAgdGhpcy5zaG93V29ya0hvdXJzID0gZmFsc2U7XG4gICAgICAgIHRoaXMuZm9vdGVySXRlbXMgPSBbeyBjc3NDbGFzczogJ2stc2NoZWR1bGVyLWZ1bGxkYXknLCBpY29uQ2xhc3M6ICdrLWktY2xvY2snLCB0ZXh0OiAnJyB9XTtcbiAgICB9XG4gICAgbmdPbkluaXQoKSB7XG4gICAgICAgIHRoaXMudG9nZ2xlV29ya0hvdXJzKCk7XG4gICAgICAgIHRoaXMuZm9vdGVyLml0ZW1zID0gdGhpcy5mb290ZXJJdGVtcztcbiAgICB9XG4gICAgbmdPbkNoYW5nZXMoKSB7XG4gICAgICAgIHRoaXMudG9nZ2xlV29ya0hvdXJzKCk7XG4gICAgfVxuICAgIHRvZ2dsZVdvcmtIb3VycygpIHtcbiAgICAgICAgdGhpcy5mb290ZXJJdGVtc1swXS50ZXh0ID0gdGhpcy5zaG93V29ya0hvdXJzID8gdGhpcy5sb2NhbGl6YXRpb24uZ2V0KCdzaG93RnVsbERheScpIDogdGhpcy5sb2NhbGl6YXRpb24uZ2V0KCdzaG93V29ya0RheScpO1xuICAgIH1cbn1cbldvcmtIb3Vyc0Zvb3RlckRpcmVjdGl2ZS5kZWNvcmF0b3JzID0gW1xuICAgIHsgdHlwZTogRGlyZWN0aXZlLCBhcmdzOiBbe1xuICAgICAgICAgICAgICAgIHNlbGVjdG9yOiAnW2tlbmRvV29ya0hvdXJzRm9vdGVyXSdcbiAgICAgICAgICAgIH0sXSB9LFxuXTtcbi8qKiBAbm9jb2xsYXBzZSAqL1xuV29ya0hvdXJzRm9vdGVyRGlyZWN0aXZlLmN0b3JQYXJhbWV0ZXJzID0gKCkgPT4gW1xuICAgIHsgdHlwZTogVmlld0Zvb3RlckNvbXBvbmVudCB9LFxuICAgIHsgdHlwZTogTG9jYWxpemF0aW9uU2VydmljZSB9XG5dO1xuV29ya0hvdXJzRm9vdGVyRGlyZWN0aXZlLnByb3BEZWNvcmF0b3JzID0ge1xuICAgIHNob3dXb3JrSG91cnM6IFt7IHR5cGU6IElucHV0IH1dXG59O1xuXG5jbGFzcyBOdW1iZXJJdGVyYXRvciB7XG4gICAgY29uc3RydWN0b3IoY291bnQpIHtcbiAgICAgICAgdGhpcy5jb3VudCA9IGNvdW50O1xuICAgIH1cbiAgICAqW2l0ZXJhdG9yXSgpIHtcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLmNvdW50OyBpKyspIHtcbiAgICAgICAgICAgIHlpZWxkIGk7XG4gICAgICAgIH1cbiAgICB9XG59XG4vKipcbiAqIEBoaWRkZW5cbiAqL1xuY2xhc3MgUmVwZWF0UGlwZSB7XG4gICAgdHJhbnNmb3JtKHZhbHVlKSB7XG4gICAgICAgIHJldHVybiBuZXcgTnVtYmVySXRlcmF0b3IodmFsdWUpO1xuICAgIH1cbn1cblJlcGVhdFBpcGUuZGVjb3JhdG9ycyA9IFtcbiAgICB7IHR5cGU6IFBpcGUsIGFyZ3M6IFt7XG4gICAgICAgICAgICAgICAgLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOnBpcGUtbmFtaW5nXG4gICAgICAgICAgICAgICAgbmFtZTogJ3JlcGVhdCdcbiAgICAgICAgICAgIH0sXSB9LFxuXTtcblxuY2xhc3MgUmVzb3VyY2VJdGVyYXRvciB7XG4gICAgY29uc3RydWN0b3IocmVzb3VyY2VzLCBsYXN0SW5kZXggPSByZXNvdXJjZXMubGVuZ3RoIC0gMSkge1xuICAgICAgICB0aGlzLnJlc291cmNlcyA9IHJlc291cmNlcztcbiAgICAgICAgdGhpcy5sYXN0SW5kZXggPSBsYXN0SW5kZXg7XG4gICAgfVxuICAgICpbaXRlcmF0b3JdKCkge1xuICAgICAgICBsZXQgcmVzb3VyY2VzID0gdGhpcy5yZXNvdXJjZXM7XG4gICAgICAgIGNvbnN0IGxhc3RJbmRleCA9IE1hdGgubWF4KDAsIHRoaXMubGFzdEluZGV4KTtcbiAgICAgICAgaWYgKCEocmVzb3VyY2VzICYmIHJlc291cmNlcy5sZW5ndGgpKSB7XG4gICAgICAgICAgICByZXNvdXJjZXMgPSBbe31dO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGxhc3REYXRhID0gcmVzb3VyY2VzW2xhc3RJbmRleF0uZGF0YSB8fCBbXTtcbiAgICAgICAgY29uc3QgbGVuZ3RoID0gbGFzdERhdGEubGVuZ3RoO1xuICAgICAgICBsZXQgY291bnQgPSAxO1xuICAgICAgICBmb3IgKGxldCBpZHggPSAwOyBpZHggPD0gbGFzdEluZGV4OyBpZHgrKykge1xuICAgICAgICAgICAgY291bnQgKj0gKHJlc291cmNlc1tpZHhdLmRhdGEgfHwgW10pLmxlbmd0aCB8fCAxO1xuICAgICAgICB9XG4gICAgICAgIGZvciAobGV0IGlkeCA9IDA7IGlkeCA8IGNvdW50OyBpZHgrKykge1xuICAgICAgICAgICAgeWllbGQgbGFzdERhdGFbaWR4ICUgbGVuZ3RoXTtcbiAgICAgICAgfVxuICAgIH1cbn1cbi8qKlxuICogQGhpZGRlblxuICovXG5jbGFzcyBSZXNvdXJjZUl0ZXJhdG9yUGlwZSB7XG4gICAgdHJhbnNmb3JtKHJlc291cmNlcyA9IFtdLCBsYXN0SW5kZXgpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBSZXNvdXJjZUl0ZXJhdG9yKHJlc291cmNlcywgbGFzdEluZGV4KTtcbiAgICB9XG59XG5SZXNvdXJjZUl0ZXJhdG9yUGlwZS5kZWNvcmF0b3JzID0gW1xuICAgIHsgdHlwZTogUGlwZSwgYXJnczogW3tcbiAgICAgICAgICAgICAgICAvLyB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmU6cGlwZS1uYW1pbmdcbiAgICAgICAgICAgICAgICBuYW1lOiAncmVzb3VyY2VJdGVyYXRvcidcbiAgICAgICAgICAgIH0sXSB9LFxuXTtcblxuLyoqXG4gKiBAaGlkZGVuXG4gKi9cbmNsYXNzIFJlc2l6ZUhpbnRDb21wb25lbnQge1xuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICB0aGlzLm1hcnF1ZWVDbGFzc2VzID0gdHJ1ZTtcbiAgICB9XG4gICAgZ2V0IGxlZnQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmhpbnQucmVjdC5sZWZ0O1xuICAgIH1cbiAgICBnZXQgdG9wKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5oaW50LnJlY3QudG9wO1xuICAgIH1cbiAgICBnZXQgd2lkdGgoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmhpbnQucmVjdC53aWR0aDtcbiAgICB9XG4gICAgZ2V0IGhlaWdodCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuaGludC5yZWN0LmhlaWdodDtcbiAgICB9XG4gICAgZ2V0IHN0YXJ0KCkge1xuICAgICAgICByZXR1cm4gdG9Mb2NhbERhdGUodGhpcy5oaW50LnN0YXJ0KTtcbiAgICB9XG4gICAgZ2V0IGVuZCgpIHtcbiAgICAgICAgcmV0dXJuIHRvTG9jYWxEYXRlKHRoaXMuaGludC5lbmQpO1xuICAgIH1cbn1cblJlc2l6ZUhpbnRDb21wb25lbnQuZGVjb3JhdG9ycyA9IFtcbiAgICB7IHR5cGU6IENvbXBvbmVudCwgYXJnczogW3tcbiAgICAgICAgICAgICAgICAvLyB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmU6Y29tcG9uZW50LXNlbGVjdG9yXG4gICAgICAgICAgICAgICAgc2VsZWN0b3I6ICdba2VuZG9SZXNpemVIaW50XScsXG4gICAgICAgICAgICAgICAgdGVtcGxhdGU6IGBcbiAgICAgICAgPGRpdiBjbGFzcz1cImstbWFycXVlZS1jb2xvclwiPjwvZGl2PlxuICAgICAgICA8ZGl2IGNsYXNzPVwiay1tYXJxdWVlLXRleHRcIj5cbiAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJrLWxhYmVsLXRvcFwiICpuZ0lmPVwiaGludC5maXJzdFwiPnt7IHN0YXJ0IHwga2VuZG9EYXRlIDogZm9ybWF0IH19PC9kaXY+XG4gICAgICAgICAgICA8ZGl2IGNsYXNzPVwiay1sYWJlbC1ib3R0b21cIiAqbmdJZj1cImhpbnQubGFzdFwiPnt7IGVuZCB8IGtlbmRvRGF0ZSA6IGZvcm1hdCB9fTwvZGl2PlxuICAgICAgICA8L2Rpdj5cbiAgICBgXG4gICAgICAgICAgICB9LF0gfSxcbl07XG5SZXNpemVIaW50Q29tcG9uZW50LnByb3BEZWNvcmF0b3JzID0ge1xuICAgIGhpbnQ6IFt7IHR5cGU6IElucHV0IH1dLFxuICAgIGZvcm1hdDogW3sgdHlwZTogSW5wdXQgfV0sXG4gICAgbWFycXVlZUNsYXNzZXM6IFt7IHR5cGU6IEhvc3RCaW5kaW5nLCBhcmdzOiBbJ2NsYXNzLmstbWFycXVlZScsXSB9LCB7IHR5cGU6IEhvc3RCaW5kaW5nLCBhcmdzOiBbJ2NsYXNzLmstc2NoZWR1bGVyLW1hcnF1ZWUnLF0gfSwgeyB0eXBlOiBIb3N0QmluZGluZywgYXJnczogWydjbGFzcy5rLWZpcnN0JyxdIH0sIHsgdHlwZTogSG9zdEJpbmRpbmcsIGFyZ3M6IFsnY2xhc3Muay1sYXN0JyxdIH1dLFxuICAgIGxlZnQ6IFt7IHR5cGU6IEhvc3RCaW5kaW5nLCBhcmdzOiBbJ3N0eWxlLmxlZnQucHgnLF0gfSwgeyB0eXBlOiBIb3N0QmluZGluZywgYXJnczogWydzdHlsZS5yaWdodC5weCcsXSB9XSxcbiAgICB0b3A6IFt7IHR5cGU6IEhvc3RCaW5kaW5nLCBhcmdzOiBbJ3N0eWxlLnRvcC5weCcsXSB9XSxcbiAgICB3aWR0aDogW3sgdHlwZTogSG9zdEJpbmRpbmcsIGFyZ3M6IFsnc3R5bGUud2lkdGgucHgnLF0gfV0sXG4gICAgaGVpZ2h0OiBbeyB0eXBlOiBIb3N0QmluZGluZywgYXJnczogWydzdHlsZS5oZWlnaHQucHgnLF0gfV1cbn07XG5cbmNvbnN0IERFQ0xBUkFUSU9OUyA9IFtcbiAgICBWaWV3Rm9vdGVyQ29tcG9uZW50LFxuICAgIFdvcmtIb3Vyc0Zvb3RlckRpcmVjdGl2ZSxcbiAgICBSZXBlYXRQaXBlLFxuICAgIFJlc291cmNlSXRlcmF0b3JQaXBlLFxuICAgIEhpbnRDb250YWluZXJDb21wb25lbnQsXG4gICAgUmVzaXplSGludENvbXBvbmVudFxuXTtcbi8qKlxuICogQGhpZGRlblxuICovXG5jbGFzcyBWaWV3c1NoYXJlZE1vZHVsZSB7XG59XG5WaWV3c1NoYXJlZE1vZHVsZS5kZWNvcmF0b3JzID0gW1xuICAgIHsgdHlwZTogTmdNb2R1bGUsIGFyZ3M6IFt7XG4gICAgICAgICAgICAgICAgaW1wb3J0czogW0NvbW1vbk1vZHVsZSwgSW50bE1vZHVsZSwgU2hhcmVkTW9kdWxlXSxcbiAgICAgICAgICAgICAgICBleHBvcnRzOiBbXG4gICAgICAgICAgICAgICAgICAgIERFQ0xBUkFUSU9OUyxcbiAgICAgICAgICAgICAgICAgICAgSW50bE1vZHVsZSxcbiAgICAgICAgICAgICAgICAgICAgQ29tbW9uTW9kdWxlLFxuICAgICAgICAgICAgICAgICAgICBTaGFyZWRNb2R1bGVcbiAgICAgICAgICAgICAgICBdLFxuICAgICAgICAgICAgICAgIGRlY2xhcmF0aW9uczogW1xuICAgICAgICAgICAgICAgICAgICBERUNMQVJBVElPTlNcbiAgICAgICAgICAgICAgICBdXG4gICAgICAgICAgICB9LF0gfSxcbl07XG5cbi8qKlxuICogQGhpZGRlblxuICovXG5jbGFzcyBNb250aFZpZXdNb2R1bGUge1xufVxuTW9udGhWaWV3TW9kdWxlLmRlY29yYXRvcnMgPSBbXG4gICAgeyB0eXBlOiBOZ01vZHVsZSwgYXJnczogW3tcbiAgICAgICAgICAgICAgICBpbXBvcnRzOiBbXG4gICAgICAgICAgICAgICAgICAgIFZpZXdzU2hhcmVkTW9kdWxlXG4gICAgICAgICAgICAgICAgXSxcbiAgICAgICAgICAgICAgICBleHBvcnRzOiBbXG4gICAgICAgICAgICAgICAgICAgIE1vbnRoVmlld0NvbXBvbmVudFxuICAgICAgICAgICAgICAgIF0sXG4gICAgICAgICAgICAgICAgZGVjbGFyYXRpb25zOiBbXG4gICAgICAgICAgICAgICAgICAgIE1vbnRoVmlld0NvbXBvbmVudCxcbiAgICAgICAgICAgICAgICAgICAgTW9udGhWaWV3UmVuZGVyZXJDb21wb25lbnQsXG4gICAgICAgICAgICAgICAgICAgIE1vbnRoVmlld0l0ZW1Db21wb25lbnQsXG4gICAgICAgICAgICAgICAgICAgIE1vbnRoU2xvdERpcmVjdGl2ZVxuICAgICAgICAgICAgICAgIF1cbiAgICAgICAgICAgIH0sXSB9LFxuXTtcblxuY29uc3QgRVZFTlRfSEVJR0hUID0gJ2V2ZW50SGVpZ2h0JztcbmNvbnN0IFNIT1dfV09SS19IT1VSUyA9ICdzaG93V29ya0hvdXJzJztcbmNvbnN0IFNUQVJUX1RJTUUgPSAnc3RhcnRUaW1lJztcbmNvbnN0IEVORF9USU1FID0gJ2VuZFRpbWUnO1xuY29uc3QgV09SS19EQVlfU1RBUlQgPSAnd29ya0RheVN0YXJ0JztcbmNvbnN0IFdPUktfREFZX0VORCA9ICd3b3JrRGF5RW5kJztcbmNvbnN0IFdPUktfV0VFS19TVEFSVCA9ICd3b3JrV2Vla1N0YXJ0JztcbmNvbnN0IFdPUktfV0VFS19FTkQgPSAnd29ya1dlZWtFbmQnO1xuY29uc3QgU0xPVF9EVVJBVElPTiA9ICdzbG90RHVyYXRpb24nO1xuY29uc3QgU0xPVF9ESVZJU0lPTlMgPSAnc2xvdERpdmlzaW9ucyc7XG5jb25zdCBDVVJSRU5UX1RJTUVfTUFSS0VSID0gJ2N1cnJlbnRUaW1lTWFya2VyJztcbi8qKlxuICogQGhpZGRlblxuICovXG5jbGFzcyBEYXlUaW1lVmlld0Jhc2UgZXh0ZW5kcyBDb25maWd1cmF0aW9uVmlld0Jhc2Uge1xuICAgIGNvbnN0cnVjdG9yKGxvY2FsaXphdGlvbiwgY2hhbmdlRGV0ZWN0b3IsIHZpZXdDb250ZXh0LCB2aWV3U3RhdGUpIHtcbiAgICAgICAgc3VwZXIobG9jYWxpemF0aW9uLCBjaGFuZ2VEZXRlY3Rvciwgdmlld0NvbnRleHQsIHZpZXdTdGF0ZSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEBoaWRkZW5cbiAgICAgKi9cbiAgICBnZXQgdmlld0V2ZW50SGVpZ2h0KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5vcHRpb25WYWx1ZShFVkVOVF9IRUlHSFQpIHx8IERFRkFVTFRfRVZFTlRfSEVJR0hUO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBAaGlkZGVuXG4gICAgICovXG4gICAgZ2V0IHNob3VsZFNob3dXb3JrSG91cnMoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm9wdGlvblZhbHVlKFNIT1dfV09SS19IT1VSUyk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEBoaWRkZW5cbiAgICAgKi9cbiAgICBnZXQgdmlld1N0YXJ0VGltZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMub3B0aW9uVmFsdWUoU1RBUlRfVElNRSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEBoaWRkZW5cbiAgICAgKi9cbiAgICBnZXQgdmlld0VuZFRpbWUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm9wdGlvblZhbHVlKEVORF9USU1FKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQGhpZGRlblxuICAgICAqL1xuICAgIGdldCB2aWV3V29ya0RheVN0YXJ0KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5vcHRpb25WYWx1ZShXT1JLX0RBWV9TVEFSVCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEBoaWRkZW5cbiAgICAgKi9cbiAgICBnZXQgdmlld1dvcmtEYXlFbmQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm9wdGlvblZhbHVlKFdPUktfREFZX0VORCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEBoaWRkZW5cbiAgICAgKi9cbiAgICBnZXQgdmlld1dvcmtXZWVrU3RhcnQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm9wdGlvblZhbHVlKFdPUktfV0VFS19TVEFSVCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEBoaWRkZW5cbiAgICAgKi9cbiAgICBnZXQgdmlld1dvcmtXZWVrRW5kKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5vcHRpb25WYWx1ZShXT1JLX1dFRUtfRU5EKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQGhpZGRlblxuICAgICAqL1xuICAgIGdldCB2aWV3U2xvdER1cmF0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5vcHRpb25WYWx1ZShTTE9UX0RVUkFUSU9OKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQGhpZGRlblxuICAgICAqL1xuICAgIGdldCB2aWV3U2xvdERpdmlzaW9ucygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMub3B0aW9uVmFsdWUoU0xPVF9ESVZJU0lPTlMpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBAaGlkZGVuXG4gICAgICovXG4gICAgZ2V0IHZpZXdDdXJyZW50VGltZU1hcmtlcigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMub3B0aW9uVmFsdWUoQ1VSUkVOVF9USU1FX01BUktFUik7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEBoaWRkZW5cbiAgICAgKi9cbiAgICBnZXQgdmlld1Njcm9sbFRpbWUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm9wdGlvblZhbHVlKCdzY3JvbGxUaW1lJyk7XG4gICAgfVxuICAgIG9wdGlvblZhbHVlKG5hbWUpIHtcbiAgICAgICAgcmV0dXJuIGlzUHJlc2VudCh0aGlzW25hbWVdKSA/IHRoaXNbbmFtZV0gOiB0aGlzLnNjaGVkdWxlck9wdGlvbnNbbmFtZV07XG4gICAgfVxufVxuRGF5VGltZVZpZXdCYXNlLnByb3BEZWNvcmF0b3JzID0ge1xuICAgIHRpbWVTbG90VGVtcGxhdGU6IFt7IHR5cGU6IENvbnRlbnRDaGlsZCwgYXJnczogW1RpbWVTbG90VGVtcGxhdGVEaXJlY3RpdmUsXSB9XSxcbiAgICBkYXRlSGVhZGVyVGVtcGxhdGU6IFt7IHR5cGU6IENvbnRlbnRDaGlsZCwgYXJnczogW0RhdGVIZWFkZXJUZW1wbGF0ZURpcmVjdGl2ZSxdIH1dLFxuICAgIHNob3dXb3JrSG91cnM6IFt7IHR5cGU6IElucHV0IH1dLFxuICAgIGV2ZW50SGVpZ2h0OiBbeyB0eXBlOiBJbnB1dCB9XSxcbiAgICBzdGFydFRpbWU6IFt7IHR5cGU6IElucHV0IH1dLFxuICAgIHNjcm9sbFRpbWU6IFt7IHR5cGU6IElucHV0IH1dLFxuICAgIGVuZFRpbWU6IFt7IHR5cGU6IElucHV0IH1dLFxuICAgIHdvcmtEYXlTdGFydDogW3sgdHlwZTogSW5wdXQgfV0sXG4gICAgd29ya0RheUVuZDogW3sgdHlwZTogSW5wdXQgfV0sXG4gICAgd29ya1dlZWtTdGFydDogW3sgdHlwZTogSW5wdXQgfV0sXG4gICAgd29ya1dlZWtFbmQ6IFt7IHR5cGU6IElucHV0IH1dLFxuICAgIHNsb3REdXJhdGlvbjogW3sgdHlwZTogSW5wdXQgfV0sXG4gICAgc2xvdERpdmlzaW9uczogW3sgdHlwZTogSW5wdXQgfV0sXG4gICAgY3VycmVudFRpbWVNYXJrZXI6IFt7IHR5cGU6IElucHV0IH1dXG59O1xuXG5jb25zdCBTTE9UX0ZJTEwgPSAnc2xvdEZpbGwnO1xuLyoqXG4gKiBAaGlkZGVuXG4gKi9cbmNsYXNzIE11bHRpRGF5Vmlld0Jhc2UgZXh0ZW5kcyBEYXlUaW1lVmlld0Jhc2Uge1xuICAgIGNvbnN0cnVjdG9yKGxvY2FsaXphdGlvbiwgY2hhbmdlRGV0ZWN0b3IsIHZpZXdDb250ZXh0LCB2aWV3U3RhdGUpIHtcbiAgICAgICAgc3VwZXIobG9jYWxpemF0aW9uLCBjaGFuZ2VEZXRlY3Rvciwgdmlld0NvbnRleHQsIHZpZXdTdGF0ZSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEBoaWRkZW5cbiAgICAgKi9cbiAgICBnZXQgdmlld1Nsb3RGaWxsKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5vcHRpb25WYWx1ZShTTE9UX0ZJTEwpO1xuICAgIH1cbn1cbk11bHRpRGF5Vmlld0Jhc2UucHJvcERlY29yYXRvcnMgPSB7XG4gICAgc2xvdEZpbGw6IFt7IHR5cGU6IElucHV0IH1dXG59O1xuXG4vKipcbiAqIFRoZSBjb21wb25lbnQgZm9yIHJlbmRlcmluZyB0aGUgKipEYXkqKiB2aWV3LlxuICovXG5jbGFzcyBEYXlWaWV3Q29tcG9uZW50IGV4dGVuZHMgTXVsdGlEYXlWaWV3QmFzZSB7XG4gICAgY29uc3RydWN0b3IobG9jYWxpemF0aW9uLCBjaGFuZ2VEZXRlY3Rvciwgdmlld0NvbnRleHQsIHZpZXdTdGF0ZSkge1xuICAgICAgICBzdXBlcihsb2NhbGl6YXRpb24sIGNoYW5nZURldGVjdG9yLCB2aWV3Q29udGV4dCwgdmlld1N0YXRlKTtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRoZSBsb25nLWRhdGUgZm9ybWF0IGZvciBkaXNwbGF5aW5nIHRoZVxuICAgICAgICAgKiBzZWxlY3RlZCBkYXRlIGluIHRoZSBTY2hlZHVsZXIgdG9vbGJhci5cbiAgICAgICAgICogRGVmYXVsdHMgdG8gYHswOkR9YFxuICAgICAgICAgKiAoW21vcmUgaW5mb3JtYXRpb25dKHslIHNsdWcgcGFyc2luZ2FuZGZvcm1hdHRpbmdfaW50bCAlfSN0b2MtZGF0ZS1mb3JtYXR0aW5nKSkuXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLnNlbGVjdGVkRGF0ZUZvcm1hdCA9ICd7MDpEfSc7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBUaGUgc2hvcnQtZGF0ZSBmb3JtYXQgZm9yIGRpc3BsYXlpbmcgdGhlXG4gICAgICAgICAqIHNlbGVjdGVkIGRhdGUgaW4gdGhlIFNjaGVkdWxlciB0b29sYmFyLlxuICAgICAgICAgKiBEZWZhdWx0cyB0byBgezA6RH1gXG4gICAgICAgICAqIChbbW9yZSBpbmZvcm1hdGlvbl0oeyUgc2x1ZyBwYXJzaW5nYW5kZm9ybWF0dGluZ19pbnRsICV9I3RvYy1kYXRlLWZvcm1hdHRpbmcpKS5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuc2VsZWN0ZWRTaG9ydERhdGVGb3JtYXQgPSAnezA6ZH0nO1xuICAgICAgICAvKipcbiAgICAgICAgICogVGhlIGludmFyaWFudCBuYW1lIGZvciB0aGlzIHZpZXcgKGBkYXlgKS5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMubmFtZSA9ICdkYXknO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBAaGlkZGVuXG4gICAgICovXG4gICAgZ2V0IHRpdGxlKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5sb2NhbGl6YXRpb24uZ2V0KCdkYXlWaWV3VGl0bGUnKTtcbiAgICB9XG59XG5EYXlWaWV3Q29tcG9uZW50LmRlY29yYXRvcnMgPSBbXG4gICAgeyB0eXBlOiBDb21wb25lbnQsIGFyZ3M6IFt7XG4gICAgICAgICAgICAgICAgY2hhbmdlRGV0ZWN0aW9uOiBDaGFuZ2VEZXRlY3Rpb25TdHJhdGVneS5PblB1c2gsXG4gICAgICAgICAgICAgICAgc2VsZWN0b3I6ICdrZW5kby1zY2hlZHVsZXItZGF5LXZpZXcnLFxuICAgICAgICAgICAgICAgIHByb3ZpZGVyczogW3tcbiAgICAgICAgICAgICAgICAgICAgICAgIHByb3ZpZGU6IFNjaGVkdWxlclZpZXcsXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmU6bm8tZm9yd2FyZC1yZWZcbiAgICAgICAgICAgICAgICAgICAgICAgIHVzZUV4aXN0aW5nOiBmb3J3YXJkUmVmKCgpID0+IERheVZpZXdDb21wb25lbnQpXG4gICAgICAgICAgICAgICAgICAgIH1dLFxuICAgICAgICAgICAgICAgIHRlbXBsYXRlOiBgXG4gICAgICAgIDxuZy10ZW1wbGF0ZSAjY29udGVudD5cbiAgICAgICAgICAgIDxtdWx0aS1kYXktdmlld1xuICAgICAgICAgICAgICAgIFtuYW1lXT1cIm5hbWVcIlxuICAgICAgICAgICAgICAgIFtldmVudEhlaWdodF09XCJ2aWV3RXZlbnRIZWlnaHRcIlxuICAgICAgICAgICAgICAgIFtjdXJyZW50VGltZU1hcmtlcl09XCJ2aWV3Q3VycmVudFRpbWVNYXJrZXJcIlxuICAgICAgICAgICAgICAgIFtzaG93V29ya0hvdXJzXT1cInNob3VsZFNob3dXb3JrSG91cnNcIlxuICAgICAgICAgICAgICAgIFtzY3JvbGxUaW1lXT1cInZpZXdTY3JvbGxUaW1lXCJcbiAgICAgICAgICAgICAgICBbc3RhcnRUaW1lXT1cInZpZXdTdGFydFRpbWVcIlxuICAgICAgICAgICAgICAgIFtlbmRUaW1lXT1cInZpZXdFbmRUaW1lXCJcbiAgICAgICAgICAgICAgICBbd29ya0RheVN0YXJ0XT1cInZpZXdXb3JrRGF5U3RhcnRcIlxuICAgICAgICAgICAgICAgIFt3b3JrRGF5RW5kXT1cInZpZXdXb3JrRGF5RW5kXCJcbiAgICAgICAgICAgICAgICBbd29ya1dlZWtTdGFydF09XCJ2aWV3V29ya1dlZWtTdGFydFwiXG4gICAgICAgICAgICAgICAgW3dvcmtXZWVrRW5kXT1cInZpZXdXb3JrV2Vla0VuZFwiXG4gICAgICAgICAgICAgICAgW3Nsb3REdXJhdGlvbl09XCJ2aWV3U2xvdER1cmF0aW9uXCJcbiAgICAgICAgICAgICAgICBbc2xvdERpdmlzaW9uc109XCJ2aWV3U2xvdERpdmlzaW9uc1wiXG4gICAgICAgICAgICAgICAgW3Nsb3RGaWxsXT1cInZpZXdTbG90RmlsbFwiXG4gICAgICAgICAgICAgICAgW3Nsb3RDbGFzc109XCJ2aWV3U2xvdENsYXNzXCJcbiAgICAgICAgICAgICAgICBbZXZlbnRDbGFzc109XCJ2aWV3RXZlbnRDbGFzc1wiXG4gICAgICAgICAgICAgICAgW2V2ZW50U3R5bGVzXT1cInZpZXdFdmVudFN0eWxlc1wiXG4gICAgICAgICAgICAgICAgW2FsbERheVNsb3RUZW1wbGF0ZV09XCJhbGxEYXlTbG90VGVtcGxhdGU/LnRlbXBsYXRlUmVmXCJcbiAgICAgICAgICAgICAgICBbYWxsRGF5RXZlbnRUZW1wbGF0ZV09XCJhbGxEYXlFdmVudFRlbXBsYXRlPy50ZW1wbGF0ZVJlZlwiXG4gICAgICAgICAgICAgICAgW9C1dmVudFRlbXBsYXRlXT1cImV2ZW50VGVtcGxhdGU/LnRlbXBsYXRlUmVmXCJcbiAgICAgICAgICAgICAgICBbZ3JvdXBIZWFkZXJUZW1wbGF0ZV09XCJncm91cEhlYWRlclRlbXBsYXRlPy50ZW1wbGF0ZVJlZlwiXG4gICAgICAgICAgICAgICAgW3RpbWVTbG90VGVtcGxhdGVdPVwidGltZVNsb3RUZW1wbGF0ZT8udGVtcGxhdGVSZWZcIlxuICAgICAgICAgICAgICAgIFttaW5vclRpbWVIZWFkZXJUZW1wbGF0ZV09XCJtaW5vclRpbWVIZWFkZXJUZW1wbGF0ZT8udGVtcGxhdGVSZWZcIlxuICAgICAgICAgICAgICAgIFttYWpvclRpbWVIZWFkZXJUZW1wbGF0ZV09XCJtYWpvclRpbWVIZWFkZXJUZW1wbGF0ZT8udGVtcGxhdGVSZWZcIlxuICAgICAgICAgICAgICAgIFtkYXRlSGVhZGVyVGVtcGxhdGVdPVwiZGF0ZUhlYWRlclRlbXBsYXRlPy50ZW1wbGF0ZVJlZlwiXG4gICAgICAgICAgICAgICAgW3NlbGVjdGVkRGF0ZUZvcm1hdF09XCJzZWxlY3RlZERhdGVGb3JtYXRcIlxuICAgICAgICAgICAgICAgIFtzZWxlY3RlZFNob3J0RGF0ZUZvcm1hdF09XCJzZWxlY3RlZFNob3J0RGF0ZUZvcm1hdFwiPlxuICAgICAgICAgICAgPC9tdWx0aS1kYXktdmlldz5cbiAgICAgICAgICAgIDxkaXYgdmlld0Zvb3RlciBrZW5kb1dvcmtIb3Vyc0Zvb3RlciBbc2hvd1dvcmtIb3Vyc109XCJzaG91bGRTaG93V29ya0hvdXJzXCIgKGl0ZW1DbGljayk9XCJzaG93V29ya0hvdXJzID0gIXNob3VsZFNob3dXb3JrSG91cnNcIj48L2Rpdj5cbiAgICAgICAgPC9uZy10ZW1wbGF0ZT5cbiAgICBgXG4gICAgICAgICAgICB9LF0gfSxcbl07XG4vKiogQG5vY29sbGFwc2UgKi9cbkRheVZpZXdDb21wb25lbnQuY3RvclBhcmFtZXRlcnMgPSAoKSA9PiBbXG4gICAgeyB0eXBlOiBMb2NhbGl6YXRpb25TZXJ2aWNlIH0sXG4gICAgeyB0eXBlOiBDaGFuZ2VEZXRlY3RvclJlZiB9LFxuICAgIHsgdHlwZTogVmlld0NvbnRleHRTZXJ2aWNlIH0sXG4gICAgeyB0eXBlOiBWaWV3U3RhdGVTZXJ2aWNlIH1cbl07XG5EYXlWaWV3Q29tcG9uZW50LnByb3BEZWNvcmF0b3JzID0ge1xuICAgIHNlbGVjdGVkRGF0ZUZvcm1hdDogW3sgdHlwZTogSW5wdXQgfV0sXG4gICAgc2VsZWN0ZWRTaG9ydERhdGVGb3JtYXQ6IFt7IHR5cGU6IElucHV0IH1dLFxuICAgIGFsbERheVNsb3RUZW1wbGF0ZTogW3sgdHlwZTogQ29udGVudENoaWxkLCBhcmdzOiBbQWxsRGF5U2xvdFRlbXBsYXRlRGlyZWN0aXZlLF0gfV0sXG4gICAgYWxsRGF5RXZlbnRUZW1wbGF0ZTogW3sgdHlwZTogQ29udGVudENoaWxkLCBhcmdzOiBbQWxsRGF5RXZlbnRUZW1wbGF0ZURpcmVjdGl2ZSxdIH1dLFxuICAgIG1pbm9yVGltZUhlYWRlclRlbXBsYXRlOiBbeyB0eXBlOiBDb250ZW50Q2hpbGQsIGFyZ3M6IFtNaW5vclRpbWVIZWFkZXJUZW1wbGF0ZURpcmVjdGl2ZSxdIH1dLFxuICAgIG1ham9yVGltZUhlYWRlclRlbXBsYXRlOiBbeyB0eXBlOiBDb250ZW50Q2hpbGQsIGFyZ3M6IFtNYWpvclRpbWVIZWFkZXJUZW1wbGF0ZURpcmVjdGl2ZSxdIH1dXG59O1xuXG4vKipcbiAqIFRoZSBjb21wb25lbnQgZm9yIHJlbmRlcmluZyB0aGUgKipNdWx0aS1EYXkqKiB2aWV3LlxuICovXG5jbGFzcyBNdWx0aURheVZpZXdDb21wb25lbnQgZXh0ZW5kcyBEYXlWaWV3Q29tcG9uZW50IHtcbiAgICBjb25zdHJ1Y3Rvcihsb2NhbGl6YXRpb24sIGNoYW5nZURldGVjdG9yLCB2aWV3Q29udGV4dCwgdmlld1N0YXRlKSB7XG4gICAgICAgIHN1cGVyKGxvY2FsaXphdGlvbiwgY2hhbmdlRGV0ZWN0b3IsIHZpZXdDb250ZXh0LCB2aWV3U3RhdGUpO1xuICAgICAgICAvKipcbiAgICAgICAgICogU3BlY2lmaWVzIHRoZSBudW1iZXIgb2YgZGF5cyB0aGF0IHRoZSB2aWV3IHdpbGwgcmVuZGVyLlxuICAgICAgICAgKiBEZWZhdWx0cyB0byBgMWAuXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLm51bWJlck9mRGF5cyA9IDE7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBUaGUgaW52YXJpYW50IG5hbWUgZm9yIHRoaXMgdmlldyAoYG11bHRpLWRheWApLlxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5uYW1lID0gJ211bHRpRGF5JztcbiAgICB9XG4gICAgLyoqXG4gICAgICogVGhlIGxvbmctZGF0ZSBmb3JtYXQgZm9yIGRpc3BsYXlpbmcgdGhlXG4gICAgICogc2VsZWN0ZWQgZGF0ZSBpbiB0aGUgU2NoZWR1bGVyIHRvb2xiYXIuXG4gICAgICogRGVmYXVsdHMgdG8gYHswOkR9IC0gezE6RH1gIGZvciBtdWx0aXBsZSBkYXlzIGFuZCBgezA6RH1gIGZvciBhIHNpbmdsZSBkYXlcbiAgICAgKiAoW21vcmUgaW5mb3JtYXRpb25dKHslIHNsdWcgcGFyc2luZ2FuZGZvcm1hdHRpbmdfaW50bCAlfSN0b2MtZGF0ZS1mb3JtYXR0aW5nKS5cbiAgICAgKi9cbiAgICBzZXQgc2VsZWN0ZWREYXRlRm9ybWF0KHZhbHVlKSB7XG4gICAgICAgIHRoaXMuZGF0ZUZvcm1hdCA9IHZhbHVlO1xuICAgIH1cbiAgICBnZXQgc2VsZWN0ZWREYXRlRm9ybWF0KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5kYXRlRm9ybWF0IHx8IHRoaXMuZGVmYXVsdERhdGVGb3JtYXQ7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFRoZSBzaG9ydCBkYXRlIGZvcm1hdCBmb3IgZGlzcGxheWluZyB0aGVcbiAgICAgKiBzZWxlY3RlZCBkYXRlIGluIHRoZSBTY2hlZHVsZXIgdG9vbGJhci5cbiAgICAgKiBEZWZhdWx0cyB0byBgezA6ZH0gLSB7MTpkfWAgZm9yIG11bHRpcGxlIGRheXMgYW5kIGB7MDpkfWAgZm9yIGEgc2luZ2xlIGRheVxuICAgICAqIChbbW9yZSBpbmZvcm1hdGlvbl0oeyUgc2x1ZyBwYXJzaW5nYW5kZm9ybWF0dGluZ19pbnRsICV9I3RvYy1kYXRlLWZvcm1hdHRpbmcpLlxuICAgICAqL1xuICAgIHNldCBzZWxlY3RlZFNob3J0RGF0ZUZvcm1hdCh2YWx1ZSkge1xuICAgICAgICB0aGlzLnNob3J0RGF0ZUZvcm1hdCA9IHZhbHVlO1xuICAgIH1cbiAgICBnZXQgc2VsZWN0ZWRTaG9ydERhdGVGb3JtYXQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnNob3J0RGF0ZUZvcm1hdCB8fCB0aGlzLmRlZmF1bHRTaG9ydERhdGVGb3JtYXQ7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEBoaWRkZW5cbiAgICAgKi9cbiAgICBnZXQgdGl0bGUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmxvY2FsaXphdGlvbi5nZXQoJ211bHRpRGF5Vmlld1RpdGxlJyk7XG4gICAgfVxuICAgIGdldCBkZWZhdWx0RGF0ZUZvcm1hdCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubnVtYmVyT2ZEYXlzID09PSAxID8gJ3swOkR9JyA6ICd7MDpEfSAtIHsxOkR9JztcbiAgICB9XG4gICAgZ2V0IGRlZmF1bHRTaG9ydERhdGVGb3JtYXQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm51bWJlck9mRGF5cyA9PT0gMSA/ICd7MDpkfScgOiAnezA6ZH0gLSB7MTpkfSc7XG4gICAgfVxufVxuTXVsdGlEYXlWaWV3Q29tcG9uZW50LmRlY29yYXRvcnMgPSBbXG4gICAgeyB0eXBlOiBDb21wb25lbnQsIGFyZ3M6IFt7XG4gICAgICAgICAgICAgICAgY2hhbmdlRGV0ZWN0aW9uOiBDaGFuZ2VEZXRlY3Rpb25TdHJhdGVneS5PblB1c2gsXG4gICAgICAgICAgICAgICAgc2VsZWN0b3I6ICdrZW5kby1zY2hlZHVsZXItbXVsdGktZGF5LXZpZXcnLFxuICAgICAgICAgICAgICAgIHByb3ZpZGVyczogW3tcbiAgICAgICAgICAgICAgICAgICAgICAgIHByb3ZpZGU6IFNjaGVkdWxlclZpZXcsXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmU6bm8tZm9yd2FyZC1yZWZcbiAgICAgICAgICAgICAgICAgICAgICAgIHVzZUV4aXN0aW5nOiBmb3J3YXJkUmVmKCgpID0+IE11bHRpRGF5Vmlld0NvbXBvbmVudClcbiAgICAgICAgICAgICAgICAgICAgfV0sXG4gICAgICAgICAgICAgICAgdGVtcGxhdGU6IGBcbiAgICAgICAgPG5nLXRlbXBsYXRlICNjb250ZW50PlxuICAgICAgICAgICAgPG11bHRpLWRheS12aWV3XG4gICAgICAgICAgICAgICAgdmlld05hbWU9XCJkYXlcIlxuICAgICAgICAgICAgICAgIFtuYW1lXT1cIm5hbWVcIlxuICAgICAgICAgICAgICAgIFtudW1iZXJPZkRheXNdPVwibnVtYmVyT2ZEYXlzXCJcbiAgICAgICAgICAgICAgICBbZXZlbnRIZWlnaHRdPVwidmlld0V2ZW50SGVpZ2h0XCJcbiAgICAgICAgICAgICAgICBbY3VycmVudFRpbWVNYXJrZXJdPVwidmlld0N1cnJlbnRUaW1lTWFya2VyXCJcbiAgICAgICAgICAgICAgICBbc2hvd1dvcmtIb3Vyc109XCJzaG91bGRTaG93V29ya0hvdXJzXCJcbiAgICAgICAgICAgICAgICBbc2Nyb2xsVGltZV09XCJ2aWV3U2Nyb2xsVGltZVwiXG4gICAgICAgICAgICAgICAgW3N0YXJ0VGltZV09XCJ2aWV3U3RhcnRUaW1lXCJcbiAgICAgICAgICAgICAgICBbZW5kVGltZV09XCJ2aWV3RW5kVGltZVwiXG4gICAgICAgICAgICAgICAgW3dvcmtEYXlTdGFydF09XCJ2aWV3V29ya0RheVN0YXJ0XCJcbiAgICAgICAgICAgICAgICBbd29ya0RheUVuZF09XCJ2aWV3V29ya0RheUVuZFwiXG4gICAgICAgICAgICAgICAgW3dvcmtXZWVrU3RhcnRdPVwidmlld1dvcmtXZWVrU3RhcnRcIlxuICAgICAgICAgICAgICAgIFt3b3JrV2Vla0VuZF09XCJ2aWV3V29ya1dlZWtFbmRcIlxuICAgICAgICAgICAgICAgIFtzbG90RHVyYXRpb25dPVwidmlld1Nsb3REdXJhdGlvblwiXG4gICAgICAgICAgICAgICAgW3Nsb3REaXZpc2lvbnNdPVwidmlld1Nsb3REaXZpc2lvbnNcIlxuICAgICAgICAgICAgICAgIFtzbG90RmlsbF09XCJ2aWV3U2xvdEZpbGxcIlxuICAgICAgICAgICAgICAgIFtzbG90Q2xhc3NdPVwidmlld1Nsb3RDbGFzc1wiXG4gICAgICAgICAgICAgICAgW2V2ZW50Q2xhc3NdPVwidmlld0V2ZW50Q2xhc3NcIlxuICAgICAgICAgICAgICAgIFtldmVudFN0eWxlc109XCJ2aWV3RXZlbnRTdHlsZXNcIlxuICAgICAgICAgICAgICAgIFthbGxEYXlTbG90VGVtcGxhdGVdPVwiYWxsRGF5U2xvdFRlbXBsYXRlPy50ZW1wbGF0ZVJlZlwiXG4gICAgICAgICAgICAgICAgW2FsbERheUV2ZW50VGVtcGxhdGVdPVwiYWxsRGF5RXZlbnRUZW1wbGF0ZT8udGVtcGxhdGVSZWZcIlxuICAgICAgICAgICAgICAgIFvQtXZlbnRUZW1wbGF0ZV09XCJldmVudFRlbXBsYXRlPy50ZW1wbGF0ZVJlZlwiXG4gICAgICAgICAgICAgICAgW2dyb3VwSGVhZGVyVGVtcGxhdGVdPVwiZ3JvdXBIZWFkZXJUZW1wbGF0ZT8udGVtcGxhdGVSZWZcIlxuICAgICAgICAgICAgICAgIFt0aW1lU2xvdFRlbXBsYXRlXT1cInRpbWVTbG90VGVtcGxhdGU/LnRlbXBsYXRlUmVmXCJcbiAgICAgICAgICAgICAgICBbbWlub3JUaW1lSGVhZGVyVGVtcGxhdGVdPVwibWlub3JUaW1lSGVhZGVyVGVtcGxhdGU/LnRlbXBsYXRlUmVmXCJcbiAgICAgICAgICAgICAgICBbbWFqb3JUaW1lSGVhZGVyVGVtcGxhdGVdPVwibWFqb3JUaW1lSGVhZGVyVGVtcGxhdGU/LnRlbXBsYXRlUmVmXCJcbiAgICAgICAgICAgICAgICBbZGF0ZUhlYWRlclRlbXBsYXRlXT1cImRhdGVIZWFkZXJUZW1wbGF0ZT8udGVtcGxhdGVSZWZcIlxuICAgICAgICAgICAgICAgIFtzZWxlY3RlZERhdGVGb3JtYXRdPVwic2VsZWN0ZWREYXRlRm9ybWF0XCJcbiAgICAgICAgICAgICAgICBbc2VsZWN0ZWRTaG9ydERhdGVGb3JtYXRdPVwic2VsZWN0ZWRTaG9ydERhdGVGb3JtYXRcIj5cbiAgICAgICAgICAgIDwvbXVsdGktZGF5LXZpZXc+XG4gICAgICAgICAgICA8ZGl2IHZpZXdGb290ZXIga2VuZG9Xb3JrSG91cnNGb290ZXIgW3Nob3dXb3JrSG91cnNdPVwic2hvdWxkU2hvd1dvcmtIb3Vyc1wiIChpdGVtQ2xpY2spPVwic2hvd1dvcmtIb3VycyA9ICFzaG91bGRTaG93V29ya0hvdXJzXCI+PC9kaXY+XG4gICAgICAgIDwvbmctdGVtcGxhdGU+XG4gICAgYFxuICAgICAgICAgICAgfSxdIH0sXG5dO1xuLyoqIEBub2NvbGxhcHNlICovXG5NdWx0aURheVZpZXdDb21wb25lbnQuY3RvclBhcmFtZXRlcnMgPSAoKSA9PiBbXG4gICAgeyB0eXBlOiBMb2NhbGl6YXRpb25TZXJ2aWNlIH0sXG4gICAgeyB0eXBlOiBDaGFuZ2VEZXRlY3RvclJlZiB9LFxuICAgIHsgdHlwZTogVmlld0NvbnRleHRTZXJ2aWNlIH0sXG4gICAgeyB0eXBlOiBWaWV3U3RhdGVTZXJ2aWNlIH1cbl07XG5NdWx0aURheVZpZXdDb21wb25lbnQucHJvcERlY29yYXRvcnMgPSB7XG4gICAgc2VsZWN0ZWREYXRlRm9ybWF0OiBbeyB0eXBlOiBJbnB1dCB9XSxcbiAgICBzZWxlY3RlZFNob3J0RGF0ZUZvcm1hdDogW3sgdHlwZTogSW5wdXQgfV0sXG4gICAgbnVtYmVyT2ZEYXlzOiBbeyB0eXBlOiBJbnB1dCB9XVxufTtcblxuLyoqXG4gKiBUaGUgY29tcG9uZW50IGZvciByZW5kZXJpbmcgdGhlICoqV2VlayoqIHZpZXcuXG4gKi9cbmNsYXNzIFdlZWtWaWV3Q29tcG9uZW50IGV4dGVuZHMgTXVsdGlEYXlWaWV3QmFzZSB7XG4gICAgY29uc3RydWN0b3IoaW50bCwgbG9jYWxpemF0aW9uLCBjaGFuZ2VEZXRlY3Rvciwgdmlld0NvbnRleHQsIHZpZXdTdGF0ZSkge1xuICAgICAgICBzdXBlcihsb2NhbGl6YXRpb24sIGNoYW5nZURldGVjdG9yLCB2aWV3Q29udGV4dCwgdmlld1N0YXRlKTtcbiAgICAgICAgdGhpcy5pbnRsID0gaW50bDtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRoZSBsb25nLWRhdGUgZm9ybWF0IGZvciBkaXNwbGF5aW5nIHRoZVxuICAgICAgICAgKiBzZWxlY3RlZCBkYXRlIGluIHRoZSBTY2hlZHVsZXIgdG9vbGJhci5cbiAgICAgICAgICogRGVmYXVsdHMgdG8gYHswOkR9IC0gezE6RH1gLFxuICAgICAgICAgKiB3aGVyZSBgMGAgaXMgdGhlIHN0YXJ0IGFuZCBgMWAgaXMgdGhlIGVuZCBkYXRlXG4gICAgICAgICAqIChbbW9yZSBpbmZvcm1hdGlvbl0oeyUgc2x1ZyBwYXJzaW5nYW5kZm9ybWF0dGluZ19pbnRsICV9I3RvYy1kYXRlLWZvcm1hdHRpbmcpLlxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5zZWxlY3RlZERhdGVGb3JtYXQgPSAnezA6RH0gLSB7MTpEfSc7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBUaGUgc2hvcnQgZGF0ZSBmb3JtYXQgZm9yIGRpc3BsYXlpbmcgdGhlXG4gICAgICAgICAqIHNlbGVjdGVkIGRhdGUgaW4gdGhlIFNjaGVkdWxlciB0b29sYmFyLlxuICAgICAgICAgKiBEZWZhdWx0cyB0byBgezA6ZH0gLSB7MTpkfWAsXG4gICAgICAgICAqIHdoZXJlIGAwYCBpcyB0aGUgc3RhcnQgYW5kIGAxYCBpcyB0aGUgZW5kIGRhdGVcbiAgICAgICAgICogKFttb3JlIGluZm9ybWF0aW9uXSh7JSBzbHVnIHBhcnNpbmdhbmRmb3JtYXR0aW5nX2ludGwgJX0jdG9jLWRhdGUtZm9ybWF0dGluZykuXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLnNlbGVjdGVkU2hvcnREYXRlRm9ybWF0ID0gJ3swOmR9IC0gezE6ZH0nO1xuICAgICAgICAvKipcbiAgICAgICAgICogVGhlIGludmFyaWFudCBuYW1lIGZvciB0aGlzIHZpZXcgKGB3ZWVrYCkuXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLm5hbWUgPSAnd2Vlayc7XG4gICAgICAgIHRoaXMuZ2V0U3RhcnREYXRlID0gdGhpcy5nZXRTdGFydERhdGUuYmluZCh0aGlzKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQGhpZGRlblxuICAgICAqL1xuICAgIGdldCB0aXRsZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubG9jYWxpemF0aW9uLmdldCgnd2Vla1ZpZXdUaXRsZScpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBAaGlkZGVuXG4gICAgICovXG4gICAgZ2V0U3RhcnREYXRlKHNlbGVjdGVkRGF0ZSkge1xuICAgICAgICByZXR1cm4gZmlyc3REYXlJbldlZWsoZ2V0RGF0ZShzZWxlY3RlZERhdGUpLCB0aGlzLmludGwuZmlyc3REYXkoKSk7XG4gICAgfVxufVxuV2Vla1ZpZXdDb21wb25lbnQuZGVjb3JhdG9ycyA9IFtcbiAgICB7IHR5cGU6IENvbXBvbmVudCwgYXJnczogW3tcbiAgICAgICAgICAgICAgICBjaGFuZ2VEZXRlY3Rpb246IENoYW5nZURldGVjdGlvblN0cmF0ZWd5Lk9uUHVzaCxcbiAgICAgICAgICAgICAgICBzZWxlY3RvcjogJ2tlbmRvLXNjaGVkdWxlci13ZWVrLXZpZXcnLFxuICAgICAgICAgICAgICAgIHByb3ZpZGVyczogW3tcbiAgICAgICAgICAgICAgICAgICAgICAgIHByb3ZpZGU6IFNjaGVkdWxlclZpZXcsXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmU6bm8tZm9yd2FyZC1yZWZcbiAgICAgICAgICAgICAgICAgICAgICAgIHVzZUV4aXN0aW5nOiBmb3J3YXJkUmVmKCgpID0+IFdlZWtWaWV3Q29tcG9uZW50KVxuICAgICAgICAgICAgICAgICAgICB9XSxcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZTogYFxuICAgICAgICA8bmctdGVtcGxhdGUgI2NvbnRlbnQ+XG4gICAgICAgICAgICA8bXVsdGktZGF5LXZpZXdcbiAgICAgICAgICAgICAgICBbbmFtZV09XCJuYW1lXCJcbiAgICAgICAgICAgICAgICBbbnVtYmVyT2ZEYXlzXT1cIjdcIlxuICAgICAgICAgICAgICAgIFtnZXRTdGFydERhdGVdPVwiZ2V0U3RhcnREYXRlXCJcbiAgICAgICAgICAgICAgICBbZXZlbnRIZWlnaHRdPVwidmlld0V2ZW50SGVpZ2h0XCJcbiAgICAgICAgICAgICAgICBbY3VycmVudFRpbWVNYXJrZXJdPVwidmlld0N1cnJlbnRUaW1lTWFya2VyXCJcbiAgICAgICAgICAgICAgICBbc2hvd1dvcmtIb3Vyc109XCJzaG91bGRTaG93V29ya0hvdXJzXCJcbiAgICAgICAgICAgICAgICBbc2Nyb2xsVGltZV09XCJ2aWV3U2Nyb2xsVGltZVwiXG4gICAgICAgICAgICAgICAgW3N0YXJ0VGltZV09XCJ2aWV3U3RhcnRUaW1lXCJcbiAgICAgICAgICAgICAgICBbZW5kVGltZV09XCJ2aWV3RW5kVGltZVwiXG4gICAgICAgICAgICAgICAgW3dvcmtEYXlTdGFydF09XCJ2aWV3V29ya0RheVN0YXJ0XCJcbiAgICAgICAgICAgICAgICBbd29ya0RheUVuZF09XCJ2aWV3V29ya0RheUVuZFwiXG4gICAgICAgICAgICAgICAgW3dvcmtXZWVrU3RhcnRdPVwidmlld1dvcmtXZWVrU3RhcnRcIlxuICAgICAgICAgICAgICAgIFt3b3JrV2Vla0VuZF09XCJ2aWV3V29ya1dlZWtFbmRcIlxuICAgICAgICAgICAgICAgIFtzbG90RHVyYXRpb25dPVwidmlld1Nsb3REdXJhdGlvblwiXG4gICAgICAgICAgICAgICAgW3Nsb3REaXZpc2lvbnNdPVwidmlld1Nsb3REaXZpc2lvbnNcIlxuICAgICAgICAgICAgICAgIFtzbG90RmlsbF09XCJ2aWV3U2xvdEZpbGxcIlxuICAgICAgICAgICAgICAgIFtzbG90Q2xhc3NdPVwidmlld1Nsb3RDbGFzc1wiXG4gICAgICAgICAgICAgICAgW2V2ZW50Q2xhc3NdPVwidmlld0V2ZW50Q2xhc3NcIlxuICAgICAgICAgICAgICAgIFtldmVudFN0eWxlc109XCJ2aWV3RXZlbnRTdHlsZXNcIlxuICAgICAgICAgICAgICAgIFthbGxEYXlTbG90VGVtcGxhdGVdPVwiYWxsRGF5U2xvdFRlbXBsYXRlPy50ZW1wbGF0ZVJlZlwiXG4gICAgICAgICAgICAgICAgW2FsbERheUV2ZW50VGVtcGxhdGVdPVwiYWxsRGF5RXZlbnRUZW1wbGF0ZT8udGVtcGxhdGVSZWZcIlxuICAgICAgICAgICAgICAgIFvQtXZlbnRUZW1wbGF0ZV09XCJldmVudFRlbXBsYXRlPy50ZW1wbGF0ZVJlZlwiXG4gICAgICAgICAgICAgICAgW2dyb3VwSGVhZGVyVGVtcGxhdGVdPVwiZ3JvdXBIZWFkZXJUZW1wbGF0ZT8udGVtcGxhdGVSZWZcIlxuICAgICAgICAgICAgICAgIFt0aW1lU2xvdFRlbXBsYXRlXT1cInRpbWVTbG90VGVtcGxhdGU/LnRlbXBsYXRlUmVmXCJcbiAgICAgICAgICAgICAgICBbbWlub3JUaW1lSGVhZGVyVGVtcGxhdGVdPVwibWlub3JUaW1lSGVhZGVyVGVtcGxhdGU/LnRlbXBsYXRlUmVmXCJcbiAgICAgICAgICAgICAgICBbbWFqb3JUaW1lSGVhZGVyVGVtcGxhdGVdPVwibWFqb3JUaW1lSGVhZGVyVGVtcGxhdGU/LnRlbXBsYXRlUmVmXCJcbiAgICAgICAgICAgICAgICBbZGF0ZUhlYWRlclRlbXBsYXRlXT1cImRhdGVIZWFkZXJUZW1wbGF0ZT8udGVtcGxhdGVSZWZcIlxuICAgICAgICAgICAgICAgIFtzZWxlY3RlZERhdGVGb3JtYXRdPVwic2VsZWN0ZWREYXRlRm9ybWF0XCJcbiAgICAgICAgICAgICAgICBbc2VsZWN0ZWRTaG9ydERhdGVGb3JtYXRdPVwic2VsZWN0ZWRTaG9ydERhdGVGb3JtYXRcIj5cbiAgICAgICAgICAgIDwvbXVsdGktZGF5LXZpZXc+XG4gICAgICAgICAgICA8ZGl2IHZpZXdGb290ZXIga2VuZG9Xb3JrSG91cnNGb290ZXIgW3Nob3dXb3JrSG91cnNdPVwic2hvdWxkU2hvd1dvcmtIb3Vyc1wiIChpdGVtQ2xpY2spPVwic2hvd1dvcmtIb3VycyA9ICFzaG91bGRTaG93V29ya0hvdXJzXCI+PC9kaXY+XG4gICAgICAgIDwvbmctdGVtcGxhdGU+XG4gICAgYFxuICAgICAgICAgICAgfSxdIH0sXG5dO1xuLyoqIEBub2NvbGxhcHNlICovXG5XZWVrVmlld0NvbXBvbmVudC5jdG9yUGFyYW1ldGVycyA9ICgpID0+IFtcbiAgICB7IHR5cGU6IEludGxTZXJ2aWNlIH0sXG4gICAgeyB0eXBlOiBMb2NhbGl6YXRpb25TZXJ2aWNlIH0sXG4gICAgeyB0eXBlOiBDaGFuZ2VEZXRlY3RvclJlZiB9LFxuICAgIHsgdHlwZTogVmlld0NvbnRleHRTZXJ2aWNlIH0sXG4gICAgeyB0eXBlOiBWaWV3U3RhdGVTZXJ2aWNlIH1cbl07XG5XZWVrVmlld0NvbXBvbmVudC5wcm9wRGVjb3JhdG9ycyA9IHtcbiAgICBzZWxlY3RlZERhdGVGb3JtYXQ6IFt7IHR5cGU6IElucHV0IH1dLFxuICAgIHNlbGVjdGVkU2hvcnREYXRlRm9ybWF0OiBbeyB0eXBlOiBJbnB1dCB9XSxcbiAgICBhbGxEYXlTbG90VGVtcGxhdGU6IFt7IHR5cGU6IENvbnRlbnRDaGlsZCwgYXJnczogW0FsbERheVNsb3RUZW1wbGF0ZURpcmVjdGl2ZSxdIH1dLFxuICAgIGFsbERheUV2ZW50VGVtcGxhdGU6IFt7IHR5cGU6IENvbnRlbnRDaGlsZCwgYXJnczogW0FsbERheUV2ZW50VGVtcGxhdGVEaXJlY3RpdmUsXSB9XSxcbiAgICBtaW5vclRpbWVIZWFkZXJUZW1wbGF0ZTogW3sgdHlwZTogQ29udGVudENoaWxkLCBhcmdzOiBbTWlub3JUaW1lSGVhZGVyVGVtcGxhdGVEaXJlY3RpdmUsXSB9XSxcbiAgICBtYWpvclRpbWVIZWFkZXJUZW1wbGF0ZTogW3sgdHlwZTogQ29udGVudENoaWxkLCBhcmdzOiBbTWFqb3JUaW1lSGVhZGVyVGVtcGxhdGVEaXJlY3RpdmUsXSB9XVxufTtcblxuY29uc3QgREFZU19JTl9XRUVLJDEgPSA3O1xuLyoqXG4gKiBUaGUgY29tcG9uZW50IGZvciByZW5kZXJpbmcgdGhlICoqV29yayBXZWVrKiogdmlldy5cbiAqL1xuY2xhc3MgV29ya1dlZWtWaWV3Q29tcG9uZW50IGV4dGVuZHMgV2Vla1ZpZXdDb21wb25lbnQge1xuICAgIGNvbnN0cnVjdG9yKGludGwsIGxvY2FsaXphdGlvbiwgY2hhbmdlRGV0ZWN0b3IsIHZpZXdDb250ZXh0LCB2aWV3U3RhdGUpIHtcbiAgICAgICAgc3VwZXIoaW50bCwgbG9jYWxpemF0aW9uLCBjaGFuZ2VEZXRlY3Rvciwgdmlld0NvbnRleHQsIHZpZXdTdGF0ZSk7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBUaGUgaW52YXJpYW50IG5hbWUgZm9yIHRoaXMgdmlldyAoYHdlZWtgKS5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMubmFtZSA9ICd3b3JrV2Vlayc7XG4gICAgICAgIHRoaXMuZ2V0TmV4dERhdGUgPSB0aGlzLmdldE5leHREYXRlLmJpbmQodGhpcyk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEBoaWRkZW5cbiAgICAgKi9cbiAgICBnZXQgdGl0bGUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmxvY2FsaXphdGlvbi5nZXQoJ3dvcmtXZWVrVmlld1RpdGxlJyk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEBoaWRkZW5cbiAgICAgKi9cbiAgICBnZXQgbnVtYmVyT2ZEYXlzKCkge1xuICAgICAgICBpZiAodGhpcy52aWV3V29ya1dlZWtTdGFydCA+IHRoaXMudmlld1dvcmtXZWVrRW5kKSB7XG4gICAgICAgICAgICByZXR1cm4gKERBWVNfSU5fV0VFSyQxIC0gdGhpcy52aWV3V29ya1dlZWtTdGFydCArIHRoaXMudmlld1dvcmtXZWVrRW5kKSArIDE7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuICh0aGlzLnZpZXdXb3JrV2Vla0VuZCAtIHRoaXMudmlld1dvcmtXZWVrU3RhcnQpICsgMTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQGhpZGRlblxuICAgICAqL1xuICAgIGdldFN0YXJ0RGF0ZShzZWxlY3RlZERhdGUpIHtcbiAgICAgICAgcmV0dXJuIGZpcnN0RGF5SW5XZWVrKGdldERhdGUoc2VsZWN0ZWREYXRlKSwgdGhpcy52aWV3V29ya1dlZWtTdGFydCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEBoaWRkZW5cbiAgICAgKi9cbiAgICBnZXROZXh0RGF0ZShkYXRlLCBjb3VudCwgX251bWJlck9mRGF5cykge1xuICAgICAgICByZXR1cm4gZ2V0RGF0ZShhZGREYXlzKGRhdGUsIERBWVNfSU5fV0VFSyQxICogY291bnQpKTtcbiAgICB9XG59XG5Xb3JrV2Vla1ZpZXdDb21wb25lbnQuZGVjb3JhdG9ycyA9IFtcbiAgICB7IHR5cGU6IENvbXBvbmVudCwgYXJnczogW3tcbiAgICAgICAgICAgICAgICBjaGFuZ2VEZXRlY3Rpb246IENoYW5nZURldGVjdGlvblN0cmF0ZWd5Lk9uUHVzaCxcbiAgICAgICAgICAgICAgICBzZWxlY3RvcjogJ2tlbmRvLXNjaGVkdWxlci13b3JrLXdlZWstdmlldycsXG4gICAgICAgICAgICAgICAgcHJvdmlkZXJzOiBbe1xuICAgICAgICAgICAgICAgICAgICAgICAgcHJvdmlkZTogU2NoZWR1bGVyVmlldyxcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHRzbGludDpkaXNhYmxlLW5leHQtbGluZTpuby1mb3J3YXJkLXJlZlxuICAgICAgICAgICAgICAgICAgICAgICAgdXNlRXhpc3Rpbmc6IGZvcndhcmRSZWYoKCkgPT4gV29ya1dlZWtWaWV3Q29tcG9uZW50KVxuICAgICAgICAgICAgICAgICAgICB9XSxcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZTogYFxuICAgICAgICA8bmctdGVtcGxhdGUgI2NvbnRlbnQ+XG4gICAgICAgICAgICA8bXVsdGktZGF5LXZpZXdcbiAgICAgICAgICAgICAgICB2aWV3TmFtZT1cIndvcmtXZWVrdmlld1wiXG4gICAgICAgICAgICAgICAgW25hbWVdPVwibmFtZVwiXG4gICAgICAgICAgICAgICAgW251bWJlck9mRGF5c109XCJudW1iZXJPZkRheXNcIlxuICAgICAgICAgICAgICAgIFtnZXRTdGFydERhdGVdPVwiZ2V0U3RhcnREYXRlXCJcbiAgICAgICAgICAgICAgICBbZ2V0TmV4dERhdGVdPVwiZ2V0TmV4dERhdGVcIlxuICAgICAgICAgICAgICAgIFtldmVudEhlaWdodF09XCJ2aWV3RXZlbnRIZWlnaHRcIlxuICAgICAgICAgICAgICAgIFtjdXJyZW50VGltZU1hcmtlcl09XCJ2aWV3Q3VycmVudFRpbWVNYXJrZXJcIlxuICAgICAgICAgICAgICAgIFtzaG93V29ya0hvdXJzXT1cInNob3VsZFNob3dXb3JrSG91cnNcIlxuICAgICAgICAgICAgICAgIFtzY3JvbGxUaW1lXT1cInZpZXdTY3JvbGxUaW1lXCJcbiAgICAgICAgICAgICAgICBbc3RhcnRUaW1lXT1cInZpZXdTdGFydFRpbWVcIlxuICAgICAgICAgICAgICAgIFtlbmRUaW1lXT1cInZpZXdFbmRUaW1lXCJcbiAgICAgICAgICAgICAgICBbd29ya0RheVN0YXJ0XT1cInZpZXdXb3JrRGF5U3RhcnRcIlxuICAgICAgICAgICAgICAgIFt3b3JrRGF5RW5kXT1cInZpZXdXb3JrRGF5RW5kXCJcbiAgICAgICAgICAgICAgICBbd29ya1dlZWtTdGFydF09XCJ2aWV3V29ya1dlZWtTdGFydFwiXG4gICAgICAgICAgICAgICAgW3dvcmtXZWVrRW5kXT1cInZpZXdXb3JrV2Vla0VuZFwiXG4gICAgICAgICAgICAgICAgW3Nsb3REdXJhdGlvbl09XCJ2aWV3U2xvdER1cmF0aW9uXCJcbiAgICAgICAgICAgICAgICBbc2xvdERpdmlzaW9uc109XCJ2aWV3U2xvdERpdmlzaW9uc1wiXG4gICAgICAgICAgICAgICAgW3Nsb3RGaWxsXT1cInZpZXdTbG90RmlsbFwiXG4gICAgICAgICAgICAgICAgW3Nsb3RDbGFzc109XCJ2aWV3U2xvdENsYXNzXCJcbiAgICAgICAgICAgICAgICBbZXZlbnRDbGFzc109XCJ2aWV3RXZlbnRDbGFzc1wiXG4gICAgICAgICAgICAgICAgW2V2ZW50U3R5bGVzXT1cInZpZXdFdmVudFN0eWxlc1wiXG4gICAgICAgICAgICAgICAgW2FsbERheVNsb3RUZW1wbGF0ZV09XCJhbGxEYXlTbG90VGVtcGxhdGU/LnRlbXBsYXRlUmVmXCJcbiAgICAgICAgICAgICAgICBbYWxsRGF5RXZlbnRUZW1wbGF0ZV09XCJhbGxEYXlFdmVudFRlbXBsYXRlPy50ZW1wbGF0ZVJlZlwiXG4gICAgICAgICAgICAgICAgW9C1dmVudFRlbXBsYXRlXT1cImV2ZW50VGVtcGxhdGU/LnRlbXBsYXRlUmVmXCJcbiAgICAgICAgICAgICAgICBbZ3JvdXBIZWFkZXJUZW1wbGF0ZV09XCJncm91cEhlYWRlclRlbXBsYXRlPy50ZW1wbGF0ZVJlZlwiXG4gICAgICAgICAgICAgICAgW3RpbWVTbG90VGVtcGxhdGVdPVwidGltZVNsb3RUZW1wbGF0ZT8udGVtcGxhdGVSZWZcIlxuICAgICAgICAgICAgICAgIFttaW5vclRpbWVIZWFkZXJUZW1wbGF0ZV09XCJtaW5vclRpbWVIZWFkZXJUZW1wbGF0ZT8udGVtcGxhdGVSZWZcIlxuICAgICAgICAgICAgICAgIFttYWpvclRpbWVIZWFkZXJUZW1wbGF0ZV09XCJtYWpvclRpbWVIZWFkZXJUZW1wbGF0ZT8udGVtcGxhdGVSZWZcIlxuICAgICAgICAgICAgICAgIFtkYXRlSGVhZGVyVGVtcGxhdGVdPVwiZGF0ZUhlYWRlclRlbXBsYXRlPy50ZW1wbGF0ZVJlZlwiXG4gICAgICAgICAgICAgICAgW3NlbGVjdGVkRGF0ZUZvcm1hdF09XCJzZWxlY3RlZERhdGVGb3JtYXRcIlxuICAgICAgICAgICAgICAgIFtzZWxlY3RlZFNob3J0RGF0ZUZvcm1hdF09XCJzZWxlY3RlZFNob3J0RGF0ZUZvcm1hdFwiPlxuICAgICAgICAgICAgPC9tdWx0aS1kYXktdmlldz5cbiAgICAgICAgICAgIDxkaXYgdmlld0Zvb3RlciBrZW5kb1dvcmtIb3Vyc0Zvb3RlciBbc2hvd1dvcmtIb3Vyc109XCJzaG91bGRTaG93V29ya0hvdXJzXCIgKGl0ZW1DbGljayk9XCJzaG93V29ya0hvdXJzID0gIXNob3VsZFNob3dXb3JrSG91cnNcIj48L2Rpdj5cbiAgICAgICAgPC9uZy10ZW1wbGF0ZT5cbiAgICBgXG4gICAgICAgICAgICB9LF0gfSxcbl07XG4vKiogQG5vY29sbGFwc2UgKi9cbldvcmtXZWVrVmlld0NvbXBvbmVudC5jdG9yUGFyYW1ldGVycyA9ICgpID0+IFtcbiAgICB7IHR5cGU6IEludGxTZXJ2aWNlIH0sXG4gICAgeyB0eXBlOiBMb2NhbGl6YXRpb25TZXJ2aWNlIH0sXG4gICAgeyB0eXBlOiBDaGFuZ2VEZXRlY3RvclJlZiB9LFxuICAgIHsgdHlwZTogVmlld0NvbnRleHRTZXJ2aWNlIH0sXG4gICAgeyB0eXBlOiBWaWV3U3RhdGVTZXJ2aWNlIH1cbl07XG5cbmNvbnN0IEVWRU5UU19PRkZTRVQgPSAxMDtcbmNvbnN0IE1JTl9FVkVOVF9IRUlHSFQgPSAyNTtcbmNvbnN0IG1pbkhlaWdodE92ZXJsYXBzID0gKHRvcDEsIHRvcDIpID0+IHRvcDEgPD0gdG9wMiAmJiB0b3AyIDw9IHRvcDEgKyBNSU5fRVZFTlRfSEVJR0hUO1xuY29uc3QgdGltZU9mZnNldCA9IChzbG90LCBkYXRlLCB2ZXJ0aWNhbCA9IHRydWUpID0+IHtcbiAgICBpZiAoc2xvdC5zdGFydC5nZXRUaW1lKCkgPD0gZGF0ZS5nZXRUaW1lKCkpIHtcbiAgICAgICAgcmV0dXJuICh2ZXJ0aWNhbCA/IHNsb3QuaGVpZ2h0IDogc2xvdC53aWR0aCkgKiAoKGRhdGUuZ2V0VGltZSgpIC0gc2xvdC5zdGFydC5nZXRUaW1lKCkpIC8gKHNsb3QuZW5kLmdldFRpbWUoKSAtIHNsb3Quc3RhcnQuZ2V0VGltZSgpKSk7XG4gICAgfVxuICAgIHJldHVybiAwO1xufTtcbmNvbnN0IGNvbHVtbkluZGV4Q29tcGFyZXIgPSAoYSwgYikgPT4ge1xuICAgIGNvbnN0IGluZGV4QSA9IGlzTnVtYmVyKGEuY29sdW1uSW5kZXgpID8gYS5jb2x1bW5JbmRleCA6IE51bWJlci5NQVhfVkFMVUU7XG4gICAgY29uc3QgaW5kZXhCID0gaXNOdW1iZXIoYi5jb2x1bW5JbmRleCkgPyBiLmNvbHVtbkluZGV4IDogTnVtYmVyLk1BWF9WQUxVRTtcbiAgICAvLyBhIHVuIGIgZGVmID0gMFxuICAgIC8vIGIgdW4gYSBkZWYgPSAwXG4gICAgaWYgKGluZGV4QSA9PT0gaW5kZXhCKSB7XG4gICAgICAgIHJldHVybiBhLml0ZW0uc3RhcnRUaW1lLmdldFRpbWUoKSAtIGIuaXRlbS5zdGFydFRpbWUuZ2V0VGltZSgpO1xuICAgIH1cbiAgICByZXR1cm4gaW5kZXhBIC0gaW5kZXhCO1xufTtcbmZ1bmN0aW9uIGluaXRUaW1lQ29sdW1ucyhzbG90S2V5cywgc2xvdEl0ZW1zKSB7XG4gICAgLy8gQnJlYWsgc2xvdHMgaW50byBncm91cHMgd2l0aCBvdmVybGFwcGluZyBldmVudHMuXG4gICAgbGV0IGNvbHVtbnMgPSAwO1xuICAgIGxldCBncm91cFNsb3RzID0gW107XG4gICAgc2xvdEtleXMuZm9yRWFjaChrZXkgPT4ge1xuICAgICAgICBjb25zdCB7IHNsb3QsIGV2ZW50cyB9ID0gc2xvdEl0ZW1zW2tleV07XG4gICAgICAgIGNvbnN0IGNvdW50ID0gZXZlbnRzLmxlbmd0aDtcbiAgICAgICAgbGV0IGdyb3VwRW5kID0gdHJ1ZTtcbiAgICAgICAgZXZlbnRzLnNvcnQoY29sdW1uSW5kZXhDb21wYXJlcik7XG4gICAgICAgIGNvbHVtbnMgPSBNYXRoLm1heChjb3VudCwgY29sdW1ucyk7XG4gICAgICAgIGdyb3VwU2xvdHMucHVzaChzbG90KTtcbiAgICAgICAgZm9yIChsZXQgZXZlbnRJZHggPSAwOyBldmVudElkeCA8IGNvdW50OyBldmVudElkeCsrKSB7XG4gICAgICAgICAgICBjb25zdCBldmVudCA9IGV2ZW50c1tldmVudElkeF07XG4gICAgICAgICAgICBncm91cEVuZCA9IGdyb3VwRW5kICYmIGV2ZW50Lml0ZW0uZW5kVGltZS5nZXRUaW1lKCkgPD0gc2xvdC5lbmQuZ2V0VGltZSgpO1xuICAgICAgICAgICAgaWYgKGlzTnVtYmVyKGV2ZW50LmNvbHVtbkluZGV4KSkge1xuICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZXZlbnQucmVjdCA9IHtcbiAgICAgICAgICAgICAgICB0b3A6IHNsb3QucmVjdC50b3AgKyB0aW1lT2Zmc2V0KHNsb3QsIGV2ZW50Lml0ZW0uc3RhcnRUaW1lKVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIGV2ZW50LmNvbHVtbkluZGV4ID0gZXZlbnRJZHg7XG4gICAgICAgICAgICBldmVudC5sYXN0Q29sdW1uID0gdHJ1ZTtcbiAgICAgICAgICAgIGZvciAobGV0IGlkeCA9IDAsIHByZXZpb3VzSWR4ID0gLTE7IGlkeCA8IGV2ZW50SWR4OyBpZHgrKykge1xuICAgICAgICAgICAgICAgIGNvbnN0IGN1cnJlbnQgPSBldmVudHNbaWR4XTtcbiAgICAgICAgICAgICAgICBpZiAoY3VycmVudC5jb2x1bW5JbmRleCA+IHByZXZpb3VzSWR4ICsgMSkge1xuICAgICAgICAgICAgICAgICAgICBldmVudC5jb2x1bW5JbmRleCA9IHByZXZpb3VzSWR4ICsgMTtcbiAgICAgICAgICAgICAgICAgICAgZXZlbnQubGFzdENvbHVtbiA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICBldmVudHMuc3BsaWNlKGV2ZW50SWR4LCAxKTtcbiAgICAgICAgICAgICAgICAgICAgZXZlbnRzLnNwbGljZShldmVudC5jb2x1bW5JbmRleCwgMCwgZXZlbnQpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKCFpbnRlcnNlY3RzKGV2ZW50Lml0ZW0uc3RhcnRUaW1lLCBldmVudC5pdGVtLmVuZFRpbWUsIGN1cnJlbnQuaXRlbS5zdGFydFRpbWUsIGN1cnJlbnQuaXRlbS5lbmRUaW1lKSAmJlxuICAgICAgICAgICAgICAgICAgICAhbWluSGVpZ2h0T3ZlcmxhcHMoY3VycmVudC5yZWN0LnRvcCwgZXZlbnQucmVjdC50b3ApKSB7XG4gICAgICAgICAgICAgICAgICAgIGV2ZW50LmNvbHVtbkluZGV4ID0gaWR4O1xuICAgICAgICAgICAgICAgICAgICBldmVudC5sYXN0Q29sdW1uID0gIWV2ZW50cy5zb21lKGUgPT4gZS5jb2x1bW5JbmRleCAmJiBpZHggPCBlLmNvbHVtbkluZGV4ICYmXG4gICAgICAgICAgICAgICAgICAgICAgICBpbnRlcnNlY3RzKGV2ZW50Lml0ZW0uc3RhcnRUaW1lLCBldmVudC5pdGVtLmVuZFRpbWUsIGUuaXRlbS5zdGFydFRpbWUsIGUuaXRlbS5lbmRUaW1lKSk7XG4gICAgICAgICAgICAgICAgICAgIGV2ZW50cy5zcGxpY2UoZXZlbnRJZHgsIDEpO1xuICAgICAgICAgICAgICAgICAgICBldmVudHMuc3BsaWNlKGlkeCwgMCwgZXZlbnQpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcHJldmlvdXNJZHggPSBjdXJyZW50LmNvbHVtbkluZGV4O1xuICAgICAgICAgICAgICAgIGN1cnJlbnQubGFzdENvbHVtbiA9IGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmIChncm91cEVuZCkge1xuICAgICAgICAgICAgZ3JvdXBTbG90cy5mb3JFYWNoKGl0ZW0gPT4gaXRlbS5jb2x1bW5zID0gY29sdW1ucyk7XG4gICAgICAgICAgICBncm91cFNsb3RzID0gW107XG4gICAgICAgICAgICBjb2x1bW5zID0gMDtcbiAgICAgICAgfVxuICAgIH0pO1xuICAgIC8vIFRoZSBtYXhpbXVtIG51bWJlciBvZiBvdmVybGFwcGluZyBldmVudHMgaW4gdGhlIGdyb3VwIGlzIHVzZWQgdG8gY3JlYXRlIHRoZSBzYW1lIG51bWJlciBvZiBjb2x1bW5zLlxuICAgIGdyb3VwU2xvdHMuZm9yRWFjaChzbG90ID0+IHNsb3QuY29sdW1ucyA9IGNvbHVtbnMpO1xufVxuZnVuY3Rpb24gZmluZFRpbWVSb3dJbmRleChldmVudHMsIGV2ZW50KSB7XG4gICAgaWYgKGV2ZW50LnJvd0luZGV4ICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgcmV0dXJuIGV2ZW50LnJvd0luZGV4O1xuICAgIH1cbiAgICBmb3IgKGxldCBpZHggPSAwOyBpZHggPCBldmVudHMubGVuZ3RoOyBpZHgrKykge1xuICAgICAgICBjb25zdCBjdXJyZW50ID0gZXZlbnRzW2lkeF07XG4gICAgICAgIGlmICghY3VycmVudCB8fCAhaW50ZXJzZWN0cyhldmVudC5pdGVtLnN0YXJ0VGltZSwgZXZlbnQuaXRlbS5lbmRUaW1lLCBjdXJyZW50Lml0ZW0uc3RhcnRUaW1lLCBjdXJyZW50Lml0ZW0uZW5kVGltZSkpIHtcbiAgICAgICAgICAgIHJldHVybiBpZHg7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGV2ZW50cy5sZW5ndGg7XG59XG5mdW5jdGlvbiBpbml0SG9yaXpvbnRhbFNsb3RzKHNsb3RzLCBpdGVtcywgcm93SGVpZ2h0LCBldmVudEhlaWdodCwgZ2V0Um93SW5kZXgpIHtcbiAgICBjb25zdCBwYWRkaW5nID0gc2xvdHNbMF0ucGFkZGluZztcbiAgICBpZiAoIWl0ZW1zLmxlbmd0aCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgaGVpZ2h0OiByb3dIZWlnaHQgLSBwYWRkaW5nXG4gICAgICAgIH07XG4gICAgfVxuICAgIGl0ZW1zLmZvckVhY2goaXRlbSA9PiB7XG4gICAgICAgIGl0ZW0ucm93SW5kZXggPSB1bmRlZmluZWQ7XG4gICAgICAgIGl0ZW0ucmVjdCA9IHtcbiAgICAgICAgICAgIGhlaWdodDogZXZlbnRIZWlnaHQsXG4gICAgICAgICAgICB3aWR0aDogMFxuICAgICAgICB9O1xuICAgIH0pO1xuICAgIGNvbnN0IHNvcnRlZCA9IG9yZGVyQnkoaXRlbXMsIFt7IGZpZWxkOiBcIml0ZW0uc3RhcnRUaW1lXCIsIGRpcjogXCJhc2NcIiB9LCB7IGZpZWxkOiBcIml0ZW0uZW5kVGltZVwiLCBkaXI6IFwiZGVzY1wiIH1dKTtcbiAgICBjb25zdCBzbG90SXRlbXMgPSB7fTtcbiAgICBzb3J0ZWQuZm9yRWFjaChldmVudCA9PiBzbG90c1xuICAgICAgICAuZmlsdGVyKHNsb3QgPT4gaW50ZXJzZWN0cyhldmVudC5pdGVtLnN0YXJ0VGltZSwgZXZlbnQuaXRlbS5lbmRUaW1lLCBzbG90LnN0YXJ0LCBzbG90LmVuZCkpXG4gICAgICAgIC5mb3JFYWNoKHNsb3QgPT4ge1xuICAgICAgICBjb25zdCB2YWx1ZSA9IHNsb3RJdGVtc1tzbG90LmtleV0gPSBzbG90SXRlbXNbc2xvdC5rZXldIHx8IHsgcm93czogW10sIHNsb3Q6IHNsb3QsIGV2ZW50czogW10gfTtcbiAgICAgICAgZXZlbnQucm93SW5kZXggPSBnZXRSb3dJbmRleCh2YWx1ZS5yb3dzLCBldmVudCk7XG4gICAgICAgIHZhbHVlLnJvd3NbZXZlbnQucm93SW5kZXhdID0gZXZlbnQ7XG4gICAgICAgIHZhbHVlLmV2ZW50cy5wdXNoKGV2ZW50KTtcbiAgICB9KSk7XG4gICAgY29uc3QgdG9wID0gc2xvdHNbMF0udG9wO1xuICAgIGxldCBtYXhPZmZzZXQgPSAwO1xuICAgIE9iamVjdC5rZXlzKHNsb3RJdGVtcykuZm9yRWFjaCgoa2V5KSA9PiB7XG4gICAgICAgIGNvbnN0IGV2ZW50cyA9IHNsb3RJdGVtc1trZXldLmV2ZW50cztcbiAgICAgICAgbGV0IHNsb3RPZmZzZXQgPSAwO1xuICAgICAgICBmb3IgKGxldCBpZHggPSAwOyBpZHggPCBldmVudHMubGVuZ3RoOyBpZHgrKykge1xuICAgICAgICAgICAgY29uc3QgZXZlbnQgPSBldmVudHNbaWR4XTtcbiAgICAgICAgICAgIGlmIChldmVudCkge1xuICAgICAgICAgICAgICAgIGV2ZW50LnJlY3QudG9wID0gdG9wICsgZXZlbnQucm93SW5kZXggKiAoRVZFTlRTX09GRlNFVCArIGV2ZW50LnJlY3QuaGVpZ2h0KTtcbiAgICAgICAgICAgICAgICBzbG90T2Zmc2V0ID0gTWF0aC5tYXgoc2xvdE9mZnNldCwgKGV2ZW50LnJlY3QudG9wIC0gdG9wKSArIGV2ZW50LnJlY3QuaGVpZ2h0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBtYXhPZmZzZXQgPSBNYXRoLm1heChzbG90T2Zmc2V0LCBtYXhPZmZzZXQpO1xuICAgIH0pO1xuICAgIG1heE9mZnNldCArPSByb3dIZWlnaHQgLSBwYWRkaW5nO1xuICAgIHJldHVybiB7XG4gICAgICAgIGhlaWdodDogbWF4T2Zmc2V0LFxuICAgICAgICBzbG90SXRlbXNcbiAgICB9O1xufVxuZnVuY3Rpb24gc2V0SG9yaXpvbnRhbE9mZnNldHMoc2xvdEl0ZW1zLCBpdGVtcywgbWVhc3VyZVRpbWUpIHtcbiAgICBPYmplY3Qua2V5cyhzbG90SXRlbXMpLmZvckVhY2goKGtleSkgPT4ge1xuICAgICAgICBjb25zdCB7IHNsb3QsIGV2ZW50cyB9ID0gc2xvdEl0ZW1zW2tleV07XG4gICAgICAgIGNvbnN0IHJlY3QgPSBzbG90LnJlY3Q7XG4gICAgICAgIGZvciAobGV0IGlkeCA9IDA7IGlkeCA8IGV2ZW50cy5sZW5ndGg7IGlkeCsrKSB7XG4gICAgICAgICAgICBjb25zdCBldmVudCA9IGV2ZW50c1tpZHhdO1xuICAgICAgICAgICAgaWYgKGV2ZW50KSB7XG4gICAgICAgICAgICAgICAgaWYgKCFpc051bWJlcihldmVudC5yZWN0LmxlZnQpKSB7XG4gICAgICAgICAgICAgICAgICAgIGV2ZW50LnJlY3QubGVmdCA9IHNsb3QucmVjdC5sZWZ0ICtcbiAgICAgICAgICAgICAgICAgICAgICAgIChtZWFzdXJlVGltZSA/IHRpbWVPZmZzZXQoc2xvdCwgZXZlbnQuaXRlbS5zdGFydFRpbWUsIGZhbHNlKSA6IDApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjb25zdCBzbG90T2Zmc2V0ID0gbWVhc3VyZVRpbWUgJiYgZXZlbnQuaXRlbS5lbmRUaW1lLmdldFRpbWUoKSA8IHNsb3QuZW5kLmdldFRpbWUoKSA/XG4gICAgICAgICAgICAgICAgICAgIHRpbWVPZmZzZXQoc2xvdCwgZXZlbnQuaXRlbS5lbmRUaW1lLCBmYWxzZSkgOiByZWN0LndpZHRoO1xuICAgICAgICAgICAgICAgIGV2ZW50LnJlY3Qud2lkdGggPSBzbG90LnJlY3QubGVmdCArIHNsb3RPZmZzZXQgLSBldmVudC5yZWN0LmxlZnQ7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9KTtcbiAgICBpdGVtcy5mb3JFYWNoKGl0ZW0gPT4ge1xuICAgICAgICBpdGVtLnJlZmxvdygpO1xuICAgIH0pO1xufVxuLyoqIEBoaWRkZW4gKi9cbmNsYXNzIFNsb3RSYW5nZSQxIHtcbiAgICBjb25zdHJ1Y3RvcihpbmRleCkge1xuICAgICAgICB0aGlzLmluZGV4ID0gaW5kZXg7XG4gICAgICAgIHRoaXMuc2xvdE1hcCA9IG5ldyBJdGVtTWFwKCk7XG4gICAgICAgIHRoaXMuaXRlbU1hcCA9IG5ldyBJdGVtTWFwKCk7XG4gICAgfVxuICAgIGdldCBzbG90cygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuc2xvdE1hcC50b0FycmF5KCk7XG4gICAgfVxuICAgIGdldCBmaXJzdFNsb3QoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnNsb3RNYXAuZmlyc3Q7XG4gICAgfVxuICAgIGdldCBsYXN0U2xvdCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuc2xvdE1hcC5sYXN0O1xuICAgIH1cbiAgICBnZXQgaXRlbXMoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLml0ZW1NYXAudG9BcnJheSgpO1xuICAgIH1cbiAgICBnZXQgcmVjdCgpIHtcbiAgICAgICAgY29uc3QgZmlyc3QgPSB0aGlzLmZpcnN0U2xvdC5yZWN0O1xuICAgICAgICBjb25zdCBsYXN0ID0gdGhpcy5sYXN0U2xvdC5yZWN0O1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgbGVmdDogZmlyc3QubGVmdCxcbiAgICAgICAgICAgIHRvcDogZmlyc3QudG9wLFxuICAgICAgICAgICAgd2lkdGg6IGxhc3QubGVmdCAtIGZpcnN0LmxlZnQgKyBsYXN0LndpZHRoLFxuICAgICAgICAgICAgaGVpZ2h0OiBsYXN0LnRvcCAtIGZpcnN0LnRvcCArIGxhc3QuaGVpZ2h0XG4gICAgICAgIH07XG4gICAgfVxuICAgIGdldCBzdGFydCgpIHtcbiAgICAgICAgY29uc3QgZmlyc3QgPSB0aGlzLnNsb3RNYXAuZmlyc3Q7XG4gICAgICAgIGlmICghZmlyc3QpIHtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmaXJzdC5zdGFydDtcbiAgICB9XG4gICAgZ2V0IGVuZCgpIHtcbiAgICAgICAgY29uc3QgbGFzdCA9IHRoaXMuc2xvdE1hcC5sYXN0O1xuICAgICAgICBpZiAoIWxhc3QpIHtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBsYXN0LmVuZDtcbiAgICB9XG4gICAgZ2V0IGhhc1Nsb3RzKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5zbG90TWFwLmNvdW50ID4gMDtcbiAgICB9XG4gICAgZ2V0IGhhc0l0ZW1zKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5pdGVtTWFwLmNvdW50ID4gMDtcbiAgICB9XG4gICAgcmVnaXN0ZXJJdGVtKGNvbXBvbmVudCkge1xuICAgICAgICB0aGlzLml0ZW1NYXAuYWRkSXRlbShjb21wb25lbnQuaXRlbS5pbmRleCwgY29tcG9uZW50KTtcbiAgICB9XG4gICAgdW5yZWdpc3Rlckl0ZW0oY29tcG9uZW50LCBpZCkge1xuICAgICAgICB0aGlzLml0ZW1NYXAucmVtb3ZlSXRlbShpZC5pbmRleCwgY29tcG9uZW50KTtcbiAgICB9XG4gICAgcmVnaXN0ZXJTbG90KHNsb3QpIHtcbiAgICAgICAgdGhpcy5zbG90TWFwLmFkZEl0ZW0oc2xvdC5pZC5pbmRleCwgc2xvdCk7XG4gICAgfVxuICAgIHVucmVnaXN0ZXJTbG90KHNsb3QpIHtcbiAgICAgICAgdGhpcy5zbG90TWFwLnJlbW92ZUl0ZW0oc2xvdC5pZC5pbmRleCwgc2xvdCk7XG4gICAgfVxuICAgIGxheW91dChvcHRpb25zKSB7XG4gICAgICAgIGNvbnN0IGl0ZW1zID0gdGhpcy5pdGVtcztcbiAgICAgICAgaWYgKCFpdGVtcy5sZW5ndGgpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBmaWxsID0gTWF0aC5tYXgoTWF0aC5taW4ob3B0aW9ucy5maWxsIHx8IDAuOSwgMSksIDAuMSk7XG4gICAgICAgIGNvbnN0IHNvcnRlZCA9IG9yZGVyQnkoaXRlbXMsIFt7IGZpZWxkOiBcIml0ZW0uc3RhcnRUaW1lXCIsIGRpcjogXCJhc2NcIiB9LCB7IGZpZWxkOiBcIml0ZW0uZW5kVGltZVwiLCBkaXI6IFwiZGVzY1wiIH1dKTtcbiAgICAgICAgaXRlbXMuZm9yRWFjaCgoaXRlbSwgaW5kZXgpID0+IHtcbiAgICAgICAgICAgIGl0ZW0ucmVjdCA9IG51bGw7XG4gICAgICAgICAgICBpdGVtLmNvbHVtbkluZGV4ID0gdW5kZWZpbmVkO1xuICAgICAgICB9KTtcbiAgICAgICAgY29uc3Qgc2xvdEl0ZW1zID0ge307XG4gICAgICAgIGNvbnN0IHNsb3RzID0gdGhpcy5zbG90cztcbiAgICAgICAgLy8gTWFwIGVhY2ggcG9wdWxhdGVkIHNsb3QgdG8gdGhlIGV2ZW50cyBpbiBpdFxuICAgICAgICBzb3J0ZWQuZm9yRWFjaChldmVudCA9PiBzbG90c1xuICAgICAgICAgICAgLmZpbHRlcihzbG90ID0+IGludGVyc2VjdHMoZXZlbnQuaXRlbS5zdGFydFRpbWUsIGV2ZW50Lml0ZW0uZW5kVGltZSwgc2xvdC5zdGFydCwgc2xvdC5lbmQpKVxuICAgICAgICAgICAgLmZvckVhY2goc2xvdCA9PiB7XG4gICAgICAgICAgICBjb25zdCB2YWx1ZSA9IHNsb3RJdGVtc1tzbG90LmtleV0gPSBzbG90SXRlbXNbc2xvdC5rZXldIHx8IHsgZXZlbnRzOiBbXSB9O1xuICAgICAgICAgICAgdmFsdWUuc2xvdCA9IHNsb3Q7XG4gICAgICAgICAgICB2YWx1ZS5ldmVudHMucHVzaChldmVudCk7XG4gICAgICAgIH0pKTtcbiAgICAgICAgY29uc3Qgc2xvdEtleXMgPSBPYmplY3Qua2V5cyhzbG90SXRlbXMpO1xuICAgICAgICBpbml0VGltZUNvbHVtbnMoc2xvdEtleXMsIHNsb3RJdGVtcyk7XG4gICAgICAgIHNsb3RLZXlzLmZvckVhY2goKGtleSkgPT4ge1xuICAgICAgICAgICAgY29uc3QgeyBzbG90LCBldmVudHMgfSA9IHNsb3RJdGVtc1trZXldO1xuICAgICAgICAgICAgY29uc3QgY291bnQgPSBldmVudHMubGVuZ3RoO1xuICAgICAgICAgICAgY29uc3Qgc3BhY2luZyA9IDI7XG4gICAgICAgICAgICBjb25zdCBzdGFydE9mZnNldCA9IDI7XG4gICAgICAgICAgICBjb25zdCBzbG90UmVjdCA9IHNsb3QucmVjdDtcbiAgICAgICAgICAgIGNvbnN0IHNsb3RMZWZ0ID0gc2xvdFJlY3QubGVmdDtcbiAgICAgICAgICAgIGNvbnN0IGNvbHVtbnMgPSBzbG90LmNvbHVtbnM7XG4gICAgICAgICAgICBjb25zdCBzbG90V2lkdGggPSBzbG90UmVjdC53aWR0aCAqIGZpbGwgLSAoY29sdW1ucyAtIDEpICogc3BhY2luZyAtIHN0YXJ0T2Zmc2V0O1xuICAgICAgICAgICAgY29uc3Qgb3JpZ2luID0gc2xvdExlZnQgKyBzdGFydE9mZnNldDtcbiAgICAgICAgICAgIGNvbnN0IGV2ZW50V2lkdGggPSBzbG90V2lkdGggLyBjb2x1bW5zO1xuICAgICAgICAgICAgY29uc3Qgc2xvdEVuZCA9IG9yaWdpbiArIHNsb3RXaWR0aCArIChjb2x1bW5zIC0gMSkgKiBzcGFjaW5nO1xuICAgICAgICAgICAgZXZlbnRzLmZvckVhY2goZXZlbnQgPT4ge1xuICAgICAgICAgICAgICAgIGlmICghaXNOdW1iZXIoZXZlbnQucmVjdC5sZWZ0KSkge1xuICAgICAgICAgICAgICAgICAgICBldmVudC5yZWN0LmxlZnQgPSBvcmlnaW4gKyBldmVudC5jb2x1bW5JbmRleCAqIChldmVudFdpZHRoICsgc3BhY2luZyk7XG4gICAgICAgICAgICAgICAgICAgIGV2ZW50LnJlY3Qud2lkdGggPSBldmVudC5sYXN0Q29sdW1uID8gc2xvdEVuZCAtIGV2ZW50LnJlY3QubGVmdCA6IGV2ZW50V2lkdGg7XG4gICAgICAgICAgICAgICAgICAgIGV2ZW50Lm9yaWdpbiA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxlZnQ6IHNsb3RMZWZ0LFxuICAgICAgICAgICAgICAgICAgICAgICAgcmlnaHQ6IHNsb3RMZWZ0ICsgc2xvdFJlY3Qud2lkdGhcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgLy8gRXhwYW5kIHRoZSBldmVudCB0byB0aGUgbGFzdCBncm91cCBzbG90XG4gICAgICAgICAgICAgICAgY29uc3Qgc2xvdE9mZnNldCA9IHNsb3QuZW5kLmdldFRpbWUoKSA8PSBldmVudC5pdGVtLmVuZFRpbWUuZ2V0VGltZSgpID8gc2xvdFJlY3QuaGVpZ2h0IDogdGltZU9mZnNldChzbG90LCBldmVudC5pdGVtLmVuZFRpbWUpO1xuICAgICAgICAgICAgICAgIGV2ZW50LnJlY3QuaGVpZ2h0ID0gc2xvdFJlY3QudG9wICsgc2xvdE9mZnNldCAtIGV2ZW50LnJlY3QudG9wO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgICAgICBzb3J0ZWQuZm9yRWFjaChldmVudCA9PiBldmVudC5yZWZsb3coKSk7XG4gICAgfVxuICAgIGluaXREYXlTbG90cyhyb3dIZWlnaHQsIGV2ZW50SGVpZ2h0KSB7XG4gICAgICAgIGNvbnN0IHNsb3RzID0gdGhpcy5zbG90cztcbiAgICAgICAgaWYgKCFzbG90cy5sZW5ndGgpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCB7IGhlaWdodCwgc2xvdEl0ZW1zIH0gPSBpbml0SG9yaXpvbnRhbFNsb3RzKHNsb3RzLCB0aGlzLml0ZW1zLCByb3dIZWlnaHQsIGV2ZW50SGVpZ2h0LCBmaW5kUm93SW5kZXgpO1xuICAgICAgICB0aGlzLnNldFNsb3RzSGVpZ2h0KGhlaWdodCk7XG4gICAgICAgIHRoaXMuc2xvdEl0ZW1zID0gc2xvdEl0ZW1zO1xuICAgIH1cbiAgICBzZXREYXlPZmZzZXRzKCkge1xuICAgICAgICBpZiAoIXRoaXMuaXRlbU1hcC5jb3VudCB8fCAhdGhpcy5zbG90SXRlbXMpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBzZXRIb3Jpem9udGFsT2Zmc2V0cyh0aGlzLnNsb3RJdGVtcywgdGhpcy5pdGVtcyk7XG4gICAgICAgIHRoaXMuc2xvdEl0ZW1zID0gbnVsbDtcbiAgICB9XG4gICAgc2V0U2xvdHNIZWlnaHQoaGVpZ2h0KSB7XG4gICAgICAgIHRoaXMuZmlyc3RTbG90LmhlaWdodCA9IGhlaWdodDtcbiAgICB9XG59XG4vKipcbiAqIEBoaWRkZW5cbiAqL1xuY2xhc3MgRGF5VGltZVJlc291cmNlR3JvdXAge1xuICAgIGNvbnN0cnVjdG9yKGluZGV4KSB7XG4gICAgICAgIHRoaXMuaW5kZXggPSBpbmRleDtcbiAgICAgICAgdGhpcy5kYXlSYW5nZXMgPSBbXTtcbiAgICAgICAgdGhpcy50aW1lUmFuZ2VzID0gW107XG4gICAgfVxuICAgIHJlZ2lzdGVyU2xvdChzbG90KSB7XG4gICAgICAgIGNvbnN0IHJhbmdlID0gdGhpcy5zbG90UmFuZ2Uoc2xvdCk7XG4gICAgICAgIHJhbmdlLnJlZ2lzdGVyU2xvdChzbG90KTtcbiAgICB9XG4gICAgdW5yZWdpc3RlclNsb3Qoc2xvdCkge1xuICAgICAgICBjb25zdCByYW5nZSA9IHRoaXMuc2xvdFJhbmdlKHNsb3QpO1xuICAgICAgICByYW5nZS51bnJlZ2lzdGVyU2xvdChzbG90KTtcbiAgICAgICAgaWYgKCFyYW5nZS5oYXNTbG90cykge1xuICAgICAgICAgICAgY29uc3QgcmFuZ2VzID0gdGhpcy5zbG90UmFuZ2VzKHNsb3QpO1xuICAgICAgICAgICAgZGVsZXRlIHJhbmdlc1tzbG90LmlkLnJhbmdlSW5kZXhdO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJlZ2lzdGVySXRlbShjb21wb25lbnQpIHtcbiAgICAgICAgY29uc3QgcmFuZ2UgPSB0aGlzLml0ZW1SYW5nZShjb21wb25lbnQpO1xuICAgICAgICBpZiAocmFuZ2UpIHtcbiAgICAgICAgICAgIHJhbmdlLnJlZ2lzdGVySXRlbShjb21wb25lbnQpO1xuICAgICAgICAgICAgY29tcG9uZW50LnJhbmdlSW5kZXggPSByYW5nZS5pbmRleDtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGNvbXBvbmVudC5yYW5nZUluZGV4ID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgY29tcG9uZW50LnRvZ2dsZShmYWxzZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgdW5yZWdpc3Rlckl0ZW0oY29tcG9uZW50LCBpZCkge1xuICAgICAgICBpZiAoY29tcG9uZW50LnJhbmdlSW5kZXggIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgY29uc3QgcmFuZ2VzID0gY29tcG9uZW50Lml0ZW0uaXNBbGxEYXkgPyB0aGlzLmRheVJhbmdlcyA6IHRoaXMudGltZVJhbmdlcztcbiAgICAgICAgICAgIGlmIChyYW5nZXNbaWQucmFuZ2VJbmRleF0pIHtcbiAgICAgICAgICAgICAgICByYW5nZXNbaWQucmFuZ2VJbmRleF0udW5yZWdpc3Rlckl0ZW0oY29tcG9uZW50LCBpZCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb21wb25lbnQucmFuZ2VJbmRleCA9IHVuZGVmaW5lZDtcbiAgICAgICAgfVxuICAgIH1cbiAgICBmb3JFYWNoRGF0ZVJhbmdlKGNhbGxiYWNrKSB7XG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5kYXlSYW5nZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGNhbGxiYWNrKHRoaXMuZGF5UmFuZ2VzW2ldKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBmb3JFYWNoVGltZVJhbmdlKGNhbGxiYWNrKSB7XG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy50aW1lUmFuZ2VzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBjYWxsYmFjayh0aGlzLnRpbWVSYW5nZXNbaV0pO1xuICAgICAgICB9XG4gICAgfVxuICAgIHNsb3RSYW5nZShzbG90KSB7XG4gICAgICAgIGNvbnN0IHJhbmdlcyA9IHRoaXMuc2xvdFJhbmdlcyhzbG90KTtcbiAgICAgICAgY29uc3QgcmFuZ2VJbmRleCA9IHNsb3QuaWQucmFuZ2VJbmRleDtcbiAgICAgICAgaWYgKCFyYW5nZXNbcmFuZ2VJbmRleF0pIHtcbiAgICAgICAgICAgIHJhbmdlc1tyYW5nZUluZGV4XSA9IG5ldyBTbG90UmFuZ2UkMShyYW5nZUluZGV4KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmFuZ2VzW3JhbmdlSW5kZXhdO1xuICAgIH1cbiAgICBzbG90UmFuZ2VzKHNsb3QpIHtcbiAgICAgICAgcmV0dXJuIHNsb3QuaXNEYXlTbG90ID8gdGhpcy5kYXlSYW5nZXMgOiB0aGlzLnRpbWVSYW5nZXM7XG4gICAgfVxuICAgIGluaXRUaW1lU2xvdHMocm93SGVpZ2h0LCBldmVudEhlaWdodCwgcmVzb3VyY2VSb3dIZWlnaHQpIHtcbiAgICAgICAgY29uc3Qgc2xvdHMgPSB0aGlzLnNsb3RzO1xuICAgICAgICBpZiAoIXNsb3RzLmxlbmd0aCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IHsgaGVpZ2h0LCBzbG90SXRlbXMgfSA9IGluaXRIb3Jpem9udGFsU2xvdHMoc2xvdHMsIHRoaXMuaXRlbXMsIHJvd0hlaWdodCwgZXZlbnRIZWlnaHQsIGZpbmRUaW1lUm93SW5kZXgpO1xuICAgICAgICB0aGlzLnNldFNsb3RzSGVpZ2h0KE1hdGgubWF4KGhlaWdodCwgcmVzb3VyY2VSb3dIZWlnaHQpKTtcbiAgICAgICAgdGhpcy5zbG90SXRlbXMgPSBzbG90SXRlbXM7XG4gICAgfVxuICAgIHNldFRpbWVsaW5lT2Zmc2V0cygpIHtcbiAgICAgICAgY29uc3QgaXRlbXMgPSB0aGlzLml0ZW1zO1xuICAgICAgICBpZiAoIXRoaXMuc2xvdEl0ZW1zIHx8ICFpdGVtcy5sZW5ndGgpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBzZXRIb3Jpem9udGFsT2Zmc2V0cyh0aGlzLnNsb3RJdGVtcywgaXRlbXMsIHRydWUpO1xuICAgICAgICB0aGlzLnNsb3RJdGVtcyA9IG51bGw7XG4gICAgfVxuICAgIHNldFNsb3RzSGVpZ2h0KGhlaWdodCkge1xuICAgICAgICAvL3NldHRpbmcgdGhlIGZpcnN0IHNsb3QgaGVpZ2h0IHNob3VsZCBiZSBzdWZmaWNpZW50XG4gICAgICAgIHRoaXMudGltZVJhbmdlc1swXS5zZXRTbG90c0hlaWdodChoZWlnaHQpO1xuICAgIH1cbiAgICBnZXQgaXRlbXMoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnRpbWVSYW5nZXMucmVkdWNlKChhY2MsIHJhbmdlKSA9PiBhY2MuY29uY2F0KHJhbmdlLml0ZW1zKSwgW10pO1xuICAgIH1cbiAgICBnZXQgc2xvdHMoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnRpbWVSYW5nZXMucmVkdWNlKChhY2MsIHJhbmdlKSA9PiBhY2MuY29uY2F0KHJhbmdlLnNsb3RzKSwgW10pO1xuICAgIH1cbiAgICBnZXQgaGFzU2xvdHMoKSB7XG4gICAgICAgIHJldHVybiBCb29sZWFuKHRoaXMuZGF5UmFuZ2VzLmZpbmQocmFuZ2UgPT4gcmFuZ2UgJiYgcmFuZ2UuaGFzU2xvdHMpIHx8IHRoaXMudGltZVJhbmdlcy5maW5kKHJhbmdlID0+IHJhbmdlICYmIHJhbmdlLmhhc1Nsb3RzKSk7XG4gICAgfVxuICAgIGNsZWFuUmFuZ2VzKCkge1xuICAgICAgICB0aGlzLmRheVJhbmdlcyA9IHRoaXMuZGF5UmFuZ2VzLmZpbHRlcihyID0+IEJvb2xlYW4ocikpO1xuICAgICAgICB0aGlzLnRpbWVSYW5nZXMgPSB0aGlzLnRpbWVSYW5nZXMuZmlsdGVyKHIgPT4gQm9vbGVhbihyKSk7XG4gICAgfVxuICAgIGl0ZW1SYW5nZShjb21wb25lbnQpIHtcbiAgICAgICAgY29uc3QgdGFzayA9IGNvbXBvbmVudC5pdGVtO1xuICAgICAgICBjb25zdCByYW5nZXMgPSB0YXNrLmlzQWxsRGF5ID8gdGhpcy5kYXlSYW5nZXMgOiB0aGlzLnRpbWVSYW5nZXM7XG4gICAgICAgIGlmIChpc051bWJlcih0YXNrLnJhbmdlSW5kZXgpKSB7XG4gICAgICAgICAgICByZXR1cm4gcmFuZ2VzW3Rhc2sucmFuZ2VJbmRleF07XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJhbmdlcy5maW5kKHIgPT4gaW50ZXJzZWN0cyh0YXNrLnN0YXJ0VGltZSwgdGFzay5lbmRUaW1lLCByLnN0YXJ0LCByLmVuZCkpO1xuICAgIH1cbn1cbi8qKlxuICogQGhpZGRlblxuICovXG5jbGFzcyBEYXlUaW1lU2xvdFNlcnZpY2UgZXh0ZW5kcyBCYXNlU2xvdFNlcnZpY2Uge1xuICAgIGxheW91dERheXMoZXZlbnRIZWlnaHQgPSAyNSkge1xuICAgICAgICB0aGlzLmdyb3Vwcy5mb3JFYWNoKChncm91cCkgPT4gZ3JvdXAuZm9yRWFjaERhdGVSYW5nZShyYW5nZSA9PiByYW5nZS5zbG90cy5mb3JFYWNoKHNsb3QgPT4ge1xuICAgICAgICAgICAgc2xvdC5lbGVtZW50Lm5hdGl2ZUVsZW1lbnQuc3R5bGUuaGVpZ2h0ID0gJyc7XG4gICAgICAgIH0pKSk7XG4gICAgICAgIGNvbnN0IHJvd0hlaWdodCA9IHRoaXMuZ3JvdXBzWzBdLmRheVJhbmdlc1swXS5zbG90c1swXS5oZWlnaHQ7XG4gICAgICAgIHRoaXMuZ3JvdXBzLmZvckVhY2goKGdyb3VwKSA9PiB7XG4gICAgICAgICAgICBncm91cC5mb3JFYWNoRGF0ZVJhbmdlKHJhbmdlID0+IHJhbmdlLmluaXREYXlTbG90cyhyb3dIZWlnaHQsIGV2ZW50SGVpZ2h0KSk7XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLmdyb3Vwcy5mb3JFYWNoKChncm91cCkgPT4ge1xuICAgICAgICAgICAgZ3JvdXAuZm9yRWFjaERhdGVSYW5nZShyYW5nZSA9PiByYW5nZS5zZXREYXlPZmZzZXRzKCkpO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgbGF5b3V0VGltZWxpbmUoZXZlbnRIZWlnaHQsIHJlc291cmNlUm93cykge1xuICAgICAgICB0aGlzLmdyb3Vwcy5mb3JFYWNoKChncm91cCkgPT4gZ3JvdXAuZm9yRWFjaFRpbWVSYW5nZShyYW5nZSA9PiByYW5nZS5zbG90cy5mb3JFYWNoKHNsb3QgPT4ge1xuICAgICAgICAgICAgc2xvdC5lbGVtZW50Lm5hdGl2ZUVsZW1lbnQuc3R5bGUuaGVpZ2h0ID0gJyc7XG4gICAgICAgIH0pKSk7XG4gICAgICAgIGNvbnN0IHJvd0hlaWdodCA9IHRoaXMuZ3JvdXBzWzBdLnRpbWVSYW5nZXNbMF0uc2xvdHNbMF0uaGVpZ2h0O1xuICAgICAgICB0aGlzLmdyb3Vwcy5mb3JFYWNoKChncm91cCwgaW5kZXgpID0+IHtcbiAgICAgICAgICAgIGdyb3VwLmluaXRUaW1lU2xvdHMocm93SGVpZ2h0LCBldmVudEhlaWdodCwgcmVzb3VyY2VSb3dzICYmIHJlc291cmNlUm93c1tpbmRleF0gPyByZXNvdXJjZVJvd3NbaW5kZXhdLm5hdGl2ZUVsZW1lbnQuY2hpbGRyZW5bMF0uY2hpbGRyZW5bMF0ub2Zmc2V0SGVpZ2h0IDogMCk7XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLmdyb3Vwcy5mb3JFYWNoKChncm91cCkgPT4gZ3JvdXAuc2V0VGltZWxpbmVPZmZzZXRzKCkpO1xuICAgIH1cbiAgICBsYXlvdXRUaW1lcyhvcHRpb25zKSB7XG4gICAgICAgIHRoaXMuZ3JvdXBzLmZvckVhY2goKGdyb3VwKSA9PiBncm91cC5mb3JFYWNoVGltZVJhbmdlKHJhbmdlID0+IHJhbmdlLmxheW91dChvcHRpb25zKSkpO1xuICAgIH1cbiAgICBmb3JFYWNoRGF0ZVJhbmdlKGNhbGxiYWNrKSB7XG4gICAgICAgIHRoaXMuZ3JvdXBzLmZvckVhY2goKGdyb3VwLCBpbmRleCkgPT4ge1xuICAgICAgICAgICAgY2FsbGJhY2soZ3JvdXAuZGF5UmFuZ2VzWzBdLCBpbmRleCk7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBzeW5jRGF0ZVJhbmdlcygpIHtcbiAgICAgICAgbGV0IG1heEhlaWdodCA9IDA7XG4gICAgICAgIHRoaXMuZ3JvdXBzLmZvckVhY2goKGdyb3VwKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBzbG90ID0gZ3JvdXAuZGF5UmFuZ2VzWzBdLmZpcnN0U2xvdDtcbiAgICAgICAgICAgIGlmIChzbG90KSB7XG4gICAgICAgICAgICAgICAgbWF4SGVpZ2h0ID0gTWF0aC5tYXgoc2xvdC5yZWN0LmhlaWdodCAtIHNsb3QucGFkZGluZywgbWF4SGVpZ2h0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuZ3JvdXBzLmZvckVhY2goKGdyb3VwKSA9PiB7XG4gICAgICAgICAgICBncm91cC5kYXlSYW5nZXNbMF0uc2V0U2xvdHNIZWlnaHQobWF4SGVpZ2h0KTtcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBtYXhIZWlnaHQ7XG4gICAgfVxuICAgIGZvckVhY2hHcm91cChjYWxsYmFjaykge1xuICAgICAgICB0aGlzLmdyb3Vwcy5mb3JFYWNoKGNhbGxiYWNrKTtcbiAgICB9XG4gICAgZm9yRWFjaFNsb3QoY2FsbGJhY2spIHtcbiAgICAgICAgdGhpcy5ncm91cHMuZm9yRWFjaCgoZ3JvdXApID0+IHtcbiAgICAgICAgICAgIGdyb3VwLmRheVJhbmdlcy5mb3JFYWNoKHJhbmdlID0+IHtcbiAgICAgICAgICAgICAgICByYW5nZS5zbG90cy5mb3JFYWNoKHNsb3QgPT4gY2FsbGJhY2soc2xvdCkpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBncm91cC50aW1lUmFuZ2VzLmZvckVhY2gocmFuZ2UgPT4ge1xuICAgICAgICAgICAgICAgIHJhbmdlLnNsb3RzLmZvckVhY2goc2xvdCA9PiBjYWxsYmFjayhzbG90KSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIGNyZWF0ZUdyb3VwKGluZGV4KSB7XG4gICAgICAgIHJldHVybiBuZXcgRGF5VGltZVJlc291cmNlR3JvdXAoaW5kZXgpO1xuICAgIH1cbiAgICBzbG90QnlJbmRleChzbG90SW5kZXgsIGFsbERheSA9IGZhbHNlKSB7XG4gICAgICAgIGNvbnN0IFtyZXNvdXJjZUluZGV4LCByYW5nZUluZGV4LCBpbmRleF0gPSBzbG90SW5kZXguc3BsaXQoJzonKS5tYXAocGFydCA9PiBwYXJzZUludChwYXJ0LCAxMCkpO1xuICAgICAgICByZXR1cm4gdGhpcy5ncm91cHNbcmVzb3VyY2VJbmRleF1bYWxsRGF5ID8gJ2RheVJhbmdlcycgOiAndGltZVJhbmdlcyddW3JhbmdlSW5kZXhdLnNsb3RzW2luZGV4XTtcbiAgICB9XG4gICAgc2xvdEJ5UG9zaXRpb24oeCwgeSwgaXNEYXlTbG90LCBpbmNsdWRlRGF5UmFuZ2VzKSB7XG4gICAgICAgIGxldCByYW5nZTtcbiAgICAgICAgaWYgKGlzRGF5U2xvdCkge1xuICAgICAgICAgICAgdGhpcy5ncm91cHMuZmluZCgoZ3JvdXApID0+IHtcbiAgICAgICAgICAgICAgICByYW5nZSA9IGdyb3VwLmRheVJhbmdlcy5maW5kKHIgPT4gcmVjdENvbnRhaW5zWChyLnJlY3QsIHgpKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gcmFuZ2U7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGlmIChyYW5nZSkge1xuICAgICAgICAgICAgICAgIHJldHVybiByYW5nZS5zbG90cy5maW5kKHNsb3QgPT4gcmVjdENvbnRhaW5zWChzbG90LnJlY3QsIHgpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuZ3JvdXBzLmZpbmQoKGdyb3VwKSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKGluY2x1ZGVEYXlSYW5nZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgcmFuZ2UgPSBncm91cC5kYXlSYW5nZXMuZmluZChyID0+IHJlY3RDb250YWlucyhyLnJlY3QsIHgsIHkpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKCFyYW5nZSkge1xuICAgICAgICAgICAgICAgICAgICByYW5nZSA9IGdyb3VwLnRpbWVSYW5nZXMuZmluZChyID0+IHJlY3RDb250YWlucyhyLnJlY3QsIHgsIHkpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIHJhbmdlO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBpZiAocmFuZ2UpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gcmFuZ2Uuc2xvdHMuZmluZChzbG90ID0+IHJlY3RDb250YWlucyhzbG90LnJlY3QsIHgsIHkpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICBncm91cFNsb3RCeVBvc2l0aW9uKGN1cnJlbnRTbG90LCB4LCB5KSB7XG4gICAgICAgIGNvbnN0IGdyb3VwID0gdGhpcy5ncm91cHNbY3VycmVudFNsb3QuaWQucmVzb3VyY2VJbmRleF07XG4gICAgICAgIGxldCByYW5nZTtcbiAgICAgICAgaWYgKGN1cnJlbnRTbG90LmlzRGF5U2xvdCkge1xuICAgICAgICAgICAgcmFuZ2UgPSBncm91cC5kYXlSYW5nZXMuZmluZChyID0+IHJlY3RDb250YWlucyhyLnJlY3QsIHgsIHkpKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJhbmdlID0gZ3JvdXAudGltZVJhbmdlcy5maW5kKHIgPT4gcmVjdENvbnRhaW5zKHIucmVjdCwgeCwgeSkpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChyYW5nZSkge1xuICAgICAgICAgICAgcmV0dXJuIHJhbmdlLnNsb3RzLmZpbmQoc2xvdCA9PiByZWN0Q29udGFpbnMoc2xvdC5yZWN0LCB4LCB5KSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZHJhZ1JhbmdlcyhjdXJyZW50U2xvdCwgb2Zmc2V0LCB0aW1lUmFuZ2VzKSB7XG4gICAgICAgIGNvbnN0IHN0YXJ0ID0gbmV3IERhdGUoY3VycmVudFNsb3Quc3RhcnQuZ2V0VGltZSgpIC0gb2Zmc2V0LnN0YXJ0KTtcbiAgICAgICAgY29uc3QgZW5kID0gbmV3IERhdGUoY3VycmVudFNsb3Quc3RhcnQuZ2V0VGltZSgpICsgb2Zmc2V0LmVuZCk7XG4gICAgICAgIGNvbnN0IGdyb3VwID0gdGhpcy5ncm91cHNbY3VycmVudFNsb3QuaWQucmVzb3VyY2VJbmRleF07XG4gICAgICAgIGxldCByZXN1bHQ7XG4gICAgICAgIGlmICh0aW1lUmFuZ2VzKSB7XG4gICAgICAgICAgICBjb25zdCBzbG90UmFuZ2VzID0gW107XG4gICAgICAgICAgICBncm91cC50aW1lUmFuZ2VzLmZvckVhY2gocmFuZ2UgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IHNsb3RzID0gcmFuZ2Uuc2xvdHMuZmlsdGVyKHMgPT4gaW50ZXJzZWN0cyhzdGFydCwgZW5kLCBzLnN0YXJ0LCBzLmVuZCkpO1xuICAgICAgICAgICAgICAgIGlmIChzbG90cy5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAgICAgc2xvdFJhbmdlcy5wdXNoKHNsb3RzKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGNvbnN0IGxhc3RSYW5nZSA9IHNsb3RSYW5nZXNbc2xvdFJhbmdlcy5sZW5ndGggLSAxXTtcbiAgICAgICAgICAgIHJlc3VsdCA9IFtzbG90UmFuZ2VzWzBdWzBdLCBsYXN0UmFuZ2VbbGFzdFJhbmdlLmxlbmd0aCAtIDFdXTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJlc3VsdCA9IGdyb3VwLnNsb3RSYW5nZShjdXJyZW50U2xvdCkuc2xvdHMuZmlsdGVyKHMgPT4gaW50ZXJzZWN0cyhzdGFydCwgZW5kLCBzLnN0YXJ0LCBzLmVuZCkpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBzdGFydCxcbiAgICAgICAgICAgIGVuZCxcbiAgICAgICAgICAgIHJhbmdlczogW3Jlc3VsdF1cbiAgICAgICAgfTtcbiAgICB9XG4gICAgcmVzaXplUmFuZ2VzKGN1cnJlbnRTbG90LCB0YXNrLCByZXNpemVTdGFydCwgb2Zmc2V0KSB7XG4gICAgICAgIGNvbnN0IGdyb3VwID0gdGhpcy5ncm91cHNbY3VycmVudFNsb3QuaWQucmVzb3VyY2VJbmRleF07XG4gICAgICAgIGNvbnN0IHJhbmdlcyA9IHRhc2suaXNBbGxEYXkgPyBncm91cC5kYXlSYW5nZXMgOiBncm91cC50aW1lUmFuZ2VzO1xuICAgICAgICBjb25zdCByZXN1bHQgPSBbXTtcbiAgICAgICAgY29uc3Qgc3RhcnREYXRlID0gdGFzay5zdGFydC50b1VUQ0RhdGUoKTtcbiAgICAgICAgY29uc3QgZW5kRGF0ZSA9IHRhc2suZW5kLnRvVVRDRGF0ZSgpO1xuICAgICAgICBsZXQgc3RhcnQsIGVuZDtcbiAgICAgICAgaWYgKHJlc2l6ZVN0YXJ0KSB7XG4gICAgICAgICAgICBjb25zdCBzdGFydFRpbWUgPSBjdXJyZW50U2xvdC5zdGFydC5nZXRUaW1lKCkgKyBvZmZzZXQuc3RhcnQ7XG4gICAgICAgICAgICBlbmQgPSBzdGFydERhdGUuZ2V0VGltZSgpID09PSBlbmREYXRlLmdldFRpbWUoKSA/IHRoaXMuZmluZERhdGVTbG90KGVuZERhdGUsIHJhbmdlcywgdHJ1ZSkuZW5kIDogZW5kRGF0ZTtcbiAgICAgICAgICAgIGlmIChzdGFydFRpbWUgPj0gZW5kRGF0ZS5nZXRUaW1lKCkpIHtcbiAgICAgICAgICAgICAgICBpZiAodGFzay5pc0FsbERheSkge1xuICAgICAgICAgICAgICAgICAgICBzdGFydCA9IG5ldyBEYXRlKE1hdGgubWluKGRhdGVXaXRoVGltZShlbmREYXRlLCBzdGFydERhdGUpLmdldFRpbWUoKSwgZW5kRGF0ZS5nZXRUaW1lKCkpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHN0YXJ0ID0gdGhpcy5maW5kRGF0ZVNsb3QoZW5kLCByYW5nZXMpLnN0YXJ0O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKG9mZnNldC5zdGFydCAmJiB0YXNrLmlzQWxsRGF5KSB7XG4gICAgICAgICAgICAgICAgc3RhcnQgPSBuZXcgRGF0ZShzdGFydFRpbWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgc3RhcnQgPSBuZXcgRGF0ZShjdXJyZW50U2xvdC5zdGFydC5nZXRUaW1lKCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgc3RhcnQgPSBzdGFydERhdGU7XG4gICAgICAgICAgICBpZiAoY3VycmVudFNsb3Quc3RhcnQuZ2V0VGltZSgpIDw9IHN0YXJ0LmdldFRpbWUoKSkge1xuICAgICAgICAgICAgICAgIGlmICh0YXNrLmlzQWxsRGF5KSB7XG4gICAgICAgICAgICAgICAgICAgIGVuZCA9IG5ldyBEYXRlKE1hdGgubWF4KGRhdGVXaXRoVGltZShzdGFydERhdGUsIGVuZERhdGUpLmdldFRpbWUoKSwgc3RhcnREYXRlLmdldFRpbWUoKSkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgZW5kID0gdGhpcy5maW5kRGF0ZVNsb3Qoc3RhcnQsIHJhbmdlcywgdHJ1ZSkuZW5kO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKG9mZnNldC5lbmQgJiYgdGFzay5pc0FsbERheSkge1xuICAgICAgICAgICAgICAgIGVuZCA9IG5ldyBEYXRlKGN1cnJlbnRTbG90LnN0YXJ0LmdldFRpbWUoKSArIG9mZnNldC5lbmQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgZW5kID0gY3VycmVudFNsb3QuZW5kO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJhbmdlcy5mb3JFYWNoKHJhbmdlID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHNsb3RzID0gcmFuZ2Uuc2xvdHMuZmlsdGVyKHMgPT4gaW50ZXJzZWN0cyhzdGFydCwgZW5kLCBzLnN0YXJ0LCBzLmVuZCkpO1xuICAgICAgICAgICAgaWYgKHNsb3RzLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgIHJlc3VsdC5wdXNoKHNsb3RzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBzdGFydCxcbiAgICAgICAgICAgIGVuZCxcbiAgICAgICAgICAgIHJhbmdlczogcmVzdWx0XG4gICAgICAgIH07XG4gICAgfVxuICAgIHRpbWVQb3NpdGlvbihkYXRlLCByZXNvdXJjZUluZGV4LCB2ZXJ0aWNhbCkge1xuICAgICAgICBjb25zdCBncm91cCA9IHRoaXMuZ3JvdXBzW3Jlc291cmNlSW5kZXhdO1xuICAgICAgICBjb25zdCByYW5nZSA9IGdyb3VwLnRpbWVSYW5nZXMuZmluZChyID0+IGRhdGVJblJhbmdlKGRhdGUsIHIuc3RhcnQsIHIuZW5kKSk7XG4gICAgICAgIGlmICghcmFuZ2UpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBzbG90ID0gcmFuZ2Uuc2xvdHMuZmluZChzID0+IGRhdGVJblJhbmdlKGRhdGUsIHMuc3RhcnQsIHMuZW5kKSk7XG4gICAgICAgIGlmIChzbG90KSB7XG4gICAgICAgICAgICBjb25zdCBwb3NpdGlvbiA9ICh2ZXJ0aWNhbCA/IHNsb3QuaGVpZ2h0IDogc2xvdC53aWR0aCkgKlxuICAgICAgICAgICAgICAgICgoZGF0ZS5nZXRUaW1lKCkgLSBzbG90LnN0YXJ0LmdldFRpbWUoKSkgLyAoc2xvdC5lbmQuZ2V0VGltZSgpIC0gc2xvdC5zdGFydC5nZXRUaW1lKCkpKTtcbiAgICAgICAgICAgIHJldHVybiB2ZXJ0aWNhbCA/IHNsb3QucmVjdC50b3AgKyBwb3NpdGlvbiA6IHNsb3QucmVjdC5sZWZ0ICsgcG9zaXRpb247XG4gICAgICAgIH1cbiAgICB9XG4gICAgZmluZERhdGVTbG90KGRhdGUsIHJhbmdlcywgZXhjbHVkZUVuZCkge1xuICAgICAgICBsZXQgcmVzdWx0O1xuICAgICAgICByYW5nZXMuZm9yRWFjaChyYW5nZSA9PiB7XG4gICAgICAgICAgICBjb25zdCBzbG90cyA9IGV4Y2x1ZGVFbmQgPyByYW5nZS5zbG90cy5maWx0ZXIocyA9PiBpbnRlcnNlY3RzKGRhdGUsIGRhdGUsIHMuc3RhcnQsIHMuZW5kKSkgOlxuICAgICAgICAgICAgICAgIHJhbmdlLnNsb3RzLmZpbHRlcihzID0+IGRhdGVJblJhbmdlKGRhdGUsIHMuc3RhcnQsIHMuZW5kKSk7XG4gICAgICAgICAgICBpZiAoc2xvdHMubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgcmVzdWx0ID0gc2xvdHNbMF07XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH1cbn1cblxuLyoqIEBoaWRkZW4gKi9cbmNvbnN0IGlzTXVsdGlEYXkgPSAoeyBzdGFydCwgZW5kIH0pID0+IHtcbiAgICBjb25zdCBzdGFydERhdGUgPSBzdGFydC5zdHJpcFRpbWUoKTtcbiAgICBjb25zdCBlbmREYXRlID0gZW5kLnN0cmlwVGltZSgpO1xuICAgIHJldHVybiBzdGFydERhdGUuZ2V0VGltZSgpICE9PSBlbmREYXRlLmdldFRpbWUoKSAmJlxuICAgICAgICAoZW5kRGF0ZS5nZXRUaW1lKCkgIT09IGVuZC5nZXRUaW1lKCkgfHwgc3RhcnREYXRlLmFkZERheXMoMSkuZ2V0VGltZSgpICE9PSBlbmREYXRlLmdldFRpbWUoKSk7XG59O1xuLy9jaGVjayBzdGFydCBhbmQgdGltZXMgb3IgdXBkYXRlIGRheSByYW5nZXMgdG8gaGF2ZSB0aGVtXG4vKiogQGhpZGRlbiAqL1xuY29uc3QgY3JlYXRlVGFza3MkMSA9IChwZXJpb2RTdGFydCwgcGVyaW9kRW5kLCBpdGVtcywgcmFuZ2VzKSA9PiB7XG4gICAgY29uc3QgdGFza3MgPSBbXTtcbiAgICBjb25zdCB1dGNTdGFydCA9IHRvVVRDRGF0ZShwZXJpb2RTdGFydCk7XG4gICAgY29uc3QgdXRjRW5kID0gdG9VVENEYXRlKHBlcmlvZEVuZCk7XG4gICAgZm9yIChsZXQgaW5kZXggPSAwOyBpbmRleCA8IGl0ZW1zLmxlbmd0aDsgaW5kZXgrKykge1xuICAgICAgICBjb25zdCBpdGVtID0gaXRlbXNbaW5kZXhdO1xuICAgICAgICBjb25zdCBtdWx0aURheSA9IGlzTXVsdGlEYXkoaXRlbSk7XG4gICAgICAgIGNvbnN0IG11bHRpcGxlUmFuZ2VzID0gbXVsdGlEYXkgJiYgIWl0ZW0uZXZlbnQuaXNBbGxEYXkgJiYgKGl0ZW0uZW5kLmdldFRpbWUoKSAtIGl0ZW0uc3RhcnQuZ2V0VGltZSgpKSA8IE1TX1BFUl9EQVk7XG4gICAgICAgIGNvbnN0IGlzQWxsRGF5ID0gaXRlbS5ldmVudC5pc0FsbERheSB8fCAobXVsdGlEYXkgJiYgIW11bHRpcGxlUmFuZ2VzKTtcbiAgICAgICAgY29uc3QgZW5kVGltZSA9IChpc0FsbERheSA/IHJvdW5kQWxsRGF5RW5kKGl0ZW0pIDogaXRlbS5lbmQpLnRvVVRDRGF0ZSgpO1xuICAgICAgICBjb25zdCBzdGFydFRpbWUgPSAoaXNBbGxEYXkgPyBpdGVtLnN0YXJ0LnN0cmlwVGltZSgpIDogaXRlbS5zdGFydCkudG9VVENEYXRlKCk7XG4gICAgICAgIGZvciAobGV0IHJhbmdlSW5kZXggPSAwOyByYW5nZUluZGV4IDwgcmFuZ2VzLmxlbmd0aDsgcmFuZ2VJbmRleCsrKSB7XG4gICAgICAgICAgICBjb25zdCByYW5nZVN0YXJ0ID0gcmFuZ2VzW3JhbmdlSW5kZXhdLnN0YXJ0O1xuICAgICAgICAgICAgY29uc3QgcmFuZ2VFbmQgPSByYW5nZXNbcmFuZ2VJbmRleF0uZW5kO1xuICAgICAgICAgICAgaWYgKGludGVyc2VjdHMoc3RhcnRUaW1lLCBlbmRUaW1lLCByYW5nZVN0YXJ0LCByYW5nZUVuZCkpIHtcbiAgICAgICAgICAgICAgICBjb25zdCB0YXNrID0ge1xuICAgICAgICAgICAgICAgICAgICBpbmRleCxcbiAgICAgICAgICAgICAgICAgICAgaXNBbGxEYXksXG4gICAgICAgICAgICAgICAgICAgIHN0YXJ0VGltZSxcbiAgICAgICAgICAgICAgICAgICAgZW5kVGltZSxcbiAgICAgICAgICAgICAgICAgICAgcmFuZ2VJbmRleDogaXNBbGxEYXkgPyAwIDogcmFuZ2VJbmRleCxcbiAgICAgICAgICAgICAgICAgICAgc3RhcnQ6IGl0ZW0uc3RhcnQsXG4gICAgICAgICAgICAgICAgICAgIGVuZDogaXRlbS5lbmQsXG4gICAgICAgICAgICAgICAgICAgIGV2ZW50OiBpdGVtLmV2ZW50XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB0YXNrcy5wdXNoKHRhc2spO1xuICAgICAgICAgICAgICAgIGlmICghbXVsdGlwbGVSYW5nZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgdGFzay5oZWFkID0gdXRjRW5kIDwgZW5kVGltZTtcbiAgICAgICAgICAgICAgICAgICAgdGFzay50YWlsID0gc3RhcnRUaW1lIDwgdXRjU3RhcnQ7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbmV4dFJhbmdlID0gcmFuZ2VzW3JhbmdlSW5kZXggKyAxXTtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgcHJldmlvdXNSYW5nZSA9IHJhbmdlc1tyYW5nZUluZGV4IC0gMV07XG4gICAgICAgICAgICAgICAgICAgIHRhc2suaGVhZCA9IChuZXh0UmFuZ2UgPyBuZXh0UmFuZ2Uuc3RhcnQgOiB1dGNFbmQpIDwgZW5kVGltZTtcbiAgICAgICAgICAgICAgICAgICAgdGFzay50YWlsID0gc3RhcnRUaW1lIDwgKHByZXZpb3VzUmFuZ2UgPyBwcmV2aW91c1JhbmdlLmVuZCA6IHV0Y1N0YXJ0KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHNvcnRUYXNrc0J5VGltZSh0YXNrcyk7XG59O1xuXG4vKipcbiAqIEBoaWRkZW5cbiAqL1xuZnVuY3Rpb24gY3JlYXRlVGltZVNsb3RzKGludGxTZXJ2aWNlLCB7IHNob3dXb3JrSG91cnMsIHN0YXJ0VGltZSwgZW5kVGltZSwgd29ya0RheVN0YXJ0LCB3b3JrRGF5RW5kLCBzbG90RGl2aXNpb25zLCBzbG90RHVyYXRpb24gfSkge1xuICAgIGNvbnN0IHN0YXJ0RGF0ZSA9IGludGxTZXJ2aWNlLnBhcnNlRGF0ZShzaG93V29ya0hvdXJzID8gd29ya0RheVN0YXJ0IDogc3RhcnRUaW1lKTtcbiAgICBjb25zdCBzdGFydCA9IHRvSW52YXJpYW50VGltZShzdGFydERhdGUpLmdldFRpbWUoKTtcbiAgICBjb25zdCBlbmREYXRlID0gaW50bFNlcnZpY2UucGFyc2VEYXRlKHNob3dXb3JrSG91cnMgPyB3b3JrRGF5RW5kIDogZW5kVGltZSk7XG4gICAgbGV0IGVuZCA9IHRvSW52YXJpYW50VGltZShlbmREYXRlKS5nZXRUaW1lKCk7XG4gICAgaWYgKGVuZCA8PSBzdGFydCkge1xuICAgICAgICBlbmQgPSB0b0ludmFyaWFudFRpbWUoTUlETklHSFRfSU5WQVJJQU5UKS5nZXRUaW1lKCkgKyBNU19QRVJfREFZO1xuICAgIH1cbiAgICBjb25zdCBzbG90cyA9IFtdO1xuICAgIGNvbnN0IGR1cmF0aW9uID0gTWF0aC5yb3VuZCgoc2xvdER1cmF0aW9uIC8gc2xvdERpdmlzaW9ucykgKiBNU19QRVJfTUlOVVRFKTtcbiAgICBsZXQgc2xvdFRpbWUgPSBzdGFydDtcbiAgICBsZXQgaW5kZXggPSAwO1xuICAgIHdoaWxlIChzbG90VGltZSA8IGVuZCkge1xuICAgICAgICBzbG90cy5wdXNoKHtcbiAgICAgICAgICAgIHN0YXJ0OiBuZXcgRGF0ZShzbG90VGltZSksXG4gICAgICAgICAgICBlbmQ6IG5ldyBEYXRlKHNsb3RUaW1lICsgZHVyYXRpb24pLFxuICAgICAgICAgICAgaXNNYWpvcjogaW5kZXggJSBzbG90RGl2aXNpb25zID09PSAwXG4gICAgICAgIH0pO1xuICAgICAgICBpbmRleCsrO1xuICAgICAgICBzbG90VGltZSArPSBkdXJhdGlvbjtcbiAgICB9XG4gICAgcmV0dXJuIHNsb3RzO1xufVxuXG5jb25zdCBnZXRTdGFydERhdGUgPSBkYXRlID0+IGdldERhdGUoZGF0ZSk7XG5jb25zdCBnZXRFbmREYXRlID0gKHN0YXJ0LCBudW1iZXJPZkRheXMpID0+IGdldERhdGUoYWRkRGF5cyhzdGFydCwgbnVtYmVyT2ZEYXlzIHx8IDEpKTtcbmNvbnN0IGdldE5leHREYXRlID0gKGRhdGUsIGNvdW50LCBudW1iZXJPZkRheXMpID0+IGdldERhdGUoYWRkRGF5cyhkYXRlLCBudW1iZXJPZkRheXMgKiBjb3VudCkpO1xuLyoqXG4gKiBAaGlkZGVuXG4gKi9cbmNsYXNzIERheVRpbWVWaWV3Q29tcG9uZW50IGV4dGVuZHMgQmFzZVZpZXcge1xuICAgIGNvbnN0cnVjdG9yKGNoYW5nZURldGVjdG9yLCB2aWV3Q29udGV4dCwgdmlld1N0YXRlLCBpbnRsLCBzbG90U2VydmljZSwgem9uZSwgcmVuZGVyZXIsIGVsZW1lbnQsIHBkZlNlcnZpY2UsIGxvY2FsaXphdGlvbikge1xuICAgICAgICBzdXBlcih2aWV3Q29udGV4dCwgdmlld1N0YXRlLCBpbnRsLCBzbG90U2VydmljZSwgem9uZSwgcmVuZGVyZXIsIGVsZW1lbnQsIHBkZlNlcnZpY2UsIGxvY2FsaXphdGlvbik7XG4gICAgICAgIHRoaXMuY2hhbmdlRGV0ZWN0b3IgPSBjaGFuZ2VEZXRlY3RvcjtcbiAgICAgICAgdGhpcy5udW1iZXJPZkRheXMgPSAxO1xuICAgICAgICB0aGlzLnN0YXJ0VGltZSA9ICcwMDowMCc7XG4gICAgICAgIHRoaXMuZW5kVGltZSA9ICcwMDowMCc7XG4gICAgICAgIHRoaXMud29ya0RheVN0YXJ0ID0gJzA4OjAwJztcbiAgICAgICAgdGhpcy53b3JrRGF5RW5kID0gJzE3OjAwJztcbiAgICAgICAgdGhpcy53b3JrV2Vla1N0YXJ0ID0gMTtcbiAgICAgICAgdGhpcy53b3JrV2Vla0VuZCA9IDU7XG4gICAgICAgIHRoaXMuc2xvdER1cmF0aW9uID0gNjA7XG4gICAgICAgIHRoaXMuc2xvdERpdmlzaW9ucyA9IDI7XG4gICAgICAgIHRoaXMuc2hvd1dvcmtIb3VycyA9IGZhbHNlO1xuICAgICAgICB0aGlzLmdldFN0YXJ0RGF0ZSA9IGdldFN0YXJ0RGF0ZTtcbiAgICAgICAgdGhpcy5nZXRFbmREYXRlID0gZ2V0RW5kRGF0ZTtcbiAgICAgICAgdGhpcy5nZXROZXh0RGF0ZSA9IGdldE5leHREYXRlO1xuICAgICAgICB0aGlzLmRheVNsb3RzID0gW107XG4gICAgICAgIHRoaXMudGltZVNsb3RzID0gW107XG4gICAgICAgIHRoaXMucmVzaXplSGludEZvcm1hdCA9ICd0JztcbiAgICAgICAgdGhpcy5zaG93Q3VycmVudFRpbWUgPSBmYWxzZTtcbiAgICAgICAgdGhpcy52ZXJ0aWNhbFRpbWUgPSB0cnVlO1xuICAgICAgICB0aGlzLmluaXRpYWxVcGRhdGUgPSB0cnVlO1xuICAgICAgICB0aGlzLnVwZGF0ZUN1cnJlbnRUaW1lID0gdGhpcy51cGRhdGVDdXJyZW50VGltZS5iaW5kKHRoaXMpO1xuICAgIH1cbiAgICBnZXQgY2xhc3NOYW1lcygpIHtcbiAgICAgICAgcmV0dXJuIGBrLXNjaGVkdWxlci0ke3RoaXMubmFtZX12aWV3YDtcbiAgICB9XG4gICAgZ2V0IHRpbWVTbG90VGVtcGxhdGVSZWYoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnRpbWVTbG90VGVtcGxhdGUgfHwgKHRoaXMuc2NoZWR1bGVyVGltZVNsb3RUZW1wbGF0ZSB8fCB7fSkudGVtcGxhdGVSZWY7XG4gICAgfVxuICAgIGdldCBkYXRlSGVhZGVyVGVtcGxhdGVSZWYoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmRhdGVIZWFkZXJUZW1wbGF0ZSB8fCAodGhpcy5zY2hlZHVsZXJEYXRlSGVhZGVyVGVtcGxhdGUgfHwge30pLnRlbXBsYXRlUmVmO1xuICAgIH1cbiAgICBuZ09uQ2hhbmdlcyhjaGFuZ2VzKSB7XG4gICAgICAgIGlmIChjaGFuZ2VzLnN0YXJ0VGltZSB8fCBjaGFuZ2VzLmVuZFRpbWUgfHwgY2hhbmdlcy5zaG93V29ya0hvdXJzIHx8IGNoYW5nZXMud29ya0RheVN0YXJ0IHx8IGNoYW5nZXMud29ya0RheUVuZCB8fFxuICAgICAgICAgICAgY2hhbmdlcy53b3JrV2Vla1N0YXJ0IHx8IGNoYW5nZXMud29ya1dlZWtFbmQgfHwgY2hhbmdlcy5zbG90RGl2aXNpb25zIHx8IGNoYW5nZXMuc2xvdER1cmF0aW9uKSB7XG4gICAgICAgICAgICB0aGlzLnRpbWVTbG90cyA9IHRoaXMuY3JlYXRlVGltZVNsb3RzKCk7XG4gICAgICAgICAgICB0aGlzLmluaXRXb3JrRGF5KCk7XG4gICAgICAgICAgICB0aGlzLmNoYW5nZXMubmV4dChudWxsKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoaXNDaGFuZ2VkKCdjdXJyZW50VGltZU1hcmtlcicsIGNoYW5nZXMpKSB7XG4gICAgICAgICAgICB0aGlzLnNob3dDdXJyZW50VGltZSA9IHRoaXMuZW5hYmxlQ3VycmVudFRpbWUoKTtcbiAgICAgICAgfVxuICAgICAgICBzdXBlci5uZ09uQ2hhbmdlcyhjaGFuZ2VzKTtcbiAgICB9XG4gICAgbmdPbkRlc3Ryb3koKSB7XG4gICAgICAgIHN1cGVyLm5nT25EZXN0cm95KCk7XG4gICAgICAgIGNsZWFyVGltZW91dCh0aGlzLmN1cnJlbnRUaW1lVGltZW91dCk7XG4gICAgfVxuICAgIHZlcnRpY2FsSXRlbShsZWFmSW5kZXgsIHJlc291cmNlSW5kZXgpIHtcbiAgICAgICAgY29uc3QgZGF0YSA9IHRoaXMudmVydGljYWxSZXNvdXJjZXNbcmVzb3VyY2VJbmRleF0uZGF0YSB8fCBbXTtcbiAgICAgICAgY29uc3QgcmVzb3VyY2VzID0gdGhpcy52ZXJ0aWNhbFJlc291cmNlcztcbiAgICAgICAgbGV0IHJlc3VsdCA9IDE7XG4gICAgICAgIGZvciAobGV0IGlkeCA9IHJlc291cmNlSW5kZXggKyAxOyBpZHggPCByZXNvdXJjZXMubGVuZ3RoOyBpZHgrKykge1xuICAgICAgICAgICAgcmVzdWx0ICo9ICgocmVzb3VyY2VzW2lkeF0uZGF0YSB8fCBbXSkubGVuZ3RoIHx8IDEpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBkYXRhWyhsZWFmSW5kZXggLyByZXN1bHQpICUgZGF0YS5sZW5ndGhdO1xuICAgIH1cbiAgICB0aW1lU2xvdENsYXNzKHNsb3QsIGRhdGUsIHJlc291cmNlSW5kZXgpIHtcbiAgICAgICAgaWYgKHRoaXMuc2xvdENsYXNzKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zbG90Q2xhc3Moe1xuICAgICAgICAgICAgICAgIHN0YXJ0OiBkYXRlV2l0aFRpbWUoZGF0ZSwgc2xvdC5zdGFydCksXG4gICAgICAgICAgICAgICAgZW5kOiBkYXRlV2l0aFRpbWUoZGF0ZSwgc2xvdC5lbmQpLFxuICAgICAgICAgICAgICAgIHJlc291cmNlczogdGhpcy5yZXNvdXJjZXNCeUluZGV4KHJlc291cmNlSW5kZXgpLFxuICAgICAgICAgICAgICAgIGlzQWxsRGF5OiBmYWxzZVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc2Nyb2xsVG9UaW1lKHRpbWUgPSB0aGlzLnNjcm9sbFRpbWUpIHtcbiAgICAgICAgbGV0IGRhdGU7XG4gICAgICAgIGlmICh0eXBlb2YgdGltZSA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgICAgIGNvbnN0IHNjcm9sbERhdGUgPSB0aGlzLmludGwucGFyc2VEYXRlKHRpbWUpO1xuICAgICAgICAgICAgaWYgKCFzY3JvbGxEYXRlKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZGF0ZSA9IHRvVVRDVGltZSh0aGlzLmRheVNsb3RzWzBdLnN0YXJ0LCBzY3JvbGxEYXRlKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGRhdGUgPSB0b1VUQ0RhdGVUaW1lKHRpbWUpO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IHBvc2l0aW9uID0gdGhpcy5zbG90U2VydmljZS50aW1lUG9zaXRpb24oZGF0ZSwgMCwgdGhpcy52ZXJ0aWNhbFRpbWUpO1xuICAgICAgICBpZiAoaXNOdW1iZXIocG9zaXRpb24pKSB7XG4gICAgICAgICAgICBjb25zdCBjb250ZW50RWxlbWVudCA9IHRoaXMuY29udGVudC5uYXRpdmVFbGVtZW50O1xuICAgICAgICAgICAgY29udGVudEVsZW1lbnRbdGhpcy52ZXJ0aWNhbFRpbWUgPyAnc2Nyb2xsVG9wJyA6ICdzY3JvbGxMZWZ0J10gPVxuICAgICAgICAgICAgICAgICh0aGlzLmxvY2FsaXphdGlvbi5ydGwgJiYgIXRoaXMudmVydGljYWxUaW1lKSA/IHJ0bFNjcm9sbFBvc2l0aW9uKGNvbnRlbnRFbGVtZW50LCBwb3NpdGlvbikgOiBwb3NpdGlvbjtcbiAgICAgICAgfVxuICAgIH1cbiAgICBvcHRpb25zQ2hhbmdlKG9wdGlvbnMpIHtcbiAgICAgICAgdGhpcy5zY2hlZHVsZXJUaW1lU2xvdFRlbXBsYXRlID0gb3B0aW9ucy50aW1lU2xvdFRlbXBsYXRlO1xuICAgICAgICB0aGlzLnNjaGVkdWxlckRhdGVIZWFkZXJUZW1wbGF0ZSA9IG9wdGlvbnMuZGF0ZUhlYWRlclRlbXBsYXRlO1xuICAgICAgICBzdXBlci5vcHRpb25zQ2hhbmdlKG9wdGlvbnMpO1xuICAgIH1cbiAgICB1cGRhdGVWaWV3KCkge1xuICAgICAgICBzdXBlci51cGRhdGVWaWV3KCk7XG4gICAgICAgIHRoaXMudXBkYXRlQ3VycmVudFRpbWUoKTtcbiAgICAgICAgaWYgKHRoaXMuaW5pdGlhbFVwZGF0ZSkge1xuICAgICAgICAgICAgdGhpcy5zY3JvbGxUb1RpbWUoKTtcbiAgICAgICAgICAgIHRoaXMuaW5pdGlhbFVwZGF0ZSA9IGZhbHNlO1xuICAgICAgICB9XG4gICAgfVxuICAgIGVuYWJsZUN1cnJlbnRUaW1lKCkge1xuICAgICAgICBpZiAoIXRoaXMuY3VycmVudFRpbWVNYXJrZXIgfHwgdGhpcy5jdXJyZW50VGltZU1hcmtlci5lbmFibGVkID09PSBmYWxzZSB8fCAhdGhpcy5zZWxlY3RlZERhdGUpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBkYXRlUmFuZ2UgPSB0aGlzLmRhdGVSYW5nZSgpO1xuICAgICAgICB0aGlzLmN1cnJlbnREYXRlID0gWm9uZWREYXRlLmZyb21Mb2NhbERhdGUodGhpcy5jdXJyZW50VGltZSgpLCB0aGlzLmN1cnJlbnRUaW1lTWFya2VyLmxvY2FsVGltZXpvbmUgIT09IGZhbHNlID8gJycgOiB0aGlzLnRpbWV6b25lKTtcbiAgICAgICAgY29uc3QgbG9jYWxUaW1lID0gdGhpcy5jdXJyZW50RGF0ZS50b0xvY2FsRGF0ZSgpO1xuICAgICAgICBjb25zdCBpbnZhcmlhbnRUaW1lID0gdG9JbnZhcmlhbnRUaW1lKGxvY2FsVGltZSk7XG4gICAgICAgIGNvbnN0IHRpbWVTbG90cyA9IHRoaXMudGltZVNsb3RzO1xuICAgICAgICBjb25zdCBpbkRhdGVSYW5nZSA9IGRhdGVJblJhbmdlKGxvY2FsVGltZSwgZGF0ZVJhbmdlLnN0YXJ0LCBkYXRlUmFuZ2UuZW5kKTtcbiAgICAgICAgY29uc3QgaW5UaW1lUmFuZ2UgPSB0aW1lU2xvdHMubGVuZ3RoICYmIGRhdGVJblJhbmdlKGludmFyaWFudFRpbWUsIHRpbWVTbG90c1swXS5zdGFydCwgdGltZVNsb3RzW3RpbWVTbG90cy5sZW5ndGggLSAxXS5lbmQpO1xuICAgICAgICByZXR1cm4gaW5EYXRlUmFuZ2UgJiYgaW5UaW1lUmFuZ2U7XG4gICAgfVxuICAgIGN1cnJlbnRUaW1lKCkge1xuICAgICAgICByZXR1cm4gbmV3IERhdGUoKTtcbiAgICB9XG4gICAgdXBkYXRlQ3VycmVudFRpbWUoKSB7XG4gICAgICAgIGlmICghaXNEb2N1bWVudEF2YWlsYWJsZSgpKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgZW5hYmxlID0gdGhpcy5lbmFibGVDdXJyZW50VGltZSgpO1xuICAgICAgICBpZiAoZW5hYmxlICE9PSB0aGlzLnNob3dDdXJyZW50VGltZSkge1xuICAgICAgICAgICAgdGhpcy5zaG93Q3VycmVudFRpbWUgPSBlbmFibGU7XG4gICAgICAgICAgICB0aGlzLmNoYW5nZURldGVjdG9yLmRldGVjdENoYW5nZXMoKTtcbiAgICAgICAgfVxuICAgICAgICBjbGVhclRpbWVvdXQodGhpcy5jdXJyZW50VGltZVRpbWVvdXQpO1xuICAgICAgICBpZiAoZW5hYmxlKSB7XG4gICAgICAgICAgICB0aGlzLnpvbmUucnVuT3V0c2lkZUFuZ3VsYXIoKCkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudFRpbWVUaW1lb3V0ID0gc2V0VGltZW91dCh0aGlzLnVwZGF0ZUN1cnJlbnRUaW1lLCB0aGlzLmN1cnJlbnRUaW1lTWFya2VyLnVwZGF0ZUludGVydmFsIHx8IE1TX1BFUl9NSU5VVEUpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB0aGlzLnBvc2l0aW9uQ3VycmVudFRpbWUoKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBwb3NpdGlvbkN1cnJlbnRUaW1lKCkge1xuICAgICAgICBpZiAodGhpcy5jdXJyZW50VGltZUVsZW1lbnRzICYmIHRoaXMuY3VycmVudFRpbWVFbGVtZW50cy5sZW5ndGgpIHtcbiAgICAgICAgICAgIGNvbnN0IGRhdGUgPSB0aGlzLmN1cnJlbnREYXRlLnRvVVRDRGF0ZSgpO1xuICAgICAgICAgICAgY29uc3QgY3VycmVudFRpbWVBcnJvd3MgPSB0aGlzLmN1cnJlbnRUaW1lQXJyb3dzID8gdGhpcy5jdXJyZW50VGltZUFycm93cy50b0FycmF5KCkgOiBbXTtcbiAgICAgICAgICAgIGNvbnN0IGFycm93T2Zmc2V0ID0gY3VycmVudFRpbWVBcnJvd3MubGVuZ3RoID8gdGhpcy5jdXJyZW50VGltZUFycm93T2Zmc2V0KCkgOiAwO1xuICAgICAgICAgICAgY29uc3QgYXJyb3dNaWQgPSBjdXJyZW50VGltZUFycm93cy5sZW5ndGggPyAoY3VycmVudFRpbWVBcnJvd3NbMF0ubmF0aXZlRWxlbWVudC5vZmZzZXRIZWlnaHQgLyAyKSA6IDQ7XG4gICAgICAgICAgICBjb25zdCB0YWJsZVdpZHRoID0gdGhpcy5jb250ZW50VGFibGUubmF0aXZlRWxlbWVudC5jbGllbnRXaWR0aDtcbiAgICAgICAgICAgIGNvbnN0IHRhYmxlSGVpZ2h0ID0gdGhpcy5jb250ZW50VGFibGUubmF0aXZlRWxlbWVudC5jbGllbnRIZWlnaHQ7XG4gICAgICAgICAgICBjb25zdCB2ZXJ0aWNhbCA9IHRoaXMudmVydGljYWxUaW1lO1xuICAgICAgICAgICAgdGhpcy5jdXJyZW50VGltZUVsZW1lbnRzLmZvckVhY2goKGVsZW1lbnQsIGluZGV4KSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgcG9zaXRpb24gPSB0aGlzLnNsb3RTZXJ2aWNlLnRpbWVQb3NpdGlvbihkYXRlLCBpbmRleCwgdmVydGljYWwpO1xuICAgICAgICAgICAgICAgIGlmIChwb3NpdGlvbiAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGxpbmUgPSBlbGVtZW50Lm5hdGl2ZUVsZW1lbnQ7XG4gICAgICAgICAgICAgICAgICAgIGlmIChjdXJyZW50VGltZUFycm93c1tpbmRleF0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGFycm93ID0gY3VycmVudFRpbWVBcnJvd3NbaW5kZXhdLm5hdGl2ZUVsZW1lbnQ7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBvcmlnaW4gPSB2ZXJ0aWNhbCA/IGFycm93T2Zmc2V0IDogcG9zaXRpb24gLSBhcnJvd01pZDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNldENvb3JkaW5hdGVzKGFycm93LCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdG9wOiB2ZXJ0aWNhbCA/IHBvc2l0aW9uIC0gYXJyb3dNaWQgOiBhcnJvd09mZnNldCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZWZ0OiBvcmlnaW4sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmlnaHQ6IG9yaWdpblxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgY29uc3Qgb3JpZ2luID0gdmVydGljYWwgPyAwIDogcG9zaXRpb247XG4gICAgICAgICAgICAgICAgICAgIHNldENvb3JkaW5hdGVzKGxpbmUsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRvcDogdmVydGljYWwgPyBwb3NpdGlvbiA6IDAsXG4gICAgICAgICAgICAgICAgICAgICAgICBsZWZ0OiBvcmlnaW4sXG4gICAgICAgICAgICAgICAgICAgICAgICByaWdodDogb3JpZ2luLFxuICAgICAgICAgICAgICAgICAgICAgICAgd2lkdGg6IHZlcnRpY2FsID8gdGFibGVXaWR0aCA6IDEsXG4gICAgICAgICAgICAgICAgICAgICAgICBoZWlnaHQ6IHZlcnRpY2FsID8gMSA6IHRhYmxlSGVpZ2h0XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfVxuICAgIGJpbmRFdmVudHMoKSB7XG4gICAgICAgIHN1cGVyLmJpbmRFdmVudHMoKTtcbiAgICAgICAgdGhpcy56b25lLnJ1bk91dHNpZGVBbmd1bGFyKCgpID0+IHtcbiAgICAgICAgICAgIHRoaXMuc3Vicy5hZGQoZnJvbUNsaWNrKHRoaXMuaGVhZGVyV3JhcC5uYXRpdmVFbGVtZW50KVxuICAgICAgICAgICAgICAgIC5zdWJzY3JpYmUoZSA9PiB0aGlzLm9uSGVhZGVyQ2xpY2soZSkpKTtcbiAgICAgICAgICAgIHRoaXMuc3Vicy5hZGQoZnJvbUV2ZW50KHRoaXMuaGVhZGVyV3JhcC5uYXRpdmVFbGVtZW50LCAnY29udGV4dG1lbnUnKVxuICAgICAgICAgICAgICAgIC5zdWJzY3JpYmUoZSA9PiB0aGlzLm9uQ2xpY2soZSkpKTtcbiAgICAgICAgICAgIHRoaXMuc3Vicy5hZGQoZnJvbURvdWJsZUNsaWNrKHRoaXMuaGVhZGVyV3JhcC5uYXRpdmVFbGVtZW50KVxuICAgICAgICAgICAgICAgIC5zdWJzY3JpYmUoZSA9PiB0aGlzLm9uQ2xpY2soZSwgJ2RibGNsaWNrJykpKTtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIG9uSGVhZGVyQ2xpY2soZSkge1xuICAgICAgICB0aGlzLm9uQ2xpY2soZSk7XG4gICAgICAgIGlmICh0aGlzLmRheVNsb3RzLmxlbmd0aCA8PSAxKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgZGF5U2xvdEluZGV4ID0gZS50YXJnZXQuZ2V0QXR0cmlidXRlKCdkYXRhLWRheXNsb3QtaW5kZXgnKTtcbiAgICAgICAgaWYgKGRheVNsb3RJbmRleCkge1xuICAgICAgICAgICAgY29uc3Qgc2xvdCA9IHRoaXMuZGF5U2xvdHNbcGFyc2VJbnQoZGF5U2xvdEluZGV4LCAxMCldO1xuICAgICAgICAgICAgdGhpcy56b25lLnJ1bigoKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy52aWV3U3RhdGUubmF2aWdhdGVUbyh7IHZpZXdOYW1lOiAnZGF5JywgZGF0ZTogc2xvdC5zdGFydCB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfVxuICAgIHNsb3RCeUluZGV4KHNsb3RJbmRleCwgYXJncykge1xuICAgICAgICByZXR1cm4gdGhpcy5zbG90U2VydmljZS5zbG90QnlJbmRleChzbG90SW5kZXgsIGFyZ3MudGFyZ2V0Lmhhc0F0dHJpYnV0ZSgnZGF0YS1kYXktc2xvdCcpKTtcbiAgICB9XG4gICAgb25TZWxlY3REYXRlKGRhdGUpIHtcbiAgICAgICAgdGhpcy5zZWxlY3RlZERhdGUgPSBkYXRlO1xuICAgICAgICB0aGlzLmRheVNsb3RzID0gdGhpcy5jcmVhdGVEYXlTbG90cygpO1xuICAgICAgICB0aGlzLnNob3dDdXJyZW50VGltZSA9IHRoaXMuZW5hYmxlQ3VycmVudFRpbWUoKTtcbiAgICAgICAgdGhpcy52aWV3U3RhdGUubm90aWZ5RGF0ZVJhbmdlKHRoaXMuZGF0ZVJhbmdlKCkpO1xuICAgIH1cbiAgICBvbkFjdGlvbihlKSB7XG4gICAgICAgIGNvbnN0IG5vdyA9IGdldERhdGUodGhpcy5zZWxlY3RlZERhdGUpO1xuICAgICAgICBpZiAoZS50eXBlID09PSAnbmV4dCcpIHtcbiAgICAgICAgICAgIGNvbnN0IG5leHQgPSB0aGlzLmdldE5leHREYXRlKG5vdywgMSwgdGhpcy5udW1iZXJPZkRheXMpO1xuICAgICAgICAgICAgaWYgKHRoaXMuaXNJblJhbmdlKG5leHQpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy52aWV3U3RhdGUubm90aWZ5TmV4dERhdGUobmV4dCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGUudHlwZSA9PT0gJ3ByZXYnKSB7XG4gICAgICAgICAgICBjb25zdCBuZXh0ID0gdGhpcy5nZXROZXh0RGF0ZShub3csIC0xLCB0aGlzLm51bWJlck9mRGF5cyk7XG4gICAgICAgICAgICBpZiAodGhpcy5pc0luUmFuZ2UobmV4dCkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnZpZXdTdGF0ZS5ub3RpZnlOZXh0RGF0ZShuZXh0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAoZS50eXBlID09PSAnc2Nyb2xsLXRpbWUnKSB7XG4gICAgICAgICAgICB0aGlzLnNjcm9sbFRvVGltZShlLnRpbWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGRhdGVSYW5nZShkYXRlID0gdGhpcy5zZWxlY3RlZERhdGUpIHtcbiAgICAgICAgY29uc3Qgc3RhcnQgPSB0aGlzLmdldFN0YXJ0RGF0ZShkYXRlKTtcbiAgICAgICAgY29uc3QgZW5kID0gdGhpcy5nZXRFbmREYXRlKHN0YXJ0LCB0aGlzLm51bWJlck9mRGF5cyk7XG4gICAgICAgIGNvbnN0IHJhbmdlRW5kID0gdGhpcy5nZXRFbmREYXRlKHN0YXJ0LCB0aGlzLm51bWJlck9mRGF5cyAtIDEpO1xuICAgICAgICBjb25zdCB0ZXh0ID0gdGhpcy5pbnRsLmZvcm1hdCh0aGlzLnNlbGVjdGVkRGF0ZUZvcm1hdCwgc3RhcnQsIHJhbmdlRW5kKTtcbiAgICAgICAgY29uc3Qgc2hvcnRUZXh0ID0gdGhpcy5pbnRsLmZvcm1hdCh0aGlzLnNlbGVjdGVkU2hvcnREYXRlRm9ybWF0LCBzdGFydCwgcmFuZ2VFbmQpO1xuICAgICAgICByZXR1cm4geyBzdGFydCwgZW5kLCB0ZXh0LCBzaG9ydFRleHQgfTtcbiAgICB9XG4gICAgY3JlYXRlRGF5U2xvdHMoKSB7XG4gICAgICAgIGxldCBjdXJyZW50ID0gdGhpcy5nZXRTdGFydERhdGUodGhpcy5zZWxlY3RlZERhdGUpO1xuICAgICAgICBjb25zdCBlbmQgPSB0aGlzLmdldEVuZERhdGUoY3VycmVudCwgdGhpcy5udW1iZXJPZkRheXMpO1xuICAgICAgICBjb25zdCBkYXRlcyA9IFtdO1xuICAgICAgICB3aGlsZSAoY3VycmVudCA8IGVuZCkge1xuICAgICAgICAgICAgY29uc3QgbmV4dCA9IGFkZERheXMoY3VycmVudCwgMSk7XG4gICAgICAgICAgICBkYXRlcy5wdXNoKHtcbiAgICAgICAgICAgICAgICBzdGFydDogY3VycmVudCxcbiAgICAgICAgICAgICAgICBlbmQ6IG5leHRcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgY3VycmVudCA9IG5leHQ7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGRhdGVzO1xuICAgIH1cbiAgICBjcmVhdGVUaW1lU2xvdHMoKSB7XG4gICAgICAgIHJldHVybiBjcmVhdGVUaW1lU2xvdHModGhpcy5pbnRsLCB7XG4gICAgICAgICAgICBzaG93V29ya0hvdXJzOiB0aGlzLnNob3dXb3JrSG91cnMsXG4gICAgICAgICAgICBzdGFydFRpbWU6IHRoaXMuc3RhcnRUaW1lLFxuICAgICAgICAgICAgZW5kVGltZTogdGhpcy5lbmRUaW1lLFxuICAgICAgICAgICAgd29ya0RheVN0YXJ0OiB0aGlzLndvcmtEYXlTdGFydCxcbiAgICAgICAgICAgIHdvcmtEYXlFbmQ6IHRoaXMud29ya0RheUVuZCxcbiAgICAgICAgICAgIHNsb3REaXZpc2lvbnM6IHRoaXMuc2xvdERpdmlzaW9ucyxcbiAgICAgICAgICAgIHNsb3REdXJhdGlvbjogdGhpcy5zbG90RHVyYXRpb25cbiAgICAgICAgfSk7XG4gICAgfVxuICAgIGluaXRXb3JrRGF5KCkge1xuICAgICAgICBjb25zdCBzdGFydERhdGUgPSB0aGlzLmludGwucGFyc2VEYXRlKHRoaXMud29ya0RheVN0YXJ0KTtcbiAgICAgICAgdGhpcy53b3JrRGF5U3RhcnRUaW1lID0gdG9JbnZhcmlhbnRUaW1lKHN0YXJ0RGF0ZSk7XG4gICAgICAgIGNvbnN0IGVuZERhdGUgPSB0aGlzLmludGwucGFyc2VEYXRlKHRoaXMud29ya0RheUVuZCk7XG4gICAgICAgIGlmIChlbmREYXRlIDw9IHN0YXJ0RGF0ZSkge1xuICAgICAgICAgICAgdGhpcy53b3JrRGF5RW5kVGltZSA9IGFkZERheXMoTUlETklHSFRfSU5WQVJJQU5ULCAxKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMud29ya0RheUVuZFRpbWUgPSB0b0ludmFyaWFudFRpbWUoZW5kRGF0ZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc2xvdEJ5UG9zaXRpb24oeCwgeSwgY29udGFpbmVyKSB7XG4gICAgICAgIGNvbnN0IGlzRGF5U2xvdCA9IGNvbnRhaW5lciA/IGhhc0NsYXNzZXMoY29udGFpbmVyLnBhcmVudE5vZGUsICdrLXNjaGVkdWxlci1oZWFkZXItd3JhcCcpIDogeSA8IDA7XG4gICAgICAgIHJldHVybiB0aGlzLnNsb3RTZXJ2aWNlLnNsb3RCeVBvc2l0aW9uKHgsIHksIGlzRGF5U2xvdCwgQm9vbGVhbih0aGlzLnZlcnRpY2FsUmVzb3VyY2VzLmxlbmd0aCkpO1xuICAgIH1cbiAgICBzbG90RmllbGRzKHNsb3QpIHtcbiAgICAgICAgY29uc3QgZmllbGRzID0gc3VwZXIuc2xvdEZpZWxkcyhzbG90KTtcbiAgICAgICAgaWYgKHNsb3QuaXNEYXlTbG90KSB7XG4gICAgICAgICAgICBmaWVsZHMuaXNBbGxEYXkgPSB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgZmllbGRzLnN0YXJ0ID0gdGhpcy5jb252ZXJ0RGF0ZShzbG90LnN0YXJ0KTtcbiAgICAgICAgICAgIGZpZWxkcy5lbmQgPSB0aGlzLmNvbnZlcnREYXRlKHNsb3QuZW5kKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZmllbGRzO1xuICAgIH1cbn1cbkRheVRpbWVWaWV3Q29tcG9uZW50LnByb3BEZWNvcmF0b3JzID0ge1xuICAgIHRpbWVTbG90VGVtcGxhdGU6IFt7IHR5cGU6IElucHV0IH1dLFxuICAgIGRhdGVIZWFkZXJUZW1wbGF0ZTogW3sgdHlwZTogSW5wdXQgfV0sXG4gICAgbnVtYmVyT2ZEYXlzOiBbeyB0eXBlOiBJbnB1dCB9XSxcbiAgICBzY3JvbGxUaW1lOiBbeyB0eXBlOiBJbnB1dCB9XSxcbiAgICBzdGFydFRpbWU6IFt7IHR5cGU6IElucHV0IH1dLFxuICAgIGVuZFRpbWU6IFt7IHR5cGU6IElucHV0IH1dLFxuICAgIHdvcmtEYXlTdGFydDogW3sgdHlwZTogSW5wdXQgfV0sXG4gICAgd29ya0RheUVuZDogW3sgdHlwZTogSW5wdXQgfV0sXG4gICAgd29ya1dlZWtTdGFydDogW3sgdHlwZTogSW5wdXQgfV0sXG4gICAgd29ya1dlZWtFbmQ6IFt7IHR5cGU6IElucHV0IH1dLFxuICAgIHNsb3REdXJhdGlvbjogW3sgdHlwZTogSW5wdXQgfV0sXG4gICAgc2xvdERpdmlzaW9uczogW3sgdHlwZTogSW5wdXQgfV0sXG4gICAgc2hvd1dvcmtIb3VyczogW3sgdHlwZTogSW5wdXQgfV0sXG4gICAgZ2V0U3RhcnREYXRlOiBbeyB0eXBlOiBJbnB1dCB9XSxcbiAgICBnZXRFbmREYXRlOiBbeyB0eXBlOiBJbnB1dCB9XSxcbiAgICBnZXROZXh0RGF0ZTogW3sgdHlwZTogSW5wdXQgfV0sXG4gICAgY3VycmVudFRpbWVNYXJrZXI6IFt7IHR5cGU6IElucHV0IH1dLFxuICAgIGN1cnJlbnRUaW1lRWxlbWVudHM6IFt7IHR5cGU6IFZpZXdDaGlsZHJlbiwgYXJnczogWydjdXJyZW50VGltZU1hcmtlcicsXSB9XSxcbiAgICBjdXJyZW50VGltZUFycm93czogW3sgdHlwZTogVmlld0NoaWxkcmVuLCBhcmdzOiBbJ2N1cnJlbnRUaW1lQXJyb3cnLF0gfV1cbn07XG5cbi8qKlxuICogQGhpZGRlblxuICovXG5jbGFzcyBNdWx0aURheVZpZXdSZW5kZXJlckNvbXBvbmVudCBleHRlbmRzIERheVRpbWVWaWV3Q29tcG9uZW50IHtcbiAgICBjb25zdHJ1Y3Rvcihsb2NhbGl6YXRpb24sIHZpZXdDb250ZXh0LCB2aWV3U3RhdGUsIGludGwsIHNsb3RTZXJ2aWNlLCB6b25lLCByZW5kZXJlciwgZWxlbWVudCwgY2hhbmdlRGV0ZWN0b3IsIHBkZlNlcnZpY2UpIHtcbiAgICAgICAgc3VwZXIoY2hhbmdlRGV0ZWN0b3IsIHZpZXdDb250ZXh0LCB2aWV3U3RhdGUsIGludGwsIHNsb3RTZXJ2aWNlLCB6b25lLCByZW5kZXJlciwgZWxlbWVudCwgcGRmU2VydmljZSwgbG9jYWxpemF0aW9uKTtcbiAgICAgICAgdGhpcy5uYW1lID0gJ2RheSc7XG4gICAgICAgIHRoaXMuZGF0ZUZvcm1hdCA9IHsgc2tlbGV0b246ICdNRWQnIH07XG4gICAgICAgIHRoaXMuYWxsRGF5UmVzaXplSGludEZvcm1hdCA9IHsgc2tlbGV0b246ICdNZCcgfTtcbiAgICAgICAgdGhpcy5hbGxEYXlJdGVtcyA9IG5ldyBCZWhhdmlvclN1YmplY3QobnVsbCk7XG4gICAgfVxuICAgIGdldCBhbGxEYXlTbG90VGVtcGxhdGVSZWYoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmFsbERheVNsb3RUZW1wbGF0ZSB8fCAodGhpcy5zY2hlZHVsZXJBbGxEYXlTbG90VGVtcGxhdGUgfHwge30pLnRlbXBsYXRlUmVmO1xuICAgIH1cbiAgICBnZXQgYWxsRGF5RXZlbnRUZW1wbGF0ZVJlZigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuYWxsRGF5RXZlbnRUZW1wbGF0ZSB8fCAodGhpcy5zY2hlZHVsZXJBbGxEYXlFdmVudFRlbXBsYXRlIHx8IHt9KS50ZW1wbGF0ZVJlZjtcbiAgICB9XG4gICAgZ2V0IG1pbm9yVGltZUhlYWRlclRlbXBsYXRlUmVmKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5taW5vclRpbWVIZWFkZXJUZW1wbGF0ZSB8fCAodGhpcy5zY2hlZHVsZXJNaW5vclRpbWVIZWFkZXJUZW1wbGF0ZSB8fCB7fSkudGVtcGxhdGVSZWY7XG4gICAgfVxuICAgIGdldCBtYWpvclRpbWVIZWFkZXJUZW1wbGF0ZVJlZigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubWFqb3JUaW1lSGVhZGVyVGVtcGxhdGUgfHwgKHRoaXMuc2NoZWR1bGVyTWFqb3JUaW1lSGVhZGVyVGVtcGxhdGUgfHwge30pLnRlbXBsYXRlUmVmO1xuICAgIH1cbiAgICBnZXQgYWxsRGF5TWVzc2FnZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubG9jYWxpemF0aW9uLmdldCgnYWxsRGF5Jyk7XG4gICAgfVxuICAgIGdldCBhbGxEYXlSZXNpemVIaW50KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5yZXNpemluZyAmJiB0aGlzLnJlc2l6aW5nLnRhc2suaXNBbGxEYXk7XG4gICAgfVxuICAgIGdldCBhbGxEYXlEcmFnSGludCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZHJhZ2dpbmcgJiYgdGhpcy5kcmFnZ2luZy5zbG90LmlzRGF5U2xvdDtcbiAgICB9XG4gICAgb3B0aW9uc0NoYW5nZShjaGFuZ2VzKSB7XG4gICAgICAgIHRoaXMuc2NoZWR1bGVyQWxsRGF5U2xvdFRlbXBsYXRlID0gY2hhbmdlcy5hbGxEYXlTbG90VGVtcGxhdGU7XG4gICAgICAgIHRoaXMuc2NoZWR1bGVyQWxsRGF5RXZlbnRUZW1wbGF0ZSA9IGNoYW5nZXMuYWxsRGF5RXZlbnRUZW1wbGF0ZTtcbiAgICAgICAgdGhpcy5zY2hlZHVsZXJNaW5vclRpbWVIZWFkZXJUZW1wbGF0ZSA9IGNoYW5nZXMubWlub3JUaW1lSGVhZGVyVGVtcGxhdGU7XG4gICAgICAgIHRoaXMuc2NoZWR1bGVyTWFqb3JUaW1lSGVhZGVyVGVtcGxhdGUgPSBjaGFuZ2VzLm1ham9yVGltZUhlYWRlclRlbXBsYXRlO1xuICAgICAgICBzdXBlci5vcHRpb25zQ2hhbmdlKGNoYW5nZXMpO1xuICAgIH1cbiAgICBuZ09uQ2hhbmdlcyhjaGFuZ2VzKSB7XG4gICAgICAgIHN1cGVyLm5nT25DaGFuZ2VzKGNoYW5nZXMpO1xuICAgICAgICBpZiAoY2hhbmdlcy5zbG90RmlsbCkge1xuICAgICAgICAgICAgdGhpcy5jaGFuZ2VzLm5leHQobnVsbCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGNoYW5nZXMuc3RhcnRUaW1lIHx8IGNoYW5nZXMuZW5kVGltZSB8fCBjaGFuZ2VzLnNob3dXb3JrSG91cnMgfHwgY2hhbmdlcy53b3JrRGF5U3RhcnQgfHwgY2hhbmdlcy53b3JrRGF5RW5kIHx8XG4gICAgICAgICAgICBjaGFuZ2VzLndvcmtXZWVrU3RhcnQgfHwgY2hhbmdlcy53b3JrV2Vla0VuZCkge1xuICAgICAgICAgICAgdGhpcy52aWV3UmFuZ2VDaGFuZ2UubmV4dChudWxsKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoY2hhbmdlcy5udW1iZXJPZkRheXMgJiYgIWNoYW5nZXMubnVtYmVyT2ZEYXlzLmZpcnN0Q2hhbmdlKSB7XG4gICAgICAgICAgICB0aGlzLmRheVNsb3RzID0gdGhpcy5jcmVhdGVEYXlTbG90cygpO1xuICAgICAgICAgICAgdGhpcy52aWV3U3RhdGUubm90aWZ5RGF0ZVJhbmdlKHRoaXMuZGF0ZVJhbmdlKCkpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGhvcml6b250YWxDb2xzcGFuKHJlc291cmNlSW5kZXgpIHtcbiAgICAgICAgY29uc3QgcmVzb3VyY2VzID0gdGhpcy5ob3Jpem9udGFsUmVzb3VyY2VzO1xuICAgICAgICBsZXQgcmVzdWx0ID0gdGhpcy5kYXlTbG90cy5sZW5ndGg7XG4gICAgICAgIGZvciAobGV0IGlkeCA9IHJlc291cmNlSW5kZXggKyAxOyBpZHggPCByZXNvdXJjZXMubGVuZ3RoOyBpZHgrKykge1xuICAgICAgICAgICAgcmVzdWx0ICo9IChyZXNvdXJjZXNbaWR4XS5kYXRhIHx8IFtdKS5sZW5ndGggfHwgMTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH1cbiAgICB2ZXJ0aWNhbFJvd3NwYW4ocmVzb3VyY2VJbmRleCkge1xuICAgICAgICBjb25zdCByZXNvdXJjZXMgPSB0aGlzLnZlcnRpY2FsUmVzb3VyY2VzO1xuICAgICAgICBsZXQgcmVzdWx0ID0gdGhpcy50aW1lU2xvdHMubGVuZ3RoICsgMTtcbiAgICAgICAgZm9yIChsZXQgaWR4ID0gcmVzb3VyY2VJbmRleCArIDE7IGlkeCA8IHJlc291cmNlcy5sZW5ndGg7IGlkeCsrKSB7XG4gICAgICAgICAgICByZXN1bHQgKj0gKHJlc291cmNlc1tpZHhdLmRhdGEgfHwgW10pLmxlbmd0aCB8fCAxO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfVxuICAgIGFsbERheVNsb3RDbGFzcyhzbG90LCByZXNvdXJjZUluZGV4KSB7XG4gICAgICAgIGlmICh0aGlzLnNsb3RDbGFzcykge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc2xvdENsYXNzKHtcbiAgICAgICAgICAgICAgICBzdGFydDogc2xvdC5zdGFydCxcbiAgICAgICAgICAgICAgICBlbmQ6IHNsb3QuZW5kLFxuICAgICAgICAgICAgICAgIHJlc291cmNlczogdGhpcy5yZXNvdXJjZXNCeUluZGV4KHJlc291cmNlSW5kZXgpLFxuICAgICAgICAgICAgICAgIGlzQWxsRGF5OiB0cnVlXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBjcmVhdGVUYXNrcyhpdGVtcywgZGF0ZVJhbmdlKSB7XG4gICAgICAgIGNvbnN0IHN0YXJ0VGltZVNsb3QgPSB0aGlzLnRpbWVTbG90c1swXTtcbiAgICAgICAgY29uc3QgZW5kVGltZVNsb3QgPSB0aGlzLnRpbWVTbG90c1t0aGlzLnRpbWVTbG90cy5sZW5ndGggLSAxXS5lbmQ7XG4gICAgICAgIGNvbnN0IG5leHREYXRlRW5kID0gIShlbmRUaW1lU2xvdC5nZXRIb3VycygpIHx8IGVuZFRpbWVTbG90LmdldE1pbnV0ZXMoKSk7XG4gICAgICAgIGNvbnN0IHJhbmdlcyA9IHRoaXMuZGF5U2xvdHMubWFwKGRheVNsb3QgPT4gKHtcbiAgICAgICAgICAgIHN0YXJ0OiB0b1VUQ1RpbWUoZGF5U2xvdC5zdGFydCwgc3RhcnRUaW1lU2xvdC5zdGFydCksXG4gICAgICAgICAgICBlbmQ6IG5leHREYXRlRW5kID8gdG9VVENEYXRlKGRheVNsb3QuZW5kKSA6IHRvVVRDVGltZShkYXlTbG90LnN0YXJ0LCBlbmRUaW1lU2xvdClcbiAgICAgICAgfSkpO1xuICAgICAgICByZXR1cm4gY3JlYXRlVGFza3MkMShkYXRlUmFuZ2Uuc3RhcnQsIGRhdGVSYW5nZS5lbmQsIGl0ZW1zLCByYW5nZXMpO1xuICAgIH1cbiAgICBvblRhc2tzQ2hhbmdlKCkge1xuICAgICAgICB0aGlzLml0ZW1zLm5leHQodGhpcy50YXNrcy5maWx0ZXIodGFzayA9PiAhdGFzay5pc0FsbERheSkpO1xuICAgICAgICB0aGlzLmFsbERheUl0ZW1zLm5leHQodGhpcy50YXNrcy5maWx0ZXIodGFzayA9PiB0YXNrLmlzQWxsRGF5KSk7XG4gICAgfVxuICAgIHJlZmxvdygpIHtcbiAgICAgICAgY29uc3Qgc2xvdFNlcnZpY2UgPSB0aGlzLnNsb3RTZXJ2aWNlO1xuICAgICAgICBpZiAoIXRoaXMudmVydGljYWxSZXNvdXJjZXMubGVuZ3RoKSB7XG4gICAgICAgICAgICB0aGlzLnVwZGF0ZUNvbnRlbnRIZWlnaHQoKTtcbiAgICAgICAgICAgIHRoaXMuc3luY1RhYmxlcygpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuc2xvdFNlcnZpY2UuY29udGFpbmVyU2l6ZSA9IHRoaXMuY29udGVudC5uYXRpdmVFbGVtZW50LmNsaWVudFdpZHRoO1xuICAgICAgICBzbG90U2VydmljZS5sYXlvdXREYXlzKHRoaXMuZXZlbnRIZWlnaHQpO1xuICAgICAgICB0aGlzLnVwZGF0ZUNvbnRlbnRIZWlnaHQoKTtcbiAgICAgICAgdGhpcy5zeW5jVGFibGVzKCk7XG4gICAgICAgIGlmICh0aGlzLmRheUNlbGxzLmxlbmd0aCkge1xuICAgICAgICAgICAgY29uc3QgY2VsbHMgPSB0aGlzLmRheUNlbGxzLnRvQXJyYXkoKTtcbiAgICAgICAgICAgIGlmICh0aGlzLnZlcnRpY2FsUmVzb3VyY2VzLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgIHNsb3RTZXJ2aWNlLmZvckVhY2hEYXRlUmFuZ2UoKHJhbmdlLCBpbmRleCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBzbG90ID0gcmFuZ2UuZmlyc3RTbG90O1xuICAgICAgICAgICAgICAgICAgICBjZWxsc1tpbmRleF0ubmF0aXZlRWxlbWVudC5zdHlsZS5oZWlnaHQgPSBgJHtzbG90LnJlY3QuaGVpZ2h0IC0gc2xvdC5wYWRkaW5nfXB4YDtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGNvbnN0IHNpemUgPSBzbG90U2VydmljZS5zeW5jRGF0ZVJhbmdlcygpO1xuICAgICAgICAgICAgICAgIGNlbGxzWzBdLm5hdGl2ZUVsZW1lbnQuc3R5bGUuaGVpZ2h0ID0gYCR7c2l6ZX1weGA7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgc2xvdFNlcnZpY2UubGF5b3V0VGltZXMoeyBmaWxsOiB0aGlzLnNsb3RGaWxsIH0pO1xuICAgICAgICB0aGlzLnN5bmNUYWJsZXMoKTtcbiAgICB9XG4gICAgZHJhZ0hvcml6b250YWwoc2xvdCkge1xuICAgICAgICByZXR1cm4gc2xvdC5pc0RheVNsb3Q7XG4gICAgfVxuICAgIHVwZGF0ZUhpbnRDb250YWluZXIoKSB7XG4gICAgICAgIGlmICh0aGlzLmhlYWRlckhpbnRDb250YWluZXIpIHtcbiAgICAgICAgICAgIHRoaXMuaGVhZGVySGludENvbnRhaW5lci5kZXRlY3RDaGFuZ2VzKCk7XG4gICAgICAgIH1cbiAgICAgICAgc3VwZXIudXBkYXRlSGludENvbnRhaW5lcigpO1xuICAgIH1cbiAgICBvblJlbGVhc2UoKSB7XG4gICAgICAgIHN1cGVyLm9uUmVsZWFzZSgpO1xuICAgICAgICB0aGlzLmRyYWdDb250YWluZXJzID0gbnVsbDtcbiAgICB9XG4gICAgdXBkYXRlRHJhZ0NvbnRhaW5lcihhcmdzKSB7XG4gICAgICAgIGlmICghdGhpcy5kcmFnQ29udGFpbmVycykge1xuICAgICAgICAgICAgdGhpcy5kcmFnQ29udGFpbmVycyA9IHRoaXMuY29udGFpbmVycztcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBjb250YWluZXIgPSB0aGlzLmRyYWdDb250YWluZXJzLmZpbmQoYyA9PiB7XG4gICAgICAgICAgICBjb25zdCBvZmZzZXQgPSBjLm9mZnNldDtcbiAgICAgICAgICAgIHJldHVybiBvZmZzZXQudG9wIDw9IGFyZ3MucGFnZVkgJiYgYXJncy5wYWdlWSA8PSBvZmZzZXQudG9wICsgb2Zmc2V0LmhlaWdodDtcbiAgICAgICAgfSkgfHwge307XG4gICAgICAgIHRoaXMuY29udGFpbmVyID0gY29udGFpbmVyLmVsZW1lbnQ7XG4gICAgICAgIHRoaXMuY29udGFpbmVyT2Zmc2V0ID0gY29udGFpbmVyLm9mZnNldDtcbiAgICB9XG4gICAgY29udGFpbmVyQnlQb3NpdGlvbih7IHgsIHkgfSkge1xuICAgICAgICByZXR1cm4gdGhpcy5jb250YWluZXJzLmZpbmQoYyA9PiB7XG4gICAgICAgICAgICBjb25zdCBvZmZzZXQgPSBjLm9mZnNldDtcbiAgICAgICAgICAgIHJldHVybiBvZmZzZXQudG9wIDw9IHkgJiYgeSA8PSBvZmZzZXQudG9wICsgb2Zmc2V0LmhlaWdodCAmJiBvZmZzZXQubGVmdCA8PSB4ICYmIHggPD0gb2Zmc2V0LmxlZnQgKyBvZmZzZXQud2lkdGg7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBnZXQgY29udGFpbmVycygpIHtcbiAgICAgICAgY29uc3QgaGVhZGVyID0gdGhpcy5oZWFkZXJXcmFwLm5hdGl2ZUVsZW1lbnQuY2hpbGRyZW5bMV07XG4gICAgICAgIGNvbnN0IGNvbnRlbnQgPSB0aGlzLmNvbnRlbnQubmF0aXZlRWxlbWVudDtcbiAgICAgICAgcmV0dXJuIFt7XG4gICAgICAgICAgICAgICAgZWxlbWVudDogY29udGVudCxcbiAgICAgICAgICAgICAgICBvZmZzZXQ6IGVsZW1lbnRPZmZzZXQoY29udGVudClcbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAgICBlbGVtZW50OiBoZWFkZXIsXG4gICAgICAgICAgICAgICAgb2Zmc2V0OiBlbGVtZW50T2Zmc2V0KGhlYWRlcilcbiAgICAgICAgICAgIH1dO1xuICAgIH1cbiAgICBzY3JvbGxDb250YWluZXIoY2FsbGJhY2ssIGFyZ3MpIHtcbiAgICAgICAgY2xlYXJJbnRlcnZhbCh0aGlzLnNjcm9sbEludGVydmFsKTtcbiAgICAgICAgaWYgKHRoaXMuY29udGFpbmVyICYmIHRoaXMuY29udGFpbmVyID09PSB0aGlzLmNvbnRlbnQubmF0aXZlRWxlbWVudCkge1xuICAgICAgICAgICAgc3VwZXIuc2Nyb2xsQ29udGFpbmVyKGNhbGxiYWNrLCBhcmdzKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBkcmFnUmFuZ2VzKHNsb3QpIHtcbiAgICAgICAgY29uc3QgdGFzayA9IHRoaXMuZHJhZ2dpbmcudGFzaztcbiAgICAgICAgaWYgKHNsb3QuaXNEYXlTbG90ICYmICF0YXNrLmlzQWxsRGF5KSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHJhbmdlczogW1tzbG90XV0sXG4gICAgICAgICAgICAgICAgc3RhcnQ6IGRhdGVXaXRoVGltZShzbG90LnN0YXJ0LCB0YXNrLnN0YXJ0LnRvVVRDRGF0ZSgpKSxcbiAgICAgICAgICAgICAgICBlbmQ6IGRhdGVXaXRoVGltZShzbG90LnN0YXJ0LCB0YXNrLmVuZC50b1VUQ0RhdGUoKSksXG4gICAgICAgICAgICAgICAgaXNBbGxEYXk6IHRydWVcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgYWxsRGF5VG9UaW1lID0gdGFzay5pc0FsbERheSAmJiAhc2xvdC5pc0RheVNsb3Q7XG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IHRoaXMuc2xvdFNlcnZpY2UuZHJhZ1JhbmdlcyhzbG90LCBhbGxEYXlUb1RpbWUgPyB7IHN0YXJ0OiAwLCBlbmQ6IDAgfSA6IHRoaXMuZHJhZ2dpbmcub2Zmc2V0KTtcbiAgICAgICAgaWYgKGFsbERheVRvVGltZSkge1xuICAgICAgICAgICAgcmVzdWx0LmVuZCA9IHNsb3QuZW5kO1xuICAgICAgICB9XG4gICAgICAgIHJlc3VsdC5pc0FsbERheSA9IHRoaXMuZHJhZ2dlZElzQWxsRGF5KHRhc2ssIHNsb3QpO1xuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH1cbiAgICBkcmFnSGludEV2ZW50U3R5bGVBcmdzKCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgZXZlbnQ6IHRoaXMuZHJhZ2dpbmcudGFzay5ldmVudCxcbiAgICAgICAgICAgIHJlc291cmNlczogdGhpcy5kcmFnZ2luZy5yZXNvdXJjZUl0ZW1zLFxuICAgICAgICAgICAgaXNBbGxEYXk6IEJvb2xlYW4odGhpcy5hbGxEYXlEcmFnSGludClcbiAgICAgICAgfTtcbiAgICB9XG4gICAgZHJhZ2dlZElzQWxsRGF5KHRhc2ssIHNsb3QpIHtcbiAgICAgICAgcmV0dXJuIEJvb2xlYW4oc2xvdC5pc0RheVNsb3QgJiYgKHRhc2suZXZlbnQuaXNBbGxEYXkgfHwgIWlzTXVsdGlEYXkodGFzaykpKTtcbiAgICB9XG4gICAgZHJhZ0hpbnRTaXplKGZpcnN0U2xvdCwgbGFzdFNsb3QpIHtcbiAgICAgICAgbGV0IHdpZHRoLCBoZWlnaHQ7XG4gICAgICAgIGlmIChmaXJzdFNsb3QuaXNEYXlTbG90KSB7XG4gICAgICAgICAgICB3aWR0aCA9IHRvUHgobGFzdFNsb3QucmVjdC5sZWZ0IC0gZmlyc3RTbG90LnJlY3QubGVmdCArIGxhc3RTbG90LnJlY3Qud2lkdGgpO1xuICAgICAgICAgICAgaGVpZ2h0ID0gdG9QeChmaXJzdFNsb3QuaGVpZ2h0KTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHdpZHRoID0gdG9QeChmaXJzdFNsb3QucmVjdC53aWR0aCAqIDAuOSk7XG4gICAgICAgICAgICBoZWlnaHQgPSB0b1B4KHRoaXMuZHJhZ2dpbmcudGFzay5pc0FsbERheSA/IGZpcnN0U2xvdC5yZWN0LmhlaWdodCA6IGxhc3RTbG90LnJlY3QudG9wIC0gZmlyc3RTbG90LnJlY3QudG9wICsgbGFzdFNsb3QucmVjdC5oZWlnaHQpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB7IHdpZHRoLCBoZWlnaHQgfTtcbiAgICB9XG4gICAgY3VycmVudFRpbWVBcnJvd09mZnNldCgpIHtcbiAgICAgICAgaWYgKHRoaXMudmVydGljYWxSZXNvdXJjZXMubGVuZ3RoKSB7XG4gICAgICAgICAgICBjb25zdCBlbCA9IHRoaXMudGltZXMubmF0aXZlRWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuay1zY2hlZHVsZXItdGltZXMtYWxsLWRheScpO1xuICAgICAgICAgICAgY29uc3QgdGltZXNFbCA9IHRoaXMudGltZXMubmF0aXZlRWxlbWVudDtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmxvY2FsaXphdGlvbi5ydGwgPyB0aW1lc0VsLm9mZnNldFdpZHRoIC0gZWwub2Zmc2V0V2lkdGggOiBlbC5vZmZzZXRMZWZ0O1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiAwO1xuICAgIH1cbn1cbk11bHRpRGF5Vmlld1JlbmRlcmVyQ29tcG9uZW50LmRlY29yYXRvcnMgPSBbXG4gICAgeyB0eXBlOiBDb21wb25lbnQsIGFyZ3M6IFt7XG4gICAgICAgICAgICAgICAgLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOmNvbXBvbmVudC1zZWxlY3RvclxuICAgICAgICAgICAgICAgIHNlbGVjdG9yOiAnbXVsdGktZGF5LXZpZXcnLFxuICAgICAgICAgICAgICAgIHByb3ZpZGVyczogW1xuICAgICAgICAgICAgICAgICAgICBEYXlUaW1lU2xvdFNlcnZpY2VcbiAgICAgICAgICAgICAgICBdLFxuICAgICAgICAgICAgICAgIHRlbXBsYXRlOiBgXG4gICAgICAgIDxkaXYgY2xhc3M9XCJrLXNjaGVkdWxlci1sYXlvdXQgay1zY2hlZHVsZXItZmxleC1sYXlvdXRcIiBbbmdDbGFzc109XCJjbGFzc05hbWVzXCI+XG4gICAgICAgICAgICA8ZGl2IGNsYXNzPVwiay1zY2hlZHVsZXItcGFuZVwiPlxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJrLXNjaGVkdWxlci10aW1lc1wiICN0aW1lc0hlYWRlcj5cbiAgICAgICAgICAgICAgICAgICAgPHRhYmxlIGNsYXNzPVwiay1zY2hlZHVsZXItdGFibGVcIiBhcmlhLWhpZGRlbj1cInRydWVcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgIDx0ciAqbmdGb3I9XCJsZXQgcmVzb3VyY2Ugb2YgaG9yaXpvbnRhbFJlc291cmNlczsgdHJhY2tCeTogaXRlbUluZGV4O1wiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0aD48L3RoPlxuICAgICAgICAgICAgICAgICAgICAgICAgPC90cj5cbiAgICAgICAgICAgICAgICAgICAgICAgIDx0cj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGg+4oCLPC90aD5cbiAgICAgICAgICAgICAgICAgICAgICAgIDwvdHI+XG4gICAgICAgICAgICAgICAgICAgICAgICA8dHIgKm5nSWY9XCIhdmVydGljYWxSZXNvdXJjZXMubGVuZ3RoXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRoIGNsYXNzPVwiay1zY2hlZHVsZXItdGltZXMtYWxsLWRheVwiICNhbGxEYXlDZWxsPnt7IGFsbERheU1lc3NhZ2UgfX08L3RoPlxuICAgICAgICAgICAgICAgICAgICAgICAgPC90cj5cbiAgICAgICAgICAgICAgICAgICAgPC90YWJsZT5cbiAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwiay1zY2hlZHVsZXItaGVhZGVyIGstc3RhdGUtZGVmYXVsdFwiICNoZWFkZXI+XG4gICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJrLXNjaGVkdWxlci1oZWFkZXItd3JhcFwiICNoZWFkZXJXcmFwPlxuICAgICAgICAgICAgICAgICAgICAgICAgPHRhYmxlIGNsYXNzPVwiay1zY2hlZHVsZXItdGFibGVcIiBhcmlhLWhpZGRlbj1cInRydWVcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dHIgKm5nRm9yPVwibGV0IHJlc291cmNlIG9mIGhvcml6b250YWxSZXNvdXJjZXM7IGxldCByZXNvdXJjZUluZGV4ID0gaW5kZXg7IHRyYWNrQnk6IGl0ZW1JbmRleDtcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRoICpuZ0Zvcj1cImxldCBpdGVtIG9mIGhvcml6b250YWxSZXNvdXJjZXMgfCByZXNvdXJjZUl0ZXJhdG9yIDogcmVzb3VyY2VJbmRleDsgdHJhY2tCeTogaXRlbUluZGV4O1wiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzcz1cImstc2xvdC1jZWxsXCIgW2F0dHIuY29sc3Bhbl09XCJob3Jpem9udGFsQ29sc3BhbihyZXNvdXJjZUluZGV4KVwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPG5nLWNvbnRhaW5lciAqbmdJZj1cIiFncm91cEhlYWRlclRlbXBsYXRlUmVmXCI+e3sgZ2V0RmllbGQoaXRlbSwgcmVzb3VyY2UudGV4dEZpZWxkKSB9fTwvbmctY29udGFpbmVyPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPG5nLWNvbnRhaW5lciAqbmdJZj1cImdyb3VwSGVhZGVyVGVtcGxhdGVSZWZcIiBbbmdUZW1wbGF0ZU91dGxldF09XCJncm91cEhlYWRlclRlbXBsYXRlUmVmXCIgW25nVGVtcGxhdGVPdXRsZXRDb250ZXh0XT1cInsgcmVzb3VyY2U6IGl0ZW0gfVwiPjwvbmctY29udGFpbmVyPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3RoPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvdHI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRyPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8bmctY29udGFpbmVyICpuZ0Zvcj1cImxldCByZXNvdXJjZSBvZiBob3Jpem9udGFsUmVzb3VyY2VzIHwgcmVzb3VyY2VJdGVyYXRvcjsgdHJhY2tCeTogaXRlbUluZGV4O1wiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRoICpuZ0Zvcj1cImxldCBzbG90IG9mIGRheVNsb3RzOyBsZXQgaW5kZXggPSBpbmRleDsgdHJhY2tCeTogaXRlbUluZGV4XCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHNwYW4gKm5nSWY9XCIhZGF0ZUhlYWRlclRlbXBsYXRlUmVmXCIgY2xhc3M9XCJrLWxpbmsgay1uYXYtZGF5XCIgW2F0dHIuZGF0YS1kYXlzbG90LWluZGV4XT1cImluZGV4XCI+e3sgc2xvdC5zdGFydCB8IGtlbmRvRGF0ZTogZGF0ZUZvcm1hdCB9fTwvc3Bhbj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8bmctY29udGFpbmVyICpuZ0lmPVwiZGF0ZUhlYWRlclRlbXBsYXRlUmVmXCIgW25nVGVtcGxhdGVPdXRsZXRdPVwiZGF0ZUhlYWRlclRlbXBsYXRlUmVmXCIgW25nVGVtcGxhdGVPdXRsZXRDb250ZXh0XT1cInsgZGF0ZTogc2xvdC5zdGFydCB9XCI+PC9uZy1jb250YWluZXI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3RoPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L25nLWNvbnRhaW5lcj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3RyPlxuICAgICAgICAgICAgICAgICAgICAgICAgPC90YWJsZT5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgc3R5bGU9XCJwb3NpdGlvbjogcmVsYXRpdmU7XCIgKm5nSWY9XCIhdmVydGljYWxSZXNvdXJjZXMubGVuZ3RoXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRhYmxlIGNsYXNzPVwiay1zY2hlZHVsZXItdGFibGUgay1zY2hlZHVsZXItaGVhZGVyLWFsbC1kYXlcIiBhcmlhLWhpZGRlbj1cInRydWVcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRyPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPG5nLWNvbnRhaW5lciAqbmdGb3I9XCJsZXQgcmVzb3VyY2Ugb2YgaG9yaXpvbnRhbFJlc291cmNlcyB8IHJlc291cmNlSXRlcmF0b3I7IGxldCByZXNvdXJjZUluZGV4ID0gaW5kZXg7IHRyYWNrQnk6IGl0ZW1JbmRleDtcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGQgKm5nRm9yPVwibGV0IHNsb3Qgb2YgZGF5U2xvdHM7IGxldCBpbmRleCA9IGluZGV4OyB0cmFja0J5OiBpdGVtSW5kZXhcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXlTbG90XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFtzdGFydF09XCJzbG90LnN0YXJ0XCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgW2VuZF09XCJzbG90LmVuZFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFtpZF09XCJ7IHJlc291cmNlSW5kZXg6IHJlc291cmNlSW5kZXgsIHJhbmdlSW5kZXg6IDAsIGluZGV4OiBpbmRleCB9XCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgW25nQ2xhc3NdPVwiYWxsRGF5U2xvdENsYXNzKHNsb3QsIHJlc291cmNlSW5kZXgpXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxuZy1jb250YWluZXIgKm5nSWY9XCJhbGxEYXlTbG90VGVtcGxhdGVSZWZcIiBbbmdUZW1wbGF0ZU91dGxldF09XCJhbGxEYXlTbG90VGVtcGxhdGVSZWZcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgW25nVGVtcGxhdGVPdXRsZXRDb250ZXh0XT1cInsgZGF0ZTogc2xvdC5zdGFydCwgcmVzb3VyY2VzOiByZXNvdXJjZXNCeUluZGV4KHJlc291cmNlSW5kZXgpIH1cIj48L25nLWNvbnRhaW5lcj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3RkPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9uZy1jb250YWluZXI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvdHI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPC90YWJsZT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8bmctY29udGFpbmVyICpuZ0Zvcj1cImxldCBpdGVtIG9mIGFsbERheUl0ZW1zIHwgYXN5bmM7IHRyYWNrQnk6IGl0ZW1JbmRleDtcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiAqbmdGb3I9XCJsZXQgaXRlbVJlc291cmNlIG9mIGl0ZW0ucmVzb3VyY2VzOyB0cmFja0J5OiBpdGVtSW5kZXg7XCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFtuZ0NsYXNzXT1cImdldEV2ZW50Q2xhc3NlcyhpdGVtLCBpdGVtUmVzb3VyY2UucmVzb3VyY2VzLCB0cnVlKVwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbbmdTdHlsZV09XCJnZXRFdmVudFN0eWxlcyhpdGVtLCBpdGVtUmVzb3VyY2UsIHRydWUpXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFtrZW5kb1NjaGVkdWxlckZvY3VzSW5kZXhdPVwiaXRlbVJlc291cmNlLmxlYWZJZHhcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRheVRpbWVWaWV3SXRlbVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFtpc0FsbERheV09XCJ0cnVlXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbZWRpdGFibGVdPVwiZWRpdGFibGVcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFtldmVudFRlbXBsYXRlXT1cImFsbERheUV2ZW50VGVtcGxhdGVSZWZcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFtpdGVtXT1cIml0ZW1cIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFtpbmRleF09XCJpdGVtLmluZGV4XCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbcmFuZ2VJbmRleF09XCJpdGVtLnJhbmdlSW5kZXhcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFtyZXNvdXJjZXNdPVwiaXRlbVJlc291cmNlLnJlc291cmNlc1wiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgW3Jlc291cmNlSW5kZXhdPVwiaXRlbVJlc291cmNlLmxlYWZJZHhcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9uZy1jb250YWluZXI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPGtlbmRvLWhpbnQtY29udGFpbmVyICNoZWFkZXJIaW50Q29udGFpbmVyPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8bmctdGVtcGxhdGU+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2ICpuZ0lmPVwiZHJhZ0hpbnRzLmxlbmd0aCAmJiBhbGxEYXlEcmFnSGludFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3M9XCJrLWV2ZW50LWRyYWctaGludFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF5VGltZVZpZXdJdGVtXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFtpc0FsbERheV09XCJ0cnVlXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgW25nU3R5bGVdPVwiZHJhZ0hpbnRzWzBdLnN0eWxlXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgW25nQ2xhc3NdPVwiZHJhZ0hpbnRzWzBdLmNsYXNzXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgW2RyYWdIaW50XT1cInRydWVcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbZXZlbnRUZW1wbGF0ZV09XCJldmVudFRlbXBsYXRlUmVmXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgW2l0ZW1dPVwiZHJhZ0hpbnRzWzBdLml0ZW1cIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbcmVzb3VyY2VzXT1cImRyYWdIaW50c1swXS5yZXNvdXJjZXNcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2ICpuZ0lmPVwicmVzaXplSGludHMubGVuZ3RoICYmIGFsbERheVJlc2l6ZUhpbnRcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGtlbmRvUmVzaXplSGludFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbaGludF09XCJyZXNpemVIaW50c1swXVwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFtuZ0NsYXNzXT1cInJlc2l6ZUhpbnRzWzBdLmNsYXNzXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgW2Zvcm1hdF09XCJhbGxEYXlSZXNpemVIaW50Rm9ybWF0XCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9uZy10ZW1wbGF0ZT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2tlbmRvLWhpbnQtY29udGFpbmVyPlxuICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICA8ZGl2IGNsYXNzPVwiay1zY2hlZHVsZXItcGFuZVwiPlxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJrLXNjaGVkdWxlci10aW1lc1wiICN0aW1lcz5cbiAgICAgICAgICAgICAgICAgICAgPG5nLWNvbnRhaW5lciAqbmdJZj1cInNob3dDdXJyZW50VGltZVwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiAqbmdGb3I9XCJsZXQgcmVzb3VyY2Ugb2YgdmVydGljYWxSZXNvdXJjZXMgfCByZXNvdXJjZUl0ZXJhdG9yOyB0cmFja0J5OiBpdGVtSW5kZXg7XCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAjY3VycmVudFRpbWVBcnJvdyBjbGFzcz1cImstY3VycmVudC10aW1lIGstY3VycmVudC10aW1lLWFycm93LXJpZ2h0XCI+XG4gICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgPC9uZy1jb250YWluZXI+XG4gICAgICAgICAgICAgICAgICAgIDx0YWJsZSBjbGFzcz1cImstc2NoZWR1bGVyLXRhYmxlXCIgI3RpbWVzVGFibGUgYXJpYS1oaWRkZW49XCJ0cnVlXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICA8bmctY29udGFpbmVyICpuZ0Zvcj1cImxldCByZXNvdXJjZUl0ZW0gb2YgdmVydGljYWxSZXNvdXJjZXMgfCByZXNvdXJjZUl0ZXJhdG9yOyBsZXQgbGVhZkluZGV4ID0gaW5kZXg7IHRyYWNrQnk6IGl0ZW1JbmRleDtcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dHIgKm5nSWY9XCJ2ZXJ0aWNhbFJlc291cmNlcy5sZW5ndGhcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPG5nLWNvbnRhaW5lciAqbmdGb3I9XCJsZXQgcmVzb3VyY2Ugb2YgdmVydGljYWxSZXNvdXJjZXM7IGxldCByZXNvdXJjZUluZGV4ID0gaW5kZXg7IHRyYWNrQnk6IGl0ZW1JbmRleDtcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0aCAqbmdJZj1cInZlcnRpY2FsSXRlbShsZWFmSW5kZXgsIHJlc291cmNlSW5kZXgpXCIgW2F0dHIucm93c3Bhbl09XCJ2ZXJ0aWNhbFJvd3NwYW4ocmVzb3VyY2VJbmRleClcIiBjbGFzcz1cImstc2xvdC1jZWxsXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPG5nLWNvbnRhaW5lciAqbmdJZj1cIiFncm91cEhlYWRlclRlbXBsYXRlUmVmXCI+e3sgZ2V0RmllbGQodmVydGljYWxJdGVtKGxlYWZJbmRleCwgcmVzb3VyY2VJbmRleCksIHJlc291cmNlLnRleHRGaWVsZCkgfX08L25nLWNvbnRhaW5lcj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8bmctY29udGFpbmVyICpuZ0lmPVwiZ3JvdXBIZWFkZXJUZW1wbGF0ZVJlZlwiIFtuZ1RlbXBsYXRlT3V0bGV0XT1cImdyb3VwSGVhZGVyVGVtcGxhdGVSZWZcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbbmdUZW1wbGF0ZU91dGxldENvbnRleHRdPVwieyByZXNvdXJjZTogdmVydGljYWxJdGVtKGxlYWZJbmRleCwgcmVzb3VyY2VJbmRleCkgfVwiPjwvbmctY29udGFpbmVyPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC90aD5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9uZy1jb250YWluZXI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0aCBjbGFzcz1cImstc2NoZWR1bGVyLXRpbWVzLWFsbC1kYXlcIiAjYWxsRGF5Q2VsbD57eyBhbGxEYXlNZXNzYWdlIH19PC90aD5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3RyPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0ciAqbmdGb3I9XCJsZXQgc2xvdCBvZiB0aW1lU2xvdHM7IGxldCB0aW1lU2xvdEluZGV4ID0gaW5kZXg7dHJhY2tCeTogaXRlbUluZGV4XCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0aCAqbmdJZj1cInNsb3QuaXNNYWpvclwiIFtuZ0NsYXNzXT1cInsgJ2stc2xvdC1jZWxsJzogc2xvdERpdmlzaW9ucyA9PT0gMSB9XCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8bmctY29udGFpbmVyICpuZ0lmPVwiIW1ham9yVGltZUhlYWRlclRlbXBsYXRlUmVmXCI+e3sgc2xvdC5zdGFydCB8IGtlbmRvRGF0ZTogJ3QnIH19PC9uZy1jb250YWluZXI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8bmctY29udGFpbmVyICpuZ0lmPVwibWFqb3JUaW1lSGVhZGVyVGVtcGxhdGVSZWZcIiBbbmdUZW1wbGF0ZU91dGxldF09XCJtYWpvclRpbWVIZWFkZXJUZW1wbGF0ZVJlZlwiIFtuZ1RlbXBsYXRlT3V0bGV0Q29udGV4dF09XCJ7IGRhdGU6IHNsb3Quc3RhcnQgfVwiPjwvbmctY29udGFpbmVyPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3RoPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGggKm5nSWY9XCIhc2xvdC5pc01ham9yXCIgW25nQ2xhc3NdPVwieyAnay1zbG90LWNlbGwnOiB0aW1lU2xvdEluZGV4ICUgc2xvdERpdmlzaW9ucyA9PT0gc2xvdERpdmlzaW9ucyAtIDEgfVwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPG5nLWNvbnRhaW5lciAqbmdJZj1cIm1pbm9yVGltZUhlYWRlclRlbXBsYXRlUmVmXCIgW25nVGVtcGxhdGVPdXRsZXRdPVwibWlub3JUaW1lSGVhZGVyVGVtcGxhdGVSZWZcIiBbbmdUZW1wbGF0ZU91dGxldENvbnRleHRdPVwieyBkYXRlOiBzbG90LnN0YXJ0IH1cIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvbmctY29udGFpbmVyPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3RoPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvdHI+XG4gICAgICAgICAgICAgICAgICAgICAgICA8L25nLWNvbnRhaW5lcj5cbiAgICAgICAgICAgICAgICAgICAgPC90YWJsZT5cbiAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwiay1zY2hlZHVsZXItY29udGVudFwiICNjb250ZW50PlxuICAgICAgICAgICAgICAgICAgICA8bmctY29udGFpbmVyICpuZ0lmPVwic2hvd0N1cnJlbnRUaW1lXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICA8ZGl2ICpuZ0Zvcj1cImxldCByZXNvdXJjZSBvZiB2ZXJ0aWNhbFJlc291cmNlcyB8IHJlc291cmNlSXRlcmF0b3I7IHRyYWNrQnk6IGl0ZW1JbmRleDtcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICNjdXJyZW50VGltZU1hcmtlciBjbGFzcz1cImstY3VycmVudC10aW1lXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgPC9uZy1jb250YWluZXI+XG4gICAgICAgICAgICAgICAgICAgIDx0YWJsZSBjbGFzcz1cImstc2NoZWR1bGVyLXRhYmxlXCIgI2NvbnRlbnRUYWJsZSByb2xlPVwicHJlc2VudGF0aW9uXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICA8bmctY29udGFpbmVyICpuZ0Zvcj1cImxldCByZXNvdXJjZUl0ZW0gb2YgdmVydGljYWxSZXNvdXJjZXMgfCByZXNvdXJjZUl0ZXJhdG9yOyBsZXQgdmVydGljYWxJbmRleCA9IGluZGV4OyB0cmFja0J5OiBpdGVtSW5kZXg7XCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRyIGNsYXNzPVwiay1zY2hlZHVsZXItaGVhZGVyLWFsbC1kYXlcIiAqbmdJZj1cInZlcnRpY2FsUmVzb3VyY2VzLmxlbmd0aFwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGQgKm5nRm9yPVwibGV0IHNsb3Qgb2YgZGF5U2xvdHM7IGxldCBpbmRleCA9IGluZGV4OyB0cmFja0J5OiBpdGVtSW5kZXhcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF5U2xvdFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgW3N0YXJ0XT1cInNsb3Quc3RhcnRcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgW2VuZF09XCJzbG90LmVuZFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbaWRdPVwieyByZXNvdXJjZUluZGV4OiB2ZXJ0aWNhbEluZGV4LCByYW5nZUluZGV4OiAwLCBpbmRleDogaW5kZXggfVwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPG5nLWNvbnRhaW5lciAqbmdJZj1cImFsbERheVNsb3RUZW1wbGF0ZVJlZlwiIFtuZ1RlbXBsYXRlT3V0bGV0XT1cImFsbERheVNsb3RUZW1wbGF0ZVJlZlwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgW25nVGVtcGxhdGVPdXRsZXRDb250ZXh0XT1cInsgZGF0ZTogc2xvdC5zdGFydCwgcmVzb3VyY2VzOiByZXNvdXJjZXNCeUluZGV4KHZlcnRpY2FsSW5kZXgpIH1cIj48L25nLWNvbnRhaW5lcj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC90ZD5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3RyPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0ciAqbmdGb3I9XCJsZXQgc2xvdCBvZiB0aW1lU2xvdHM7IGluZGV4IGFzIGluZGV4OyB0cmFja0J5OiBpdGVtSW5kZXhcIiBbY2xhc3Muay1taWRkbGUtcm93XT1cInNsb3QuaXNNYWpvclwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8bmctY29udGFpbmVyICpuZ0Zvcj1cImxldCByZXNvdXJjZSBvZiBob3Jpem9udGFsUmVzb3VyY2VzIHwgcmVzb3VyY2VJdGVyYXRvcjsgbGV0IGhvcml6b250YWxJbmRleCA9IGluZGV4OyB0cmFja0J5OiBpdGVtSW5kZXg7XCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGQgKm5nRm9yPVwibGV0IGRheVNsb3Qgb2YgZGF5U2xvdHM7IGluZGV4IGFzIHJhbmdlSW5kZXg7IHRyYWNrQnk6IGl0ZW1JbmRleFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgW2NsYXNzLmstbm9ud29yay1ob3VyXT1cInNsb3QuaXNXb3JrSG91clwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgW25nQ2xhc3NdPVwidGltZVNsb3RDbGFzcyhzbG90LCBkYXlTbG90LnN0YXJ0LCB2ZXJ0aWNhbFJlc291cmNlcy5sZW5ndGggPyB2ZXJ0aWNhbEluZGV4IDogaG9yaXpvbnRhbEluZGV4KVwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGltZVNsb3QgI3RpbWVTbG90PVwidGltZVNsb3RcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbZGF0ZV09XCJkYXlTbG90LnN0YXJ0XCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgW2ludmFyaWFudFN0YXJ0XT1cInNsb3Quc3RhcnRcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbaW52YXJpYW50RW5kXT1cInNsb3QuZW5kXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgW3dvcmtEYXlTdGFydF09XCJ3b3JrRGF5U3RhcnRUaW1lXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgW3dvcmtEYXlFbmRdPVwid29ya0RheUVuZFRpbWVcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbd29ya1dlZWtTdGFydF09XCJ3b3JrV2Vla1N0YXJ0XCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgW3dvcmtXZWVrRW5kXT1cIndvcmtXZWVrRW5kXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgW2lkXT1cInsgcmVzb3VyY2VJbmRleDogdmVydGljYWxSZXNvdXJjZXMubGVuZ3RoID8gdmVydGljYWxJbmRleCA6IGhvcml6b250YWxJbmRleCwgcmFuZ2VJbmRleDogcmFuZ2VJbmRleCwgaW5kZXg6IGluZGV4IH1cIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxuZy1jb250YWluZXIgKm5nSWY9XCJ0aW1lU2xvdFRlbXBsYXRlUmVmXCIgW25nVGVtcGxhdGVPdXRsZXRdPVwidGltZVNsb3RUZW1wbGF0ZVJlZlwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFtuZ1RlbXBsYXRlT3V0bGV0Q29udGV4dF09XCJ7IGRhdGU6IHRpbWVTbG90LnN0YXJ0TG9jYWxUaW1lLCByZXNvdXJjZXM6IHJlc291cmNlc0J5SW5kZXgodGltZVNsb3QuaWQucmVzb3VyY2VJbmRleCkgfVwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvbmctY29udGFpbmVyPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC90ZD5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9uZy1jb250YWluZXI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPC90cj5cbiAgICAgICAgICAgICAgICAgICAgICAgIDwvbmctY29udGFpbmVyPlxuICAgICAgICAgICAgICAgICAgICA8L3RhYmxlPlxuICAgICAgICAgICAgICAgICAgICA8bmctY29udGFpbmVyICpuZ0Zvcj1cImxldCBpdGVtIG9mIGl0ZW1zIHwgYXN5bmM7IHRyYWNrQnk6IGl0ZW1JbmRleDtcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgKm5nRm9yPVwibGV0IGl0ZW1SZXNvdXJjZSBvZiBpdGVtLnJlc291cmNlczsgdHJhY2tCeTogaXRlbUluZGV4O1wiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgW25nQ2xhc3NdPVwiZ2V0RXZlbnRDbGFzc2VzKGl0ZW0sIGl0ZW1SZXNvdXJjZS5yZXNvdXJjZXMpXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbbmdTdHlsZV09XCJnZXRFdmVudFN0eWxlcyhpdGVtLCBpdGVtUmVzb3VyY2UpXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBba2VuZG9TY2hlZHVsZXJGb2N1c0luZGV4XT1cIml0ZW1SZXNvdXJjZS5sZWFmSWR4XCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXlUaW1lVmlld0l0ZW1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgW2VkaXRhYmxlXT1cImVkaXRhYmxlXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgW3ZlcnRpY2FsXT1cInRydWVcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbZXZlbnRUZW1wbGF0ZV09XCJldmVudFRlbXBsYXRlUmVmXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgW2l0ZW1dPVwiaXRlbVwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFtpbmRleF09XCJpdGVtLmluZGV4XCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgW3JhbmdlSW5kZXhdPVwiaXRlbS5yYW5nZUluZGV4XCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgW3Jlc291cmNlc109XCJpdGVtUmVzb3VyY2UucmVzb3VyY2VzXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgW3Jlc291cmNlSW5kZXhdPVwiaXRlbVJlc291cmNlLmxlYWZJZHhcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICA8L25nLWNvbnRhaW5lcj5cbiAgICAgICAgICAgICAgICAgICAgPG5nLWNvbnRhaW5lciAqbmdJZj1cInZlcnRpY2FsUmVzb3VyY2VzLmxlbmd0aFwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgPG5nLWNvbnRhaW5lciAqbmdGb3I9XCJsZXQgaXRlbSBvZiBhbGxEYXlJdGVtcyB8IGFzeW5jOyB0cmFja0J5OiBpdGVtSW5kZXg7XCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiAqbmdGb3I9XCJsZXQgaXRlbVJlc291cmNlIG9mIGl0ZW0ucmVzb3VyY2VzOyB0cmFja0J5OiBpdGVtSW5kZXg7XCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgW25nQ2xhc3NdPVwiZ2V0RXZlbnRDbGFzc2VzKGl0ZW0sIGl0ZW1SZXNvdXJjZS5yZXNvdXJjZXMsIHRydWUpXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgW25nU3R5bGVdPVwiZ2V0RXZlbnRTdHlsZXMoaXRlbSwgaXRlbVJlc291cmNlLCB0cnVlKVwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFtrZW5kb1NjaGVkdWxlckZvY3VzSW5kZXhdPVwiaXRlbVJlc291cmNlLmxlYWZJZHhcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXlUaW1lVmlld0l0ZW1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFtpc0FsbERheV09XCJ0cnVlXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFtlZGl0YWJsZV09XCJlZGl0YWJsZVwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbZXZlbnRUZW1wbGF0ZV09XCJhbGxEYXlFdmVudFRlbXBsYXRlUmVmXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFtpdGVtXT1cIml0ZW1cIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgW2luZGV4XT1cIml0ZW0uaW5kZXhcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgW3JhbmdlSW5kZXhdPVwiaXRlbS5yYW5nZUluZGV4XCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFtyZXNvdXJjZXNdPVwiaXRlbVJlc291cmNlLnJlc291cmNlc1wiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbcmVzb3VyY2VJbmRleF09XCJpdGVtUmVzb3VyY2UubGVhZklkeFwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICAgICAgPC9uZy1jb250YWluZXI+XG4gICAgICAgICAgICAgICAgICAgIDwvbmctY29udGFpbmVyPlxuICAgICAgICAgICAgICAgICAgICA8a2VuZG8taGludC1jb250YWluZXIgI2hpbnRDb250YWluZXI+XG4gICAgICAgICAgICAgICAgICAgICAgICA8bmctdGVtcGxhdGU+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiAqbmdJZj1cImRyYWdIaW50cy5sZW5ndGggJiYgKCFhbGxEYXlEcmFnSGludCB8fCB2ZXJ0aWNhbFJlc291cmNlcy5sZW5ndGgpXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3M9XCJrLWV2ZW50LWRyYWctaGludFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRheVRpbWVWaWV3SXRlbVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgW2lzQWxsRGF5XT1cImFsbERheURyYWdIaW50XCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFtuZ1N0eWxlXT1cImRyYWdIaW50c1swXS5zdHlsZVwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbbmdDbGFzc109XCJkcmFnSGludHNbMF0uY2xhc3NcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgW2RyYWdIaW50XT1cInRydWVcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgW2V2ZW50VGVtcGxhdGVdPVwiZXZlbnRUZW1wbGF0ZVJlZlwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbcmVzb3VyY2VzXT1cImRyYWdIaW50c1swXS5yZXNvdXJjZXNcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgW2l0ZW1dPVwiZHJhZ0hpbnRzWzBdLml0ZW1cIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxuZy1jb250YWluZXIgKm5nSWY9XCJyZXNpemVIaW50cy5sZW5ndGggJiYgKCFhbGxEYXlSZXNpemVIaW50IHx8IHZlcnRpY2FsUmVzb3VyY2VzLmxlbmd0aClcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiAqbmdGb3I9XCJsZXQgaGludCBvZiByZXNpemVIaW50czsgdHJhY2tCeTogaXRlbUluZGV4O1wiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBrZW5kb1Jlc2l6ZUhpbnRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbaGludF09XCJoaW50XCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbbmdDbGFzc109XCJoaW50LmNsYXNzXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbZm9ybWF0XT1cImFsbERheVJlc2l6ZUhpbnQgPyBhbGxEYXlSZXNpemVIaW50Rm9ybWF0IDogcmVzaXplSGludEZvcm1hdFwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L25nLWNvbnRhaW5lcj5cbiAgICAgICAgICAgICAgICAgICAgICAgIDwvbmctdGVtcGxhdGU+XG4gICAgICAgICAgICAgICAgICAgIDwva2VuZG8taGludC1jb250YWluZXI+XG4gICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgPC9kaXY+XG4gICAgYFxuICAgICAgICAgICAgfSxdIH0sXG5dO1xuLyoqIEBub2NvbGxhcHNlICovXG5NdWx0aURheVZpZXdSZW5kZXJlckNvbXBvbmVudC5jdG9yUGFyYW1ldGVycyA9ICgpID0+IFtcbiAgICB7IHR5cGU6IExvY2FsaXphdGlvblNlcnZpY2UgfSxcbiAgICB7IHR5cGU6IFZpZXdDb250ZXh0U2VydmljZSB9LFxuICAgIHsgdHlwZTogVmlld1N0YXRlU2VydmljZSB9LFxuICAgIHsgdHlwZTogSW50bFNlcnZpY2UgfSxcbiAgICB7IHR5cGU6IERheVRpbWVTbG90U2VydmljZSB9LFxuICAgIHsgdHlwZTogTmdab25lIH0sXG4gICAgeyB0eXBlOiBSZW5kZXJlcjIgfSxcbiAgICB7IHR5cGU6IEVsZW1lbnRSZWYgfSxcbiAgICB7IHR5cGU6IENoYW5nZURldGVjdG9yUmVmIH0sXG4gICAgeyB0eXBlOiBQREZTZXJ2aWNlIH1cbl07XG5NdWx0aURheVZpZXdSZW5kZXJlckNvbXBvbmVudC5wcm9wRGVjb3JhdG9ycyA9IHtcbiAgICBuYW1lOiBbeyB0eXBlOiBJbnB1dCB9XSxcbiAgICBzbG90RmlsbDogW3sgdHlwZTogSW5wdXQgfV0sXG4gICAgYWxsRGF5U2xvdFRlbXBsYXRlOiBbeyB0eXBlOiBJbnB1dCB9XSxcbiAgICBhbGxEYXlFdmVudFRlbXBsYXRlOiBbeyB0eXBlOiBJbnB1dCB9XSxcbiAgICBtaW5vclRpbWVIZWFkZXJUZW1wbGF0ZTogW3sgdHlwZTogSW5wdXQgfV0sXG4gICAgbWFqb3JUaW1lSGVhZGVyVGVtcGxhdGU6IFt7IHR5cGU6IElucHV0IH1dLFxuICAgIGRheUNlbGxzOiBbeyB0eXBlOiBWaWV3Q2hpbGRyZW4sIGFyZ3M6IFsnYWxsRGF5Q2VsbCcsXSB9XSxcbiAgICBoZWFkZXJIaW50Q29udGFpbmVyOiBbeyB0eXBlOiBWaWV3Q2hpbGQsIGFyZ3M6IFsnaGVhZGVySGludENvbnRhaW5lcicsXSB9XVxufTtcblxuLyoqXG4gKiBAaGlkZGVuXG4gKi9cbmNsYXNzIFRpbWVTbG90RGlyZWN0aXZlIGV4dGVuZHMgQmFzZVNsb3REaXJlY3RpdmUge1xuICAgIGNvbnN0cnVjdG9yKGVsZW1lbnQsIHNsb3RTZXJ2aWNlLCBsb2NhbGl6YXRpb24pIHtcbiAgICAgICAgc3VwZXIoZWxlbWVudCwgc2xvdFNlcnZpY2UsIGxvY2FsaXphdGlvbik7XG4gICAgICAgIHRoaXMuaXNEYXlTbG90ID0gZmFsc2U7XG4gICAgfVxuICAgIGdldCBub25Xb3JrSG91cigpIHtcbiAgICAgICAgY29uc3QgZGF0ZSA9IHRoaXMuZGF0ZS5nZXREYXkoKTtcbiAgICAgICAgcmV0dXJuIHRoaXMuaW52YXJpYW50U3RhcnQgPCB0aGlzLndvcmtEYXlTdGFydCB8fCB0aGlzLndvcmtEYXlFbmQgPCB0aGlzLmludmFyaWFudEVuZCB8fCAhaXNXb3JrV2Vla0RheShkYXRlLCB0aGlzLndvcmtXZWVrU3RhcnQsIHRoaXMud29ya1dlZWtFbmQpO1xuICAgIH1cbiAgICBnZXQgc3RhcnRMb2NhbFRpbWUoKSB7XG4gICAgICAgIGlmICghdGhpcy5kYXRlIHx8ICF0aGlzLmludmFyaWFudFN0YXJ0KSB7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZGF0ZVdpdGhUaW1lKHRoaXMuZGF0ZSwgdGhpcy5pbnZhcmlhbnRTdGFydCk7XG4gICAgfVxuICAgIGdldCBlbmRMb2NhbFRpbWUoKSB7XG4gICAgICAgIGlmICghdGhpcy5kYXRlIHx8ICF0aGlzLmludmFyaWFudEVuZCkge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGRhdGVXaXRoVGltZSh0aGlzLmRhdGUsIHRoaXMuaW52YXJpYW50RW5kKTtcbiAgICB9XG4gICAgZ2V0IHN0YXJ0KCkge1xuICAgICAgICBpZiAoIXRoaXMuZGF0ZSB8fCAhdGhpcy5pbnZhcmlhbnRTdGFydCkge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRvVVRDVGltZSh0aGlzLmRhdGUsIHRoaXMuaW52YXJpYW50U3RhcnQpO1xuICAgIH1cbiAgICBnZXQgZW5kKCkge1xuICAgICAgICBpZiAoIXRoaXMuZGF0ZSB8fCAhdGhpcy5pbnZhcmlhbnRFbmQpIHtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGxvY2FsRW5kID0gdG9VVENUaW1lKHRoaXMuZGF0ZSwgdGhpcy5pbnZhcmlhbnRFbmQpO1xuICAgICAgICBpZiAoSU5WQVJJQU5UX0VORC5nZXRUaW1lKCkgPD0gdGhpcy5pbnZhcmlhbnRFbmQuZ2V0VGltZSgpKSB7XG4gICAgICAgICAgICByZXR1cm4gYWRkVVRDRGF5cyhsb2NhbEVuZCwgMSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGxvY2FsRW5kO1xuICAgIH1cbn1cblRpbWVTbG90RGlyZWN0aXZlLmRlY29yYXRvcnMgPSBbXG4gICAgeyB0eXBlOiBEaXJlY3RpdmUsIGFyZ3M6IFt7XG4gICAgICAgICAgICAgICAgLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOmRpcmVjdGl2ZS1zZWxlY3RvclxuICAgICAgICAgICAgICAgIHNlbGVjdG9yOiAnW3RpbWVTbG90XScsXG4gICAgICAgICAgICAgICAgZXhwb3J0QXM6ICd0aW1lU2xvdCdcbiAgICAgICAgICAgIH0sXSB9LFxuXTtcbi8qKiBAbm9jb2xsYXBzZSAqL1xuVGltZVNsb3REaXJlY3RpdmUuY3RvclBhcmFtZXRlcnMgPSAoKSA9PiBbXG4gICAgeyB0eXBlOiBFbGVtZW50UmVmIH0sXG4gICAgeyB0eXBlOiBEYXlUaW1lU2xvdFNlcnZpY2UgfSxcbiAgICB7IHR5cGU6IExvY2FsaXphdGlvblNlcnZpY2UgfVxuXTtcblRpbWVTbG90RGlyZWN0aXZlLnByb3BEZWNvcmF0b3JzID0ge1xuICAgIGludmFyaWFudFN0YXJ0OiBbeyB0eXBlOiBJbnB1dCB9XSxcbiAgICBpbnZhcmlhbnRFbmQ6IFt7IHR5cGU6IElucHV0IH1dLFxuICAgIHdvcmtEYXlTdGFydDogW3sgdHlwZTogSW5wdXQgfV0sXG4gICAgd29ya0RheUVuZDogW3sgdHlwZTogSW5wdXQgfV0sXG4gICAgd29ya1dlZWtTdGFydDogW3sgdHlwZTogSW5wdXQgfV0sXG4gICAgd29ya1dlZWtFbmQ6IFt7IHR5cGU6IElucHV0IH1dLFxuICAgIGRhdGU6IFt7IHR5cGU6IElucHV0IH1dLFxuICAgIG5vbldvcmtIb3VyOiBbeyB0eXBlOiBIb3N0QmluZGluZywgYXJnczogWydjbGFzcy5rLW5vbndvcmstaG91cicsXSB9XVxufTtcbi8qKlxuICogQGhpZGRlblxuICovXG5jbGFzcyBEYXlTbG90RGlyZWN0aXZlIGV4dGVuZHMgQmFzZVNsb3REaXJlY3RpdmUge1xuICAgIGNvbnN0cnVjdG9yKGVsZW1lbnQsIHNsb3RTZXJ2aWNlLCBsb2NhbGl6YXRpb24pIHtcbiAgICAgICAgc3VwZXIoZWxlbWVudCwgc2xvdFNlcnZpY2UsIGxvY2FsaXphdGlvbik7XG4gICAgICAgIHRoaXMuaXNEYXlTbG90ID0gdHJ1ZTtcbiAgICB9XG4gICAgc2V0IHN0YXJ0KHZhbHVlKSB7XG4gICAgICAgIHRoaXMuc3RhcnREYXRlID0gdmFsdWU7XG4gICAgfVxuICAgIGdldCBzdGFydCgpIHtcbiAgICAgICAgaWYgKCF0aGlzLnN0YXJ0RGF0ZSkge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRvVVRDRGF0ZSh0aGlzLnN0YXJ0RGF0ZSk7XG4gICAgfVxuICAgIHNldCBlbmQodmFsdWUpIHtcbiAgICAgICAgdGhpcy5lbmREYXRlID0gdmFsdWU7XG4gICAgfVxuICAgIGdldCBlbmQoKSB7XG4gICAgICAgIGlmICghdGhpcy5lbmREYXRlKSB7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdG9VVENEYXRlKHRoaXMuZW5kRGF0ZSk7XG4gICAgfVxuICAgIGdldCBkYXlTbG90KCkge1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG59XG5EYXlTbG90RGlyZWN0aXZlLmRlY29yYXRvcnMgPSBbXG4gICAgeyB0eXBlOiBEaXJlY3RpdmUsIGFyZ3M6IFt7XG4gICAgICAgICAgICAgICAgLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOmRpcmVjdGl2ZS1zZWxlY3RvclxuICAgICAgICAgICAgICAgIHNlbGVjdG9yOiAnW2RheVNsb3RdJ1xuICAgICAgICAgICAgfSxdIH0sXG5dO1xuLyoqIEBub2NvbGxhcHNlICovXG5EYXlTbG90RGlyZWN0aXZlLmN0b3JQYXJhbWV0ZXJzID0gKCkgPT4gW1xuICAgIHsgdHlwZTogRWxlbWVudFJlZiB9LFxuICAgIHsgdHlwZTogRGF5VGltZVNsb3RTZXJ2aWNlIH0sXG4gICAgeyB0eXBlOiBMb2NhbGl6YXRpb25TZXJ2aWNlIH1cbl07XG5EYXlTbG90RGlyZWN0aXZlLnByb3BEZWNvcmF0b3JzID0ge1xuICAgIHN0YXJ0OiBbeyB0eXBlOiBJbnB1dCB9XSxcbiAgICBlbmQ6IFt7IHR5cGU6IElucHV0IH1dLFxuICAgIGRheVNsb3Q6IFt7IHR5cGU6IEhvc3RCaW5kaW5nLCBhcmdzOiBbJ2F0dHIuZGF0YS1kYXktc2xvdCcsXSB9XVxufTtcblxuLyoqXG4gKiBAaGlkZGVuXG4gKi9cbmNsYXNzIERheVRpbWVWaWV3SXRlbUNvbXBvbmVudCBleHRlbmRzIEJhc2VWaWV3SXRlbSB7XG4gICAgY29uc3RydWN0b3IoaW50bFNlcnZpY2UsIHNsb3RTZXJ2aWNlLCBsb2NhbGl6YXRpb24sIGZvY3VzU2VydmljZSwgZWxlbWVudCwgcmVuZGVyZXIsIGxvY2FsZUlkKSB7XG4gICAgICAgIHN1cGVyKHNsb3RTZXJ2aWNlLCBsb2NhbGl6YXRpb24sIGZvY3VzU2VydmljZSwgZWxlbWVudCwgcmVuZGVyZXIsIGxvY2FsZUlkKTtcbiAgICAgICAgdGhpcy5pbnRsU2VydmljZSA9IGludGxTZXJ2aWNlO1xuICAgICAgICB0aGlzLmxvY2FsZUlkID0gbG9jYWxlSWQ7XG4gICAgfVxuICAgIGdldCBldmVudFRpbWUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmludGxTZXJ2aWNlLmZvcm1hdCgnezA6dH3igJN7MTp0fScsIHRvTG9jYWxEYXRlKHRoaXMuaXRlbS5zdGFydFRpbWUpLCB0b0xvY2FsRGF0ZSh0aGlzLml0ZW0uZW5kVGltZSkpO1xuICAgIH1cbn1cbkRheVRpbWVWaWV3SXRlbUNvbXBvbmVudC5kZWNvcmF0b3JzID0gW1xuICAgIHsgdHlwZTogQ29tcG9uZW50LCBhcmdzOiBbe1xuICAgICAgICAgICAgICAgIC8vIHRzbGludDpkaXNhYmxlLW5leHQtbGluZTpjb21wb25lbnQtc2VsZWN0b3JcbiAgICAgICAgICAgICAgICBzZWxlY3RvcjogJ1tkYXlUaW1lVmlld0l0ZW1dJyxcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZTogYFxuICAgICAgICA8c3BhbiBjbGFzcz1cImstZXZlbnQtYWN0aW9uc1wiPlxuICAgICAgICAgICAgPHNwYW4gY2xhc3M9XCJrLWljb24gay1pLWFycm93LTYwLWxlZnRcIiAqbmdJZj1cIml0ZW0udGFpbCAmJiAhdmVydGljYWxcIj48L3NwYW4+XG4gICAgICAgICAgICA8c3BhbiBjbGFzcz1cImstaWNvbiBrLWktcmVsb2FkXCIgKm5nSWY9XCJpc1JlY3VycmVuY2VcIj48L3NwYW4+XG4gICAgICAgICAgICA8c3BhbiBjbGFzcz1cImstaWNvbiBrLWktbm9uLXJlY3VycmVuY2VcIiAqbmdJZj1cImlzUmVjdXJyZW5jZUV4Y2VwdGlvblwiPjwvc3Bhbj5cbiAgICAgICAgPC9zcGFuPlxuICAgICAgICA8bmctY29udGFpbmVyICpuZ0lmPVwiZXZlbnRUZW1wbGF0ZVwiIFtuZ1RlbXBsYXRlT3V0bGV0XT1cImV2ZW50VGVtcGxhdGVcIlxuICAgICAgICAgICAgW25nVGVtcGxhdGVPdXRsZXRDb250ZXh0XT1cInsgJGltcGxpY2l0OiBpdGVtLmV2ZW50LCBldmVudDogaXRlbS5ldmVudCwgcmVzb3VyY2VzOiByZXNvdXJjZXMgfVwiPlxuICAgICAgICA8L25nLWNvbnRhaW5lcj5cbiAgICAgICAgPGRpdiAqbmdJZj1cIiFldmVudFRlbXBsYXRlXCIgW2F0dHIudGl0bGVdPVwiZXZlbnRUaXRsZVwiPlxuICAgICAgICAgICAgPGRpdiBjbGFzcz1cImstZXZlbnQtdGVtcGxhdGUgay1ldmVudC10aW1lXCIgKm5nSWY9XCIhaXNBbGxEYXlcIj57eyBldmVudFRpbWUgfX08L2Rpdj5cbiAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJrLWV2ZW50LXRlbXBsYXRlXCIgYXJpYS1oaWRkZW49XCJ0cnVlXCI+e3sgaXRlbS5ldmVudC50aXRsZSB9fTwvZGl2PlxuICAgICAgICA8L2Rpdj5cblxuICAgICAgICA8c3BhbiBjbGFzcz1cImstZXZlbnQtYWN0aW9uc1wiPlxuICAgICAgICAgICAgPHNwYW4gKm5nSWY9XCJyZW1vdmFibGVcIiBjbGFzcz1cImstbGluayBrLWV2ZW50LWRlbGV0ZVwiIGFyaWEtaGlkZGVuPVwidHJ1ZVwiIFthdHRyLnRpdGxlXT1cImRlbGV0ZU1lc3NhZ2VcIj5cbiAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz1cImstaWNvbiBrLWktY2xvc2VcIj48L3NwYW4+XG4gICAgICAgICAgICA8L3NwYW4+XG4gICAgICAgICAgICA8c3BhbiBjbGFzcz1cImstaWNvbiBrLWktYXJyb3ctNjAtcmlnaHRcIiAqbmdJZj1cIml0ZW0uaGVhZCAmJiAhdmVydGljYWxcIj48L3NwYW4+XG4gICAgICAgIDwvc3Bhbj5cblxuICAgICAgICA8c3BhbiBjbGFzcz1cImstZXZlbnQtdG9wLWFjdGlvbnNcIiAqbmdJZj1cIml0ZW0udGFpbCAmJiB2ZXJ0aWNhbFwiPlxuICAgICAgICAgICAgPHNwYW4gY2xhc3M9XCJrLWljb24gay1pLWFycm93LTYwLXVwXCI+PC9zcGFuPlxuICAgICAgICA8L3NwYW4+XG5cbiAgICAgICAgPHNwYW4gY2xhc3M9XCJrLWV2ZW50LWJvdHRvbS1hY3Rpb25zXCIgKm5nSWY9XCJpdGVtLmhlYWQgJiYgdmVydGljYWxcIj5cbiAgICAgICAgICAgIDxzcGFuIGNsYXNzPVwiay1pY29uIGstaS1hcnJvdy02MC1kb3duXCI+PC9zcGFuPlxuICAgICAgICA8L3NwYW4+XG5cbiAgICAgICAgPG5nLWNvbnRhaW5lciAqbmdJZj1cInJlc2l6YWJsZSAmJiB2ZXJ0aWNhbFwiPlxuICAgICAgICAgICAgPHNwYW4gY2xhc3M9XCJrLXJlc2l6ZS1oYW5kbGUgay1yZXNpemUtblwiICpuZ0lmPVwiIWl0ZW0udGFpbFwiPjwvc3Bhbj5cbiAgICAgICAgICAgIDxzcGFuIGNsYXNzPVwiay1yZXNpemUtaGFuZGxlIGstcmVzaXplLXNcIiAqbmdJZj1cIiFpdGVtLmhlYWRcIj48L3NwYW4+XG4gICAgICAgIDwvbmctY29udGFpbmVyPlxuXG4gICAgICAgIDxuZy1jb250YWluZXIgKm5nSWY9XCJyZXNpemFibGUgJiYgIXZlcnRpY2FsXCI+XG4gICAgICAgICAgICA8c3BhbiBjbGFzcz1cImstcmVzaXplLWhhbmRsZSBrLXJlc2l6ZS13XCI+PC9zcGFuPlxuICAgICAgICAgICAgPHNwYW4gY2xhc3M9XCJrLXJlc2l6ZS1oYW5kbGUgay1yZXNpemUtZVwiPjwvc3Bhbj5cbiAgICAgICAgPC9uZy1jb250YWluZXI+XG4gICAgYFxuICAgICAgICAgICAgfSxdIH0sXG5dO1xuLyoqIEBub2NvbGxhcHNlICovXG5EYXlUaW1lVmlld0l0ZW1Db21wb25lbnQuY3RvclBhcmFtZXRlcnMgPSAoKSA9PiBbXG4gICAgeyB0eXBlOiBJbnRsU2VydmljZSB9LFxuICAgIHsgdHlwZTogRGF5VGltZVNsb3RTZXJ2aWNlIH0sXG4gICAgeyB0eXBlOiBMb2NhbGl6YXRpb25TZXJ2aWNlIH0sXG4gICAgeyB0eXBlOiBGb2N1c1NlcnZpY2UgfSxcbiAgICB7IHR5cGU6IEVsZW1lbnRSZWYgfSxcbiAgICB7IHR5cGU6IFJlbmRlcmVyMiB9LFxuICAgIHsgdHlwZTogU3RyaW5nLCBkZWNvcmF0b3JzOiBbeyB0eXBlOiBJbmplY3QsIGFyZ3M6IFtMT0NBTEVfSUQsXSB9XSB9XG5dO1xuRGF5VGltZVZpZXdJdGVtQ29tcG9uZW50LnByb3BEZWNvcmF0b3JzID0ge1xuICAgIHZlcnRpY2FsOiBbeyB0eXBlOiBJbnB1dCB9XSxcbiAgICBpc0FsbERheTogW3sgdHlwZTogSW5wdXQgfV1cbn07XG5cbmNvbnN0IERJUkVDVElWRVMgPSBbVGltZVNsb3REaXJlY3RpdmUsIERheVNsb3REaXJlY3RpdmUsIERheVRpbWVWaWV3SXRlbUNvbXBvbmVudF07XG4vKipcbiAqIEBoaWRkZW5cbiAqL1xuY2xhc3MgRGF5VGltZU1vZHVsZSB7XG59XG5EYXlUaW1lTW9kdWxlLmRlY29yYXRvcnMgPSBbXG4gICAgeyB0eXBlOiBOZ01vZHVsZSwgYXJnczogW3tcbiAgICAgICAgICAgICAgICBpbXBvcnRzOiBbQ29tbW9uTW9kdWxlLCBTaGFyZWRNb2R1bGVdLFxuICAgICAgICAgICAgICAgIGV4cG9ydHM6IFtcbiAgICAgICAgICAgICAgICAgICAgRElSRUNUSVZFU1xuICAgICAgICAgICAgICAgIF0sXG4gICAgICAgICAgICAgICAgZGVjbGFyYXRpb25zOiBbXG4gICAgICAgICAgICAgICAgICAgIERJUkVDVElWRVNcbiAgICAgICAgICAgICAgICBdXG4gICAgICAgICAgICB9LF0gfSxcbl07XG5cbmNvbnN0IFBVQkxJQ19ESVJFQ1RJVkVTID0gW1xuICAgIERheVZpZXdDb21wb25lbnQsXG4gICAgTXVsdGlEYXlWaWV3Q29tcG9uZW50LFxuICAgIFdlZWtWaWV3Q29tcG9uZW50LFxuICAgIFdvcmtXZWVrVmlld0NvbXBvbmVudFxuXTtcbi8qKlxuICogQGhpZGRlblxuICovXG5jbGFzcyBNdWx0aURheVZpZXdNb2R1bGUge1xufVxuTXVsdGlEYXlWaWV3TW9kdWxlLmRlY29yYXRvcnMgPSBbXG4gICAgeyB0eXBlOiBOZ01vZHVsZSwgYXJnczogW3tcbiAgICAgICAgICAgICAgICBpbXBvcnRzOiBbXG4gICAgICAgICAgICAgICAgICAgIFZpZXdzU2hhcmVkTW9kdWxlLFxuICAgICAgICAgICAgICAgICAgICBEYXlUaW1lTW9kdWxlXG4gICAgICAgICAgICAgICAgXSxcbiAgICAgICAgICAgICAgICBleHBvcnRzOiBbXG4gICAgICAgICAgICAgICAgICAgIFBVQkxJQ19ESVJFQ1RJVkVTXG4gICAgICAgICAgICAgICAgXSxcbiAgICAgICAgICAgICAgICBkZWNsYXJhdGlvbnM6IFtcbiAgICAgICAgICAgICAgICAgICAgLi4uUFVCTElDX0RJUkVDVElWRVMsXG4gICAgICAgICAgICAgICAgICAgIE11bHRpRGF5Vmlld1JlbmRlcmVyQ29tcG9uZW50XG4gICAgICAgICAgICAgICAgXVxuICAgICAgICAgICAgfSxdIH0sXG5dO1xuXG4vLyB0c2xpbnQ6ZGlzYWJsZTpuby1pbnB1dC1yZW5hbWVcbi8qKlxuICogQSBkaXJlY3RpdmUgc2VsZWN0b3IgZm9yIGEgY3VzdG9tIFNjaGVkdWxlciB2aWV3XG4gKi9cbmNsYXNzIFNjaGVkdWxlclZpZXdEaXJlY3RpdmUgZXh0ZW5kcyBTY2hlZHVsZXJWaWV3IHtcbiAgICBjb25zdHJ1Y3Rvcih0ZW1wbGF0ZSkge1xuICAgICAgICBzdXBlcigpO1xuICAgICAgICB0aGlzLnRlbXBsYXRlID0gdGVtcGxhdGU7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFRoZSBpbnZhcmlhbnQgbmFtZSBmb3IgdGhpcyB2aWV3LiBGb3IgZXhhbXBsZSwgYGRheWAuXG4gICAgICogSWYgbm90IHNldCwgdGhlIG5hbWUgd2lsbCBiZSB0aGUgc2FtZSBhcyB0aGUgdGl0bGUuXG4gICAgICovXG4gICAgZ2V0IG5hbWUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9uYW1lIHx8IHRoaXMudGl0bGU7XG4gICAgfVxuICAgIHNldCBuYW1lKHZhbHVlKSB7XG4gICAgICAgIHRoaXMuX25hbWUgPSB2YWx1ZTtcbiAgICB9XG59XG5TY2hlZHVsZXJWaWV3RGlyZWN0aXZlLmRlY29yYXRvcnMgPSBbXG4gICAgeyB0eXBlOiBEaXJlY3RpdmUsIGFyZ3M6IFt7XG4gICAgICAgICAgICAgICAgcHJvdmlkZXJzOiBbe1xuICAgICAgICAgICAgICAgICAgICAgICAgcHJvdmlkZTogU2NoZWR1bGVyVmlldyxcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHRzbGludDpkaXNhYmxlLW5leHQtbGluZTpuby1mb3J3YXJkLXJlZlxuICAgICAgICAgICAgICAgICAgICAgICAgdXNlRXhpc3Rpbmc6IGZvcndhcmRSZWYoKCkgPT4gU2NoZWR1bGVyVmlld0RpcmVjdGl2ZSlcbiAgICAgICAgICAgICAgICAgICAgfV0sXG4gICAgICAgICAgICAgICAgc2VsZWN0b3I6ICdba2VuZG9TY2hlZHVsZXJWaWV3XSdcbiAgICAgICAgICAgIH0sXSB9LFxuXTtcbi8qKiBAbm9jb2xsYXBzZSAqL1xuU2NoZWR1bGVyVmlld0RpcmVjdGl2ZS5jdG9yUGFyYW1ldGVycyA9ICgpID0+IFtcbiAgICB7IHR5cGU6IFRlbXBsYXRlUmVmIH1cbl07XG5TY2hlZHVsZXJWaWV3RGlyZWN0aXZlLnByb3BEZWNvcmF0b3JzID0ge1xuICAgIHRpdGxlOiBbeyB0eXBlOiBJbnB1dCwgYXJnczogWydrZW5kb1NjaGVkdWxlclZpZXcnLF0gfV0sXG4gICAgbmFtZTogW3sgdHlwZTogSW5wdXQsIGFyZ3M6IFsna2VuZG9TY2hlZHVsZXJWaWV3TmFtZScsXSB9XVxufTtcblxuLyoqXG4gKiBAaGlkZGVuXG4gKi9cbmNvbnN0IGNyZWF0ZVRhc2tzJDIgPSAocGVyaW9kU3RhcnQsIHBlcmlvZEVuZCwgaXRlbXMpID0+IHtcbiAgICBjb25zdCB0YXNrcyA9IFtdO1xuICAgIGNvbnN0IHV0Y1N0YXJ0ID0gdG9VVENEYXRlKHBlcmlvZFN0YXJ0KTtcbiAgICBjb25zdCB1dGNFbmQgPSB0b1VUQ0RhdGUocGVyaW9kRW5kKTtcbiAgICBmb3IgKGxldCBpbmRleCA9IDA7IGluZGV4IDwgaXRlbXMubGVuZ3RoOyBpbmRleCsrKSB7XG4gICAgICAgIGNvbnN0IGl0ZW0gPSBpdGVtc1tpbmRleF07XG4gICAgICAgIGNvbnN0IGV2ZW50ID0gaXRlbS5ldmVudDtcbiAgICAgICAgY29uc3QgdGFzayA9IHtcbiAgICAgICAgICAgIGluZGV4LFxuICAgICAgICAgICAgc3RhcnQ6IGl0ZW0uc3RhcnQsXG4gICAgICAgICAgICBlbmQ6IGl0ZW0uZW5kLFxuICAgICAgICAgICAgZXZlbnQ6IGV2ZW50LFxuICAgICAgICAgICAgaXNBbGxEYXk6IGZhbHNlXG4gICAgICAgIH07XG4gICAgICAgIGNvbnN0IGVuZFRpbWUgPSBldmVudC5pc0FsbERheSA/IHJvdW5kQWxsRGF5RW5kKGl0ZW0pIDogdGFzay5lbmQ7XG4gICAgICAgIGNvbnN0IHN0YXJ0VGltZSA9IGV2ZW50LmlzQWxsRGF5ID8gdGFzay5zdGFydC5zdHJpcFRpbWUoKSA6IHRhc2suc3RhcnQ7XG4gICAgICAgIHRhc2suc3RhcnRUaW1lID0gc3RhcnRUaW1lLnRvVVRDRGF0ZSgpO1xuICAgICAgICB0YXNrLmVuZFRpbWUgPSBlbmRUaW1lLnRvVVRDRGF0ZSgpO1xuICAgICAgICBpZiAoaW50ZXJzZWN0cyh0YXNrLnN0YXJ0VGltZSwgdGFzay5lbmRUaW1lLCB1dGNTdGFydCwgdXRjRW5kKSkge1xuICAgICAgICAgICAgdGFza3MucHVzaCh0YXNrKTtcbiAgICAgICAgICAgIHRhc2suaGVhZCA9IHRhc2suZW5kVGltZSA+IHBlcmlvZEVuZDtcbiAgICAgICAgICAgIHRhc2sudGFpbCA9IHRhc2suc3RhcnRUaW1lIDwgcGVyaW9kU3RhcnQ7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHRhc2tzO1xufTtcblxuLyoqXG4gKiBAaGlkZGVuXG4gKi9cbmNsYXNzIFRpbWVsaW5lTXVsdGlEYXlWaWV3Q29tcG9uZW50IGV4dGVuZHMgRGF5VGltZVZpZXdDb21wb25lbnQge1xuICAgIGNvbnN0cnVjdG9yKGxvY2FsaXphdGlvbiwgY2hhbmdlRGV0ZWN0b3IsIHZpZXdDb250ZXh0LCB2aWV3U3RhdGUsIGludGwsIHNsb3RTZXJ2aWNlLCB6b25lLCByZW5kZXJlciwgZWxlbWVudCwgcGRmU2VydmljZSkge1xuICAgICAgICBzdXBlcihjaGFuZ2VEZXRlY3Rvciwgdmlld0NvbnRleHQsIHZpZXdTdGF0ZSwgaW50bCwgc2xvdFNlcnZpY2UsIHpvbmUsIHJlbmRlcmVyLCBlbGVtZW50LCBwZGZTZXJ2aWNlLCBsb2NhbGl6YXRpb24pO1xuICAgICAgICB0aGlzLm5hbWUgPSAndGltZWxpbmUnO1xuICAgICAgICB0aGlzLmNvbHVtbldpZHRoID0gMTAwO1xuICAgICAgICB0aGlzLnZpZXdOYW1lID0gJ3RpbWVsaW5lJztcbiAgICAgICAgdGhpcy52ZXJ0aWNhbFRpbWUgPSBmYWxzZTtcbiAgICB9XG4gICAgZ2V0IGNsYXNzTmFtZXMoKSB7XG4gICAgICAgIHJldHVybiBgay1zY2hlZHVsZXItJHt0aGlzLnZpZXdOYW1lfS12aWV3YDtcbiAgICB9XG4gICAgbmdPbkNoYW5nZXMoY2hhbmdlcykge1xuICAgICAgICBpZiAoY2hhbmdlcy5jb2x1bW5XaWR0aCkge1xuICAgICAgICAgICAgdGhpcy5jaGFuZ2VzLm5leHQobnVsbCk7XG4gICAgICAgIH1cbiAgICAgICAgc3VwZXIubmdPbkNoYW5nZXMoY2hhbmdlcyk7XG4gICAgfVxuICAgIHJlZmxvdygpIHtcbiAgICAgICAgY29uc3Qgc2xvdFNlcnZpY2UgPSB0aGlzLnNsb3RTZXJ2aWNlO1xuICAgICAgICB0aGlzLnVwZGF0ZUNvbnRlbnRIZWlnaHQoKTtcbiAgICAgICAgc2xvdFNlcnZpY2UuY29udGFpbmVyU2l6ZSA9IHRoaXMuY29udGVudC5uYXRpdmVFbGVtZW50LnNjcm9sbFdpZHRoO1xuICAgICAgICBjb25zdCB2ZXJ0aWNhbFJlc291cmNlUm93cyA9IHRoaXMudmVydGljYWxSZXNvdXJjZXMubGVuZ3RoID8gdGhpcy52ZXJ0aWNhbFJlc291cmNlUm93cy50b0FycmF5KCkgOiBbXTtcbiAgICAgICAgc2xvdFNlcnZpY2UubGF5b3V0VGltZWxpbmUodGhpcy5ldmVudEhlaWdodCwgdmVydGljYWxSZXNvdXJjZVJvd3MpO1xuICAgICAgICBpZiAodmVydGljYWxSZXNvdXJjZVJvd3MubGVuZ3RoKSB7XG4gICAgICAgICAgICBzbG90U2VydmljZS5mb3JFYWNoR3JvdXAoKGdyb3VwLCBpbmRleCkgPT4ge1xuICAgICAgICAgICAgICAgIHZlcnRpY2FsUmVzb3VyY2VSb3dzW2luZGV4XS5uYXRpdmVFbGVtZW50LnN0eWxlLmhlaWdodCA9IGAke2dyb3VwLnRpbWVSYW5nZXNbMF0uc2xvdHNbMF0uaGVpZ2h0fXB4YDtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuc3luY1RhYmxlcygpO1xuICAgIH1cbiAgICBnZXQgYWxsRXZlbnRzTWVzc2FnZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubG9jYWxpemF0aW9uLmdldCgnYWxsRXZlbnRzJyk7XG4gICAgfVxuICAgIGdldCBzbG90c0NvdW50KCkge1xuICAgICAgICBjb25zdCByZXNvdXJjZXMgPSB0aGlzLmhvcml6b250YWxSZXNvdXJjZXM7XG4gICAgICAgIGxldCByZXN1bHQgPSB0aGlzLmRheVNsb3RzLmxlbmd0aCAqIHRoaXMudGltZVNsb3RzLmxlbmd0aDtcbiAgICAgICAgZm9yIChsZXQgaWR4ID0gMDsgaWR4IDwgcmVzb3VyY2VzLmxlbmd0aDsgaWR4KyspIHtcbiAgICAgICAgICAgIHJlc3VsdCAqPSAocmVzb3VyY2VzW2lkeF0uZGF0YSB8fCBbXSkubGVuZ3RoIHx8IDE7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9XG4gICAgdGltZUNvbHNwYW4oaW5kZXgpIHtcbiAgICAgICAgY29uc3QgdGltZVNsb3RzID0gdGhpcy50aW1lU2xvdHMubGVuZ3RoO1xuICAgICAgICBjb25zdCByZW1haW5kZXIgPSB0aW1lU2xvdHMgJSB0aGlzLnNsb3REaXZpc2lvbnM7XG4gICAgICAgIHJldHVybiByZW1haW5kZXIgPT09IDAgfHwgKGluZGV4IDwgdGltZVNsb3RzIC0gcmVtYWluZGVyKSA/IHRoaXMuc2xvdERpdmlzaW9ucyA6IDE7XG4gICAgfVxuICAgIGhvcml6b250YWxDb2xzcGFuKHJlc291cmNlSW5kZXgpIHtcbiAgICAgICAgY29uc3QgcmVzb3VyY2VzID0gdGhpcy5ob3Jpem9udGFsUmVzb3VyY2VzO1xuICAgICAgICBsZXQgcmVzdWx0ID0gdGhpcy5kYXlTbG90cy5sZW5ndGggKiB0aGlzLnRpbWVTbG90cy5sZW5ndGg7XG4gICAgICAgIGZvciAobGV0IGlkeCA9IHJlc291cmNlSW5kZXggKyAxOyBpZHggPCByZXNvdXJjZXMubGVuZ3RoOyBpZHgrKykge1xuICAgICAgICAgICAgcmVzdWx0ICo9IChyZXNvdXJjZXNbaWR4XS5kYXRhIHx8IFtdKS5sZW5ndGggfHwgMTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH1cbiAgICB2ZXJ0aWNhbFJvd3NwYW4ocmVzb3VyY2VJbmRleCkge1xuICAgICAgICBjb25zdCByZXNvdXJjZXMgPSB0aGlzLnZlcnRpY2FsUmVzb3VyY2VzO1xuICAgICAgICBsZXQgcmVzdWx0ID0gMTtcbiAgICAgICAgZm9yIChsZXQgaWR4ID0gcmVzb3VyY2VJbmRleCArIDE7IGlkeCA8IHJlc291cmNlcy5sZW5ndGg7IGlkeCsrKSB7XG4gICAgICAgICAgICByZXN1bHQgKj0gKHJlc291cmNlc1tpZHhdLmRhdGEgfHwgW10pLmxlbmd0aCB8fCAxO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfVxuICAgIGNyZWF0ZVRhc2tzKGl0ZW1zLCBkYXRlUmFuZ2UpIHtcbiAgICAgICAgcmV0dXJuIGNyZWF0ZVRhc2tzJDIoZGF0ZVJhbmdlLnN0YXJ0LCBkYXRlUmFuZ2UuZW5kLCBpdGVtcyk7XG4gICAgfVxuICAgIG9uVGFza3NDaGFuZ2UoKSB7XG4gICAgICAgIHRoaXMuaXRlbXMubmV4dCh0aGlzLnRhc2tzKTtcbiAgICB9XG4gICAgZHJhZ1JhbmdlcyhzbG90KSB7XG4gICAgICAgIHJldHVybiB0aGlzLnNsb3RTZXJ2aWNlLmRyYWdSYW5nZXMoc2xvdCwgdGhpcy5kcmFnZ2luZy5vZmZzZXQsIHRydWUpO1xuICAgIH1cbiAgICBkcmFnSGludFNpemUoZmlyc3RTbG90LCBsYXN0U2xvdCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgd2lkdGg6IHRvUHgobGFzdFNsb3QucmVjdC5sZWZ0IC0gZmlyc3RTbG90LnJlY3QubGVmdCArIGxhc3RTbG90LnJlY3Qud2lkdGgpLFxuICAgICAgICAgICAgaGVpZ2h0OiB0b1B4KGZpcnN0U2xvdC5oZWlnaHQpXG4gICAgICAgIH07XG4gICAgfVxuICAgIHVwZGF0ZVJlc2l6ZUhpbnRzKHJhbmdlcywgc3RhcnQsIGVuZCkge1xuICAgICAgICBjb25zdCBsYXN0ID0gcmFuZ2VzW3Jhbmdlcy5sZW5ndGggLSAxXTtcbiAgICAgICAgc3VwZXIudXBkYXRlUmVzaXplSGludHMoW1tyYW5nZXNbMF1bMF0sIGxhc3RbbGFzdC5sZW5ndGggLSAxXV1dLCBzdGFydCwgZW5kKTtcbiAgICB9XG4gICAgcGRmV2lkdGgoKSB7XG4gICAgICAgIGNvbnN0IGNvbnRlbnRXaWR0aCA9IHRoaXMuY29udGVudC5uYXRpdmVFbGVtZW50LnNjcm9sbFdpZHRoO1xuICAgICAgICBjb25zdCB0aW1lc1dpZHRoID0gdGhpcy50aW1lcy5uYXRpdmVFbGVtZW50Lm9mZnNldFdpZHRoO1xuICAgICAgICByZXR1cm4gY29udGVudFdpZHRoICsgdGltZXNXaWR0aDtcbiAgICB9XG4gICAgY3VycmVudFRpbWVBcnJvd09mZnNldCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuaGVhZGVyV3JhcC5uYXRpdmVFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJ3RyOmxhc3QtY2hpbGQnKS5vZmZzZXRUb3A7XG4gICAgfVxufVxuVGltZWxpbmVNdWx0aURheVZpZXdDb21wb25lbnQuZGVjb3JhdG9ycyA9IFtcbiAgICB7IHR5cGU6IENvbXBvbmVudCwgYXJnczogW3tcbiAgICAgICAgICAgICAgICAvLyB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmU6Y29tcG9uZW50LXNlbGVjdG9yXG4gICAgICAgICAgICAgICAgc2VsZWN0b3I6ICd0aW1lbGluZS1tdWx0aS1kYXktdmlldycsXG4gICAgICAgICAgICAgICAgcHJvdmlkZXJzOiBbXG4gICAgICAgICAgICAgICAgICAgIERheVRpbWVTbG90U2VydmljZVxuICAgICAgICAgICAgICAgIF0sXG4gICAgICAgICAgICAgICAgdGVtcGxhdGU6IGBcbiAgICAgICAgPGRpdiBjbGFzcz1cImstc2NoZWR1bGVyLWxheW91dCBrLXNjaGVkdWxlci1mbGV4LWxheW91dFwiIFtuZ0NsYXNzXT1cImNsYXNzTmFtZXNcIj5cbiAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJrLXNjaGVkdWxlci1wYW5lXCI+XG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cImstc2NoZWR1bGVyLXRpbWVzXCIgI3RpbWVzSGVhZGVyPlxuICAgICAgICAgICAgICAgICAgICA8dGFibGUgY2xhc3M9XCJrLXNjaGVkdWxlci10YWJsZVwiIGFyaWEtaGlkZGVuPVwidHJ1ZVwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgPHRyPjx0aD48L3RoPjwvdHI+XG4gICAgICAgICAgICAgICAgICAgICAgICA8dHI+PHRoIGNsYXNzPVwiay1zbG90LWNlbGxcIj48L3RoPjwvdHI+XG4gICAgICAgICAgICAgICAgICAgICAgICA8dHIgKm5nRm9yPVwibGV0IHJlc291cmNlIG9mIGhvcml6b250YWxSZXNvdXJjZXM7IHRyYWNrQnk6IGl0ZW1JbmRleDtcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGg+PC90aD5cbiAgICAgICAgICAgICAgICAgICAgICAgIDwvdHI+XG4gICAgICAgICAgICAgICAgICAgIDwvdGFibGU+XG4gICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cImstc2NoZWR1bGVyLWhlYWRlciBrLXN0YXRlLWRlZmF1bHRcIiAjaGVhZGVyID5cbiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cImstc2NoZWR1bGVyLWhlYWRlci13cmFwXCIgI2hlYWRlcldyYXA+XG4gICAgICAgICAgICAgICAgICAgICAgICA8bmctY29udGFpbmVyICpuZ0lmPVwic2hvd0N1cnJlbnRUaW1lXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiAqbmdGb3I9XCJsZXQgcmVzb3VyY2Ugb2YgaG9yaXpvbnRhbFJlc291cmNlcyB8IHJlc291cmNlSXRlcmF0b3I7IHRyYWNrQnk6IGl0ZW1JbmRleDtcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAjY3VycmVudFRpbWVBcnJvdyBjbGFzcz1cImstY3VycmVudC10aW1lIGstY3VycmVudC10aW1lLWFycm93LWRvd25cIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgICAgIDwvbmctY29udGFpbmVyPlxuICAgICAgICAgICAgICAgICAgICAgICAgPHRhYmxlIGNsYXNzPVwiay1zY2hlZHVsZXItdGFibGVcIiBhcmlhLWhpZGRlbj1cInRydWVcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8Y29sZ3JvdXA+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxjb2wgKm5nRm9yPVwibGV0IHNsb3RJbmRleCBvZiBzbG90c0NvdW50IHwgcmVwZWF0OyB0cmFja0J5OiBpdGVtSW5kZXg7XCIgW25nU3R5bGVdPVwieyAnd2lkdGgucHgnOiBjb2x1bW5XaWR0aCB9XCIgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2NvbGdyb3VwPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0ciAqbmdGb3I9XCJsZXQgcmVzb3VyY2Ugb2YgaG9yaXpvbnRhbFJlc291cmNlczsgbGV0IHJlc291cmNlSW5kZXggPSBpbmRleDsgdHJhY2tCeTogaXRlbUluZGV4O1wiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGggKm5nRm9yPVwibGV0IGl0ZW0gb2YgaG9yaXpvbnRhbFJlc291cmNlcyB8IHJlc291cmNlSXRlcmF0b3IgOiByZXNvdXJjZUluZGV4OyB0cmFja0J5OiBpdGVtSW5kZXg7XCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzPVwiay1zbG90LWNlbGxcIiBbYXR0ci5jb2xzcGFuXT1cImhvcml6b250YWxDb2xzcGFuKHJlc291cmNlSW5kZXgpXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8bmctY29udGFpbmVyICpuZ0lmPVwiIWdyb3VwSGVhZGVyVGVtcGxhdGVSZWZcIj57eyBnZXRGaWVsZChpdGVtLCByZXNvdXJjZS50ZXh0RmllbGQpIH19PC9uZy1jb250YWluZXI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8bmctY29udGFpbmVyICpuZ0lmPVwiZ3JvdXBIZWFkZXJUZW1wbGF0ZVJlZlwiIFtuZ1RlbXBsYXRlT3V0bGV0XT1cImdyb3VwSGVhZGVyVGVtcGxhdGVSZWZcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFtuZ1RlbXBsYXRlT3V0bGV0Q29udGV4dF09XCJ7IHJlc291cmNlOiBpdGVtIH1cIj48L25nLWNvbnRhaW5lcj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC90aD5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3RyPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dHI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8bmctY29udGFpbmVyICpuZ0Zvcj1cImxldCByZXNvdXJjZSBvZiBob3Jpem9udGFsUmVzb3VyY2VzIHwgcmVzb3VyY2VJdGVyYXRvcjsgdHJhY2tCeTogaXRlbUluZGV4O1wiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxuZy1jb250YWluZXIgKm5nRm9yPVwibGV0IGRheVNsb3Qgb2YgZGF5U2xvdHM7IGxldCBpbmRleCA9IGluZGV4OyB0cmFja0J5OiBpdGVtSW5kZXg7XCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0aCBbYXR0ci5jb2xzcGFuXT1cInRpbWVTbG90cy5sZW5ndGhcIiBjbGFzcz1cImstc2xvdC1jZWxsXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8c3BhbiAqbmdJZj1cIiFkYXRlSGVhZGVyVGVtcGxhdGVSZWZcIiBjbGFzcz1cImstbGlua1wiIFtuZ0NsYXNzXT1cInsgJ2stbmF2LWRheSc6IG51bWJlck9mRGF5cyA+IDEgfVwiIFthdHRyLmRhdGEtZGF5c2xvdC1pbmRleF09XCJpbmRleFwiPnt7IGRheVNsb3Quc3RhcnQgfCBrZW5kb0RhdGU6ICdtJ319PC9zcGFuPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPG5nLWNvbnRhaW5lciAqbmdJZj1cImRhdGVIZWFkZXJUZW1wbGF0ZVJlZlwiIFtuZ1RlbXBsYXRlT3V0bGV0XT1cImRhdGVIZWFkZXJUZW1wbGF0ZVJlZlwiIFtuZ1RlbXBsYXRlT3V0bGV0Q29udGV4dF09XCJ7IGRhdGU6IGRheVNsb3Quc3RhcnQgfVwiPjwvbmctY29udGFpbmVyPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3RoPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvbmctY29udGFpbmVyPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9uZy1jb250YWluZXI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvdHI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0cj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxuZy1jb250YWluZXIgKm5nRm9yPVwibGV0IHJlc291cmNlIG9mIGhvcml6b250YWxSZXNvdXJjZXMgfCByZXNvdXJjZUl0ZXJhdG9yOyBsZXQgcmVzb3VyY2VJbmRleCA9IGluZGV4OyB0cmFja0J5OiBpdGVtSW5kZXg7XCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8bmctY29udGFpbmVyICpuZ0Zvcj1cImxldCBkYXlTbG90IG9mIGRheVNsb3RzOyBsZXQgcmFuZ2VJbmRleCA9IGluZGV4OyB0cmFja0J5OiBpdGVtSW5kZXg7XCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPG5nLWNvbnRhaW5lciAqbmdGb3I9XCJsZXQgdGltZVNsb3Qgb2YgdGltZVNsb3RzOyBsZXQgaW5kZXggPSBpbmRleDsgdHJhY2tCeTogaXRlbUluZGV4O1wiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGggKm5nSWY9XCJ0aW1lU2xvdC5pc01ham9yXCIgW2F0dHIuY29sc3Bhbl09XCJ0aW1lQ29sc3BhbihpbmRleClcIiA+e3sgdGltZVNsb3Quc3RhcnQgfCBrZW5kb0RhdGU6ICd0JyB9fTwvdGg+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9uZy1jb250YWluZXI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L25nLWNvbnRhaW5lcj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvbmctY29udGFpbmVyPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3RyPlxuICAgICAgICAgICAgICAgICAgICAgICAgPC90YWJsZT5cbiAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJrLXNjaGVkdWxlci1wYW5lXCI+XG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cImstc2NoZWR1bGVyLXRpbWVzXCIgI3RpbWVzPlxuICAgICAgICAgICAgICAgICAgICA8dGFibGUgY2xhc3M9XCJrLXNjaGVkdWxlci10YWJsZVwiICN0aW1lc1RhYmxlIGFyaWEtaGlkZGVuPVwidHJ1ZVwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgPHRyICpuZ0lmPVwiIXZlcnRpY2FsUmVzb3VyY2VzLmxlbmd0aFwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0aCByb3dzcGFuPVwiMVwiICN0aXRsZUNlbGw+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHt7IGFsbEV2ZW50c01lc3NhZ2UgfX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3RoPlxuICAgICAgICAgICAgICAgICAgICAgICAgPC90cj5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxuZy1jb250YWluZXIgKm5nSWY9XCJ2ZXJ0aWNhbFJlc291cmNlcy5sZW5ndGhcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8bmctY29udGFpbmVyICpuZ0Zvcj1cImxldCByZXNvdXJjZUl0ZW0gb2YgdmVydGljYWxSZXNvdXJjZXMgfCByZXNvdXJjZUl0ZXJhdG9yOyBsZXQgbGVhZkluZGV4ID0gaW5kZXg7IHRyYWNrQnk6IGl0ZW1JbmRleDtcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRyICN2ZXJ0aWNhbFJlc291cmNlUm93cz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxuZy1jb250YWluZXIgKm5nRm9yPVwibGV0IHJlc291cmNlIG9mIHZlcnRpY2FsUmVzb3VyY2VzOyBsZXQgcmVzb3VyY2VJbmRleCA9IGluZGV4OyB0cmFja0J5OiBpdGVtSW5kZXg7XCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRoICpuZ0lmPVwidmVydGljYWxJdGVtKGxlYWZJbmRleCwgcmVzb3VyY2VJbmRleClcIiBbYXR0ci5yb3dzcGFuXT1cInZlcnRpY2FsUm93c3BhbihyZXNvdXJjZUluZGV4KVwiIGNsYXNzPVwiay1zbG90LWNlbGxcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxuZy1jb250YWluZXIgKm5nSWY9XCIhZ3JvdXBIZWFkZXJUZW1wbGF0ZVJlZlwiPnt7IGdldEZpZWxkKHZlcnRpY2FsSXRlbShsZWFmSW5kZXgsIHJlc291cmNlSW5kZXgpLCByZXNvdXJjZS50ZXh0RmllbGQpIH19PC9uZy1jb250YWluZXI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8bmctY29udGFpbmVyICpuZ0lmPVwiZ3JvdXBIZWFkZXJUZW1wbGF0ZVJlZlwiIFtuZ1RlbXBsYXRlT3V0bGV0XT1cImdyb3VwSGVhZGVyVGVtcGxhdGVSZWZcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFtuZ1RlbXBsYXRlT3V0bGV0Q29udGV4dF09XCJ7IHJlc291cmNlOiB2ZXJ0aWNhbEl0ZW0obGVhZkluZGV4LCByZXNvdXJjZUluZGV4KSB9XCI+PC9uZy1jb250YWluZXI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvdGg+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L25nLWNvbnRhaW5lcj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC90cj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L25nLWNvbnRhaW5lcj5cbiAgICAgICAgICAgICAgICAgICAgICAgIDwvbmctY29udGFpbmVyPlxuICAgICAgICAgICAgICAgICAgICA8L3RhYmxlPlxuICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJrLXNjaGVkdWxlci1jb250ZW50XCIgI2NvbnRlbnQ+XG4gICAgICAgICAgICAgICAgICAgIDxuZy1jb250YWluZXIgKm5nSWY9XCJzaG93Q3VycmVudFRpbWVcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgKm5nRm9yPVwibGV0IHJlc291cmNlIG9mIGhvcml6b250YWxSZXNvdXJjZXMgfCByZXNvdXJjZUl0ZXJhdG9yOyB0cmFja0J5OiBpdGVtSW5kZXg7XCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzcz1cImstY3VycmVudC10aW1lXCIgI2N1cnJlbnRUaW1lTWFya2VyPlxuICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgIDwvbmctY29udGFpbmVyPlxuICAgICAgICAgICAgICAgICAgICA8dGFibGUgY2xhc3M9XCJrLXNjaGVkdWxlci10YWJsZVwiICNjb250ZW50VGFibGUgcm9sZT1cInByZXNlbnRhdGlvblwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgPGNvbGdyb3VwPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxjb2wgKm5nRm9yPVwibGV0IHNsb3RJbmRleCBvZiBzbG90c0NvdW50IHwgcmVwZWF0OyB0cmFja0J5OiBpdGVtSW5kZXg7XCIgW25nU3R5bGVdPVwieyAnd2lkdGgucHgnOiBjb2x1bW5XaWR0aCB9XCIgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgIDwvY29sZ3JvdXA+XG4gICAgICAgICAgICAgICAgICAgICAgICA8dHIgKm5nRm9yPVwibGV0IHJlc291cmNlSXRlbSBvZiB2ZXJ0aWNhbFJlc291cmNlcyB8IHJlc291cmNlSXRlcmF0b3I7IGxldCB2ZXJ0aWNhbEluZGV4ID0gaW5kZXg7IHRyYWNrQnk6IGl0ZW1JbmRleDtcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8bmctY29udGFpbmVyICpuZ0Zvcj1cImxldCByZXNvdXJjZSBvZiBob3Jpem9udGFsUmVzb3VyY2VzIHwgcmVzb3VyY2VJdGVyYXRvcjsgbGV0IGhvcml6b250YWxJbmRleCA9IGluZGV4OyB0cmFja0J5OiBpdGVtSW5kZXg7XCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxuZy1jb250YWluZXIgKm5nRm9yPVwibGV0IGRheVNsb3Qgb2YgZGF5U2xvdHM7IGxldCByYW5nZUluZGV4ID0gaW5kZXg7IHRyYWNrQnk6IGl0ZW1JbmRleDtcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0ZCAqbmdGb3I9XCJsZXQgc2xvdCBvZiB0aW1lU2xvdHM7IGxldCBpbmRleCA9IGluZGV4OyB0cmFja0J5OiBpdGVtSW5kZXg7XCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgW25nQ2xhc3NdPVwidGltZVNsb3RDbGFzcyhzbG90LCBkYXlTbG90LnN0YXJ0LCB2ZXJ0aWNhbFJlc291cmNlcy5sZW5ndGggPyB2ZXJ0aWNhbEluZGV4IDogaG9yaXpvbnRhbEluZGV4KVwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpbWVTbG90ICN0aW1lU2xvdD1cInRpbWVTbG90XCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgW2RhdGVdPVwiZGF5U2xvdC5zdGFydFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFtpbnZhcmlhbnRTdGFydF09XCJzbG90LnN0YXJ0XCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgW2ludmFyaWFudEVuZF09XCJzbG90LmVuZFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFt3b3JrRGF5U3RhcnRdPVwid29ya0RheVN0YXJ0VGltZVwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFt3b3JrRGF5RW5kXT1cIndvcmtEYXlFbmRUaW1lXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgW3dvcmtXZWVrU3RhcnRdPVwid29ya1dlZWtTdGFydFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFt3b3JrV2Vla0VuZF09XCJ3b3JrV2Vla0VuZFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFtpZF09XCJ7IHJlc291cmNlSW5kZXg6IHZlcnRpY2FsUmVzb3VyY2VzLmxlbmd0aCA/IHZlcnRpY2FsSW5kZXggOiBob3Jpem9udGFsSW5kZXgsIHJhbmdlSW5kZXg6IHJhbmdlSW5kZXgsIGluZGV4OiBpbmRleCB9XCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8bmctY29udGFpbmVyICpuZ0lmPVwidGltZVNsb3RUZW1wbGF0ZVJlZlwiIFtuZ1RlbXBsYXRlT3V0bGV0XT1cInRpbWVTbG90VGVtcGxhdGVSZWZcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbbmdUZW1wbGF0ZU91dGxldENvbnRleHRdPVwieyBkYXRlOiB0aW1lU2xvdC5zdGFydCwgcmVzb3VyY2VzOiByZXNvdXJjZXNCeUluZGV4KHRpbWVTbG90LmlkLnJlc291cmNlSW5kZXggKSB9XCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9uZy1jb250YWluZXI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3RkPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L25nLWNvbnRhaW5lcj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L25nLWNvbnRhaW5lcj5cbiAgICAgICAgICAgICAgICAgICAgICAgIDwvdHI+XG4gICAgICAgICAgICAgICAgICAgIDwvdGFibGU+XG4gICAgICAgICAgICAgICAgICAgIDxuZy1jb250YWluZXIgKm5nRm9yPVwibGV0IGl0ZW0gb2YgaXRlbXMgfCBhc3luYzsgdHJhY2tCeTogaXRlbUluZGV4O1wiPlxuICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiAqbmdGb3I9XCJsZXQgaXRlbVJlc291cmNlIG9mIGl0ZW0ucmVzb3VyY2VzOyB0cmFja0J5OiBpdGVtSW5kZXg7XCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbbmdDbGFzc109XCJnZXRFdmVudENsYXNzZXMoaXRlbSwgaXRlbVJlc291cmNlLnJlc291cmNlcylcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFtuZ1N0eWxlXT1cImdldEV2ZW50U3R5bGVzKGl0ZW0sIGl0ZW1SZXNvdXJjZSlcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFtrZW5kb1NjaGVkdWxlckZvY3VzSW5kZXhdPVwiaXRlbVJlc291cmNlLmxlYWZJZHhcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRheVRpbWVWaWV3SXRlbVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbZWRpdGFibGVdPVwiZWRpdGFibGVcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbaXRlbV09XCJpdGVtXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgW2luZGV4XT1cIml0ZW0uaW5kZXhcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbcmFuZ2VJbmRleF09XCJpdGVtLnJhbmdlSW5kZXhcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbZXZlbnRUZW1wbGF0ZV09XCJldmVudFRlbXBsYXRlUmVmXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgW3Jlc291cmNlc109XCJpdGVtUmVzb3VyY2UucmVzb3VyY2VzXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgW3Jlc291cmNlSW5kZXhdPVwiaXRlbVJlc291cmNlLmxlYWZJZHhcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICA8L25nLWNvbnRhaW5lcj5cbiAgICAgICAgICAgICAgICAgICAgPGtlbmRvLWhpbnQtY29udGFpbmVyICNoaW50Q29udGFpbmVyPlxuICAgICAgICAgICAgICAgICAgICAgICAgPG5nLXRlbXBsYXRlPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgKm5nRm9yPVwibGV0IGhpbnQgb2YgZHJhZ0hpbnRzOyB0cmFja0J5OiBpdGVtSW5kZXg7XCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3M9XCJrLWV2ZW50LWRyYWctaGludFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRheVRpbWVWaWV3SXRlbVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgW25nU3R5bGVdPVwiaGludC5zdHlsZVwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbbmdDbGFzc109XCJoaW50LmNsYXNzXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFtkcmFnSGludF09XCJ0cnVlXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFtldmVudFRlbXBsYXRlXT1cImV2ZW50VGVtcGxhdGVSZWZcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgW2l0ZW1dPVwiaGludC5pdGVtXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFtyZXNvdXJjZXNdPVwiaGludC5yZXNvdXJjZXNcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2ICpuZ0lmPVwicmVzaXplSGludHMgJiYgcmVzaXplSGludHMubGVuZ3RoXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAga2VuZG9SZXNpemVIaW50XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFtoaW50XT1cInJlc2l6ZUhpbnRzWzBdXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgW25nQ2xhc3NdPVwicmVzaXplSGludHNbMF0uY2xhc3NcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbZm9ybWF0XT1cInJlc2l6ZUhpbnRGb3JtYXRcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgICAgIDwvbmctdGVtcGxhdGU+XG4gICAgICAgICAgICAgICAgICAgIDwva2VuZG8taGludC1jb250YWluZXI+XG4gICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgPC9kaXY+XG4gICAgYFxuICAgICAgICAgICAgfSxdIH0sXG5dO1xuLyoqIEBub2NvbGxhcHNlICovXG5UaW1lbGluZU11bHRpRGF5Vmlld0NvbXBvbmVudC5jdG9yUGFyYW1ldGVycyA9ICgpID0+IFtcbiAgICB7IHR5cGU6IExvY2FsaXphdGlvblNlcnZpY2UgfSxcbiAgICB7IHR5cGU6IENoYW5nZURldGVjdG9yUmVmIH0sXG4gICAgeyB0eXBlOiBWaWV3Q29udGV4dFNlcnZpY2UgfSxcbiAgICB7IHR5cGU6IFZpZXdTdGF0ZVNlcnZpY2UgfSxcbiAgICB7IHR5cGU6IEludGxTZXJ2aWNlIH0sXG4gICAgeyB0eXBlOiBEYXlUaW1lU2xvdFNlcnZpY2UgfSxcbiAgICB7IHR5cGU6IE5nWm9uZSB9LFxuICAgIHsgdHlwZTogUmVuZGVyZXIyIH0sXG4gICAgeyB0eXBlOiBFbGVtZW50UmVmIH0sXG4gICAgeyB0eXBlOiBQREZTZXJ2aWNlIH1cbl07XG5UaW1lbGluZU11bHRpRGF5Vmlld0NvbXBvbmVudC5wcm9wRGVjb3JhdG9ycyA9IHtcbiAgICBuYW1lOiBbeyB0eXBlOiBJbnB1dCB9XSxcbiAgICBjb2x1bW5XaWR0aDogW3sgdHlwZTogSW5wdXQgfV0sXG4gICAgdmlld05hbWU6IFt7IHR5cGU6IElucHV0IH1dLFxuICAgIHZlcnRpY2FsUmVzb3VyY2VSb3dzOiBbeyB0eXBlOiBWaWV3Q2hpbGRyZW4sIGFyZ3M6IFsndmVydGljYWxSZXNvdXJjZVJvd3MnLF0gfV1cbn07XG5cbmNvbnN0IENPTFVNTl9XSURUSCA9ICdjb2x1bW5XaWR0aCc7XG4vKipcbiAqIEBoaWRkZW5cbiAqL1xuY2xhc3MgVGltZWxpbmVCYXNlIGV4dGVuZHMgRGF5VGltZVZpZXdCYXNlIHtcbiAgICBjb25zdHJ1Y3Rvcihsb2NhbGl6YXRpb24sIGNoYW5nZURldGVjdG9yLCB2aWV3Q29udGV4dCwgdmlld1N0YXRlKSB7XG4gICAgICAgIHN1cGVyKGxvY2FsaXphdGlvbiwgY2hhbmdlRGV0ZWN0b3IsIHZpZXdDb250ZXh0LCB2aWV3U3RhdGUpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBAaGlkZGVuXG4gICAgICovXG4gICAgZ2V0IHZpZXdDb2x1bW5XaWR0aCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMub3B0aW9uVmFsdWUoQ09MVU1OX1dJRFRIKTtcbiAgICB9XG59XG5UaW1lbGluZUJhc2UucHJvcERlY29yYXRvcnMgPSB7XG4gICAgY29sdW1uV2lkdGg6IFt7IHR5cGU6IElucHV0IH1dXG59O1xuXG4vKipcbiAqIFRoZSBjb21wb25lbnQgZm9yIHJlbmRlcmluZyB0aGUgKipUaW1lbGluZSoqIHZpZXcuXG4gKi9cbmNsYXNzIFRpbWVsaW5lVmlld0NvbXBvbmVudCBleHRlbmRzIFRpbWVsaW5lQmFzZSB7XG4gICAgY29uc3RydWN0b3IobG9jYWxpemF0aW9uLCBjaGFuZ2VEZXRlY3Rvciwgdmlld0NvbnRleHQsIHZpZXdTdGF0ZSkge1xuICAgICAgICBzdXBlcihsb2NhbGl6YXRpb24sIGNoYW5nZURldGVjdG9yLCB2aWV3Q29udGV4dCwgdmlld1N0YXRlKTtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRoZSBsb25nLWRhdGUgZm9ybWF0IGZvciBkaXNwbGF5aW5nIHRoZVxuICAgICAgICAgKiBzZWxlY3RlZCBkYXRlIGluIHRoZSBTY2hlZHVsZXIgdG9vbGJhci5cbiAgICAgICAgICogRGVmYXVsdHMgdG8gYHswOkR9YFxuICAgICAgICAgKiAoW21vcmUgaW5mb3JtYXRpb25dKHslIHNsdWcgcGFyc2luZ2FuZGZvcm1hdHRpbmdfaW50bCAlfSN0b2MtZGF0ZS1mb3JtYXR0aW5nKSkuXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLnNlbGVjdGVkRGF0ZUZvcm1hdCA9ICd7MDpEfSc7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBUaGUgc2hvcnQtZGF0ZSBmb3JtYXQgZm9yIGRpc3BsYXlpbmcgdGhlXG4gICAgICAgICAqIHNlbGVjdGVkIGRhdGUgaW4gdGhlIFNjaGVkdWxlciB0b29sYmFyLlxuICAgICAgICAgKiBEZWZhdWx0cyB0byBgezA6RH1gXG4gICAgICAgICAqIChbbW9yZSBpbmZvcm1hdGlvbl0oeyUgc2x1ZyBwYXJzaW5nYW5kZm9ybWF0dGluZ19pbnRsICV9I3RvYy1kYXRlLWZvcm1hdHRpbmcpKS5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuc2VsZWN0ZWRTaG9ydERhdGVGb3JtYXQgPSAnezA6ZH0nO1xuICAgICAgICAvKipcbiAgICAgICAgICogVGhlIGludmFyaWFudCBuYW1lIGZvciB0aGlzIHZpZXcgKGB0aW1lbGluZWApLlxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5uYW1lID0gJ3RpbWVsaW5lJztcbiAgICB9XG4gICAgLyoqXG4gICAgICogQGhpZGRlblxuICAgICAqL1xuICAgIGdldCB0aXRsZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubG9jYWxpemF0aW9uLmdldCgndGltZWxpbmVWaWV3VGl0bGUnKTtcbiAgICB9XG59XG5UaW1lbGluZVZpZXdDb21wb25lbnQuZGVjb3JhdG9ycyA9IFtcbiAgICB7IHR5cGU6IENvbXBvbmVudCwgYXJnczogW3tcbiAgICAgICAgICAgICAgICBjaGFuZ2VEZXRlY3Rpb246IENoYW5nZURldGVjdGlvblN0cmF0ZWd5Lk9uUHVzaCxcbiAgICAgICAgICAgICAgICBzZWxlY3RvcjogJ2tlbmRvLXNjaGVkdWxlci10aW1lbGluZS12aWV3JyxcbiAgICAgICAgICAgICAgICBwcm92aWRlcnM6IFt7XG4gICAgICAgICAgICAgICAgICAgICAgICBwcm92aWRlOiBTY2hlZHVsZXJWaWV3LFxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOm5vLWZvcndhcmQtcmVmXG4gICAgICAgICAgICAgICAgICAgICAgICB1c2VFeGlzdGluZzogZm9yd2FyZFJlZigoKSA9PiBUaW1lbGluZVZpZXdDb21wb25lbnQpXG4gICAgICAgICAgICAgICAgICAgIH1dLFxuICAgICAgICAgICAgICAgIHRlbXBsYXRlOiBgXG4gICAgICAgIDxuZy10ZW1wbGF0ZSAjY29udGVudD5cbiAgICAgICAgICAgIDx0aW1lbGluZS1tdWx0aS1kYXktdmlld1xuICAgICAgICAgICAgICAgIFtuYW1lXT1cIm5hbWVcIlxuICAgICAgICAgICAgICAgIFtldmVudEhlaWdodF09XCJ2aWV3RXZlbnRIZWlnaHRcIlxuICAgICAgICAgICAgICAgIFtjb2x1bW5XaWR0aF09XCJ2aWV3Q29sdW1uV2lkdGhcIlxuICAgICAgICAgICAgICAgIFtjdXJyZW50VGltZU1hcmtlcl09XCJ2aWV3Q3VycmVudFRpbWVNYXJrZXJcIlxuICAgICAgICAgICAgICAgIFtzaG93V29ya0hvdXJzXT1cInNob3VsZFNob3dXb3JrSG91cnNcIlxuICAgICAgICAgICAgICAgIFtzY3JvbGxUaW1lXT1cInZpZXdTY3JvbGxUaW1lXCJcbiAgICAgICAgICAgICAgICBbc3RhcnRUaW1lXT1cInZpZXdTdGFydFRpbWVcIlxuICAgICAgICAgICAgICAgIFtlbmRUaW1lXT1cInZpZXdFbmRUaW1lXCJcbiAgICAgICAgICAgICAgICBbd29ya0RheVN0YXJ0XT1cInZpZXdXb3JrRGF5U3RhcnRcIlxuICAgICAgICAgICAgICAgIFt3b3JrRGF5RW5kXT1cInZpZXdXb3JrRGF5RW5kXCJcbiAgICAgICAgICAgICAgICBbd29ya1dlZWtTdGFydF09XCJ2aWV3V29ya1dlZWtTdGFydFwiXG4gICAgICAgICAgICAgICAgW3dvcmtXZWVrRW5kXT1cInZpZXdXb3JrV2Vla0VuZFwiXG4gICAgICAgICAgICAgICAgW3Nsb3REdXJhdGlvbl09XCJ2aWV3U2xvdER1cmF0aW9uXCJcbiAgICAgICAgICAgICAgICBbc2xvdERpdmlzaW9uc109XCJ2aWV3U2xvdERpdmlzaW9uc1wiXG4gICAgICAgICAgICAgICAgW3Nsb3RDbGFzc109XCJ2aWV3U2xvdENsYXNzXCJcbiAgICAgICAgICAgICAgICBbZXZlbnRDbGFzc109XCJ2aWV3RXZlbnRDbGFzc1wiXG4gICAgICAgICAgICAgICAgW2V2ZW50U3R5bGVzXT1cInZpZXdFdmVudFN0eWxlc1wiXG4gICAgICAgICAgICAgICAgW9C1dmVudFRlbXBsYXRlXT1cImV2ZW50VGVtcGxhdGU/LnRlbXBsYXRlUmVmXCJcbiAgICAgICAgICAgICAgICBbZ3JvdXBIZWFkZXJUZW1wbGF0ZV09XCJncm91cEhlYWRlclRlbXBsYXRlPy50ZW1wbGF0ZVJlZlwiXG4gICAgICAgICAgICAgICAgW3RpbWVTbG90VGVtcGxhdGVdPVwidGltZVNsb3RUZW1wbGF0ZT8udGVtcGxhdGVSZWZcIlxuICAgICAgICAgICAgICAgIFtkYXRlSGVhZGVyVGVtcGxhdGVdPVwiZGF0ZUhlYWRlclRlbXBsYXRlPy50ZW1wbGF0ZVJlZlwiXG4gICAgICAgICAgICAgICAgW3NlbGVjdGVkRGF0ZUZvcm1hdF09XCJzZWxlY3RlZERhdGVGb3JtYXRcIlxuICAgICAgICAgICAgICAgIFtzZWxlY3RlZFNob3J0RGF0ZUZvcm1hdF09XCJzZWxlY3RlZFNob3J0RGF0ZUZvcm1hdFwiPlxuICAgICAgICAgICAgPC90aW1lbGluZS1tdWx0aS1kYXktdmlldz5cbiAgICAgICAgICAgIDxkaXYgdmlld0Zvb3RlciBrZW5kb1dvcmtIb3Vyc0Zvb3RlciBbc2hvd1dvcmtIb3Vyc109XCJzaG91bGRTaG93V29ya0hvdXJzXCIgKGl0ZW1DbGljayk9XCJzaG93V29ya0hvdXJzID0gIXNob3VsZFNob3dXb3JrSG91cnNcIj48L2Rpdj5cbiAgICAgICAgPC9uZy10ZW1wbGF0ZT5cbiAgICBgXG4gICAgICAgICAgICB9LF0gfSxcbl07XG4vKiogQG5vY29sbGFwc2UgKi9cblRpbWVsaW5lVmlld0NvbXBvbmVudC5jdG9yUGFyYW1ldGVycyA9ICgpID0+IFtcbiAgICB7IHR5cGU6IExvY2FsaXphdGlvblNlcnZpY2UgfSxcbiAgICB7IHR5cGU6IENoYW5nZURldGVjdG9yUmVmIH0sXG4gICAgeyB0eXBlOiBWaWV3Q29udGV4dFNlcnZpY2UgfSxcbiAgICB7IHR5cGU6IFZpZXdTdGF0ZVNlcnZpY2UgfVxuXTtcblRpbWVsaW5lVmlld0NvbXBvbmVudC5wcm9wRGVjb3JhdG9ycyA9IHtcbiAgICBzZWxlY3RlZERhdGVGb3JtYXQ6IFt7IHR5cGU6IElucHV0IH1dLFxuICAgIHNlbGVjdGVkU2hvcnREYXRlRm9ybWF0OiBbeyB0eXBlOiBJbnB1dCB9XVxufTtcblxuLyoqXG4gKiBUaGUgY29tcG9uZW50IGZvciByZW5kZXJpbmcgdGhlICoqV2VlayoqIHRpbWVsaW5lIHZpZXcuXG4gKi9cbmNsYXNzIFRpbWVsaW5lV2Vla1ZpZXdDb21wb25lbnQgZXh0ZW5kcyBUaW1lbGluZUJhc2Uge1xuICAgIGNvbnN0cnVjdG9yKGludGwsIGxvY2FsaXphdGlvbiwgY2hhbmdlRGV0ZWN0b3IsIHZpZXdDb250ZXh0LCB2aWV3U3RhdGUpIHtcbiAgICAgICAgc3VwZXIobG9jYWxpemF0aW9uLCBjaGFuZ2VEZXRlY3Rvciwgdmlld0NvbnRleHQsIHZpZXdTdGF0ZSk7XG4gICAgICAgIHRoaXMuaW50bCA9IGludGw7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBUaGUgbG9uZy1kYXRlIGZvcm1hdCB0aGF0IHdpbGwgYmUgdXNlZCBmb3IgZGlzcGxheWluZyB0aGVcbiAgICAgICAgICogc2VsZWN0ZWQgZGF0ZSBpbiB0aGUgU2NoZWR1bGVyIHRvb2xiYXIuXG4gICAgICAgICAqIERlZmF1bHRzIHRvIGB7MDpEfSAtIHsxOkR9YFxuICAgICAgICAgKiB3aGVyZSBgMGAgaXMgdGhlIHN0YXJ0IGFuZCBgMWAgaXMgdGhlIGVuZCBkYXRlXG4gICAgICAgICAqIChbbW9yZSBpbmZvcm1hdGlvbl0oeyUgc2x1ZyBwYXJzaW5nYW5kZm9ybWF0dGluZ19pbnRsICV9I3RvYy1kYXRlLWZvcm1hdHRpbmcpKS5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuc2VsZWN0ZWREYXRlRm9ybWF0ID0gJ3swOkR9IC0gezE6RH0nO1xuICAgICAgICAvKipcbiAgICAgICAgICogVGhlIHNob3J0IGRhdGUgZm9ybWF0IHRoYXQgd2lsbCBiZSB1c2VkIGZvciBkaXNwbGF5aW5nIHRoZVxuICAgICAgICAgKiBzZWxlY3RlZCBkYXRlIGluIHRoZSBTY2hlZHVsZXIgdG9vbGJhci5cbiAgICAgICAgICogRGVmYXVsdHMgdG8gYHswOmR9IC0gezE6ZH1gXG4gICAgICAgICAqIHdoZXJlIGAwYCBpcyB0aGUgc3RhcnQgYW5kIGAxYCBpcyB0aGUgZW5kIGRhdGVcbiAgICAgICAgICogKFttb3JlIGluZm9ybWF0aW9uXSh7JSBzbHVnIHBhcnNpbmdhbmRmb3JtYXR0aW5nX2ludGwgJX0jdG9jLWRhdGUtZm9ybWF0dGluZykpLlxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5zZWxlY3RlZFNob3J0RGF0ZUZvcm1hdCA9ICd7MDpkfSAtIHsxOmR9JztcbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRoZSBpbnZhcmlhbnQgbmFtZSBmb3IgdGhpcyB2aWV3IChgdGltZWxpbmVXZWVrYCkuXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLm5hbWUgPSAndGltZWxpbmVXZWVrJztcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEBoaWRkZW5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuZ2V0U3RhcnREYXRlID0gKHNlbGVjdGVkRGF0ZSkgPT4ge1xuICAgICAgICAgICAgcmV0dXJuIGZpcnN0RGF5SW5XZWVrKGdldERhdGUoc2VsZWN0ZWREYXRlKSwgdGhpcy5pbnRsLmZpcnN0RGF5KCkpO1xuICAgICAgICB9O1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBAaGlkZGVuXG4gICAgICovXG4gICAgZ2V0IHRpdGxlKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5sb2NhbGl6YXRpb24uZ2V0KCd0aW1lbGluZVdlZWtWaWV3VGl0bGUnKTtcbiAgICB9XG59XG5UaW1lbGluZVdlZWtWaWV3Q29tcG9uZW50LmRlY29yYXRvcnMgPSBbXG4gICAgeyB0eXBlOiBDb21wb25lbnQsIGFyZ3M6IFt7XG4gICAgICAgICAgICAgICAgY2hhbmdlRGV0ZWN0aW9uOiBDaGFuZ2VEZXRlY3Rpb25TdHJhdGVneS5PblB1c2gsXG4gICAgICAgICAgICAgICAgc2VsZWN0b3I6ICdrZW5kby1zY2hlZHVsZXItdGltZWxpbmUtd2Vlay12aWV3JyxcbiAgICAgICAgICAgICAgICBwcm92aWRlcnM6IFt7XG4gICAgICAgICAgICAgICAgICAgICAgICBwcm92aWRlOiBTY2hlZHVsZXJWaWV3LFxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOm5vLWZvcndhcmQtcmVmXG4gICAgICAgICAgICAgICAgICAgICAgICB1c2VFeGlzdGluZzogZm9yd2FyZFJlZigoKSA9PiBUaW1lbGluZVdlZWtWaWV3Q29tcG9uZW50KVxuICAgICAgICAgICAgICAgICAgICB9XSxcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZTogYFxuICAgICAgICA8bmctdGVtcGxhdGUgI2NvbnRlbnQ+XG4gICAgICAgICAgICA8dGltZWxpbmUtbXVsdGktZGF5LXZpZXdcbiAgICAgICAgICAgICAgICB2aWV3TmFtZT1cInRpbWVsaW5lLXdlZWtcIlxuICAgICAgICAgICAgICAgIFtuYW1lXT1cIm5hbWVcIlxuICAgICAgICAgICAgICAgIFtudW1iZXJPZkRheXNdPVwiN1wiXG4gICAgICAgICAgICAgICAgW2dldFN0YXJ0RGF0ZV09XCJnZXRTdGFydERhdGVcIlxuICAgICAgICAgICAgICAgIFtldmVudEhlaWdodF09XCJ2aWV3RXZlbnRIZWlnaHRcIlxuICAgICAgICAgICAgICAgIFtjb2x1bW5XaWR0aF09XCJ2aWV3Q29sdW1uV2lkdGhcIlxuICAgICAgICAgICAgICAgIFtjdXJyZW50VGltZU1hcmtlcl09XCJ2aWV3Q3VycmVudFRpbWVNYXJrZXJcIlxuICAgICAgICAgICAgICAgIFtzaG93V29ya0hvdXJzXT1cInNob3VsZFNob3dXb3JrSG91cnNcIlxuICAgICAgICAgICAgICAgIFtzY3JvbGxUaW1lXT1cInZpZXdTY3JvbGxUaW1lXCJcbiAgICAgICAgICAgICAgICBbc3RhcnRUaW1lXT1cInZpZXdTdGFydFRpbWVcIlxuICAgICAgICAgICAgICAgIFtlbmRUaW1lXT1cInZpZXdFbmRUaW1lXCJcbiAgICAgICAgICAgICAgICBbd29ya0RheVN0YXJ0XT1cInZpZXdXb3JrRGF5U3RhcnRcIlxuICAgICAgICAgICAgICAgIFt3b3JrRGF5RW5kXT1cInZpZXdXb3JrRGF5RW5kXCJcbiAgICAgICAgICAgICAgICBbd29ya1dlZWtTdGFydF09XCJ2aWV3V29ya1dlZWtTdGFydFwiXG4gICAgICAgICAgICAgICAgW3dvcmtXZWVrRW5kXT1cInZpZXdXb3JrV2Vla0VuZFwiXG4gICAgICAgICAgICAgICAgW3Nsb3REdXJhdGlvbl09XCJ2aWV3U2xvdER1cmF0aW9uXCJcbiAgICAgICAgICAgICAgICBbc2xvdERpdmlzaW9uc109XCJ2aWV3U2xvdERpdmlzaW9uc1wiXG4gICAgICAgICAgICAgICAgW3Nsb3RDbGFzc109XCJ2aWV3U2xvdENsYXNzXCJcbiAgICAgICAgICAgICAgICBbZXZlbnRDbGFzc109XCJ2aWV3RXZlbnRDbGFzc1wiXG4gICAgICAgICAgICAgICAgW2V2ZW50U3R5bGVzXT1cInZpZXdFdmVudFN0eWxlc1wiXG4gICAgICAgICAgICAgICAgW9C1dmVudFRlbXBsYXRlXT1cImV2ZW50VGVtcGxhdGU/LnRlbXBsYXRlUmVmXCJcbiAgICAgICAgICAgICAgICBbZ3JvdXBIZWFkZXJUZW1wbGF0ZV09XCJncm91cEhlYWRlclRlbXBsYXRlPy50ZW1wbGF0ZVJlZlwiXG4gICAgICAgICAgICAgICAgW3RpbWVTbG90VGVtcGxhdGVdPVwidGltZVNsb3RUZW1wbGF0ZT8udGVtcGxhdGVSZWZcIlxuICAgICAgICAgICAgICAgIFtkYXRlSGVhZGVyVGVtcGxhdGVdPVwiZGF0ZUhlYWRlclRlbXBsYXRlPy50ZW1wbGF0ZVJlZlwiXG4gICAgICAgICAgICAgICAgW3NlbGVjdGVkRGF0ZUZvcm1hdF09XCJzZWxlY3RlZERhdGVGb3JtYXRcIlxuICAgICAgICAgICAgICAgIFtzZWxlY3RlZFNob3J0RGF0ZUZvcm1hdF09XCJzZWxlY3RlZFNob3J0RGF0ZUZvcm1hdFwiPlxuICAgICAgICAgICAgPC90aW1lbGluZS1tdWx0aS1kYXktdmlldz5cbiAgICAgICAgICAgIDxkaXYgdmlld0Zvb3RlciBrZW5kb1dvcmtIb3Vyc0Zvb3RlciBbc2hvd1dvcmtIb3Vyc109XCJzaG91bGRTaG93V29ya0hvdXJzXCIgKGl0ZW1DbGljayk9XCJzaG93V29ya0hvdXJzID0gIXNob3VsZFNob3dXb3JrSG91cnNcIj48L2Rpdj5cbiAgICAgICAgPC9uZy10ZW1wbGF0ZT5cbiAgICBgXG4gICAgICAgICAgICB9LF0gfSxcbl07XG4vKiogQG5vY29sbGFwc2UgKi9cblRpbWVsaW5lV2Vla1ZpZXdDb21wb25lbnQuY3RvclBhcmFtZXRlcnMgPSAoKSA9PiBbXG4gICAgeyB0eXBlOiBJbnRsU2VydmljZSB9LFxuICAgIHsgdHlwZTogTG9jYWxpemF0aW9uU2VydmljZSB9LFxuICAgIHsgdHlwZTogQ2hhbmdlRGV0ZWN0b3JSZWYgfSxcbiAgICB7IHR5cGU6IFZpZXdDb250ZXh0U2VydmljZSB9LFxuICAgIHsgdHlwZTogVmlld1N0YXRlU2VydmljZSB9XG5dO1xuVGltZWxpbmVXZWVrVmlld0NvbXBvbmVudC5wcm9wRGVjb3JhdG9ycyA9IHtcbiAgICBzZWxlY3RlZERhdGVGb3JtYXQ6IFt7IHR5cGU6IElucHV0IH1dLFxuICAgIHNlbGVjdGVkU2hvcnREYXRlRm9ybWF0OiBbeyB0eXBlOiBJbnB1dCB9XVxufTtcblxuLyoqXG4gKiBUaGUgY29tcG9uZW50IGZvciByZW5kZXJpbmcgdGhlICoqTW9udGgqKiB0aW1lbGluZSB2aWV3LlxuICovXG5jbGFzcyBUaW1lbGluZU1vbnRoVmlld0NvbXBvbmVudCBleHRlbmRzIFRpbWVsaW5lQmFzZSB7XG4gICAgY29uc3RydWN0b3IobG9jYWxpemF0aW9uLCBjaGFuZ2VEZXRlY3Rvciwgdmlld0NvbnRleHQsIHZpZXdTdGF0ZSkge1xuICAgICAgICBzdXBlcihsb2NhbGl6YXRpb24sIGNoYW5nZURldGVjdG9yLCB2aWV3Q29udGV4dCwgdmlld1N0YXRlKTtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRoZSBsb25nLWRhdGUgZm9ybWF0IGZvciBkaXNwbGF5aW5nIHRoZVxuICAgICAgICAgKiBzZWxlY3RlZCBkYXRlIGluIHRoZSBTY2hlZHVsZXIgdG9vbGJhci5cbiAgICAgICAgICogRGVmYXVsdHMgdG8gYHswOll9YFxuICAgICAgICAgKiAoW21vcmUgaW5mb3JtYXRpb25dKHslIHNsdWcgcGFyc2luZ2FuZGZvcm1hdHRpbmdfaW50bCAlfSN0b2MtZGF0ZS1mb3JtYXR0aW5nKSkuXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLnNlbGVjdGVkRGF0ZUZvcm1hdCA9ICd7MDpZfSc7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBUaGUgc2hvcnQtZGF0ZSBmb3JtYXQgZm9yIGRpc3BsYXlpbmcgdGhlXG4gICAgICAgICAqIHNlbGVjdGVkIGRhdGUgaW4gdGhlIFNjaGVkdWxlciB0b29sYmFyLlxuICAgICAgICAgKiBEZWZhdWx0cyB0byBgezA6eX1gXG4gICAgICAgICAqIChbbW9yZSBpbmZvcm1hdGlvbl0oeyUgc2x1ZyBwYXJzaW5nYW5kZm9ybWF0dGluZ19pbnRsICV9I3RvYy1kYXRlLWZvcm1hdHRpbmcpKS5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuc2VsZWN0ZWRTaG9ydERhdGVGb3JtYXQgPSAnezA6eX0nO1xuICAgICAgICAvKipcbiAgICAgICAgICogVGhlIGludmFyaWFudCBuYW1lIGZvciB0aGlzIHZpZXcgKGB0aW1lbGluZU1vbnRoYCkuXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLm5hbWUgPSAndGltZWxpbmVNb250aCc7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAaGlkZGVuXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmdldFN0YXJ0RGF0ZSA9IChzZWxlY3RlZERhdGUpID0+IHtcbiAgICAgICAgICAgIHJldHVybiBmaXJzdERheU9mTW9udGgoZ2V0RGF0ZShzZWxlY3RlZERhdGUpKTtcbiAgICAgICAgfTtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEBoaWRkZW5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuZ2V0RW5kRGF0ZSA9IChzZWxlY3RlZERhdGUpID0+IHtcbiAgICAgICAgICAgIHJldHVybiBhZGRNb250aHModGhpcy5nZXRTdGFydERhdGUoc2VsZWN0ZWREYXRlKSwgMSk7XG4gICAgICAgIH07XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAaGlkZGVuXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmdldE5leHREYXRlID0gKGRhdGUsIGNvdW50KSA9PiB7XG4gICAgICAgICAgICByZXR1cm4gYWRkTW9udGhzKGRhdGUsIGNvdW50KTtcbiAgICAgICAgfTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQGhpZGRlblxuICAgICAqL1xuICAgIGdldCB0aXRsZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubG9jYWxpemF0aW9uLmdldCgndGltZWxpbmVNb250aFZpZXdUaXRsZScpO1xuICAgIH1cbn1cblRpbWVsaW5lTW9udGhWaWV3Q29tcG9uZW50LmRlY29yYXRvcnMgPSBbXG4gICAgeyB0eXBlOiBDb21wb25lbnQsIGFyZ3M6IFt7XG4gICAgICAgICAgICAgICAgY2hhbmdlRGV0ZWN0aW9uOiBDaGFuZ2VEZXRlY3Rpb25TdHJhdGVneS5PblB1c2gsXG4gICAgICAgICAgICAgICAgc2VsZWN0b3I6ICdrZW5kby1zY2hlZHVsZXItdGltZWxpbmUtbW9udGgtdmlldycsXG4gICAgICAgICAgICAgICAgcHJvdmlkZXJzOiBbe1xuICAgICAgICAgICAgICAgICAgICAgICAgcHJvdmlkZTogU2NoZWR1bGVyVmlldyxcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHRzbGludDpkaXNhYmxlLW5leHQtbGluZTpuby1mb3J3YXJkLXJlZlxuICAgICAgICAgICAgICAgICAgICAgICAgdXNlRXhpc3Rpbmc6IGZvcndhcmRSZWYoKCkgPT4gVGltZWxpbmVNb250aFZpZXdDb21wb25lbnQpXG4gICAgICAgICAgICAgICAgICAgIH1dLFxuICAgICAgICAgICAgICAgIHRlbXBsYXRlOiBgXG4gICAgICAgIDxuZy10ZW1wbGF0ZSAjY29udGVudD5cbiAgICAgICAgICAgIDx0aW1lbGluZS1tdWx0aS1kYXktdmlld1xuICAgICAgICAgICAgICAgIHZpZXdOYW1lPVwidGltZWxpbmUtbW9udGhcIlxuICAgICAgICAgICAgICAgIFtuYW1lXT1cIm5hbWVcIlxuICAgICAgICAgICAgICAgIFtnZXROZXh0RGF0ZV09XCJnZXROZXh0RGF0ZVwiXG4gICAgICAgICAgICAgICAgW2dldFN0YXJ0RGF0ZV09XCJnZXRTdGFydERhdGVcIlxuICAgICAgICAgICAgICAgIFtnZXRFbmREYXRlXT1cImdldEVuZERhdGVcIlxuICAgICAgICAgICAgICAgIFtldmVudEhlaWdodF09XCJ2aWV3RXZlbnRIZWlnaHRcIlxuICAgICAgICAgICAgICAgIFtjb2x1bW5XaWR0aF09XCJ2aWV3Q29sdW1uV2lkdGhcIlxuICAgICAgICAgICAgICAgIFtjdXJyZW50VGltZU1hcmtlcl09XCJ2aWV3Q3VycmVudFRpbWVNYXJrZXJcIlxuICAgICAgICAgICAgICAgIFtzaG93V29ya0hvdXJzXT1cInNob3VsZFNob3dXb3JrSG91cnNcIlxuICAgICAgICAgICAgICAgIFtzY3JvbGxUaW1lXT1cInZpZXdTY3JvbGxUaW1lXCJcbiAgICAgICAgICAgICAgICBbc3RhcnRUaW1lXT1cInZpZXdTdGFydFRpbWVcIlxuICAgICAgICAgICAgICAgIFtlbmRUaW1lXT1cInZpZXdFbmRUaW1lXCJcbiAgICAgICAgICAgICAgICBbd29ya0RheVN0YXJ0XT1cInZpZXdXb3JrRGF5U3RhcnRcIlxuICAgICAgICAgICAgICAgIFt3b3JrRGF5RW5kXT1cInZpZXdXb3JrRGF5RW5kXCJcbiAgICAgICAgICAgICAgICBbd29ya1dlZWtTdGFydF09XCJ2aWV3V29ya1dlZWtTdGFydFwiXG4gICAgICAgICAgICAgICAgW3dvcmtXZWVrRW5kXT1cInZpZXdXb3JrV2Vla0VuZFwiXG4gICAgICAgICAgICAgICAgW3Nsb3REdXJhdGlvbl09XCJ2aWV3U2xvdER1cmF0aW9uXCJcbiAgICAgICAgICAgICAgICBbc2xvdERpdmlzaW9uc109XCJ2aWV3U2xvdERpdmlzaW9uc1wiXG4gICAgICAgICAgICAgICAgW3Nsb3RDbGFzc109XCJ2aWV3U2xvdENsYXNzXCJcbiAgICAgICAgICAgICAgICBbZXZlbnRDbGFzc109XCJ2aWV3RXZlbnRDbGFzc1wiXG4gICAgICAgICAgICAgICAgW2V2ZW50U3R5bGVzXT1cInZpZXdFdmVudFN0eWxlc1wiXG4gICAgICAgICAgICAgICAgW9C1dmVudFRlbXBsYXRlXT1cImV2ZW50VGVtcGxhdGU/LnRlbXBsYXRlUmVmXCJcbiAgICAgICAgICAgICAgICBbZ3JvdXBIZWFkZXJUZW1wbGF0ZV09XCJncm91cEhlYWRlclRlbXBsYXRlPy50ZW1wbGF0ZVJlZlwiXG4gICAgICAgICAgICAgICAgW3RpbWVTbG90VGVtcGxhdGVdPVwidGltZVNsb3RUZW1wbGF0ZT8udGVtcGxhdGVSZWZcIlxuICAgICAgICAgICAgICAgIFtkYXRlSGVhZGVyVGVtcGxhdGVdPVwiZGF0ZUhlYWRlclRlbXBsYXRlPy50ZW1wbGF0ZVJlZlwiXG4gICAgICAgICAgICAgICAgW3NlbGVjdGVkRGF0ZUZvcm1hdF09XCJzZWxlY3RlZERhdGVGb3JtYXRcIlxuICAgICAgICAgICAgICAgIFtzZWxlY3RlZFNob3J0RGF0ZUZvcm1hdF09XCJzZWxlY3RlZFNob3J0RGF0ZUZvcm1hdFwiPlxuICAgICAgICAgICAgPC90aW1lbGluZS1tdWx0aS1kYXktdmlldz5cbiAgICAgICAgICAgIDxkaXYgdmlld0Zvb3RlciBrZW5kb1dvcmtIb3Vyc0Zvb3RlciBbc2hvd1dvcmtIb3Vyc109XCJzaG91bGRTaG93V29ya0hvdXJzXCIgKGl0ZW1DbGljayk9XCJzaG93V29ya0hvdXJzID0gIXNob3VsZFNob3dXb3JrSG91cnNcIj48L2Rpdj5cbiAgICAgICAgPC9uZy10ZW1wbGF0ZT5cbiAgICBgXG4gICAgICAgICAgICB9LF0gfSxcbl07XG4vKiogQG5vY29sbGFwc2UgKi9cblRpbWVsaW5lTW9udGhWaWV3Q29tcG9uZW50LmN0b3JQYXJhbWV0ZXJzID0gKCkgPT4gW1xuICAgIHsgdHlwZTogTG9jYWxpemF0aW9uU2VydmljZSB9LFxuICAgIHsgdHlwZTogQ2hhbmdlRGV0ZWN0b3JSZWYgfSxcbiAgICB7IHR5cGU6IFZpZXdDb250ZXh0U2VydmljZSB9LFxuICAgIHsgdHlwZTogVmlld1N0YXRlU2VydmljZSB9XG5dO1xuVGltZWxpbmVNb250aFZpZXdDb21wb25lbnQucHJvcERlY29yYXRvcnMgPSB7XG4gICAgc2VsZWN0ZWREYXRlRm9ybWF0OiBbeyB0eXBlOiBJbnB1dCB9XSxcbiAgICBzZWxlY3RlZFNob3J0RGF0ZUZvcm1hdDogW3sgdHlwZTogSW5wdXQgfV1cbn07XG5cbmNvbnN0IFBVQkxJQ19ESVJFQ1RJVkVTJDEgPSBbXG4gICAgVGltZWxpbmVWaWV3Q29tcG9uZW50LFxuICAgIFRpbWVsaW5lV2Vla1ZpZXdDb21wb25lbnQsXG4gICAgVGltZWxpbmVNb250aFZpZXdDb21wb25lbnRcbl07XG4vKipcbiAqIEBoaWRkZW5cbiAqL1xuY2xhc3MgVGltZWxpbmVWaWV3TW9kdWxlIHtcbn1cblRpbWVsaW5lVmlld01vZHVsZS5kZWNvcmF0b3JzID0gW1xuICAgIHsgdHlwZTogTmdNb2R1bGUsIGFyZ3M6IFt7XG4gICAgICAgICAgICAgICAgaW1wb3J0czogW1xuICAgICAgICAgICAgICAgICAgICBEYXlUaW1lTW9kdWxlLFxuICAgICAgICAgICAgICAgICAgICBWaWV3c1NoYXJlZE1vZHVsZVxuICAgICAgICAgICAgICAgIF0sXG4gICAgICAgICAgICAgICAgZXhwb3J0czogW1xuICAgICAgICAgICAgICAgICAgICBQVUJMSUNfRElSRUNUSVZFUyQxXG4gICAgICAgICAgICAgICAgXSxcbiAgICAgICAgICAgICAgICBkZWNsYXJhdGlvbnM6IFtcbiAgICAgICAgICAgICAgICAgICAgLi4uUFVCTElDX0RJUkVDVElWRVMkMSxcbiAgICAgICAgICAgICAgICAgICAgVGltZWxpbmVNdWx0aURheVZpZXdDb21wb25lbnRcbiAgICAgICAgICAgICAgICBdXG4gICAgICAgICAgICB9LF0gfSxcbl07XG5cbmNvbnN0IGlzUmVjdXJyZW5jZU1hc3RlciQxID0gKGV2KSA9PiAhIShldi5pZCAmJiBldi5yZWN1cnJlbmNlUnVsZSk7XG4vKipcbiAqIEBoaWRkZW5cbiAqL1xuY2xhc3MgTG9jYWxFZGl0U2VydmljZSB7XG4gICAgY29uc3RydWN0b3Ioc2NoZWR1bGVyLCBsb2NhbERhdGFDaGFuZ2VzU2VydmljZSkge1xuICAgICAgICB0aGlzLnNjaGVkdWxlciA9IHNjaGVkdWxlcjtcbiAgICAgICAgdGhpcy5sb2NhbERhdGFDaGFuZ2VzU2VydmljZSA9IGxvY2FsRGF0YUNoYW5nZXNTZXJ2aWNlO1xuICAgIH1cbiAgICBnZXQgZmllbGRzKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5zY2hlZHVsZXIubW9kZWxGaWVsZHM7XG4gICAgfVxuICAgIGdldCBoYXNMb2NhbERhdGEoKSB7XG4gICAgICAgIHJldHVybiBpc1ByZXNlbnQodGhpcy5sb2NhbERhdGFDaGFuZ2VzU2VydmljZS5kYXRhKTtcbiAgICB9XG4gICAgZ2V0IGRhdGEoKSB7XG4gICAgICAgIGlmICh0aGlzLmhhc0xvY2FsRGF0YSkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMubG9jYWxEYXRhQ2hhbmdlc1NlcnZpY2UuZGF0YTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5zY2hlZHVsZXIuZXZlbnRzO1xuICAgIH1cbiAgICBjcmVhdGUoaXRlbSkge1xuICAgICAgICBjb25zdCBpZEZpZWxkID0gdGhpcy5maWVsZHMuaWQ7XG4gICAgICAgIGNvbnN0IGlkID0gZ2V0RmllbGQoaXRlbSwgaWRGaWVsZCk7XG4gICAgICAgIGlmICghaXNQcmVzZW50KGlkKSkge1xuICAgICAgICAgICAgc2V0RmllbGQoaXRlbSwgaWRGaWVsZCwgdGhpcy5uZXh0SWQoKSk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5kYXRhLnB1c2goaXRlbSk7XG4gICAgICAgIHRoaXMuZGF0YUNoYW5nZWQoKTtcbiAgICB9XG4gICAgY3JlYXRlRXhjZXB0aW9uKGl0ZW0sIHZhbHVlKSB7XG4gICAgICAgIGNvbnN0IGV4Y2VwdGlvbiA9IHRoaXMuYnVpbGRFeGNlcHRpb24odmFsdWUpO1xuICAgICAgICB0aGlzLnJlbW92ZU9jY3VycmVuY2VJbnRlcm5hbChpdGVtKTtcbiAgICAgICAgdGhpcy5jcmVhdGUoZXhjZXB0aW9uKTtcbiAgICB9XG4gICAgdXBkYXRlKGl0ZW0sIHZhbHVlKSB7XG4gICAgICAgIGFzc2lnblZhbHVlcyhpdGVtLCB2YWx1ZSk7XG4gICAgICAgIHRoaXMuZGF0YUNoYW5nZWQoKTtcbiAgICB9XG4gICAgcmVtb3ZlKGl0ZW0pIHtcbiAgICAgICAgY29uc3QgaWRGaWVsZCA9IHRoaXMuZmllbGRzLmlkO1xuICAgICAgICBjb25zdCBpdGVtSWQgPSBnZXRGaWVsZChpdGVtLCBpZEZpZWxkKTtcbiAgICAgICAgY29uc3QgZGF0YSA9IHRoaXMuZGF0YTtcbiAgICAgICAgZm9yIChsZXQgaWR4ID0gMDsgaWR4IDwgZGF0YS5sZW5ndGg7IGlkeCsrKSB7XG4gICAgICAgICAgICBpZiAoaXRlbUlkID09PSBnZXRGaWVsZChkYXRhW2lkeF0sIGlkRmllbGQpKSB7XG4gICAgICAgICAgICAgICAgZGF0YS5zcGxpY2UoaWR4LCAxKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB0aGlzLmRhdGFDaGFuZ2VkKCk7XG4gICAgfVxuICAgIHJlbW92ZVNlcmllcyhpdGVtKSB7XG4gICAgICAgIGNvbnN0IGV2ZW50ID0gcmVhZEV2ZW50KGl0ZW0sIHRoaXMuZmllbGRzKTtcbiAgICAgICAgY29uc3QgaXNIZWFkID0gaXNSZWN1cnJlbmNlTWFzdGVyJDEoZXZlbnQpO1xuICAgICAgICB0aGlzLnJlbW92ZUl0ZW1BbmRFeGNlcHRpb25zKGlzSGVhZCA/IGV2ZW50LmlkIDogZXZlbnQucmVjdXJyZW5jZUlkKTtcbiAgICAgICAgdGhpcy5kYXRhQ2hhbmdlZCgpO1xuICAgIH1cbiAgICByZW1vdmVPY2N1cnJlbmNlKGl0ZW0pIHtcbiAgICAgICAgdGhpcy5yZW1vdmVPY2N1cnJlbmNlSW50ZXJuYWwoaXRlbSk7XG4gICAgICAgIHRoaXMuZGF0YUNoYW5nZWQoKTtcbiAgICB9XG4gICAgZmluZFJlY3VycmVuY2VNYXN0ZXIoaXRlbSkge1xuICAgICAgICBjb25zdCBmaWVsZHMgPSB0aGlzLnNjaGVkdWxlci5tb2RlbEZpZWxkcztcbiAgICAgICAgY29uc3QgZXZlbnQgPSByZWFkRXZlbnQoaXRlbSwgZmllbGRzKTtcbiAgICAgICAgY29uc3QgaGVhZElkID0gaXNSZWN1cnJlbmNlTWFzdGVyJDEoZXZlbnQpID8gZXZlbnQuaWQgOiBldmVudC5yZWN1cnJlbmNlSWQ7XG4gICAgICAgIHJldHVybiB0aGlzLmRhdGEuZmluZCgoZGF0YUl0ZW0pID0+IGdldEZpZWxkKGRhdGFJdGVtLCBmaWVsZHMuaWQpID09PSBoZWFkSWQpO1xuICAgIH1cbiAgICBpc1JlY3VycmluZyhldmVudCkge1xuICAgICAgICByZXR1cm4gaXNSZWN1cnJpbmcoZXZlbnQsIHRoaXMuc2NoZWR1bGVyLm1vZGVsRmllbGRzKTtcbiAgICB9XG4gICAgaXNFeGNlcHRpb24oZXZlbnQpIHtcbiAgICAgICAgcmV0dXJuIGlzRXhjZXB0aW9uKGV2ZW50LCB0aGlzLnNjaGVkdWxlci5tb2RlbEZpZWxkcyk7XG4gICAgfVxuICAgIG5leHRJZCgpIHtcbiAgICAgICAgcmV0dXJuIGd1aWQoKTtcbiAgICB9XG4gICAgYnVpbGRFeGNlcHRpb24oaXRlbSkge1xuICAgICAgICBjb25zdCBmaWVsZHMgPSB0aGlzLmZpZWxkcztcbiAgICAgICAgY29uc3QgaGVhZCA9IHRoaXMuZmluZFJlY3VycmVuY2VNYXN0ZXIoaXRlbSk7XG4gICAgICAgIGlmICghaGVhZCkge1xuICAgICAgICAgICAgaWYgKGlzRGV2TW9kZSgpKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdVbmFibGUgdG8gZmluZCByZWN1cnJlbmNlIGhlYWQgZm9yIGV2ZW50LiBQbGVhc2UgY2hlY2sgdGhhdCByZWN1cnJlbmNlSWQgaXMgc2V0IGFuZCByZWZlcnMgdG8gYW4gZXhpc3RpbmcgZXZlbnQuJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgZXhjZXB0aW9uID0gY2xvbmUoaXRlbSk7XG4gICAgICAgIHNldEZpZWxkKGV4Y2VwdGlvbiwgZmllbGRzLmlkLCB0aGlzLm5leHRJZCgpKTtcbiAgICAgICAgc2V0RmllbGQoZXhjZXB0aW9uLCBmaWVsZHMucmVjdXJyZW5jZUlkLCBnZXRGaWVsZChoZWFkLCBmaWVsZHMuaWQpKTtcbiAgICAgICAgc2V0RmllbGQoZXhjZXB0aW9uLCBmaWVsZHMucmVjdXJyZW5jZVJ1bGUsIG51bGwpO1xuICAgICAgICByZXR1cm4gZXhjZXB0aW9uO1xuICAgIH1cbiAgICByZW1vdmVJdGVtQW5kRXhjZXB0aW9ucyhpdGVtSWQpIHtcbiAgICAgICAgY29uc3QgZGF0YSA9IHRoaXMuZGF0YTtcbiAgICAgICAgY29uc3QgZmllbGRzID0gdGhpcy5zY2hlZHVsZXIubW9kZWxGaWVsZHM7XG4gICAgICAgIGZvciAobGV0IGlkeCA9IGRhdGEubGVuZ3RoIC0gMTsgaWR4ID49IDA7IGlkeC0tKSB7XG4gICAgICAgICAgICBpZiAoaXRlbUlkID09PSBnZXRGaWVsZChkYXRhW2lkeF0sIGZpZWxkcy5yZWN1cnJlbmNlSWQpIHx8IGl0ZW1JZCA9PT0gZ2V0RmllbGQoZGF0YVtpZHhdLCBmaWVsZHMuaWQpKSB7XG4gICAgICAgICAgICAgICAgZGF0YS5zcGxpY2UoaWR4LCAxKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICByZW1vdmVPY2N1cnJlbmNlSW50ZXJuYWwoaXRlbSkge1xuICAgICAgICBjb25zdCBmaWVsZHMgPSB0aGlzLmZpZWxkcztcbiAgICAgICAgY29uc3QgaGVhZCA9IHRoaXMuZmluZFJlY3VycmVuY2VNYXN0ZXIoaXRlbSk7XG4gICAgICAgIGNvbnN0IGV4Y2VwdGlvbkRhdGUgPSBnZXRGaWVsZChpdGVtLCBmaWVsZHMuc3RhcnQpO1xuICAgICAgICBjb25zdCBjdXJyZW50RXhjZXB0aW9ucyA9IGdldEZpZWxkKGhlYWQsIGZpZWxkcy5yZWN1cnJlbmNlRXhjZXB0aW9ucykgfHwgW107XG4gICAgICAgIHNldEZpZWxkKGhlYWQsIGZpZWxkcy5yZWN1cnJlbmNlRXhjZXB0aW9ucywgWy4uLmN1cnJlbnRFeGNlcHRpb25zLCBleGNlcHRpb25EYXRlXSk7XG4gICAgfVxuICAgIGRhdGFDaGFuZ2VkKCkge1xuICAgICAgICBpZiAodGhpcy5oYXNMb2NhbERhdGEpIHtcbiAgICAgICAgICAgIHRoaXMubG9jYWxEYXRhQ2hhbmdlc1NlcnZpY2UuY2hhbmdlcy5lbWl0KCk7XG4gICAgICAgIH1cbiAgICB9XG59XG5cbi8qKlxuICogQGhpZGRlblxuICovXG5jb25zdCBtYXJrQWxsQXNUb3VjaGVkID0gKGNvbnRyb2wpID0+IHtcbiAgICBjb250cm9sLm1hcmtBc1RvdWNoZWQoKTtcbiAgICBpZiAoY29udHJvbC5oYXNPd25Qcm9wZXJ0eSgnY29udHJvbHMnKSkge1xuICAgICAgICBsZXQgY29udHJvbHMgPSBjb250cm9sLmNvbnRyb2xzO1xuICAgICAgICBmb3IgKGxldCBpbm5lciBpbiBjb250cm9scykge1xuICAgICAgICAgICAgaWYgKGNvbnRyb2xzLmhhc093blByb3BlcnR5KGlubmVyKSkge1xuICAgICAgICAgICAgICAgIG1hcmtBbGxBc1RvdWNoZWQoY29udHJvbHNbaW5uZXJdKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbn07XG4vKipcbiAqIEBoaWRkZW5cbiAqL1xuZnVuY3Rpb24gZGlmZihvYmoxLCBvYmoyLCBmaWVsZHMpIHtcbiAgICBmb3IgKGxldCBpZHggPSAwOyBpZHggPCBmaWVsZHMubGVuZ3RoOyBpZHgrKykge1xuICAgICAgICBjb25zdCBmaWVsZCA9IGZpZWxkc1tpZHhdO1xuICAgICAgICBpZiAoIWFyZUVxdWFsKGdldEZpZWxkKG9iajEsIGZpZWxkKSwgZ2V0RmllbGQob2JqMiwgZmllbGQpKSkge1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGZhbHNlO1xufVxuLyoqXG4gKiBAaGlkZGVuXG4gKi9cbmZ1bmN0aW9uIGFyZUVxdWFsKHZhbHVlMSwgdmFsdWUyKSB7XG4gICAgaWYgKHZhbHVlMSAmJiB2YWx1ZTEuZ2V0VGltZSAmJiB2YWx1ZTIgJiYgdmFsdWUyLmdldFRpbWUpIHtcbiAgICAgICAgcmV0dXJuIHZhbHVlMS5nZXRUaW1lKCkgPT09IHZhbHVlMi5nZXRUaW1lKCk7XG4gICAgfVxuICAgIGVsc2UgaWYgKEFycmF5LmlzQXJyYXkodmFsdWUxKSkge1xuICAgICAgICBpZiAoIUFycmF5LmlzQXJyYXkodmFsdWUyKSB8fCB2YWx1ZTEubGVuZ3RoICE9PSB2YWx1ZTIubGVuZ3RoKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgZm9yIChsZXQgaWR4ID0gMDsgaWR4IDwgdmFsdWUxLmxlbmd0aDsgaWR4KyspIHtcbiAgICAgICAgICAgIGlmICh2YWx1ZTFbaWR4XSAhPT0gdmFsdWUyW2lkeF0pIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICAgIC8vIHRzbGludDpkaXNhYmxlLW5leHQtbGluZTp0cmlwbGUtZXF1YWxzXG4gICAgcmV0dXJuIHZhbHVlMSA9PSB2YWx1ZTI7XG59XG5jb25zdCBEQVRFX0FDQ0VTU09SUyA9IFsnZ2V0RnVsbFllYXInLCAnZ2V0TW9udGgnLCAnZ2V0RGF0ZScsICdnZXRIb3VycycsICdnZXRNaW51dGVzJywgJ2dldFNlY29uZHMnLCAnZ2V0TWlsbGlzZWNvbmRzJ107XG4vKipcbiAqIEBoaWRkZW5cbiAqL1xuZnVuY3Rpb24gc2VyaWVzRGF0ZShoZWFkLCBvY2N1cnJlbmNlLCBjdXJyZW50LCBmaWVsZCkge1xuICAgIGNvbnN0IHZhbHVlcyA9IFtdO1xuICAgIGNvbnN0IGhlYWREYXRlID0gZ2V0RmllbGQoaGVhZCwgZmllbGQpO1xuICAgIGNvbnN0IG9jY3VycmVuY2VEYXRlID0gZ2V0RmllbGQob2NjdXJyZW5jZSwgZmllbGQpO1xuICAgIGNvbnN0IGN1cnJlbnREYXRlID0gZ2V0RmllbGQoY3VycmVudCwgZmllbGQpO1xuICAgIERBVEVfQUNDRVNTT1JTLmZvckVhY2goYWNjZXNzb3IgPT4ge1xuICAgICAgICB2YWx1ZXMucHVzaChvY2N1cnJlbmNlRGF0ZVthY2Nlc3Nvcl0oKSA9PT0gY3VycmVudERhdGVbYWNjZXNzb3JdKCkgPyBoZWFkRGF0ZVthY2Nlc3Nvcl0oKSA6IGN1cnJlbnREYXRlW2FjY2Vzc29yXSgpKTtcbiAgICB9KTtcbiAgICByZXR1cm4gbmV3IERhdGUoLi4udmFsdWVzKTtcbn1cblxuLyoqXG4gKiBAaGlkZGVuXG4gKi9cbmNsYXNzIEVkaXRpbmdEaXJlY3RpdmVCYXNlIHtcbiAgICBjb25zdHJ1Y3RvcihzY2hlZHVsZXIsIGxvY2FsRGF0YUNoYW5nZXNTZXJ2aWNlLCBkaWFsb2dzU2VydmljZSkge1xuICAgICAgICB0aGlzLnNjaGVkdWxlciA9IHNjaGVkdWxlcjtcbiAgICAgICAgdGhpcy5sb2NhbERhdGFDaGFuZ2VzU2VydmljZSA9IGxvY2FsRGF0YUNoYW5nZXNTZXJ2aWNlO1xuICAgICAgICB0aGlzLmRpYWxvZ3NTZXJ2aWNlID0gZGlhbG9nc1NlcnZpY2U7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBGaXJlcyBiZWZvcmUgdGhlIGVkaXRpbmcgZGlyZWN0aXZlIHJlbmRlcnMgdGhlICoqQWRkKiogZGlhbG9nLlxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5hZGQgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBGaXJlcyBiZWZvcmUgdGhlIGVkaXRpbmcgZGlyZWN0aXZlIHJlbmRlcnMgdGhlICoqRWRpdCoqIGRpYWxvZy5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuZWRpdCA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcbiAgICAgICAgdGhpcy5kZWZhdWx0VGl0bGUgPSAnTm8gdGl0bGUnO1xuICAgICAgICB0aGlzLmRlZmF1bHRFZGl0U2VydmljZSA9IHRoaXMuY3JlYXRlRGVmYXVsdFNlcnZpY2UoKTtcbiAgICAgICAgdGhpcy5zY2hlZHVsZXIuZWRpdGFibGUgPSB0cnVlO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBUaGUgZWRpdCBzZXJ2aWNlIHRoYXQgd2lsbCBoYW5kbGUgdGhlIGVkaXRpbmcgb3BlcmF0aW9ucy5cbiAgICAgKi9cbiAgICBzZXQgZWRpdFNlcnZpY2UodmFsdWUpIHtcbiAgICAgICAgdGhpcy51c2VyRWRpdFNlcnZpY2UgPSB2YWx1ZTtcbiAgICB9XG4gICAgZ2V0IGVkaXRTZXJ2aWNlKCkge1xuICAgICAgICByZXR1cm4gdGhpcy51c2VyRWRpdFNlcnZpY2UgfHwgdGhpcy5kZWZhdWx0RWRpdFNlcnZpY2U7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEBoaWRkZW5cbiAgICAgKi9cbiAgICBuZ09uSW5pdCgpIHtcbiAgICAgICAgdGhpcy5zdWJzY3JpcHRpb25zID0gbWVyZ2UodGhpcy5zY2hlZHVsZXIuc2xvdERibENsaWNrLCB0aGlzLnNjaGVkdWxlci5jcmVhdGUpLnN1YnNjcmliZSh0aGlzLmFkZEhhbmRsZXIuYmluZCh0aGlzKSk7XG4gICAgICAgIHRoaXMuc3Vic2NyaXB0aW9ucy5hZGQodGhpcy5zY2hlZHVsZXIucmVtb3ZlQ29uZmlybWVkLnN1YnNjcmliZSh0aGlzLnJlbW92ZUhhbmRsZXIuYmluZCh0aGlzKSkpO1xuICAgICAgICB0aGlzLnN1YnNjcmlwdGlvbnMuYWRkKHRoaXMuc2NoZWR1bGVyLmNhbmNlbC5zdWJzY3JpYmUodGhpcy5jYW5jZWxIYW5kbGVyLmJpbmQodGhpcykpKTtcbiAgICAgICAgdGhpcy5zdWJzY3JpcHRpb25zLmFkZCh0aGlzLnNjaGVkdWxlci5yZXNpemVFbmRDb25maXJtZWQuc3Vic2NyaWJlKHRoaXMucmVzaXplRW5kSGFuZGxlci5iaW5kKHRoaXMpKSk7XG4gICAgICAgIHRoaXMuc3Vic2NyaXB0aW9ucy5hZGQodGhpcy5zY2hlZHVsZXIuZHJhZ0VuZENvbmZpcm1lZC5zdWJzY3JpYmUodGhpcy5kcmFnRW5kSGFuZGxlci5iaW5kKHRoaXMpKSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEBoaWRkZW5cbiAgICAgKi9cbiAgICBuZ09uRGVzdHJveSgpIHtcbiAgICAgICAgdGhpcy5zdWJzY3JpcHRpb25zLnVuc3Vic2NyaWJlKCk7XG4gICAgfVxuICAgIGNyZWF0ZURlZmF1bHRTZXJ2aWNlKCkge1xuICAgICAgICByZXR1cm4gbmV3IExvY2FsRWRpdFNlcnZpY2UodGhpcy5zY2hlZHVsZXIsIHRoaXMubG9jYWxEYXRhQ2hhbmdlc1NlcnZpY2UpO1xuICAgIH1cbiAgICBhZGRIYW5kbGVyKGFyZ3MpIHtcbiAgICAgICAgdGhpcy5jbG9zZUVkaXRvcigpO1xuICAgICAgICBpZiAoIXRoaXMuaXNFbmFibGVkKCdhZGQnKSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGZpZWxkcyA9IHRoaXMuc2NoZWR1bGVyLm1vZGVsRmllbGRzO1xuICAgICAgICBjb25zdCBkYXRhSXRlbSA9IHt9O1xuICAgICAgICBzZXRGaWVsZChkYXRhSXRlbSwgZmllbGRzLnN0YXJ0LCBhcmdzLnN0YXJ0KTtcbiAgICAgICAgc2V0RmllbGQoZGF0YUl0ZW0sIGZpZWxkcy5lbmQsIGFyZ3MuZW5kKTtcbiAgICAgICAgc2V0RmllbGQoZGF0YUl0ZW0sIGZpZWxkcy5pc0FsbERheSwgYXJncy5pc0FsbERheSk7XG4gICAgICAgIHNldEZpZWxkKGRhdGFJdGVtLCBmaWVsZHMudGl0bGUsIGFyZ3MudGl0bGUpO1xuICAgICAgICBjb25zdCByZXNvdXJjZXMgPSBncm91cFJlc291cmNlcyh0aGlzLnNjaGVkdWxlci5ncm91cCwgdGhpcy5zY2hlZHVsZXIucmVzb3VyY2VzKTtcbiAgICAgICAgY29uc3Qgc2xvdFJlc291cmNlcyA9IGFyZ3MucmVzb3VyY2VzO1xuICAgICAgICBmb3IgKGxldCBpZHggPSAwOyBpZHggPCByZXNvdXJjZXMubGVuZ3RoOyBpZHgrKykge1xuICAgICAgICAgICAgY29uc3QgcmVzb3VyY2UgPSByZXNvdXJjZXNbaWR4XTtcbiAgICAgICAgICAgIGNvbnN0IHZhbHVlID0gZ2V0RmllbGQoc2xvdFJlc291cmNlc1tpZHhdLCByZXNvdXJjZS52YWx1ZUZpZWxkKTtcbiAgICAgICAgICAgIHNldEZpZWxkKGRhdGFJdGVtLCByZXNvdXJjZS5maWVsZCwgcmVzb3VyY2UubXVsdGlwbGUgPyBbdmFsdWVdIDogdmFsdWUpO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGFkZEFyZ3MgPSBuZXcgQWRkRXZlbnQodGhpcy5zY2hlZHVsZXIsIHsgZGF0YUl0ZW0gfSk7XG4gICAgICAgIHRoaXMuYWRkLmVtaXQoYWRkQXJncyk7XG4gICAgICAgIGlmICghYWRkQXJncy5pc0RlZmF1bHRQcmV2ZW50ZWQoKSkge1xuICAgICAgICAgICAgdGhpcy5zY2hlZHVsZXIuYWRkRXZlbnQodGhpcy5jcmVhdGVNb2RlbCh7XG4gICAgICAgICAgICAgICAgYWN0aW9uOiAnYWRkJyxcbiAgICAgICAgICAgICAgICBpc05ldzogdHJ1ZSxcbiAgICAgICAgICAgICAgICBkYXRhSXRlbVxuICAgICAgICAgICAgfSkpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJlbW92ZUhhbmRsZXIoeyBkYXRhSXRlbSB9KSB7XG4gICAgICAgIGlmICghdGhpcy5pc0VuYWJsZWQoJ3JlbW92ZScpKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuZWRpdFNlcnZpY2UuaXNSZWN1cnJpbmcoZGF0YUl0ZW0pKSB7XG4gICAgICAgICAgICB0aGlzLmRpYWxvZ3NTZXJ2aWNlLm9wZW5SZWN1cnJpbmdDb25maXJtYXRpb25EaWFsb2coMSAvKiBSZW1vdmUgKi8pXG4gICAgICAgICAgICAgICAgLnN1YnNjcmliZSgoZWRpdE1vZGUpID0+IHtcbiAgICAgICAgICAgICAgICBpZiAoZWRpdE1vZGUgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmhhbmRsZVJlbW92ZShkYXRhSXRlbSwgZWRpdE1vZGUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5kaWFsb2dzU2VydmljZS5vcGVuUmVtb3ZlQ29uZmlybWF0aW9uRGlhbG9nKClcbiAgICAgICAgICAgICAgICAuc3Vic2NyaWJlKChzaG91bGRSZW1vdmUpID0+IHtcbiAgICAgICAgICAgICAgICBpZiAoc2hvdWxkUmVtb3ZlKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuaGFuZGxlUmVtb3ZlKGRhdGFJdGVtLCAwIC8qIEV2ZW50ICovKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBjYW5jZWxIYW5kbGVyKCkge1xuICAgICAgICB0aGlzLmNsb3NlRWRpdG9yKCk7XG4gICAgfVxuICAgIGNsb3NlRWRpdG9yKCkge1xuICAgICAgICB0aGlzLnNjaGVkdWxlci5jbG9zZUV2ZW50KCk7XG4gICAgfVxuICAgIGhhbmRsZVVwZGF0ZShpdGVtLCB2YWx1ZSwgbW9kZSkge1xuICAgICAgICBjb25zdCBzdmMgPSB0aGlzLmVkaXRTZXJ2aWNlO1xuICAgICAgICBpZiAobW9kZSA9PT0gMSAvKiBPY2N1cnJlbmNlICovKSB7XG4gICAgICAgICAgICBzdmMuaXNFeGNlcHRpb24oaXRlbSkgP1xuICAgICAgICAgICAgICAgIHN2Yy51cGRhdGUoaXRlbSwgdmFsdWUpIDpcbiAgICAgICAgICAgICAgICBzdmMuY3JlYXRlRXhjZXB0aW9uKGl0ZW0sIHZhbHVlKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIC8vIEl0ZW0gaXMgbm90IHJlY3VycmluZyBvciB3ZSdyZSBlZGl0aW5nIHRoZSBlbnRpcmUgc2VyaWVzXG4gICAgICAgICAgICBzdmMudXBkYXRlKGl0ZW0sIHZhbHVlKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBoYW5kbGVSZW1vdmUoaXRlbSwgbW9kZSkge1xuICAgICAgICBjb25zdCBzdmMgPSB0aGlzLmVkaXRTZXJ2aWNlO1xuICAgICAgICBpZiAobW9kZSA9PT0gMiAvKiBTZXJpZXMgKi8pIHtcbiAgICAgICAgICAgIHN2Yy5yZW1vdmVTZXJpZXMoaXRlbSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAobW9kZSA9PT0gMSAvKiBPY2N1cnJlbmNlICovKSB7XG4gICAgICAgICAgICBzdmMuaXNFeGNlcHRpb24oaXRlbSkgP1xuICAgICAgICAgICAgICAgIHN2Yy5yZW1vdmUoaXRlbSkgOlxuICAgICAgICAgICAgICAgIHN2Yy5yZW1vdmVPY2N1cnJlbmNlKGl0ZW0pO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgLy8gSXRlbSBpcyBub3QgcmVjdXJyaW5nXG4gICAgICAgICAgICBzdmMucmVtb3ZlKGl0ZW0pO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJlc2l6ZUVuZEhhbmRsZXIoeyBldmVudCwgc3RhcnQsIGVuZCB9KSB7XG4gICAgICAgIGlmIChhcmVFcXVhbChzdGFydCwgZXZlbnQuc3RhcnQpICYmIGFyZUVxdWFsKGVuZCwgZXZlbnQuZW5kKSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGRhdGFJdGVtID0gZXZlbnQuZGF0YUl0ZW07XG4gICAgICAgIGNvbnN0IGZpZWxkcyA9IHRoaXMuc2NoZWR1bGVyLm1vZGVsRmllbGRzO1xuICAgICAgICBsZXQgdmFsdWUgPSB7fTtcbiAgICAgICAgc2V0RmllbGQodmFsdWUsIGZpZWxkcy5zdGFydCwgc3RhcnQpO1xuICAgICAgICBzZXRGaWVsZCh2YWx1ZSwgZmllbGRzLmVuZCwgZW5kKTtcbiAgICAgICAgaWYgKHRoaXMuZWRpdFNlcnZpY2UuaXNSZWN1cnJpbmcoZGF0YUl0ZW0pKSB7XG4gICAgICAgICAgICB0aGlzLmRpYWxvZ3NTZXJ2aWNlLm9wZW5SZWN1cnJpbmdDb25maXJtYXRpb25EaWFsb2coMCAvKiBFZGl0ICovKVxuICAgICAgICAgICAgICAgIC5zdWJzY3JpYmUoKHJlc3VsdCkgPT4ge1xuICAgICAgICAgICAgICAgIGxldCB0YXJnZXQgPSBkYXRhSXRlbTtcbiAgICAgICAgICAgICAgICBpZiAocmVzdWx0ID09PSAyIC8qIFNlcmllcyAqLykge1xuICAgICAgICAgICAgICAgICAgICB0YXJnZXQgPSB0aGlzLmVkaXRTZXJ2aWNlLmZpbmRSZWN1cnJlbmNlTWFzdGVyKGRhdGFJdGVtKTtcbiAgICAgICAgICAgICAgICAgICAgc2V0RmllbGQodmFsdWUsIGZpZWxkcy5zdGFydCwgc2VyaWVzRGF0ZSh0YXJnZXQsIGRhdGFJdGVtLCB2YWx1ZSwgZmllbGRzLnN0YXJ0KSk7XG4gICAgICAgICAgICAgICAgICAgIHNldEZpZWxkKHZhbHVlLCBmaWVsZHMuZW5kLCBzZXJpZXNEYXRlKHRhcmdldCwgZGF0YUl0ZW0sIHZhbHVlLCBmaWVsZHMuZW5kKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKHJlc3VsdCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhbHVlID0gYXNzaWduVmFsdWVzKGNsb25lKGRhdGFJdGVtKSwgdmFsdWUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aGlzLmhhbmRsZVVwZGF0ZSh0YXJnZXQsIHZhbHVlLCByZXN1bHQpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLmVkaXRTZXJ2aWNlLnVwZGF0ZShkYXRhSXRlbSwgdmFsdWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGRyYWdFbmRIYW5kbGVyKHsgZXZlbnQ6IHsgZGF0YUl0ZW0gfSwgc3RhcnQsIGVuZCwgcmVzb3VyY2VzLCBpc0FsbERheSB9KSB7XG4gICAgICAgIGNvbnN0IG1vZGVsRmllbGRzID0gdGhpcy5zY2hlZHVsZXIubW9kZWxGaWVsZHM7XG4gICAgICAgIGNvbnN0IHJlc291cmNlRmllbGRzID0gZ3JvdXBSZXNvdXJjZXModGhpcy5zY2hlZHVsZXIuZ3JvdXAsIHRoaXMuc2NoZWR1bGVyLnJlc291cmNlcykubWFwKHIgPT4gci5maWVsZCk7XG4gICAgICAgIGNvbnN0IGZpZWxkcyA9IFttb2RlbEZpZWxkcy5zdGFydCwgbW9kZWxGaWVsZHMuZW5kLCBtb2RlbEZpZWxkcy5pc0FsbERheV0uY29uY2F0KHJlc291cmNlRmllbGRzKTtcbiAgICAgICAgbGV0IHZhbHVlID0gY2xvbmUocmVzb3VyY2VzKTtcbiAgICAgICAgc2V0RmllbGQodmFsdWUsIG1vZGVsRmllbGRzLnN0YXJ0LCBzdGFydCk7XG4gICAgICAgIHNldEZpZWxkKHZhbHVlLCBtb2RlbEZpZWxkcy5lbmQsIGVuZCk7XG4gICAgICAgIHNldEZpZWxkKHZhbHVlLCBtb2RlbEZpZWxkcy5pc0FsbERheSwgaXNBbGxEYXkpO1xuICAgICAgICBpZiAoIWRpZmYoZGF0YUl0ZW0sIHZhbHVlLCBmaWVsZHMpKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuZWRpdFNlcnZpY2UuaXNSZWN1cnJpbmcoZGF0YUl0ZW0pKSB7XG4gICAgICAgICAgICB0aGlzLmRpYWxvZ3NTZXJ2aWNlLm9wZW5SZWN1cnJpbmdDb25maXJtYXRpb25EaWFsb2coMCAvKiBFZGl0ICovKVxuICAgICAgICAgICAgICAgIC5zdWJzY3JpYmUoKHJlc3VsdCkgPT4ge1xuICAgICAgICAgICAgICAgIGxldCB0YXJnZXQgPSBkYXRhSXRlbTtcbiAgICAgICAgICAgICAgICBpZiAocmVzdWx0ID09PSAyIC8qIFNlcmllcyAqLykge1xuICAgICAgICAgICAgICAgICAgICB0YXJnZXQgPSB0aGlzLmVkaXRTZXJ2aWNlLmZpbmRSZWN1cnJlbmNlTWFzdGVyKGRhdGFJdGVtKTtcbiAgICAgICAgICAgICAgICAgICAgc2V0RmllbGQodmFsdWUsIG1vZGVsRmllbGRzLnN0YXJ0LCBzZXJpZXNEYXRlKHRhcmdldCwgZGF0YUl0ZW0sIHZhbHVlLCBtb2RlbEZpZWxkcy5zdGFydCkpO1xuICAgICAgICAgICAgICAgICAgICBzZXRGaWVsZCh2YWx1ZSwgbW9kZWxGaWVsZHMuZW5kLCBzZXJpZXNEYXRlKHRhcmdldCwgZGF0YUl0ZW0sIHZhbHVlLCBtb2RlbEZpZWxkcy5lbmQpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSBpZiAocmVzdWx0ICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSBhc3NpZ25WYWx1ZXMoY2xvbmUoZGF0YUl0ZW0pLCB2YWx1ZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXMuaGFuZGxlVXBkYXRlKHRhcmdldCwgdmFsdWUsIHJlc3VsdCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuZWRpdFNlcnZpY2UudXBkYXRlKGRhdGFJdGVtLCB2YWx1ZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgaXNFbmFibGVkKGFjdGlvbikge1xuICAgICAgICBjb25zdCBlZGl0YWJsZSA9IHRoaXMuc2NoZWR1bGVyLmVkaXRhYmxlO1xuICAgICAgICByZXR1cm4gZWRpdGFibGUgJiYgZWRpdGFibGVbYWN0aW9uXSAhPT0gZmFsc2U7XG4gICAgfVxufVxuRWRpdGluZ0RpcmVjdGl2ZUJhc2UucHJvcERlY29yYXRvcnMgPSB7XG4gICAgYWRkOiBbeyB0eXBlOiBPdXRwdXQgfV0sXG4gICAgZWRpdDogW3sgdHlwZTogT3V0cHV0IH1dLFxuICAgIGVkaXRTZXJ2aWNlOiBbeyB0eXBlOiBJbnB1dCB9XVxufTtcblxuLyoqXG4gKiBBIGRpcmVjdGl2ZSB3aGljaCBlbmNhcHN1bGF0ZXMgdGhlIGVkaXRpbmcgb3BlcmF0aW9ucyB3aGVuIHRoZSBTY2hlZHVsZXJcbiAqIHVzZXMgdGhlIFtSZWFjdGl2ZSBBbmd1bGFyIEZvcm1zXSh7eyBzaXRlLmRhdGEudXJscy5hbmd1bGFyWydyZWFjdGl2ZWZvcm1zJ10gfX0pLlxuICovXG5jbGFzcyBSZWFjdGl2ZUVkaXRpbmdEaXJlY3RpdmUgZXh0ZW5kcyBFZGl0aW5nRGlyZWN0aXZlQmFzZSB7XG4gICAgY29uc3RydWN0b3Ioc2NoZWR1bGVyLCBsb2NhbERhdGFDaGFuZ2VzU2VydmljZSwgZGlhbG9nc1NlcnZpY2UpIHtcbiAgICAgICAgc3VwZXIoc2NoZWR1bGVyLCBsb2NhbERhdGFDaGFuZ2VzU2VydmljZSwgZGlhbG9nc1NlcnZpY2UpO1xuICAgICAgICB0aGlzLnNjaGVkdWxlciA9IHNjaGVkdWxlcjtcbiAgICAgICAgdGhpcy5sb2NhbERhdGFDaGFuZ2VzU2VydmljZSA9IGxvY2FsRGF0YUNoYW5nZXNTZXJ2aWNlO1xuICAgICAgICB0aGlzLmRpYWxvZ3NTZXJ2aWNlID0gZGlhbG9nc1NlcnZpY2U7XG4gICAgfVxuICAgIG5nT25Jbml0KCkge1xuICAgICAgICBzdXBlci5uZ09uSW5pdCgpO1xuICAgICAgICB0aGlzLnN1YnNjcmlwdGlvbnMuYWRkKHRoaXMuc2NoZWR1bGVyLmV2ZW50RGJsQ2xpY2suc3Vic2NyaWJlKHRoaXMuZWRpdEhhbmRsZXIuYmluZCh0aGlzKSkpO1xuICAgICAgICB0aGlzLnN1YnNjcmlwdGlvbnMuYWRkKHRoaXMuc2NoZWR1bGVyLnNhdmUuc3Vic2NyaWJlKHRoaXMuc2F2ZUhhbmRsZXIuYmluZCh0aGlzKSkpO1xuICAgIH1cbiAgICBlZGl0SGFuZGxlcihhcmdzKSB7XG4gICAgICAgIGlmICghdGhpcy5pc0VuYWJsZWQoJ2VkaXQnKSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGVkaXRBcmdzID0gbmV3IEVkaXRFdmVudCh0aGlzLnNjaGVkdWxlciwgeyBkYXRhSXRlbTogYXJncy5ldmVudC5kYXRhSXRlbSwgZXZlbnQ6IGFyZ3MuZXZlbnQgfSk7XG4gICAgICAgIHRoaXMuZWRpdC5lbWl0KGVkaXRBcmdzKTtcbiAgICAgICAgaWYgKGVkaXRBcmdzLmlzRGVmYXVsdFByZXZlbnRlZCgpKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgbGV0IGRhdGFJdGVtID0gYXJncy5ldmVudC5kYXRhSXRlbTtcbiAgICAgICAgaWYgKHRoaXMuZWRpdFNlcnZpY2UuaXNSZWN1cnJpbmcoZGF0YUl0ZW0pKSB7XG4gICAgICAgICAgICB0aGlzLmRpYWxvZ3NTZXJ2aWNlLm9wZW5SZWN1cnJpbmdDb25maXJtYXRpb25EaWFsb2coMCAvKiBFZGl0ICovKVxuICAgICAgICAgICAgICAgIC5waXBlKGZpbHRlcihtb2RlID0+IG1vZGUgIT09IHVuZGVmaW5lZCkpXG4gICAgICAgICAgICAgICAgLnN1YnNjcmliZSgobW9kZSkgPT4ge1xuICAgICAgICAgICAgICAgIGlmIChtb2RlID09PSAyIC8qIFNlcmllcyAqLykge1xuICAgICAgICAgICAgICAgICAgICBkYXRhSXRlbSA9IHRoaXMuZWRpdFNlcnZpY2UuZmluZFJlY3VycmVuY2VNYXN0ZXIoZGF0YUl0ZW0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjb25zdCBncm91cCA9IHRoaXMuY3JlYXRlTW9kZWwoe1xuICAgICAgICAgICAgICAgICAgICBhY3Rpb246ICdlZGl0JyxcbiAgICAgICAgICAgICAgICAgICAgaXNOZXc6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBtb2RlLFxuICAgICAgICAgICAgICAgICAgICBkYXRhSXRlbVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHRoaXMuc2NoZWR1bGVyLmVkaXRFdmVudChkYXRhSXRlbSwgeyBncm91cCwgbW9kZSB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgY29uc3QgZ3JvdXAgPSB0aGlzLmNyZWF0ZU1vZGVsKHtcbiAgICAgICAgICAgICAgICBhY3Rpb246ICdlZGl0JyxcbiAgICAgICAgICAgICAgICBpc05ldzogZmFsc2UsXG4gICAgICAgICAgICAgICAgbW9kZTogMCAvKiBFdmVudCAqLyxcbiAgICAgICAgICAgICAgICBkYXRhSXRlbVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB0aGlzLnNjaGVkdWxlci5lZGl0RXZlbnQoZGF0YUl0ZW0sIHsgZ3JvdXAgfSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc2F2ZUhhbmRsZXIoYXJncykge1xuICAgICAgICBpZiAodGhpcy5pc0Zvcm1WYWxpZChhcmdzKSkge1xuICAgICAgICAgICAgY29uc3QgZm9ybVZhbHVlID0gYXJncy5mb3JtR3JvdXAudmFsdWU7XG4gICAgICAgICAgICBpZiAoYXJncy5pc05ldykge1xuICAgICAgICAgICAgICAgIHRoaXMuZWRpdFNlcnZpY2UuY3JlYXRlKGZvcm1WYWx1ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLmhhbmRsZVVwZGF0ZShhcmdzLmRhdGFJdGVtLCBmb3JtVmFsdWUsIGFyZ3MubW9kZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5jbG9zZUVkaXRvcigpO1xuICAgIH1cbiAgICBjcmVhdGVNb2RlbChhcmdzKSB7XG4gICAgICAgIC8vIEFsaWFzIGBldmVudGAgZm9yIGJhY2t3YXJkcyBjb21wYXRpYmlsaXR5LlxuICAgICAgICBhcmdzLmV2ZW50ID0gYXJncy5kYXRhSXRlbTtcbiAgICAgICAgcmV0dXJuIHRoaXMuY3JlYXRlRm9ybUdyb3VwKGFyZ3MpO1xuICAgIH1cbiAgICBpc0Zvcm1WYWxpZCh7IGZvcm1Hcm91cCwgaXNOZXcgfSkge1xuICAgICAgICBpZiAoZm9ybUdyb3VwLnZhbGlkKSB7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIWZvcm1Hcm91cC5kaXJ0eSAmJiAhaXNOZXcpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICBtYXJrQWxsQXNUb3VjaGVkKGZvcm1Hcm91cCk7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG59XG5SZWFjdGl2ZUVkaXRpbmdEaXJlY3RpdmUuZGVjb3JhdG9ycyA9IFtcbiAgICB7IHR5cGU6IERpcmVjdGl2ZSwgYXJnczogW3tcbiAgICAgICAgICAgICAgICBzZWxlY3RvcjogJ1trZW5kb1NjaGVkdWxlclJlYWN0aXZlRWRpdGluZ10nXG4gICAgICAgICAgICB9LF0gfSxcbl07XG4vKiogQG5vY29sbGFwc2UgKi9cblJlYWN0aXZlRWRpdGluZ0RpcmVjdGl2ZS5jdG9yUGFyYW1ldGVycyA9ICgpID0+IFtcbiAgICB7IHR5cGU6IFNjaGVkdWxlckNvbXBvbmVudCB9LFxuICAgIHsgdHlwZTogTG9jYWxEYXRhQ2hhbmdlc1NlcnZpY2UgfSxcbiAgICB7IHR5cGU6IERpYWxvZ3NTZXJ2aWNlIH1cbl07XG5SZWFjdGl2ZUVkaXRpbmdEaXJlY3RpdmUucHJvcERlY29yYXRvcnMgPSB7XG4gICAgY3JlYXRlRm9ybUdyb3VwOiBbeyB0eXBlOiBJbnB1dCwgYXJnczogWydrZW5kb1NjaGVkdWxlclJlYWN0aXZlRWRpdGluZycsXSB9XVxufTtcblxuLyoqXG4gKiBAaGlkZGVuXG4gKi9cbmNsYXNzIFJlc291cmNlRWRpdG9yQmFzZSB7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHRoaXMudmFsdWVDaGFuZ2UgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XG4gICAgICAgIHRoaXMuZ2V0RmllbGQgPSBnZXRGaWVsZDtcbiAgICAgICAgdGhpcy5vblRvdWNoZWRDYWxsYmFjayA9IChfKSA9PiB7IH07XG4gICAgICAgIHRoaXMub25DaGFuZ2VDYWxsYmFjayA9IChfKSA9PiB7IH07XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEBoaWRkZW5cbiAgICAgKi9cbiAgICB3cml0ZVZhbHVlKG5ld1ZhbHVlKSB7XG4gICAgICAgIHRoaXMucmVzb3VyY2VWYWx1ZSA9IG5ld1ZhbHVlO1xuICAgIH1cbiAgICBnZXRSZXNvdXJjZVN0eWxlKGRhdGFJdGVtKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAnYmFja2dyb3VuZC1jb2xvcic6IGdldEZpZWxkKGRhdGFJdGVtLCB0aGlzLnJlc291cmNlLmNvbG9yRmllbGQpLFxuICAgICAgICAgICAgJ21hcmdpbi1yaWdodCc6IGlzUHJlc2VudChnZXRGaWVsZChkYXRhSXRlbSwgdGhpcy5yZXNvdXJjZS52YWx1ZUZpZWxkKSkgPyAnOHB4JyA6ICc0cHgnXG4gICAgICAgIH07XG4gICAgfVxuICAgIG9uUmVzb3VyY2VWYWx1ZUNoYW5nZShuZXdWYWx1ZSkge1xuICAgICAgICB0aGlzLnJlc291cmNlVmFsdWUgPSBuZXdWYWx1ZTtcbiAgICAgICAgdGhpcy5lbWl0Q2hhbmdlKHRoaXMucmVzb3VyY2VWYWx1ZSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEBoaWRkZW5cbiAgICAgKi9cbiAgICByZWdpc3Rlck9uQ2hhbmdlKGZuKSB7XG4gICAgICAgIHRoaXMub25DaGFuZ2VDYWxsYmFjayA9IGZuO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBAaGlkZGVuXG4gICAgICovXG4gICAgcmVnaXN0ZXJPblRvdWNoZWQoZm4pIHtcbiAgICAgICAgdGhpcy5vblRvdWNoZWRDYWxsYmFjayA9IGZuO1xuICAgIH1cbiAgICBlbWl0Q2hhbmdlKHZhbHVlKSB7XG4gICAgICAgIHRoaXMub25DaGFuZ2VDYWxsYmFjayh2YWx1ZSk7XG4gICAgICAgIHRoaXMudmFsdWVDaGFuZ2UuZW1pdCh2YWx1ZSk7XG4gICAgfVxufVxuUmVzb3VyY2VFZGl0b3JCYXNlLnByb3BEZWNvcmF0b3JzID0ge1xuICAgIHJlc291cmNlOiBbeyB0eXBlOiBJbnB1dCB9XSxcbiAgICB2YWx1ZUNoYW5nZTogW3sgdHlwZTogT3V0cHV0IH1dXG59O1xuXG4vKiB0c2xpbnQ6ZGlzYWJsZTogbm8tdXNlLWJlZm9yZS1kZWNsYXJlICovXG4vKiB0c2xpbnQ6ZGlzYWJsZTogbm8tZm9yd2FyZC1yZWYgKi9cbi8qKlxuICogQGhpZGRlblxuICovXG5jb25zdCBNVUxUSVBMRV9SRVNPVVJDRV9WQUxVRV9BQ0NFU1NPUiA9IHtcbiAgICBtdWx0aTogdHJ1ZSxcbiAgICBwcm92aWRlOiBOR19WQUxVRV9BQ0NFU1NPUixcbiAgICB1c2VFeGlzdGluZzogZm9yd2FyZFJlZigoKSA9PiBNdWx0aXBsZVJlc291cmNlRWRpdG9yQ29tcG9uZW50KVxufTtcbi8qKlxuICogQGhpZGRlblxuICovXG5jbGFzcyBNdWx0aXBsZVJlc291cmNlRWRpdG9yQ29tcG9uZW50IGV4dGVuZHMgUmVzb3VyY2VFZGl0b3JCYXNlIHtcbiAgICBnZXRUYWdTdHlsZShkYXRhSXRlbSkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgJ2JhY2tncm91bmQtY29sb3InOiBkYXRhSXRlbVt0aGlzLnJlc291cmNlLmNvbG9yRmllbGRdXG4gICAgICAgIH07XG4gICAgfVxuICAgIGZvY3VzKCkge1xuICAgICAgICB0aGlzLnJlc291cmNlTXVsdGlTZWxlY3QuZm9jdXMoKTtcbiAgICB9XG59XG5NdWx0aXBsZVJlc291cmNlRWRpdG9yQ29tcG9uZW50LmRlY29yYXRvcnMgPSBbXG4gICAgeyB0eXBlOiBDb21wb25lbnQsIGFyZ3M6IFt7XG4gICAgICAgICAgICAgICAgcHJvdmlkZXJzOiBbXG4gICAgICAgICAgICAgICAgICAgIE1VTFRJUExFX1JFU09VUkNFX1ZBTFVFX0FDQ0VTU09SXG4gICAgICAgICAgICAgICAgXSxcbiAgICAgICAgICAgICAgICBzZWxlY3RvcjogJ2tlbmRvLW11bHRpcGxlLXJlc291cmNlLWVkaXRvcicsXG4gICAgICAgICAgICAgICAgdGVtcGxhdGU6IGBcbiAgICAgICAgPGtlbmRvLW11bHRpc2VsZWN0XG4gICAgICAgICAgICAjcmVzb3VyY2VNdWx0aVNlbGVjdFxuICAgICAgICAgICAgW2RhdGFdPSdyZXNvdXJjZS5kYXRhJ1xuICAgICAgICAgICAgW3RleHRGaWVsZF09J3Jlc291cmNlLnRleHRGaWVsZCdcbiAgICAgICAgICAgIFt2YWx1ZUZpZWxkXT0ncmVzb3VyY2UudmFsdWVGaWVsZCdcbiAgICAgICAgICAgIFt2YWx1ZVByaW1pdGl2ZV09J3RydWUnXG4gICAgICAgICAgICBbdmFsdWVdPSdyZXNvdXJjZVZhbHVlJ1xuICAgICAgICAgICAgKHZhbHVlQ2hhbmdlKT0nb25SZXNvdXJjZVZhbHVlQ2hhbmdlKCRldmVudCknXG4gICAgICAgID5cbiAgICAgICAgICAgIDxuZy10ZW1wbGF0ZSBrZW5kb0Ryb3BEb3duTGlzdEl0ZW1UZW1wbGF0ZSBsZXQtZGF0YUl0ZW0+XG4gICAgICAgICAgICAgICAgPHNwYW4gKm5nSWY9XCJyZXNvdXJjZS5jb2xvckZpZWxkXCIgY2xhc3M9XCJrLXNjaGVkdWxlci1tYXJrXCJcbiAgICAgICAgICAgICAgICBbbmdTdHlsZV09XCJnZXRSZXNvdXJjZVN0eWxlKGRhdGFJdGVtKVwiPjwvc3Bhbj5cbiAgICAgICAgICAgICAgICB7eyBnZXRGaWVsZChkYXRhSXRlbSwgcmVzb3VyY2UudGV4dEZpZWxkKSB9fVxuICAgICAgICAgICAgPC9uZy10ZW1wbGF0ZT5cbiAgICAgICAgICAgIDxuZy10ZW1wbGF0ZSBrZW5kb011bHRpU2VsZWN0VGFnVGVtcGxhdGUgbGV0LWRhdGFJdGVtPlxuICAgICAgICAgICAgICAgIDxzcGFuICpuZ0lmPVwicmVzb3VyY2UuY29sb3JGaWVsZFwiIGNsYXNzPVwiay1zY2hlZHVsZXItbWFya1wiXG4gICAgICAgICAgICAgICAgW25nU3R5bGVdPVwiZ2V0VGFnU3R5bGUoZGF0YUl0ZW0pXCI+PC9zcGFuPlxuICAgICAgICAgICAgICAgIHt7IGdldEZpZWxkKGRhdGFJdGVtLCByZXNvdXJjZS50ZXh0RmllbGQpIH19XG4gICAgICAgICAgICA8L25nLXRlbXBsYXRlPlxuICAgICAgICA8L2tlbmRvLW11bHRpc2VsZWN0PlxuICAgIGBcbiAgICAgICAgICAgIH0sXSB9LFxuXTtcbk11bHRpcGxlUmVzb3VyY2VFZGl0b3JDb21wb25lbnQucHJvcERlY29yYXRvcnMgPSB7XG4gICAgcmVzb3VyY2VNdWx0aVNlbGVjdDogW3sgdHlwZTogVmlld0NoaWxkLCBhcmdzOiBbJ3Jlc291cmNlTXVsdGlTZWxlY3QnLF0gfV1cbn07XG5cbi8qIHRzbGludDpkaXNhYmxlOiBuby11c2UtYmVmb3JlLWRlY2xhcmUgKi9cbi8qIHRzbGludDpkaXNhYmxlOiBuby1mb3J3YXJkLXJlZiAqL1xuLyoqXG4gKiBAaGlkZGVuXG4gKi9cbmNvbnN0IFNJTkdMRV9SRVNPVVJDRV9WQUxVRV9BQ0NFU1NPUiA9IHtcbiAgICBtdWx0aTogdHJ1ZSxcbiAgICBwcm92aWRlOiBOR19WQUxVRV9BQ0NFU1NPUixcbiAgICB1c2VFeGlzdGluZzogZm9yd2FyZFJlZigoKSA9PiBTaW5nbGVSZXNvdXJjZUVkaXRvckNvbXBvbmVudClcbn07XG4vKipcbiAqIEBoaWRkZW5cbiAqL1xuY2xhc3MgU2luZ2xlUmVzb3VyY2VFZGl0b3JDb21wb25lbnQgZXh0ZW5kcyBSZXNvdXJjZUVkaXRvckJhc2Uge1xuICAgIGZvY3VzKCkge1xuICAgICAgICB0aGlzLnJlc291cmNlRHJvcERvd24uZm9jdXMoKTtcbiAgICB9XG59XG5TaW5nbGVSZXNvdXJjZUVkaXRvckNvbXBvbmVudC5kZWNvcmF0b3JzID0gW1xuICAgIHsgdHlwZTogQ29tcG9uZW50LCBhcmdzOiBbe1xuICAgICAgICAgICAgICAgIHByb3ZpZGVyczogW1xuICAgICAgICAgICAgICAgICAgICBTSU5HTEVfUkVTT1VSQ0VfVkFMVUVfQUNDRVNTT1JcbiAgICAgICAgICAgICAgICBdLFxuICAgICAgICAgICAgICAgIHNlbGVjdG9yOiAna2VuZG8tc2luZ2xlLXJlc291cmNlLWVkaXRvcicsXG4gICAgICAgICAgICAgICAgdGVtcGxhdGU6IGBcbiAgICAgICAgPGtlbmRvLWRyb3Bkb3dubGlzdFxuICAgICAgICAgICAgI3Jlc291cmNlRHJvcERvd25cbiAgICAgICAgICAgIFtkYXRhXT0ncmVzb3VyY2UuZGF0YSdcbiAgICAgICAgICAgIFt0ZXh0RmllbGRdPSdyZXNvdXJjZS50ZXh0RmllbGQnXG4gICAgICAgICAgICBbdmFsdWVGaWVsZF09J3Jlc291cmNlLnZhbHVlRmllbGQnXG4gICAgICAgICAgICBbdmFsdWVQcmltaXRpdmVdPSd0cnVlJ1xuICAgICAgICAgICAgW3ZhbHVlXT0ncmVzb3VyY2VWYWx1ZSdcbiAgICAgICAgICAgICh2YWx1ZUNoYW5nZSk9J29uUmVzb3VyY2VWYWx1ZUNoYW5nZSgkZXZlbnQpJ1xuICAgICAgICA+XG4gICAgICAgICAgICA8bmctdGVtcGxhdGUga2VuZG9Ecm9wRG93bkxpc3RJdGVtVGVtcGxhdGUgbGV0LWRhdGFJdGVtPlxuICAgICAgICAgICAgICAgIDxzcGFuICpuZ0lmPVwicmVzb3VyY2UuY29sb3JGaWVsZFwiIGNsYXNzPVwiay1zY2hlZHVsZXItbWFya1wiXG4gICAgICAgICAgICAgICAgW25nU3R5bGVdPVwiZ2V0UmVzb3VyY2VTdHlsZShkYXRhSXRlbSlcIj48L3NwYW4+XG4gICAgICAgICAgICAgICAge3sgZ2V0RmllbGQoZGF0YUl0ZW0sIHJlc291cmNlLnRleHRGaWVsZCkgfX1cbiAgICAgICAgICAgIDwvbmctdGVtcGxhdGU+XG4gICAgICAgIDwva2VuZG8tZHJvcGRvd25saXN0PlxuICAgIGBcbiAgICAgICAgICAgIH0sXSB9LFxuXTtcblNpbmdsZVJlc291cmNlRWRpdG9yQ29tcG9uZW50LnByb3BEZWNvcmF0b3JzID0ge1xuICAgIHJlc291cmNlRHJvcERvd246IFt7IHR5cGU6IFZpZXdDaGlsZCwgYXJnczogWydyZXNvdXJjZURyb3BEb3duJyxdIH1dXG59O1xuXG4vLyB0c2xpbnQ6ZGlzYWJsZTpuby1iaXR3aXNlXG4vKipcbiAqIEBoaWRkZW5cbiAqL1xudmFyIE1vZGlmaWVycztcbihmdW5jdGlvbiAoTW9kaWZpZXJzKSB7XG4gICAgTW9kaWZpZXJzW01vZGlmaWVyc1tcIk5vbmVcIl0gPSAwXSA9IFwiTm9uZVwiO1xuICAgIE1vZGlmaWVyc1tNb2RpZmllcnNbXCJBbHRLZXlcIl0gPSAxXSA9IFwiQWx0S2V5XCI7XG4gICAgTW9kaWZpZXJzW01vZGlmaWVyc1tcIkN0cmxLZXlcIl0gPSAyXSA9IFwiQ3RybEtleVwiO1xuICAgIE1vZGlmaWVyc1tNb2RpZmllcnNbXCJTaGlmdEtleVwiXSA9IDRdID0gXCJTaGlmdEtleVwiO1xuICAgIE1vZGlmaWVyc1tNb2RpZmllcnNbXCJNZXRhS2V5XCJdID0gOF0gPSBcIk1ldGFLZXlcIjtcbn0pKE1vZGlmaWVycyB8fCAoTW9kaWZpZXJzID0ge30pKTtcbi8qKlxuICogQGhpZGRlblxuICovXG5mdW5jdGlvbiB3aXRoTW9kaWZpZXJzKGUsIG1vZGlmaWVycykge1xuICAgIHJldHVybiBlLmFsdEtleSA9PT0gKChtb2RpZmllcnMgJiBNb2RpZmllcnMuQWx0S2V5KSA9PT0gTW9kaWZpZXJzLkFsdEtleSkgJiZcbiAgICAgICAgZS5jdHJsS2V5ID09PSAoKG1vZGlmaWVycyAmIE1vZGlmaWVycy5DdHJsS2V5KSA9PT0gTW9kaWZpZXJzLkN0cmxLZXkpICYmXG4gICAgICAgIGUuc2hpZnRLZXkgPT09ICgobW9kaWZpZXJzICYgTW9kaWZpZXJzLlNoaWZ0S2V5KSA9PT0gTW9kaWZpZXJzLlNoaWZ0S2V5KSAmJlxuICAgICAgICBlLm1ldGFLZXkgPT09ICgobW9kaWZpZXJzICYgTW9kaWZpZXJzLk1ldGFLZXkpID09PSBNb2RpZmllcnMuTWV0YUtleSk7XG59XG4vKipcbiAqIEBoaWRkZW5cbiAqL1xuZnVuY3Rpb24gbm9Nb2RpZmllcnMoZSkge1xuICAgIHJldHVybiB3aXRoTW9kaWZpZXJzKGUsIE1vZGlmaWVycy5Ob25lKTtcbn1cblxuLyoqXG4gKiBAaGlkZGVuXG4gKi9cbmNsYXNzIEVkaXREaWFsb2dDb21wb25lbnQge1xuICAgIGNvbnN0cnVjdG9yKG5nWm9uZSwgZWRpdFNlcnZpY2UsIGxvY2FsaXphdGlvbiwgY2hhbmdlRGV0ZWN0b3IsIGVsZW1lbnQsIGZvY3VzU2VydmljZSkge1xuICAgICAgICB0aGlzLm5nWm9uZSA9IG5nWm9uZTtcbiAgICAgICAgdGhpcy5lZGl0U2VydmljZSA9IGVkaXRTZXJ2aWNlO1xuICAgICAgICB0aGlzLmxvY2FsaXphdGlvbiA9IGxvY2FsaXphdGlvbjtcbiAgICAgICAgdGhpcy5jaGFuZ2VEZXRlY3RvciA9IGNoYW5nZURldGVjdG9yO1xuICAgICAgICB0aGlzLmVsZW1lbnQgPSBlbGVtZW50O1xuICAgICAgICB0aGlzLmZvY3VzU2VydmljZSA9IGZvY3VzU2VydmljZTtcbiAgICAgICAgdGhpcy5yZXNvdXJjZXMgPSBbXTtcbiAgICAgICAgdGhpcy50aW1lem9uZSA9ICdFdGMvVVRDJztcbiAgICAgICAgdGhpcy5zZXRUaW1lWm9uZSA9IGZhbHNlO1xuICAgICAgICB0aGlzLnNldFNlcGFyYXRlU3RhcnRFbmRUaW1lWm9uZXMgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5zdWJzID0gdGhpcy5lZGl0U2VydmljZS5jaGFuZ2VkLnN1YnNjcmliZSgoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLm5nWm9uZS5ydW4oKCkgPT4geyB0aGlzLm9uQ2hhbmdlKCk7IH0pO1xuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5zdWJzLmFkZChmcm9tRXZlbnQodGhpcy5lbGVtZW50Lm5hdGl2ZUVsZW1lbnQsICdrZXlkb3duJylcbiAgICAgICAgICAgIC5waXBlKGZpbHRlcigoKSA9PiB0aGlzLmlzQWN0aXZlKSlcbiAgICAgICAgICAgIC5zdWJzY3JpYmUoKGUpID0+IHtcbiAgICAgICAgICAgIGlmIChlLmtleUNvZGUgPT09IEtleXMuRXNjYXBlKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5yZXNldCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGUua2V5Q29kZSA9PT0gS2V5cy5FbnRlciAmJiAod2l0aE1vZGlmaWVycyhlLCBNb2RpZmllcnMuQ3RybEtleSkgfHwgd2l0aE1vZGlmaWVycyhlLCBNb2RpZmllcnMuTWV0YUtleSkpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5vblNhdmUoZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICB9KSk7XG4gICAgfVxuICAgIGdldCBhdXRvRm9jdXNlZEVsZW1lbnQoKSB7XG4gICAgICAgIGlmICh0aGlzLmVkaXRUZW1wbGF0ZSkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZWRpdFRlbXBsYXRlLmF1dG9Gb2N1c2VkRWxlbWVudDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gJy5rLWVkaXQtZmllbGQgaW5wdXQnO1xuICAgIH1cbiAgICBnZXQgaXNFZGl0aW5nU2VyaWVzKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5lZGl0TW9kZSA9PT0gMiAvKiBTZXJpZXMgKi8gJiYgQm9vbGVhbih0aGlzLmZvcm1Hcm91cC5nZXQodGhpcy5maWVsZHMucmVjdXJyZW5jZVJ1bGUpKTtcbiAgICB9XG4gICAgZ2V0IGV2ZW50VGltZXpvbmUoKSB7XG4gICAgICAgIHJldHVybiBmb3JtVmFsdWVPckRlZmF1bHQodGhpcy5mb3JtR3JvdXAsIHRoaXMuZmllbGRzLnN0YXJ0VGltZXpvbmUsIHRoaXMudGltZXpvbmUpO1xuICAgIH1cbiAgICBnZXQgZW5kVGltZXpvbmUoKSB7XG4gICAgICAgIHJldHVybiBmb3JtVmFsdWVPckRlZmF1bHQodGhpcy5mb3JtR3JvdXAsIHRoaXMuZmllbGRzLmVuZFRpbWV6b25lLCB0aGlzLmV2ZW50VGltZXpvbmUpO1xuICAgIH1cbiAgICBvbkNoYW5nZSgpIHtcbiAgICAgICAgdGhpcy5jaGFuZ2VEZXRlY3Rvci5tYXJrRm9yQ2hlY2soKTtcbiAgICAgICAgaWYgKHRoaXMuZWRpdFNlcnZpY2UuaGFzTmV3RXZlbnQpIHtcbiAgICAgICAgICAgIHRoaXMuZWRpdE1vZGUgPSAyIC8qIFNlcmllcyAqLztcbiAgICAgICAgICAgIHRoaXMuZm9ybUdyb3VwID0gdGhpcy5lZGl0U2VydmljZS5jb250ZXh0LmZvcm1Hcm91cDtcbiAgICAgICAgICAgIHRoaXMuaXNOZXcgPSB0cnVlO1xuICAgICAgICAgICAgdGhpcy5hcHBseUxvY2FsVGltZXpvbmUoKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICh0aGlzLmVkaXRTZXJ2aWNlLmlzRWRpdGluZygpKSB7XG4gICAgICAgICAgICBjb25zdCB7IGRhdGFJdGVtLCBtb2RlIH0gPSB0aGlzLmVkaXRTZXJ2aWNlLmNvbnRleHQ7XG4gICAgICAgICAgICB0aGlzLmZvcm1Hcm91cCA9IHRoaXMuZWRpdFNlcnZpY2UuY29udGV4dC5mb3JtR3JvdXA7XG4gICAgICAgICAgICB0aGlzLmlzTmV3ID0gZmFsc2U7XG4gICAgICAgICAgICB0aGlzLmVkaXRlZEV2ZW50ID0gZGF0YUl0ZW07XG4gICAgICAgICAgICB0aGlzLmVkaXRNb2RlID0gaXNQcmVzZW50KG1vZGUpID8gbW9kZSA6IDIgLyogU2VyaWVzICovO1xuICAgICAgICAgICAgdGhpcy5hcHBseUxvY2FsVGltZXpvbmUoKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMucmVzZXQoKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIXRoaXMuZWRpdFRlbXBsYXRlKSB7XG4gICAgICAgICAgICB0aGlzLmFkZFRpbWVab25lQ2hlY2tib3hlc1RvRm9ybUdyb3VwKCk7XG4gICAgICAgICAgICB0aGlzLnN1YnNjcmliZVRvRm9ybUdyb3VwQ2hhbmdlcygpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChpc1ByZXNlbnQodGhpcy5mb3JtR3JvdXApKSB7XG4gICAgICAgICAgICB0aGlzLnJlY3VycmVuY2VTdGFydCA9IHRoaXMuZm9ybUdyb3VwLmdldCh0aGlzLmZpZWxkcy5zdGFydCkudmFsdWU7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5pc0FjdGl2ZSA9IHRydWU7XG4gICAgfVxuICAgIG5nT25EZXN0cm95KCkge1xuICAgICAgICBpZiAodGhpcy5zdWJzKSB7XG4gICAgICAgICAgICB0aGlzLnN1YnMudW5zdWJzY3JpYmUoKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBvbkNhbmNlbChlKSB7XG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgdGhpcy5vbkNsb3NlKCk7XG4gICAgICAgIHRoaXMuY2hhbmdlRGV0ZWN0b3IubWFya0ZvckNoZWNrKCk7XG4gICAgfVxuICAgIG9uU2F2ZShlKSB7XG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgdGhpcy5hcHBseVRpbWV6b25lKCk7XG4gICAgICAgIHRoaXMuZWRpdFNlcnZpY2Uuc2F2ZSgpO1xuICAgICAgICB0aGlzLmNoYW5nZURldGVjdG9yLm1hcmtGb3JDaGVjaygpO1xuICAgIH1cbiAgICBvbkNsb3NlKCkge1xuICAgICAgICB0aGlzLmVkaXRTZXJ2aWNlLmVuZEVkaXQoKTtcbiAgICAgICAgdGhpcy5jaGFuZ2VEZXRlY3Rvci5tYXJrRm9yQ2hlY2soKTtcbiAgICAgICAgdGhpcy5mb2N1c1NlcnZpY2UuZm9jdXMoKTtcbiAgICB9XG4gICAgZ2V0IGhhc0FsbERheSgpIHtcbiAgICAgICAgcmV0dXJuIEJvb2xlYW4odGhpcy5mb3JtR3JvdXAuZ2V0KHRoaXMuZmllbGRzLmlzQWxsRGF5KSk7XG4gICAgfVxuICAgIGdldCBoYXNTdGFydFRpbWVab25lKCkge1xuICAgICAgICByZXR1cm4gQm9vbGVhbih0aGlzLmZvcm1Hcm91cC5nZXQodGhpcy5maWVsZHMuc3RhcnRUaW1lem9uZSkpO1xuICAgIH1cbiAgICBnZXQgaXNTdGFydFRpbWVab25lVmlzaWJsZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZm9ybUdyb3VwICYmIHRoaXMuZm9ybUdyb3VwLmdldCgnc3RhcnRUaW1lem9uZUNoZWNrYm94JykudmFsdWU7XG4gICAgfVxuICAgIGdldCBoYXNFbmRUaW1lWm9uZSgpIHtcbiAgICAgICAgcmV0dXJuIEJvb2xlYW4odGhpcy5mb3JtR3JvdXAuZ2V0KHRoaXMuZmllbGRzLmVuZFRpbWV6b25lKSk7XG4gICAgfVxuICAgIGdldCBpc0VuZFRpbWVab25lVmlzaWJsZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZm9ybUdyb3VwICYmIHRoaXMuZm9ybUdyb3VwLmdldCgnZW5kVGltZXpvbmVDaGVja2JveCcpLnZhbHVlO1xuICAgIH1cbiAgICBnZXRGb3JtVmFsdWUoZmllbGQpIHtcbiAgICAgICAgaWYgKGZpZWxkKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5mb3JtR3JvdXAuZ2V0KGZpZWxkKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICB0ZXh0Rm9yKGtleSkge1xuICAgICAgICByZXR1cm4gdGhpcy5sb2NhbGl6YXRpb24uZ2V0KGtleSk7XG4gICAgfVxuICAgIG9uUmVzb3VyY2VDbGljayhyZXNvdXJjZSkge1xuICAgICAgICBjb25zdCByZXNvdXJjZUVkaXRvcnMgPSByZXNvdXJjZS5tdWx0aXBsZSA/IHRoaXMubXVsdGlwbGVSZXNvdXJjZUVkaXRvcnMgOiB0aGlzLnNpbmdsZVJlc291cmNlRWRpdG9ycztcbiAgICAgICAgY29uc3QgY3VycmVudEVkaXRvciA9IHJlc291cmNlRWRpdG9ycy5maWx0ZXIoKGVkaXRvcikgPT4gZWRpdG9yLnJlc291cmNlLmZpZWxkID09PSByZXNvdXJjZS5maWVsZCkucG9wKCk7XG4gICAgICAgIGlmIChjdXJyZW50RWRpdG9yKSB7XG4gICAgICAgICAgICBjdXJyZW50RWRpdG9yLmZvY3VzKCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmVzZXQoKSB7XG4gICAgICAgIHRoaXMuaXNBY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5zZXRUaW1lWm9uZSA9IGZhbHNlO1xuICAgICAgICB0aGlzLnNldFNlcGFyYXRlU3RhcnRFbmRUaW1lWm9uZXMgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5yZW1vdmVUaW1lWm9uZUNoZWNrYm94ZXNGcm9tRm9ybUdyb3VwKCk7XG4gICAgICAgIHRoaXMuZm9jdXNTZXJ2aWNlLmZvY3VzKCk7XG4gICAgfVxuICAgIGFkZFRpbWVab25lQ2hlY2tib3hlc1RvRm9ybUdyb3VwKCkge1xuICAgICAgICBpZiAoaXNQcmVzZW50KHRoaXMuZm9ybUdyb3VwKSkge1xuICAgICAgICAgICAgY29uc3Qgc3RhcnRGaWVsZCA9IHRoaXMuZmllbGRzLnN0YXJ0VGltZXpvbmU7XG4gICAgICAgICAgICB0aGlzLmZvcm1Hcm91cC5hZGRDb250cm9sKCdzdGFydFRpbWV6b25lQ2hlY2tib3gnLCBuZXcgRm9ybUNvbnRyb2wodGhpcy5mb3JtR3JvdXAuY29udGFpbnMoc3RhcnRGaWVsZCkgJiZcbiAgICAgICAgICAgICAgICB0aGlzLmZvcm1Hcm91cC5nZXQoc3RhcnRGaWVsZCkudmFsdWUpKTtcbiAgICAgICAgICAgIGNvbnN0IGVuZEZpZWxkID0gdGhpcy5maWVsZHMuZW5kVGltZXpvbmU7XG4gICAgICAgICAgICB0aGlzLmZvcm1Hcm91cC5hZGRDb250cm9sKCdlbmRUaW1lem9uZUNoZWNrYm94JywgbmV3IEZvcm1Db250cm9sKHRoaXMuZm9ybUdyb3VwLmNvbnRhaW5zKGVuZEZpZWxkKSAmJlxuICAgICAgICAgICAgICAgIHRoaXMuZm9ybUdyb3VwLmdldChlbmRGaWVsZCkudmFsdWUpKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZW1vdmVUaW1lWm9uZUNoZWNrYm94ZXNGcm9tRm9ybUdyb3VwKCkge1xuICAgICAgICBpZiAoaXNQcmVzZW50KHRoaXMuZm9ybUdyb3VwKSkge1xuICAgICAgICAgICAgdGhpcy5mb3JtR3JvdXAucmVtb3ZlQ29udHJvbCgnc3RhcnRUaW1lem9uZUNoZWNrYm94Jyk7XG4gICAgICAgICAgICB0aGlzLmZvcm1Hcm91cC5yZW1vdmVDb250cm9sKCdlbmRUaW1lem9uZUNoZWNrYm94Jyk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc3Vic2NyaWJlVG9Gb3JtR3JvdXBDaGFuZ2VzKCkge1xuICAgICAgICBpZiAoaXNQcmVzZW50KHRoaXMuZm9ybUdyb3VwKSkge1xuICAgICAgICAgICAgY29uc3QgZmllbGRzID0gdGhpcy5maWVsZHM7XG4gICAgICAgICAgICB0aGlzLmZvcm1Hcm91cC5nZXQoJ3N0YXJ0VGltZXpvbmVDaGVja2JveCcpLnZhbHVlQ2hhbmdlcy5zdWJzY3JpYmUoaXNUcnVlID0+IHtcbiAgICAgICAgICAgICAgICBpZiAoIWlzVHJ1ZSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmZvcm1Hcm91cC5nZXQoZmllbGRzLnN0YXJ0VGltZXpvbmUpLnNldFZhbHVlKG51bGwsIHsgZW1pdEV2ZW50OiBmYWxzZSB9KTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5mb3JtR3JvdXAuZ2V0KGZpZWxkcy5lbmRUaW1lem9uZSkuc2V0VmFsdWUobnVsbCwgeyBlbWl0RXZlbnQ6IGZhbHNlIH0pO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmZvcm1Hcm91cC5nZXQoJ2VuZFRpbWV6b25lQ2hlY2tib3gnKS5zZXRWYWx1ZShmYWxzZSwgeyBlbWl0RXZlbnQ6IGZhbHNlIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgdGhpcy5mb3JtR3JvdXAuZ2V0KCdlbmRUaW1lem9uZUNoZWNrYm94JykudmFsdWVDaGFuZ2VzLnN1YnNjcmliZShpc1RydWUgPT4ge1xuICAgICAgICAgICAgICAgIGlmICghaXNUcnVlKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZm9ybUdyb3VwLmdldChmaWVsZHMuZW5kVGltZXpvbmUpLnNldFZhbHVlKG51bGwsIHsgZW1pdEV2ZW50OiBmYWxzZSB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHRoaXMuZm9ybUdyb3VwLmdldChmaWVsZHMuc3RhcnQpLnZhbHVlQ2hhbmdlcy5zdWJzY3JpYmUoKG5ld1N0YXJ0KSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5yZWN1cnJlbmNlU3RhcnQgPSBuZXdTdGFydDtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENvbnZlcnRzIHRoZSBldmVudCBkYXRlcyB0byBcImRpc3BsYXkgZGF0ZXNcIiB0aGF0IGxvb2sgbGlrZSB0aGUgb3JpZ2luYWwgZGF0ZSBpbiBpdHMgdGltZSB6b25lLlxuICAgICAqIFRoZSByZXN1bHQgZG9lcyBub3QgcmVwcmVzZW50IHRoZSBzYW1lIG1vbWVudCBpbiB0aW1lIGFuZCBtdXN0IGJlIGNvbnZlcnRlZCBiYWNrIHRvIGxvY2FsIGRhdGVzLlxuICAgICAqL1xuICAgIGFwcGx5TG9jYWxUaW1lem9uZSgpIHtcbiAgICAgICAgY29uc3QgZmllbGRzID0gdGhpcy5maWVsZHM7XG4gICAgICAgIGNvbnN0IHN0YXJ0ID0gdGhpcy5yZWFkRGF0ZUFzTG9jYWwoZmllbGRzLnN0YXJ0LCB0aGlzLmV2ZW50VGltZXpvbmUpO1xuICAgICAgICBjb25zdCBlbmQgPSB0aGlzLnJlYWREYXRlQXNMb2NhbChmaWVsZHMuZW5kLCB0aGlzLmVuZFRpbWV6b25lKTtcbiAgICAgICAgdGhpcy5mb3JtR3JvdXAuZ2V0KGZpZWxkcy5zdGFydCkucmVzZXQoc3RhcnQpO1xuICAgICAgICB0aGlzLmZvcm1Hcm91cC5nZXQoZmllbGRzLmVuZCkucmVzZXQoZW5kKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ29udmVydHMgdGhlIFwiZGlzcGxheSBkYXRlc1wiIHVzZWQgYnkgdGhlIGVkaXRvcnMgYmFjayB0byBsb2NhbCBkYXRlcyB0aGF0IHJlcHJlc2VudCB0aGUgdHJ1ZSBtb21lbnQgaW4gdGltZS5cbiAgICAgKi9cbiAgICBhcHBseVRpbWV6b25lKCkge1xuICAgICAgICBjb25zdCBmaWVsZHMgPSB0aGlzLmZpZWxkcztcbiAgICAgICAgY29uc3Qgc3RhcnQgPSB0aGlzLnJlYWREYXRlV2l0aFRpbWV6b25lKGZpZWxkcy5zdGFydCwgdGhpcy5ldmVudFRpbWV6b25lKTtcbiAgICAgICAgY29uc3QgZW5kID0gdGhpcy5yZWFkRGF0ZVdpdGhUaW1lem9uZShmaWVsZHMuZW5kLCB0aGlzLmVuZFRpbWV6b25lKTtcbiAgICAgICAgdGhpcy5mb3JtR3JvdXAuZ2V0KGZpZWxkcy5zdGFydCkucmVzZXQoc3RhcnQpO1xuICAgICAgICB0aGlzLmZvcm1Hcm91cC5nZXQoZmllbGRzLmVuZCkucmVzZXQoZW5kKTtcbiAgICB9XG4gICAgcmVhZERhdGVXaXRoVGltZXpvbmUoZmllbGQsIHRpbWV6b25lKSB7XG4gICAgICAgIGNvbnN0IHZhbHVlID0gdGhpcy5mb3JtR3JvdXAuZ2V0KGZpZWxkKS52YWx1ZTtcbiAgICAgICAgcmV0dXJuIFpvbmVkRGF0ZS5mcm9tVVRDRGF0ZSh0b1VUQ0RhdGVUaW1lKHZhbHVlKSwgdGltZXpvbmUpLnRvTG9jYWxEYXRlKCk7XG4gICAgfVxuICAgIHJlYWREYXRlQXNMb2NhbChmaWVsZCwgdGltZXpvbmUpIHtcbiAgICAgICAgY29uc3QgdmFsdWUgPSB0aGlzLmZvcm1Hcm91cC5nZXQoZmllbGQpLnZhbHVlO1xuICAgICAgICByZXR1cm4gdG9Mb2NhbERhdGUoWm9uZWREYXRlLmZyb21Mb2NhbERhdGUodmFsdWUsIHRpbWV6b25lKS50b1VUQ0RhdGUoKSk7XG4gICAgfVxufVxuRWRpdERpYWxvZ0NvbXBvbmVudC5kZWNvcmF0b3JzID0gW1xuICAgIHsgdHlwZTogQ29tcG9uZW50LCBhcmdzOiBbe1xuICAgICAgICAgICAgICAgIHNlbGVjdG9yOiAna2VuZG8tc2NoZWR1bGVyLWVkaXQtZGlhbG9nJyxcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZTogYFxuICAgICAgICA8a2VuZG8tZGlhbG9nIChjbG9zZSk9J29uQ2xvc2UoKScgW21pbldpZHRoXT0nNzAwJyAqbmdJZj0naXNBY3RpdmUnIHRpdGxlPSd7eyB0ZXh0Rm9yKFwiZWRpdG9yVGl0bGVcIikgfX0nIGNsYXNzPSdrLXNjaGVkdWxlci1lZGl0LWRpYWxvZycgW2F1dG9Gb2N1c2VkRWxlbWVudF09XCJhdXRvRm9jdXNlZEVsZW1lbnRcIj5cbiAgICAgICAgICAgIDxuZy1jb250YWluZXIgKm5nSWY9JyFlZGl0VGVtcGxhdGUnPlxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9J2stc2NoZWR1bGVyLWVkaXQtZm9ybSc+XG4gICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9J2stZWRpdC1mb3JtLWNvbnRhaW5lcic+XG4gICAgICAgICAgICAgICAgICAgICAgICA8Zm9ybSBub3ZhbGlkYXRlIFtmb3JtR3JvdXBdPSdmb3JtR3JvdXAnPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9J2stZWRpdC1sYWJlbCc+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxsYWJlbCBmb3I9J2stZXZlbnQtdGl0bGUnPnt7IHRleHRGb3IoJ2VkaXRvckV2ZW50VGl0bGUnKSB9fTwvbGFiZWw+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0nay1lZGl0LWZpZWxkJz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGlucHV0ICN0aXRsZSBpZD0nay1ldmVudC10aXRsZScgY2xhc3M9J2stdGV4dGJveCcgcGxhY2Vob2xkZXI9J1RpdGxlJyBbZm9ybUNvbnRyb2xdPSdmb3JtR3JvdXAuZ2V0KGZpZWxkcy50aXRsZSknIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSdrLWVkaXQtbGFiZWwnPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8bGFiZWwgKGNsaWNrKT1cInN0YXJ0RGF0ZVRpbWVQaWNrZXIuZm9jdXMoKVwiPnt7IHRleHRGb3IoJ2VkaXRvckV2ZW50U3RhcnQnKSB9fTwvbGFiZWw+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0nay1lZGl0LWZpZWxkJz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGtlbmRvLXNjaGVkdWxlci1kYXRldGltZS1waWNrZXIgI3N0YXJ0RGF0ZVRpbWVQaWNrZXIgW2Zvcm1Db250cm9sXT0nZm9ybUdyb3VwLmdldChmaWVsZHMuc3RhcnQpJ1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgW2lzQWxsRGF5XT0nZ2V0Rm9ybVZhbHVlKGZpZWxkcy5pc0FsbERheSk/LnZhbHVlJz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9rZW5kby1zY2hlZHVsZXItZGF0ZXRpbWUtcGlja2VyPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPG5nLWNvbnRhaW5lciAqbmdJZj1cImlzU3RhcnRUaW1lWm9uZVZpc2libGVcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0nay1lZGl0LWxhYmVsJz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxsYWJlbCAoY2xpY2spPVwic3RhcnRUelBpY2tlci5mb2N1cygpXCI+e3sgdGV4dEZvcignZWRpdG9yRXZlbnRTdGFydFRpbWVab25lJykgfX08L2xhYmVsPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSdrLWVkaXQtZmllbGQnPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGtlbmRvLXRpbWV6b25lLWVkaXRvciAjc3RhcnRUelBpY2tlciBbZm9ybUNvbnRyb2xdPSdmb3JtR3JvdXAuZ2V0KGZpZWxkcy5zdGFydFRpbWV6b25lKSc+PC9rZW5kby10aW1lem9uZS1lZGl0b3I+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvbmctY29udGFpbmVyPlxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0nay1lZGl0LWxhYmVsJz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGxhYmVsIChjbGljayk9XCJlbmREYXRlVGltZVBpY2tlci5mb2N1cygpXCI+e3sgdGV4dEZvcignZWRpdG9yRXZlbnRFbmQnKSB9fTwvbGFiZWw+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0nay1lZGl0LWZpZWxkJz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGtlbmRvLXNjaGVkdWxlci1kYXRldGltZS1waWNrZXIgI2VuZERhdGVUaW1lUGlja2VyIFtmb3JtQ29udHJvbF09J2Zvcm1Hcm91cC5nZXQoZmllbGRzLmVuZCknXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbaXNBbGxEYXldPSdnZXRGb3JtVmFsdWUoZmllbGRzLmlzQWxsRGF5KT8udmFsdWUnPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2tlbmRvLXNjaGVkdWxlci1kYXRldGltZS1waWNrZXI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8bmctY29udGFpbmVyICpuZ0lmPVwiaXNFbmRUaW1lWm9uZVZpc2libGVcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0nay1lZGl0LWxhYmVsJz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxsYWJlbCAoY2xpY2spPVwiZW5kVHpQaWNrZXIuZm9jdXMoKVwiPnt7IHRleHRGb3IoJ2VkaXRvckV2ZW50RW5kVGltZVpvbmUnKSB9fTwvbGFiZWw+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9J2stZWRpdC1maWVsZCc+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8a2VuZG8tdGltZXpvbmUtZWRpdG9yICNlbmRUelBpY2tlciBbZm9ybUNvbnRyb2xdPSdmb3JtR3JvdXAuZ2V0KGZpZWxkcy5lbmRUaW1lem9uZSknPjwva2VuZG8tdGltZXpvbmUtZWRpdG9yPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L25nLWNvbnRhaW5lcj5cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9J2stZWRpdC1maWVsZCcgKm5nSWY9XCJoYXNBbGxEYXlcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGlucHV0IHR5cGU9J2NoZWNrYm94JyBpZD0nay1pcy1hbGxkYXktY2hrYm94JyBjbGFzcz0nay1jaGVja2JveCcgW2Zvcm1Db250cm9sXT0nZm9ybUdyb3VwLmdldChmaWVsZHMuaXNBbGxEYXkpJyAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8bGFiZWwgY2xhc3M9J2stY2hlY2tib3gtbGFiZWwnIGZvcj0nay1pcy1hbGxkYXktY2hrYm94Jz57eyB0ZXh0Rm9yKCdlZGl0b3JFdmVudEFsbERheScpIH19PC9sYWJlbD5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9J2stZWRpdC1maWVsZCcgKm5nSWY9XCJoYXNTdGFydFRpbWVab25lXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxpbnB1dCB0eXBlPSdjaGVja2JveCcgaWQ9J2stc2V0LXRpbWV6b25lJyBjbGFzcz0nay1jaGVja2JveCdcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9ybUNvbnRyb2xOYW1lPSdzdGFydFRpbWV6b25lQ2hlY2tib3gnIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxsYWJlbCBjbGFzcz0nay1jaGVja2JveC1sYWJlbCcgZm9yPSdrLXNldC10aW1lem9uZSc+e3sgdGV4dEZvcignZWRpdG9yRXZlbnRUaW1lWm9uZScpIH19PC9sYWJlbD5cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8bmctY29udGFpbmVyICpuZ0lmPVwiaXNTdGFydFRpbWVab25lVmlzaWJsZSAmJiBoYXNFbmRUaW1lWm9uZVwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGlucHV0IHR5cGU9J2NoZWNrYm94JyBpZD0nay11c2Utc2VwYXJhdGUnIGNsYXNzPSdrLWNoZWNrYm94JyBmb3JtQ29udHJvbE5hbWU9J2VuZFRpbWV6b25lQ2hlY2tib3gnIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8bGFiZWwgY2xhc3M9J2stY2hlY2tib3gtbGFiZWwnIGZvcj0nay11c2Utc2VwYXJhdGUnPnt7IHRleHRGb3IoJ2VkaXRvckV2ZW50U2VwYXJhdGVUaW1lWm9uZXMnKSB9fTwvbGFiZWw+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvbmctY29udGFpbmVyPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPG5nLWNvbnRhaW5lciAqbmdJZj1cImlzRWRpdGluZ1Nlcmllc1wiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8a2VuZG8tcmVjdXJyZW5jZS1lZGl0b3JcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFtmb3JtQ29udHJvbF09J2Zvcm1Hcm91cC5nZXQoZmllbGRzLnJlY3VycmVuY2VSdWxlKSdcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFtzdGFydF09J3JlY3VycmVuY2VTdGFydCdcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFt0aW1lem9uZV09J2V2ZW50VGltZXpvbmUnXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID48L2tlbmRvLXJlY3VycmVuY2UtZWRpdG9yPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvbmctY29udGFpbmVyPlxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPG5nLWNvbnRhaW5lciAqbmdJZj0nZ2V0Rm9ybVZhbHVlKGZpZWxkcy5kZXNjcmlwdGlvbiknPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSdrLWVkaXQtbGFiZWwnPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGxhYmVsIGZvcj0nay1ldmVudC1kZXNjcmlwdGlvbic+e3sgdGV4dEZvcignZWRpdG9yRXZlbnREZXNjcmlwdGlvbicpIH19PC9sYWJlbD5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9J2stZWRpdC1maWVsZCc+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGV4dGFyZWEgaWQ9J2stZXZlbnQtZGVzY3JpcHRpb24nIGNsYXNzPSdrLXRleHRib3gnIFtmb3JtQ29udHJvbF09J2Zvcm1Hcm91cC5nZXQoZmllbGRzLmRlc2NyaXB0aW9uKSc+PC90ZXh0YXJlYT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9uZy1jb250YWluZXI+XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8bmctY29udGFpbmVyICpuZ0Zvcj0nbGV0IHJlc291cmNlIG9mIHJlc291cmNlcyc+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxuZy1jb250YWluZXIgKm5nSWY9J2dldEZvcm1WYWx1ZShyZXNvdXJjZS5maWVsZCknPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0nay1lZGl0LWxhYmVsJz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8bGFiZWwgKGNsaWNrKT1cIm9uUmVzb3VyY2VDbGljayhyZXNvdXJjZSlcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge3sgcmVzb3VyY2UubmFtZSA/IHJlc291cmNlLm5hbWUgOiByZXNvdXJjZS5maWVsZCB9fVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvbGFiZWw+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9J2stZWRpdC1maWVsZCc+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGtlbmRvLW11bHRpcGxlLXJlc291cmNlLWVkaXRvclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqbmdJZj0ncmVzb3VyY2UubXVsdGlwbGUnXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFtmb3JtQ29udHJvbF09J2Zvcm1Hcm91cC5nZXQocmVzb3VyY2UuZmllbGQpJ1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbcmVzb3VyY2VdPSdyZXNvdXJjZSc+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9rZW5kby1tdWx0aXBsZS1yZXNvdXJjZS1lZGl0b3I+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGtlbmRvLXNpbmdsZS1yZXNvdXJjZS1lZGl0b3JcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKm5nSWY9JyFyZXNvdXJjZS5tdWx0aXBsZSdcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgW2Zvcm1Db250cm9sXT0nZm9ybUdyb3VwLmdldChyZXNvdXJjZS5maWVsZCknXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFtyZXNvdXJjZV09J3Jlc291cmNlJz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2tlbmRvLXNpbmdsZS1yZXNvdXJjZS1lZGl0b3I+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9uZy1jb250YWluZXI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9uZy1jb250YWluZXI+XG4gICAgICAgICAgICAgICAgICAgICAgICA8L2Zvcm0+XG4gICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgPC9uZy1jb250YWluZXI+XG5cbiAgICAgICAgICAgIDxuZy1jb250YWluZXIgKm5nSWY9J2VkaXRUZW1wbGF0ZSc+XG4gICAgICAgICAgICAgICAgPGZvcm0gbm92YWxpZGF0ZSBbZm9ybUdyb3VwXT0nZm9ybUdyb3VwJz5cbiAgICAgICAgICAgICAgICAgICAgPG5nLWNvbnRhaW5lciBbbmdUZW1wbGF0ZU91dGxldF09J2VkaXRUZW1wbGF0ZS50ZW1wbGF0ZVJlZidcbiAgICAgICAgICAgICAgICAgICAgICAgIFtuZ1RlbXBsYXRlT3V0bGV0Q29udGV4dF09XCJ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJGltcGxpY2l0OiBmb3JtR3JvdXAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9ybUdyb3VwOiBmb3JtR3JvdXAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YUl0ZW06IGVkaXRlZEV2ZW50LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVkaXRNb2RlOiBlZGl0TW9kZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpc05ldzogaXNOZXdcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cIj5cbiAgICAgICAgICAgICAgICAgICAgPC9uZy1jb250YWluZXI+XG4gICAgICAgICAgICAgICAgPC9mb3JtPlxuICAgICAgICAgICAgPC9uZy1jb250YWluZXI+XG5cbiAgICAgICAgICAgIDxrZW5kby1kaWFsb2ctYWN0aW9ucz5cbiAgICAgICAgICAgICAgICA8YnV0dG9uIGNsYXNzPVwiay1idXR0b25cIiAoY2xpY2spPVwib25DYW5jZWwoJGV2ZW50KVwiPnt7IHRleHRGb3IoJ2NhbmNlbCcpIH19PC9idXR0b24+XG4gICAgICAgICAgICAgICAgPGJ1dHRvbiBjbGFzcz1cImstYnV0dG9uIGstcHJpbWFyeVwiIChjbGljayk9XCJvblNhdmUoJGV2ZW50KVwiIFtkaXNhYmxlZF09XCIhZm9ybUdyb3VwLnZhbGlkXCI+e3sgdGV4dEZvcignc2F2ZScpIH19PC9idXR0b24+XG4gICAgICAgICAgICA8L2tlbmRvLWRpYWxvZy1hY3Rpb25zPlxuICAgICAgICA8L2tlbmRvLWRpYWxvZz5cbiAgICBgXG4gICAgICAgICAgICB9LF0gfSxcbl07XG4vKiogQG5vY29sbGFwc2UgKi9cbkVkaXREaWFsb2dDb21wb25lbnQuY3RvclBhcmFtZXRlcnMgPSAoKSA9PiBbXG4gICAgeyB0eXBlOiBOZ1pvbmUgfSxcbiAgICB7IHR5cGU6IEVkaXRTZXJ2aWNlIH0sXG4gICAgeyB0eXBlOiBMb2NhbGl6YXRpb25TZXJ2aWNlIH0sXG4gICAgeyB0eXBlOiBDaGFuZ2VEZXRlY3RvclJlZiB9LFxuICAgIHsgdHlwZTogRWxlbWVudFJlZiB9LFxuICAgIHsgdHlwZTogRm9jdXNTZXJ2aWNlIH1cbl07XG5FZGl0RGlhbG9nQ29tcG9uZW50LnByb3BEZWNvcmF0b3JzID0ge1xuICAgIG11bHRpcGxlUmVzb3VyY2VFZGl0b3JzOiBbeyB0eXBlOiBWaWV3Q2hpbGRyZW4sIGFyZ3M6IFtNdWx0aXBsZVJlc291cmNlRWRpdG9yQ29tcG9uZW50LF0gfV0sXG4gICAgc2luZ2xlUmVzb3VyY2VFZGl0b3JzOiBbeyB0eXBlOiBWaWV3Q2hpbGRyZW4sIGFyZ3M6IFtTaW5nbGVSZXNvdXJjZUVkaXRvckNvbXBvbmVudCxdIH1dLFxuICAgIHJlc291cmNlczogW3sgdHlwZTogSW5wdXQgfV0sXG4gICAgdGltZXpvbmU6IFt7IHR5cGU6IElucHV0IH1dLFxuICAgIGZpZWxkczogW3sgdHlwZTogSW5wdXQgfV0sXG4gICAgZWRpdFRlbXBsYXRlOiBbeyB0eXBlOiBJbnB1dCB9XVxufTtcblxuLyogdHNsaW50OmRpc2FibGU6IG5vLXVzZS1iZWZvcmUtZGVjbGFyZSAqL1xuLyogdHNsaW50OmRpc2FibGU6IG5vLWZvcndhcmQtcmVmICovXG4vKipcbiAqIEBoaWRkZW5cbiAqL1xuY29uc3QgU0NIRURVTEVSX0RBVEVUSU1FUElDS0VSX1ZBTFVFX0FDQ0VTU09SID0ge1xuICAgIG11bHRpOiB0cnVlLFxuICAgIHByb3ZpZGU6IE5HX1ZBTFVFX0FDQ0VTU09SLFxuICAgIHVzZUV4aXN0aW5nOiBmb3J3YXJkUmVmKCgpID0+IFNjaGVkdWxlckRhdGVUaW1lUGlja2VyQ29tcG9uZW50KVxufTtcbi8qKlxuICogQGhpZGRlblxuICovXG5jbGFzcyBTY2hlZHVsZXJEYXRlVGltZVBpY2tlckNvbXBvbmVudCB7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHRoaXMudmFsdWVDaGFuZ2UgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XG4gICAgICAgIHRoaXMub25Ub3VjaGVkQ2FsbGJhY2sgPSAoXykgPT4geyB9O1xuICAgICAgICB0aGlzLm9uQ2hhbmdlQ2FsbGJhY2sgPSAoXykgPT4geyB9O1xuICAgIH1cbiAgICB3cml0ZVZhbHVlKG5ld0RhdGUpIHtcbiAgICAgICAgaWYgKG5ld0RhdGUgaW5zdGFuY2VvZiBEYXRlKSB7XG4gICAgICAgICAgICB0aGlzLmRhdGUgPSBuZXdEYXRlO1xuICAgICAgICB9XG4gICAgfVxuICAgIG9uVmFsdWVDaGFuZ2UobmV3VmFsdWUpIHtcbiAgICAgICAgdGhpcy5vbkNoYW5nZUNhbGxiYWNrKG5ld1ZhbHVlKTtcbiAgICAgICAgdGhpcy52YWx1ZUNoYW5nZS5lbWl0KG5ld1ZhbHVlKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQGhpZGRlblxuICAgICAqL1xuICAgIGZvY3VzKCkge1xuICAgICAgICB0aGlzLmRhdGVQaWNrZXIuZm9jdXMoKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQGhpZGRlblxuICAgICAqL1xuICAgIHJlZ2lzdGVyT25DaGFuZ2UoZm4pIHtcbiAgICAgICAgdGhpcy5vbkNoYW5nZUNhbGxiYWNrID0gZm47XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEBoaWRkZW5cbiAgICAgKi9cbiAgICByZWdpc3Rlck9uVG91Y2hlZChmbikge1xuICAgICAgICB0aGlzLm9uVG91Y2hlZENhbGxiYWNrID0gZm47XG4gICAgfVxufVxuU2NoZWR1bGVyRGF0ZVRpbWVQaWNrZXJDb21wb25lbnQuZGVjb3JhdG9ycyA9IFtcbiAgICB7IHR5cGU6IENvbXBvbmVudCwgYXJnczogW3tcbiAgICAgICAgICAgICAgICBwcm92aWRlcnM6IFtcbiAgICAgICAgICAgICAgICAgICAgU0NIRURVTEVSX0RBVEVUSU1FUElDS0VSX1ZBTFVFX0FDQ0VTU09SXG4gICAgICAgICAgICAgICAgXSxcbiAgICAgICAgICAgICAgICBzZWxlY3RvcjogJ2tlbmRvLXNjaGVkdWxlci1kYXRldGltZS1waWNrZXInLFxuICAgICAgICAgICAgICAgIHRlbXBsYXRlOiBgXG4gICAgPGtlbmRvLWRhdGVwaWNrZXJcbiAgICAgICAgI2RhdGVwaWNrZXJcbiAgICAgICAgWyh2YWx1ZSldPSdkYXRlJ1xuICAgICAgICAodmFsdWVDaGFuZ2UpPSdvblZhbHVlQ2hhbmdlKCRldmVudCknXG4gICAgPjwva2VuZG8tZGF0ZXBpY2tlcj5cbiAgICA8a2VuZG8tdGltZXBpY2tlciAqbmdJZj0nIWlzQWxsRGF5J1xuICAgICAgICBbKHZhbHVlKV09J2RhdGUnXG4gICAgICAgICh2YWx1ZUNoYW5nZSk9J29uVmFsdWVDaGFuZ2UoJGV2ZW50KSdcbiAgICA+PC9rZW5kby10aW1lcGlja2VyPlxuICAgIGBcbiAgICAgICAgICAgIH0sXSB9LFxuXTtcblNjaGVkdWxlckRhdGVUaW1lUGlja2VyQ29tcG9uZW50LnByb3BEZWNvcmF0b3JzID0ge1xuICAgIGRhdGVQaWNrZXI6IFt7IHR5cGU6IFZpZXdDaGlsZCwgYXJnczogWydkYXRlcGlja2VyJyxdIH1dLFxuICAgIGlzQWxsRGF5OiBbeyB0eXBlOiBJbnB1dCB9XSxcbiAgICB2YWx1ZUNoYW5nZTogW3sgdHlwZTogT3V0cHV0IH1dXG59O1xuXG5sZXQgdW5pcXVlSWRDb3VudGVyID0gMDtcbmNvbnN0IG9mZnNldFBvc2l0aW9ucyA9IFsnZmlyc3QnLCAnc2Vjb25kJywgJ3RoaXJkJywgJ2ZvdXJ0aCcsICdsYXN0J107XG5jb25zdCBmcmVxdWVuY2llcyA9IFsnbmV2ZXInLCAnZGFpbHknLCAnd2Vla2x5JywgJ21vbnRobHknLCAneWVhcmx5J107XG4vKipcbiAqIEBoaWRkZW5cbiAqL1xuY29uc3QgZGF5UnVsZSA9IFtcbiAgICB7IGRheTogMCwgb2Zmc2V0OiAwIH0sXG4gICAgeyBkYXk6IDEsIG9mZnNldDogMCB9LFxuICAgIHsgZGF5OiAyLCBvZmZzZXQ6IDAgfSxcbiAgICB7IGRheTogMywgb2Zmc2V0OiAwIH0sXG4gICAgeyBkYXk6IDQsIG9mZnNldDogMCB9LFxuICAgIHsgZGF5OiA1LCBvZmZzZXQ6IDAgfSxcbiAgICB7IGRheTogNiwgb2Zmc2V0OiAwIH1cbl07XG4vKipcbiAqIEBoaWRkZW5cbiAqL1xuY29uc3Qgd2Vla2RheVJ1bGUgPSBbXG4gICAgeyBkYXk6IDEsIG9mZnNldDogMCB9LFxuICAgIHsgZGF5OiAyLCBvZmZzZXQ6IDAgfSxcbiAgICB7IGRheTogMywgb2Zmc2V0OiAwIH0sXG4gICAgeyBkYXk6IDQsIG9mZnNldDogMCB9LFxuICAgIHsgZGF5OiA1LCBvZmZzZXQ6IDAgfVxuXTtcbi8qKlxuICogQGhpZGRlblxuICovXG5jb25zdCB3ZWVrZW5kUnVsZSA9IFtcbiAgICB7IGRheTogMCwgb2Zmc2V0OiAwIH0sXG4gICAgeyBkYXk6IDYsIG9mZnNldDogMCB9XG5dO1xuLyoqXG4gKiBAaGlkZGVuXG4gKlxuICogVGhlIGludGVybmFsIHNlcnZpY2UgZm9yIGhhbmRsaW5nIGNoYW5nZXMgaW4gdGhlIFJlY3VycmVuY2VFZGl0b3IgY29tcG9uZW50LlxuICovXG5jbGFzcyBSZWN1cnJlbmNlU2VydmljZSB7XG4gICAgY29uc3RydWN0b3IoaW50bCwgbG9jYWxpemF0aW9uKSB7XG4gICAgICAgIHRoaXMuaW50bCA9IGludGw7XG4gICAgICAgIHRoaXMubG9jYWxpemF0aW9uID0gbG9jYWxpemF0aW9uO1xuICAgICAgICB0aGlzLmNoYW5nZSA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcbiAgICAgICAgdGhpcy5lbmRSdWxlQ2hhbmdlID0gbmV3IEV2ZW50RW1pdHRlcigpO1xuICAgICAgICB0aGlzLmZyZXF1ZW5jeUNoYW5nZSA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcbiAgICAgICAgdGhpcy5yZXBlYXRPblJ1bGVDaGFuZ2UgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XG4gICAgfVxuICAgIGluaXQocnJ1bGUgPSBcIlwiLCBzdGFydCwgdGltZXpvbmUpIHtcbiAgICAgICAgdGhpcy5ycnVsZSA9IHBhcnNlUnVsZSh7XG4gICAgICAgICAgICByZWN1cnJlbmNlUnVsZTogcnJ1bGUsXG4gICAgICAgICAgICB3ZWVrU3RhcnQ6IHRoaXMuaW50bC5maXJzdERheSgpXG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLnN0YXJ0ID0gc3RhcnQ7XG4gICAgICAgIHRoaXMudGltZXpvbmUgPSB0aW1lem9uZTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQGhpZGRlblxuICAgICAqL1xuICAgIGdldFVuaXF1ZUlkKCkge1xuICAgICAgICByZXR1cm4gdW5pcXVlSWRDb3VudGVyKys7XG4gICAgfVxuICAgIGdldCBmcmVxdWVuY2llcygpIHtcbiAgICAgICAgcmV0dXJuIGZyZXF1ZW5jaWVzLm1hcCgoZnJlcSkgPT4gKHtcbiAgICAgICAgICAgIHZhbHVlOiBmcmVxLFxuICAgICAgICAgICAgdGV4dDogdGhpcy5sb2NhbGl6YXRpb24uZ2V0KCdmcmVxdWVuY2llcycgKyBjYXBpdGFsaXplKGZyZXEpKVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIGdldCBmcmVxdWVuY3koKSB7XG4gICAgICAgIGlmIChpc1ByZXNlbnQodGhpcy5ycnVsZSkgJiYgIWlzTnVsbE9yRW1wdHlTdHJpbmcodGhpcy5ycnVsZS5mcmVxKSkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMucnJ1bGUuZnJlcTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gJ25ldmVyJztcbiAgICB9XG4gICAgc2V0RnJlcXVlbmN5KGZyZXEpIHtcbiAgICAgICAgdGhpcy5ycnVsZSA9IHt9O1xuICAgICAgICB0aGlzLnJydWxlLmZyZXEgPSBmcmVxO1xuICAgICAgICB0aGlzLnJydWxlLmludGVydmFsID0gMTtcbiAgICAgICAgaWYgKGZyZXEgPT09ICd3ZWVrbHknKSB7XG4gICAgICAgICAgICB0aGlzLnJydWxlLmJ5V2Vla0RheSA9IFt7XG4gICAgICAgICAgICAgICAgICAgIGRheTogdGhpcy5zdGFydC5nZXREYXkoKSxcbiAgICAgICAgICAgICAgICAgICAgb2Zmc2V0OiAwXG4gICAgICAgICAgICAgICAgfV07XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGZyZXEgPT09ICdtb250aGx5JyB8fCBmcmVxID09PSAneWVhcmx5Jykge1xuICAgICAgICAgICAgdGhpcy5ycnVsZS5ieU1vbnRoRGF5ID0gW3RoaXMuc3RhcnQuZ2V0RGF0ZSgpXTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoZnJlcSA9PT0gJ3llYXJseScpIHtcbiAgICAgICAgICAgIHRoaXMucnJ1bGUuYnlNb250aCA9IFt0aGlzLnN0YXJ0LmdldE1vbnRoKCkgKyAxXTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmZyZXF1ZW5jeUNoYW5nZS5lbWl0KCk7XG4gICAgICAgIHRoaXMub25DaGFuZ2UoKTtcbiAgICB9XG4gICAgc2V0IGludGVydmFsKG5ld0ludGVydmFsKSB7XG4gICAgICAgIHRoaXMucnJ1bGUuaW50ZXJ2YWwgPSBuZXdJbnRlcnZhbDtcbiAgICAgICAgdGhpcy5vbkNoYW5nZSgpO1xuICAgIH1cbiAgICBzZXQgY291bnQobmV3Q291bnQpIHtcbiAgICAgICAgdGhpcy5ycnVsZS5jb3VudCA9IG5ld0NvdW50O1xuICAgICAgICB0aGlzLm9uQ2hhbmdlKCk7XG4gICAgfVxuICAgIHNldCB1bnRpbChuZXdVbnRpbCkge1xuICAgICAgICB0aGlzLnJydWxlLnVudGlsID0gWm9uZWREYXRlLmZyb21Mb2NhbERhdGUobmV3VW50aWwsIHRoaXMudGltZXpvbmUpO1xuICAgICAgICB0aGlzLm9uQ2hhbmdlKCk7XG4gICAgfVxuICAgIGdldCB1bnRpbCgpIHtcbiAgICAgICAgaWYgKGlzUHJlc2VudCh0aGlzLnJydWxlLnVudGlsKSkge1xuICAgICAgICAgICAgcmV0dXJuIHRvTG9jYWxEYXRlKHRoaXMucnJ1bGUudW50aWwpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHNldFdlZWtEYXlzKG5ld1dlZWtEYXlzKSB7XG4gICAgICAgIHRoaXMucnJ1bGUuYnlXZWVrRGF5ID0gbmV3V2Vla0RheXM7XG4gICAgICAgIHRoaXMub25DaGFuZ2UoKTtcbiAgICB9XG4gICAgc2V0IG1vbnRoRGF5cyhuZXdNb250aERheXMpIHtcbiAgICAgICAgdGhpcy5ycnVsZS5ieU1vbnRoRGF5ID0gbmV3TW9udGhEYXlzO1xuICAgICAgICB0aGlzLm9uQ2hhbmdlKCk7XG4gICAgfVxuICAgIHNldCBwb3NpdGlvbnMobmV3UG9zaXRpb25zKSB7XG4gICAgICAgIHRoaXMucnJ1bGUuYnlTZXRQb3NpdGlvbiA9IG5ld1Bvc2l0aW9ucztcbiAgICAgICAgdGhpcy5vbkNoYW5nZSgpO1xuICAgIH1cbiAgICBzZXRNb250aHMobmV3TW9udGhzKSB7XG4gICAgICAgIHRoaXMucnJ1bGUuYnlNb250aCA9IG5ld01vbnRocztcbiAgICAgICAgdGhpcy5vbkNoYW5nZSgpO1xuICAgIH1cbiAgICBnZXQgbW9udGhzKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5pbnRsLmRhdGVGb3JtYXROYW1lcyh7XG4gICAgICAgICAgICB0eXBlOiAnbW9udGhzJyxcbiAgICAgICAgICAgIG5hbWVUeXBlOiAnd2lkZSdcbiAgICAgICAgfSkubWFwKChtb250aCwgaWR4KSA9PiAoe1xuICAgICAgICAgICAgdGV4dDogbW9udGgsXG4gICAgICAgICAgICB2YWx1ZTogaWR4ICsgMVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIC8qXG4gICAgICAgIFRvRG8gUmVmYWN0b3Igd2Vla0RheXMgYW5kIGV4dGVuZGVkV2Vla0RheXMgZ2V0dGVycyBpbnRvIGEgc2luZ2xlIG1ldGhvZFxuICAgICovXG4gICAgZ2V0IHdlZWtEYXlzKCkge1xuICAgICAgICBjb25zdCBmaXJzdERheSA9IHRoaXMuaW50bC5maXJzdERheSgpO1xuICAgICAgICBjb25zdCBhYmJyTmFtZXMgPSB0aGlzLmludGwuZGF0ZUZvcm1hdE5hbWVzKHtcbiAgICAgICAgICAgIHR5cGU6ICdkYXlzJyxcbiAgICAgICAgICAgIG5hbWVUeXBlOiAnYWJicmV2aWF0ZWQnXG4gICAgICAgIH0pLm1hcCgoZGF5LCBpZHgpID0+ICh7XG4gICAgICAgICAgICB0ZXh0OiBkYXksXG4gICAgICAgICAgICB2YWx1ZTogaWR4XG4gICAgICAgIH0pKTtcbiAgICAgICAgLyogU29ydGluZyBhY2NvcmRpbmcgdG8gZmlyc3Qgd2VlayBkYXkgKi9cbiAgICAgICAgcmV0dXJuIChhYmJyTmFtZXMuc2xpY2UoZmlyc3REYXkpKS5jb25jYXQoYWJick5hbWVzLnNsaWNlKDAsIGZpcnN0RGF5KSk7XG4gICAgfVxuICAgIGdldCBleHRlbmRlZFdlZWtEYXlzKCkge1xuICAgICAgICBjb25zdCBmaXJzdERheSA9IHRoaXMuaW50bC5maXJzdERheSgpO1xuICAgICAgICBsZXQgd2lkZU5hbWVzID0gdGhpcy5pbnRsLmRhdGVGb3JtYXROYW1lcyh7XG4gICAgICAgICAgICB0eXBlOiAnZGF5cycsXG4gICAgICAgICAgICBuYW1lVHlwZTogJ3dpZGUnXG4gICAgICAgIH0pLm1hcCgoZGF5LCBpZHgpID0+ICh7XG4gICAgICAgICAgICB0ZXh0OiBkYXksXG4gICAgICAgICAgICB2YWx1ZTogaWR4XG4gICAgICAgIH0pKTtcbiAgICAgICAgY29uc3Qgc29ydGVkV2lkZU5hbWVzID0gKHdpZGVOYW1lcy5zbGljZShmaXJzdERheSkpLmNvbmNhdCh3aWRlTmFtZXMuc2xpY2UoMCwgZmlyc3REYXkpKTtcbiAgICAgICAgY29uc3Qgc3BlY2lhbFJ1bGVzID0gW1xuICAgICAgICAgICAgeyB0ZXh0OiB0aGlzLmxvY2FsaXphdGlvbi5nZXQoJ3dlZWtkYXlzRGF5JyksIHZhbHVlOiAnZGF5JyB9LFxuICAgICAgICAgICAgeyB0ZXh0OiB0aGlzLmxvY2FsaXphdGlvbi5nZXQoJ3dlZWtkYXlzV2Vla2RheScpLCB2YWx1ZTogJ3dlZWtkYXknIH0sXG4gICAgICAgICAgICB7IHRleHQ6IHRoaXMubG9jYWxpemF0aW9uLmdldCgnd2Vla2RheXNXZWVrZW5kZGF5JyksIHZhbHVlOiAnd2Vla2VuZCcgfVxuICAgICAgICBdO1xuICAgICAgICByZXR1cm4gc3BlY2lhbFJ1bGVzLmNvbmNhdChzb3J0ZWRXaWRlTmFtZXMpO1xuICAgIH1cbiAgICBnZXQgb2Zmc2V0UG9zaXRpb25zKCkge1xuICAgICAgICBjb25zdCB2YWx1ZXMgPSBbMSwgMiwgMywgNCwgLTFdO1xuICAgICAgICByZXR1cm4gb2Zmc2V0UG9zaXRpb25zLm1hcCgob2Zmc2V0LCBpZHgpID0+ICh7XG4gICAgICAgICAgICB0ZXh0OiB0aGlzLmxvY2FsaXphdGlvbi5nZXQoJ29mZnNldFBvc2l0aW9ucycgKyBjYXBpdGFsaXplKG9mZnNldCkpLFxuICAgICAgICAgICAgdmFsdWU6IHZhbHVlc1tpZHhdXG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgZ2V0IGVuZFJ1bGUoKSB7XG4gICAgICAgIGlmIChpc1ByZXNlbnQodGhpcy5ycnVsZS5jb3VudCkpIHtcbiAgICAgICAgICAgIHJldHVybiAnY291bnQnO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGlzUHJlc2VudCh0aGlzLnJydWxlLnVudGlsKSkge1xuICAgICAgICAgICAgcmV0dXJuICd1bnRpbCc7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gJ25ldmVyJztcbiAgICAgICAgfVxuICAgIH1cbiAgICBzZXQgZW5kUnVsZShlbmRSdWxlKSB7XG4gICAgICAgIGlmIChlbmRSdWxlID09PSAnY291bnQnKSB7XG4gICAgICAgICAgICB0aGlzLnJydWxlLnVudGlsID0gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChlbmRSdWxlID09PSAndW50aWwnKSB7XG4gICAgICAgICAgICB0aGlzLnJydWxlLmNvdW50ID0gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIC8qIG5ldmVyICovXG4gICAgICAgICAgICB0aGlzLnJydWxlLmNvdW50ID0gbnVsbDtcbiAgICAgICAgICAgIHRoaXMucnJ1bGUudW50aWwgPSBudWxsO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuZW5kUnVsZUNoYW5nZS5lbWl0KGVuZFJ1bGUpO1xuICAgICAgICB0aGlzLm9uQ2hhbmdlKCk7XG4gICAgfVxuICAgIGdldCByZXBlYXRPblJ1bGUoKSB7XG4gICAgICAgIGlmIChpc1ByZXNlbnQodGhpcy5ycnVsZS5ieVdlZWtEYXkpKSB7XG4gICAgICAgICAgICByZXR1cm4gJ3dlZWtkYXknO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGlzUHJlc2VudCh0aGlzLnJydWxlLmJ5TW9udGhEYXkpKSB7XG4gICAgICAgICAgICByZXR1cm4gJ21vbnRoZGF5JztcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG4gICAgc2V0IHJlcGVhdE9uUnVsZShyZXBlYXRPblJ1bGUpIHtcbiAgICAgICAgaWYgKHJlcGVhdE9uUnVsZSA9PT0gJ21vbnRoZGF5Jykge1xuICAgICAgICAgICAgdGhpcy5ycnVsZS5ieVdlZWtEYXkgPSBudWxsO1xuICAgICAgICAgICAgdGhpcy5ycnVsZS5ieVNldFBvc2l0aW9uID0gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIC8qIHdlZWtEYXlzICovXG4gICAgICAgICAgICB0aGlzLnJydWxlLmJ5TW9udGhEYXkgPSBudWxsO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMucmVwZWF0T25SdWxlQ2hhbmdlLmVtaXQocmVwZWF0T25SdWxlKTtcbiAgICAgICAgdGhpcy5vbkNoYW5nZSgpO1xuICAgIH1cbiAgICBvbkNoYW5nZSgpIHtcbiAgICAgICAgaWYgKHRoaXMuZnJlcXVlbmN5ID09PSAnbmV2ZXInKSB7XG4gICAgICAgICAgICB0aGlzLmNoYW5nZS5lbWl0KG51bGwpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5jaGFuZ2UuZW1pdChzZXJpYWxpemVSdWxlKHRoaXMucnJ1bGUsIHRoaXMudGltZXpvbmUpKTtcbiAgICAgICAgfVxuICAgIH1cbn1cblJlY3VycmVuY2VTZXJ2aWNlLmRlY29yYXRvcnMgPSBbXG4gICAgeyB0eXBlOiBJbmplY3RhYmxlIH0sXG5dO1xuLyoqIEBub2NvbGxhcHNlICovXG5SZWN1cnJlbmNlU2VydmljZS5jdG9yUGFyYW1ldGVycyA9ICgpID0+IFtcbiAgICB7IHR5cGU6IEludGxTZXJ2aWNlIH0sXG4gICAgeyB0eXBlOiBMb2NhbGl6YXRpb25TZXJ2aWNlIH1cbl07XG5cbi8qKlxuICogQGhpZGRlblxuICovXG5jbGFzcyBSZWN1cnJlbmNlTG9jYWxpemF0aW9uU2VydmljZSBleHRlbmRzIExvY2FsaXphdGlvblNlcnZpY2Uge1xuICAgIGNvbnN0cnVjdG9yKHByZWZpeCwgbWVzc2FnZVNlcnZpY2UsIF9ydGwsIHNjaGVkdWxlckxvY2FsaXphdGlvbikge1xuICAgICAgICBzdXBlcihwcmVmaXgsIG1lc3NhZ2VTZXJ2aWNlLCBfcnRsKTtcbiAgICAgICAgdGhpcy5zY2hlZHVsZXJMb2NhbGl6YXRpb24gPSBzY2hlZHVsZXJMb2NhbGl6YXRpb247XG4gICAgfVxuICAgIGdldChzaG9ydEtleSkge1xuICAgICAgICBpZiAodGhpcy5zY2hlZHVsZXJMb2NhbGl6YXRpb24pIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnNjaGVkdWxlckxvY2FsaXphdGlvbi5nZXQoJ3JlY3VycmVuY2VFZGl0b3InICsgY2FwaXRhbGl6ZShzaG9ydEtleSkpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBzdXBlci5nZXQoc2hvcnRLZXkpO1xuICAgIH1cbn1cbi8qKiBAbm9jb2xsYXBzZSAqL1xuUmVjdXJyZW5jZUxvY2FsaXphdGlvblNlcnZpY2UuY3RvclBhcmFtZXRlcnMgPSAoKSA9PiBbXG4gICAgeyB0eXBlOiBTdHJpbmcsIGRlY29yYXRvcnM6IFt7IHR5cGU6IEluamVjdCwgYXJnczogW0wxME5fUFJFRklYLF0gfV0gfSxcbiAgICB7IHR5cGU6IE1lc3NhZ2VTZXJ2aWNlLCBkZWNvcmF0b3JzOiBbeyB0eXBlOiBPcHRpb25hbCB9XSB9LFxuICAgIHsgdHlwZTogQm9vbGVhbiwgZGVjb3JhdG9yczogW3sgdHlwZTogT3B0aW9uYWwgfSwgeyB0eXBlOiBJbmplY3QsIGFyZ3M6IFtSVEwsXSB9XSB9LFxuICAgIHsgdHlwZTogU2NoZWR1bGVyTG9jYWxpemF0aW9uU2VydmljZSwgZGVjb3JhdG9yczogW3sgdHlwZTogT3B0aW9uYWwgfSwgeyB0eXBlOiBJbmplY3QsIGFyZ3M6IFtTY2hlZHVsZXJMb2NhbGl6YXRpb25TZXJ2aWNlLF0gfV0gfVxuXTtcblxuLyogdHNsaW50OmRpc2FibGU6IG5vLXVzZS1iZWZvcmUtZGVjbGFyZSAqL1xuLyogdHNsaW50OmRpc2FibGU6IG5vLWZvcndhcmQtcmVmICovXG4vKipcbiAqIEBoaWRkZW5cbiAqL1xuY29uc3QgUkVDVVJSRU5DRV9WQUxVRV9BQ0NFU1NPUiA9IHtcbiAgICBtdWx0aTogdHJ1ZSxcbiAgICBwcm92aWRlOiBOR19WQUxVRV9BQ0NFU1NPUixcbiAgICB1c2VFeGlzdGluZzogZm9yd2FyZFJlZigoKSA9PiBSZWN1cnJlbmNlRWRpdG9yQ29tcG9uZW50KVxufTtcbi8qKlxuICogUmVwcmVzZW50cyB0aGUgS2VuZG8gVUkgUmVjdXJyZW5jZSBFZGl0b3IgY29tcG9uZW50IGZvciBBbmd1bGFyLiBbVGhpcyBleGFtcGxlXSh7JSBzbHVnIGN1c3RvbV9yZWFjdGl2ZV9lZGl0aW5nX3NjaGVkdWxlciAlfSN0b2Mtc2V0dXApIGRlbW9uc3RyYXRlcyB0aGUgUmVjdXJyZW5jZSBFZGl0b3IsIGFtb25nIG90aGVyIGNvbXBvbmVudHMuXG4gKi9cbmNsYXNzIFJlY3VycmVuY2VFZGl0b3JDb21wb25lbnQge1xuICAgIGNvbnN0cnVjdG9yKHJlY3VycmVuY2VTZXJ2aWNlKSB7XG4gICAgICAgIHRoaXMucmVjdXJyZW5jZVNlcnZpY2UgPSByZWN1cnJlbmNlU2VydmljZTtcbiAgICAgICAgdGhpcy5jc3NDbGFzcyA9IHRydWU7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBTcGVjaWZpZXMgdGhlIGlkIG9mIHRoZSB0aW1lem9uZSB0aGF0IHdpbGwgYmUgdXNlZC5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMudGltZXpvbmUgPSAnRXRjL1VUQyc7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBGaXJlcyB3aGVuIHRoZSB2YWx1ZSBvZiB0aGUgY29tcG9uZW50IGhhcyBjaGFuZ2VkLlxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy52YWx1ZUNoYW5nZSA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcbiAgICAgICAgdGhpcy5vblRvdWNoZWRDYWxsYmFjayA9IChfKSA9PiB7IH07XG4gICAgICAgIHRoaXMub25DaGFuZ2VDYWxsYmFjayA9IChfKSA9PiB7IH07XG4gICAgICAgIHRoaXMuc3Vic2NyaXB0aW9ucyA9IHRoaXMucmVjdXJyZW5jZVNlcnZpY2UuY2hhbmdlLnN1YnNjcmliZSgocnJ1bGUpID0+IHtcbiAgICAgICAgICAgIHRoaXMuZW1pdENoYW5nZShycnVsZSk7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBTcGVjaWZpZXMgdGhlIHN0YXJ0IGRhdGUgb2YgdGhlIGV2ZW50LlxuICAgICAqL1xuICAgIHNldCBzdGFydCh2YWx1ZSkge1xuICAgICAgICB0aGlzLl9zdGFydCA9IHZhbHVlO1xuICAgIH1cbiAgICBnZXQgc3RhcnQoKSB7XG4gICAgICAgIHJldHVybiBpc1ByZXNlbnQodGhpcy5fc3RhcnQpID8gdGhpcy5fc3RhcnQgOiBnZXREYXRlKG5ldyBEYXRlKCkpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBAaGlkZGVuXG4gICAgICovXG4gICAgZ2V0IGN1cnJlbnRGcmVxKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5yZWN1cnJlbmNlU2VydmljZS5mcmVxdWVuY3k7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEBoaWRkZW5cbiAgICAgKi9cbiAgICBuZ09uSW5pdCgpIHtcbiAgICAgICAgdGhpcy5yZWN1cnJlbmNlU2VydmljZS5pbml0KCcnLCB0aGlzLnN0YXJ0LCB0aGlzLnRpbWV6b25lKTtcbiAgICB9XG4gICAgbmdPbkNoYW5nZXMoY2hhbmdlcykge1xuICAgICAgICBpZiAoaXNDaGFuZ2VkKCdzdGFydCcsIGNoYW5nZXMpKSB7XG4gICAgICAgICAgICB0aGlzLnJlY3VycmVuY2VTZXJ2aWNlLnN0YXJ0ID0gdGhpcy5zdGFydDtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBAaGlkZGVuXG4gICAgICovXG4gICAgbmdPbkRlc3Ryb3koKSB7XG4gICAgICAgIGlmICh0aGlzLnN1YnNjcmlwdGlvbnMpIHtcbiAgICAgICAgICAgIHRoaXMuc3Vic2NyaXB0aW9ucy51bnN1YnNjcmliZSgpO1xuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEBoaWRkZW5cbiAgICAgKi9cbiAgICB3cml0ZVZhbHVlKHJydWxlKSB7XG4gICAgICAgIHRoaXMucmVjdXJyZW5jZVNlcnZpY2UuaW5pdCh0eXBlb2YgcnJ1bGUgPT09ICdzdHJpbmcnID8gcnJ1bGUgOiAnJywgdGhpcy5zdGFydCwgdGhpcy50aW1lem9uZSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEBoaWRkZW5cbiAgICAgKi9cbiAgICByZWdpc3Rlck9uQ2hhbmdlKGZuKSB7XG4gICAgICAgIHRoaXMub25DaGFuZ2VDYWxsYmFjayA9IGZuO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBAaGlkZGVuXG4gICAgICovXG4gICAgcmVnaXN0ZXJPblRvdWNoZWQoZm4pIHtcbiAgICAgICAgdGhpcy5vblRvdWNoZWRDYWxsYmFjayA9IGZuO1xuICAgIH1cbiAgICBlbWl0Q2hhbmdlKHJydWxlKSB7XG4gICAgICAgIHRoaXMub25DaGFuZ2VDYWxsYmFjayhycnVsZSk7XG4gICAgICAgIHRoaXMudmFsdWVDaGFuZ2UuZW1pdChycnVsZSk7XG4gICAgfVxufVxuUmVjdXJyZW5jZUVkaXRvckNvbXBvbmVudC5kZWNvcmF0b3JzID0gW1xuICAgIHsgdHlwZTogQ29tcG9uZW50LCBhcmdzOiBbe1xuICAgICAgICAgICAgICAgIGV4cG9ydEFzOiAna2VuZG9SZWN1cnJlbmNlRWRpdG9yJyxcbiAgICAgICAgICAgICAgICBwcm92aWRlcnM6IFtcbiAgICAgICAgICAgICAgICAgICAgUmVjdXJyZW5jZUxvY2FsaXphdGlvblNlcnZpY2UsXG4gICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHByb3ZpZGU6IExvY2FsaXphdGlvblNlcnZpY2UsXG4gICAgICAgICAgICAgICAgICAgICAgICB1c2VFeGlzdGluZzogUmVjdXJyZW5jZUxvY2FsaXphdGlvblNlcnZpY2VcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgcHJvdmlkZTogTDEwTl9QUkVGSVgsXG4gICAgICAgICAgICAgICAgICAgICAgICB1c2VWYWx1ZTogJ2tlbmRvLnJlY3VycmVuY2VlZGl0b3InXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIFJFQ1VSUkVOQ0VfVkFMVUVfQUNDRVNTT1IsXG4gICAgICAgICAgICAgICAgICAgIFJlY3VycmVuY2VTZXJ2aWNlXG4gICAgICAgICAgICAgICAgXSxcbiAgICAgICAgICAgICAgICBzZWxlY3RvcjogJ2tlbmRvLXJlY3VycmVuY2UtZWRpdG9yJyxcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZTogYFxuICAgICAgICA8bmctY29udGFpbmVyIGtlbmRvUmVjdXJyZW5jZUVkaXRvckxvY2FsaXplZE1lc3NhZ2VzXG4gICAgICAgICAgICBpMThuLXJlcGVhdD1cImtlbmRvLnJlY3VycmVuY2VlZGl0b3IucmVwZWF0fFRoZSB0ZXh0IHNpbWlsYXIgdG8gJ1JlcGVhdCcgZGlzcGxheWVkIGluIHRoZSByZWN1cnJlbmNlIGVkaXRvci5cIlxuICAgICAgICAgICAgcmVwZWF0PSdSZXBlYXQnXG5cbiAgICAgICAgICAgIGkxOG4tZGFpbHlJbnRlcnZhbD1cImtlbmRvLnJlY3VycmVuY2VlZGl0b3IuZGFpbHlJbnRlcnZhbHxUaGUgdGV4dCBzaW1pbGFyIHRvICdkYXkocyknIGRpc3BsYXllZCBpbiB0aGUgcmVjdXJyZW5jZSBlZGl0b3IuXCJcbiAgICAgICAgICAgIGRhaWx5SW50ZXJ2YWw9J2RheShzKSdcblxuICAgICAgICAgICAgaTE4bi1kYWlseVJlcGVhdEV2ZXJ5PVwia2VuZG8ucmVjdXJyZW5jZWVkaXRvci5kYWlseVJlcGVhdEV2ZXJ5fFRoZSB0ZXh0IHNpbWlsYXIgdG8gJ1JlcGVhdCBldmVyeScgZGlzcGxheWVkIGluIHRoZSByZWN1cnJlbmNlIGVkaXRvci5cIlxuICAgICAgICAgICAgZGFpbHlSZXBlYXRFdmVyeT0nUmVwZWF0IGV2ZXJ5J1xuXG4gICAgICAgICAgICBpMThuLXdlZWtseUludGVydmFsPVwia2VuZG8ucmVjdXJyZW5jZWVkaXRvci53ZWVrbHlJbnRlcnZhbHxUaGUgdGV4dCBzaW1pbGFyIHRvICd3ZWVrKHMpJyBkaXNwbGF5ZWQgaW4gdGhlIHJlY3VycmVuY2UgZWRpdG9yLlwiXG4gICAgICAgICAgICB3ZWVrbHlJbnRlcnZhbD0nd2VlayhzKSdcblxuICAgICAgICAgICAgaTE4bi13ZWVrbHlSZXBlYXRFdmVyeT1cImtlbmRvLnJlY3VycmVuY2VlZGl0b3Iud2Vla2x5UmVwZWF0RXZlcnl8VGhlIHRleHQgc2ltaWxhciB0byAnUmVwZWF0IGV2ZXJ5JyBkaXNwbGF5ZWQgaW4gdGhlIHJlY3VycmVuY2UgZWRpdG9yLlwiXG4gICAgICAgICAgICB3ZWVrbHlSZXBlYXRFdmVyeT0nUmVwZWF0IGV2ZXJ5J1xuXG4gICAgICAgICAgICBpMThuLXdlZWtseVJlcGVhdE9uPVwia2VuZG8ucmVjdXJyZW5jZWVkaXRvci53ZWVrbHlSZXBlYXRPbnxUaGUgdGV4dCBzaW1pbGFyIHRvICdSZXBlYXQgb24nIGRpc3BsYXllZCBpbiB0aGUgcmVjdXJyZW5jZSBlZGl0b3IuXCJcbiAgICAgICAgICAgIHdlZWtseVJlcGVhdE9uPSdSZXBlYXQgb24nXG5cbiAgICAgICAgICAgIGkxOG4tbW9udGhseURheT1cImtlbmRvLnJlY3VycmVuY2VlZGl0b3IubW9udGhseURheXxUaGUgdGV4dCBzaW1pbGFyIHRvICdEYXknIGRpc3BsYXllZCBpbiB0aGUgcmVjdXJyZW5jZSBlZGl0b3IuXCJcbiAgICAgICAgICAgIG1vbnRobHlEYXk9J0RheSdcblxuICAgICAgICAgICAgaTE4bi1tb250aGx5SW50ZXJ2YWw9XCJrZW5kby5yZWN1cnJlbmNlZWRpdG9yLm1vbnRobHlJbnRlcnZhbHxUaGUgdGV4dCBzaW1pbGFyIHRvICdtb250aChzKScgZGlzcGxheWVkIGluIHRoZSByZWN1cnJlbmNlIGVkaXRvci5cIlxuICAgICAgICAgICAgbW9udGhseUludGVydmFsPSdtb250aChzKSdcblxuICAgICAgICAgICAgaTE4bi1tb250aGx5UmVwZWF0RXZlcnk9XCJrZW5kby5yZWN1cnJlbmNlZWRpdG9yLm1vbnRobHlSZXBlYXRFdmVyeXxUaGUgdGV4dCBzaW1pbGFyIHRvICdSZXBlYXQgZXZlcnknIGRpc3BsYXllZCBpbiB0aGUgcmVjdXJyZW5jZSBlZGl0b3IuXCJcbiAgICAgICAgICAgIG1vbnRobHlSZXBlYXRFdmVyeT0nUmVwZWF0IGV2ZXJ5J1xuXG4gICAgICAgICAgICBpMThuLW1vbnRobHlSZXBlYXRPbj1cImtlbmRvLnJlY3VycmVuY2VlZGl0b3IubW9udGhseVJlcGVhdE9ufFRoZSB0ZXh0IHNpbWlsYXIgdG8gJ1JlcGVhdCBvbicgZGlzcGxheWVkIGluIHRoZSByZWN1cnJlbmNlIGVkaXRvci5cIlxuICAgICAgICAgICAgbW9udGhseVJlcGVhdE9uPSdSZXBlYXQgb24nXG5cbiAgICAgICAgICAgIGkxOG4teWVhcmx5T2Y9XCJrZW5kby5yZWN1cnJlbmNlZWRpdG9yLnllYXJseU9mfFRoZSB0ZXh0IHNpbWlsYXIgdG8gJ29mJyBkaXNwbGF5ZWQgaW4gdGhlIHJlY3VycmVuY2UgZWRpdG9yLlwiXG4gICAgICAgICAgICB5ZWFybHlPZj0nb2YnXG5cbiAgICAgICAgICAgIGkxOG4teWVhcmx5UmVwZWF0RXZlcnk9XCJrZW5kby5yZWN1cnJlbmNlZWRpdG9yLnllYXJseVJlcGVhdEV2ZXJ5fFRoZSB0ZXh0IHNpbWlsYXIgdG8gJ1JlcGVhdCBldmVyeScgZGlzcGxheWVkIGluIHRoZSByZWN1cnJlbmNlIGVkaXRvci5cIlxuICAgICAgICAgICAgeWVhcmx5UmVwZWF0RXZlcnk9J1JlcGVhdCBldmVyeSdcblxuICAgICAgICAgICAgaTE4bi15ZWFybHlSZXBlYXRPbj1cImtlbmRvLnJlY3VycmVuY2VlZGl0b3IueWVhcmx5UmVwZWF0T258VGhlIHRleHQgc2ltaWxhciB0byAnUmVwZWF0IG9uJyBkaXNwbGF5ZWQgaW4gdGhlIHJlY3VycmVuY2UgZWRpdG9yLlwiXG4gICAgICAgICAgICB5ZWFybHlSZXBlYXRPbj0nUmVwZWF0IG9uJ1xuXG4gICAgICAgICAgICBpMThuLXllYXJseUludGVydmFsPVwia2VuZG8ucmVjdXJyZW5jZWVkaXRvci55ZWFybHlJbnRlcnZhbHxUaGUgdGV4dCBzaW1pbGFyIHRvICd5ZWFyKHMpJyBkaXNwbGF5ZWQgaW4gdGhlIHJlY3VycmVuY2UgZWRpdG9yLlwiXG4gICAgICAgICAgICB5ZWFybHlJbnRlcnZhbD0neWVhcihzKSdcblxuICAgICAgICAgICAgaTE4bi1mcmVxdWVuY2llc0RhaWx5PVwia2VuZG8ucmVjdXJyZW5jZWVkaXRvci5mcmVxdWVuY2llc0RhaWx5fFRoZSB0ZXh0IHNpbWlsYXIgdG8gJ0RhaWx5JyBkaXNwbGF5ZWQgaW4gdGhlIHJlY3VycmVuY2UgZWRpdG9yLlwiXG4gICAgICAgICAgICBmcmVxdWVuY2llc0RhaWx5PSdEYWlseSdcblxuICAgICAgICAgICAgaTE4bi1mcmVxdWVuY2llc01vbnRobHk9XCJrZW5kby5yZWN1cnJlbmNlZWRpdG9yLmZyZXF1ZW5jaWVzTW9udGhseXxUaGUgdGV4dCBzaW1pbGFyIHRvICdNb250aGx5JyBkaXNwbGF5ZWQgaW4gdGhlIHJlY3VycmVuY2UgZWRpdG9yLlwiXG4gICAgICAgICAgICBmcmVxdWVuY2llc01vbnRobHk9J01vbnRobHknXG5cbiAgICAgICAgICAgIGkxOG4tZnJlcXVlbmNpZXNOZXZlcj1cImtlbmRvLnJlY3VycmVuY2VlZGl0b3IuZnJlcXVlbmNpZXNOZXZlcnxUaGUgdGV4dCBzaW1pbGFyIHRvICdOZXZlcicgZGlzcGxheWVkIGluIHRoZSByZWN1cnJlbmNlIGVkaXRvci5cIlxuICAgICAgICAgICAgZnJlcXVlbmNpZXNOZXZlcj0nTmV2ZXInXG5cbiAgICAgICAgICAgIGkxOG4tZnJlcXVlbmNpZXNXZWVrbHk9XCJrZW5kby5yZWN1cnJlbmNlZWRpdG9yLmZyZXF1ZW5jaWVzV2Vla2x5fFRoZSB0ZXh0IHNpbWlsYXIgdG8gJ1dlZWtseScgZGlzcGxheWVkIGluIHRoZSByZWN1cnJlbmNlIGVkaXRvci5cIlxuICAgICAgICAgICAgZnJlcXVlbmNpZXNXZWVrbHk9J1dlZWtseSdcblxuICAgICAgICAgICAgaTE4bi1mcmVxdWVuY2llc1llYXJseT1cImtlbmRvLnJlY3VycmVuY2VlZGl0b3IuZnJlcXVlbmNpZXNZZWFybHl8VGhlIHRleHQgc2ltaWxhciB0byAnWWVhcmx5JyBkaXNwbGF5ZWQgaW4gdGhlIHJlY3VycmVuY2UgZWRpdG9yLlwiXG4gICAgICAgICAgICBmcmVxdWVuY2llc1llYXJseT0nWWVhcmx5J1xuXG4gICAgICAgICAgICBpMThuLWZmZnNldFBvc2l0aW9uc0ZpcnN0PVwia2VuZG8ucmVjdXJyZW5jZWVkaXRvci5mZmZzZXRQb3NpdGlvbnNGaXJzdHxUaGUgdGV4dCBzaW1pbGFyIHRvICdGaXJzdCcgZGlzcGxheWVkIGluIHRoZSByZWN1cnJlbmNlIGVkaXRvci5cIlxuICAgICAgICAgICAgb2Zmc2V0UG9zaXRpb25zRmlyc3Q9J0ZpcnN0J1xuXG4gICAgICAgICAgICBpMThuLW9mZnNldFBvc2l0aW9uc1NlY29uZD1cImtlbmRvLnJlY3VycmVuY2VlZGl0b3Iub2Zmc2V0UG9zaXRpb25zU2Vjb25kfFRoZSB0ZXh0IHNpbWlsYXIgdG8gJ1NlY29uZCcgZGlzcGxheWVkIGluIHRoZSByZWN1cnJlbmNlIGVkaXRvci5cIlxuICAgICAgICAgICAgb2Zmc2V0UG9zaXRpb25zU2Vjb25kPSdTZWNvbmQnXG5cbiAgICAgICAgICAgIGkxOG4tb2Zmc2V0UG9zaXRpb25zVGhpcmQ9XCJrZW5kby5yZWN1cnJlbmNlZWRpdG9yLm9mZnNldFBvc2l0aW9uc1RoaXJkfFRoZSB0ZXh0IHNpbWlsYXIgdG8gJ1RoaXJkJyBkaXNwbGF5ZWQgaW4gdGhlIHJlY3VycmVuY2UgZWRpdG9yLlwiXG4gICAgICAgICAgICBvZmZzZXRQb3NpdGlvbnNUaGlyZD0nVGhpcmQnXG5cbiAgICAgICAgICAgIGkxOG4tb2Zmc2V0UG9zaXRpb25zRm91cnRoPVwia2VuZG8ucmVjdXJyZW5jZWVkaXRvci5vZmZzZXRQb3NpdGlvbnNGb3VydGh8VGhlIHRleHQgc2ltaWxhciB0byAnRm91cnRoJyBkaXNwbGF5ZWQgaW4gdGhlIHJlY3VycmVuY2UgZWRpdG9yLlwiXG4gICAgICAgICAgICBvZmZzZXRQb3NpdGlvbnNGb3VydGg9J0ZvdXJ0aCdcblxuICAgICAgICAgICAgaTE4bi1vZmZzZXRQb3NpdGlvbnNMYXN0PVwia2VuZG8ucmVjdXJyZW5jZWVkaXRvci5vZmZzZXRQb3NpdGlvbnNMYXN0fFRoZSB0ZXh0IHNpbWlsYXIgdG8gJ0xhc3QnIGRpc3BsYXllZCBpbiB0aGUgcmVjdXJyZW5jZSBlZGl0b3IuXCJcbiAgICAgICAgICAgIG9mZnNldFBvc2l0aW9uc0xhc3Q9J0xhc3QnXG5cbiAgICAgICAgICAgIGkxOG4td2Vla2RheXNEYXk9XCJrZW5kby5yZWN1cnJlbmNlZWRpdG9yLndlZWtkYXlzRGF5fFRoZSB0ZXh0IHNpbWlsYXIgdG8gJ0RheScgZGlzcGxheWVkIGluIHRoZSByZXBlYXQgYnkgc2VjdGlvbiBvZiB0aGUgbW9udGhseSByZWN1cnJlbmNlIHBhdHRlcm4uXCJcbiAgICAgICAgICAgIHdlZWtkYXlzRGF5PSdEYXknXG5cbiAgICAgICAgICAgIGkxOG4td2Vla2RheXNXZWVrZGF5PVwia2VuZG8ucmVjdXJyZW5jZWVkaXRvci53ZWVrZGF5c1dlZWtkYXl8VGhlIHRleHQgc2ltaWxhciB0byAnV2Vla2RheScgZGlzcGxheWVkIGluIHRoZSByZXBlYXQgYnkgc2VjdGlvbiBvZiB0aGUgbW9udGhseSByZWN1cnJlbmNlIHBhdHRlcm4uXCJcbiAgICAgICAgICAgIHdlZWtkYXlzV2Vla2RheT0nV2Vla2RheSdcblxuICAgICAgICAgICAgaTE4bi13ZWVrZGF5c1dlZWtlbmRkYXk9XCJrZW5kby5yZWN1cnJlbmNlZWRpdG9yLndlZWtkYXlzV2Vla2VuZGRheXxUaGUgdGV4dCBzaW1pbGFyIHRvICdXZWVrZW5kIERheScgZGlzcGxheWVkIGluIHRoZSByZXBlYXQgYnkgc2VjdGlvbiBvZiB0aGUgbW9udGhseSByZWN1cnJlbmNlIHBhdHRlcm4uXCJcbiAgICAgICAgICAgIHdlZWtkYXlzV2Vla2VuZGRheT0nV2Vla2VuZCBEYXknXG5cbiAgICAgICAgICAgIGkxOG4tZW5kQWZ0ZXI9XCJrZW5kby5yZWN1cnJlbmNlZWRpdG9yLmVuZEFmdGVyfFRoZSB0ZXh0IHNpbWlsYXIgdG8gJ0FmdGVyJyBkaXNwbGF5ZWQgaW4gdGhlIHJlY3VycmVuY2UgZWRpdG9yLlwiXG4gICAgICAgICAgICBlbmRBZnRlcj0nQWZ0ZXInXG5cbiAgICAgICAgICAgIGkxOG4tZW5kT2NjdXJyZW5jZT1cImtlbmRvLnJlY3VycmVuY2VlZGl0b3IuZW5kT2NjdXJyZW5jZXxUaGUgdGV4dCBzaW1pbGFyIHRvICdvY2N1cnJlbmNlKHMpJyBkaXNwbGF5ZWQgaW4gdGhlIHJlY3VycmVuY2UgZWRpdG9yLlwiXG4gICAgICAgICAgICBlbmRPY2N1cnJlbmNlPSdvY2N1cnJlbmNlKHMpJ1xuXG4gICAgICAgICAgICBpMThuLWVuZExhYmVsPVwia2VuZG8ucmVjdXJyZW5jZWVkaXRvci5lbmRMYWJlbHxUaGUgdGV4dCBzaW1pbGFyIHRvICdFbmQnIGRpc3BsYXllZCBpbiB0aGUgcmVjdXJyZW5jZSBlZGl0b3IuXCJcbiAgICAgICAgICAgIGVuZExhYmVsPSdFbmQnXG5cbiAgICAgICAgICAgIGkxOG4tZW5kTmV2ZXI9XCJrZW5kby5yZWN1cnJlbmNlZWRpdG9yLmVuZE5ldmVyfFRoZSB0ZXh0IHNpbWlsYXIgdG8gJ05ldmVyJyBkaXNwbGF5ZWQgaW4gdGhlIHJlY3VycmVuY2UgZWRpdG9yLlwiXG4gICAgICAgICAgICBlbmROZXZlcj0nTmV2ZXInXG5cbiAgICAgICAgICAgIGkxOG4tZW5kT249XCJrZW5kby5yZWN1cnJlbmNlZWRpdG9yLmVuZE9ufFRoZSB0ZXh0IHNpbWlsYXIgdG8gJ09uJyBkaXNwbGF5ZWQgaW4gdGhlIHJlY3VycmVuY2UgZWRpdG9yLlwiXG4gICAgICAgICAgICBlbmRPbj0nT24nXG4gICAgICAgID5cbiAgICAgICAgPC9uZy1jb250YWluZXI+XG5cbiAgICAgICAgPGtlbmRvLXJlY3VycmVuY2UtZnJlcXVlbmN5LWVkaXRvcj5cbiAgICAgICAgPC9rZW5kby1yZWN1cnJlbmNlLWZyZXF1ZW5jeS1lZGl0b3I+XG5cbiAgICAgICAgPGRpdiBjbGFzcz0nay1yZWN1ci12aWV3Jz5cbiAgICAgICAgICAgIDxrZW5kby1yZWN1cnJlbmNlLWludGVydmFsLWVkaXRvclxuICAgICAgICAgICAgICAgICpuZ0lmPVwiY3VycmVudEZyZXEgIT09ICduZXZlcidcIlxuICAgICAgICAgICAgICAgIFt1c2VyTnVtZXJpY09wdGlvbnNdPVwicmVwZWF0RXZlcnlPcHRpb25zXCI+XG4gICAgICAgICAgICA8L2tlbmRvLXJlY3VycmVuY2UtaW50ZXJ2YWwtZWRpdG9yPlxuXG4gICAgICAgICAgICA8a2VuZG8tcmVjdXJyZW5jZS13ZWVrZGF5LXJ1bGUtZWRpdG9yICpuZ0lmPVwiY3VycmVudEZyZXEgPT09ICd3ZWVrbHknXCI+XG4gICAgICAgICAgICA8L2tlbmRvLXJlY3VycmVuY2Utd2Vla2RheS1ydWxlLWVkaXRvcj5cblxuICAgICAgICAgICAgPGtlbmRvLXJlY3VycmVuY2UtbW9udGhseS15ZWFybHktZWRpdG9yXG4gICAgICAgICAgICAgICAgKm5nSWY9XCJjdXJyZW50RnJlcSA9PT0gJ21vbnRobHknIHx8IGN1cnJlbnRGcmVxID09PSAneWVhcmx5J1wiXG4gICAgICAgICAgICAgICAgW3VzZXJOdW1lcmljT3B0aW9uc109XCJyZXBlYXRPbk9wdGlvbnNcIj5cbiAgICAgICAgICAgIDwva2VuZG8tcmVjdXJyZW5jZS1tb250aGx5LXllYXJseS1lZGl0b3I+XG5cbiAgICAgICAgICAgIDxrZW5kby1yZWN1cnJlbmNlLWVuZC1ydWxlLWVkaXRvclxuICAgICAgICAgICAgICAgICpuZ0lmPVwiY3VycmVudEZyZXEgIT09ICduZXZlcidcIlxuICAgICAgICAgICAgICAgIFt1c2VyTnVtZXJpY09wdGlvbnNdPVwiZW5kQWZ0ZXJPcHRpb25zXCJcbiAgICAgICAgICAgICAgICBbdXNlckRhdGVQaWNrZXJPcHRpb25zXT1cImVuZE9uT3B0aW9uc1wiPlxuICAgICAgICAgICAgPC9rZW5kby1yZWN1cnJlbmNlLWVuZC1ydWxlLWVkaXRvcj5cbiAgICAgICAgPC9kaXY+XG4gICAgYFxuICAgICAgICAgICAgfSxdIH0sXG5dO1xuLyoqIEBub2NvbGxhcHNlICovXG5SZWN1cnJlbmNlRWRpdG9yQ29tcG9uZW50LmN0b3JQYXJhbWV0ZXJzID0gKCkgPT4gW1xuICAgIHsgdHlwZTogUmVjdXJyZW5jZVNlcnZpY2UgfVxuXTtcblJlY3VycmVuY2VFZGl0b3JDb21wb25lbnQucHJvcERlY29yYXRvcnMgPSB7XG4gICAgY3NzQ2xhc3M6IFt7IHR5cGU6IEhvc3RCaW5kaW5nLCBhcmdzOiBbJ2NsYXNzLmstcmVjdXJyZW5jZS1lZGl0b3InLF0gfV0sXG4gICAgc3RhcnQ6IFt7IHR5cGU6IElucHV0IH1dLFxuICAgIHRpbWV6b25lOiBbeyB0eXBlOiBJbnB1dCB9XSxcbiAgICByZXBlYXRFdmVyeU9wdGlvbnM6IFt7IHR5cGU6IElucHV0IH1dLFxuICAgIGVuZEFmdGVyT3B0aW9uczogW3sgdHlwZTogSW5wdXQgfV0sXG4gICAgcmVwZWF0T25PcHRpb25zOiBbeyB0eXBlOiBJbnB1dCB9XSxcbiAgICBlbmRPbk9wdGlvbnM6IFt7IHR5cGU6IElucHV0IH1dLFxuICAgIHZhbHVlQ2hhbmdlOiBbeyB0eXBlOiBPdXRwdXQgfV1cbn07XG5cbi8qKlxuICogQGhpZGRlblxuICovXG5jbGFzcyBSZWN1cnJlbmNlRnJlcXVlbmN5RWRpdG9yQ29tcG9uZW50IHtcbiAgICBjb25zdHJ1Y3RvcihyZWN1cnJlbmNlLCBsb2NhbGl6YXRpb24pIHtcbiAgICAgICAgdGhpcy5yZWN1cnJlbmNlID0gcmVjdXJyZW5jZTtcbiAgICAgICAgdGhpcy5sb2NhbGl6YXRpb24gPSBsb2NhbGl6YXRpb247XG4gICAgfVxuICAgIG5nT25Jbml0KCkge1xuICAgICAgICB0aGlzLmZyZXF1ZW5jaWVzID0gdGhpcy5yZWN1cnJlbmNlLmZyZXF1ZW5jaWVzO1xuICAgIH1cbiAgICBnZXQgc2VsZWN0ZWQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnJlY3VycmVuY2UuZnJlcXVlbmN5O1xuICAgIH1cbiAgICBvbkNsaWNrKG5ld0ZyZXEpIHtcbiAgICAgICAgaWYgKG5ld0ZyZXEudmFsdWUgIT09IHRoaXMuc2VsZWN0ZWQpIHtcbiAgICAgICAgICAgIHRoaXMucmVjdXJyZW5jZS5zZXRGcmVxdWVuY3kobmV3RnJlcS52YWx1ZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgdGV4dEZvcihrZXkpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubG9jYWxpemF0aW9uLmdldChrZXkpO1xuICAgIH1cbiAgICBvbkZyZXF1ZW5jeUNsaWNrKCkge1xuICAgICAgICBjb25zdCBzZWxlY3RlZCA9IHRoaXMud2Vla0RheUJ1dHRvbnMudG9BcnJheSgpLmZpbmQociA9PiByLnNlbGVjdGVkKTtcbiAgICAgICAgaWYgKHNlbGVjdGVkKSB7XG4gICAgICAgICAgICBzZWxlY3RlZC5mb2N1cygpO1xuICAgICAgICB9XG4gICAgfVxufVxuUmVjdXJyZW5jZUZyZXF1ZW5jeUVkaXRvckNvbXBvbmVudC5kZWNvcmF0b3JzID0gW1xuICAgIHsgdHlwZTogQ29tcG9uZW50LCBhcmdzOiBbe1xuICAgICAgICAgICAgICAgIHNlbGVjdG9yOiAna2VuZG8tcmVjdXJyZW5jZS1mcmVxdWVuY3ktZWRpdG9yJyxcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZTogYFxuICAgICAgICA8ZGl2IGNsYXNzPSdrLWVkaXQtbGFiZWwnPlxuICAgICAgICAgICAgPGxhYmVsIChjbGljayk9XCJvbkZyZXF1ZW5jeUNsaWNrKClcIj57eyB0ZXh0Rm9yKCdyZXBlYXQnKSB9fTwvbGFiZWw+XG4gICAgICAgIDwvZGl2PlxuICAgICAgICA8ZGl2IGNsYXNzPSdrLWVkaXQtZmllbGQnPlxuICAgICAgICAgICAgPGtlbmRvLWJ1dHRvbmdyb3VwIFtzZWxlY3Rpb25dPVwiJ3NpbmdsZSdcIj5cbiAgICAgICAgICAgICAgICA8YnV0dG9uICpuZ0Zvcj0nbGV0IGZyZXEgb2YgZnJlcXVlbmNpZXMnIGtlbmRvQnV0dG9uXG4gICAgICAgICAgICAgICAgICAgICAgICBbc3R5bGUud2lkdGgucHhdPVwiMTAwXCJcbiAgICAgICAgICAgICAgICAgICAgICAgIFt0b2dnbGFibGVdPVwidHJ1ZVwiXG4gICAgICAgICAgICAgICAgICAgICAgICBbc2VsZWN0ZWRdPVwiZnJlcS52YWx1ZSA9PT0gc2VsZWN0ZWRcIlxuICAgICAgICAgICAgICAgICAgICAgICAgKGNsaWNrKT1cIm9uQ2xpY2soZnJlcSlcIlxuICAgICAgICAgICAgICAgID57eyBmcmVxLnRleHQgfX08L2J1dHRvbj5cbiAgICAgICAgICAgIDwva2VuZG8tYnV0dG9uZ3JvdXA+XG4gICAgICAgIDwvZGl2PlxuICAgIGBcbiAgICAgICAgICAgIH0sXSB9LFxuXTtcbi8qKiBAbm9jb2xsYXBzZSAqL1xuUmVjdXJyZW5jZUZyZXF1ZW5jeUVkaXRvckNvbXBvbmVudC5jdG9yUGFyYW1ldGVycyA9ICgpID0+IFtcbiAgICB7IHR5cGU6IFJlY3VycmVuY2VTZXJ2aWNlIH0sXG4gICAgeyB0eXBlOiBMb2NhbGl6YXRpb25TZXJ2aWNlIH1cbl07XG5SZWN1cnJlbmNlRnJlcXVlbmN5RWRpdG9yQ29tcG9uZW50LnByb3BEZWNvcmF0b3JzID0ge1xuICAgIHdlZWtEYXlCdXR0b25zOiBbeyB0eXBlOiBWaWV3Q2hpbGRyZW4sIGFyZ3M6IFtCdXR0b24sXSB9XVxufTtcblxuLyoqXG4gKiBAaGlkZGVuXG4gKi9cbmNsYXNzIEVuZFJ1bGVSYWRpb0J1dHRvbkRpcmVjdGl2ZSB7XG4gICAgY29uc3RydWN0b3IoZWwsIHJlbmRlcmVyLCByZWN1cnJlbmNlLCBjaGFuZ2VEZXRlY3Rvcikge1xuICAgICAgICB0aGlzLmVsID0gZWw7XG4gICAgICAgIHRoaXMucmVuZGVyZXIgPSByZW5kZXJlcjtcbiAgICAgICAgdGhpcy5yZWN1cnJlbmNlID0gcmVjdXJyZW5jZTtcbiAgICAgICAgdGhpcy5jaGFuZ2VEZXRlY3RvciA9IGNoYW5nZURldGVjdG9yO1xuICAgICAgICB0aGlzLnR5cGUgPSAncmFkaW8nO1xuICAgICAgICB0aGlzLnJhZGlvQ2xhc3MgPSB0cnVlO1xuICAgICAgICB0aGlzLmRlc3Ryb3lDaGFuZ2UgPSB0aGlzLnJlbmRlcmVyLmxpc3Rlbih0aGlzLmVsZW0sICdjaGFuZ2UnLCB0aGlzLm9uQ2hhbmdlLmJpbmQodGhpcykpO1xuICAgIH1cbiAgICBuZ09uSW5pdCgpIHtcbiAgICAgICAgdGhpcy5lbmRSdWxlID0gdGhpcy5lbmRSdWxlSWQuc3BsaXQoJy0nKVsyXTtcbiAgICAgICAgdGhpcy5yZW5kZXJlci5zZXRBdHRyaWJ1dGUodGhpcy5lbGVtLCAnaWQnLCB0aGlzLmVuZFJ1bGVJZCk7XG4gICAgICAgIHRoaXMucmVuZGVyZXIuc2V0QXR0cmlidXRlKHRoaXMuZWxlbSwgJ25hbWUnLCBgZW5kLSR7dGhpcy5lbmRSdWxlSWQuc3BsaXQoJy0nKS5wb3AoKX1gKTtcbiAgICB9XG4gICAgbmdBZnRlckNvbnRlbnRDaGVja2VkKCkge1xuICAgICAgICB0aGlzLnNldENoZWNrZWRTdGF0ZSgpO1xuICAgIH1cbiAgICBuZ09uRGVzdHJveSgpIHtcbiAgICAgICAgaWYgKHRoaXMuZGVzdHJveUNoYW5nZSkge1xuICAgICAgICAgICAgdGhpcy5kZXN0cm95Q2hhbmdlKCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgb25DaGFuZ2UoKSB7XG4gICAgICAgIGlmICh0aGlzLmVsZW0uY2hlY2tlZCkge1xuICAgICAgICAgICAgdGhpcy5yZWN1cnJlbmNlLmVuZFJ1bGUgPSB0aGlzLmVuZFJ1bGU7XG4gICAgICAgICAgICB0aGlzLmNoYW5nZURldGVjdG9yLm1hcmtGb3JDaGVjaygpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHNldENoZWNrZWRTdGF0ZSgpIHtcbiAgICAgICAgY29uc3QgaXNDaGVja2VkID0gdGhpcy5lbmRSdWxlID09PSB0aGlzLnJlY3VycmVuY2UuZW5kUnVsZTtcbiAgICAgICAgdGhpcy5yZW5kZXJlci5zZXRQcm9wZXJ0eSh0aGlzLmVsZW0sICdjaGVja2VkJywgaXNDaGVja2VkKTtcbiAgICB9XG4gICAgZ2V0IGVsZW0oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmVsLm5hdGl2ZUVsZW1lbnQ7XG4gICAgfVxufVxuRW5kUnVsZVJhZGlvQnV0dG9uRGlyZWN0aXZlLmRlY29yYXRvcnMgPSBbXG4gICAgeyB0eXBlOiBEaXJlY3RpdmUsIGFyZ3M6IFt7XG4gICAgICAgICAgICAgICAgc2VsZWN0b3I6ICdba2VuZG9SZWN1cnJlbmNlRW5kUnVsZVJhZGlvQnV0dG9uXSdcbiAgICAgICAgICAgIH0sXSB9LFxuXTtcbi8qKiBAbm9jb2xsYXBzZSAqL1xuRW5kUnVsZVJhZGlvQnV0dG9uRGlyZWN0aXZlLmN0b3JQYXJhbWV0ZXJzID0gKCkgPT4gW1xuICAgIHsgdHlwZTogRWxlbWVudFJlZiB9LFxuICAgIHsgdHlwZTogUmVuZGVyZXIyIH0sXG4gICAgeyB0eXBlOiBSZWN1cnJlbmNlU2VydmljZSB9LFxuICAgIHsgdHlwZTogQ2hhbmdlRGV0ZWN0b3JSZWYgfVxuXTtcbkVuZFJ1bGVSYWRpb0J1dHRvbkRpcmVjdGl2ZS5wcm9wRGVjb3JhdG9ycyA9IHtcbiAgICB0eXBlOiBbeyB0eXBlOiBIb3N0QmluZGluZywgYXJnczogWydhdHRyLnR5cGUnLF0gfV0sXG4gICAgcmFkaW9DbGFzczogW3sgdHlwZTogSG9zdEJpbmRpbmcsIGFyZ3M6IFsnY2xhc3Muay1yYWRpbycsXSB9XSxcbiAgICBlbmRSdWxlSWQ6IFt7IHR5cGU6IElucHV0LCBhcmdzOiBbXCJrZW5kb1JlY3VycmVuY2VFbmRSdWxlUmFkaW9CdXR0b25cIixdIH1dXG59O1xuXG4vKipcbiAqIEBoaWRkZW5cbiAqL1xuY2xhc3MgUmVjdXJyZW5jZUVuZFJ1bGVFZGl0b3JDb21wb25lbnQge1xuICAgIGNvbnN0cnVjdG9yKHJlY3VycmVuY2UsIGxvY2FsaXphdGlvbikge1xuICAgICAgICB0aGlzLnJlY3VycmVuY2UgPSByZWN1cnJlbmNlO1xuICAgICAgICB0aGlzLmxvY2FsaXphdGlvbiA9IGxvY2FsaXphdGlvbjtcbiAgICAgICAgdGhpcy5udW1lcmljT3B0aW9ucyA9IHtcbiAgICAgICAgICAgIG1pbjogMSxcbiAgICAgICAgICAgIGZvcm1hdDogJyMnLFxuICAgICAgICAgICAgYXV0b0NvcnJlY3Q6IHRydWUsXG4gICAgICAgICAgICBzdGVwOiAxLFxuICAgICAgICAgICAgc3Bpbm5lcnM6IHRydWVcbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5kYXRlUGlja2VyT3B0aW9ucyA9IHtcbiAgICAgICAgICAgIGFjdGl2ZVZpZXc6ICdtb250aCcsXG4gICAgICAgICAgICBib3R0b21WaWV3OiAnbW9udGgnLFxuICAgICAgICAgICAgdG9wVmlldzogJ2NlbnR1cnknLFxuICAgICAgICAgICAgZGlzYWJsZWREYXRlc1ZhbGlkYXRpb246IHRydWUsXG4gICAgICAgICAgICBuYXZpZ2F0aW9uOiB0cnVlLFxuICAgICAgICAgICAgZm9ybWF0OiAnZCdcbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy51bmlxdWVJZCA9IHRoaXMucmVjdXJyZW5jZS5nZXRVbmlxdWVJZCgpO1xuICAgICAgICB0aGlzLnNldEluaXRpYWxWYWx1ZXMoKTtcbiAgICAgICAgdGhpcy5zdWJzY3JpYmVDaGFuZ2VzKCk7XG4gICAgfVxuICAgIHNldCB1c2VyTnVtZXJpY09wdGlvbnMob3B0aW9ucykge1xuICAgICAgICB0aGlzLm51bWVyaWNPcHRpb25zID0gT2JqZWN0LmFzc2lnbih7fSwgdGhpcy5udW1lcmljT3B0aW9ucywgb3B0aW9ucyk7XG4gICAgfVxuICAgIHNldCB1c2VyRGF0ZVBpY2tlck9wdGlvbnMob3B0aW9ucykge1xuICAgICAgICB0aGlzLmRhdGVQaWNrZXJPcHRpb25zID0gT2JqZWN0LmFzc2lnbih7fSwgdGhpcy5kYXRlUGlja2VyT3B0aW9ucywgb3B0aW9ucyk7XG4gICAgfVxuICAgIG5nT25EZXN0cm95KCkge1xuICAgICAgICBpZiAodGhpcy5zdWJzY3JpcHRpb25zKSB7XG4gICAgICAgICAgICB0aGlzLnN1YnNjcmlwdGlvbnMudW5zdWJzY3JpYmUoKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzZXRFbmRSdWxlKGVuZFJ1bGUpIHtcbiAgICAgICAgaWYgKGVuZFJ1bGUgPT09ICdjb3VudCcpIHtcbiAgICAgICAgICAgIHRoaXMucmVjdXJyZW5jZS5ycnVsZS5jb3VudCA9IHRoaXMuY291bnRWYWx1ZTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChlbmRSdWxlID09PSAndW50aWwnKSB7XG4gICAgICAgICAgICB0aGlzLnJlY3VycmVuY2UudW50aWwgPSB0aGlzLnVudGlsVmFsdWU7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZ2V0IHJydWxlKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5yZWN1cnJlbmNlLnJydWxlO1xuICAgIH1cbiAgICBnZXQgaXNDb3VudERpc2FibGVkKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5yZWN1cnJlbmNlLmVuZFJ1bGUgIT09ICdjb3VudCc7XG4gICAgfVxuICAgIGdldCBpc1VudGlsRGlzYWJsZWQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnJlY3VycmVuY2UuZW5kUnVsZSAhPT0gJ3VudGlsJztcbiAgICB9XG4gICAgb25Db3VudENoYW5nZSh2YWx1ZSkge1xuICAgICAgICBpZiAoaXNQcmVzZW50KHZhbHVlKSkge1xuICAgICAgICAgICAgdGhpcy5yZWN1cnJlbmNlLmNvdW50ID0gdmFsdWU7XG4gICAgICAgIH1cbiAgICB9XG4gICAgb25Db3VudEJsdXIoKSB7XG4gICAgICAgIGlmICghaXNQcmVzZW50KHRoaXMuY291bnRWYWx1ZSkpIHtcbiAgICAgICAgICAgIHRoaXMucmVjdXJyZW5jZS5jb3VudCA9IHRoaXMuY291bnRWYWx1ZSA9IDE7XG4gICAgICAgIH1cbiAgICB9XG4gICAgb25VbnRpbENoYW5nZSh2YWx1ZSkge1xuICAgICAgICBpZiAoaXNQcmVzZW50KHZhbHVlKSkge1xuICAgICAgICAgICAgdGhpcy5yZWN1cnJlbmNlLnVudGlsID0gdGhpcy5jcmVhdGVVbnRpbCh2YWx1ZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgb25VbnRpbEJsdXIoKSB7XG4gICAgICAgIGlmICghaXNQcmVzZW50KHRoaXMudW50aWxWYWx1ZSkpIHtcbiAgICAgICAgICAgIHRoaXMucmVjdXJyZW5jZS51bnRpbCA9IHRoaXMudW50aWxWYWx1ZSA9IHRoaXMuY3JlYXRlVW50aWwodGhpcy5yZWN1cnJlbmNlLnN0YXJ0KTtcbiAgICAgICAgfVxuICAgIH1cbiAgICB0ZXh0Rm9yKGtleSkge1xuICAgICAgICByZXR1cm4gdGhpcy5sb2NhbGl6YXRpb24uZ2V0KGtleSk7XG4gICAgfVxuICAgIG9uRW5kTGFiZWxDbGljaygpIHtcbiAgICAgICAgY29uc3Qgc2VsZWN0ZWQgPSB0aGlzLmVuZFJ1bGVSYWRpb0J1dHRvbnMudG9BcnJheSgpLmZpbmQociA9PiByLmVsZW0uY2hlY2tlZCk7XG4gICAgICAgIGlmIChzZWxlY3RlZCkge1xuICAgICAgICAgICAgc2VsZWN0ZWQuZWxlbS5mb2N1cygpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHNldEluaXRpYWxWYWx1ZXMoKSB7XG4gICAgICAgIHRoaXMuY291bnRWYWx1ZSA9IHRoaXMucnJ1bGUuY291bnQgfHwgMTtcbiAgICAgICAgY29uc3QgY3VycmVudFVudGlsID0gdGhpcy5yZWN1cnJlbmNlLnVudGlsO1xuICAgICAgICBjb25zdCBjdXJyZW50U3RhcnQgPSB0aGlzLnJlY3VycmVuY2Uuc3RhcnQ7XG4gICAgICAgIHRoaXMudW50aWxWYWx1ZSA9IGlzUHJlc2VudChjdXJyZW50VW50aWwpID8gY3VycmVudFVudGlsIDogdGhpcy5jcmVhdGVVbnRpbChjdXJyZW50U3RhcnQpO1xuICAgIH1cbiAgICBzdWJzY3JpYmVDaGFuZ2VzKCkge1xuICAgICAgICB0aGlzLnN1YnNjcmlwdGlvbnMgPSB0aGlzLnJlY3VycmVuY2UuZW5kUnVsZUNoYW5nZS5zdWJzY3JpYmUoKGVuZFJ1bGUpID0+IHtcbiAgICAgICAgICAgIHRoaXMuc2V0RW5kUnVsZShlbmRSdWxlKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuc3Vic2NyaXB0aW9ucy5hZGQodGhpcy5yZWN1cnJlbmNlLmZyZXF1ZW5jeUNoYW5nZS5zdWJzY3JpYmUoKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5zZXRJbml0aWFsVmFsdWVzKCk7XG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgY3JlYXRlVW50aWwodW50aWwpIHtcbiAgICAgICAgLy8gUmVhZCB0aGUgdW50aWwgZGF0ZSBhcyBVVEMgZGF0ZSBwYXJ0cyB0byBhdm9pZCBpbnRlcmZlcmluZyB3aXRoIHRoZSBsb2NhbCB0aW1lIHpvbmUuXG4gICAgICAgIGNvbnN0IHVudGlsRGF0ZSA9IHRvVVRDRGF0ZSh1bnRpbCk7XG4gICAgICAgIHVudGlsRGF0ZS5zZXRVVENEYXRlKHVudGlsRGF0ZS5nZXRVVENEYXRlKCkgKyAxKTtcbiAgICAgICAgLy8gQ29udmVydCB0byB0aGUgc2NoZWR1bGVyIHRpbWUgem9uZS5cbiAgICAgICAgcmV0dXJuIFpvbmVkRGF0ZS5mcm9tVVRDRGF0ZSh1bnRpbERhdGUsIHRoaXMucmVjdXJyZW5jZS50aW1lem9uZSkudG9Mb2NhbERhdGUoKTtcbiAgICB9XG59XG5SZWN1cnJlbmNlRW5kUnVsZUVkaXRvckNvbXBvbmVudC5kZWNvcmF0b3JzID0gW1xuICAgIHsgdHlwZTogQ29tcG9uZW50LCBhcmdzOiBbe1xuICAgICAgICAgICAgICAgIHNlbGVjdG9yOiAna2VuZG8tcmVjdXJyZW5jZS1lbmQtcnVsZS1lZGl0b3InLFxuICAgICAgICAgICAgICAgIHRlbXBsYXRlOiBgXG4gICAgICAgIDxkaXYgY2xhc3M9J2stZWRpdC1sYWJlbCc+XG4gICAgICAgICAgICA8bGFiZWwgKGNsaWNrKT1cIm9uRW5kTGFiZWxDbGljaygpXCI+e3sgdGV4dEZvcignZW5kTGFiZWwnKSB9fTwvbGFiZWw+XG4gICAgICAgIDwvZGl2PlxuICAgICAgICA8ZGl2IGNsYXNzPSdrLWVkaXQtZmllbGQnPlxuICAgICAgICAgICAgPHVsIGNsYXNzPSdrLXJlc2V0Jz5cbiAgICAgICAgICAgICAgICA8bGk+XG4gICAgICAgICAgICAgICAgICAgIDxpbnB1dCBrZW5kb1JlY3VycmVuY2VFbmRSdWxlUmFkaW9CdXR0b249J2stZW5kcnVsZS1uZXZlci17e3VuaXF1ZUlkfX0nIC8+XG4gICAgICAgICAgICAgICAgICAgIDxsYWJlbCBjbGFzcz0nay1yYWRpby1sYWJlbCcgZm9yPSdrLWVuZHJ1bGUtbmV2ZXIte3t1bmlxdWVJZH19Jz57eyB0ZXh0Rm9yKCdlbmROZXZlcicpIH19PC9sYWJlbD5cbiAgICAgICAgICAgICAgICA8L2xpPlxuICAgICAgICAgICAgICAgIDxsaT5cbiAgICAgICAgICAgICAgICAgICAgPGlucHV0IGtlbmRvUmVjdXJyZW5jZUVuZFJ1bGVSYWRpb0J1dHRvbj0nay1lbmRydWxlLWNvdW50LXt7dW5pcXVlSWR9fScgLz5cbiAgICAgICAgICAgICAgICAgICAgPGxhYmVsIGNsYXNzPSdrLXJhZGlvLWxhYmVsJyBmb3I9J2stZW5kcnVsZS1jb3VudC17e3VuaXF1ZUlkfX0nPnt7IHRleHRGb3IoJ2VuZEFmdGVyJykgfX08L2xhYmVsPlxuXG4gICAgICAgICAgICAgICAgICAgIDxrZW5kby1udW1lcmljdGV4dGJveFxuICAgICAgICAgICAgICAgICAgICAgICAgW3N0eWxlLndpZHRoLnB4XT0nNzAnXG4gICAgICAgICAgICAgICAgICAgICAgICBbYXV0b0NvcnJlY3RdPSdudW1lcmljT3B0aW9ucy5hdXRvQ29ycmVjdCdcbiAgICAgICAgICAgICAgICAgICAgICAgIFtkZWNpbWFsc109JzAnXG4gICAgICAgICAgICAgICAgICAgICAgICBbZGlzYWJsZWRdPSdpc0NvdW50RGlzYWJsZWQnXG4gICAgICAgICAgICAgICAgICAgICAgICBbZm9ybWF0XT1cIm51bWVyaWNPcHRpb25zLmZvcm1hdFwiXG4gICAgICAgICAgICAgICAgICAgICAgICBbbWluXT0nbnVtZXJpY09wdGlvbnMubWluJ1xuICAgICAgICAgICAgICAgICAgICAgICAgW21heF09XCJudW1lcmljT3B0aW9ucy5tYXhcIlxuICAgICAgICAgICAgICAgICAgICAgICAgW3JlYWRvbmx5XT1cIm51bWVyaWNPcHRpb25zLnJlYWRvbmx5XCJcbiAgICAgICAgICAgICAgICAgICAgICAgIFtzZWxlY3RPbkZvY3VzXT1cIm51bWVyaWNPcHRpb25zLnNlbGVjdE9uRm9jdXNcIlxuICAgICAgICAgICAgICAgICAgICAgICAgW3NwaW5uZXJzXT1cIm51bWVyaWNPcHRpb25zLnNwaW5uZXJzXCJcbiAgICAgICAgICAgICAgICAgICAgICAgIFtzdGVwXT1cIm51bWVyaWNPcHRpb25zLnN0ZXBcIlxuICAgICAgICAgICAgICAgICAgICAgICAgW3RpdGxlXT1cIm51bWVyaWNPcHRpb25zLnRpdGxlXCJcbiAgICAgICAgICAgICAgICAgICAgICAgIFsodmFsdWUpXT0nY291bnRWYWx1ZSdcbiAgICAgICAgICAgICAgICAgICAgICAgIChibHVyKT1cIm9uQ291bnRCbHVyKClcIlxuICAgICAgICAgICAgICAgICAgICAgICAgKHZhbHVlQ2hhbmdlKT0nb25Db3VudENoYW5nZSgkZXZlbnQpJz5cbiAgICAgICAgICAgICAgICAgICAgPC9rZW5kby1udW1lcmljdGV4dGJveD5cbiAgICAgICAgICAgICAgICAgICAgPHNwYW4+e3sgdGV4dEZvcignZW5kT2NjdXJyZW5jZScpIH19PC9zcGFuPlxuICAgICAgICAgICAgICAgIDwvbGk+XG4gICAgICAgICAgICAgICAgPGxpPlxuICAgICAgICAgICAgICAgICAgICA8aW5wdXQga2VuZG9SZWN1cnJlbmNlRW5kUnVsZVJhZGlvQnV0dG9uPSdrLWVuZHJ1bGUtdW50aWwte3t1bmlxdWVJZH19JyAvPlxuICAgICAgICAgICAgICAgICAgICA8bGFiZWwgY2xhc3M9J2stcmFkaW8tbGFiZWwnIGZvcj0nay1lbmRydWxlLXVudGlsLXt7dW5pcXVlSWR9fSc+e3sgdGV4dEZvcignZW5kT24nKSB9fTwvbGFiZWw+XG5cbiAgICAgICAgICAgICAgICAgICAgPGtlbmRvLWRhdGVwaWNrZXJcbiAgICAgICAgICAgICAgICAgICAgICAgIFtzdHlsZS53aWR0aC5weF09JzE1MCdcbiAgICAgICAgICAgICAgICAgICAgICAgIFtkaXNhYmxlZF09J2lzVW50aWxEaXNhYmxlZCdcbiAgICAgICAgICAgICAgICAgICAgICAgIFthY3RpdmVWaWV3XT1cImRhdGVQaWNrZXJPcHRpb25zLmFjdGl2ZVZpZXdcIlxuICAgICAgICAgICAgICAgICAgICAgICAgW2JvdHRvbVZpZXddPVwiZGF0ZVBpY2tlck9wdGlvbnMuYm90dG9tVmlld1wiXG4gICAgICAgICAgICAgICAgICAgICAgICBbZGlzYWJsZWREYXRlc1ZhbGlkYXRpb25dPVwiZGF0ZVBpY2tlck9wdGlvbnMuZGlzYWJsZWREYXRlc1ZhbGlkYXRpb25cIlxuICAgICAgICAgICAgICAgICAgICAgICAgW2ZvY3VzZWREYXRlXT1cImRhdGVQaWNrZXJPcHRpb25zLmZvY3VzZWREYXRlXCJcbiAgICAgICAgICAgICAgICAgICAgICAgIFtmb3JtYXRdPVwiZGF0ZVBpY2tlck9wdGlvbnMuZm9ybWF0XCJcbiAgICAgICAgICAgICAgICAgICAgICAgIFtmb3JtYXRQbGFjZWhvbGRlcl09XCJkYXRlUGlja2VyT3B0aW9ucy5mb3JtYXRQbGFjZUhvbGRlclwiXG4gICAgICAgICAgICAgICAgICAgICAgICBbbWF4XT1cImRhdGVQaWNrZXJPcHRpb25zLm1heFwiXG4gICAgICAgICAgICAgICAgICAgICAgICBbbWluXT1cImRhdGVQaWNrZXJPcHRpb25zLm1pblwiXG4gICAgICAgICAgICAgICAgICAgICAgICBbbmF2aWdhdGlvbl09XCJkYXRlUGlja2VyT3B0aW9ucy5uYXZpZ2F0aW9uXCJcbiAgICAgICAgICAgICAgICAgICAgICAgIFtwbGFjZWhvbGRlcl09XCJkYXRlUGlja2VyT3B0aW9ucy5wbGFjZWhvbGRlclwiXG4gICAgICAgICAgICAgICAgICAgICAgICBbcmVhZE9ubHlJbnB1dF09XCJkYXRlUGlja2VyT3B0aW9ucy5yZWFkT25seUlucHV0XCJcbiAgICAgICAgICAgICAgICAgICAgICAgIFtyZWFkb25seV09XCJkYXRlUGlja2VyT3B0aW9ucy5yZWFkb25seVwiXG4gICAgICAgICAgICAgICAgICAgICAgICBbdGl0bGVdPVwiZGF0ZVBpY2tlck9wdGlvbnMudGl0bGVcIlxuICAgICAgICAgICAgICAgICAgICAgICAgW3RvcFZpZXddPVwiZGF0ZVBpY2tlck9wdGlvbnMudG9wVmlld1wiXG4gICAgICAgICAgICAgICAgICAgICAgICBbd2Vla051bWJlcl09XCJkYXRlUGlja2VyT3B0aW9ucy53ZWVrTnVtYmVyXCJcbiAgICAgICAgICAgICAgICAgICAgICAgIFtkaXNhYmxlZERhdGVzXT1cImRhdGVQaWNrZXJPcHRpb25zLmRpc2FibGVkRGF0ZXNcIlxuICAgICAgICAgICAgICAgICAgICAgICAgW3BvcHVwU2V0dGluZ3NdPVwiZGF0ZVBpY2tlck9wdGlvbnMucG9wdXBTZXR0aW5nc1wiXG4gICAgICAgICAgICAgICAgICAgICAgICBbKHZhbHVlKV09J3VudGlsVmFsdWUnXG4gICAgICAgICAgICAgICAgICAgICAgICAoYmx1cik9XCJvblVudGlsQmx1cigpXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICh2YWx1ZUNoYW5nZSk9J29uVW50aWxDaGFuZ2UoJGV2ZW50KSc+XG4gICAgICAgICAgICAgICAgICAgIDwva2VuZG8tZGF0ZXBpY2tlcj5cbiAgICAgICAgICAgICAgICA8L2xpPlxuICAgICAgICAgICAgPC91bD5cbiAgICAgICAgPC9kaXY+XG4gICAgYFxuICAgICAgICAgICAgfSxdIH0sXG5dO1xuLyoqIEBub2NvbGxhcHNlICovXG5SZWN1cnJlbmNlRW5kUnVsZUVkaXRvckNvbXBvbmVudC5jdG9yUGFyYW1ldGVycyA9ICgpID0+IFtcbiAgICB7IHR5cGU6IFJlY3VycmVuY2VTZXJ2aWNlIH0sXG4gICAgeyB0eXBlOiBMb2NhbGl6YXRpb25TZXJ2aWNlIH1cbl07XG5SZWN1cnJlbmNlRW5kUnVsZUVkaXRvckNvbXBvbmVudC5wcm9wRGVjb3JhdG9ycyA9IHtcbiAgICB1c2VyTnVtZXJpY09wdGlvbnM6IFt7IHR5cGU6IElucHV0IH1dLFxuICAgIHVzZXJEYXRlUGlja2VyT3B0aW9uczogW3sgdHlwZTogSW5wdXQgfV0sXG4gICAgZW5kUnVsZVJhZGlvQnV0dG9uczogW3sgdHlwZTogVmlld0NoaWxkcmVuLCBhcmdzOiBbRW5kUnVsZVJhZGlvQnV0dG9uRGlyZWN0aXZlLF0gfV1cbn07XG5cbi8qKlxuICogQGhpZGRlblxuICovXG5jbGFzcyBSZWN1cnJlbmNlSW50ZXJ2YWxFZGl0b3JDb21wb25lbnQge1xuICAgIGNvbnN0cnVjdG9yKHJlY3VycmVuY2UsIGxvY2FsaXphdGlvbikge1xuICAgICAgICB0aGlzLnJlY3VycmVuY2UgPSByZWN1cnJlbmNlO1xuICAgICAgICB0aGlzLmxvY2FsaXphdGlvbiA9IGxvY2FsaXphdGlvbjtcbiAgICAgICAgdGhpcy5udW1lcmljT3B0aW9ucyA9IHtcbiAgICAgICAgICAgIG1pbjogMSxcbiAgICAgICAgICAgIGZvcm1hdDogJyMnLFxuICAgICAgICAgICAgYXV0b0NvcnJlY3Q6IHRydWUsXG4gICAgICAgICAgICBzdGVwOiAxLFxuICAgICAgICAgICAgc3Bpbm5lcnM6IHRydWVcbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5pbnRlcnZhbFZhbHVlID0gdGhpcy5yZWN1cnJlbmNlLnJydWxlLmludGVydmFsIHx8IDE7XG4gICAgfVxuICAgIHNldCB1c2VyTnVtZXJpY09wdGlvbnMob3B0aW9ucykge1xuICAgICAgICB0aGlzLm51bWVyaWNPcHRpb25zID0gT2JqZWN0LmFzc2lnbih7fSwgdGhpcy5udW1lcmljT3B0aW9ucywgb3B0aW9ucyk7XG4gICAgfVxuICAgIGdldCBjdXJyZW50RnJlcSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucmVjdXJyZW5jZS5mcmVxdWVuY3k7XG4gICAgfVxuICAgIG9uSW50ZXJ2YWxDaGFuZ2UobmV3SW50ZXJ2YWwpIHtcbiAgICAgICAgaWYgKGlzUHJlc2VudChuZXdJbnRlcnZhbCkpIHtcbiAgICAgICAgICAgIHRoaXMucmVjdXJyZW5jZS5pbnRlcnZhbCA9IG5ld0ludGVydmFsO1xuICAgICAgICB9XG4gICAgfVxuICAgIG9uSW50ZXJ2YWxCbHVyKCkge1xuICAgICAgICBpZiAoIWlzUHJlc2VudCh0aGlzLmludGVydmFsVmFsdWUpKSB7XG4gICAgICAgICAgICB0aGlzLnJlY3VycmVuY2UuaW50ZXJ2YWwgPSB0aGlzLmludGVydmFsVmFsdWUgPSAxO1xuICAgICAgICB9XG4gICAgfVxuICAgIHRleHRGb3JSZXBlYXRFdmVyeSgpIHtcbiAgICAgICAgY29uc3QgZnJlcSA9IHRoaXMuY3VycmVudEZyZXE7XG4gICAgICAgIHN3aXRjaCAoZnJlcSkge1xuICAgICAgICAgICAgY2FzZSAnZGFpbHknOlxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnRleHRGb3IoJ2RhaWx5UmVwZWF0RXZlcnknKTtcbiAgICAgICAgICAgIGNhc2UgJ3dlZWtseSc6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMudGV4dEZvcignd2Vla2x5UmVwZWF0RXZlcnknKTtcbiAgICAgICAgICAgIGNhc2UgJ21vbnRobHknOlxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnRleHRGb3IoJ21vbnRobHlSZXBlYXRFdmVyeScpO1xuICAgICAgICAgICAgY2FzZSAneWVhcmx5JzpcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy50ZXh0Rm9yKCd5ZWFybHlSZXBlYXRFdmVyeScpO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgIH1cbiAgICB0ZXh0Rm9yRnJlcXVlbmN5KCkge1xuICAgICAgICBjb25zdCBmcmVxID0gdGhpcy5jdXJyZW50RnJlcTtcbiAgICAgICAgc3dpdGNoIChmcmVxKSB7XG4gICAgICAgICAgICBjYXNlICdkYWlseSc6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMudGV4dEZvcignZGFpbHlJbnRlcnZhbCcpO1xuICAgICAgICAgICAgY2FzZSAnd2Vla2x5JzpcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy50ZXh0Rm9yKCd3ZWVrbHlJbnRlcnZhbCcpO1xuICAgICAgICAgICAgY2FzZSAnbW9udGhseSc6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMudGV4dEZvcignbW9udGhseUludGVydmFsJyk7XG4gICAgICAgICAgICBjYXNlICd5ZWFybHknOlxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnRleHRGb3IoJ3llYXJseUludGVydmFsJyk7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgfVxuICAgIHRleHRGb3Ioa2V5KSB7XG4gICAgICAgIHJldHVybiB0aGlzLmxvY2FsaXphdGlvbi5nZXQoa2V5KTtcbiAgICB9XG59XG5SZWN1cnJlbmNlSW50ZXJ2YWxFZGl0b3JDb21wb25lbnQuZGVjb3JhdG9ycyA9IFtcbiAgICB7IHR5cGU6IENvbXBvbmVudCwgYXJnczogW3tcbiAgICAgICAgICAgICAgICBzZWxlY3RvcjogJ2tlbmRvLXJlY3VycmVuY2UtaW50ZXJ2YWwtZWRpdG9yJyxcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZTogYFxuICAgICAgICA8ZGl2IGNsYXNzPVwiay1lZGl0LWxhYmVsXCI+XG4gICAgICAgICAgICA8bGFiZWwgKGNsaWNrKT1cImludGVydmFsTnVtZXJpYy5mb2N1cygpXCI+e3sgdGV4dEZvclJlcGVhdEV2ZXJ5KCkgfX08L2xhYmVsPlxuICAgICAgICA8L2Rpdj5cblxuICAgICAgICA8ZGl2IGNsYXNzPVwiay1lZGl0LWZpZWxkXCI+XG4gICAgICAgICAgICA8a2VuZG8tbnVtZXJpY3RleHRib3hcbiAgICAgICAgICAgICAgICAjaW50ZXJ2YWxOdW1lcmljXG4gICAgICAgICAgICAgICAgW3N0eWxlLndpZHRoLnB4XT1cIjcwXCJcbiAgICAgICAgICAgICAgICBbbWluXT1cIm51bWVyaWNPcHRpb25zLm1pblwiXG4gICAgICAgICAgICAgICAgW21heF09XCJudW1lcmljT3B0aW9ucy5tYXhcIlxuICAgICAgICAgICAgICAgIFtkZWNpbWFsc109XCIwXCJcbiAgICAgICAgICAgICAgICBbZm9ybWF0XT1cIm51bWVyaWNPcHRpb25zLmZvcm1hdFwiXG4gICAgICAgICAgICAgICAgW2F1dG9Db3JyZWN0XT1cIm51bWVyaWNPcHRpb25zLmF1dG9Db3JyZWN0XCJcbiAgICAgICAgICAgICAgICBbcmVhZG9ubHldPVwibnVtZXJpY09wdGlvbnMucmVhZG9ubHlcIlxuICAgICAgICAgICAgICAgIFtzZWxlY3RPbkZvY3VzXT1cIm51bWVyaWNPcHRpb25zLnNlbGVjdE9uRm9jdXNcIlxuICAgICAgICAgICAgICAgIFtzcGlubmVyc109XCJudW1lcmljT3B0aW9ucy5zcGlubmVyc1wiXG4gICAgICAgICAgICAgICAgW3N0ZXBdPVwibnVtZXJpY09wdGlvbnMuc3RlcFwiXG4gICAgICAgICAgICAgICAgW3RpdGxlXT1cIm51bWVyaWNPcHRpb25zLnRpdGxlXCJcbiAgICAgICAgICAgICAgICBbKHZhbHVlKV09XCJpbnRlcnZhbFZhbHVlXCJcbiAgICAgICAgICAgICAgICAoYmx1cik9XCJvbkludGVydmFsQmx1cigpXCJcbiAgICAgICAgICAgICAgICAodmFsdWVDaGFuZ2UpPVwib25JbnRlcnZhbENoYW5nZSgkZXZlbnQpXCI+XG4gICAgICAgICAgICA8L2tlbmRvLW51bWVyaWN0ZXh0Ym94PlxuXG4gICAgICAgICAgICA8c3Bhbj57eyB0ZXh0Rm9yRnJlcXVlbmN5KCkgfX08L3NwYW4+XG4gICAgICAgIDwvZGl2PlxuICAgIGBcbiAgICAgICAgICAgIH0sXSB9LFxuXTtcbi8qKiBAbm9jb2xsYXBzZSAqL1xuUmVjdXJyZW5jZUludGVydmFsRWRpdG9yQ29tcG9uZW50LmN0b3JQYXJhbWV0ZXJzID0gKCkgPT4gW1xuICAgIHsgdHlwZTogUmVjdXJyZW5jZVNlcnZpY2UgfSxcbiAgICB7IHR5cGU6IExvY2FsaXphdGlvblNlcnZpY2UgfVxuXTtcblJlY3VycmVuY2VJbnRlcnZhbEVkaXRvckNvbXBvbmVudC5wcm9wRGVjb3JhdG9ycyA9IHtcbiAgICB1c2VyTnVtZXJpY09wdGlvbnM6IFt7IHR5cGU6IElucHV0IH1dXG59O1xuXG4vKipcbiAqIEBoaWRkZW5cbiAqL1xuY2xhc3MgUmVwZWF0T25SYWRpb0J1dHRvbkRpcmVjdGl2ZSB7XG4gICAgY29uc3RydWN0b3IoZWwsIHJlbmRlcmVyLCByZWN1cnJlbmNlLCBjaGFuZ2VEZXRlY3Rvcikge1xuICAgICAgICB0aGlzLmVsID0gZWw7XG4gICAgICAgIHRoaXMucmVuZGVyZXIgPSByZW5kZXJlcjtcbiAgICAgICAgdGhpcy5yZWN1cnJlbmNlID0gcmVjdXJyZW5jZTtcbiAgICAgICAgdGhpcy5jaGFuZ2VEZXRlY3RvciA9IGNoYW5nZURldGVjdG9yO1xuICAgICAgICB0aGlzLnR5cGUgPSAncmFkaW8nO1xuICAgICAgICB0aGlzLnJhZGlvQ2xhc3MgPSB0cnVlO1xuICAgICAgICB0aGlzLmRlc3Ryb3lDaGFuZ2UgPSB0aGlzLnJlbmRlcmVyLmxpc3Rlbih0aGlzLmVsZW0sICdjaGFuZ2UnLCB0aGlzLm9uQ2hhbmdlLmJpbmQodGhpcykpO1xuICAgIH1cbiAgICAvKiB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmU6bm8taW5wdXQtcmVuYW1lICovXG4gICAgc2V0IHJlcGVhdE9uUnVsZSh2YWx1ZSkge1xuICAgICAgICBjb25zdCBwYXJ0cyA9IHZhbHVlLnNwbGl0KCctJyk7XG4gICAgICAgIHRoaXMuX3JlcGVhdE9uUnVsZSA9IHBhcnRzWzBdO1xuICAgICAgICB0aGlzLl91bmlxdWVJZCA9IHBhcnRzWzFdO1xuICAgIH1cbiAgICBuZ09uSW5pdCgpIHtcbiAgICAgICAgdGhpcy5yZW5kZXJlci5zZXRBdHRyaWJ1dGUodGhpcy5lbGVtLCAnaWQnLCBgay1yZXBlYXRvbi0ke3RoaXMuX3JlcGVhdE9uUnVsZX0tJHt0aGlzLl91bmlxdWVJZH1gKTtcbiAgICAgICAgdGhpcy5yZW5kZXJlci5zZXRBdHRyaWJ1dGUodGhpcy5lbGVtLCAnbmFtZScsIGBkYXktJHt0aGlzLl91bmlxdWVJZH1gKTtcbiAgICB9XG4gICAgbmdBZnRlckNvbnRlbnRDaGVja2VkKCkge1xuICAgICAgICB0aGlzLnNldENoZWNrZWRTdGF0ZSgpO1xuICAgIH1cbiAgICBuZ09uRGVzdHJveSgpIHtcbiAgICAgICAgaWYgKHRoaXMuZGVzdHJveUNoYW5nZSkge1xuICAgICAgICAgICAgdGhpcy5kZXN0cm95Q2hhbmdlKCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgb25DaGFuZ2UoKSB7XG4gICAgICAgIGlmICh0aGlzLmVsZW0uY2hlY2tlZCkge1xuICAgICAgICAgICAgdGhpcy5yZWN1cnJlbmNlLnJlcGVhdE9uUnVsZSA9IHRoaXMuX3JlcGVhdE9uUnVsZTtcbiAgICAgICAgICAgIHRoaXMuY2hhbmdlRGV0ZWN0b3IubWFya0ZvckNoZWNrKCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc2V0Q2hlY2tlZFN0YXRlKCkge1xuICAgICAgICBjb25zdCBpc0NoZWNrZWQgPSB0aGlzLl9yZXBlYXRPblJ1bGUgPT09IHRoaXMucmVjdXJyZW5jZS5yZXBlYXRPblJ1bGU7XG4gICAgICAgIHRoaXMucmVuZGVyZXIuc2V0UHJvcGVydHkodGhpcy5lbGVtLCAnY2hlY2tlZCcsIGlzQ2hlY2tlZCk7XG4gICAgfVxuICAgIGdldCBlbGVtKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5lbC5uYXRpdmVFbGVtZW50O1xuICAgIH1cbn1cblJlcGVhdE9uUmFkaW9CdXR0b25EaXJlY3RpdmUuZGVjb3JhdG9ycyA9IFtcbiAgICB7IHR5cGU6IERpcmVjdGl2ZSwgYXJnczogW3tcbiAgICAgICAgICAgICAgICBzZWxlY3RvcjogJ1trZW5kb1JlY3VycmVuY2VSZXBlYXRPblJhZGlvQnV0dG9uXSdcbiAgICAgICAgICAgIH0sXSB9LFxuXTtcbi8qKiBAbm9jb2xsYXBzZSAqL1xuUmVwZWF0T25SYWRpb0J1dHRvbkRpcmVjdGl2ZS5jdG9yUGFyYW1ldGVycyA9ICgpID0+IFtcbiAgICB7IHR5cGU6IEVsZW1lbnRSZWYgfSxcbiAgICB7IHR5cGU6IFJlbmRlcmVyMiB9LFxuICAgIHsgdHlwZTogUmVjdXJyZW5jZVNlcnZpY2UgfSxcbiAgICB7IHR5cGU6IENoYW5nZURldGVjdG9yUmVmIH1cbl07XG5SZXBlYXRPblJhZGlvQnV0dG9uRGlyZWN0aXZlLnByb3BEZWNvcmF0b3JzID0ge1xuICAgIHR5cGU6IFt7IHR5cGU6IEhvc3RCaW5kaW5nLCBhcmdzOiBbJ2F0dHIudHlwZScsXSB9XSxcbiAgICByYWRpb0NsYXNzOiBbeyB0eXBlOiBIb3N0QmluZGluZywgYXJnczogWydjbGFzcy5rLXJhZGlvJyxdIH1dLFxuICAgIHJlcGVhdE9uUnVsZTogW3sgdHlwZTogSW5wdXQsIGFyZ3M6IFtcImtlbmRvUmVjdXJyZW5jZVJlcGVhdE9uUmFkaW9CdXR0b25cIixdIH1dXG59O1xuXG4vKipcbiAqIEBoaWRkZW5cbiAqL1xuY2xhc3MgUmVjdXJyZW5jZU1vbnRobHlZZWFybHlFZGl0b3JDb21wb25lbnQge1xuICAgIGNvbnN0cnVjdG9yKHJlY3VycmVuY2UsIGxvY2FsaXphdGlvbikge1xuICAgICAgICB0aGlzLnJlY3VycmVuY2UgPSByZWN1cnJlbmNlO1xuICAgICAgICB0aGlzLmxvY2FsaXphdGlvbiA9IGxvY2FsaXphdGlvbjtcbiAgICAgICAgdGhpcy51bmlxdWVJZCA9IHRoaXMucmVjdXJyZW5jZS5nZXRVbmlxdWVJZCgpO1xuICAgICAgICB0aGlzLm51bWVyaWNPcHRpb25zID0ge1xuICAgICAgICAgICAgbWluOiAxLFxuICAgICAgICAgICAgbWF4OiAzMSxcbiAgICAgICAgICAgIGZvcm1hdDogJyMnLFxuICAgICAgICAgICAgYXV0b0NvcnJlY3Q6IHRydWUsXG4gICAgICAgICAgICBzdGVwOiAxLFxuICAgICAgICAgICAgc3Bpbm5lcnM6IHRydWVcbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5zZXRJbml0aWFsVmFsdWVzKCk7XG4gICAgICAgIHRoaXMuc3Vic2NyaWJlRXZlbnRIYW5kbGVycygpO1xuICAgIH1cbiAgICBzZXQgdXNlck51bWVyaWNPcHRpb25zKG9wdGlvbnMpIHtcbiAgICAgICAgdGhpcy5udW1lcmljT3B0aW9ucyA9IE9iamVjdC5hc3NpZ24oe30sIHRoaXMubnVtZXJpY09wdGlvbnMsIG9wdGlvbnMpO1xuICAgIH1cbiAgICBzZXRJbml0aWFsVmFsdWVzKCkge1xuICAgICAgICB0aGlzLmV4dGVuZGVkV2Vla0RheXMgPSB0aGlzLnJlY3VycmVuY2UuZXh0ZW5kZWRXZWVrRGF5cztcbiAgICAgICAgdGhpcy5vZmZzZXRQb3NpdGlvbnMgPSB0aGlzLnJlY3VycmVuY2Uub2Zmc2V0UG9zaXRpb25zO1xuICAgICAgICB0aGlzLmN1cnJlbnRPZmZzZXQgPSB0aGlzLmRlZmF1bHRPZmZzZXQ7XG4gICAgICAgIHRoaXMuY3VycmVudFdlZWtEYXkgPSB0aGlzLmRlZmF1bHRXZWVrRGF5O1xuICAgICAgICBpZiAodGhpcy5jdXJyZW50RnJlcSA9PT0gJ3llYXJseScpIHtcbiAgICAgICAgICAgIHRoaXMubW9udGhzID0gdGhpcy5yZWN1cnJlbmNlLm1vbnRocztcbiAgICAgICAgICAgIHRoaXMuY3VycmVudE1vbnRoTW9udGhEYXkgPSB0aGlzLmN1cnJlbnRNb250aFdlZWtEYXkgPSB0aGlzLnJlY3VycmVuY2UucnJ1bGUuYnlNb250aFswXTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzdWJzY3JpYmVFdmVudEhhbmRsZXJzKCkge1xuICAgICAgICB0aGlzLnN1YnMgPSB0aGlzLnJlY3VycmVuY2UucmVwZWF0T25SdWxlQ2hhbmdlLnN1YnNjcmliZSh0aGlzLm9uUmVwZWF0T25SdWxlQ2hhbmdlLmJpbmQodGhpcykpO1xuICAgICAgICB0aGlzLnN1YnMuYWRkKHRoaXMucmVjdXJyZW5jZS5mcmVxdWVuY3lDaGFuZ2Uuc3Vic2NyaWJlKHRoaXMub25GcmVxdWVuY3lDaGFuZ2UuYmluZCh0aGlzKSkpO1xuICAgIH1cbiAgICBvblJlcGVhdE9uUnVsZUNoYW5nZShuZXdSZXBlYXRPblJ1bGUpIHtcbiAgICAgICAgaWYgKG5ld1JlcGVhdE9uUnVsZSA9PT0gJ21vbnRoZGF5Jykge1xuICAgICAgICAgICAgdGhpcy5yZWN1cnJlbmNlLnJydWxlLmJ5TW9udGhEYXkgPSBbdGhpcy5tb250aERheV07XG4gICAgICAgICAgICBpZiAodGhpcy5jdXJyZW50RnJlcSA9PT0gJ3llYXJseScpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnJlY3VycmVuY2UucnJ1bGUuYnlNb250aCA9IFt0aGlzLmN1cnJlbnRNb250aE1vbnRoRGF5XTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChuZXdSZXBlYXRPblJ1bGUgPT09ICd3ZWVrZGF5Jykge1xuICAgICAgICAgICAgaWYgKHR5cGVvZiB0aGlzLndlZWtEYXkgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICAgICAgLyogZGF5LCB3ZWVrZGF5IG9yIHdlZWtlbmQgKi9cbiAgICAgICAgICAgICAgICB0aGlzLnJlY3VycmVuY2UucnJ1bGUuYnlTZXRQb3NpdGlvbiA9IFt0aGlzLm9mZnNldF07XG4gICAgICAgICAgICAgICAgdGhpcy5yZWN1cnJlbmNlLnJydWxlLmJ5V2Vla0RheSA9IHRoaXMud2Vla0RheVJ1bGVGcm9tU3RyaW5nKHRoaXMud2Vla0RheSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAvKiBzcGVjaWZpYyB3ZWVrZGF5ICovXG4gICAgICAgICAgICAgICAgdGhpcy5yZWN1cnJlbmNlLnJydWxlLmJ5V2Vla0RheSA9IFt7XG4gICAgICAgICAgICAgICAgICAgICAgICBkYXk6IHRoaXMud2Vla0RheSxcbiAgICAgICAgICAgICAgICAgICAgICAgIG9mZnNldDogdGhpcy5vZmZzZXRcbiAgICAgICAgICAgICAgICAgICAgfV07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodGhpcy5jdXJyZW50RnJlcSA9PT0gJ3llYXJseScpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnJlY3VycmVuY2UucnJ1bGUuYnlNb250aCA9IFt0aGlzLmN1cnJlbnRNb250aFdlZWtEYXldO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIG9uRnJlcXVlbmN5Q2hhbmdlKCkge1xuICAgICAgICB0aGlzLnNldEluaXRpYWxWYWx1ZXMoKTtcbiAgICB9XG4gICAgbmdPbkRlc3Ryb3koKSB7XG4gICAgICAgIGlmICh0aGlzLnN1YnMpIHtcbiAgICAgICAgICAgIHRoaXMuc3Vicy51bnN1YnNjcmliZSgpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGdldCBtb250aERheSgpIHtcbiAgICAgICAgY29uc3QgcnJ1bGUgPSB0aGlzLnJlY3VycmVuY2UucnJ1bGU7XG4gICAgICAgIGlmIChpc1ByZXNlbnQocnJ1bGUuYnlNb250aERheSkgJiYgcnJ1bGUuYnlNb250aERheS5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICByZXR1cm4gcnJ1bGUuYnlNb250aERheVswXTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChpc1ByZXNlbnQodGhpcy5jdXJyZW50TW9udGhEYXkpKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5jdXJyZW50TW9udGhEYXk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5yZWN1cnJlbmNlLnN0YXJ0LmdldERhdGUoKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBnZXQgd2Vla0RheSgpIHtcbiAgICAgICAgY29uc3QgcnJ1bGUgPSB0aGlzLnJlY3VycmVuY2UucnJ1bGU7XG4gICAgICAgIGlmIChpc1ByZXNlbnQocnJ1bGUuYnlXZWVrRGF5KSkge1xuICAgICAgICAgICAgY29uc3Qgd2Vla0RheXNDb3VudCA9IHJydWxlLmJ5V2Vla0RheS5sZW5ndGg7XG4gICAgICAgICAgICBzd2l0Y2ggKHdlZWtEYXlzQ291bnQpIHtcbiAgICAgICAgICAgICAgICBjYXNlIDc6XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAnZGF5JztcbiAgICAgICAgICAgICAgICBjYXNlIDU6XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAnd2Vla2RheSc7XG4gICAgICAgICAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gJ3dlZWtlbmQnO1xuICAgICAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJydWxlLmJ5V2Vla0RheVswXS5kYXk7XG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoaXNQcmVzZW50KHRoaXMuY3VycmVudFdlZWtEYXkpKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5jdXJyZW50V2Vla0RheTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5kZWZhdWx0V2Vla0RheTtcbiAgICB9XG4gICAgZ2V0IG9mZnNldCgpIHtcbiAgICAgICAgY29uc3QgcnJ1bGUgPSB0aGlzLnJlY3VycmVuY2UucnJ1bGU7XG4gICAgICAgIGlmIChpc1ByZXNlbnQocnJ1bGUuYnlXZWVrRGF5KSkge1xuICAgICAgICAgICAgY29uc3Qgd2Vla0RheXNDb3VudCA9IHJydWxlLmJ5V2Vla0RheS5sZW5ndGg7XG4gICAgICAgICAgICBzd2l0Y2ggKHdlZWtEYXlzQ291bnQpIHtcbiAgICAgICAgICAgICAgICBjYXNlIDc6XG4gICAgICAgICAgICAgICAgY2FzZSA1OlxuICAgICAgICAgICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJydWxlLmJ5U2V0UG9zaXRpb25bMF07XG4gICAgICAgICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcnJ1bGUuYnlXZWVrRGF5WzBdLm9mZnNldDtcbiAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChpc1ByZXNlbnQodGhpcy5jdXJyZW50T2Zmc2V0KSkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuY3VycmVudE9mZnNldDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5kZWZhdWx0T2Zmc2V0O1xuICAgIH1cbiAgICBvbk1vbnRoQ2hhbmdlKG1vbnRoLCByZXBlYXRPblJ1bGUpIHtcbiAgICAgICAgaWYgKHJlcGVhdE9uUnVsZSA9PT0gJ21vbnRoZGF5Jykge1xuICAgICAgICAgICAgdGhpcy5jdXJyZW50TW9udGhNb250aERheSA9IG1vbnRoO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5jdXJyZW50TW9udGhXZWVrRGF5ID0gbW9udGg7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5yZWN1cnJlbmNlLnNldE1vbnRocyhbbW9udGhdKTtcbiAgICB9XG4gICAgb25Nb250aERheUNoYW5nZShtb250aERheSkge1xuICAgICAgICB0aGlzLmN1cnJlbnRNb250aERheSA9IG1vbnRoRGF5O1xuICAgICAgICB0aGlzLnJlY3VycmVuY2UubW9udGhEYXlzID0gW21vbnRoRGF5XTtcbiAgICB9XG4gICAgb25PZmZzZXRQb3NpdGlvbkNoYW5nZShvZmZzZXQpIHtcbiAgICAgICAgY29uc3QgcnJ1bGUgPSB0aGlzLnJlY3VycmVuY2UucnJ1bGU7XG4gICAgICAgIGlmIChpc1ByZXNlbnQocnJ1bGUuYnlXZWVrRGF5KSkge1xuICAgICAgICAgICAgY29uc3Qgd2Vla0RheXNDb3VudCA9IHJydWxlLmJ5V2Vla0RheS5sZW5ndGg7XG4gICAgICAgICAgICBzd2l0Y2ggKHdlZWtEYXlzQ291bnQpIHtcbiAgICAgICAgICAgICAgICBjYXNlIDc6XG4gICAgICAgICAgICAgICAgY2FzZSA1OlxuICAgICAgICAgICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5yZWN1cnJlbmNlLnBvc2l0aW9ucyA9IFtvZmZzZXRdO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICAgICAgICAgIHJydWxlLmJ5V2Vla0RheVswXS5vZmZzZXQgPSBvZmZzZXQ7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucmVjdXJyZW5jZS5vbkNoYW5nZSgpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB0aGlzLmN1cnJlbnRPZmZzZXQgPSBvZmZzZXQ7XG4gICAgfVxuICAgIG9uV2Vla0RheUNoYW5nZSh3ZWVrRGF5KSB7XG4gICAgICAgIGxldCB3ZWVrRGF5cztcbiAgICAgICAgaWYgKHR5cGVvZiB3ZWVrRGF5ID09PSAnc3RyaW5nJykge1xuICAgICAgICAgICAgLyogZGF5LCB3ZWVrZGF5IG9yIHdlZWtlbmQgKi9cbiAgICAgICAgICAgIHdlZWtEYXlzID0gdGhpcy53ZWVrRGF5UnVsZUZyb21TdHJpbmcod2Vla0RheSk7XG4gICAgICAgICAgICB0aGlzLnJlY3VycmVuY2UucG9zaXRpb25zID0gW3RoaXMub2Zmc2V0XTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIC8qIHNwZWNpZmljIHdlZWtkYXkgKi9cbiAgICAgICAgICAgIHdlZWtEYXlzID0gW3tcbiAgICAgICAgICAgICAgICAgICAgZGF5OiB3ZWVrRGF5LFxuICAgICAgICAgICAgICAgICAgICBvZmZzZXQ6IHRoaXMub2Zmc2V0XG4gICAgICAgICAgICAgICAgfV07XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5jdXJyZW50V2Vla0RheSA9IHdlZWtEYXk7XG4gICAgICAgIHRoaXMucmVjdXJyZW5jZS5zZXRXZWVrRGF5cyh3ZWVrRGF5cyk7XG4gICAgfVxuICAgIGlzRGlzYWJsZWQocmVwZWF0T24pIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucmVjdXJyZW5jZS5yZXBlYXRPblJ1bGUgIT09IHJlcGVhdE9uO1xuICAgIH1cbiAgICBnZXQgY3VycmVudEZyZXEoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnJlY3VycmVuY2UuZnJlcXVlbmN5O1xuICAgIH1cbiAgICBnZXQgZGVmYXVsdE9mZnNldCgpIHtcbiAgICAgICAgcmV0dXJuIDE7XG4gICAgfVxuICAgIGdldCBkZWZhdWx0V2Vla0RheSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucmVjdXJyZW5jZS5zdGFydC5nZXREYXkoKTtcbiAgICB9XG4gICAgd2Vla0RheVJ1bGVGcm9tU3RyaW5nKHdlZWtEYXkpIHtcbiAgICAgICAgc3dpdGNoICh3ZWVrRGF5KSB7XG4gICAgICAgICAgICBjYXNlICdkYXknOlxuICAgICAgICAgICAgICAgIHJldHVybiBkYXlSdWxlO1xuICAgICAgICAgICAgY2FzZSAnd2Vla2RheSc6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHdlZWtkYXlSdWxlO1xuICAgICAgICAgICAgY2FzZSAnd2Vla2VuZCc6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHdlZWtlbmRSdWxlO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG4gICAgdGV4dEZvclJlcGVhdE9uKCkge1xuICAgICAgICBjb25zdCBmcmVxID0gdGhpcy5jdXJyZW50RnJlcTtcbiAgICAgICAgc3dpdGNoIChmcmVxKSB7XG4gICAgICAgICAgICBjYXNlICdtb250aGx5JzpcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy50ZXh0Rm9yKCdtb250aGx5UmVwZWF0T24nKTtcbiAgICAgICAgICAgIGNhc2UgJ3llYXJseSc6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMudGV4dEZvcigneWVhcmx5UmVwZWF0T24nKTtcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICB9XG4gICAgdGV4dEZvcihrZXkpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubG9jYWxpemF0aW9uLmdldChrZXkpO1xuICAgIH1cbiAgICBvblJlcGVhdE9uTGFiZWxDbGljaygpIHtcbiAgICAgICAgY29uc3Qgc2VsZWN0ZWQgPSB0aGlzLnJlcGVhdE9uUmFkaW9CdXR0b25zLnRvQXJyYXkoKS5maW5kKHIgPT4gci5lbGVtLmNoZWNrZWQpO1xuICAgICAgICBpZiAoc2VsZWN0ZWQpIHtcbiAgICAgICAgICAgIHNlbGVjdGVkLmVsZW0uZm9jdXMoKTtcbiAgICAgICAgfVxuICAgIH1cbn1cblJlY3VycmVuY2VNb250aGx5WWVhcmx5RWRpdG9yQ29tcG9uZW50LmRlY29yYXRvcnMgPSBbXG4gICAgeyB0eXBlOiBDb21wb25lbnQsIGFyZ3M6IFt7XG4gICAgICAgICAgICAgICAgc2VsZWN0b3I6ICdrZW5kby1yZWN1cnJlbmNlLW1vbnRobHkteWVhcmx5LWVkaXRvcicsXG4gICAgICAgICAgICAgICAgdGVtcGxhdGU6IGBcbiAgICAgICAgPGRpdiBjbGFzcz0nay1lZGl0LWxhYmVsJz5cbiAgICAgICAgICAgIDxsYWJlbCAoY2xpY2spPVwib25SZXBlYXRPbkxhYmVsQ2xpY2soKVwiPnt7IHRleHRGb3JSZXBlYXRPbigpIH19PC9sYWJlbD5cbiAgICAgICAgPC9kaXY+XG4gICAgICAgIDxkaXYgY2xhc3M9J2stZWRpdC1maWVsZCc+XG4gICAgICAgICAgICA8dWwgY2xhc3M9J2stcmVzZXQnIFtzdHlsZS53aWR0aC5weF09JzY1MCc+XG4gICAgICAgICAgICAgICAgPGxpPlxuICAgICAgICAgICAgICAgICAgICA8aW5wdXQga2VuZG9SZWN1cnJlbmNlUmVwZWF0T25SYWRpb0J1dHRvbj0nbW9udGhkYXkte3t1bmlxdWVJZH19JyAvPlxuXG4gICAgICAgICAgICAgICAgICAgIDxsYWJlbCBjbGFzcz0nay1yYWRpby1sYWJlbCcgZm9yPSdrLXJlcGVhdG9uLW1vbnRoZGF5LXt7dW5pcXVlSWR9fSc+XG4gICAgICAgICAgICAgICAgICAgICAgICA8bmctdGVtcGxhdGUgW25nSWZdPVwiY3VycmVudEZyZXEgPT09ICdtb250aGx5J1wiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHt7IHRleHRGb3IoJ21vbnRobHlEYXknKSB9fVxuICAgICAgICAgICAgICAgICAgICAgICAgPC9uZy10ZW1wbGF0ZT5cbiAgICAgICAgICAgICAgICAgICAgPC9sYWJlbD5cblxuICAgICAgICAgICAgICAgICAgICA8bmctdGVtcGxhdGUgW25nSWZdPVwiY3VycmVudEZyZXEgPT09ICd5ZWFybHknXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICA8a2VuZG8tZHJvcGRvd25saXN0XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgW2RhdGFdPSdtb250aHMnXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dEZpZWxkPSd0ZXh0J1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlRmllbGQ9J3ZhbHVlJ1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFt2YWx1ZV09J2N1cnJlbnRNb250aE1vbnRoRGF5J1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFt2YWx1ZVByaW1pdGl2ZV09J3RydWUnXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKHZhbHVlQ2hhbmdlKT1cIm9uTW9udGhDaGFuZ2UoJGV2ZW50LCAnbW9udGhkYXknKVwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgW2Rpc2FibGVkXT1cImlzRGlzYWJsZWQoJ21vbnRoZGF5JylcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgIDwva2VuZG8tZHJvcGRvd25saXN0PlxuICAgICAgICAgICAgICAgICAgICA8L25nLXRlbXBsYXRlPlxuXG4gICAgICAgICAgICAgICAgICAgIDxrZW5kby1udW1lcmljdGV4dGJveFxuICAgICAgICAgICAgICAgICAgICAgICAgW3N0eWxlLndpZHRoLnB4XT0nNzAnXG4gICAgICAgICAgICAgICAgICAgICAgICBbbWluXT1cIm51bWVyaWNPcHRpb25zLm1pblwiXG4gICAgICAgICAgICAgICAgICAgICAgICBbbWF4XT1cIm51bWVyaWNPcHRpb25zLm1heFwiXG4gICAgICAgICAgICAgICAgICAgICAgICBbZGVjaW1hbHNdPVwiMFwiXG4gICAgICAgICAgICAgICAgICAgICAgICBbZm9ybWF0XT1cIm51bWVyaWNPcHRpb25zLmZvcm1hdFwiXG4gICAgICAgICAgICAgICAgICAgICAgICBbYXV0b0NvcnJlY3RdPVwibnVtZXJpY09wdGlvbnMuYXV0b0NvcnJlY3RcIlxuICAgICAgICAgICAgICAgICAgICAgICAgW3JlYWRvbmx5XT1cIm51bWVyaWNPcHRpb25zLnJlYWRvbmx5XCJcbiAgICAgICAgICAgICAgICAgICAgICAgIFtzZWxlY3RPbkZvY3VzXT1cIm51bWVyaWNPcHRpb25zLnNlbGVjdE9uRm9jdXNcIlxuICAgICAgICAgICAgICAgICAgICAgICAgW3NwaW5uZXJzXT1cIm51bWVyaWNPcHRpb25zLnNwaW5uZXJzXCJcbiAgICAgICAgICAgICAgICAgICAgICAgIFtzdGVwXT1cIm51bWVyaWNPcHRpb25zLnN0ZXBcIlxuICAgICAgICAgICAgICAgICAgICAgICAgW3RpdGxlXT1cIm51bWVyaWNPcHRpb25zLnRpdGxlXCJcbiAgICAgICAgICAgICAgICAgICAgICAgIFt2YWx1ZV09J21vbnRoRGF5J1xuICAgICAgICAgICAgICAgICAgICAgICAgKHZhbHVlQ2hhbmdlKT0nb25Nb250aERheUNoYW5nZSgkZXZlbnQpJ1xuICAgICAgICAgICAgICAgICAgICAgICAgW2Rpc2FibGVkXT1cImlzRGlzYWJsZWQoJ21vbnRoZGF5JylcIj5cbiAgICAgICAgICAgICAgICAgICAgPC9rZW5kby1udW1lcmljdGV4dGJveD5cbiAgICAgICAgICAgICAgICA8L2xpPlxuICAgICAgICAgICAgICAgIDxsaT5cbiAgICAgICAgICAgICAgICAgICAgPGlucHV0IGtlbmRvUmVjdXJyZW5jZVJlcGVhdE9uUmFkaW9CdXR0b249J3dlZWtkYXkte3t1bmlxdWVJZH19JyAvPlxuICAgICAgICAgICAgICAgICAgICA8bGFiZWwgY2xhc3M9J2stcmFkaW8tbGFiZWwnIGZvcj0nay1yZXBlYXRvbi13ZWVrZGF5LXt7dW5pcXVlSWR9fSc+PC9sYWJlbD5cblxuICAgICAgICAgICAgICAgICAgICA8a2VuZG8tZHJvcGRvd25saXN0XG4gICAgICAgICAgICAgICAgICAgICAgICBbZGF0YV09J29mZnNldFBvc2l0aW9ucydcbiAgICAgICAgICAgICAgICAgICAgICAgIHRleHRGaWVsZD0ndGV4dCdcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlRmllbGQ9J3ZhbHVlJ1xuICAgICAgICAgICAgICAgICAgICAgICAgW3ZhbHVlXT0nb2Zmc2V0J1xuICAgICAgICAgICAgICAgICAgICAgICAgW3ZhbHVlUHJpbWl0aXZlXT0ndHJ1ZSdcbiAgICAgICAgICAgICAgICAgICAgICAgICh2YWx1ZUNoYW5nZSk9J29uT2Zmc2V0UG9zaXRpb25DaGFuZ2UoJGV2ZW50KSdcbiAgICAgICAgICAgICAgICAgICAgICAgIFtkaXNhYmxlZF09XCJpc0Rpc2FibGVkKCd3ZWVrZGF5JylcIj5cbiAgICAgICAgICAgICAgICAgICAgPC9rZW5kby1kcm9wZG93bmxpc3Q+XG5cbiAgICAgICAgICAgICAgICAgICAgPGtlbmRvLWRyb3Bkb3dubGlzdFxuICAgICAgICAgICAgICAgICAgICAgICAgW2RhdGFdPVwiZXh0ZW5kZWRXZWVrRGF5c1wiXG4gICAgICAgICAgICAgICAgICAgICAgICB0ZXh0RmllbGQ9J3RleHQnXG4gICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZUZpZWxkPSd2YWx1ZSdcbiAgICAgICAgICAgICAgICAgICAgICAgIFt2YWx1ZV09J3dlZWtEYXknXG4gICAgICAgICAgICAgICAgICAgICAgICBbdmFsdWVQcmltaXRpdmVdPSd0cnVlJ1xuICAgICAgICAgICAgICAgICAgICAgICAgKHZhbHVlQ2hhbmdlKT0nb25XZWVrRGF5Q2hhbmdlKCRldmVudCknXG4gICAgICAgICAgICAgICAgICAgICAgICBbZGlzYWJsZWRdPVwiaXNEaXNhYmxlZCgnd2Vla2RheScpXCI+XG4gICAgICAgICAgICAgICAgICAgIDwva2VuZG8tZHJvcGRvd25saXN0PlxuXG4gICAgICAgICAgICAgICAgICAgIDxuZy10ZW1wbGF0ZSBbbmdJZl09XCJjdXJyZW50RnJlcSA9PT0gJ3llYXJseSdcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuPnt7IHRleHRGb3IoJ3llYXJseU9mJykgfX08L3NwYW4+XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxrZW5kby1kcm9wZG93bmxpc3RcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbZGF0YV09J21vbnRocydcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0RmllbGQ9J3RleHQnXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWVGaWVsZD0ndmFsdWUnXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgW3ZhbHVlXT0nY3VycmVudE1vbnRoV2Vla0RheSdcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbdmFsdWVQcmltaXRpdmVdPSd0cnVlJ1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICh2YWx1ZUNoYW5nZSk9XCJvbk1vbnRoQ2hhbmdlKCRldmVudCwgJ3dlZWtkYXknKVwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgW2Rpc2FibGVkXT1cImlzRGlzYWJsZWQoJ3dlZWtkYXknKVwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgPC9rZW5kby1kcm9wZG93bmxpc3Q+XG4gICAgICAgICAgICAgICAgICAgIDwvbmctdGVtcGxhdGU+XG4gICAgICAgICAgICAgICAgPC9saT5cbiAgICAgICAgICAgIDwvdWw+XG4gICAgICAgIDwvZGl2PlxuICAgIGBcbiAgICAgICAgICAgIH0sXSB9LFxuXTtcbi8qKiBAbm9jb2xsYXBzZSAqL1xuUmVjdXJyZW5jZU1vbnRobHlZZWFybHlFZGl0b3JDb21wb25lbnQuY3RvclBhcmFtZXRlcnMgPSAoKSA9PiBbXG4gICAgeyB0eXBlOiBSZWN1cnJlbmNlU2VydmljZSB9LFxuICAgIHsgdHlwZTogTG9jYWxpemF0aW9uU2VydmljZSB9XG5dO1xuUmVjdXJyZW5jZU1vbnRobHlZZWFybHlFZGl0b3JDb21wb25lbnQucHJvcERlY29yYXRvcnMgPSB7XG4gICAgdXNlck51bWVyaWNPcHRpb25zOiBbeyB0eXBlOiBJbnB1dCB9XSxcbiAgICByZXBlYXRPblJhZGlvQnV0dG9uczogW3sgdHlwZTogVmlld0NoaWxkcmVuLCBhcmdzOiBbUmVwZWF0T25SYWRpb0J1dHRvbkRpcmVjdGl2ZSxdIH1dXG59O1xuXG4vKipcbiAqIEBoaWRkZW5cbiAqL1xuY2xhc3MgUmVjdXJyZW5jZVdlZWtkYXlSdWxlRWRpdG9yQ29tcG9uZW50IHtcbiAgICBjb25zdHJ1Y3RvcihyZWN1cnJlbmNlLCBsb2NhbGl6YXRpb24pIHtcbiAgICAgICAgdGhpcy5yZWN1cnJlbmNlID0gcmVjdXJyZW5jZTtcbiAgICAgICAgdGhpcy5sb2NhbGl6YXRpb24gPSBsb2NhbGl6YXRpb247XG4gICAgICAgIHRoaXMuc2VsZWN0ZWQgPSBbXTtcbiAgICAgICAgdGhpcy53ZWVrRGF5cyA9IHRoaXMucmVjdXJyZW5jZS53ZWVrRGF5cztcbiAgICAgICAgdGhpcy5zZXRTZWxlY3RlZERheXMoKTtcbiAgICB9XG4gICAgc2V0U2VsZWN0ZWREYXlzKCkge1xuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IDc7IGkrKykge1xuICAgICAgICAgICAgdGhpcy5zZWxlY3RlZFtpXSA9IGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIGlmIChpc1ByZXNlbnQodGhpcy5ycnVsZS5ieVdlZWtEYXkpKSB7XG4gICAgICAgICAgICB0aGlzLnJydWxlLmJ5V2Vla0RheS5mb3JFYWNoKChydWxlKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5zZWxlY3RlZFtydWxlLmRheV0gPSB0cnVlO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgb25TZWxlY3RlZENoYW5nZShpc1NlbGVjdGVkLCBkYXkpIHtcbiAgICAgICAgdGhpcy5zZWxlY3RlZFtkYXldID0gaXNTZWxlY3RlZDtcbiAgICAgICAgdGhpcy5yZWN1cnJlbmNlLnNldFdlZWtEYXlzKHRoaXMuc2VyaWFsaXplVG9XZWVrRGF5UnVsZUFycmF5KHRoaXMuc2VsZWN0ZWQpKTtcbiAgICB9XG4gICAgaXNTZWxlY3RlZChkYXkpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuc2VsZWN0ZWRbZGF5LnZhbHVlXTtcbiAgICB9XG4gICAgc2VyaWFsaXplVG9XZWVrRGF5UnVsZUFycmF5KGFycikge1xuICAgICAgICBsZXQgc2VsZWN0ZWRWYWx1ZXMgPSBbXTtcbiAgICAgICAgYXJyLmZvckVhY2goKGlzU2VsZWN0ZWQsIGlkeCkgPT4ge1xuICAgICAgICAgICAgaWYgKGlzU2VsZWN0ZWQpIHtcbiAgICAgICAgICAgICAgICBzZWxlY3RlZFZhbHVlcy5wdXNoKHsgZGF5OiBpZHgsIG9mZnNldDogMCB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBzZWxlY3RlZFZhbHVlcy5sZW5ndGggPiAwID8gc2VsZWN0ZWRWYWx1ZXMgOiBudWxsO1xuICAgIH1cbiAgICBnZXQgcnJ1bGUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnJlY3VycmVuY2UucnJ1bGU7XG4gICAgfVxuICAgIGNhcGl0YWxpemUoZGF5KSB7XG4gICAgICAgIHJldHVybiBjYXBpdGFsaXplKGRheSk7XG4gICAgfVxuICAgIHRleHRGb3Ioa2V5KSB7XG4gICAgICAgIHJldHVybiB0aGlzLmxvY2FsaXphdGlvbi5nZXQoa2V5KTtcbiAgICB9XG4gICAgb25XZWVrbHlSZXBlYXRPbkNsaWNrKCkge1xuICAgICAgICBjb25zdCBzZWxlY3RlZCA9IHRoaXMud2Vla0RheUJ1dHRvbnMudG9BcnJheSgpLmZpbmQociA9PiByLnNlbGVjdGVkKTtcbiAgICAgICAgaWYgKHNlbGVjdGVkKSB7XG4gICAgICAgICAgICBzZWxlY3RlZC5mb2N1cygpO1xuICAgICAgICB9XG4gICAgfVxufVxuUmVjdXJyZW5jZVdlZWtkYXlSdWxlRWRpdG9yQ29tcG9uZW50LmRlY29yYXRvcnMgPSBbXG4gICAgeyB0eXBlOiBDb21wb25lbnQsIGFyZ3M6IFt7XG4gICAgICAgICAgICAgICAgc2VsZWN0b3I6ICdrZW5kby1yZWN1cnJlbmNlLXdlZWtkYXktcnVsZS1lZGl0b3InLFxuICAgICAgICAgICAgICAgIHRlbXBsYXRlOiBgXG4gICAgICAgIDxkaXYgY2xhc3M9J2stZWRpdC1sYWJlbCc+XG4gICAgICAgICAgICA8bGFiZWwgKGNsaWNrKT1cIm9uV2Vla2x5UmVwZWF0T25DbGljaygpXCI+e3sgdGV4dEZvcignd2Vla2x5UmVwZWF0T24nKSB9fTwvbGFiZWw+XG4gICAgICAgIDwvZGl2PlxuICAgICAgICA8ZGl2IGNsYXNzPSdrLWVkaXQtZmllbGQnPlxuICAgICAgICAgICAgPGtlbmRvLWJ1dHRvbmdyb3VwIFtzZWxlY3Rpb25dPVwiJ211bHRpcGxlJ1wiPlxuICAgICAgICAgICAgICAgIDxidXR0b24gKm5nRm9yPSdsZXQgZGF5IG9mIHdlZWtEYXlzJyBrZW5kb0J1dHRvblxuICAgICAgICAgICAgICAgICAgICAgICAgW3N0eWxlLndpZHRoLnB4XT1cIjc1XCJcbiAgICAgICAgICAgICAgICAgICAgICAgIFt0b2dnbGVhYmxlXT1cInRydWVcIlxuICAgICAgICAgICAgICAgICAgICAgICAgW3NlbGVjdGVkXT1cImlzU2VsZWN0ZWQoZGF5KVwiXG4gICAgICAgICAgICAgICAgICAgICAgICAoc2VsZWN0ZWRDaGFuZ2UpPVwib25TZWxlY3RlZENoYW5nZSgkZXZlbnQsIGRheS52YWx1ZSlcIlxuICAgICAgICAgICAgICAgID57eyBjYXBpdGFsaXplKGRheS50ZXh0KSB9fTwvYnV0dG9uPlxuICAgICAgICAgICAgPC9rZW5kby1idXR0b25ncm91cD5cbiAgICAgICAgPC9kaXY+XG4gICAgYFxuICAgICAgICAgICAgfSxdIH0sXG5dO1xuLyoqIEBub2NvbGxhcHNlICovXG5SZWN1cnJlbmNlV2Vla2RheVJ1bGVFZGl0b3JDb21wb25lbnQuY3RvclBhcmFtZXRlcnMgPSAoKSA9PiBbXG4gICAgeyB0eXBlOiBSZWN1cnJlbmNlU2VydmljZSB9LFxuICAgIHsgdHlwZTogTG9jYWxpemF0aW9uU2VydmljZSB9XG5dO1xuUmVjdXJyZW5jZVdlZWtkYXlSdWxlRWRpdG9yQ29tcG9uZW50LnByb3BEZWNvcmF0b3JzID0ge1xuICAgIHdlZWtEYXlCdXR0b25zOiBbeyB0eXBlOiBWaWV3Q2hpbGRyZW4sIGFyZ3M6IFtCdXR0b24sXSB9XVxufTtcblxuLyoqXG4gKiBAaGlkZGVuXG4gKi9cbmNsYXNzIE1lc3NhZ2VzJDEgZXh0ZW5kcyBDb21wb25lbnRNZXNzYWdlcyB7XG59XG5NZXNzYWdlcyQxLnByb3BEZWNvcmF0b3JzID0ge1xuICAgIHJlcGVhdDogW3sgdHlwZTogSW5wdXQgfV0sXG4gICAgZGFpbHlJbnRlcnZhbDogW3sgdHlwZTogSW5wdXQgfV0sXG4gICAgZGFpbHlSZXBlYXRFdmVyeTogW3sgdHlwZTogSW5wdXQgfV0sXG4gICAgd2Vla2x5SW50ZXJ2YWw6IFt7IHR5cGU6IElucHV0IH1dLFxuICAgIHdlZWtseVJlcGVhdEV2ZXJ5OiBbeyB0eXBlOiBJbnB1dCB9XSxcbiAgICB3ZWVrbHlSZXBlYXRPbjogW3sgdHlwZTogSW5wdXQgfV0sXG4gICAgbW9udGhseURheTogW3sgdHlwZTogSW5wdXQgfV0sXG4gICAgbW9udGhseUludGVydmFsOiBbeyB0eXBlOiBJbnB1dCB9XSxcbiAgICBtb250aGx5UmVwZWF0RXZlcnk6IFt7IHR5cGU6IElucHV0IH1dLFxuICAgIG1vbnRobHlSZXBlYXRPbjogW3sgdHlwZTogSW5wdXQgfV0sXG4gICAgeWVhcmx5T2Y6IFt7IHR5cGU6IElucHV0IH1dLFxuICAgIHllYXJseVJlcGVhdEV2ZXJ5OiBbeyB0eXBlOiBJbnB1dCB9XSxcbiAgICB5ZWFybHlSZXBlYXRPbjogW3sgdHlwZTogSW5wdXQgfV0sXG4gICAgeWVhcmx5SW50ZXJ2YWw6IFt7IHR5cGU6IElucHV0IH1dLFxuICAgIGZyZXF1ZW5jaWVzRGFpbHk6IFt7IHR5cGU6IElucHV0IH1dLFxuICAgIGZyZXF1ZW5jaWVzTW9udGhseTogW3sgdHlwZTogSW5wdXQgfV0sXG4gICAgZnJlcXVlbmNpZXNOZXZlcjogW3sgdHlwZTogSW5wdXQgfV0sXG4gICAgZnJlcXVlbmNpZXNXZWVrbHk6IFt7IHR5cGU6IElucHV0IH1dLFxuICAgIGZyZXF1ZW5jaWVzWWVhcmx5OiBbeyB0eXBlOiBJbnB1dCB9XSxcbiAgICBvZmZzZXRQb3NpdGlvbnNGaXJzdDogW3sgdHlwZTogSW5wdXQgfV0sXG4gICAgb2Zmc2V0UG9zaXRpb25zU2Vjb25kOiBbeyB0eXBlOiBJbnB1dCB9XSxcbiAgICBvZmZzZXRQb3NpdGlvbnNUaGlyZDogW3sgdHlwZTogSW5wdXQgfV0sXG4gICAgb2Zmc2V0UG9zaXRpb25zRm91cnRoOiBbeyB0eXBlOiBJbnB1dCB9XSxcbiAgICBvZmZzZXRQb3NpdGlvbnNMYXN0OiBbeyB0eXBlOiBJbnB1dCB9XSxcbiAgICB3ZWVrZGF5c0RheTogW3sgdHlwZTogSW5wdXQgfV0sXG4gICAgd2Vla2RheXNXZWVrZGF5OiBbeyB0eXBlOiBJbnB1dCB9XSxcbiAgICB3ZWVrZGF5c1dlZWtlbmRkYXk6IFt7IHR5cGU6IElucHV0IH1dLFxuICAgIGVuZEFmdGVyOiBbeyB0eXBlOiBJbnB1dCB9XSxcbiAgICBlbmRPY2N1cnJlbmNlOiBbeyB0eXBlOiBJbnB1dCB9XSxcbiAgICBlbmRMYWJlbDogW3sgdHlwZTogSW5wdXQgfV0sXG4gICAgZW5kTmV2ZXI6IFt7IHR5cGU6IElucHV0IH1dLFxuICAgIGVuZE9uOiBbeyB0eXBlOiBJbnB1dCB9XVxufTtcblxuLyoqXG4gKiBAaGlkZGVuXG4gKiBDdXN0b20gY29tcG9uZW50IG1lc3NhZ2VzIG92ZXJyaWRlIGRlZmF1bHQgY29tcG9uZW50IG1lc3NhZ2VzLlxuICovXG5jbGFzcyBSZWN1cnJlbmNlRWRpdG9yQ3VzdG9tTWVzc2FnZXNDb21wb25lbnQgZXh0ZW5kcyBNZXNzYWdlcyQxIHtcbiAgICBjb25zdHJ1Y3RvcihzZXJ2aWNlKSB7XG4gICAgICAgIHN1cGVyKCk7XG4gICAgICAgIHRoaXMuc2VydmljZSA9IHNlcnZpY2U7XG4gICAgfVxuICAgIGdldCBvdmVycmlkZSgpIHtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxufVxuUmVjdXJyZW5jZUVkaXRvckN1c3RvbU1lc3NhZ2VzQ29tcG9uZW50LmRlY29yYXRvcnMgPSBbXG4gICAgeyB0eXBlOiBDb21wb25lbnQsIGFyZ3M6IFt7XG4gICAgICAgICAgICAgICAgcHJvdmlkZXJzOiBbXG4gICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHByb3ZpZGU6IE1lc3NhZ2VzJDEsXG4gICAgICAgICAgICAgICAgICAgICAgICB1c2VFeGlzdGluZzogZm9yd2FyZFJlZigoKSA9PiBSZWN1cnJlbmNlRWRpdG9yQ3VzdG9tTWVzc2FnZXNDb21wb25lbnQpIC8vIHRzbGludDpkaXNhYmxlLWxpbmU6bm8tZm9yd2FyZC1yZWZcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIF0sXG4gICAgICAgICAgICAgICAgc2VsZWN0b3I6ICdrZW5kby1yZWN1cnJlbmNlLWVkaXRvci1tZXNzYWdlcycsXG4gICAgICAgICAgICAgICAgdGVtcGxhdGU6IGBgXG4gICAgICAgICAgICB9LF0gfSxcbl07XG4vKiogQG5vY29sbGFwc2UgKi9cblJlY3VycmVuY2VFZGl0b3JDdXN0b21NZXNzYWdlc0NvbXBvbmVudC5jdG9yUGFyYW1ldGVycyA9ICgpID0+IFtcbiAgICB7IHR5cGU6IExvY2FsaXphdGlvblNlcnZpY2UgfVxuXTtcblxuLyoqXG4gKiBAaGlkZGVuXG4gKi9cbmNsYXNzIFJlY3VycmVuY2VFZGl0b3JMb2NhbGl6ZWRNZXNzYWdlc0RpcmVjdGl2ZSBleHRlbmRzIE1lc3NhZ2VzJDEge1xuICAgIGNvbnN0cnVjdG9yKHNlcnZpY2UpIHtcbiAgICAgICAgc3VwZXIoKTtcbiAgICAgICAgdGhpcy5zZXJ2aWNlID0gc2VydmljZTtcbiAgICB9XG59XG5SZWN1cnJlbmNlRWRpdG9yTG9jYWxpemVkTWVzc2FnZXNEaXJlY3RpdmUuZGVjb3JhdG9ycyA9IFtcbiAgICB7IHR5cGU6IERpcmVjdGl2ZSwgYXJnczogW3tcbiAgICAgICAgICAgICAgICBwcm92aWRlcnM6IFtcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgcHJvdmlkZTogTWVzc2FnZXMkMSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHVzZUV4aXN0aW5nOiBmb3J3YXJkUmVmKCgpID0+IFJlY3VycmVuY2VFZGl0b3JMb2NhbGl6ZWRNZXNzYWdlc0RpcmVjdGl2ZSkgLy8gdHNsaW50OmRpc2FibGUtbGluZTpuby1mb3J3YXJkLXJlZlxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgXSxcbiAgICAgICAgICAgICAgICBzZWxlY3RvcjogJ1trZW5kb1JlY3VycmVuY2VFZGl0b3JMb2NhbGl6ZWRNZXNzYWdlc10nXG4gICAgICAgICAgICB9LF0gfSxcbl07XG4vKiogQG5vY29sbGFwc2UgKi9cblJlY3VycmVuY2VFZGl0b3JMb2NhbGl6ZWRNZXNzYWdlc0RpcmVjdGl2ZS5jdG9yUGFyYW1ldGVycyA9ICgpID0+IFtcbiAgICB7IHR5cGU6IExvY2FsaXphdGlvblNlcnZpY2UgfVxuXTtcblxuLyogdHNsaW50OmRpc2FibGU6IG5vLXVzZS1iZWZvcmUtZGVjbGFyZSAqL1xuLyogdHNsaW50OmRpc2FibGU6IG5vLWZvcndhcmQtcmVmICovXG4vKipcbiAqIEBoaWRkZW5cbiAqL1xuY29uc3QgVElNRV9aT05FX1ZBTFVFX0FDQ0VTU09SID0ge1xuICAgIG11bHRpOiB0cnVlLFxuICAgIHByb3ZpZGU6IE5HX1ZBTFVFX0FDQ0VTU09SLFxuICAgIHVzZUV4aXN0aW5nOiBmb3J3YXJkUmVmKCgpID0+IFRpbWVab25lRWRpdG9yQ29tcG9uZW50KVxufTtcbi8qKlxuICogUmVwcmVzZW50cyB0aGUgS2VuZG8gVUkgVGltZVpvbmUgRWRpdG9yIGNvbXBvbmVudCBmb3IgQW5ndWxhci5cbiAqIGBUaW1lWm9uZUVkaXRvckNvbXBvbmVudGAgZGlzcGxheXMgdGhlIGN1cnJlbnRseSBsb2FkZWQgdGltZXpvbmVzLlxuICogVXNlZCBmb3IgZWRpdGluZyB0aGUgYHN0YXJ0YCBhbmQgYGVuZGAgdGltZXpvbmVzIG9mIHRoZSBgU2NoZWR1bGVyRXZlbnRgIG9iamVjdHMuXG4gKi9cbmNsYXNzIFRpbWVab25lRWRpdG9yQ29tcG9uZW50IHtcbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIFNwZWNpZmllcyB0aGUgd2lkdGggb2YgdGhlIENvbWJvQm94IHdoaWNoIGNvbnRhaW5zIHRoZSBuYW1lcyBvZiB0aGUgdGltZXpvbmVzLlxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy53aWR0aCA9IDI2MDtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEZpcmVzIHdoZW4gdGhlIHZhbHVlIG9mIHRoZSBjb21wb25lbnQgaGFzIGNoYW5nZWQuXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLnZhbHVlQ2hhbmdlID0gbmV3IEV2ZW50RW1pdHRlcigpO1xuICAgICAgICB0aGlzLm9uVG91Y2hlZENhbGxiYWNrID0gKF8pID0+IHsgfTtcbiAgICAgICAgdGhpcy5vbkNoYW5nZUNhbGxiYWNrID0gKF8pID0+IHsgfTtcbiAgICAgICAgdGhpcy50ek5hbWVzID0gdGltZXpvbmVOYW1lcygpO1xuICAgICAgICB0aGlzLnR6U291cmNlID0gdGhpcy50ek5hbWVzLnNsaWNlKCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEBoaWRkZW5cbiAgICAgKi9cbiAgICBvblRpbWVab25lQ2hhbmdlKHR6TmFtZSkge1xuICAgICAgICB0aGlzLnR6ID0gdHpOYW1lO1xuICAgICAgICB0aGlzLm9uQ2hhbmdlQ2FsbGJhY2sodGhpcy50eik7XG4gICAgICAgIHRoaXMudmFsdWVDaGFuZ2UuZW1pdCh0ek5hbWUpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBAaGlkZGVuXG4gICAgICovXG4gICAgb25UaW1lWm9uZUZpbHRlckNoYW5nZSh2YWx1ZSkge1xuICAgICAgICB0aGlzLnR6U291cmNlID0gdGhpcy50ek5hbWVzLmZpbHRlcigodHopID0+IHR6LnRvTG93ZXJDYXNlKCkuaW5kZXhPZih2YWx1ZS50b0xvd2VyQ2FzZSgpKSAhPT0gLTEpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBAaGlkZGVuXG4gICAgICovXG4gICAgd3JpdGVWYWx1ZSh2YWx1ZSkge1xuICAgICAgICBpZiAodHlwZW9mIHZhbHVlID09PSAnc3RyaW5nJyAmJiB0aGlzLnR6TmFtZXMuaW5kZXhPZih2YWx1ZSkgPj0gMCkge1xuICAgICAgICAgICAgdGhpcy50eiA9IHZhbHVlO1xuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEBoaWRkZW5cbiAgICAgKi9cbiAgICBmb2N1cygpIHtcbiAgICAgICAgdGhpcy50ekNvbWJvQm94LmZvY3VzKCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEBoaWRkZW5cbiAgICAgKi9cbiAgICByZWdpc3Rlck9uQ2hhbmdlKGZuKSB7XG4gICAgICAgIHRoaXMub25DaGFuZ2VDYWxsYmFjayA9IGZuO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBAaGlkZGVuXG4gICAgICovXG4gICAgcmVnaXN0ZXJPblRvdWNoZWQoZm4pIHtcbiAgICAgICAgdGhpcy5vblRvdWNoZWRDYWxsYmFjayA9IGZuO1xuICAgIH1cbn1cblRpbWVab25lRWRpdG9yQ29tcG9uZW50LmRlY29yYXRvcnMgPSBbXG4gICAgeyB0eXBlOiBDb21wb25lbnQsIGFyZ3M6IFt7XG4gICAgICAgICAgICAgICAgcHJvdmlkZXJzOiBbXG4gICAgICAgICAgICAgICAgICAgIFRJTUVfWk9ORV9WQUxVRV9BQ0NFU1NPUlxuICAgICAgICAgICAgICAgIF0sXG4gICAgICAgICAgICAgICAgc2VsZWN0b3I6ICdrZW5kby10aW1lem9uZS1lZGl0b3InLFxuICAgICAgICAgICAgICAgIHRlbXBsYXRlOiBgXG4gICAgICAgIDxrZW5kby1jb21ib2JveFxuICAgICAgICAgICAgI3R6Y29tYm9ib3hcbiAgICAgICAgICAgIFtzdHlsZS53aWR0aC5weF09XCJ3aWR0aFwiXG4gICAgICAgICAgICBbYWxsb3dDdXN0b21dPVwiZmFsc2VcIlxuICAgICAgICAgICAgW2RhdGFdPVwidHpTb3VyY2VcIlxuICAgICAgICAgICAgW2ZpbHRlcmFibGVdPVwidHJ1ZVwiXG4gICAgICAgICAgICBbc3VnZ2VzdF09XCJ0cnVlXCJcbiAgICAgICAgICAgIFt2YWx1ZV09XCJ0elwiXG4gICAgICAgICAgICAoZmlsdGVyQ2hhbmdlKT1cIm9uVGltZVpvbmVGaWx0ZXJDaGFuZ2UoJGV2ZW50KVwiXG4gICAgICAgICAgICAodmFsdWVDaGFuZ2UpPVwib25UaW1lWm9uZUNoYW5nZSgkZXZlbnQpXCI+XG4gICAgICAgIDwva2VuZG8tY29tYm9ib3g+XG4gICAgYFxuICAgICAgICAgICAgfSxdIH0sXG5dO1xuLyoqIEBub2NvbGxhcHNlICovXG5UaW1lWm9uZUVkaXRvckNvbXBvbmVudC5jdG9yUGFyYW1ldGVycyA9ICgpID0+IFtdO1xuVGltZVpvbmVFZGl0b3JDb21wb25lbnQucHJvcERlY29yYXRvcnMgPSB7XG4gICAgdHpDb21ib0JveDogW3sgdHlwZTogVmlld0NoaWxkLCBhcmdzOiBbJ3R6Y29tYm9ib3gnLF0gfV0sXG4gICAgd2lkdGg6IFt7IHR5cGU6IElucHV0IH1dLFxuICAgIHZhbHVlQ2hhbmdlOiBbeyB0eXBlOiBPdXRwdXQgfV1cbn07XG5cbmNvbnN0IGlzQ29udGVudFdyYXBwZXIgPSBlbGVtZW50ID0+IGhhc0NsYXNzZXMoZWxlbWVudCwgJ2stc2NoZWR1bGVyLWNvbnRlbnQnKTtcbi8qKlxuICogQGhpZGRlblxuICovXG5jbGFzcyBTaG9ydGN1dHNEaXJlY3RpdmUge1xuICAgIGNvbnN0cnVjdG9yKHNjaGVkdWxlciwgZG9tRXZlbnRzLCBmb2N1c1NlcnZpY2UsIHpvbmUsIGNoYW5nZURldGVjdG9yLCB2aWV3U3RhdGUsIGRpYWxvZ3NTZXJ2aWNlKSB7XG4gICAgICAgIHRoaXMuc2NoZWR1bGVyID0gc2NoZWR1bGVyO1xuICAgICAgICB0aGlzLmRvbUV2ZW50cyA9IGRvbUV2ZW50cztcbiAgICAgICAgdGhpcy5mb2N1c1NlcnZpY2UgPSBmb2N1c1NlcnZpY2U7XG4gICAgICAgIHRoaXMuem9uZSA9IHpvbmU7XG4gICAgICAgIHRoaXMuY2hhbmdlRGV0ZWN0b3IgPSBjaGFuZ2VEZXRlY3RvcjtcbiAgICAgICAgdGhpcy52aWV3U3RhdGUgPSB2aWV3U3RhdGU7XG4gICAgICAgIHRoaXMuZGlhbG9nc1NlcnZpY2UgPSBkaWFsb2dzU2VydmljZTtcbiAgICAgICAgdGhpcy5zaG9ydGN1dHMgPSBbe1xuICAgICAgICAgICAgICAgIG1hdGNoOiBlID0+IGUua2V5Q29kZSA9PT0gS2V5cy5LZXlDICYmIG5vTW9kaWZpZXJzKGUpLFxuICAgICAgICAgICAgICAgIGFjdGlvbjogZSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHNjaGVkdWxlciA9IHRoaXMuc2NoZWR1bGVyO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBob3VycyA9IG5ldyBEYXRlKCkuZ2V0SG91cnMoKTtcbiAgICAgICAgICAgICAgICAgICAgY29uc3Qgc2VsZWN0ZWQgPSBzY2hlZHVsZXIuc2VsZWN0ZWREYXRlO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBzdGFydCA9IG5ldyBEYXRlKHNlbGVjdGVkLmdldEZ1bGxZZWFyKCksIHNlbGVjdGVkLmdldE1vbnRoKCksIHNlbGVjdGVkLmdldERhdGUoKSwgaG91cnMgKyAxKTtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZW5kID0gbmV3IERhdGUoc2VsZWN0ZWQuZ2V0RnVsbFllYXIoKSwgc2VsZWN0ZWQuZ2V0TW9udGgoKSwgc2VsZWN0ZWQuZ2V0RGF0ZSgpLCBob3VycyArIDIpO1xuICAgICAgICAgICAgICAgICAgICBsZXQgZmlyc3RSZXNvdXJjZTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHNjaGVkdWxlci5ncm91cCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgcmVzb3VyY2VzID0gc2NoZWR1bGVyLnJlc291cmNlcyB8fCBbXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGdyb3VwID0gc2NoZWR1bGVyLmdyb3VwIHx8IHt9O1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZ3JvdXBlZCA9IGdyb3VwUmVzb3VyY2VzKGdyb3VwLCByZXNvdXJjZXMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGdyb3VwZWQubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpcnN0UmVzb3VyY2UgPSBncm91cGVkWzBdLmRhdGFbMF07XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgc2NoZWR1bGVyLmNyZWF0ZS5lbWl0KHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0YXJ0OiBab25lZERhdGUuZnJvbUxvY2FsRGF0ZShzdGFydCwgc2NoZWR1bGVyLnRpbWV6b25lKS50b0xvY2FsRGF0ZSgpLFxuICAgICAgICAgICAgICAgICAgICAgICAgZW5kOiBab25lZERhdGUuZnJvbUxvY2FsRGF0ZShlbmQsIHNjaGVkdWxlci50aW1lem9uZSkudG9Mb2NhbERhdGUoKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGlzQWxsRGF5OiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc291cmNlczogW2ZpcnN0UmVzb3VyY2VdLFxuICAgICAgICAgICAgICAgICAgICAgICAgb3JpZ2luYWxFdmVudDogZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbmRlcjogc2NoZWR1bGVyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAgICBtYXRjaDogZSA9PiBlLmtleUNvZGUgPj0gS2V5cy5EaWdpdDEgJiYgZS5rZXlDb2RlIDw9IEtleXMuRGlnaXQ5ICYmIHdpdGhNb2RpZmllcnMoZSwgTW9kaWZpZXJzLkFsdEtleSksXG4gICAgICAgICAgICAgICAgYWN0aW9uOiBlID0+IHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3Qgc2NoZWR1bGVyID0gdGhpcy5zY2hlZHVsZXI7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHZpZXdJbmRleCA9IGUua2V5Q29kZSAtIEtleXMuRGlnaXQwIC0gMTtcbiAgICAgICAgICAgICAgICAgICAgY29uc3Qgdmlld3MgPSBzY2hlZHVsZXIudmlld3MudG9BcnJheSgpO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCB2aWV3ID0gdmlld3Nbdmlld0luZGV4XTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHZpZXcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuem9uZS5ydW4oKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHByZXZlbnRlZCA9IHNjaGVkdWxlci5vbk5hdmlnYXRpb25BY3Rpb24oeyB0eXBlOiAndmlldy1jaGFuZ2UnLCB2aWV3IH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghcHJldmVudGVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY2hhbmdlRGV0ZWN0b3IubWFya0ZvckNoZWNrKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZm9jdXNXYWl0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgICAgbWF0Y2g6IGUgPT4gZS5rZXlDb2RlID09PSBLZXlzLktleVQgJiYgbm9Nb2RpZmllcnMoZSksXG4gICAgICAgICAgICAgICAgYWN0aW9uOiAoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuem9uZS5ydW4oKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zY2hlZHVsZXIub25OYXZpZ2F0aW9uQWN0aW9uKHsgdHlwZTogJ3RvZGF5JyB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZm9jdXNXYWl0KCk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAgICAvLyB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmU6ZGVwcmVjYXRpb25cbiAgICAgICAgICAgICAgICBtYXRjaDogKGUpID0+IChlLmtleUNvZGUgPT09IEtleXMuQXJyb3dMZWZ0IHx8IGUua2V5Q29kZSA9PT0gS2V5cy5BcnJvd1JpZ2h0KSAmJiB3aXRoTW9kaWZpZXJzKGUsIE1vZGlmaWVycy5TaGlmdEtleSksXG4gICAgICAgICAgICAgICAgYWN0aW9uOiAoZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAvLyB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmU6ZGVwcmVjYXRpb25cbiAgICAgICAgICAgICAgICAgICAgY29uc3QgdHlwZSA9IGUua2V5Q29kZSA9PT0gS2V5cy5BcnJvd0xlZnQgPyAncHJldicgOiAnbmV4dCc7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuem9uZS5ydW4oKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zY2hlZHVsZXIub25OYXZpZ2F0aW9uQWN0aW9uKHsgdHlwZSB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZm9jdXNXYWl0KCk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAgICAvLyB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmU6ZGVwcmVjYXRpb25cbiAgICAgICAgICAgICAgICBtYXRjaDogZSA9PiAoZS5rZXlDb2RlID09PSBLZXlzLkFycm93VXAgfHwgZS5rZXlDb2RlID09PSBLZXlzLkFycm93TGVmdCkgJiYgbm9Nb2RpZmllcnMoZSkgJiYgIWlzQ29udGVudFdyYXBwZXIoZS50YXJnZXQpLFxuICAgICAgICAgICAgICAgIGFjdGlvbjogZSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHByZXZlbnRlZCA9IHRoaXMuc2NoZWR1bGVyLm9uTmF2aWdhdGlvbkFjdGlvbih7IHR5cGU6ICdmb2N1cy1wcmV2JyB9KTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFwcmV2ZW50ZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZm9jdXNTZXJ2aWNlLmZvY3VzTmV4dCh7IG9mZnNldDogLTEgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgICAgLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOmRlcHJlY2F0aW9uXG4gICAgICAgICAgICAgICAgbWF0Y2g6IGUgPT4gKGUua2V5Q29kZSA9PT0gS2V5cy5BcnJvd0Rvd24gfHwgZS5rZXlDb2RlID09PSBLZXlzLkFycm93UmlnaHQpICYmIG5vTW9kaWZpZXJzKGUpICYmICFpc0NvbnRlbnRXcmFwcGVyKGUudGFyZ2V0KSxcbiAgICAgICAgICAgICAgICBhY3Rpb246IGUgPT4ge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBwcmV2ZW50ZWQgPSB0aGlzLnNjaGVkdWxlci5vbk5hdmlnYXRpb25BY3Rpb24oeyB0eXBlOiAnZm9jdXMtbmV4dCcgfSk7XG4gICAgICAgICAgICAgICAgICAgIGlmICghcHJldmVudGVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmZvY3VzU2VydmljZS5mb2N1c05leHQoeyBvZmZzZXQ6IDEgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XTtcbiAgICAgICAgdGhpcy50YXNrU2hvcnRjdXRzID0gW3tcbiAgICAgICAgICAgICAgICBtYXRjaDogZSA9PiAoZS5rZXlDb2RlID09PSBLZXlzLkRlbGV0ZSB8fCBlLmtleUNvZGUgPT09IEtleXMuQmFja3NwYWNlKSAmJiBub01vZGlmaWVycyhlKSxcbiAgICAgICAgICAgICAgICBhY3Rpb246IChlLCBldmVudCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnZpZXdTdGF0ZS5lbWl0RXZlbnQoJ3JlbW92ZScsIHsgZXZlbnQ6IGV2ZW50LCBkYXRhSXRlbTogZXZlbnQuZGF0YUl0ZW0gfSk7XG4gICAgICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgICAgbWF0Y2g6IGUgPT4gZS5rZXlDb2RlID09PSBLZXlzLkVudGVyICYmIG5vTW9kaWZpZXJzKGUpLFxuICAgICAgICAgICAgICAgIGFjdGlvbjogKGUsIGV2ZW50KSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMudmlld1N0YXRlLmVtaXRFdmVudCgnZXZlbnREYmxDbGljaycsIHsgdHlwZTogJ2RibGNsaWNrJywgZXZlbnQ6IGV2ZW50LCBvcmlnaW5hbEV2ZW50OiBlIH0pO1xuICAgICAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfV07XG4gICAgICAgIHRoaXMuc3VicyA9IG5ldyBTdWJzY3JpcHRpb24oKTtcbiAgICAgICAgdGhpcy5zdWJzLmFkZCh0aGlzLmRvbUV2ZW50cy5rZXlkb3duLnN1YnNjcmliZShlID0+IHRoaXMub25LZXlkb3duKGUpKSk7XG4gICAgICAgIHRoaXMuc3Vicy5hZGQodGhpcy5zY2hlZHVsZXIuZXZlbnRLZXlkb3duLnN1YnNjcmliZShlID0+IHRoaXMub25FdmVudEtleWRvd24oZSkpKTtcbiAgICB9XG4gICAgb25LZXlkb3duKGUpIHtcbiAgICAgICAgY29uc3QgbWF0Y2ggPSB0aGlzLnNob3J0Y3V0cy5maW5kKHNob3J0Y3V0ID0+IHNob3J0Y3V0Lm1hdGNoKGUpKTtcbiAgICAgICAgaWYgKG1hdGNoICYmICF0aGlzLmRpYWxvZ3NTZXJ2aWNlLmlzT3Blbikge1xuICAgICAgICAgICAgbWF0Y2guYWN0aW9uKGUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIG9uRXZlbnRLZXlkb3duKGUpIHtcbiAgICAgICAgY29uc3QgbWF0Y2ggPSB0aGlzLnRhc2tTaG9ydGN1dHMuZmluZChzaG9ydGN1dCA9PiBzaG9ydGN1dC5tYXRjaChlLm9yaWdpbmFsRXZlbnQpKTtcbiAgICAgICAgaWYgKG1hdGNoICYmICF0aGlzLmRpYWxvZ3NTZXJ2aWNlLmlzT3Blbikge1xuICAgICAgICAgICAgbWF0Y2guYWN0aW9uKGUub3JpZ2luYWxFdmVudCwgZS5ldmVudCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZm9jdXNXYWl0KCkge1xuICAgICAgICB0aGlzLnZpZXdTdGF0ZS5sYXlvdXRFbmQucGlwZSh0YWtlKDEpKS5zdWJzY3JpYmUoKCkgPT4gdGhpcy5mb2N1c1NlcnZpY2UuZm9jdXMoKSk7XG4gICAgfVxufVxuU2hvcnRjdXRzRGlyZWN0aXZlLmRlY29yYXRvcnMgPSBbXG4gICAgeyB0eXBlOiBEaXJlY3RpdmUsIGFyZ3M6IFt7XG4gICAgICAgICAgICAgICAgLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOmRpcmVjdGl2ZS1zZWxlY3RvclxuICAgICAgICAgICAgICAgIHNlbGVjdG9yOiAna2VuZG8tc2NoZWR1bGVyJ1xuICAgICAgICAgICAgfSxdIH0sXG5dO1xuLyoqIEBub2NvbGxhcHNlICovXG5TaG9ydGN1dHNEaXJlY3RpdmUuY3RvclBhcmFtZXRlcnMgPSAoKSA9PiBbXG4gICAgeyB0eXBlOiBTY2hlZHVsZXJDb21wb25lbnQgfSxcbiAgICB7IHR5cGU6IERvbUV2ZW50c1NlcnZpY2UgfSxcbiAgICB7IHR5cGU6IEZvY3VzU2VydmljZSB9LFxuICAgIHsgdHlwZTogTmdab25lIH0sXG4gICAgeyB0eXBlOiBDaGFuZ2VEZXRlY3RvclJlZiB9LFxuICAgIHsgdHlwZTogVmlld1N0YXRlU2VydmljZSB9LFxuICAgIHsgdHlwZTogRGlhbG9nc1NlcnZpY2UgfVxuXTtcblxuY29uc3QgVEVNUExBVEVTID0gW1xuICAgIEFnZW5kYURhdGVUZW1wbGF0ZURpcmVjdGl2ZSxcbiAgICBBZ2VuZGFUaW1lVGVtcGxhdGVEaXJlY3RpdmUsXG4gICAgQWxsRGF5RXZlbnRUZW1wbGF0ZURpcmVjdGl2ZSxcbiAgICBBbGxEYXlTbG90VGVtcGxhdGVEaXJlY3RpdmUsXG4gICAgRGF0ZUhlYWRlclRlbXBsYXRlRGlyZWN0aXZlLFxuICAgIEV2ZW50VGVtcGxhdGVEaXJlY3RpdmUsXG4gICAgRWRpdERpYWxvZ1RlbXBsYXRlRGlyZWN0aXZlLFxuICAgIEdyb3VwSGVhZGVyVGVtcGxhdGVEaXJlY3RpdmUsXG4gICAgTWFqb3JUaW1lSGVhZGVyVGVtcGxhdGVEaXJlY3RpdmUsXG4gICAgTWlub3JUaW1lSGVhZGVyVGVtcGxhdGVEaXJlY3RpdmUsXG4gICAgTW9udGhEYXlTbG90VGVtcGxhdGVEaXJlY3RpdmUsXG4gICAgVGltZVNsb3RUZW1wbGF0ZURpcmVjdGl2ZVxuXTtcbmNvbnN0IGRlY2xhcmF0aW9ucyA9IFtcbiAgICBTY2hlZHVsZXJDb21wb25lbnQsXG4gICAgU2NoZWR1bGVyVmlld0RpcmVjdGl2ZSxcbiAgICBEYXRhQmluZGluZ0RpcmVjdGl2ZSxcbiAgICBTaG9ydGN1dHNEaXJlY3RpdmUsXG4gICAgUmVhY3RpdmVFZGl0aW5nRGlyZWN0aXZlLFxuICAgIFNjaGVkdWxlckRhdGVUaW1lUGlja2VyQ29tcG9uZW50LFxuICAgIFJlY3VycmVuY2VFZGl0b3JDb21wb25lbnQsXG4gICAgUmVjdXJyZW5jZUVuZFJ1bGVFZGl0b3JDb21wb25lbnQsXG4gICAgUmVjdXJyZW5jZUZyZXF1ZW5jeUVkaXRvckNvbXBvbmVudCxcbiAgICBSZWN1cnJlbmNlSW50ZXJ2YWxFZGl0b3JDb21wb25lbnQsXG4gICAgUmVjdXJyZW5jZU1vbnRobHlZZWFybHlFZGl0b3JDb21wb25lbnQsXG4gICAgUmVjdXJyZW5jZVdlZWtkYXlSdWxlRWRpdG9yQ29tcG9uZW50LFxuICAgIEVuZFJ1bGVSYWRpb0J1dHRvbkRpcmVjdGl2ZSxcbiAgICBSZXBlYXRPblJhZGlvQnV0dG9uRGlyZWN0aXZlLFxuICAgIE11bHRpcGxlUmVzb3VyY2VFZGl0b3JDb21wb25lbnQsXG4gICAgU2luZ2xlUmVzb3VyY2VFZGl0b3JDb21wb25lbnQsXG4gICAgVGltZVpvbmVFZGl0b3JDb21wb25lbnQsXG4gICAgRWRpdERpYWxvZ0NvbXBvbmVudCxcbiAgICBTY2hlZHVsZXJDdXN0b21NZXNzYWdlc0NvbXBvbmVudCxcbiAgICBMb2NhbGl6ZWRNZXNzYWdlc0RpcmVjdGl2ZSxcbiAgICBSZWN1cnJlbmNlRWRpdG9yQ3VzdG9tTWVzc2FnZXNDb21wb25lbnQsXG4gICAgUmVjdXJyZW5jZUVkaXRvckxvY2FsaXplZE1lc3NhZ2VzRGlyZWN0aXZlLFxuICAgIExvYWRpbmdDb21wb25lbnQsXG4gICAgLi4uVEVNUExBVEVTXG5dO1xuY29uc3QgcHVibGljRGlyZWN0aXZlcyQxID0gW1xuICAgIEFnZW5kYVZpZXdDb21wb25lbnQsXG4gICAgTW9udGhWaWV3TW9kdWxlLFxuICAgIE11bHRpRGF5Vmlld01vZHVsZSxcbiAgICBSZWFjdGl2ZUVkaXRpbmdEaXJlY3RpdmUsXG4gICAgVGltZWxpbmVWaWV3TW9kdWxlLFxuICAgIHB1YmxpY0RpcmVjdGl2ZXMsXG4gICAgLi4uZGVjbGFyYXRpb25zXG5dO1xuY29uc3QgaW1wb3J0ZWRLZW5kb01vZHVsZXMgPSBbXG4gICAgQnV0dG9uc01vZHVsZSxcbiAgICBEYXRlSW5wdXRzTW9kdWxlLFxuICAgIERpYWxvZ01vZHVsZSxcbiAgICBOdW1lcmljVGV4dEJveE1vZHVsZSxcbiAgICBUZXh0Qm94TW9kdWxlLFxuICAgIERyb3BEb3duc01vZHVsZSxcbiAgICBSZWFjdGl2ZUZvcm1zTW9kdWxlLFxuICAgIFNoYXJlZE1vZHVsZVxuXTtcbi8qKlxuICogUmVwcmVzZW50cyB0aGUgW05nTW9kdWxlXSh7eyBzaXRlLmRhdGEudXJscy5hbmd1bGFyWyduZ21vZHVsZWFwaSddIH19KVxuICogZGVmaW5pdGlvbiBmb3IgdGhlIFNjaGVkdWxlciBjb21wb25lbnQuXG4gKlxuICogQGV4YW1wbGVcbiAqIGBgYHRzLW5vLXJ1blxuICogaW1wb3J0IHsgQnJvd3Nlck1vZHVsZSB9IGZyb20gJ0Bhbmd1bGFyL3BsYXRmb3JtLWJyb3dzZXInO1xuICogaW1wb3J0IHsgTmdNb2R1bGUgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcbiAqXG4gKiAvLyBJbXBvcnQgdGhlIFNjaGVkdWxlciBtb2R1bGVcbiAqIGltcG9ydCB7IFNjaGVkdWxlck1vZHVsZSB9IGZyb20gJ0Bwcm9ncmVzcy9rZW5kby1hbmd1bGFyLXNjaGVkdWxlcic7XG4gKlxuICogaW1wb3J0IHsgQXBwQ29tcG9uZW50IH0gZnJvbSAnLi9hcHAuY29tcG9uZW50JztcbiAqXG4gKiBfQE5nTW9kdWxlKHtcbiAqICAgICBkZWNsYXJhdGlvbnM6IFtcbiAqICAgICAgICAgQXBwQ29tcG9uZW50XG4gKiAgICAgXSxcbiAqICAgICBpbXBvcnRzOiBbXG4gKiAgICAgICAgIEJyb3dzZXJNb2R1bGUsXG4gKlxuICogICAgICAgICAvLyBJbXBvcnQgdGhlIFNjaGVkdWxlciBtb2R1bGVcbiAqICAgICAgICAgU2NoZWR1bGVyTW9kdWxlXG4gKiAgICAgXSxcbiAqICAgICBib290c3RyYXA6IFtcbiAqICAgICAgICAgQXBwQ29tcG9uZW50XG4gKiAgICAgXVxuICogfSlcbiAqIGV4cG9ydCBjbGFzcyBBcHBNb2R1bGUgeyB9XG4gKiBgYGBcbiAqL1xuY2xhc3MgU2NoZWR1bGVyTW9kdWxlIHtcbn1cblNjaGVkdWxlck1vZHVsZS5kZWNvcmF0b3JzID0gW1xuICAgIHsgdHlwZTogTmdNb2R1bGUsIGFyZ3M6IFt7XG4gICAgICAgICAgICAgICAgaW1wb3J0czogW1xuICAgICAgICAgICAgICAgICAgICBDb21tb25Nb2R1bGUsXG4gICAgICAgICAgICAgICAgICAgIFRvb2xiYXJNb2R1bGUsXG4gICAgICAgICAgICAgICAgICAgIEFnZW5kYVZpZXdNb2R1bGUsXG4gICAgICAgICAgICAgICAgICAgIE11bHRpRGF5Vmlld01vZHVsZSxcbiAgICAgICAgICAgICAgICAgICAgUmVzaXplU2Vuc29yTW9kdWxlLFxuICAgICAgICAgICAgICAgICAgICBNb250aFZpZXdNb2R1bGUsXG4gICAgICAgICAgICAgICAgICAgIFRpbWVsaW5lVmlld01vZHVsZSxcbiAgICAgICAgICAgICAgICAgICAgLi4uaW1wb3J0ZWRLZW5kb01vZHVsZXNcbiAgICAgICAgICAgICAgICBdLFxuICAgICAgICAgICAgICAgIGRlY2xhcmF0aW9uczogZGVjbGFyYXRpb25zLFxuICAgICAgICAgICAgICAgIGV4cG9ydHM6IHB1YmxpY0RpcmVjdGl2ZXMkMSxcbiAgICAgICAgICAgICAgICBwcm92aWRlcnM6IFt7XG4gICAgICAgICAgICAgICAgICAgICAgICBwcm92aWRlOiBJbnRsU2VydmljZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHVzZUNsYXNzOiBDbGRySW50bFNlcnZpY2VcbiAgICAgICAgICAgICAgICAgICAgfV1cbiAgICAgICAgICAgIH0sXSB9LFxuXTtcblxuY29uc3QgREFURV9GT1JNQVRTID0gW1xuICAgIFwieXl5eU1NZGRUSEhtbXNzU1NTWFhYXCIsXG4gICAgXCJ5eXl5TU1kZFRISG1tc3NYWFhcIixcbiAgICBcInl5eXlNTWRkVEhIbW1zc1wiLFxuICAgIFwieXl5eU1NZGRUSEhtbVwiLFxuICAgIFwieXl5eU1NZGRUSEhcIixcbiAgICBcInl5eXlNTWRkXCJcbl07XG4vKipcbiAqIEEgYmFzZSBpbXBsZW1lbnRhdGlvbiBvZiB0aGUgW2VkaXQgc2VydmljZV0oeyUgc2x1ZyBhcGlfc2NoZWR1bGVyX2VkaXRzZXJ2aWNlICV9KSB3aGljaCBwZXJzaXN0cyBkYXRhIHRvIHRyYWRpdGlvbmFsIENSVUQgc2VydmljZXMgc3VjaCBhcyBPRGF0YS5cbiAqXG4gKiBUbyBzdXBwb3J0IGN1c3RvbSBtb2RlbHMsIHRoZSBgQmFzZUVkaXRTZXJ2aWNlYCBjbGFzcyByZXF1aXJlcyBhIFtmaWVsZCBtYXBdKHslIHNsdWcgYXBpX3NjaGVkdWxlcl9zY2hlZHVsZXJtb2RlbGZpZWxkcyAlfSkgYXMgYSBjb25zdHJ1Y3RvciBwYXJhbWV0ZXIuIFN1YmNsYXNzZXMgcmVxdWlyZSB5b3UgdG9cbiAqIGltcGxlbWVudCB0aGUgYHJlYWRgIG9wZXJhdGlvbiwgd2hpY2ggaXMgbm90IGNhbGxlZCBkaXJlY3RseSBieSB0aGUgYmFzZSBjbGFzcywgYW5kIHRoZSBbYHNhdmVgXSh7JSBzbHVnIGFwaV9zY2hlZHVsZXJfYmFzZWVkaXRzZXJ2aWNlICV9I3RvYy1zYXZlKSBtZXRob2Qgd2hpY2ggcGVyc2lzdHMgdGhlIGNyZWF0ZWQsXG4gKiB1cGRhdGVkLCBhbmQgZGVsZXRlZCBlbnRpdGllcy5cbiAqXG4gKiBUaGUgW2BldmVudHNgXSgjdG9jLWV2ZW50cykgb2JzZXJ2YWJsZSB3aWxsIHB1Ymxpc2ggdGhlIGN1cnJlbnQgZGF0YSB3aGljaCBpcyBzZXQgdXBvbiBzdWJzY3JpcHRpb24gYnkgdXNpbmcsIGZvciBleGFtcGxlLCBhbiBbYXN5bmMgcGlwZV0oaHR0cHM6Ly9hbmd1bGFyLmlvL2FwaS9jb21tb24vQXN5bmNQaXBlKVxuICogKFttb3JlIGluZm9ybWF0aW9uXSh7JSBzbHVnIGVkaXRpbmdfZGlyZWN0aXZlc19zY2hlZHVsZXIgJX0jdG9jLWN1c3RvbS1zZXJ2aWNlKSkuXG4gKlxuICogSW1wbGVtZW50YXRpb25zIHdoaWNoIHV0aWxpemUgZGVkaWNhdGVkIHNlcnZpY2VzLCBzdWNoIGFzIEdvb2dsZSBDYWxlbmRhciBhbmQgTWljcm9zb2Z0IEV4Y2hhbmdlLCB3aWxsIHR5cGljYWxseSBpbXBsZW1lbnQgdGhlXG4gKiBbYEVkaXRTZXJ2aWNlYF0oeyUgc2x1ZyBhcGlfc2NoZWR1bGVyX2VkaXRzZXJ2aWNlICV9KSBvZiB0aGUgU2NoZWR1bGVyIGRpcmVjdGx5LlxuICpcbiAqIHslIG1ldGEgaGVpZ2h0OjcwMCAlfVxuICogeyUgZW1iZWRfZmlsZSBlZGl0aW5nL2VkaXRpbmctZGlyZWN0aXZlcy9yZWFjdGl2ZS1lZGl0aW5nLXNlcnZpY2UvYXBwLmNvbXBvbmVudC50cyBwcmV2aWV3ICV9XG4gKiB7JSBlbWJlZF9maWxlIGVkaXRpbmcvZWRpdGluZy1kaXJlY3RpdmVzL3JlYWN0aXZlLWVkaXRpbmctc2VydmljZS9hcHAubW9kdWxlLnRzICV9XG4gKiB7JSBlbWJlZF9maWxlIHNoYXJlZC9lZGl0LnNlcnZpY2UudHMgJX1cbiAqIHslIGVtYmVkX2ZpbGUgc2hhcmVkL215LWV2ZW50LmludGVyZmFjZS50cyAlfVxuICogeyUgZW1iZWRfZmlsZSBzaGFyZWQvbWFpbi50cyAlfVxuICogeyUgZW5kbWV0YSAlfVxuICovXG5jbGFzcyBCYXNlRWRpdFNlcnZpY2Uge1xuICAgIC8qKlxuICAgICAqIEluaXRpYWxpemVzIHRoZSBiYXNlIGVkaXQgc2VydmljZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBmaWVsZHMgLSBBIGZpZWxkIG1hcCB0aGF0IHdpbGwgYmUgdXNlZCBmb3IgcmVhZGluZyBhbmQgbW9kaWZ5aW5nIG1vZGVsIG9iamVjdHMuIERlZmF1bHRzIHRvIHRoZSBbYFNjaGVkdWxlckV2ZW50YF0oeyUgc2x1ZyBhcGlfc2NoZWR1bGVyX3NjaGVkdWxlcmV2ZW50ICV9KSBmaWVsZHMuXG4gICAgICovXG4gICAgY29uc3RydWN0b3IoZmllbGRzKSB7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBBbiBhcnJheSBvZiB0aGUgY3VycmVudGx5IGxvYWRlZCBldmVudHMgd2hpY2ggaXMgcG9wdWxhdGVkIGJ5IHRoZSBkZXJpdmVkIGNsYXNzLlxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5kYXRhID0gW107XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBUaGUgc291cmNlIHN1YmplY3QgZm9yIHRoZSBgZXZlbnRzYCBvYnNlcnZhYmxlLlxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5zb3VyY2UgPSBuZXcgQmVoYXZpb3JTdWJqZWN0KFtdKTtcbiAgICAgICAgdGhpcy5jcmVhdGVkSXRlbXMgPSBbXTtcbiAgICAgICAgdGhpcy51cGRhdGVkSXRlbXMgPSBbXTtcbiAgICAgICAgdGhpcy5kZWxldGVkSXRlbXMgPSBbXTtcbiAgICAgICAgdGhpcy5ldmVudHMgPSB0aGlzLnNvdXJjZS5hc09ic2VydmFibGUoKTtcbiAgICAgICAgdGhpcy5maWVsZHMgPSBPYmplY3QuYXNzaWduKHt9LCBkZWZhdWx0TW9kZWxGaWVsZHMsIGZpZWxkcyk7XG4gICAgICAgIHRoaXMuZ2V0SWQgPSBnZXR0ZXIodGhpcy5maWVsZHMuaWQpO1xuICAgICAgICB0aGlzLmdldFJlY3VycmVuY2VJZCA9IGdldHRlcih0aGlzLmZpZWxkcy5yZWN1cnJlbmNlSWQpO1xuICAgICAgICB0aGlzLmdldFJlY3VycmVuY2VSdWxlID0gZ2V0dGVyKHRoaXMuZmllbGRzLnJlY3VycmVuY2VSdWxlKTtcbiAgICAgICAgdGhpcy5nZXRSZWN1cnJlbmNlRXhjZXB0aW9ucyA9IGdldHRlcih0aGlzLmZpZWxkcy5yZWN1cnJlbmNlRXhjZXB0aW9ucyk7XG4gICAgICAgIHRoaXMuZ2V0U3RhcnQgPSBnZXR0ZXIodGhpcy5maWVsZHMuc3RhcnQpO1xuICAgICAgICB0aGlzLnNldElkID0gc2V0dGVyKHRoaXMuZmllbGRzLmlkKTtcbiAgICAgICAgdGhpcy5zZXRSZWN1cnJlbmNlUnVsZSA9IHNldHRlcih0aGlzLmZpZWxkcy5yZWN1cnJlbmNlUnVsZSk7XG4gICAgICAgIHRoaXMuc2V0UmVjdXJyZW5jZUV4Y2VwdGlvbnMgPSBzZXR0ZXIodGhpcy5maWVsZHMucmVjdXJyZW5jZUV4Y2VwdGlvbnMpO1xuICAgICAgICB0aGlzLnNldFJlY3VycmVuY2VJZCA9IHNldHRlcih0aGlzLmZpZWxkcy5yZWN1cnJlbmNlSWQpO1xuICAgIH1cbiAgICBjcmVhdGUoZXZlbnQpIHtcbiAgICAgICAgdGhpcy5sb2dDcmVhdGUoZXZlbnQpO1xuICAgICAgICB0aGlzLnNhdmVDaGFuZ2VzKCk7XG4gICAgfVxuICAgIC8qXG4gICAgICogQ3JlYXRlcyBhbiBleGNlcHRpb24gdG8gYSByZWN1cnJpbmcgc2VyaWVzLlxuICAgICAqXG4gICAgICogVGhlIGBjcmVhdGVFeGNlcHRpb25gIG1ldGhvZCBwZXJmb3JtcyB0aGUgZm9sbG93aW5nIG9wZXJhdGlvbnM6XG4gICAgICogKiBBZGRzIHRoZSBzdGFydCBkYXRlIG9mIHRoZSBldmVudCB0byB0aGUgYHJlY3VycmVuY2VFeGNlcHRpb25zYCBvZiB0aGUgbWFzdGVyIGV2ZW50IChyZWN1cnJlbmNlIGhlYWQpLlxuICAgICAqICogQ3JlYXRlcyBhIG5ldyBldmVudCB0aGF0IHN0b3JlcyB0aGUgcmVjdXJyZW5jZSBleGNlcHRpb24gaXRzZWxmLlxuICAgICAqL1xuICAgIGNyZWF0ZUV4Y2VwdGlvbihldmVudCwgdmFsdWUpIHtcbiAgICAgICAgY29uc3QgZXhjZXB0aW9uID0gdGhpcy5idWlsZEV4Y2VwdGlvbih2YWx1ZSk7XG4gICAgICAgIHRoaXMubG9nUmVtb3ZlT2NjdXJyZW5jZShldmVudCk7XG4gICAgICAgIHRoaXMubG9nQ3JlYXRlKGV4Y2VwdGlvbik7XG4gICAgICAgIHRoaXMuc2F2ZUNoYW5nZXMoKTtcbiAgICB9XG4gICAgdXBkYXRlKGV2ZW50LCB2YWx1ZSkge1xuICAgICAgICB0aGlzLmFzc2lnblZhbHVlcyhldmVudCwgdmFsdWUpO1xuICAgICAgICB0aGlzLmxvZ1VwZGF0ZShldmVudCk7XG4gICAgICAgIHRoaXMuc2F2ZUNoYW5nZXMoKTtcbiAgICB9XG4gICAgcmVtb3ZlKGV2ZW50KSB7XG4gICAgICAgIHRoaXMubG9nUmVtb3ZlKGV2ZW50KTtcbiAgICAgICAgdGhpcy5zYXZlQ2hhbmdlcygpO1xuICAgIH1cbiAgICByZW1vdmVTZXJpZXMoZXZlbnQpIHtcbiAgICAgICAgY29uc3QgaWQgPSB0aGlzLmdldElkKGV2ZW50KTtcbiAgICAgICAgY29uc3QgcmVjdXJyZW5jZUlkID0gdGhpcy5nZXRSZWN1cnJlbmNlSWQoZXZlbnQpO1xuICAgICAgICBjb25zdCBpc0hlYWQgPSB0aGlzLmlzUmVjdXJyZW5jZUhlYWQoZXZlbnQpO1xuICAgICAgICB0aGlzLnJlbW92ZUl0ZW1BbmRFeGNlcHRpb25zKGlzSGVhZCA/IGlkIDogcmVjdXJyZW5jZUlkKTtcbiAgICAgICAgdGhpcy5zYXZlQ2hhbmdlcygpO1xuICAgIH1cbiAgICByZW1vdmVPY2N1cnJlbmNlKGV2ZW50KSB7XG4gICAgICAgIHRoaXMubG9nUmVtb3ZlT2NjdXJyZW5jZShldmVudCk7XG4gICAgICAgIHRoaXMuc2F2ZUNoYW5nZXMoKTtcbiAgICB9XG4gICAgZmluZFJlY3VycmVuY2VNYXN0ZXIoZXZlbnQpIHtcbiAgICAgICAgY29uc3QgaWQgPSB0aGlzLmdldElkKGV2ZW50KTtcbiAgICAgICAgY29uc3QgcmVjdXJyZW5jZUlkID0gdGhpcy5nZXRSZWN1cnJlbmNlSWQoZXZlbnQpO1xuICAgICAgICBjb25zdCBoZWFkSWQgPSB0aGlzLmlzUmVjdXJyZW5jZUhlYWQoZXZlbnQpID8gaWQgOiByZWN1cnJlbmNlSWQ7XG4gICAgICAgIGNvbnN0IGluZGV4ID0gdGhpcy5pdGVtSW5kZXgoaGVhZElkLCB0aGlzLmRhdGEpO1xuICAgICAgICByZXR1cm4gdGhpcy5kYXRhW2luZGV4XTtcbiAgICB9XG4gICAgaXNSZWN1cnJpbmcoZXZlbnQpIHtcbiAgICAgICAgcmV0dXJuIGlzUmVjdXJyaW5nKGV2ZW50LCB0aGlzLmZpZWxkcyk7XG4gICAgfVxuICAgIGlzRXhjZXB0aW9uKGV2ZW50KSB7XG4gICAgICAgIHJldHVybiBpc0V4Y2VwdGlvbihldmVudCwgdGhpcy5maWVsZHMpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIGEgQm9vbGVhbiB2YWx1ZSB3aGljaCBpbmRpY2F0ZXMgaWYgdGhlIGV2ZW50IGlzIG5ldy5cbiAgICAgKiBJZiB0aGUgYElEYCBmaWVsZCBpcyBkZWZpbmVkLCB0aGUgZGVmYXVsdCBpbXBsZW1lbnRhdGlvbiByZXR1cm5zIGB0cnVlYC5cbiAgICAgKiBDYW4gYmUgb3ZlcnJpZGRlbiB0byBpbXBsZW1lbnQgZGlmZmVyZW50IGNvbmRpdGlvbnMuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gZXZlbnQgLSBUaGUgZXZlbnQgdGhhdCB3aWxsIGJlIGNoZWNrZWQuXG4gICAgICovXG4gICAgaXNOZXcoZXZlbnQpIHtcbiAgICAgICAgY29uc3QgaWQgPSB0aGlzLmdldElkKGV2ZW50KTtcbiAgICAgICAgcmV0dXJuICFpc1ByZXNlbnQoaWQpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIHRoZSBuZXh0IGBJRGAgdGhhdCB3aWxsIGJlIHVzZWQgZm9yIG5ldyBldmVudHMuXG4gICAgICogVGhlIGRlZmF1bHQgaW1wbGVtZW50YXRpb24gcmV0dXJucyBgdW5kZWZpbmVkYC5cbiAgICAgKi9cbiAgICBuZXh0SWQoKSB7XG4gICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENvcGllcyB2YWx1ZXMgdG8gdGhlIHRhcmdldCBtb2RlbCBpbnN0YW5jZS5cbiAgICAgKiBUbyBjb3B5IHRoZSB0b3AtbGV2ZWwgZmllbGRzLCB0aGUgYmFzZSBpbXBsZW1lbnRhdGlvbiB1c2VzXG4gICAgICogW2BPYmplY3QuYXNzaWduYF0oaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvSmF2YVNjcmlwdC9SZWZlcmVuY2UvR2xvYmFsX09iamVjdHMvT2JqZWN0L2Fzc2lnbikuXG4gICAgICogVG8gY29weSBuZXN0ZWQgZmllbGRzLCBvdmVycmlkZSBgYXNzaWduVmFsdWVzYCBhbmQgaGFuZGxlIHRoZSBtb2RlbC1zcGVjaWZpYyBjYXNlcy5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB0YXJnZXQgLSBUaGUgdGFyZ2V0IG9iamVjdCB0aGF0IHdpbGwgcmVjZWl2ZSB0aGUgZmllbGQgdmFsdWVzLlxuICAgICAqIEBwYXJhbSBzb3VyY2UgLSBUaGUgc291cmNlIG9iamVjdCBmcm9tIHdoaWNoIHRoZSBmaWVsZHMgd2lsbCBiZSByZWFkLlxuICAgICAqL1xuICAgIGFzc2lnblZhbHVlcyh0YXJnZXQsIHNvdXJjZSkge1xuICAgICAgICBjbG9uZVRvKHNvdXJjZSwgdGFyZ2V0KTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ2xvbmVzIGFuIGV4aXN0aW5nIG1vZGVsIG9iamVjdC5cbiAgICAgKiBUbyBjb3B5IHRoZSB0b3AtbGV2ZWwgbW9kZWwgZmllbGRzLCB0aGUgYmFzZSBjcmVhdGVzIGFuIGVtcHR5IG9iamVjdCBhbmQgY2FsbHMgW2Bhc3NpZ25WYWx1ZXNgXSgjdG9jLWFzc2lnbnZhbHVlcykuXG4gICAgICogVG8gY3JlYXRlIG1vZGVscyBvZiB0aGUgY29ycmVjdCB0eXBlLCBvdmVycmlkZSBgY2xvbmVFdmVudGAuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gZXZlbnQgLSBUaGUgbW9kZWwgaW5zdGFuY2UgdG8gY29weS5cbiAgICAgKiBAcmV0dXJucyBURXZlbnQgLSBUaGUgbmV3IG1vZGVsIGluc3RhbmNlLlxuICAgICAqL1xuICAgIGNsb25lRXZlbnQoZXZlbnQpIHtcbiAgICAgICAgY29uc3QgcmVzdWx0ID0ge307XG4gICAgICAgIHRoaXMuYXNzaWduVmFsdWVzKHJlc3VsdCwgZXZlbnQpO1xuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBBIHV0aWxpdHkgbWV0aG9kIHdoaWNoIHBhcnNlcyByZWN1cnJlbmNlIGV4Y2VwdGlvbiBkYXRlcyBpbiBhbiBJU08gZm9ybWF0LlxuICAgICAqXG4gICAgICogQGV4YW1wbGVcbiAgICAgKiBgYGB0cy1uby1ydW5cbiAgICAgKiAgIGNvbnN0IGV4ZGF0ZXMgPSAnMjAxODA2MTRUMDYwMDAwWjsyMDE4MDYxNVQwNjAwMDBaJztcbiAgICAgKiAgIGNvbnN0IHJlc3VsdCA9IHN1cGVyLnBhcnNlRXhjZXB0aW9ucyhleGRhdGVzKTtcbiAgICAgKlxuICAgICAqICAgLy8gY29uc29sZS5sb2cocmVzdWx0KTtcbiAgICAgKiAgIC8vIEFycmF5IFsgRGF0ZSAyMDE4LTA2LTE0VDAzOjAwOjAwLjAwMFosIERhdGUgMjAxOC0wNi0xNVQwMzowMDowMC4wMDBaIF1cbiAgICAgKiBgYGBcbiAgICAgKlxuICAgICAqIEBwYXJhbSB2YWx1ZSAtIEEgY29tbWEtc2VwYXJhdGVkIGxpc3Qgb2YgSVNPLWZvcm1hdHRlZCBkYXRlcy5cbiAgICAgKiBAcmV0dXJucyBEYXRlW10gLSBUaGUgcmVjdXJyZW5jZSBleGNlcHRpb25zIGFzIGxvY2FsIGRhdGVzLlxuICAgICAqL1xuICAgIHBhcnNlRXhjZXB0aW9ucyh2YWx1ZSkge1xuICAgICAgICBpZiAoIWlzUHJlc2VudCh2YWx1ZSkgfHwgdmFsdWUgPT09ICcnKSB7XG4gICAgICAgICAgICByZXR1cm4gW107XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHZhbHVlXG4gICAgICAgICAgICAuc3BsaXQoJzsnKVxuICAgICAgICAgICAgLm1hcChleCA9PiBwYXJzZURhdGUoZXgsIERBVEVfRk9STUFUUykgfHwgdW5kZWZpbmVkKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQSB1dGlsaXR5IG1ldGhvZCB3aGljaCBzZXJpYWxpemVzIHJlY3VycmVuY2UgZXhjZXB0aW9uIGRhdGVzIGluIGFuIElTTyBmb3JtYXQuXG4gICAgICpcbiAgICAgKiBAZXhhbXBsZVxuICAgICAqIGBgYHRzLW5vLXJ1blxuICAgICAqICAgY29uc3QgZXhkYXRlcyA9IFsgbmV3IERhdGUoMjAxOCwgNSwgMTQsIDMsIDAsIDApLCBuZXcgRGF0ZSgyMDE4LCA1LCAxNSwgMywgMCwgMCkgXTtcbiAgICAgKiAgIGNvbnN0IHJlc3VsdCA9IHN1cGVyLnNlcmlhbGl6ZUV4Y2VwdGlvbnMoZXhkYXRlcyk7XG4gICAgICpcbiAgICAgKiAgIC8vIGNvbnNvbGUubG9nKHJlc3VsdCk7XG4gICAgICogICAvLyAnMjAxODA2MTRUMDYwMDAwWjsyMDE4MDYxNVQwNjAwMDBaJ1xuICAgICAqIGBgYFxuICAgICAqXG4gICAgICogQHBhcmFtIHZhbHVlIC0gQW4gYXJyYXkgb2YgYERhdGVgIGluc3RhbmNlcy5cbiAgICAgKiBAcmV0dXJucyBzdHJpbmcgLSBBIGNvbW1hLXNlcGFyYXRlZCBsaXN0IG9mIElTTy1mb3JtYXR0ZWQgZGF0ZXMuXG4gICAgICovXG4gICAgc2VyaWFsaXplRXhjZXB0aW9ucyhleGNlcHRpb25zKSB7XG4gICAgICAgIGlmICghZXhjZXB0aW9ucyB8fCBleGNlcHRpb25zLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgcmV0dXJuICcnO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBleGNlcHRpb25zLm1hcChkYXRlID0+IGZvcm1hdERhdGUodG9Mb2NhbERhdGUoZGF0ZSksICd5eXl5TU1kZFRISG1tc3MnKSArICdaJykuam9pbignOycpO1xuICAgIH1cbiAgICByZXNldCgpIHtcbiAgICAgICAgdGhpcy5kYXRhID0gW107XG4gICAgICAgIHRoaXMuZGVsZXRlZEl0ZW1zID0gW107XG4gICAgICAgIHRoaXMudXBkYXRlZEl0ZW1zID0gW107XG4gICAgICAgIHRoaXMuY3JlYXRlZEl0ZW1zID0gW107XG4gICAgfVxuICAgIGl0ZW1JbmRleChpZCwgaXRlbXMpIHtcbiAgICAgICAgZm9yIChsZXQgaWR4ID0gMDsgaWR4IDwgaXRlbXMubGVuZ3RoOyBpZHgrKykge1xuICAgICAgICAgICAgaWYgKHRoaXMuZ2V0SWQoaXRlbXNbaWR4XSkgPT09IGlkKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGlkeDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gLTE7XG4gICAgfVxuICAgIGJ1aWxkRXhjZXB0aW9uKGl0ZW0pIHtcbiAgICAgICAgY29uc3QgZmllbGRzID0gdGhpcy5maWVsZHM7XG4gICAgICAgIGNvbnN0IGhlYWQgPSB0aGlzLmZpbmRSZWN1cnJlbmNlTWFzdGVyKGl0ZW0pO1xuICAgICAgICBjb25zdCBjb3B5ID0gdGhpcy5jbG9uZUV2ZW50KGl0ZW0pO1xuICAgICAgICBhc3NpZ25GaWVsZChjb3B5LCBoZWFkLCBmaWVsZHMuaWQpO1xuICAgICAgICB0aGlzLnNldElkKGNvcHksIHRoaXMubmV4dElkKCkpO1xuICAgICAgICB0aGlzLnNldFJlY3VycmVuY2VSdWxlKGNvcHksIHVuZGVmaW5lZCk7XG4gICAgICAgIHRoaXMuc2V0UmVjdXJyZW5jZUlkKGNvcHksIHRoaXMuZ2V0SWQoaGVhZCkpO1xuICAgICAgICByZXR1cm4gY29weTtcbiAgICB9XG4gICAgaXNSZWN1cnJlbmNlSGVhZChpdGVtKSB7XG4gICAgICAgIGNvbnN0IGlkID0gdGhpcy5nZXRJZChpdGVtKTtcbiAgICAgICAgY29uc3QgcmVjdXJyZW5jZVJ1bGUgPSB0aGlzLmdldFJlY3VycmVuY2VSdWxlKGl0ZW0pO1xuICAgICAgICByZXR1cm4gISEoaWQgJiYgcmVjdXJyZW5jZVJ1bGUpO1xuICAgIH1cbiAgICBsb2dDcmVhdGUoaXRlbSkge1xuICAgICAgICB0aGlzLmRhdGEgPSBbLi4udGhpcy5kYXRhLCBpdGVtXTtcbiAgICAgICAgdGhpcy5zb3VyY2UubmV4dCh0aGlzLmRhdGEpO1xuICAgICAgICB0aGlzLmNyZWF0ZWRJdGVtcy5wdXNoKGl0ZW0pO1xuICAgIH1cbiAgICBsb2dVcGRhdGUoaXRlbSkge1xuICAgICAgICBjb25zdCBpZCA9IHRoaXMuZ2V0SWQoaXRlbSk7XG4gICAgICAgIGlmICghdGhpcy5pc05ldyhpdGVtKSkge1xuICAgICAgICAgICAgY29uc3QgaW5kZXggPSB0aGlzLml0ZW1JbmRleChpZCwgdGhpcy51cGRhdGVkSXRlbXMpO1xuICAgICAgICAgICAgaWYgKGluZGV4ICE9PSAtMSkge1xuICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlZEl0ZW1zLnNwbGljZShpbmRleCwgMSwgaXRlbSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZWRJdGVtcy5wdXNoKGl0ZW0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgY29uc3QgaW5kZXggPSB0aGlzLmNyZWF0ZWRJdGVtcy5pbmRleE9mKGl0ZW0pO1xuICAgICAgICAgICAgdGhpcy5jcmVhdGVkSXRlbXMuc3BsaWNlKGluZGV4LCAxLCBpdGVtKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBsb2dSZW1vdmUoaXRlbSkge1xuICAgICAgICBjb25zdCBpZCA9IHRoaXMuZ2V0SWQoaXRlbSk7XG4gICAgICAgIGxldCBpbmRleCA9IHRoaXMuaXRlbUluZGV4KGlkLCB0aGlzLmRhdGEpO1xuICAgICAgICB0aGlzLmRhdGEgPSB0aGlzLmRhdGEuZmlsdGVyKChfLCBpKSA9PiBpICE9PSBpbmRleCk7XG4gICAgICAgIHRoaXMuc291cmNlLm5leHQodGhpcy5kYXRhKTtcbiAgICAgICAgaW5kZXggPSB0aGlzLml0ZW1JbmRleChpZCwgdGhpcy5jcmVhdGVkSXRlbXMpO1xuICAgICAgICBpZiAoaW5kZXggPj0gMCkge1xuICAgICAgICAgICAgdGhpcy5jcmVhdGVkSXRlbXMuc3BsaWNlKGluZGV4LCAxKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuZGVsZXRlZEl0ZW1zLnB1c2goaXRlbSk7XG4gICAgICAgIH1cbiAgICAgICAgaW5kZXggPSB0aGlzLml0ZW1JbmRleChpZCwgdGhpcy51cGRhdGVkSXRlbXMpO1xuICAgICAgICBpZiAoaW5kZXggPj0gMCkge1xuICAgICAgICAgICAgdGhpcy51cGRhdGVkSXRlbXMuc3BsaWNlKGluZGV4LCAxKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBsb2dSZW1vdmVPY2N1cnJlbmNlKGV2ZW50KSB7XG4gICAgICAgIGNvbnN0IGhlYWQgPSB0aGlzLmZpbmRSZWN1cnJlbmNlTWFzdGVyKGV2ZW50KTtcbiAgICAgICAgY29uc3QgZXhjZXB0aW9uRGF0ZSA9IHRoaXMuZ2V0U3RhcnQoZXZlbnQpO1xuICAgICAgICBjb25zdCBjdXJyZW50RXhjZXB0aW9ucyA9IHRoaXMuZ2V0UmVjdXJyZW5jZUV4Y2VwdGlvbnMoaGVhZCkgfHwgW107XG4gICAgICAgIHRoaXMuc2V0UmVjdXJyZW5jZUV4Y2VwdGlvbnMoaGVhZCwgWy4uLmN1cnJlbnRFeGNlcHRpb25zLCBleGNlcHRpb25EYXRlXSk7XG4gICAgICAgIHRoaXMubG9nVXBkYXRlKGhlYWQpO1xuICAgIH1cbiAgICByZW1vdmVJdGVtQW5kRXhjZXB0aW9ucyhpdGVtSWQpIHtcbiAgICAgICAgdGhpcy5kZWxldGVkSXRlbXMgPSB0aGlzLmRlbGV0ZWRJdGVtcy5jb25jYXQodGhpcy5kYXRhLmZpbHRlcihldiA9PiB0aGlzLmdldFJlY3VycmVuY2VJZChldikgPT09IGl0ZW1JZCB8fCB0aGlzLmdldElkKGV2KSA9PT0gaXRlbUlkKSk7XG4gICAgfVxuICAgIGhhc0NoYW5nZXMoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmRlbGV0ZWRJdGVtcy5sZW5ndGggKyB0aGlzLnVwZGF0ZWRJdGVtcy5sZW5ndGggKyB0aGlzLmNyZWF0ZWRJdGVtcy5sZW5ndGggPiAwO1xuICAgIH1cbiAgICBzYXZlQ2hhbmdlcygpIHtcbiAgICAgICAgaWYgKCF0aGlzLmhhc0NoYW5nZXMoKSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuc2F2ZSh0aGlzLmNyZWF0ZWRJdGVtcywgdGhpcy51cGRhdGVkSXRlbXMsIHRoaXMuZGVsZXRlZEl0ZW1zKTtcbiAgICAgICAgdGhpcy5yZXNldCgpO1xuICAgIH1cbn1cblxuY29uc3QgY3JlYXRlRWxlbWVudCA9ICh0YWdOYW1lLCBjbGFzc05hbWUpID0+IHtcbiAgICBjb25zdCBlbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCh0YWdOYW1lKTtcbiAgICBpZiAoY2xhc3NOYW1lKSB7XG4gICAgICAgIGVsZW1lbnQuY2xhc3NOYW1lID0gY2xhc3NOYW1lO1xuICAgIH1cbiAgICByZXR1cm4gZWxlbWVudDtcbn07XG5jb25zdCBjcmVhdGVEaXYgPSAoY2xhc3NOYW1lKSA9PiBjcmVhdGVFbGVtZW50KCdkaXYnLCBjbGFzc05hbWUpO1xuLyoqXG4gKiBDb25maWd1cmVzIHRoZSBzZXR0aW5ncyBmb3IgdGhlIGV4cG9ydCBvZiBTY2hlZHVsZXIgaW4gUERGIChbc2VlIGV4YW1wbGVdKHslIHNsdWcgcGRmZXhwb3J0X3NjaGVkdWxlciAlfSkpLlxuICovXG5jbGFzcyBQREZDb21wb25lbnQge1xuICAgIGNvbnN0cnVjdG9yKHBkZlNlcnZpY2UsIG5nWm9uZSkge1xuICAgICAgICB0aGlzLnBkZlNlcnZpY2UgPSBwZGZTZXJ2aWNlO1xuICAgICAgICB0aGlzLm5nWm9uZSA9IG5nWm9uZTtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRoZSBjcmVhdG9yIG9mIHRoZSBQREYgZG9jdW1lbnQuXG4gICAgICAgICAqIERlZmF1bHRzIHRvIGBLZW5kbyBVSSBQREYgR2VuZXJhdG9yYC5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuY3JlYXRvciA9ICdLZW5kbyBVSSBQREYgR2VuZXJhdG9yJztcbiAgICAgICAgdGhpcy5zdWJzY3JpcHRpb25zID0gdGhpcy5wZGZTZXJ2aWNlLmVsZW1lbnRSZWFkeS5zdWJzY3JpYmUodGhpcy5jcmVhdGVFbGVtZW50LmJpbmQodGhpcykpO1xuICAgICAgICB0aGlzLnNhdmVEYXRhVXJpID0gdGhpcy5zYXZlRGF0YVVyaS5iaW5kKHRoaXMpO1xuICAgICAgICB0aGlzLmV4cG9ydEdyb3VwID0gdGhpcy5leHBvcnRHcm91cC5iaW5kKHRoaXMpO1xuICAgICAgICB0aGlzLmRvbmUgPSB0aGlzLmRvbmUuYmluZCh0aGlzKTtcbiAgICB9XG4gICAgbmdPbkRlc3Ryb3koKSB7XG4gICAgICAgIHRoaXMuc3Vic2NyaXB0aW9ucy51bnN1YnNjcmliZSgpO1xuICAgIH1cbiAgICBnZXQgZHJhd09wdGlvbnMoKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBfZGVzdHJ1Y3RpdmU6IHRydWUsXG4gICAgICAgICAgICBhdm9pZExpbmtzOiB0aGlzLmF2b2lkTGlua3MsXG4gICAgICAgICAgICBtYXJnaW46IHRoaXMubWFyZ2luLFxuICAgICAgICAgICAgc2NhbGU6IHRoaXMuc2NhbGVcbiAgICAgICAgfTtcbiAgICB9XG4gICAgZ2V0IHBkZk9wdGlvbnMoKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBhdXRob3I6IHRoaXMuYXV0aG9yLFxuICAgICAgICAgICAgY3JlYXRvcjogdGhpcy5jcmVhdG9yLFxuICAgICAgICAgICAgZGF0ZTogdGhpcy5kYXRlLFxuICAgICAgICAgICAgaW1nRFBJOiB0aGlzLmltYWdlUmVzb2x1dGlvbixcbiAgICAgICAgICAgIGtleXdvcmRzOiB0aGlzLmtleXdvcmRzLFxuICAgICAgICAgICAgbWFyZ2luOiB0aGlzLm1hcmdpbixcbiAgICAgICAgICAgIHByb2R1Y2VyOiB0aGlzLnByb2R1Y2VyLFxuICAgICAgICAgICAgc3ViamVjdDogdGhpcy5zdWJqZWN0LFxuICAgICAgICAgICAgdGl0bGU6IHRoaXMudGl0bGVcbiAgICAgICAgfTtcbiAgICB9XG4gICAgZ2V0IHNhdmVPcHRpb25zKCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgZm9yY2VQcm94eTogdGhpcy5mb3JjZVByb3h5LFxuICAgICAgICAgICAgcHJveHlEYXRhOiB0aGlzLnByb3h5RGF0YSxcbiAgICAgICAgICAgIHByb3h5VGFyZ2V0OiB0aGlzLnByb3h5VGFyZ2V0LFxuICAgICAgICAgICAgcHJveHlVUkw6IHRoaXMucHJveHlVUkxcbiAgICAgICAgfTtcbiAgICB9XG4gICAgY3JlYXRlRWxlbWVudChhcmdzKSB7XG4gICAgICAgIHRoaXMubmdab25lLnJ1bk91dHNpZGVBbmd1bGFyKCgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGNvbnRhaW5lciA9IHRoaXMuY29udGFpbmVyID0gY3JlYXRlRGl2KCk7XG4gICAgICAgICAgICBjb250YWluZXIuc3R5bGUudG9wID0gY29udGFpbmVyLnN0eWxlLmxlZnQgPSAnLTEwMDAwcHgnO1xuICAgICAgICAgICAgY29udGFpbmVyLnN0eWxlLnBvc2l0aW9uID0gJ2Fic29sdXRlJztcbiAgICAgICAgICAgIGNvbnN0IHdyYXBwZXIgPSBjcmVhdGVEaXYoJ2std2lkZ2V0IGstc2NoZWR1bGVyIGstZmxvYXR3cmFwJyk7XG4gICAgICAgICAgICB3cmFwcGVyLnN0eWxlLnBvc2l0aW9uID0gJ3JlbGF0aXZlJztcbiAgICAgICAgICAgIHdyYXBwZXIuYXBwZW5kQ2hpbGQoYXJncy5lbGVtZW50KTtcbiAgICAgICAgICAgIGNvbnRhaW5lci5hcHBlbmRDaGlsZCh3cmFwcGVyKTtcbiAgICAgICAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoY29udGFpbmVyKTtcbiAgICAgICAgICAgIHRoaXMuc2F2ZSh3cmFwcGVyKTtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIHNhdmUoZWxlbWVudCkge1xuICAgICAgICB0aGlzLmRyYXdFbGVtZW50KGVsZW1lbnQsIHRoaXMuZHJhd09wdGlvbnMpXG4gICAgICAgICAgICAudGhlbih0aGlzLmV4cG9ydEdyb3VwKVxuICAgICAgICAgICAgLnRoZW4odGhpcy5zYXZlRGF0YVVyaSlcbiAgICAgICAgICAgIC50aGVuKHRoaXMuZG9uZSwgdGhpcy5kb25lKTtcbiAgICB9XG4gICAgZHJhd0VsZW1lbnQoZWxlbWVudCwgb3B0aW9ucykge1xuICAgICAgICByZXR1cm4gZHJhd0RPTShlbGVtZW50LCBvcHRpb25zKTtcbiAgICB9XG4gICAgZXhwb3J0R3JvdXAoZ3JvdXApIHtcbiAgICAgICAgcmV0dXJuIGV4cG9ydFBERihncm91cCwgdGhpcy5wZGZPcHRpb25zKTtcbiAgICB9XG4gICAgc2F2ZURhdGFVcmkoZGF0YVVyaSkge1xuICAgICAgICBzYXZlQXMoZGF0YVVyaSwgdGhpcy5maWxlTmFtZSwgdGhpcy5zYXZlT3B0aW9ucyk7XG4gICAgfVxuICAgIGRvbmUoKSB7XG4gICAgICAgIGlmICh0aGlzLmNvbnRhaW5lcikge1xuICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5yZW1vdmVDaGlsZCh0aGlzLmNvbnRhaW5lcik7XG4gICAgICAgICAgICB0aGlzLmNvbnRhaW5lciA9IG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5wZGZTZXJ2aWNlLmRvbmUuZW1pdCgpO1xuICAgIH1cbn1cblBERkNvbXBvbmVudC5kZWNvcmF0b3JzID0gW1xuICAgIHsgdHlwZTogQ29tcG9uZW50LCBhcmdzOiBbe1xuICAgICAgICAgICAgICAgIHNlbGVjdG9yOiAna2VuZG8tc2NoZWR1bGVyLXBkZicsXG4gICAgICAgICAgICAgICAgdGVtcGxhdGU6ICcnXG4gICAgICAgICAgICB9LF0gfSxcbl07XG4vKiogQG5vY29sbGFwc2UgKi9cblBERkNvbXBvbmVudC5jdG9yUGFyYW1ldGVycyA9ICgpID0+IFtcbiAgICB7IHR5cGU6IFBERlNlcnZpY2UgfSxcbiAgICB7IHR5cGU6IE5nWm9uZSB9XG5dO1xuUERGQ29tcG9uZW50LnByb3BEZWNvcmF0b3JzID0ge1xuICAgIGF1dGhvcjogW3sgdHlwZTogSW5wdXQgfV0sXG4gICAgYXZvaWRMaW5rczogW3sgdHlwZTogSW5wdXQgfV0sXG4gICAgY3JlYXRvcjogW3sgdHlwZTogSW5wdXQgfV0sXG4gICAgZGF0ZTogW3sgdHlwZTogSW5wdXQgfV0sXG4gICAgaW1hZ2VSZXNvbHV0aW9uOiBbeyB0eXBlOiBJbnB1dCB9XSxcbiAgICBmaWxlTmFtZTogW3sgdHlwZTogSW5wdXQgfV0sXG4gICAgZm9yY2VQcm94eTogW3sgdHlwZTogSW5wdXQgfV0sXG4gICAga2V5d29yZHM6IFt7IHR5cGU6IElucHV0IH1dLFxuICAgIG1hcmdpbjogW3sgdHlwZTogSW5wdXQgfV0sXG4gICAgc2NhbGU6IFt7IHR5cGU6IElucHV0IH1dLFxuICAgIHByb3h5RGF0YTogW3sgdHlwZTogSW5wdXQgfV0sXG4gICAgcHJveHlVUkw6IFt7IHR5cGU6IElucHV0IH1dLFxuICAgIHByb3h5VGFyZ2V0OiBbeyB0eXBlOiBJbnB1dCB9XSxcbiAgICBwcm9kdWNlcjogW3sgdHlwZTogSW5wdXQgfV0sXG4gICAgc3ViamVjdDogW3sgdHlwZTogSW5wdXQgfV0sXG4gICAgdGl0bGU6IFt7IHR5cGU6IElucHV0IH1dXG59O1xuXG4vKipcbiAqIFJlcHJlc2VudHMgdGhlIGBleHBvcnQtdG8tUERGYCBjb21tYW5kIG9mIHRoZSBTY2hlZHVsZXIuXG4gKiBZb3UgY2FuIGFwcGx5IHRoaXMgZGlyZWN0aXZlIHRvIGFueSBgYnV0dG9uYCBlbGVtZW50IGluc2lkZSBhXG4gKiBbYFRvb2xiYXJUZW1wbGF0ZWBdKHslIHNsdWcgdG9vbGJhcl9zY2hlZHVsZXIgJX0pLlxuICogV2hlbiB0aGUgdXNlciBjbGlja3MgYSBidXR0b24gdGhhdCBpcyBhc3NvY2lhdGVkIHdpdGggdGhlIGRpcmVjdGl2ZSwgdGhlXG4gKiBbYHBkZkV4cG9ydGBdKHslIHNsdWcgYXBpX3NjaGVkdWxlcl9zY2hlZHVsZXJjb21wb25lbnQgJX0jdG9jLXBkZmV4cG9ydCkgZXZlbnRcbiAqIGZpcmVzIChbc2VlIGV4YW1wbGVdKHslIHNsdWcgcGRmZXhwb3J0X3NjaGVkdWxlciAlfSkpLlxuICpcbiAqIEBleGFtcGxlXG4gKiBgYGBodG1sLW5vLXJ1blxuICogPGtlbmRvLXNjaGVkdWxlcj5cbiAqICAgICAgPG5nLXRlbXBsYXRlIGtlbmRvU2NoZWR1bGVyVG9vbGJhclRlbXBsYXRlPlxuICogICAgICAgICAgPGJ1dHRvbiBrZW5kb1NjaGVkdWxlclBERkNvbW1hbmQ+RXhwb3J0IFBERjwvYnV0dG9uPlxuICogICAgICAgICAgPHVsIGtlbmRvU2NoZWR1bGVyVG9vbGJhck5hdmlnYXRpb24+PC91bD5cbiAqICAgICAgICAgIDx1bCBrZW5kb1NjaGVkdWxlclRvb2xiYXJWaWV3U2VsZWN0b3I+PC91bD5cbiAqICAgICAgPC9uZy10ZW1wbGF0ZT5cbiAqICAgICAgPGtlbmRvLXNjaGVkdWxlci1wZGYgZmlsZU5hbWU9XCJTY2hlZHVsZXIucGRmXCI+XG4gKiAgICAgIDwva2VuZG8tc2NoZWR1bGVyLXBkZj5cbiAqIDwva2VuZG8tc2NoZWR1bGVyPlxuICogYGBgXG4gKi9cbmNsYXNzIFBERkNvbW1hbmREaXJlY3RpdmUgZXh0ZW5kcyBCdXR0b24ge1xuICAgIGNvbnN0cnVjdG9yKHBkZlNlcnZpY2UsIGVsZW1lbnQsIHJlbmRlcmVyLCBsb2NhbGl6YXRpb24sIG5nWm9uZSkge1xuICAgICAgICBzdXBlcihlbGVtZW50LCByZW5kZXJlciwgbnVsbCwgbG9jYWxpemF0aW9uLCBuZ1pvbmUpO1xuICAgICAgICB0aGlzLnBkZlNlcnZpY2UgPSBwZGZTZXJ2aWNlO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBAaGlkZGVuXG4gICAgICovXG4gICAgb25DbGljayhlKSB7XG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgdGhpcy5wZGZTZXJ2aWNlLmV4cG9ydENsaWNrLmVtaXQoKTtcbiAgICB9XG4gICAgbmdPbkluaXQoKSB7XG4gICAgICAgIHRoaXMuaWNvbiA9ICdwZGYnO1xuICAgIH1cbn1cblBERkNvbW1hbmREaXJlY3RpdmUuZGVjb3JhdG9ycyA9IFtcbiAgICB7IHR5cGU6IERpcmVjdGl2ZSwgYXJnczogW3tcbiAgICAgICAgICAgICAgICBzZWxlY3RvcjogJ1trZW5kb1NjaGVkdWxlclBERkNvbW1hbmRdJ1xuICAgICAgICAgICAgfSxdIH0sXG5dO1xuLyoqIEBub2NvbGxhcHNlICovXG5QREZDb21tYW5kRGlyZWN0aXZlLmN0b3JQYXJhbWV0ZXJzID0gKCkgPT4gW1xuICAgIHsgdHlwZTogUERGU2VydmljZSB9LFxuICAgIHsgdHlwZTogRWxlbWVudFJlZiB9LFxuICAgIHsgdHlwZTogUmVuZGVyZXIyIH0sXG4gICAgeyB0eXBlOiBMb2NhbGl6YXRpb25TZXJ2aWNlIH0sXG4gICAgeyB0eXBlOiBOZ1pvbmUgfVxuXTtcblBERkNvbW1hbmREaXJlY3RpdmUucHJvcERlY29yYXRvcnMgPSB7XG4gICAgb25DbGljazogW3sgdHlwZTogSG9zdExpc3RlbmVyLCBhcmdzOiBbJ2NsaWNrJywgWyckZXZlbnQnXSxdIH1dXG59O1xuXG5jb25zdCBkZWNsYXJhdGlvbnMkMSA9IFtcbiAgICBQREZDb21wb25lbnQsXG4gICAgUERGQ29tbWFuZERpcmVjdGl2ZVxuXTtcbi8qKlxuICogUmVwcmVzZW50cyB0aGUgW05nTW9kdWxlXShodHRwczovL2FuZ3VsYXIuaW8vYXBpL2NvcmUvTmdNb2R1bGUpXG4gKiBkZWZpbml0aW9uIGZvciB0aGUgU2NoZWR1bGVyIFBERiBjb21wb25lbnQuXG4gKlxuICogQGV4YW1wbGVcbiAqXG4gKiBgYGB0cy1uby1ydW5cbiAqIC8vIEltcG9ydCB0aGUgU2NoZWR1bGVyIGFuZCBQREYgbW9kdWxlc1xuICogaW1wb3J0IHsgU2NoZWR1bGVyTW9kdWxlLCBQREZNb2R1bGUgfSBmcm9tICdAcHJvZ3Jlc3Mva2VuZG8tYW5ndWxhci1zY2hlZHVsZXInO1xuICpcbiAqIC8vIFRoZSBicm93c2VyIHBsYXRmb3JtIHdpdGggYSBjb21waWxlclxuICogaW1wb3J0IHsgcGxhdGZvcm1Ccm93c2VyRHluYW1pYyB9IGZyb20gJ0Bhbmd1bGFyL3BsYXRmb3JtLWJyb3dzZXItZHluYW1pYyc7XG4gKlxuICogaW1wb3J0IHsgTmdNb2R1bGUgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcbiAqXG4gKiAvLyBJbXBvcnQgdGhlIGFwcCBjb21wb25lbnRcbiAqIGltcG9ydCB7IEFwcENvbXBvbmVudCB9IGZyb20gJy4vYXBwLmNvbXBvbmVudCc7XG4gKlxuICogLy8gRGVmaW5lIHRoZSBhcHAgbW9kdWxlXG4gKiBfQE5nTW9kdWxlKHtcbiAqICAgICBkZWNsYXJhdGlvbnM6IFtBcHBDb21wb25lbnRdLCAvLyBkZWNsYXJlIGFwcCBjb21wb25lbnRcbiAqICAgICBpbXBvcnRzOiAgICAgIFtCcm93c2VyTW9kdWxlLCBTY2hlZHVsZXJNb2R1bGUsIFBERk1vZHVsZV0sIC8vIGltcG9ydCBTY2hlZHVsZXIgYW5kIFBERiBtb2R1bGVzXG4gKiAgICAgYm9vdHN0cmFwOiAgICBbQXBwQ29tcG9uZW50XVxuICogfSlcbiAqIGV4cG9ydCBjbGFzcyBBcHBNb2R1bGUge31cbiAqXG4gKiAvLyBDb21waWxlIGFuZCBsYXVuY2ggdGhlIG1vZHVsZVxuICogcGxhdGZvcm1Ccm93c2VyRHluYW1pYygpLmJvb3RzdHJhcE1vZHVsZShBcHBNb2R1bGUpO1xuICpcbiAqIGBgYFxuICovXG5jbGFzcyBQREZNb2R1bGUge1xufVxuUERGTW9kdWxlLmRlY29yYXRvcnMgPSBbXG4gICAgeyB0eXBlOiBOZ01vZHVsZSwgYXJnczogW3tcbiAgICAgICAgICAgICAgICBkZWNsYXJhdGlvbnM6IFtkZWNsYXJhdGlvbnMkMV0sXG4gICAgICAgICAgICAgICAgZXhwb3J0czogW2RlY2xhcmF0aW9ucyQxXVxuICAgICAgICAgICAgfSxdIH0sXG5dO1xuXG4vKipcbiAqIEdlbmVyYXRlZCBidW5kbGUgaW5kZXguIERvIG5vdCBlZGl0LlxuICovXG5cbmV4cG9ydCB7IERhdGFCaW5kaW5nRGlyZWN0aXZlLCBFZGl0aW5nRGlyZWN0aXZlQmFzZSwgUmVhY3RpdmVFZGl0aW5nRGlyZWN0aXZlLCBTQ0hFRFVMRVJfREFURVRJTUVQSUNLRVJfVkFMVUVfQUNDRVNTT1IsIFNjaGVkdWxlckRhdGVUaW1lUGlja2VyQ29tcG9uZW50LCBEaWFsb2dzU2VydmljZSwgRWRpdERpYWxvZ1RlbXBsYXRlRGlyZWN0aXZlLCBFZGl0RGlhbG9nQ29tcG9uZW50LCBFZGl0U2VydmljZSwgTG9jYWxEYXRhQ2hhbmdlc1NlcnZpY2UsIEVuZFJ1bGVSYWRpb0J1dHRvbkRpcmVjdGl2ZSwgUmVjdXJyZW5jZUVkaXRvckN1c3RvbU1lc3NhZ2VzQ29tcG9uZW50LCBSZWN1cnJlbmNlRWRpdG9yTG9jYWxpemVkTWVzc2FnZXNEaXJlY3RpdmUsIE1lc3NhZ2VzJDEgYXMgTWVzc2FnZXMsIFJlY3VycmVuY2VMb2NhbGl6YXRpb25TZXJ2aWNlLCBSRUNVUlJFTkNFX1ZBTFVFX0FDQ0VTU09SLCBSZWN1cnJlbmNlRW5kUnVsZUVkaXRvckNvbXBvbmVudCwgUmVjdXJyZW5jZUZyZXF1ZW5jeUVkaXRvckNvbXBvbmVudCwgUmVjdXJyZW5jZUludGVydmFsRWRpdG9yQ29tcG9uZW50LCBSZWN1cnJlbmNlTW9udGhseVllYXJseUVkaXRvckNvbXBvbmVudCwgUmVjdXJyZW5jZVdlZWtkYXlSdWxlRWRpdG9yQ29tcG9uZW50LCBSZWN1cnJlbmNlU2VydmljZSwgUmVwZWF0T25SYWRpb0J1dHRvbkRpcmVjdGl2ZSwgUmVzb3VyY2VFZGl0b3JCYXNlLCBNVUxUSVBMRV9SRVNPVVJDRV9WQUxVRV9BQ0NFU1NPUiwgTXVsdGlwbGVSZXNvdXJjZUVkaXRvckNvbXBvbmVudCwgU0lOR0xFX1JFU09VUkNFX1ZBTFVFX0FDQ0VTU09SLCBTaW5nbGVSZXNvdXJjZUVkaXRvckNvbXBvbmVudCwgVElNRV9aT05FX1ZBTFVFX0FDQ0VTU09SLCBUaW1lWm9uZUVkaXRvckNvbXBvbmVudCwgQ3JlYXRlRXZlbnQsIFByZXZlbnRhYmxlRXZlbnQkMSBhcyBQcmV2ZW50YWJsZUV2ZW50LCBMb2FkaW5nQ29tcG9uZW50LCBTY2hlZHVsZXJDdXN0b21NZXNzYWdlc0NvbXBvbmVudCwgTG9jYWxpemVkTWVzc2FnZXNEaXJlY3RpdmUsIE1lc3NhZ2VzIGFzIE1lc3NhZ2VzJDEsIFNjaGVkdWxlckxvY2FsaXphdGlvblNlcnZpY2UsIEZvY3VzU2VydmljZSwgU2hvcnRjdXRzRGlyZWN0aXZlLCBUb29sYmFyTmF2aWdhdGlvbkNvbXBvbmVudCwgVG9vbGJhclRlbXBsYXRlRGlyZWN0aXZlLCBUb29sYmFyQ29tcG9uZW50LCBUb29sYmFyTW9kdWxlLCBwdWJsaWNEaXJlY3RpdmVzLCBUb29sYmFyVmlld1NlbGVjdG9yQ29tcG9uZW50LCBBZ2VuZGFIZWFkZXJJdGVtQ29tcG9uZW50LCBBZ2VuZGFIZWFkZXJDb21wb25lbnQsIEFnZW5kYVRhc2tJdGVtQ29tcG9uZW50LCBBZ2VuZGFWaWV3SW50ZXJuYWxDb21wb25lbnQsIEFnZW5kYUxpc3RDb21wb25lbnQsIEFnZW5kYVZpZXdNb2R1bGUsIEJhc2VWaWV3LCBDb25maWd1cmF0aW9uVmlld0Jhc2UsIERvbUV2ZW50c1NlcnZpY2UsIEhpbnRDb250YWluZXJDb21wb25lbnQsIFJlcGVhdFBpcGUsIFJlc2l6ZUhpbnRDb21wb25lbnQsIFJlc291cmNlSXRlcmF0b3JQaXBlLCBWaWV3Rm9vdGVyQ29tcG9uZW50LCBWaWV3c1NoYXJlZE1vZHVsZSwgV29ya0hvdXJzRm9vdGVyRGlyZWN0aXZlLCBEYXlUaW1lU2xvdFNlcnZpY2UsIERheVRpbWVWaWV3QmFzZSwgRGF5VGltZVZpZXdJdGVtQ29tcG9uZW50LCBEYXlUaW1lVmlld0NvbXBvbmVudCwgRGF5VGltZU1vZHVsZSwgRGF5U2xvdERpcmVjdGl2ZSwgVGltZVNsb3REaXJlY3RpdmUsIE1vbnRoU2xvdERpcmVjdGl2ZSwgTW9udGhTbG90U2VydmljZSwgTW9udGhWaWV3SXRlbUNvbXBvbmVudCwgTW9udGhWaWV3UmVuZGVyZXJDb21wb25lbnQsIE1vbnRoVmlld0NvbXBvbmVudCwgTW9udGhWaWV3TW9kdWxlLCBNdWx0aURheVZpZXdCYXNlLCBNdWx0aURheVZpZXdSZW5kZXJlckNvbXBvbmVudCwgTXVsdGlEYXlWaWV3Q29tcG9uZW50LCBNdWx0aURheVZpZXdNb2R1bGUsIFdvcmtXZWVrVmlld0NvbXBvbmVudCwgU2NoZWR1bGVyVmlld0RpcmVjdGl2ZSwgQWdlbmRhRGF0ZVRlbXBsYXRlRGlyZWN0aXZlLCBBZ2VuZGFUaW1lVGVtcGxhdGVEaXJlY3RpdmUsIEFsbERheUV2ZW50VGVtcGxhdGVEaXJlY3RpdmUsIEFsbERheVNsb3RUZW1wbGF0ZURpcmVjdGl2ZSwgRGF0ZUhlYWRlclRlbXBsYXRlRGlyZWN0aXZlLCBFdmVudFRlbXBsYXRlRGlyZWN0aXZlLCBHcm91cEhlYWRlclRlbXBsYXRlRGlyZWN0aXZlLCBNYWpvclRpbWVIZWFkZXJUZW1wbGF0ZURpcmVjdGl2ZSwgTWlub3JUaW1lSGVhZGVyVGVtcGxhdGVEaXJlY3RpdmUsIE1vbnRoRGF5U2xvdFRlbXBsYXRlRGlyZWN0aXZlLCBUaW1lU2xvdFRlbXBsYXRlRGlyZWN0aXZlLCBUaW1lbGluZUJhc2UsIFRpbWVsaW5lTW9udGhWaWV3Q29tcG9uZW50LCBUaW1lbGluZU11bHRpRGF5Vmlld0NvbXBvbmVudCwgVGltZWxpbmVWaWV3Q29tcG9uZW50LCBUaW1lbGluZVZpZXdNb2R1bGUsIFRpbWVsaW5lV2Vla1ZpZXdDb21wb25lbnQsIEJhc2VTbG90RGlyZWN0aXZlLCBCYXNlU2xvdFNlcnZpY2UsIEJhc2VWaWV3SXRlbSwgU2NoZWR1bGVyQ29tcG9uZW50LCBTY2hlZHVsZXJNb2R1bGUsIFZpZXdDb250ZXh0U2VydmljZSwgVmlld1N0YXRlU2VydmljZSwgVG9vbGJhclNlcnZpY2UsIEFnZW5kYVZpZXdDb21wb25lbnQsIERheVZpZXdDb21wb25lbnQsIFdlZWtWaWV3Q29tcG9uZW50LCBSZWN1cnJlbmNlRWRpdG9yQ29tcG9uZW50LCBCYXNlRWRpdFNlcnZpY2UsIFBERk1vZHVsZSwgUERGQ29tcG9uZW50LCBQREZTZXJ2aWNlLCBQREZDb21tYW5kRGlyZWN0aXZlLCBQREZFeHBvcnRFdmVudCwgRm9jdXNhYmxlRGlyZWN0aXZlLCBTaGFyZWRNb2R1bGUsIFNjaGVkdWxlclZpZXcsIERhdGVDaGFuZ2VFdmVudCwgTmF2aWdhdGVFdmVudCwgU2xvdENsaWNrRXZlbnQsIEV2ZW50Q2xpY2tFdmVudCwgRXZlbnRLZXlkb3duRXZlbnQsIFZJRVdfRVZFTlRfTUFQLCBDYW5jZWxFdmVudCwgRWRpdEV2ZW50QmFzZSwgUmVtb3ZlRXZlbnQsIFNhdmVFdmVudCwgUmVzaXplU3RhcnRFdmVudCwgUmVzaXplRXZlbnQsIFJlc2l6ZUVuZEV2ZW50LCBEcmFnU3RhcnRFdmVudCwgRHJhZ0V2ZW50LCBEcmFnRW5kRXZlbnQsIEVkaXRFdmVudCwgQWRkRXZlbnQgfTtcbiJdfQ==